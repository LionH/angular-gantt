(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(module,exports,__webpack_require__){module.exports=__webpack_require__("zUnb")},zUnb:function(module,__webpack_exports__,__webpack_require__){"use strict";function isFunction(x){return"function"==typeof x}__webpack_require__.r(__webpack_exports__);let _enable_super_gross_mode_that_will_cause_bad_things=!1;const config_config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(value){if(value){const error=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+error.stack)}else _enable_super_gross_mode_that_will_cause_bad_things&&console.log("RxJS: Back to a better error behavior. Thank you. <3");_enable_super_gross_mode_that_will_cause_bad_things=value},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(err){setTimeout(()=>{throw err})}const empty={closed:!0,next(value){},error(err){if(config_config.useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)},complete(){}},isArray=Array.isArray||(x=>x&&"number"==typeof x.length);function isObject(x){return null!==x&&"object"==typeof x}function UnsubscriptionErrorImpl(errors){return Error.call(this),this.message=errors?`${errors.length} errors occurred during unsubscription:\n${errors.map((err,i)=>`${i+1}) ${err.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=errors,this}UnsubscriptionErrorImpl.prototype=Object.create(Error.prototype);const UnsubscriptionError=UnsubscriptionErrorImpl;let Subscription_Subscription=(()=>{class Subscription{constructor(unsubscribe){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,unsubscribe&&(this._unsubscribe=unsubscribe)}unsubscribe(){let errors,hasErrors=!1;if(this.closed)return;let{_parent:_parent,_parents:_parents,_unsubscribe:_unsubscribe,_subscriptions:_subscriptions}=this;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;let index=-1,len=_parents?_parents.length:0;for(;_parent;)_parent.remove(this),_parent=++index<len&&_parents[index]||null;if(isFunction(_unsubscribe))try{_unsubscribe.call(this)}catch(e){hasErrors=!0,errors=e instanceof UnsubscriptionError?flattenUnsubscriptionErrors(e.errors):[e]}if(isArray(_subscriptions))for(index=-1,len=_subscriptions.length;++index<len;){const sub=_subscriptions[index];if(isObject(sub))try{sub.unsubscribe()}catch(e){hasErrors=!0,errors=errors||[],e instanceof UnsubscriptionError?errors=errors.concat(flattenUnsubscriptionErrors(e.errors)):errors.push(e)}}if(hasErrors)throw new UnsubscriptionError(errors)}add(teardown){let subscription=teardown;switch(typeof teardown){case"function":subscription=new Subscription(teardown);case"object":if(subscription===this||subscription.closed||"function"!=typeof subscription.unsubscribe)return subscription;if(this.closed)return subscription.unsubscribe(),subscription;if(!(subscription instanceof Subscription)){const tmp=subscription;(subscription=new Subscription)._subscriptions=[tmp]}break;default:if(!teardown)return Subscription.EMPTY;throw new Error("unrecognized teardown "+teardown+" added to Subscription.")}if(subscription._addParent(this)){const subscriptions=this._subscriptions;subscriptions?subscriptions.push(subscription):this._subscriptions=[subscription]}return subscription}remove(subscription){const subscriptions=this._subscriptions;if(subscriptions){const subscriptionIndex=subscriptions.indexOf(subscription);-1!==subscriptionIndex&&subscriptions.splice(subscriptionIndex,1)}}_addParent(parent){let{_parent:_parent,_parents:_parents}=this;return _parent!==parent&&(_parent?_parents?-1===_parents.indexOf(parent)&&(_parents.push(parent),!0):(this._parents=[parent],!0):(this._parent=parent,!0))}}return Subscription.EMPTY=function(empty){return empty.closed=!0,empty}(new Subscription),Subscription})();function flattenUnsubscriptionErrors(errors){return errors.reduce((errs,err)=>errs.concat(err instanceof UnsubscriptionError?err.errors:err),[])}const rxSubscriber="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class Subscriber_Subscriber extends Subscription_Subscription{constructor(destinationOrNext,error,complete){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=empty;break;case 1:if(!destinationOrNext){this.destination=empty;break}if("object"==typeof destinationOrNext){destinationOrNext instanceof Subscriber_Subscriber?(this.syncErrorThrowable=destinationOrNext.syncErrorThrowable,this.destination=destinationOrNext,destinationOrNext.add(this)):(this.syncErrorThrowable=!0,this.destination=new Subscriber_SafeSubscriber(this,destinationOrNext));break}default:this.syncErrorThrowable=!0,this.destination=new Subscriber_SafeSubscriber(this,destinationOrNext,error,complete)}}[rxSubscriber](){return this}static create(next,error,complete){const subscriber=new Subscriber_Subscriber(next,error,complete);return subscriber.syncErrorThrowable=!1,subscriber}next(value){this.isStopped||this._next(value)}error(err){this.isStopped||(this.isStopped=!0,this._error(err))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(value){this.destination.next(value)}_error(err){this.destination.error(err),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parent:_parent,_parents:_parents}=this;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=_parent,this._parents=_parents,this}}class Subscriber_SafeSubscriber extends Subscriber_Subscriber{constructor(_parentSubscriber,observerOrNext,error,complete){let next;super(),this._parentSubscriber=_parentSubscriber;let context=this;isFunction(observerOrNext)?next=observerOrNext:observerOrNext&&(next=observerOrNext.next,error=observerOrNext.error,complete=observerOrNext.complete,observerOrNext!==empty&&(isFunction((context=Object.create(observerOrNext)).unsubscribe)&&this.add(context.unsubscribe.bind(context)),context.unsubscribe=this.unsubscribe.bind(this))),this._context=context,this._next=next,this._error=error,this._complete=complete}next(value){if(!this.isStopped&&this._next){const{_parentSubscriber:_parentSubscriber}=this;config_config.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?this.__tryOrSetError(_parentSubscriber,this._next,value)&&this.unsubscribe():this.__tryOrUnsub(this._next,value)}}error(err){if(!this.isStopped){const{_parentSubscriber:_parentSubscriber}=this,{useDeprecatedSynchronousErrorHandling:useDeprecatedSynchronousErrorHandling}=config_config;if(this._error)useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?(this.__tryOrSetError(_parentSubscriber,this._error,err),this.unsubscribe()):(this.__tryOrUnsub(this._error,err),this.unsubscribe());else if(_parentSubscriber.syncErrorThrowable)useDeprecatedSynchronousErrorHandling?(_parentSubscriber.syncErrorValue=err,_parentSubscriber.syncErrorThrown=!0):hostReportError(err),this.unsubscribe();else{if(this.unsubscribe(),useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)}}}complete(){if(!this.isStopped){const{_parentSubscriber:_parentSubscriber}=this;if(this._complete){const wrappedComplete=()=>this._complete.call(this._context);config_config.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?(this.__tryOrSetError(_parentSubscriber,wrappedComplete),this.unsubscribe()):(this.__tryOrUnsub(wrappedComplete),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(fn,value){try{fn.call(this._context,value)}catch(err){if(this.unsubscribe(),config_config.useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)}}__tryOrSetError(parent,fn,value){if(!config_config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{fn.call(this._context,value)}catch(err){return config_config.useDeprecatedSynchronousErrorHandling?(parent.syncErrorValue=err,parent.syncErrorThrown=!0,!0):(hostReportError(err),!0)}return!1}_unsubscribe(){const{_parentSubscriber:_parentSubscriber}=this;this._context=null,this._parentSubscriber=null,_parentSubscriber.unsubscribe()}}const observable_observable="function"==typeof Symbol&&Symbol.observable||"@@observable";function noop(){}function pipe(...fns){return pipeFromArray(fns)}function pipeFromArray(fns){return fns?1===fns.length?fns[0]:function(input){return fns.reduce((prev,fn)=>fn(prev),input)}:noop}let Observable_Observable=(()=>{class Observable{constructor(subscribe){this._isScalar=!1,subscribe&&(this._subscribe=subscribe)}lift(operator){const observable=new Observable;return observable.source=this,observable.operator=operator,observable}subscribe(observerOrNext,error,complete){const{operator:operator}=this,sink=function(nextOrObserver,error,complete){if(nextOrObserver){if(nextOrObserver instanceof Subscriber_Subscriber)return nextOrObserver;if(nextOrObserver[rxSubscriber])return nextOrObserver[rxSubscriber]()}return nextOrObserver||error||complete?new Subscriber_Subscriber(nextOrObserver,error,complete):new Subscriber_Subscriber(empty)}(observerOrNext,error,complete);if(sink.add(operator?operator.call(sink,this.source):this.source||config_config.useDeprecatedSynchronousErrorHandling&&!sink.syncErrorThrowable?this._subscribe(sink):this._trySubscribe(sink)),config_config.useDeprecatedSynchronousErrorHandling&&sink.syncErrorThrowable&&(sink.syncErrorThrowable=!1,sink.syncErrorThrown))throw sink.syncErrorValue;return sink}_trySubscribe(sink){try{return this._subscribe(sink)}catch(err){config_config.useDeprecatedSynchronousErrorHandling&&(sink.syncErrorThrown=!0,sink.syncErrorValue=err),function(observer){for(;observer;){const{closed:closed,destination:destination,isStopped:isStopped}=observer;if(closed||isStopped)return!1;observer=destination&&destination instanceof Subscriber_Subscriber?destination:null}return!0}(sink)?sink.error(err):console.warn(err)}}forEach(next,promiseCtor){return new(promiseCtor=getPromiseCtor(promiseCtor))((resolve,reject)=>{let subscription;subscription=this.subscribe(value=>{try{next(value)}catch(err){reject(err),subscription&&subscription.unsubscribe()}},reject,resolve)})}_subscribe(subscriber){const{source:source}=this;return source&&source.subscribe(subscriber)}[observable_observable](){return this}pipe(...operations){return 0===operations.length?this:pipeFromArray(operations)(this)}toPromise(promiseCtor){return new(promiseCtor=getPromiseCtor(promiseCtor))((resolve,reject)=>{let value;this.subscribe(x=>value=x,err=>reject(err),()=>resolve(value))})}}return Observable.create=subscribe=>new Observable(subscribe),Observable})();function getPromiseCtor(promiseCtor){if(promiseCtor||(promiseCtor=config_config.Promise||Promise),!promiseCtor)throw new Error("no Promise impl found");return promiseCtor}function ObjectUnsubscribedErrorImpl(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}ObjectUnsubscribedErrorImpl.prototype=Object.create(Error.prototype);const ObjectUnsubscribedError=ObjectUnsubscribedErrorImpl;class SubjectSubscription_SubjectSubscription extends Subscription_Subscription{constructor(subject,subscriber){super(),this.subject=subject,this.subscriber=subscriber,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const subject=this.subject,observers=subject.observers;if(this.subject=null,!observers||0===observers.length||subject.isStopped||subject.closed)return;const subscriberIndex=observers.indexOf(this.subscriber);-1!==subscriberIndex&&observers.splice(subscriberIndex,1)}}class Subject_SubjectSubscriber extends Subscriber_Subscriber{constructor(destination){super(destination),this.destination=destination}}let Subject_Subject=(()=>{class Subject extends Observable_Observable{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[rxSubscriber](){return new Subject_SubjectSubscriber(this)}lift(operator){const subject=new Subject_AnonymousSubject(this,this);return subject.operator=operator,subject}next(value){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped){const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].next(value)}}error(err){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=err,this.isStopped=!0;const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].error(err);this.observers.length=0}complete(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(subscriber){if(this.closed)throw new ObjectUnsubscribedError;return super._trySubscribe(subscriber)}_subscribe(subscriber){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(subscriber.error(this.thrownError),Subscription_Subscription.EMPTY):this.isStopped?(subscriber.complete(),Subscription_Subscription.EMPTY):(this.observers.push(subscriber),new SubjectSubscription_SubjectSubscription(this,subscriber))}asObservable(){const observable=new Observable_Observable;return observable.source=this,observable}}return Subject.create=(destination,source)=>new Subject_AnonymousSubject(destination,source),Subject})();class Subject_AnonymousSubject extends Subject_Subject{constructor(destination,source){super(),this.destination=destination,this.source=source}next(value){const{destination:destination}=this;destination&&destination.next&&destination.next(value)}error(err){const{destination:destination}=this;destination&&destination.error&&this.destination.error(err)}complete(){const{destination:destination}=this;destination&&destination.complete&&this.destination.complete()}_subscribe(subscriber){const{source:source}=this;return source?this.source.subscribe(subscriber):Subscription_Subscription.EMPTY}}function isScheduler(value){return value&&"function"==typeof value.schedule}class InnerSubscriber_InnerSubscriber extends Subscriber_Subscriber{constructor(parent,outerValue,outerIndex){super(),this.parent=parent,this.outerValue=outerValue,this.outerIndex=outerIndex,this.index=0}_next(value){this.parent.notifyNext(this.outerValue,value,this.outerIndex,this.index++,this)}_error(error){this.parent.notifyError(error,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const subscribeToArray=array=>subscriber=>{for(let i=0,len=array.length;i<len&&!subscriber.closed;i++)subscriber.next(array[i]);subscriber.closed||subscriber.complete()},subscribeToPromise=promise=>subscriber=>(promise.then(value=>{subscriber.closed||(subscriber.next(value),subscriber.complete())},err=>subscriber.error(err)).then(null,hostReportError),subscriber);function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const iterator_iterator=getSymbolIterator(),subscribeToIterable=iterable=>subscriber=>{const iterator=iterable[iterator_iterator]();for(;;){const item=iterator.next();if(item.done){subscriber.complete();break}if(subscriber.next(item.value),subscriber.closed)break}return"function"==typeof iterator.return&&subscriber.add(()=>{iterator.return&&iterator.return()}),subscriber},subscribeToObservable=obj=>subscriber=>{const obs=obj[observable_observable]();if("function"!=typeof obs.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return obs.subscribe(subscriber)},isArrayLike=x=>x&&"number"==typeof x.length&&"function"!=typeof x;function isPromise(value){return!!value&&"function"!=typeof value.subscribe&&"function"==typeof value.then}const subscribeTo=result=>{if(result instanceof Observable_Observable)return subscriber=>result._isScalar?(subscriber.next(result.value),void subscriber.complete()):result.subscribe(subscriber);if(result&&"function"==typeof result[observable_observable])return subscribeToObservable(result);if(isArrayLike(result))return subscribeToArray(result);if(isPromise(result))return subscribeToPromise(result);if(result&&"function"==typeof result[iterator_iterator])return subscribeToIterable(result);{const value=isObject(result)?"an invalid object":`'${result}'`;throw new TypeError(`You provided ${value} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.")}};function subscribeToResult(outerSubscriber,result,outerValue,outerIndex,destination=new InnerSubscriber_InnerSubscriber(outerSubscriber,outerValue,outerIndex)){if(!destination.closed)return subscribeTo(result)(destination)}class OuterSubscriber_OuterSubscriber extends Subscriber_Subscriber{notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.destination.next(innerValue)}notifyError(error,innerSub){this.destination.error(error)}notifyComplete(innerSub){this.destination.complete()}}function map(project,thisArg){return function(source){if("function"!=typeof project)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return source.lift(new MapOperator(project,thisArg))}}class MapOperator{constructor(project,thisArg){this.project=project,this.thisArg=thisArg}call(subscriber,source){return source.subscribe(new map_MapSubscriber(subscriber,this.project,this.thisArg))}}class map_MapSubscriber extends Subscriber_Subscriber{constructor(destination,project,thisArg){super(destination),this.project=project,this.count=0,this.thisArg=thisArg||this}_next(value){let result;try{result=this.project.call(this.thisArg,value,this.count++)}catch(err){return void this.destination.error(err)}this.destination.next(result)}}function fromArray(input,scheduler){return new Observable_Observable(scheduler?subscriber=>{const sub=new Subscription_Subscription;let i=0;return sub.add(scheduler.schedule(function(){i!==input.length?(subscriber.next(input[i++]),subscriber.closed||sub.add(this.schedule())):subscriber.complete()})),sub}:subscribeToArray(input))}function from_from(input,scheduler){if(!scheduler)return input instanceof Observable_Observable?input:new Observable_Observable(subscribeTo(input));if(null!=input){if(function(input){return input&&"function"==typeof input[observable_observable]}(input))return function(input,scheduler){return new Observable_Observable(scheduler?subscriber=>{const sub=new Subscription_Subscription;return sub.add(scheduler.schedule(()=>{const observable=input[observable_observable]();sub.add(observable.subscribe({next(value){sub.add(scheduler.schedule(()=>subscriber.next(value)))},error(err){sub.add(scheduler.schedule(()=>subscriber.error(err)))},complete(){sub.add(scheduler.schedule(()=>subscriber.complete()))}}))})),sub}:subscribeToObservable(input))}(input,scheduler);if(isPromise(input))return function(input,scheduler){return new Observable_Observable(scheduler?subscriber=>{const sub=new Subscription_Subscription;return sub.add(scheduler.schedule(()=>input.then(value=>{sub.add(scheduler.schedule(()=>{subscriber.next(value),sub.add(scheduler.schedule(()=>subscriber.complete()))}))},err=>{sub.add(scheduler.schedule(()=>subscriber.error(err)))}))),sub}:subscribeToPromise(input))}(input,scheduler);if(isArrayLike(input))return fromArray(input,scheduler);if(function(input){return input&&"function"==typeof input[iterator_iterator]}(input)||"string"==typeof input)return function(input,scheduler){if(!input)throw new Error("Iterable cannot be null");return new Observable_Observable(scheduler?subscriber=>{const sub=new Subscription_Subscription;let iterator;return sub.add(()=>{iterator&&"function"==typeof iterator.return&&iterator.return()}),sub.add(scheduler.schedule(()=>{iterator=input[iterator_iterator](),sub.add(scheduler.schedule(function(){if(subscriber.closed)return;let value,done;try{const result=iterator.next();value=result.value,done=result.done}catch(err){return void subscriber.error(err)}done?subscriber.complete():(subscriber.next(value),this.schedule())}))})),sub}:subscribeToIterable(input))}(input,scheduler)}throw new TypeError((null!==input&&typeof input||input)+" is not observable")}function mergeMap(project,resultSelector,concurrent=Number.POSITIVE_INFINITY){return"function"==typeof resultSelector?source=>source.pipe(mergeMap((a,i)=>from_from(project(a,i)).pipe(map((b,ii)=>resultSelector(a,b,i,ii))),concurrent)):("number"==typeof resultSelector&&(concurrent=resultSelector),source=>source.lift(new MergeMapOperator(project,concurrent)))}class MergeMapOperator{constructor(project,concurrent=Number.POSITIVE_INFINITY){this.project=project,this.concurrent=concurrent}call(observer,source){return source.subscribe(new mergeMap_MergeMapSubscriber(observer,this.project,this.concurrent))}}class mergeMap_MergeMapSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,project,concurrent=Number.POSITIVE_INFINITY){super(destination),this.project=project,this.concurrent=concurrent,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(value){this.active<this.concurrent?this._tryNext(value):this.buffer.push(value)}_tryNext(value){let result;const index=this.index++;try{result=this.project(value,index)}catch(err){return void this.destination.error(err)}this.active++,this._innerSub(result,value,index)}_innerSub(ish,value,index){const innerSubscriber=new InnerSubscriber_InnerSubscriber(this,void 0,void 0);this.destination.add(innerSubscriber),subscribeToResult(this,ish,value,index,innerSubscriber)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.destination.next(innerValue)}notifyComplete(innerSub){const buffer=this.buffer;this.remove(innerSub),this.active--,buffer.length>0?this._next(buffer.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function identity(x){return x}function mergeAll(concurrent=Number.POSITIVE_INFINITY){return mergeMap(identity,concurrent)}function refCount(){return function(source){return source.lift(new RefCountOperator(source))}}class RefCountOperator{constructor(connectable){this.connectable=connectable}call(subscriber,source){const{connectable:connectable}=this;connectable._refCount++;const refCounter=new refCount_RefCountSubscriber(subscriber,connectable),subscription=source.subscribe(refCounter);return refCounter.closed||(refCounter.connection=connectable.connect()),subscription}}class refCount_RefCountSubscriber extends Subscriber_Subscriber{constructor(destination,connectable){super(destination),this.connectable=connectable}_unsubscribe(){const{connectable:connectable}=this;if(!connectable)return void(this.connection=null);this.connectable=null;const refCount=connectable._refCount;if(refCount<=0)return void(this.connection=null);if(connectable._refCount=refCount-1,refCount>1)return void(this.connection=null);const{connection:connection}=this,sharedConnection=connectable._connection;this.connection=null,!sharedConnection||connection&&sharedConnection!==connection||sharedConnection.unsubscribe()}}const connectableProto=class extends Observable_Observable{constructor(source,subjectFactory){super(),this.source=source,this.subjectFactory=subjectFactory,this._refCount=0,this._isComplete=!1}_subscribe(subscriber){return this.getSubject().subscribe(subscriber)}getSubject(){const subject=this._subject;return subject&&!subject.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let connection=this._connection;return connection||(this._isComplete=!1,(connection=this._connection=new Subscription_Subscription).add(this.source.subscribe(new ConnectableObservable_ConnectableSubscriber(this.getSubject(),this))),connection.closed?(this._connection=null,connection=Subscription_Subscription.EMPTY):this._connection=connection),connection}refCount(){return refCount()(this)}}.prototype,connectableObservableDescriptor={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:connectableProto._subscribe},_isComplete:{value:connectableProto._isComplete,writable:!0},getSubject:{value:connectableProto.getSubject},connect:{value:connectableProto.connect},refCount:{value:connectableProto.refCount}};class ConnectableObservable_ConnectableSubscriber extends Subject_SubjectSubscriber{constructor(destination,connectable){super(destination),this.connectable=connectable}_error(err){this._unsubscribe(),super._error(err)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const connectable=this.connectable;if(connectable){this.connectable=null;const connection=connectable._connection;connectable._refCount=0,connectable._subject=null,connectable._connection=null,connection&&connection.unsubscribe()}}}function shareSubjectFactory(){return new Subject_Subject}const PARAMETERS="__parameters__";function makeParamDecorator(name,props,parentClass){const metaCtor=function(props){return function(...args){if(props){const values=props(...args);for(const propName in values)this[propName]=values[propName]}}}(props);function ParamDecoratorFactory(...args){if(this instanceof ParamDecoratorFactory)return metaCtor.apply(this,args),this;const annotationInstance=new ParamDecoratorFactory(...args);return ParamDecorator.annotation=annotationInstance,ParamDecorator;function ParamDecorator(cls,unusedKey,index){const parameters=cls.hasOwnProperty(PARAMETERS)?cls[PARAMETERS]:Object.defineProperty(cls,PARAMETERS,{value:[]})[PARAMETERS];for(;parameters.length<=index;)parameters.push(null);return(parameters[index]=parameters[index]||[]).push(annotationInstance),cls}}return parentClass&&(ParamDecoratorFactory.prototype=Object.create(parentClass.prototype)),ParamDecoratorFactory.prototype.ngMetadataName=name,ParamDecoratorFactory.annotationCls=ParamDecoratorFactory,ParamDecoratorFactory}const Inject=makeParamDecorator("Inject",token=>({token:token})),Optional=makeParamDecorator("Optional"),Self=makeParamDecorator("Self"),SkipSelf=makeParamDecorator("SkipSelf");var InjectFlags=function(InjectFlags){return InjectFlags[InjectFlags.Default=0]="Default",InjectFlags[InjectFlags.Host=1]="Host",InjectFlags[InjectFlags.Self=2]="Self",InjectFlags[InjectFlags.SkipSelf=4]="SkipSelf",InjectFlags[InjectFlags.Optional=8]="Optional",InjectFlags}({});function getClosureSafeProperty(objWithPropertyToExtract){for(let key in objWithPropertyToExtract)if(objWithPropertyToExtract[key]===getClosureSafeProperty)return key;throw Error("Could not find renamed property on target object.")}function ɵɵdefineInjectable(opts){return{token:opts.token,providedIn:opts.providedIn||null,factory:opts.factory,value:void 0}}function getInjectableDef(type){const def=type[NG_INJECTABLE_DEF];return def&&def.token===type?def:null}const NG_INJECTABLE_DEF=getClosureSafeProperty({ngInjectableDef:getClosureSafeProperty});function stringify(token){if("string"==typeof token)return token;if(token instanceof Array)return"["+token.map(stringify).join(", ")+"]";if(null==token)return""+token;if(token.overriddenName)return`${token.overriddenName}`;if(token.name)return`${token.name}`;const res=token.toString();if(null==res)return""+res;const newLineIndex=res.indexOf("\n");return-1===newLineIndex?res:res.substring(0,newLineIndex)}const __forward_ref__=getClosureSafeProperty({__forward_ref__:getClosureSafeProperty});function forwardRef(forwardRefFn){return forwardRefFn.__forward_ref__=forwardRef,forwardRefFn.toString=function(){return stringify(this())},forwardRefFn}function resolveForwardRef(type){const fn=type;return"function"==typeof fn&&fn.hasOwnProperty(__forward_ref__)&&fn.__forward_ref__===forwardRef?fn():type}const __globalThis="undefined"!=typeof globalThis&&globalThis,__window="undefined"!=typeof window&&window,__self="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,__global="undefined"!=typeof global&&global,_global=__globalThis||__global||__window||__self;class InjectionToken{constructor(_desc,options){this._desc=_desc,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof options?this.__NG_ELEMENT_ID__=options:void 0!==options&&(this.ngInjectableDef=ɵɵdefineInjectable({token:this,providedIn:options.providedIn||"root",factory:options.factory}))}toString(){return`InjectionToken ${this._desc}`}}const INJECTOR=new InjectionToken("INJECTOR",-1),THROW_IF_NOT_FOUND=new Object,NG_TEMP_TOKEN_PATH="ngTempTokenPath",NG_TOKEN_PATH="ngTokenPath",NEW_LINE=/\n/gm,NO_NEW_LINE="ɵ",SOURCE="__source",USE_VALUE=getClosureSafeProperty({provide:String,useValue:getClosureSafeProperty});let _injectImplementation,_currentInjector=void 0;function setCurrentInjector(injector){const former=_currentInjector;return _currentInjector=injector,former}function ɵɵinject(token,flags=InjectFlags.Default){return(_injectImplementation||function(token,flags=InjectFlags.Default){if(void 0===_currentInjector)throw new Error("inject() must be called from an injection context");return null===_currentInjector?function(token,notFoundValue,flags){const injectableDef=getInjectableDef(token);if(injectableDef&&"root"==injectableDef.providedIn)return void 0===injectableDef.value?injectableDef.value=injectableDef.factory():injectableDef.value;if(flags&InjectFlags.Optional)return null;throw new Error(`Injector: NOT_FOUND [${stringify(token)}]`)}(token,0,flags):_currentInjector.get(token,flags&InjectFlags.Optional?null:void 0,flags)})(token,flags)}class NullInjector{get(token,notFoundValue=THROW_IF_NOT_FOUND){if(notFoundValue===THROW_IF_NOT_FOUND){const error=new Error(`NullInjectorError: No provider for ${stringify(token)}!`);throw error.name="NullInjectorError",error}return notFoundValue}}function formatError(text,obj,injectorErrorName,source=null){text=text&&"\n"===text.charAt(0)&&text.charAt(1)==NO_NEW_LINE?text.substr(2):text;let context=stringify(obj);if(obj instanceof Array)context=obj.map(stringify).join(" -> ");else if("object"==typeof obj){let parts=[];for(let key in obj)if(obj.hasOwnProperty(key)){let value=obj[key];parts.push(key+":"+("string"==typeof value?JSON.stringify(value):stringify(value)))}context=`{${parts.join(", ")}}`}return`${injectorErrorName}${source?"("+source+")":""}[${context}]: ${text.replace(NEW_LINE,"\n  ")}`}class NgModuleRef{}class NgModuleFactory{}function addToArray(arr,index,value){index>=arr.length?arr.push(value):arr.splice(index,0,value)}function removeFromArray(arr,index){return index>=arr.length-1?arr.pop():arr.splice(index,1)[0]}const ViewEncapsulation=function(){var ViewEncapsulation={Emulated:0,Native:1,None:2,ShadowDom:3};return ViewEncapsulation[ViewEncapsulation.Emulated]="Emulated",ViewEncapsulation[ViewEncapsulation.Native]="Native",ViewEncapsulation[ViewEncapsulation.None]="None",ViewEncapsulation[ViewEncapsulation.ShadowDom]="ShadowDom",ViewEncapsulation}(),defaultScheduler=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(_global))(),ERROR_DEBUG_CONTEXT="ngDebugContext",ERROR_ORIGINAL_ERROR="ngOriginalError",ERROR_LOGGER="ngErrorLogger";function getDebugContext(error){return error[ERROR_DEBUG_CONTEXT]}function getOriginalError(error){return error[ERROR_ORIGINAL_ERROR]}function defaultErrorLogger(console,...values){console.error(...values)}class ErrorHandler{constructor(){this._console=console}handleError(error){const originalError=this._findOriginalError(error),context=this._findContext(error),errorLogger=function(error){return error[ERROR_LOGGER]||defaultErrorLogger}(error);errorLogger(this._console,"ERROR",error),originalError&&errorLogger(this._console,"ORIGINAL ERROR",originalError),context&&errorLogger(this._console,"ERROR CONTEXT",context)}_findContext(error){return error?getDebugContext(error)?getDebugContext(error):this._findContext(getOriginalError(error)):null}_findOriginalError(error){let e=getOriginalError(error);for(;e&&getOriginalError(e);)e=getOriginalError(e);return e}}let _devMode=!0,_runModeLocked=!1;function isDevMode(){return _runModeLocked=!0,_devMode}class InertBodyHelper{constructor(defaultDoc){if(this.defaultDoc=defaultDoc,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){const inertHtml=this.inertDocument.createElement("html");this.inertDocument.appendChild(inertHtml),this.inertBodyElement=this.inertDocument.createElement("body"),inertHtml.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(_a){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(html){html="<body><remove></remove>"+html+"</body>";try{html=encodeURI(html)}catch(_a){return null}const xhr=new XMLHttpRequest;xhr.responseType="document",xhr.open("GET","data:text/html;charset=utf-8,"+html,!1),xhr.send(void 0);const body=xhr.response.body;return body.removeChild(body.firstChild),body}getInertBodyElement_DOMParser(html){html="<body><remove></remove>"+html+"</body>";try{const body=(new window.DOMParser).parseFromString(html,"text/html").body;return body.removeChild(body.firstChild),body}catch(_a){return null}}getInertBodyElement_InertDocument(html){const templateEl=this.inertDocument.createElement("template");return"content"in templateEl?(templateEl.innerHTML=html,templateEl):(this.inertBodyElement.innerHTML=html,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}stripCustomNsAttrs(el){const elAttrs=el.attributes;for(let i=elAttrs.length-1;0<i;i--){const attrName=elAttrs.item(i).name;"xmlns:ns1"!==attrName&&0!==attrName.indexOf("ns1:")||el.removeAttribute(attrName)}let childNode=el.firstChild;for(;childNode;)childNode.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(childNode),childNode=childNode.nextSibling}}const SAFE_URL_PATTERN=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:\/?#]*(?:[\/?#]|$))/gi,DATA_URL_PATTERN=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function _sanitizeUrl(url){return(url=String(url)).match(SAFE_URL_PATTERN)||url.match(DATA_URL_PATTERN)?url:(isDevMode()&&console.warn(`WARNING: sanitizing unsafe URL value ${url} (see http://g.co/ng/security#xss)`),"unsafe:"+url)}function tagSet(tags){const res={};for(const t of tags.split(","))res[t]=!0;return res}function core_merge(...sets){const res={};for(const s of sets)for(const v in s)s.hasOwnProperty(v)&&(res[v]=!0);return res}const VOID_ELEMENTS=tagSet("area,br,col,hr,img,wbr"),OPTIONAL_END_TAG_BLOCK_ELEMENTS=tagSet("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),OPTIONAL_END_TAG_INLINE_ELEMENTS=tagSet("rp,rt"),OPTIONAL_END_TAG_ELEMENTS=core_merge(OPTIONAL_END_TAG_INLINE_ELEMENTS,OPTIONAL_END_TAG_BLOCK_ELEMENTS),VALID_ELEMENTS=core_merge(VOID_ELEMENTS,core_merge(OPTIONAL_END_TAG_BLOCK_ELEMENTS,tagSet("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),core_merge(OPTIONAL_END_TAG_INLINE_ELEMENTS,tagSet("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),OPTIONAL_END_TAG_ELEMENTS),URI_ATTRS=tagSet("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),SRCSET_ATTRS=tagSet("srcset"),VALID_ATTRS=core_merge(URI_ATTRS,SRCSET_ATTRS,tagSet("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),tagSet("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),SKIP_TRAVERSING_CONTENT_IF_INVALID_ELEMENTS=tagSet("script,style,template");class SanitizingHtmlSerializer{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(el){let current=el.firstChild,traverseContent=!0;for(;current;)if(current.nodeType===Node.ELEMENT_NODE?traverseContent=this.startElement(current):current.nodeType===Node.TEXT_NODE?this.chars(current.nodeValue):this.sanitizedSomething=!0,traverseContent&&current.firstChild)current=current.firstChild;else for(;current;){current.nodeType===Node.ELEMENT_NODE&&this.endElement(current);let next=this.checkClobberedElement(current,current.nextSibling);if(next){current=next;break}current=this.checkClobberedElement(current,current.parentNode)}return this.buf.join("")}startElement(element){const tagName=element.nodeName.toLowerCase();if(!VALID_ELEMENTS.hasOwnProperty(tagName))return this.sanitizedSomething=!0,!SKIP_TRAVERSING_CONTENT_IF_INVALID_ELEMENTS.hasOwnProperty(tagName);this.buf.push("<"),this.buf.push(tagName);const elAttrs=element.attributes;for(let i=0;i<elAttrs.length;i++){const elAttr=elAttrs.item(i),attrName=elAttr.name,lower=attrName.toLowerCase();if(!VALID_ATTRS.hasOwnProperty(lower)){this.sanitizedSomething=!0;continue}let value=elAttr.value;URI_ATTRS[lower]&&(value=_sanitizeUrl(value)),SRCSET_ATTRS[lower]&&(srcset=value,value=(srcset=String(srcset)).split(",").map(srcset=>_sanitizeUrl(srcset.trim())).join(", ")),this.buf.push(" ",attrName,'="',encodeEntities(value),'"')}var srcset;return this.buf.push(">"),!0}endElement(current){const tagName=current.nodeName.toLowerCase();VALID_ELEMENTS.hasOwnProperty(tagName)&&!VOID_ELEMENTS.hasOwnProperty(tagName)&&(this.buf.push("</"),this.buf.push(tagName),this.buf.push(">"))}chars(chars){this.buf.push(encodeEntities(chars))}checkClobberedElement(node,nextNode){if(nextNode&&(node.compareDocumentPosition(nextNode)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${node.outerHTML}`);return nextNode}}const SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~ |!])/g;function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(match){return"&#"+(1024*(match.charCodeAt(0)-55296)+(match.charCodeAt(1)-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(match){return"&#"+match.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let inertBodyHelper;function getTemplateContent(el){return"content"in el&&function(el){return el.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===el.nodeName}(el)?el.content:null}const SecurityContext=function(){var SecurityContext={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return SecurityContext[SecurityContext.NONE]="NONE",SecurityContext[SecurityContext.HTML]="HTML",SecurityContext[SecurityContext.STYLE]="STYLE",SecurityContext[SecurityContext.SCRIPT]="SCRIPT",SecurityContext[SecurityContext.URL]="URL",SecurityContext[SecurityContext.RESOURCE_URL]="RESOURCE_URL",SecurityContext}();class Sanitizer{}const SAFE_STYLE_VALUE=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),URL_RE=/^url\(([^)]+)\)$/,CAMEL_CASE_REGEXP=/([A-Z])/g;function normalizeDebugBindingValue(value){try{return null!=value?value.toString().slice(0,30):value}catch(e){return"[ERROR] Exception while trying to serialize the value"}}let ChangeDetectorRef=(()=>{class ChangeDetectorRef{}return ChangeDetectorRef.__NG_ELEMENT_ID__=()=>SWITCH_CHANGE_DETECTOR_REF_FACTORY(),ChangeDetectorRef})();const SWITCH_CHANGE_DETECTOR_REF_FACTORY=(...args)=>{},APP_ROOT=new InjectionToken("The presence of this token marks an injector as being the root injector."),INJECTOR_IMPL=function(providers,parent,name){return new StaticInjector(providers,parent,name)};let Injector=(()=>{class Injector{static create(options,parent){return Array.isArray(options)?INJECTOR_IMPL(options,parent,""):INJECTOR_IMPL(options.providers,options.parent,options.name||"")}}return Injector.THROW_IF_NOT_FOUND=THROW_IF_NOT_FOUND,Injector.NULL=new NullInjector,Injector.ngInjectableDef=ɵɵdefineInjectable({token:Injector,providedIn:"any",factory:()=>ɵɵinject(INJECTOR)}),Injector.__NG_ELEMENT_ID__=-1,Injector})();const IDENT=function(value){return value},EMPTY=[],CIRCULAR$1=IDENT,MULTI_PROVIDER_FN=function(){return Array.prototype.slice.call(arguments)},NO_NEW_LINE$1="ɵ";class StaticInjector{constructor(providers,parent=Injector.NULL,source=null){this.parent=parent,this.source=source;const records=this._records=new Map;records.set(Injector,{token:Injector,fn:IDENT,deps:EMPTY,value:this,useNew:!1}),records.set(INJECTOR,{token:INJECTOR,fn:IDENT,deps:EMPTY,value:this,useNew:!1}),function recursivelyProcessProviders(records,provider){if(provider)if((provider=resolveForwardRef(provider))instanceof Array)for(let i=0;i<provider.length;i++)recursivelyProcessProviders(records,provider[i]);else{if("function"==typeof provider)throw staticError("Function/Class not supported",provider);if(!provider||"object"!=typeof provider||!provider.provide)throw staticError("Unexpected provider",provider);{let token=resolveForwardRef(provider.provide);const resolvedProvider=function(provider){const deps=function(provider){let deps=EMPTY;const providerDeps=provider.deps;if(providerDeps&&providerDeps.length){deps=[];for(let i=0;i<providerDeps.length;i++){let options=6,token=resolveForwardRef(providerDeps[i]);if(token instanceof Array)for(let j=0,annotations=token;j<annotations.length;j++){const annotation=annotations[j];annotation instanceof Optional||annotation==Optional?options|=1:annotation instanceof SkipSelf||annotation==SkipSelf?options&=-3:annotation instanceof Self||annotation==Self?options&=-5:token=annotation instanceof Inject?annotation.token:resolveForwardRef(annotation)}deps.push({token:token,options:options})}}else if(provider.useExisting)deps=[{token:resolveForwardRef(provider.useExisting),options:6}];else if(!(providerDeps||USE_VALUE in provider))throw staticError("'deps' required",provider);return deps}(provider);let fn=IDENT,value=EMPTY,useNew=!1,provide=resolveForwardRef(provider.provide);if(USE_VALUE in provider)value=provider.useValue;else if(provider.useFactory)fn=provider.useFactory;else if(provider.useExisting);else if(provider.useClass)useNew=!0,fn=resolveForwardRef(provider.useClass);else{if("function"!=typeof provide)throw staticError("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",provider);useNew=!0,fn=provide}return{deps:deps,fn:fn,useNew:useNew,value:value}}(provider);if(!0===provider.multi){let multiProvider=records.get(token);if(multiProvider){if(multiProvider.fn!==MULTI_PROVIDER_FN)throw multiProviderMixError(token)}else records.set(token,multiProvider={token:provider.provide,deps:[],useNew:!1,fn:MULTI_PROVIDER_FN,value:EMPTY});multiProvider.deps.push({token:token=provider,options:6})}const record=records.get(token);if(record&&record.fn==MULTI_PROVIDER_FN)throw multiProviderMixError(token);records.set(token,resolvedProvider)}}}(records,providers)}get(token,notFoundValue,flags=InjectFlags.Default){const record=this._records.get(token);try{return function tryResolveToken(token,record,records,parent,notFoundValue,flags){try{return function(token,record,records,parent,notFoundValue,flags){let value;if(!record||flags&InjectFlags.SkipSelf)flags&InjectFlags.Self||(value=parent.get(token,notFoundValue,InjectFlags.Default));else{if((value=record.value)==CIRCULAR$1)throw Error(NO_NEW_LINE$1+"Circular dependency");if(value===EMPTY){record.value=CIRCULAR$1;let obj=void 0,useNew=record.useNew,fn=record.fn,depRecords=record.deps,deps=EMPTY;if(depRecords.length){deps=[];for(let i=0;i<depRecords.length;i++){const depRecord=depRecords[i],options=depRecord.options,childRecord=2&options?records.get(depRecord.token):void 0;deps.push(tryResolveToken(depRecord.token,childRecord,records,childRecord||4&options?parent:Injector.NULL,1&options?null:Injector.THROW_IF_NOT_FOUND,InjectFlags.Default))}}record.value=value=useNew?new fn(...deps):fn.apply(obj,deps)}}return value}(token,record,records,parent,notFoundValue,flags)}catch(e){throw e instanceof Error||(e=new Error(e)),(e[NG_TEMP_TOKEN_PATH]=e[NG_TEMP_TOKEN_PATH]||[]).unshift(token),record&&record.value==CIRCULAR$1&&(record.value=EMPTY),e}}(token,record,this._records,this.parent,notFoundValue,flags)}catch(e){return function(e,token,injectorErrorName,source){const tokenPath=e[NG_TEMP_TOKEN_PATH];throw token[SOURCE]&&tokenPath.unshift(token[SOURCE]),e.message=formatError("\n"+e.message,tokenPath,"StaticInjectorError",source),e[NG_TOKEN_PATH]=tokenPath,e[NG_TEMP_TOKEN_PATH]=null,e}(e,token,0,this.source)}}toString(){const tokens=[];return this._records.forEach((v,token)=>tokens.push(stringify(token))),`StaticInjector[${tokens.join(", ")}]`}}function multiProviderMixError(token){return staticError("Cannot mix multi providers and regular providers",token)}function staticError(text,obj){return new Error(formatError(text,obj,"StaticInjectorError"))}const ANALYZE_FOR_ENTRY_COMPONENTS=new InjectionToken("AnalyzeForEntryComponents");let _symbolIterator=null;function core_getSymbolIterator(){if(!_symbolIterator){const Symbol=_global.Symbol;if(Symbol&&Symbol.iterator)_symbolIterator=Symbol.iterator;else{const keys=Object.getOwnPropertyNames(Map.prototype);for(let i=0;i<keys.length;++i){const key=keys[i];"entries"!==key&&"size"!==key&&Map.prototype[key]===Map.prototype.entries&&(_symbolIterator=key)}}}return _symbolIterator}function looseIdentical(a,b){return a===b||"number"==typeof a&&"number"==typeof b&&isNaN(a)&&isNaN(b)}function devModeEqual$1(a,b){const isListLikeIterableA=isListLikeIterable$1(a),isListLikeIterableB=isListLikeIterable$1(b);if(isListLikeIterableA&&isListLikeIterableB)return function(a,b,comparator){const iterator1=a[core_getSymbolIterator()](),iterator2=b[core_getSymbolIterator()]();for(;;){const item1=iterator1.next(),item2=iterator2.next();if(item1.done&&item2.done)return!0;if(item1.done||item2.done)return!1;if(!comparator(item1.value,item2.value))return!1}}(a,b,devModeEqual$1);{const isAObject=a&&("object"==typeof a||"function"==typeof a),isBObject=b&&("object"==typeof b||"function"==typeof b);return!(isListLikeIterableA||!isAObject||isListLikeIterableB||!isBObject)||looseIdentical(a,b)}}class WrappedValue{constructor(value){this.wrapped=value}static wrap(value){return new WrappedValue(value)}static unwrap(value){return WrappedValue.isWrapped(value)?value.wrapped:value}static isWrapped(value){return value instanceof WrappedValue}}function isListLikeIterable$1(obj){return!!isJsObject$1(obj)&&(Array.isArray(obj)||!(obj instanceof Map)&&core_getSymbolIterator()in obj)}function isJsObject$1(o){return null!==o&&("function"==typeof o||"object"==typeof o)}function core_isPromise(obj){return!!obj&&"function"==typeof obj.then}function isObservable(obj){return!!obj&&"function"==typeof obj.subscribe}class SimpleChange{constructor(previousValue,currentValue,firstChange){this.previousValue=previousValue,this.currentValue=currentValue,this.firstChange=firstChange}isFirstChange(){return this.firstChange}}class ComponentRef{}class ComponentFactory{}function noComponentFactoryError(component){const error=Error(`No component factory found for ${stringify(component)}. Did you add it to @NgModule.entryComponents?`);return error[ERROR_COMPONENT]=component,error}const ERROR_COMPONENT="ngComponent";class _NullComponentFactoryResolver{resolveComponentFactory(component){throw noComponentFactoryError(component)}}let ComponentFactoryResolver=(()=>{class ComponentFactoryResolver{}return ComponentFactoryResolver.NULL=new _NullComponentFactoryResolver,ComponentFactoryResolver})();class CodegenComponentFactoryResolver{constructor(factories,_parent,_ngModule){this._parent=_parent,this._ngModule=_ngModule,this._factories=new Map;for(let i=0;i<factories.length;i++){const factory=factories[i];this._factories.set(factory.componentType,factory)}}resolveComponentFactory(component){let factory=this._factories.get(component);if(!factory&&this._parent&&(factory=this._parent.resolveComponentFactory(component)),!factory)throw noComponentFactoryError(component);return new ComponentFactoryBoundToModule(factory,this._ngModule)}}class ComponentFactoryBoundToModule extends ComponentFactory{constructor(factory,ngModule){super(),this.factory=factory,this.ngModule=ngModule,this.selector=factory.selector,this.componentType=factory.componentType,this.ngContentSelectors=factory.ngContentSelectors,this.inputs=factory.inputs,this.outputs=factory.outputs}create(injector,projectableNodes,rootSelectorOrNode,ngModule){return this.factory.create(injector,projectableNodes,rootSelectorOrNode,ngModule||this.ngModule)}}function core_noop(...args){}let ElementRef=(()=>{class ElementRef{constructor(nativeElement){this.nativeElement=nativeElement}}return ElementRef.__NG_ELEMENT_ID__=()=>SWITCH_ELEMENT_REF_FACTORY(ElementRef),ElementRef})();const SWITCH_ELEMENT_REF_FACTORY=core_noop;class Renderer{}class RendererFactory2{}const RendererStyleFlags2=function(){var RendererStyleFlags2={Important:1,DashCase:2};return RendererStyleFlags2[RendererStyleFlags2.Important]="Important",RendererStyleFlags2[RendererStyleFlags2.DashCase]="DashCase",RendererStyleFlags2}();let Renderer2=(()=>{class Renderer2{}return Renderer2.__NG_ELEMENT_ID__=()=>SWITCH_RENDERER2_FACTORY(),Renderer2})();const SWITCH_RENDERER2_FACTORY=core_noop;class Version{constructor(full){this.full=full,this.major=full.split(".")[0],this.minor=full.split(".")[1],this.patch=full.split(".").slice(2).join(".")}}const VERSION=new Version("8.2.5");class DefaultIterableDifferFactory{constructor(){}supports(obj){return isListLikeIterable$1(obj)}create(trackByFn){return new DefaultIterableDiffer(trackByFn)}}const trackByIdentity=(index,item)=>item;class DefaultIterableDiffer{constructor(trackByFn){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=trackByFn||trackByIdentity}forEachItem(fn){let record;for(record=this._itHead;null!==record;record=record._next)fn(record)}forEachOperation(fn){let nextIt=this._itHead,nextRemove=this._removalsHead,addRemoveOffset=0,moveOffsets=null;for(;nextIt||nextRemove;){const record=!nextRemove||nextIt&&nextIt.currentIndex<getPreviousIndex(nextRemove,addRemoveOffset,moveOffsets)?nextIt:nextRemove,adjPreviousIndex=getPreviousIndex(record,addRemoveOffset,moveOffsets),currentIndex=record.currentIndex;if(record===nextRemove)addRemoveOffset--,nextRemove=nextRemove._nextRemoved;else if(nextIt=nextIt._next,null==record.previousIndex)addRemoveOffset++;else{moveOffsets||(moveOffsets=[]);const localMovePreviousIndex=adjPreviousIndex-addRemoveOffset,localCurrentIndex=currentIndex-addRemoveOffset;if(localMovePreviousIndex!=localCurrentIndex){for(let i=0;i<localMovePreviousIndex;i++){const offset=i<moveOffsets.length?moveOffsets[i]:moveOffsets[i]=0,index=offset+i;localCurrentIndex<=index&&index<localMovePreviousIndex&&(moveOffsets[i]=offset+1)}moveOffsets[record.previousIndex]=localCurrentIndex-localMovePreviousIndex}}adjPreviousIndex!==currentIndex&&fn(record,adjPreviousIndex,currentIndex)}}forEachPreviousItem(fn){let record;for(record=this._previousItHead;null!==record;record=record._nextPrevious)fn(record)}forEachAddedItem(fn){let record;for(record=this._additionsHead;null!==record;record=record._nextAdded)fn(record)}forEachMovedItem(fn){let record;for(record=this._movesHead;null!==record;record=record._nextMoved)fn(record)}forEachRemovedItem(fn){let record;for(record=this._removalsHead;null!==record;record=record._nextRemoved)fn(record)}forEachIdentityChange(fn){let record;for(record=this._identityChangesHead;null!==record;record=record._nextIdentityChange)fn(record)}diff(collection){if(null==collection&&(collection=[]),!isListLikeIterable$1(collection))throw new Error(`Error trying to diff '${stringify(collection)}'. Only arrays and iterables are allowed`);return this.check(collection)?this:null}onDestroy(){}check(collection){this._reset();let index,item,itemTrackBy,record=this._itHead,mayBeDirty=!1;if(Array.isArray(collection)){this.length=collection.length;for(let index=0;index<this.length;index++)itemTrackBy=this._trackByFn(index,item=collection[index]),null!==record&&looseIdentical(record.trackById,itemTrackBy)?(mayBeDirty&&(record=this._verifyReinsertion(record,item,itemTrackBy,index)),looseIdentical(record.item,item)||this._addIdentityChange(record,item)):(record=this._mismatch(record,item,itemTrackBy,index),mayBeDirty=!0),record=record._next}else index=0,function(obj,fn){if(Array.isArray(obj))for(let i=0;i<obj.length;i++)fn(obj[i]);else{const iterator=obj[core_getSymbolIterator()]();let item;for(;!(item=iterator.next()).done;)fn(item.value)}}(collection,item=>{itemTrackBy=this._trackByFn(index,item),null!==record&&looseIdentical(record.trackById,itemTrackBy)?(mayBeDirty&&(record=this._verifyReinsertion(record,item,itemTrackBy,index)),looseIdentical(record.item,item)||this._addIdentityChange(record,item)):(record=this._mismatch(record,item,itemTrackBy,index),mayBeDirty=!0),record=record._next,index++}),this.length=index;return this._truncate(record),this.collection=collection,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let record,nextRecord;for(record=this._previousItHead=this._itHead;null!==record;record=record._next)record._nextPrevious=record._next;for(record=this._additionsHead;null!==record;record=record._nextAdded)record.previousIndex=record.currentIndex;for(this._additionsHead=this._additionsTail=null,record=this._movesHead;null!==record;record=nextRecord)record.previousIndex=record.currentIndex,nextRecord=record._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(record,item,itemTrackBy,index){let previousRecord;return null===record?previousRecord=this._itTail:(previousRecord=record._prev,this._remove(record)),null!==(record=null===this._linkedRecords?null:this._linkedRecords.get(itemTrackBy,index))?(looseIdentical(record.item,item)||this._addIdentityChange(record,item),this._moveAfter(record,previousRecord,index)):null!==(record=null===this._unlinkedRecords?null:this._unlinkedRecords.get(itemTrackBy,null))?(looseIdentical(record.item,item)||this._addIdentityChange(record,item),this._reinsertAfter(record,previousRecord,index)):record=this._addAfter(new IterableChangeRecord_(item,itemTrackBy),previousRecord,index),record}_verifyReinsertion(record,item,itemTrackBy,index){let reinsertRecord=null===this._unlinkedRecords?null:this._unlinkedRecords.get(itemTrackBy,null);return null!==reinsertRecord?record=this._reinsertAfter(reinsertRecord,record._prev,index):record.currentIndex!=index&&(record.currentIndex=index,this._addToMoves(record,index)),record}_truncate(record){for(;null!==record;){const nextRecord=record._next;this._addToRemovals(this._unlink(record)),record=nextRecord}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(record,prevRecord,index){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(record);const prev=record._prevRemoved,next=record._nextRemoved;return null===prev?this._removalsHead=next:prev._nextRemoved=next,null===next?this._removalsTail=prev:next._prevRemoved=prev,this._insertAfter(record,prevRecord,index),this._addToMoves(record,index),record}_moveAfter(record,prevRecord,index){return this._unlink(record),this._insertAfter(record,prevRecord,index),this._addToMoves(record,index),record}_addAfter(record,prevRecord,index){return this._insertAfter(record,prevRecord,index),this._additionsTail=null===this._additionsTail?this._additionsHead=record:this._additionsTail._nextAdded=record,record}_insertAfter(record,prevRecord,index){const next=null===prevRecord?this._itHead:prevRecord._next;return record._next=next,record._prev=prevRecord,null===next?this._itTail=record:next._prev=record,null===prevRecord?this._itHead=record:prevRecord._next=record,null===this._linkedRecords&&(this._linkedRecords=new _DuplicateMap),this._linkedRecords.put(record),record.currentIndex=index,record}_remove(record){return this._addToRemovals(this._unlink(record))}_unlink(record){null!==this._linkedRecords&&this._linkedRecords.remove(record);const prev=record._prev,next=record._next;return null===prev?this._itHead=next:prev._next=next,null===next?this._itTail=prev:next._prev=prev,record}_addToMoves(record,toIndex){return record.previousIndex===toIndex?record:(this._movesTail=null===this._movesTail?this._movesHead=record:this._movesTail._nextMoved=record,record)}_addToRemovals(record){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _DuplicateMap),this._unlinkedRecords.put(record),record.currentIndex=null,record._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=record,record._prevRemoved=null):(record._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=record),record}_addIdentityChange(record,item){return record.item=item,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=record:this._identityChangesTail._nextIdentityChange=record,record}}class IterableChangeRecord_{constructor(item,trackById){this.item=item,this.trackById=trackById,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class _DuplicateItemRecordList{constructor(){this._head=null,this._tail=null}add(record){null===this._head?(this._head=this._tail=record,record._nextDup=null,record._prevDup=null):(this._tail._nextDup=record,record._prevDup=this._tail,record._nextDup=null,this._tail=record)}get(trackById,atOrAfterIndex){let record;for(record=this._head;null!==record;record=record._nextDup)if((null===atOrAfterIndex||atOrAfterIndex<=record.currentIndex)&&looseIdentical(record.trackById,trackById))return record;return null}remove(record){const prev=record._prevDup,next=record._nextDup;return null===prev?this._head=next:prev._nextDup=next,null===next?this._tail=prev:next._prevDup=prev,null===this._head}}class _DuplicateMap{constructor(){this.map=new Map}put(record){const key=record.trackById;let duplicates=this.map.get(key);duplicates||(duplicates=new _DuplicateItemRecordList,this.map.set(key,duplicates)),duplicates.add(record)}get(trackById,atOrAfterIndex){const recordList=this.map.get(trackById);return recordList?recordList.get(trackById,atOrAfterIndex):null}remove(record){const key=record.trackById;return this.map.get(key).remove(record)&&this.map.delete(key),record}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function getPreviousIndex(item,addRemoveOffset,moveOffsets){const previousIndex=item.previousIndex;if(null===previousIndex)return previousIndex;let moveOffset=0;return moveOffsets&&previousIndex<moveOffsets.length&&(moveOffset=moveOffsets[previousIndex]),previousIndex+addRemoveOffset+moveOffset}class DefaultKeyValueDifferFactory{constructor(){}supports(obj){return obj instanceof Map||isJsObject$1(obj)}create(){return new DefaultKeyValueDiffer}}class DefaultKeyValueDiffer{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(fn){let record;for(record=this._mapHead;null!==record;record=record._next)fn(record)}forEachPreviousItem(fn){let record;for(record=this._previousMapHead;null!==record;record=record._nextPrevious)fn(record)}forEachChangedItem(fn){let record;for(record=this._changesHead;null!==record;record=record._nextChanged)fn(record)}forEachAddedItem(fn){let record;for(record=this._additionsHead;null!==record;record=record._nextAdded)fn(record)}forEachRemovedItem(fn){let record;for(record=this._removalsHead;null!==record;record=record._nextRemoved)fn(record)}diff(map){if(map){if(!(map instanceof Map||isJsObject$1(map)))throw new Error(`Error trying to diff '${stringify(map)}'. Only maps and objects are allowed`)}else map=new Map;return this.check(map)?this:null}onDestroy(){}check(map){this._reset();let insertBefore=this._mapHead;if(this._appendAfter=null,this._forEach(map,(value,key)=>{if(insertBefore&&insertBefore.key===key)this._maybeAddToChanges(insertBefore,value),this._appendAfter=insertBefore,insertBefore=insertBefore._next;else{const record=this._getOrCreateRecordForKey(key,value);insertBefore=this._insertBeforeOrAppend(insertBefore,record)}}),insertBefore){insertBefore._prev&&(insertBefore._prev._next=null),this._removalsHead=insertBefore;for(let record=insertBefore;null!==record;record=record._nextRemoved)record===this._mapHead&&(this._mapHead=null),this._records.delete(record.key),record._nextRemoved=record._next,record.previousValue=record.currentValue,record.currentValue=null,record._prev=null,record._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(before,record){if(before){const prev=before._prev;return record._next=before,record._prev=prev,before._prev=record,prev&&(prev._next=record),before===this._mapHead&&(this._mapHead=record),this._appendAfter=before,before}return this._appendAfter?(this._appendAfter._next=record,record._prev=this._appendAfter):this._mapHead=record,this._appendAfter=record,null}_getOrCreateRecordForKey(key,value){if(this._records.has(key)){const record=this._records.get(key);this._maybeAddToChanges(record,value);const prev=record._prev,next=record._next;return prev&&(prev._next=next),next&&(next._prev=prev),record._next=null,record._prev=null,record}const record=new KeyValueChangeRecord_(key);return this._records.set(key,record),record.currentValue=value,this._addToAdditions(record),record}_reset(){if(this.isDirty){let record;for(this._previousMapHead=this._mapHead,record=this._previousMapHead;null!==record;record=record._next)record._nextPrevious=record._next;for(record=this._changesHead;null!==record;record=record._nextChanged)record.previousValue=record.currentValue;for(record=this._additionsHead;null!=record;record=record._nextAdded)record.previousValue=record.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(record,newValue){looseIdentical(newValue,record.currentValue)||(record.previousValue=record.currentValue,record.currentValue=newValue,this._addToChanges(record))}_addToAdditions(record){null===this._additionsHead?this._additionsHead=this._additionsTail=record:(this._additionsTail._nextAdded=record,this._additionsTail=record)}_addToChanges(record){null===this._changesHead?this._changesHead=this._changesTail=record:(this._changesTail._nextChanged=record,this._changesTail=record)}_forEach(obj,fn){obj instanceof Map?obj.forEach(fn):Object.keys(obj).forEach(k=>fn(obj[k],k))}}class KeyValueChangeRecord_{constructor(key){this.key=key,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let IterableDiffers=(()=>{class IterableDiffers{constructor(factories){this.factories=factories}static create(factories,parent){if(null!=parent){const copied=parent.factories.slice();factories=factories.concat(copied)}return new IterableDiffers(factories)}static extend(factories){return{provide:IterableDiffers,useFactory:parent=>{if(!parent)throw new Error("Cannot extend IterableDiffers without a parent injector");return IterableDiffers.create(factories,parent)},deps:[[IterableDiffers,new SkipSelf,new Optional]]}}find(iterable){const factory=this.factories.find(f=>f.supports(iterable));if(null!=factory)return factory;throw new Error(`Cannot find a differ supporting object '${iterable}' of type '${type=iterable,type.name||typeof type}'`);var type}}return IterableDiffers.ngInjectableDef=ɵɵdefineInjectable({token:IterableDiffers,providedIn:"root",factory:()=>new IterableDiffers([new DefaultIterableDifferFactory])}),IterableDiffers})(),KeyValueDiffers=(()=>{class KeyValueDiffers{constructor(factories){this.factories=factories}static create(factories,parent){if(parent){const copied=parent.factories.slice();factories=factories.concat(copied)}return new KeyValueDiffers(factories)}static extend(factories){return{provide:KeyValueDiffers,useFactory:parent=>{if(!parent)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return KeyValueDiffers.create(factories,parent)},deps:[[KeyValueDiffers,new SkipSelf,new Optional]]}}find(kv){const factory=this.factories.find(f=>f.supports(kv));if(factory)return factory;throw new Error(`Cannot find a differ supporting object '${kv}'`)}}return KeyValueDiffers.ngInjectableDef=ɵɵdefineInjectable({token:KeyValueDiffers,providedIn:"root",factory:()=>new KeyValueDiffers([new DefaultKeyValueDifferFactory])}),KeyValueDiffers})();const keyValDiff=[new DefaultKeyValueDifferFactory],defaultIterableDiffers=new IterableDiffers([new DefaultIterableDifferFactory]),defaultKeyValueDiffers=new KeyValueDiffers(keyValDiff);let TemplateRef=(()=>{class TemplateRef{}return TemplateRef.__NG_ELEMENT_ID__=()=>SWITCH_TEMPLATE_REF_FACTORY(TemplateRef,ElementRef),TemplateRef})();const SWITCH_TEMPLATE_REF_FACTORY=core_noop;let ViewContainerRef=(()=>{class ViewContainerRef{}return ViewContainerRef.__NG_ELEMENT_ID__=()=>SWITCH_VIEW_CONTAINER_REF_FACTORY(ViewContainerRef,ElementRef),ViewContainerRef})();const SWITCH_VIEW_CONTAINER_REF_FACTORY=core_noop;function expressionChangedAfterItHasBeenCheckedError(context,oldValue,currValue,isFirstCheck){let msg=`ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '${oldValue}'. Current value: '${currValue}'.`;return isFirstCheck&&(msg+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(msg,context){const err=new Error(msg);return _addDebugContext(err,context),err}(msg,context)}function _addDebugContext(err,context){err[ERROR_DEBUG_CONTEXT]=context,err[ERROR_LOGGER]=context.logError.bind(context)}function viewDestroyedError(action){return new Error(`ViewDestroyedError: Attempt to use a destroyed view: ${action}`)}function shiftInitState(view,priorInitState,newInitState){const state=view.state,initState=1792&state;return initState===priorInitState?(view.state=-1793&state|newInitState,view.initIndex=-1,!0):initState===newInitState}function shouldCallLifecycleInitHook(view,initState,index){return(1792&view.state)===initState&&view.initIndex<=index&&(view.initIndex=index+1,!0)}function asTextData(view,index){return view.nodes[index]}function asElementData(view,index){return view.nodes[index]}function asProviderData(view,index){return view.nodes[index]}function asPureExpressionData(view,index){return view.nodes[index]}function asQueryList(view,index){return view.nodes[index]}const Services={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},NOOP=()=>{},_tokenKeyCache=new Map;function tokenKey(token){let key=_tokenKeyCache.get(token);return key||(key=stringify(token)+"_"+_tokenKeyCache.size,_tokenKeyCache.set(token,key)),key}const UNDEFINED_RENDERER_TYPE_ID="$$undefined",EMPTY_RENDERER_TYPE_ID="$$empty";function createRendererType2(values){return{id:UNDEFINED_RENDERER_TYPE_ID,styles:values.styles,encapsulation:values.encapsulation,data:values.data}}let _renderCompCount$1=0;function checkBinding(view,def,bindingIdx,value){return!(!(2&view.state)&&looseIdentical(view.oldValues[def.bindingIndex+bindingIdx],value))}function checkAndUpdateBinding(view,def,bindingIdx,value){return!!checkBinding(view,def,bindingIdx,value)&&(view.oldValues[def.bindingIndex+bindingIdx]=value,!0)}function checkBindingNoChanges(view,def,bindingIdx,value){const oldValue=view.oldValues[def.bindingIndex+bindingIdx];if(1&view.state||!devModeEqual$1(oldValue,value)){const bindingName=def.bindings[bindingIdx].name;throw expressionChangedAfterItHasBeenCheckedError(Services.createDebugContext(view,def.nodeIndex),`${bindingName}: ${oldValue}`,`${bindingName}: ${value}`,0!=(1&view.state))}}function markParentViewsForCheck(view){let currView=view;for(;currView;)2&currView.def.flags&&(currView.state|=8),currView=currView.viewContainerParent||currView.parent}function markParentViewsForCheckProjectedViews(view,endView){let currView=view;for(;currView&&currView!==endView;)currView.state|=64,currView=currView.viewContainerParent||currView.parent}function dispatchEvent(view,nodeIndex,eventName,event){try{return markParentViewsForCheck(33554432&view.def.nodes[nodeIndex].flags?asElementData(view,nodeIndex).componentView:view),Services.handleEvent(view,nodeIndex,eventName,event)}catch(e){view.root.errorHandler.handleError(e)}}function declaredViewContainer(view){return view.parent?asElementData(view.parent,view.parentNodeDef.nodeIndex):null}function viewParentEl(view){return view.parent?view.parentNodeDef.parent:null}function renderNode(view,def){switch(201347067&def.flags){case 1:return asElementData(view,def.nodeIndex).renderElement;case 2:return asTextData(view,def.nodeIndex).renderText}}function isComponentView(view){return!!view.parent&&!!(32768&view.parentNodeDef.flags)}function isEmbeddedView(view){return!(!view.parent||32768&view.parentNodeDef.flags)}function filterQueryId(queryId){return 1<<queryId%32}function splitMatchedQueriesDsl(matchedQueriesDsl){const matchedQueries={};let matchedQueryIds=0;const references={};return matchedQueriesDsl&&matchedQueriesDsl.forEach(([queryId,valueType])=>{"number"==typeof queryId?(matchedQueries[queryId]=valueType,matchedQueryIds|=filterQueryId(queryId)):references[queryId]=valueType}),{matchedQueries:matchedQueries,references:references,matchedQueryIds:matchedQueryIds}}function splitDepsDsl(deps,sourceName){return deps.map(value=>{let token,flags;return Array.isArray(value)?[flags,token]=value:(flags=0,token=value),token&&("function"==typeof token||"object"==typeof token)&&sourceName&&Object.defineProperty(token,SOURCE,{value:sourceName,configurable:!0}),{flags:flags,token:token,tokenKey:tokenKey(token)}})}function getParentRenderElement(view,renderHost,def){let renderParent=def.renderParent;return renderParent?0==(1&renderParent.flags)||0==(33554432&renderParent.flags)||renderParent.element.componentRendererType&&renderParent.element.componentRendererType.encapsulation===ViewEncapsulation.Native?asElementData(view,def.renderParent.nodeIndex).renderElement:void 0:renderHost}const DEFINITION_CACHE=new WeakMap;function resolveDefinition(factory){let value=DEFINITION_CACHE.get(factory);return value||((value=factory(()=>NOOP)).factory=factory,DEFINITION_CACHE.set(factory,value)),value}function visitRootRenderNodes(view,action,parentNode,nextSibling,target){3===action&&(parentNode=view.renderer.parentNode(renderNode(view,view.def.lastRenderRootNode))),visitSiblingRenderNodes(view,action,0,view.def.nodes.length-1,parentNode,nextSibling,target)}function visitSiblingRenderNodes(view,action,startIndex,endIndex,parentNode,nextSibling,target){for(let i=startIndex;i<=endIndex;i++){const nodeDef=view.def.nodes[i];11&nodeDef.flags&&visitRenderNode(view,nodeDef,action,parentNode,nextSibling,target),i+=nodeDef.childCount}}function visitProjectedRenderNodes(view,ngContentIndex,action,parentNode,nextSibling,target){let compView=view;for(;compView&&!isComponentView(compView);)compView=compView.parent;const hostView=compView.parent,hostElDef=viewParentEl(compView),endIndex=hostElDef.nodeIndex+hostElDef.childCount;for(let i=hostElDef.nodeIndex+1;i<=endIndex;i++){const nodeDef=hostView.def.nodes[i];nodeDef.ngContentIndex===ngContentIndex&&visitRenderNode(hostView,nodeDef,action,parentNode,nextSibling,target),i+=nodeDef.childCount}if(!hostView.parent){const projectedNodes=view.root.projectableNodes[ngContentIndex];if(projectedNodes)for(let i=0;i<projectedNodes.length;i++)execRenderNodeAction(view,projectedNodes[i],action,parentNode,nextSibling,target)}}function visitRenderNode(view,nodeDef,action,parentNode,nextSibling,target){if(8&nodeDef.flags)visitProjectedRenderNodes(view,nodeDef.ngContent.index,action,parentNode,nextSibling,target);else{const rn=renderNode(view,nodeDef);if(3===action&&33554432&nodeDef.flags&&48&nodeDef.bindingFlags?(16&nodeDef.bindingFlags&&execRenderNodeAction(view,rn,action,parentNode,nextSibling,target),32&nodeDef.bindingFlags&&execRenderNodeAction(asElementData(view,nodeDef.nodeIndex).componentView,rn,action,parentNode,nextSibling,target)):execRenderNodeAction(view,rn,action,parentNode,nextSibling,target),16777216&nodeDef.flags){const embeddedViews=asElementData(view,nodeDef.nodeIndex).viewContainer._embeddedViews;for(let k=0;k<embeddedViews.length;k++)visitRootRenderNodes(embeddedViews[k],action,parentNode,nextSibling,target)}1&nodeDef.flags&&!nodeDef.element.name&&visitSiblingRenderNodes(view,action,nodeDef.nodeIndex+1,nodeDef.nodeIndex+nodeDef.childCount,parentNode,nextSibling,target)}}function execRenderNodeAction(view,renderNode,action,parentNode,nextSibling,target){const renderer=view.renderer;switch(action){case 1:renderer.appendChild(parentNode,renderNode);break;case 2:renderer.insertBefore(parentNode,renderNode,nextSibling);break;case 3:renderer.removeChild(parentNode,renderNode);break;case 0:target.push(renderNode)}}const NS_PREFIX_RE=/^:([^:]+):(.+)$/;function splitNamespace(name){if(":"===name[0]){const match=name.match(NS_PREFIX_RE);return[match[1],match[2]]}return["",name]}function calcBindingFlags(bindings){let flags=0;for(let i=0;i<bindings.length;i++)flags|=bindings[i].flags;return flags}const UNDEFINED_VALUE=new Object,InjectorRefTokenKey=tokenKey(Injector),INJECTORRefTokenKey=tokenKey(INJECTOR),NgModuleRefTokenKey=tokenKey(NgModuleRef);function moduleProvideDef(flags,token,value,deps){return value=resolveForwardRef(value),{index:-1,deps:splitDepsDsl(deps,stringify(token)),flags:flags,token:token,value:value}}function resolveNgModuleDep(data,depDef,notFoundValue=Injector.THROW_IF_NOT_FOUND){const former=setCurrentInjector(data);try{if(8&depDef.flags)return depDef.token;if(2&depDef.flags&&(notFoundValue=null),1&depDef.flags)return data._parent.get(depDef.token,notFoundValue);const tokenKey=depDef.tokenKey;switch(tokenKey){case InjectorRefTokenKey:case INJECTORRefTokenKey:case NgModuleRefTokenKey:return data}const providerDef=data._def.providersByKey[tokenKey];let injectableDef;if(providerDef){let providerInstance=data._providers[providerDef.index];return void 0===providerInstance&&(providerInstance=data._providers[providerDef.index]=_createProviderInstance(data,providerDef)),providerInstance===UNDEFINED_VALUE?void 0:providerInstance}if((injectableDef=getInjectableDef(depDef.token))&&(ngModule=data,null!=(def=injectableDef).providedIn&&(function(ngModule,scope){return ngModule._def.modules.indexOf(def.providedIn)>-1}(ngModule)||"root"===def.providedIn&&ngModule._def.isRoot))){const index=data._providers.length;return data._def.providers[index]=data._def.providersByKey[depDef.tokenKey]={flags:5120,value:injectableDef.factory,deps:[],index:index,token:depDef.token},data._providers[index]=UNDEFINED_VALUE,data._providers[index]=_createProviderInstance(data,data._def.providersByKey[depDef.tokenKey])}return 4&depDef.flags?notFoundValue:data._parent.get(depDef.token,notFoundValue)}finally{setCurrentInjector(former)}var ngModule,def}function _createProviderInstance(ngModule,providerDef){let injectable;switch(201347067&providerDef.flags){case 512:injectable=function(ngModule,ctor,deps){const len=deps.length;switch(len){case 0:return new ctor;case 1:return new ctor(resolveNgModuleDep(ngModule,deps[0]));case 2:return new ctor(resolveNgModuleDep(ngModule,deps[0]),resolveNgModuleDep(ngModule,deps[1]));case 3:return new ctor(resolveNgModuleDep(ngModule,deps[0]),resolveNgModuleDep(ngModule,deps[1]),resolveNgModuleDep(ngModule,deps[2]));default:const depValues=new Array(len);for(let i=0;i<len;i++)depValues[i]=resolveNgModuleDep(ngModule,deps[i]);return new ctor(...depValues)}}(ngModule,providerDef.value,providerDef.deps);break;case 1024:injectable=function(ngModule,factory,deps){const len=deps.length;switch(len){case 0:return factory();case 1:return factory(resolveNgModuleDep(ngModule,deps[0]));case 2:return factory(resolveNgModuleDep(ngModule,deps[0]),resolveNgModuleDep(ngModule,deps[1]));case 3:return factory(resolveNgModuleDep(ngModule,deps[0]),resolveNgModuleDep(ngModule,deps[1]),resolveNgModuleDep(ngModule,deps[2]));default:const depValues=Array(len);for(let i=0;i<len;i++)depValues[i]=resolveNgModuleDep(ngModule,deps[i]);return factory(...depValues)}}(ngModule,providerDef.value,providerDef.deps);break;case 2048:injectable=resolveNgModuleDep(ngModule,providerDef.deps[0]);break;case 256:injectable=providerDef.value}return injectable===UNDEFINED_VALUE||null===injectable||"object"!=typeof injectable||131072&providerDef.flags||"function"!=typeof injectable.ngOnDestroy||(providerDef.flags|=131072),void 0===injectable?UNDEFINED_VALUE:injectable}function detachEmbeddedView(elementData,viewIndex){const embeddedViews=elementData.viewContainer._embeddedViews;if((null==viewIndex||viewIndex>=embeddedViews.length)&&(viewIndex=embeddedViews.length-1),viewIndex<0)return null;const view=embeddedViews[viewIndex];return view.viewContainerParent=null,removeFromArray(embeddedViews,viewIndex),Services.dirtyParentQueries(view),renderDetachView$1(view),view}function renderAttachEmbeddedView(elementData,prevView,view){const prevRenderNode=prevView?renderNode(prevView,prevView.def.lastRenderRootNode):elementData.renderElement,parentNode=view.renderer.parentNode(prevRenderNode),nextSibling=view.renderer.nextSibling(prevRenderNode);visitRootRenderNodes(view,2,parentNode,nextSibling,void 0)}function renderDetachView$1(view){visitRootRenderNodes(view,3,null,null,void 0)}const EMPTY_CONTEXT=new Object;function createComponentFactory(selector,componentType,viewDefFactory,inputs,outputs,ngContentSelectors){return new ComponentFactory_(selector,componentType,viewDefFactory,inputs,outputs,ngContentSelectors)}class ComponentFactory_ extends ComponentFactory{constructor(selector,componentType,viewDefFactory,_inputs,_outputs,ngContentSelectors){super(),this.selector=selector,this.componentType=componentType,this._inputs=_inputs,this._outputs=_outputs,this.ngContentSelectors=ngContentSelectors,this.viewDefFactory=viewDefFactory}get inputs(){const inputsArr=[],inputs=this._inputs;for(let propName in inputs)inputsArr.push({propName:propName,templateName:inputs[propName]});return inputsArr}get outputs(){const outputsArr=[];for(let propName in this._outputs)outputsArr.push({propName:propName,templateName:this._outputs[propName]});return outputsArr}create(injector,projectableNodes,rootSelectorOrNode,ngModule){if(!ngModule)throw new Error("ngModule should be provided");const viewDef=resolveDefinition(this.viewDefFactory),componentNodeIndex=viewDef.nodes[0].element.componentProvider.nodeIndex,view=Services.createRootView(injector,projectableNodes||[],rootSelectorOrNode,viewDef,ngModule,EMPTY_CONTEXT),component=asProviderData(view,componentNodeIndex).instance;return rootSelectorOrNode&&view.renderer.setAttribute(asElementData(view,0).renderElement,"ng-version",VERSION.full),new ComponentRef_(view,new ViewRef_(view),component)}}class ComponentRef_ extends ComponentRef{constructor(_view,_viewRef,_component){super(),this._view=_view,this._viewRef=_viewRef,this._component=_component,this._elDef=this._view.def.nodes[0],this.hostView=_viewRef,this.changeDetectorRef=_viewRef,this.instance=_component}get location(){return new ElementRef(asElementData(this._view,this._elDef.nodeIndex).renderElement)}get injector(){return new Injector_(this._view,this._elDef)}get componentType(){return this._component.constructor}destroy(){this._viewRef.destroy()}onDestroy(callback){this._viewRef.onDestroy(callback)}}function createViewContainerData(view,elDef,elData){return new ViewContainerRef_(view,elDef,elData)}class ViewContainerRef_{constructor(_view,_elDef,_data){this._view=_view,this._elDef=_elDef,this._data=_data,this._embeddedViews=[]}get element(){return new ElementRef(this._data.renderElement)}get injector(){return new Injector_(this._view,this._elDef)}get parentInjector(){let view=this._view,elDef=this._elDef.parent;for(;!elDef&&view;)elDef=viewParentEl(view),view=view.parent;return view?new Injector_(view,elDef):new Injector_(this._view,null)}clear(){for(let i=this._embeddedViews.length-1;i>=0;i--){const view=detachEmbeddedView(this._data,i);Services.destroyView(view)}}get(index){const view=this._embeddedViews[index];if(view){const ref=new ViewRef_(view);return ref.attachToViewContainerRef(this),ref}return null}get length(){return this._embeddedViews.length}createEmbeddedView(templateRef,context,index){const viewRef=templateRef.createEmbeddedView(context||{});return this.insert(viewRef,index),viewRef}createComponent(componentFactory,index,injector,projectableNodes,ngModuleRef){const contextInjector=injector||this.parentInjector;ngModuleRef||componentFactory instanceof ComponentFactoryBoundToModule||(ngModuleRef=contextInjector.get(NgModuleRef));const componentRef=componentFactory.create(contextInjector,projectableNodes,void 0,ngModuleRef);return this.insert(componentRef.hostView,index),componentRef}insert(viewRef,index){if(viewRef.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");const viewRef_=viewRef;return function(parentView,elementData,viewIndex,view){let embeddedViews=elementData.viewContainer._embeddedViews;null==viewIndex&&(viewIndex=embeddedViews.length),view.viewContainerParent=parentView,addToArray(embeddedViews,viewIndex,view),function(vcElementData,view){const dvcElementData=declaredViewContainer(view);if(!dvcElementData||dvcElementData===vcElementData||16&view.state)return;view.state|=16;let projectedViews=dvcElementData.template._projectedViews;projectedViews||(projectedViews=dvcElementData.template._projectedViews=[]),projectedViews.push(view),function(viewDef,nodeDef){if(4&nodeDef.flags)return;view.parent.def.nodeFlags|=4,nodeDef.flags|=4;let parentNodeDef=nodeDef.parent;for(;parentNodeDef;)parentNodeDef.childFlags|=4,parentNodeDef=parentNodeDef.parent}(0,view.parentNodeDef)}(elementData,view),Services.dirtyParentQueries(view),renderAttachEmbeddedView(elementData,viewIndex>0?embeddedViews[viewIndex-1]:null,view)}(this._view,this._data,index,viewRef_._view),viewRef_.attachToViewContainerRef(this),viewRef}move(viewRef,currentIndex){if(viewRef.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");const previousIndex=this._embeddedViews.indexOf(viewRef._view);return function(elementData,oldViewIndex,newViewIndex){const embeddedViews=elementData.viewContainer._embeddedViews,view=embeddedViews[previousIndex];removeFromArray(embeddedViews,previousIndex),null==newViewIndex&&(newViewIndex=embeddedViews.length),addToArray(embeddedViews,newViewIndex,view),Services.dirtyParentQueries(view),renderDetachView$1(view),renderAttachEmbeddedView(elementData,newViewIndex>0?embeddedViews[newViewIndex-1]:null,view)}(this._data,0,currentIndex),viewRef}indexOf(viewRef){return this._embeddedViews.indexOf(viewRef._view)}remove(index){const viewData=detachEmbeddedView(this._data,index);viewData&&Services.destroyView(viewData)}detach(index){const view=detachEmbeddedView(this._data,index);return view?new ViewRef_(view):null}}function createChangeDetectorRef(view){return new ViewRef_(view)}class ViewRef_{constructor(_view){this._view=_view,this._viewContainerRef=null,this._appRef=null}get rootNodes(){return function(view){const renderNodes=[];return visitRootRenderNodes(view,0,void 0,void 0,renderNodes),renderNodes}(this._view)}get context(){return this._view.context}get destroyed(){return 0!=(128&this._view.state)}markForCheck(){markParentViewsForCheck(this._view)}detach(){this._view.state&=-5}detectChanges(){const fs=this._view.root.rendererFactory;fs.begin&&fs.begin();try{Services.checkAndUpdateView(this._view)}finally{fs.end&&fs.end()}}checkNoChanges(){Services.checkNoChangesView(this._view)}reattach(){this._view.state|=4}onDestroy(callback){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(callback)}destroy(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Services.destroyView(this._view)}detachFromAppRef(){this._appRef=null,renderDetachView$1(this._view),Services.dirtyParentQueries(this._view)}attachToAppRef(appRef){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=appRef}attachToViewContainerRef(vcRef){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=vcRef}}function createTemplateData(view,def){return new TemplateRef_(view,def)}class TemplateRef_ extends TemplateRef{constructor(_parentView,_def){super(),this._parentView=_parentView,this._def=_def}createEmbeddedView(context){return new ViewRef_(Services.createEmbeddedView(this._parentView,this._def,this._def.element.template,context))}get elementRef(){return new ElementRef(asElementData(this._parentView,this._def.nodeIndex).renderElement)}}function createInjector$1(view,elDef){return new Injector_(view,elDef)}class Injector_{constructor(view,elDef){this.view=view,this.elDef=elDef}get(token,notFoundValue=Injector.THROW_IF_NOT_FOUND){return Services.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:token,tokenKey:tokenKey(token)},notFoundValue)}}function createRendererV1(view){return new RendererAdapter(view.renderer)}class RendererAdapter{constructor(delegate){this.delegate=delegate}selectRootElement(selectorOrNode){return this.delegate.selectRootElement(selectorOrNode)}createElement(parent,namespaceAndName){const[ns,name]=splitNamespace(namespaceAndName),el=this.delegate.createElement(name,ns);return parent&&this.delegate.appendChild(parent,el),el}createViewRoot(hostElement){return hostElement}createTemplateAnchor(parentElement){const comment=this.delegate.createComment("");return parentElement&&this.delegate.appendChild(parentElement,comment),comment}createText(parentElement,value){const node=this.delegate.createText(value);return parentElement&&this.delegate.appendChild(parentElement,node),node}projectNodes(parentElement,nodes){for(let i=0;i<nodes.length;i++)this.delegate.appendChild(parentElement,nodes[i])}attachViewAfter(node,viewRootNodes){const parentElement=this.delegate.parentNode(node),nextSibling=this.delegate.nextSibling(node);for(let i=0;i<viewRootNodes.length;i++)this.delegate.insertBefore(parentElement,viewRootNodes[i],nextSibling)}detachView(viewRootNodes){for(let i=0;i<viewRootNodes.length;i++){const node=viewRootNodes[i],parentElement=this.delegate.parentNode(node);this.delegate.removeChild(parentElement,node)}}destroyView(hostElement,viewAllNodes){for(let i=0;i<viewAllNodes.length;i++)this.delegate.destroyNode(viewAllNodes[i])}listen(renderElement,name,callback){return this.delegate.listen(renderElement,name,callback)}listenGlobal(target,name,callback){return this.delegate.listen(target,name,callback)}setElementProperty(renderElement,propertyName,propertyValue){this.delegate.setProperty(renderElement,propertyName,propertyValue)}setElementAttribute(renderElement,namespaceAndName,attributeValue){const[ns,name]=splitNamespace(namespaceAndName);null!=attributeValue?this.delegate.setAttribute(renderElement,name,attributeValue,ns):this.delegate.removeAttribute(renderElement,name,ns)}setBindingDebugInfo(renderElement,propertyName,propertyValue){}setElementClass(renderElement,className,isAdd){isAdd?this.delegate.addClass(renderElement,className):this.delegate.removeClass(renderElement,className)}setElementStyle(renderElement,styleName,styleValue){null!=styleValue?this.delegate.setStyle(renderElement,styleName,styleValue):this.delegate.removeStyle(renderElement,styleName)}invokeElementMethod(renderElement,methodName,args){renderElement[methodName].apply(renderElement,args)}setText(renderNode,text){this.delegate.setValue(renderNode,text)}animate(){throw new Error("Renderer.animate is no longer supported!")}}function createNgModuleRef(moduleType,parent,bootstrapComponents,def){return new NgModuleRef_(moduleType,parent,bootstrapComponents,def)}class NgModuleRef_{constructor(_moduleType,_parent,_bootstrapComponents,_def){this._moduleType=_moduleType,this._parent=_parent,this._bootstrapComponents=_bootstrapComponents,this._def=_def,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(data){const def=data._def,providers=data._providers=new Array(def.providers.length);for(let i=0;i<def.providers.length;i++){const provDef=def.providers[i];4096&provDef.flags||void 0===providers[i]&&(providers[i]=_createProviderInstance(data,provDef))}}(this)}get(token,notFoundValue=Injector.THROW_IF_NOT_FOUND,injectFlags=InjectFlags.Default){let flags=0;return injectFlags&InjectFlags.SkipSelf?flags|=1:injectFlags&InjectFlags.Self&&(flags|=4),resolveNgModuleDep(this,{token:token,tokenKey:tokenKey(token),flags:flags},notFoundValue)}get instance(){return this.get(this._moduleType)}get componentFactoryResolver(){return this.get(ComponentFactoryResolver)}destroy(){if(this._destroyed)throw new Error(`The ng module ${stringify(this.instance.constructor)} has already been destroyed.`);this._destroyed=!0,function(ngModule,lifecycles){const def=ngModule._def,destroyed=new Set;for(let i=0;i<def.providers.length;i++)if(131072&def.providers[i].flags){const instance=ngModule._providers[i];if(instance&&instance!==UNDEFINED_VALUE){const onDestroy=instance.ngOnDestroy;"function"!=typeof onDestroy||destroyed.has(instance)||(onDestroy.apply(instance),destroyed.add(instance))}}}(this),this._destroyListeners.forEach(listener=>listener())}onDestroy(callback){this._destroyListeners.push(callback)}}const RendererV1TokenKey=tokenKey(Renderer),Renderer2TokenKey=tokenKey(Renderer2),ElementRefTokenKey=tokenKey(ElementRef),ViewContainerRefTokenKey=tokenKey(ViewContainerRef),TemplateRefTokenKey=tokenKey(TemplateRef),ChangeDetectorRefTokenKey=tokenKey(ChangeDetectorRef),InjectorRefTokenKey$1=tokenKey(Injector),INJECTORRefTokenKey$1=tokenKey(INJECTOR);function directiveDef(checkIndex,flags,matchedQueries,childCount,ctor,deps,props,outputs){const bindings=[];if(props)for(let prop in props){const[bindingIndex,nonMinifiedName]=props[prop];bindings[bindingIndex]={flags:8,name:prop,nonMinifiedName:nonMinifiedName,ns:null,securityContext:null,suffix:null}}const outputDefs=[];if(outputs)for(let propName in outputs)outputDefs.push({type:1,propName:propName,target:null,eventName:outputs[propName]});return _def(checkIndex,flags|=16384,matchedQueries,childCount,ctor,ctor,deps,bindings,outputDefs)}function providerDef(flags,matchedQueries,token,value,deps){return _def(-1,flags,matchedQueries,0,token,value,deps)}function _def(checkIndex,flags,matchedQueriesDsl,childCount,token,value,deps,bindings,outputs){const{matchedQueries:matchedQueries,references:references,matchedQueryIds:matchedQueryIds}=splitMatchedQueriesDsl(matchedQueriesDsl);outputs||(outputs=[]),bindings||(bindings=[]),value=resolveForwardRef(value);const depDefs=splitDepsDsl(deps,stringify(token));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:checkIndex,flags:flags,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:matchedQueries,matchedQueryIds:matchedQueryIds,references:references,ngContentIndex:-1,childCount:childCount,bindings:bindings,bindingFlags:calcBindingFlags(bindings),outputs:outputs,element:null,provider:{token:token,value:value,deps:depDefs},text:null,query:null,ngContent:null}}function createProviderInstance(view,def){return _createProviderInstance$1(view,def)}function createPipeInstance(view,def){let compView=view;for(;compView.parent&&!isComponentView(compView);)compView=compView.parent;return createClass(compView.parent,viewParentEl(compView),!0,def.provider.value,def.provider.deps)}function createDirectiveInstance(view,def){const instance=createClass(view,def.parent,(32768&def.flags)>0,def.provider.value,def.provider.deps);if(def.outputs.length)for(let i=0;i<def.outputs.length;i++){const output=def.outputs[i],outputObservable=instance[output.propName];if(!isObservable(outputObservable))throw new Error(`@Output ${output.propName} not initialized in '${instance.constructor.name}'.`);{const subscription=outputObservable.subscribe(eventHandlerClosure(view,def.parent.nodeIndex,output.eventName));view.disposables[def.outputIndex+i]=subscription.unsubscribe.bind(subscription)}}return instance}function eventHandlerClosure(view,index,eventName){return event=>dispatchEvent(view,index,eventName,event)}function _createProviderInstance$1(view,def){const allowPrivateServices=(8192&def.flags)>0,providerDef=def.provider;switch(201347067&def.flags){case 512:return createClass(view,def.parent,allowPrivateServices,providerDef.value,providerDef.deps);case 1024:return function(view,elDef,allowPrivateServices,factory,deps){const len=deps.length;switch(len){case 0:return factory();case 1:return factory(resolveDep(view,elDef,allowPrivateServices,deps[0]));case 2:return factory(resolveDep(view,elDef,allowPrivateServices,deps[0]),resolveDep(view,elDef,allowPrivateServices,deps[1]));case 3:return factory(resolveDep(view,elDef,allowPrivateServices,deps[0]),resolveDep(view,elDef,allowPrivateServices,deps[1]),resolveDep(view,elDef,allowPrivateServices,deps[2]));default:const depValues=Array(len);for(let i=0;i<len;i++)depValues[i]=resolveDep(view,elDef,allowPrivateServices,deps[i]);return factory(...depValues)}}(view,def.parent,allowPrivateServices,providerDef.value,providerDef.deps);case 2048:return resolveDep(view,def.parent,allowPrivateServices,providerDef.deps[0]);case 256:return providerDef.value}}function createClass(view,elDef,allowPrivateServices,ctor,deps){const len=deps.length;switch(len){case 0:return new ctor;case 1:return new ctor(resolveDep(view,elDef,allowPrivateServices,deps[0]));case 2:return new ctor(resolveDep(view,elDef,allowPrivateServices,deps[0]),resolveDep(view,elDef,allowPrivateServices,deps[1]));case 3:return new ctor(resolveDep(view,elDef,allowPrivateServices,deps[0]),resolveDep(view,elDef,allowPrivateServices,deps[1]),resolveDep(view,elDef,allowPrivateServices,deps[2]));default:const depValues=new Array(len);for(let i=0;i<len;i++)depValues[i]=resolveDep(view,elDef,allowPrivateServices,deps[i]);return new ctor(...depValues)}}const NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR={};function resolveDep(view,elDef,allowPrivateServices,depDef,notFoundValue=Injector.THROW_IF_NOT_FOUND){if(8&depDef.flags)return depDef.token;const startView=view;2&depDef.flags&&(notFoundValue=null);const tokenKey=depDef.tokenKey;tokenKey===ChangeDetectorRefTokenKey&&(allowPrivateServices=!(!elDef||!elDef.element.componentView)),elDef&&1&depDef.flags&&(allowPrivateServices=!1,elDef=elDef.parent);let searchView=view;for(;searchView;){if(elDef)switch(tokenKey){case RendererV1TokenKey:return createRendererV1(findCompView(searchView,elDef,allowPrivateServices));case Renderer2TokenKey:return findCompView(searchView,elDef,allowPrivateServices).renderer;case ElementRefTokenKey:return new ElementRef(asElementData(searchView,elDef.nodeIndex).renderElement);case ViewContainerRefTokenKey:return asElementData(searchView,elDef.nodeIndex).viewContainer;case TemplateRefTokenKey:if(elDef.element.template)return asElementData(searchView,elDef.nodeIndex).template;break;case ChangeDetectorRefTokenKey:return createChangeDetectorRef(findCompView(searchView,elDef,allowPrivateServices));case InjectorRefTokenKey$1:case INJECTORRefTokenKey$1:return createInjector$1(searchView,elDef);default:const providerDef=(allowPrivateServices?elDef.element.allProviders:elDef.element.publicProviders)[tokenKey];if(providerDef){let providerData=asProviderData(searchView,providerDef.nodeIndex);return providerData||(providerData={instance:_createProviderInstance$1(searchView,providerDef)},searchView.nodes[providerDef.nodeIndex]=providerData),providerData.instance}}allowPrivateServices=isComponentView(searchView),elDef=viewParentEl(searchView),searchView=searchView.parent,4&depDef.flags&&(searchView=null)}const value=startView.root.injector.get(depDef.token,NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR);return value!==NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR||notFoundValue===NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR?value:startView.root.ngModule.injector.get(depDef.token,notFoundValue)}function findCompView(view,elDef,allowPrivateServices){let compView;if(allowPrivateServices)compView=asElementData(view,elDef.nodeIndex).componentView;else for(compView=view;compView.parent&&!isComponentView(compView);)compView=compView.parent;return compView}function updateProp(view,providerData,def,bindingIdx,value,changes){if(32768&def.flags){const compView=asElementData(view,def.parent.nodeIndex).componentView;2&compView.def.flags&&(compView.state|=8)}if(providerData.instance[def.bindings[bindingIdx].name]=value,524288&def.flags){changes=changes||{};const oldValue=WrappedValue.unwrap(view.oldValues[def.bindingIndex+bindingIdx]);changes[def.bindings[bindingIdx].nonMinifiedName]=new SimpleChange(oldValue,value,0!=(2&view.state))}return view.oldValues[def.bindingIndex+bindingIdx]=value,changes}function callLifecycleHooksChildrenFirst(view,lifecycles){if(!(view.def.nodeFlags&lifecycles))return;const nodes=view.def.nodes;let initIndex=0;for(let i=0;i<nodes.length;i++){const nodeDef=nodes[i];let parent=nodeDef.parent;for(!parent&&nodeDef.flags&lifecycles&&callProviderLifecycles(view,i,nodeDef.flags&lifecycles,initIndex++),0==(nodeDef.childFlags&lifecycles)&&(i+=nodeDef.childCount);parent&&1&parent.flags&&i===parent.nodeIndex+parent.childCount;)parent.directChildFlags&lifecycles&&(initIndex=callElementProvidersLifecycles(view,parent,lifecycles,initIndex)),parent=parent.parent}}function callElementProvidersLifecycles(view,elDef,lifecycles,initIndex){for(let i=elDef.nodeIndex+1;i<=elDef.nodeIndex+elDef.childCount;i++){const nodeDef=view.def.nodes[i];nodeDef.flags&lifecycles&&callProviderLifecycles(view,i,nodeDef.flags&lifecycles,initIndex++),i+=nodeDef.childCount}return initIndex}function callProviderLifecycles(view,index,lifecycles,initIndex){const providerData=asProviderData(view,index);if(!providerData)return;const provider=providerData.instance;provider&&(Services.setCurrentNode(view,index),1048576&lifecycles&&shouldCallLifecycleInitHook(view,512,initIndex)&&provider.ngAfterContentInit(),2097152&lifecycles&&provider.ngAfterContentChecked(),4194304&lifecycles&&shouldCallLifecycleInitHook(view,768,initIndex)&&provider.ngAfterViewInit(),8388608&lifecycles&&provider.ngAfterViewChecked(),131072&lifecycles&&provider.ngOnDestroy())}const SCHEDULER=new InjectionToken("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>defaultScheduler}),LOCALE_DATA={},LocaleDataIndex=function(){var LocaleDataIndex={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return LocaleDataIndex[LocaleDataIndex.LocaleId]="LocaleId",LocaleDataIndex[LocaleDataIndex.DayPeriodsFormat]="DayPeriodsFormat",LocaleDataIndex[LocaleDataIndex.DayPeriodsStandalone]="DayPeriodsStandalone",LocaleDataIndex[LocaleDataIndex.DaysFormat]="DaysFormat",LocaleDataIndex[LocaleDataIndex.DaysStandalone]="DaysStandalone",LocaleDataIndex[LocaleDataIndex.MonthsFormat]="MonthsFormat",LocaleDataIndex[LocaleDataIndex.MonthsStandalone]="MonthsStandalone",LocaleDataIndex[LocaleDataIndex.Eras]="Eras",LocaleDataIndex[LocaleDataIndex.FirstDayOfWeek]="FirstDayOfWeek",LocaleDataIndex[LocaleDataIndex.WeekendRange]="WeekendRange",LocaleDataIndex[LocaleDataIndex.DateFormat]="DateFormat",LocaleDataIndex[LocaleDataIndex.TimeFormat]="TimeFormat",LocaleDataIndex[LocaleDataIndex.DateTimeFormat]="DateTimeFormat",LocaleDataIndex[LocaleDataIndex.NumberSymbols]="NumberSymbols",LocaleDataIndex[LocaleDataIndex.NumberFormats]="NumberFormats",LocaleDataIndex[LocaleDataIndex.CurrencySymbol]="CurrencySymbol",LocaleDataIndex[LocaleDataIndex.CurrencyName]="CurrencyName",LocaleDataIndex[LocaleDataIndex.Currencies]="Currencies",LocaleDataIndex[LocaleDataIndex.PluralCase]="PluralCase",LocaleDataIndex[LocaleDataIndex.ExtraData]="ExtraData",LocaleDataIndex}(),u=void 0;var localeEn=["en",[["a","p"],["AM","PM"],u],[["AM","PM"],u,u],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],u,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],u,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",u,"{1} 'at' {0}",u],[".",",",";","%","+","-","E","×","‰","∞","NaN",":"],["#,##0.###","#,##0%","¤#,##0.00","#E0"],"$","US Dollar",{},function(n){let i=Math.floor(Math.abs(n)),v=n.toString().replace(/^[^.]*\.?/,"").length;return 1===i&&0===v?1:5}];const DEFAULT_LOCALE_ID="en-US";let LOCALE_ID=DEFAULT_LOCALE_ID;function setLocaleId(localeId){var msg;msg="Expected localeId to be defined",null==localeId&&function(msg){throw new Error(`ASSERTION ERROR: ${msg}`)}(msg),"string"==typeof localeId&&(LOCALE_ID=localeId.toLowerCase().replace(/_/g,"-"))}class core_EventEmitter extends Subject_Subject{constructor(isAsync=!1){super(),this.__isAsync=isAsync}emit(value){super.next(value)}subscribe(generatorOrNext,error,complete){let schedulerFn,errorFn=err=>null,completeFn=()=>null;generatorOrNext&&"object"==typeof generatorOrNext?(schedulerFn=this.__isAsync?value=>{setTimeout(()=>generatorOrNext.next(value))}:value=>{generatorOrNext.next(value)},generatorOrNext.error&&(errorFn=this.__isAsync?err=>{setTimeout(()=>generatorOrNext.error(err))}:err=>{generatorOrNext.error(err)}),generatorOrNext.complete&&(completeFn=this.__isAsync?()=>{setTimeout(()=>generatorOrNext.complete())}:()=>{generatorOrNext.complete()})):(schedulerFn=this.__isAsync?value=>{setTimeout(()=>generatorOrNext(value))}:value=>{generatorOrNext(value)},error&&(errorFn=this.__isAsync?err=>{setTimeout(()=>error(err))}:err=>{error(err)}),complete&&(completeFn=this.__isAsync?()=>{setTimeout(()=>complete())}:()=>{complete()}));const sink=super.subscribe(schedulerFn,errorFn,completeFn);return generatorOrNext instanceof Subscription_Subscription&&generatorOrNext.add(sink),sink}}function symbolIterator(){return this._results[core_getSymbolIterator()]()}class QueryList{constructor(){this.dirty=!0,this._results=[],this.changes=new core_EventEmitter,this.length=0;const symbol=core_getSymbolIterator(),proto=QueryList.prototype;proto[symbol]||(proto[symbol]=symbolIterator)}map(fn){return this._results.map(fn)}filter(fn){return this._results.filter(fn)}find(fn){return this._results.find(fn)}reduce(fn,init){return this._results.reduce(fn,init)}forEach(fn){this._results.forEach(fn)}some(fn){return this._results.some(fn)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(resultsTree){this._results=function flatten(list,dst){void 0===dst&&(dst=list);for(let i=0;i<list.length;i++){let item=list[i];Array.isArray(item)?(dst===list&&(dst=list.slice(0,i)),flatten(item,dst)):dst!==list&&dst.push(item)}return dst}(resultsTree),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}const APP_INITIALIZER=new InjectionToken("Application Initializer");class ApplicationInitStatus{constructor(appInits){this.appInits=appInits,this.initialized=!1,this.done=!1,this.donePromise=new Promise((res,rej)=>{this.resolve=res,this.reject=rej})}runInitializers(){if(this.initialized)return;const asyncInitPromises=[],complete=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const initResult=this.appInits[i]();core_isPromise(initResult)&&asyncInitPromises.push(initResult)}Promise.all(asyncInitPromises).then(()=>{complete()}).catch(e=>{this.reject(e)}),0===asyncInitPromises.length&&complete(),this.initialized=!0}}const APP_ID=new InjectionToken("AppId");function _appIdRandomProviderFactory(){return`${_randomChar()}${_randomChar()}${_randomChar()}`}function _randomChar(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const PLATFORM_INITIALIZER=new InjectionToken("Platform Initializer"),PLATFORM_ID=new InjectionToken("Platform ID"),APP_BOOTSTRAP_LISTENER=new InjectionToken("appBootstrapListener");class Console{log(message){console.log(message)}warn(message){console.warn(message)}}const LOCALE_ID$1=new InjectionToken("LocaleId"),ivyEnabled=!1;function _throwError(){throw new Error("Runtime compiler is not loaded")}const Compiler_compileModuleSync=_throwError,Compiler_compileModuleAsync=_throwError,Compiler_compileModuleAndAllComponentsSync=_throwError,Compiler_compileModuleAndAllComponentsAsync=_throwError;class Compiler{constructor(){this.compileModuleSync=Compiler_compileModuleSync,this.compileModuleAsync=Compiler_compileModuleAsync,this.compileModuleAndAllComponentsSync=Compiler_compileModuleAndAllComponentsSync,this.compileModuleAndAllComponentsAsync=Compiler_compileModuleAndAllComponentsAsync}clearCache(){}clearCacheFor(type){}getModuleId(moduleType){}}class CompilerFactory{}let trace,core_events;function detectWTF(){const wtf=_global.wtf;return!(!wtf||!(trace=wtf.trace)||(core_events=trace.events,0))}const wtfEnabled=detectWTF(),wtfCreateScope=wtfEnabled?function(signature,flags=null){return core_events.createScope(signature,flags)}:(signature,flags)=>(function(arg0,arg1){return null}),wtfLeave=wtfEnabled?function(scope,returnValue){return trace.leaveScope(scope,returnValue),returnValue}:(s,r)=>r,core_promise=(()=>Promise.resolve(0))();function scheduleMicroTask(fn){"undefined"==typeof Zone?core_promise.then(()=>{fn&&fn.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",fn)}class NgZone{constructor({enableLongStackTrace:enableLongStackTrace=!1}){if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new core_EventEmitter(!1),this.onMicrotaskEmpty=new core_EventEmitter(!1),this.onStable=new core_EventEmitter(!1),this.onError=new core_EventEmitter(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");var zone;Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),enableLongStackTrace&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(zone=this)._inner=zone._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(delegate,current,target,task,applyThis,applyArgs)=>{try{return onEnter(zone),delegate.invokeTask(target,task,applyThis,applyArgs)}finally{onLeave(zone)}},onInvoke:(delegate,current,target,callback,applyThis,applyArgs,source)=>{try{return onEnter(zone),delegate.invoke(target,callback,applyThis,applyArgs,source)}finally{onLeave(zone)}},onHasTask:(delegate,current,target,hasTaskState)=>{delegate.hasTask(target,hasTaskState),current===target&&("microTask"==hasTaskState.change?(zone.hasPendingMicrotasks=hasTaskState.microTask,checkStable(zone)):"macroTask"==hasTaskState.change&&(zone.hasPendingMacrotasks=hasTaskState.macroTask))},onHandleError:(delegate,current,target,error)=>(delegate.handleError(target,error),zone.runOutsideAngular(()=>zone.onError.emit(error)),!1)})}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!NgZone.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(NgZone.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(fn,applyThis,applyArgs){return this._inner.run(fn,applyThis,applyArgs)}runTask(fn,applyThis,applyArgs,name){const zone=this._inner,task=zone.scheduleEventTask("NgZoneEvent: "+name,fn,EMPTY_PAYLOAD,noop$1,noop$1);try{return zone.runTask(task,applyThis,applyArgs)}finally{zone.cancelTask(task)}}runGuarded(fn,applyThis,applyArgs){return this._inner.runGuarded(fn,applyThis,applyArgs)}runOutsideAngular(fn){return this._outer.run(fn)}}function noop$1(){}const EMPTY_PAYLOAD={};function checkStable(zone){if(0==zone._nesting&&!zone.hasPendingMicrotasks&&!zone.isStable)try{zone._nesting++,zone.onMicrotaskEmpty.emit(null)}finally{if(zone._nesting--,!zone.hasPendingMicrotasks)try{zone.runOutsideAngular(()=>zone.onStable.emit(null))}finally{zone.isStable=!0}}}function onEnter(zone){zone._nesting++,zone.isStable&&(zone.isStable=!1,zone.onUnstable.emit(null))}function onLeave(zone){zone._nesting--,checkStable(zone)}class NoopNgZone{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new core_EventEmitter,this.onMicrotaskEmpty=new core_EventEmitter,this.onStable=new core_EventEmitter,this.onError=new core_EventEmitter}run(fn){return fn()}runGuarded(fn){return fn()}runOutsideAngular(fn){return fn()}runTask(fn){return fn()}}class Testability{constructor(_ngZone){this._ngZone=_ngZone,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),_ngZone.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{NgZone.assertNotInAngularZone(),scheduleMicroTask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())scheduleMicroTask(()=>{for(;0!==this._callbacks.length;){let cb=this._callbacks.pop();clearTimeout(cb.timeoutId),cb.doneCb(this._didWork)}this._didWork=!1});else{let pending=this.getPendingTasks();this._callbacks=this._callbacks.filter(cb=>!cb.updateCb||!cb.updateCb(pending)||(clearTimeout(cb.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(cb,timeout,updateCb){let timeoutId=-1;timeout&&timeout>0&&(timeoutId=setTimeout(()=>{this._callbacks=this._callbacks.filter(cb=>cb.timeoutId!==timeoutId),cb(this._didWork,this.getPendingTasks())},timeout)),this._callbacks.push({doneCb:cb,timeoutId:timeoutId,updateCb:updateCb})}whenStable(doneCb,timeout,updateCb){if(updateCb&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(doneCb,timeout,updateCb),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(using,provider,exactMatch){return[]}}class TestabilityRegistry{constructor(){this._applications=new Map,_testabilityGetter.addToWindow(this)}registerApplication(token,testability){this._applications.set(token,testability)}unregisterApplication(token){this._applications.delete(token)}unregisterAllApplications(){this._applications.clear()}getTestability(elem){return this._applications.get(elem)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(elem,findInAncestors=!0){return _testabilityGetter.findTestabilityInTree(this,elem,findInAncestors)}}class _NoopGetTestability{addToWindow(registry){}findTestabilityInTree(registry,elem,findInAncestors){return null}}let _platform,_testabilityGetter=new _NoopGetTestability,compileNgModuleFactory=function(injector,options,moduleType){return injector.get(CompilerFactory).createCompiler([options]).compileModuleAsync(moduleType)},isBoundToModule=function(cf){return cf instanceof ComponentFactoryBoundToModule};const ALLOW_MULTIPLE_PLATFORMS=new InjectionToken("AllowMultipleToken");class NgProbeToken{constructor(name,token){this.name=name,this.token=token}}function createPlatformFactory(parentPlatformFactory,name,providers=[]){const desc=`Platform: ${name}`,marker=new InjectionToken(desc);return(extraProviders=[])=>{let platform=getPlatform();if(!platform||platform.injector.get(ALLOW_MULTIPLE_PLATFORMS,!1))if(parentPlatformFactory)parentPlatformFactory(providers.concat(extraProviders).concat({provide:marker,useValue:!0}));else{const injectedProviders=providers.concat(extraProviders).concat({provide:marker,useValue:!0});!function(injector){if(_platform&&!_platform.destroyed&&!_platform.injector.get(ALLOW_MULTIPLE_PLATFORMS,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");_platform=injector.get(PlatformRef);const inits=injector.get(PLATFORM_INITIALIZER,null);inits&&inits.forEach(init=>init())}(Injector.create({providers:injectedProviders,name:desc}))}return function(requiredToken){const platform=getPlatform();if(!platform)throw new Error("No platform exists!");if(!platform.injector.get(requiredToken,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return platform}(marker)}}function getPlatform(){return _platform&&!_platform.destroyed?_platform:null}class PlatformRef{constructor(_injector){this._injector=_injector,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(moduleFactory,options){const ngZone="noop"===(ngZoneOption=options?options.ngZone:void 0)?new NoopNgZone:("zone.js"===ngZoneOption?void 0:ngZoneOption)||new NgZone({enableLongStackTrace:isDevMode()}),providers=[{provide:NgZone,useValue:ngZone}];var ngZoneOption;return ngZone.run(()=>{const ngZoneInjector=Injector.create({providers:providers,parent:this.injector,name:moduleFactory.moduleType.name}),moduleRef=moduleFactory.create(ngZoneInjector),exceptionHandler=moduleRef.injector.get(ErrorHandler,null);if(!exceptionHandler)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return ivyEnabled&&setLocaleId(moduleRef.injector.get(LOCALE_ID$1,DEFAULT_LOCALE_ID)||DEFAULT_LOCALE_ID),moduleRef.onDestroy(()=>core_remove(this._modules,moduleRef)),ngZone.runOutsideAngular(()=>ngZone.onError.subscribe({next:error=>{exceptionHandler.handleError(error)}})),function(errorHandler,ngZone,callback){try{const result=callback();return core_isPromise(result)?result.catch(e=>{throw ngZone.runOutsideAngular(()=>errorHandler.handleError(e)),e}):result}catch(e){throw ngZone.runOutsideAngular(()=>errorHandler.handleError(e)),e}}(exceptionHandler,ngZone,()=>{const initStatus=moduleRef.injector.get(ApplicationInitStatus);return initStatus.runInitializers(),initStatus.donePromise.then(()=>(this._moduleDoBootstrap(moduleRef),moduleRef))})})}bootstrapModule(moduleType,compilerOptions=[]){const options=optionsReducer({},compilerOptions);return compileNgModuleFactory(this.injector,options,moduleType).then(moduleFactory=>this.bootstrapModuleFactory(moduleFactory,options))}_moduleDoBootstrap(moduleRef){const appRef=moduleRef.injector.get(core_ApplicationRef);if(moduleRef._bootstrapComponents.length>0)moduleRef._bootstrapComponents.forEach(f=>appRef.bootstrap(f));else{if(!moduleRef.instance.ngDoBootstrap)throw new Error(`The module ${stringify(moduleRef.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. `+"Please define one of these.");moduleRef.instance.ngDoBootstrap(appRef)}this._modules.push(moduleRef)}onDestroy(callback){this._destroyListeners.push(callback)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(module=>module.destroy()),this._destroyListeners.forEach(listener=>listener()),this._destroyed=!0}get destroyed(){return this._destroyed}}function optionsReducer(dst,objs){return Array.isArray(objs)?objs.reduce(optionsReducer,dst):Object.assign({},dst,objs)}let core_ApplicationRef=(()=>{class ApplicationRef{constructor(_zone,_console,_injector,_exceptionHandler,_componentFactoryResolver,_initStatus){this._zone=_zone,this._console=_console,this._injector=_injector,this._exceptionHandler=_exceptionHandler,this._componentFactoryResolver=_componentFactoryResolver,this._initStatus=_initStatus,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=isDevMode(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const isCurrentlyStable=new Observable_Observable(observer=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{observer.next(this._stable),observer.complete()})}),isStable=new Observable_Observable(observer=>{let stableSub;this._zone.runOutsideAngular(()=>{stableSub=this._zone.onStable.subscribe(()=>{NgZone.assertNotInAngularZone(),scheduleMicroTask(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,observer.next(!0))})})});const unstableSub=this._zone.onUnstable.subscribe(()=>{NgZone.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{observer.next(!1)}))});return()=>{stableSub.unsubscribe(),unstableSub.unsubscribe()}});this.isStable=function(...observables){let concurrent=Number.POSITIVE_INFINITY,scheduler=null,last=observables[observables.length-1];return isScheduler(last)?(scheduler=observables.pop(),observables.length>1&&"number"==typeof observables[observables.length-1]&&(concurrent=observables.pop())):"number"==typeof last&&(concurrent=observables.pop()),null===scheduler&&1===observables.length&&observables[0]instanceof Observable_Observable?observables[0]:mergeAll(concurrent)(fromArray(observables,scheduler))}(isCurrentlyStable,isStable.pipe(source=>refCount()(function(subjectOrSubjectFactory,selector){return function(source){let subjectFactory;subjectFactory="function"==typeof subjectOrSubjectFactory?subjectOrSubjectFactory:function(){return subjectOrSubjectFactory};const connectable=Object.create(source,connectableObservableDescriptor);return connectable.source=source,connectable.subjectFactory=subjectFactory,connectable}}(shareSubjectFactory)(source))))}bootstrap(componentOrFactory,rootSelectorOrNode){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let componentFactory;componentFactory=componentOrFactory instanceof ComponentFactory?componentOrFactory:this._componentFactoryResolver.resolveComponentFactory(componentOrFactory),this.componentTypes.push(componentFactory.componentType);const ngModule=isBoundToModule(componentFactory)?null:this._injector.get(NgModuleRef),compRef=componentFactory.create(Injector.NULL,[],rootSelectorOrNode||componentFactory.selector,ngModule);compRef.onDestroy(()=>{this._unloadComponent(compRef)});const testability=compRef.injector.get(Testability,null);return testability&&compRef.injector.get(TestabilityRegistry).registerApplication(compRef.location.nativeElement,testability),this._loadComponent(compRef),isDevMode()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),compRef}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");const scope=ApplicationRef._tickScope();try{this._runningTick=!0;for(let view of this._views)view.detectChanges();if(this._enforceNoNewChanges)for(let view of this._views)view.checkNoChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1,wtfLeave(scope)}}attachView(viewRef){const view=viewRef;this._views.push(view),view.attachToAppRef(this)}detachView(viewRef){const view=viewRef;core_remove(this._views,view),view.detachFromAppRef()}_loadComponent(componentRef){this.attachView(componentRef.hostView),this.tick(),this.components.push(componentRef),this._injector.get(APP_BOOTSTRAP_LISTENER,[]).concat(this._bootstrapListeners).forEach(listener=>listener(componentRef))}_unloadComponent(componentRef){this.detachView(componentRef.hostView),core_remove(this.components,componentRef)}ngOnDestroy(){this._views.slice().forEach(view=>view.destroy())}get viewCount(){return this._views.length}}return ApplicationRef._tickScope=wtfCreateScope("ApplicationRef#tick()"),ApplicationRef})();function core_remove(list,el){const index=list.indexOf(el);index>-1&&list.splice(index,1)}class NgModuleFactoryLoader{}const _SEPARATOR="#",FACTORY_CLASS_SUFFIX="NgFactory";class SystemJsNgModuleLoaderConfig{}const DEFAULT_CONFIG={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};class SystemJsNgModuleLoader{constructor(_compiler,config){this._compiler=_compiler,this._config=config||DEFAULT_CONFIG}load(path){return!ivyEnabled&&this._compiler instanceof Compiler?this.loadFactory(path):this.loadAndCompile(path)}loadAndCompile(path){let[module,exportName]=path.split(_SEPARATOR);return void 0===exportName&&(exportName="default"),__webpack_require__("zn8P")(module).then(module=>module[exportName]).then(type=>checkNotEmpty(type,module,exportName)).then(type=>this._compiler.compileModuleAsync(type))}loadFactory(path){let[module,exportName]=path.split(_SEPARATOR),factoryClassSuffix=FACTORY_CLASS_SUFFIX;return void 0===exportName&&(exportName="default",factoryClassSuffix=""),__webpack_require__("zn8P")(this._config.factoryPathPrefix+module+this._config.factoryPathSuffix).then(module=>module[exportName+factoryClassSuffix]).then(factory=>checkNotEmpty(factory,module,exportName))}}function checkNotEmpty(value,modulePath,exportName){if(!value)throw new Error(`Cannot find '${exportName}' in '${modulePath}'`);return value}class DebugEventListener{constructor(name,callback){this.name=name,this.callback=callback}}class DebugNode__PRE_R3__{constructor(nativeNode,parent,_debugContext){this.listeners=[],this.parent=null,this._debugContext=_debugContext,this.nativeNode=nativeNode,parent&&parent instanceof DebugElement__PRE_R3__&&parent.addChild(this)}get injector(){return this._debugContext.injector}get componentInstance(){return this._debugContext.component}get context(){return this._debugContext.context}get references(){return this._debugContext.references}get providerTokens(){return this._debugContext.providerTokens}}class DebugElement__PRE_R3__ extends DebugNode__PRE_R3__{constructor(nativeNode,parent,_debugContext){super(nativeNode,parent,_debugContext),this.properties={},this.attributes={},this.classes={},this.styles={},this.childNodes=[],this.nativeElement=nativeNode}addChild(child){child&&(this.childNodes.push(child),child.parent=this)}removeChild(child){const childIndex=this.childNodes.indexOf(child);-1!==childIndex&&(child.parent=null,this.childNodes.splice(childIndex,1))}insertChildrenAfter(child,newChildren){const siblingIndex=this.childNodes.indexOf(child);-1!==siblingIndex&&(this.childNodes.splice(siblingIndex+1,0,...newChildren),newChildren.forEach(c=>{c.parent&&c.parent.removeChild(c),child.parent=this}))}insertBefore(refChild,newChild){const refIndex=this.childNodes.indexOf(refChild);-1===refIndex?this.addChild(newChild):(newChild.parent&&newChild.parent.removeChild(newChild),newChild.parent=this,this.childNodes.splice(refIndex,0,newChild))}query(predicate){return this.queryAll(predicate)[0]||null}queryAll(predicate){const matches=[];return function _queryElementChildren(element,predicate,matches){element.childNodes.forEach(node=>{node instanceof DebugElement__PRE_R3__&&(predicate(node)&&matches.push(node),_queryElementChildren(node,predicate,matches))})}(this,predicate,matches),matches}queryAllNodes(predicate){const matches=[];return function _queryNodeChildren(parentNode,predicate,matches){parentNode instanceof DebugElement__PRE_R3__&&parentNode.childNodes.forEach(node=>{predicate(node)&&matches.push(node),node instanceof DebugElement__PRE_R3__&&_queryNodeChildren(node,predicate,matches)})}(this,predicate,matches),matches}get children(){return this.childNodes.filter(node=>node instanceof DebugElement__PRE_R3__)}triggerEventHandler(eventName,eventObj){this.listeners.forEach(listener=>{listener.name==eventName&&listener.callback(eventObj)})}}const _nativeNodeToDebugNode=new Map,getDebugNode=function(nativeNode){return _nativeNodeToDebugNode.get(nativeNode)||null};function indexDebugNode(node){_nativeNodeToDebugNode.set(node.nativeNode,node)}const platformCore=createPlatformFactory(null,"core",[{provide:PLATFORM_ID,useValue:"unknown"},{provide:PlatformRef,deps:[Injector]},{provide:TestabilityRegistry,deps:[]},{provide:Console,deps:[]}]);function _iterableDiffersFactory(){return defaultIterableDiffers}function _keyValueDiffersFactory(){return defaultKeyValueDiffers}function _localeFactory(locale){return locale?(ivyEnabled&&setLocaleId(locale),locale):DEFAULT_LOCALE_ID}function zoneSchedulerFactory(ngZone){let queue=[];return ngZone.onStable.subscribe(()=>{for(;queue.length;)queue.pop()()}),function(fn){queue.push(fn)}}class ApplicationModule{constructor(appRef){}}function elementDef(checkIndex,flags,matchedQueriesDsl,ngContentIndex,childCount,namespaceAndName,fixedAttrs=[],bindings,outputs,handleEvent,componentView,componentRendererType){handleEvent||(handleEvent=NOOP);const{matchedQueries:matchedQueries,references:references,matchedQueryIds:matchedQueryIds}=splitMatchedQueriesDsl(matchedQueriesDsl);let ns=null,name=null;namespaceAndName&&([ns,name]=splitNamespace(namespaceAndName)),bindings=bindings||[];const bindingDefs=new Array(bindings.length);for(let i=0;i<bindings.length;i++){const[bindingFlags,namespaceAndName,suffixOrSecurityContext]=bindings[i],[ns,name]=splitNamespace(namespaceAndName);let securityContext=void 0,suffix=void 0;switch(15&bindingFlags){case 4:suffix=suffixOrSecurityContext;break;case 1:case 8:securityContext=suffixOrSecurityContext}bindingDefs[i]={flags:bindingFlags,ns:ns,name:name,nonMinifiedName:name,securityContext:securityContext,suffix:suffix}}outputs=outputs||[];const outputDefs=new Array(outputs.length);for(let i=0;i<outputs.length;i++){const[target,eventName]=outputs[i];outputDefs[i]={type:0,target:target,eventName:eventName,propName:null}}const attrs=(fixedAttrs=fixedAttrs||[]).map(([namespaceAndName,value])=>{const[ns,name]=splitNamespace(namespaceAndName);return[ns,name,value]});return componentRendererType=function(type){if(type&&type.id===UNDEFINED_RENDERER_TYPE_ID){const isFilled=null!=type.encapsulation&&type.encapsulation!==ViewEncapsulation.None||type.styles.length||Object.keys(type.data).length;type.id=isFilled?`c${_renderCompCount$1++}`:EMPTY_RENDERER_TYPE_ID}return type&&type.id===EMPTY_RENDERER_TYPE_ID&&(type=null),type||null}(componentRendererType),componentView&&(flags|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:checkIndex,flags:flags|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:matchedQueries,matchedQueryIds:matchedQueryIds,references:references,ngContentIndex:ngContentIndex,childCount:childCount,bindings:bindingDefs,bindingFlags:calcBindingFlags(bindingDefs),outputs:outputDefs,element:{ns:ns,name:name,attrs:attrs,template:null,componentProvider:null,componentView:componentView||null,componentRendererType:componentRendererType,publicProviders:null,allProviders:null,handleEvent:handleEvent||NOOP},provider:null,text:null,query:null,ngContent:null}}function core_createElement(view,renderHost,def){const elDef=def.element,rootSelectorOrNode=view.root.selectorOrNode,renderer=view.renderer;let el;if(view.parent||!rootSelectorOrNode){el=elDef.name?renderer.createElement(elDef.name,elDef.ns):renderer.createComment("");const parentEl=getParentRenderElement(view,renderHost,def);parentEl&&renderer.appendChild(parentEl,el)}else el=renderer.selectRootElement(rootSelectorOrNode,!!elDef.componentRendererType&&elDef.componentRendererType.encapsulation===ViewEncapsulation.ShadowDom);if(elDef.attrs)for(let i=0;i<elDef.attrs.length;i++){const[ns,name,value]=elDef.attrs[i];renderer.setAttribute(el,name,value,ns)}return el}function listenToElementOutputs(view,compView,def,el){for(let i=0;i<def.outputs.length;i++){const output=def.outputs[i],handleEventClosure=renderEventHandlerClosure(view,def.nodeIndex,(name=output.eventName,(target=output.target)?`${target}:${name}`:name));let listenTarget=output.target,listenerView=view;"component"===output.target&&(listenTarget=null,listenerView=compView);const disposable=listenerView.renderer.listen(listenTarget||el,output.eventName,handleEventClosure);view.disposables[def.outputIndex+i]=disposable}var target,name}function renderEventHandlerClosure(view,index,eventName){return event=>dispatchEvent(view,index,eventName,event)}function checkAndUpdateElementValue(view,def,bindingIdx,value){if(!checkAndUpdateBinding(view,def,bindingIdx,value))return!1;const binding=def.bindings[bindingIdx],elData=asElementData(view,def.nodeIndex),renderNode=elData.renderElement,name=binding.name;switch(15&binding.flags){case 1:!function(view,binding,renderNode,ns,name,value){const securityContext=binding.securityContext;let renderValue=securityContext?view.root.sanitizer.sanitize(securityContext,value):value;renderValue=null!=renderValue?renderValue.toString():null;const renderer=view.renderer;null!=value?renderer.setAttribute(renderNode,name,renderValue,ns):renderer.removeAttribute(renderNode,name,ns)}(view,binding,renderNode,binding.ns,name,value);break;case 2:!function(view,renderNode,name,value){const renderer=view.renderer;value?renderer.addClass(renderNode,name):renderer.removeClass(renderNode,name)}(view,renderNode,name,value);break;case 4:!function(view,binding,renderNode,name,value){let renderValue=view.root.sanitizer.sanitize(SecurityContext.STYLE,value);if(null!=renderValue){renderValue=renderValue.toString();const unit=binding.suffix;null!=unit&&(renderValue+=unit)}else renderValue=null;const renderer=view.renderer;null!=renderValue?renderer.setStyle(renderNode,name,renderValue):renderer.removeStyle(renderNode,name)}(view,binding,renderNode,name,value);break;case 8:!function(view,binding,renderNode,name,value){const securityContext=binding.securityContext;let renderValue=securityContext?view.root.sanitizer.sanitize(securityContext,value):value;view.renderer.setProperty(renderNode,name,renderValue)}(33554432&def.flags&&32&binding.flags?elData.componentView:view,binding,renderNode,name,value)}return!0}function queryDef(flags,id,bindings){let bindingDefs=[];for(let propName in bindings)bindingDefs.push({propName:propName,bindingType:bindings[propName]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:flags,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:id,filterId:filterQueryId(id),bindings:bindingDefs},ngContent:null}}function dirtyParentQueries(view){const queryIds=view.def.nodeMatchedQueries;for(;view.parent&&isEmbeddedView(view);){let tplDef=view.parentNodeDef;view=view.parent;const end=tplDef.nodeIndex+tplDef.childCount;for(let i=0;i<=end;i++){const nodeDef=view.def.nodes[i];67108864&nodeDef.flags&&536870912&nodeDef.flags&&(nodeDef.query.filterId&queryIds)===nodeDef.query.filterId&&asQueryList(view,i).setDirty(),!(1&nodeDef.flags&&i+nodeDef.childCount<tplDef.nodeIndex)&&67108864&nodeDef.childFlags&&536870912&nodeDef.childFlags||(i+=nodeDef.childCount)}}if(134217728&view.def.nodeFlags)for(let i=0;i<view.def.nodes.length;i++){const nodeDef=view.def.nodes[i];134217728&nodeDef.flags&&536870912&nodeDef.flags&&asQueryList(view,i).setDirty(),i+=nodeDef.childCount}}function checkAndUpdateQuery(view,nodeDef){const queryList=asQueryList(view,nodeDef.nodeIndex);if(!queryList.dirty)return;let directiveInstance,newValues=void 0;if(67108864&nodeDef.flags){const elementDef=nodeDef.parent.parent;newValues=calcQueryValues(view,elementDef.nodeIndex,elementDef.nodeIndex+elementDef.childCount,nodeDef.query,[]),directiveInstance=asProviderData(view,nodeDef.parent.nodeIndex).instance}else 134217728&nodeDef.flags&&(newValues=calcQueryValues(view,0,view.def.nodes.length-1,nodeDef.query,[]),directiveInstance=view.component);queryList.reset(newValues);const bindings=nodeDef.query.bindings;let notify=!1;for(let i=0;i<bindings.length;i++){const binding=bindings[i];let boundValue;switch(binding.bindingType){case 0:boundValue=queryList.first;break;case 1:boundValue=queryList,notify=!0}directiveInstance[binding.propName]=boundValue}notify&&queryList.notifyOnChanges()}function calcQueryValues(view,startIndex,endIndex,queryDef,values){for(let i=startIndex;i<=endIndex;i++){const nodeDef=view.def.nodes[i],valueType=nodeDef.matchedQueries[queryDef.id];if(null!=valueType&&values.push(getQueryValue(view,nodeDef,valueType)),1&nodeDef.flags&&nodeDef.element.template&&(nodeDef.element.template.nodeMatchedQueries&queryDef.filterId)===queryDef.filterId){const elementData=asElementData(view,i);if((nodeDef.childMatchedQueries&queryDef.filterId)===queryDef.filterId&&(calcQueryValues(view,i+1,i+nodeDef.childCount,queryDef,values),i+=nodeDef.childCount),16777216&nodeDef.flags){const embeddedViews=elementData.viewContainer._embeddedViews;for(let k=0;k<embeddedViews.length;k++){const embeddedView=embeddedViews[k],dvc=declaredViewContainer(embeddedView);dvc&&dvc===elementData&&calcQueryValues(embeddedView,0,embeddedView.def.nodes.length-1,queryDef,values)}}const projectedViews=elementData.template._projectedViews;if(projectedViews)for(let k=0;k<projectedViews.length;k++){const projectedView=projectedViews[k];calcQueryValues(projectedView,0,projectedView.def.nodes.length-1,queryDef,values)}}(nodeDef.childMatchedQueries&queryDef.filterId)!==queryDef.filterId&&(i+=nodeDef.childCount)}return values}function getQueryValue(view,nodeDef,queryValueType){if(null!=queryValueType)switch(queryValueType){case 1:return asElementData(view,nodeDef.nodeIndex).renderElement;case 0:return new ElementRef(asElementData(view,nodeDef.nodeIndex).renderElement);case 2:return asElementData(view,nodeDef.nodeIndex).template;case 3:return asElementData(view,nodeDef.nodeIndex).viewContainer;case 4:return asProviderData(view,nodeDef.nodeIndex).instance}}function appendNgContent(view,renderHost,def){const parentEl=getParentRenderElement(view,renderHost,def);parentEl&&visitProjectedRenderNodes(view,def.ngContent.index,1,parentEl,null,void 0)}function textDef(checkIndex,ngContentIndex,staticText){const bindings=new Array(staticText.length-1);for(let i=1;i<staticText.length;i++)bindings[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:staticText[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:checkIndex,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:ngContentIndex,childCount:0,bindings:bindings,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:staticText[0]},query:null,ngContent:null}}function createText(view,renderHost,def){let renderNode;const renderer=view.renderer;renderNode=renderer.createText(def.text.prefix);const parentEl=getParentRenderElement(view,renderHost,def);return parentEl&&renderer.appendChild(parentEl,renderNode),{renderText:renderNode}}function _addInterpolationPart(value,binding){return(null!=value?value.toString():"")+binding.suffix}function viewDef(flags,nodes,updateDirectives,updateRenderer){let viewBindingCount=0,viewDisposableCount=0,viewNodeFlags=0,viewRootNodeFlags=0,viewMatchedQueries=0,currentParent=null,currentRenderParent=null,currentElementHasPublicProviders=!1,currentElementHasPrivateProviders=!1,lastRenderRootNode=null;for(let i=0;i<nodes.length;i++){const node=nodes[i];if(node.nodeIndex=i,node.parent=currentParent,node.bindingIndex=viewBindingCount,node.outputIndex=viewDisposableCount,node.renderParent=currentRenderParent,viewNodeFlags|=node.flags,viewMatchedQueries|=node.matchedQueryIds,node.element){const elDef=node.element;elDef.publicProviders=currentParent?currentParent.element.publicProviders:Object.create(null),elDef.allProviders=elDef.publicProviders,currentElementHasPublicProviders=!1,currentElementHasPrivateProviders=!1,node.element.template&&(viewMatchedQueries|=node.element.template.nodeMatchedQueries)}if(validateNode(currentParent,node,nodes.length),viewBindingCount+=node.bindings.length,viewDisposableCount+=node.outputs.length,!currentRenderParent&&3&node.flags&&(lastRenderRootNode=node),20224&node.flags){currentElementHasPublicProviders||(currentElementHasPublicProviders=!0,currentParent.element.publicProviders=Object.create(currentParent.element.publicProviders),currentParent.element.allProviders=currentParent.element.publicProviders);const isComponent=0!=(32768&node.flags);0==(8192&node.flags)||isComponent?currentParent.element.publicProviders[tokenKey(node.provider.token)]=node:(currentElementHasPrivateProviders||(currentElementHasPrivateProviders=!0,currentParent.element.allProviders=Object.create(currentParent.element.publicProviders)),currentParent.element.allProviders[tokenKey(node.provider.token)]=node),isComponent&&(currentParent.element.componentProvider=node)}if(currentParent?(currentParent.childFlags|=node.flags,currentParent.directChildFlags|=node.flags,currentParent.childMatchedQueries|=node.matchedQueryIds,node.element&&node.element.template&&(currentParent.childMatchedQueries|=node.element.template.nodeMatchedQueries)):viewRootNodeFlags|=node.flags,node.childCount>0)currentParent=node,isNgContainer(node)||(currentRenderParent=node);else for(;currentParent&&i===currentParent.nodeIndex+currentParent.childCount;){const newParent=currentParent.parent;newParent&&(newParent.childFlags|=currentParent.childFlags,newParent.childMatchedQueries|=currentParent.childMatchedQueries),currentRenderParent=(currentParent=newParent)&&isNgContainer(currentParent)?currentParent.renderParent:currentParent}}return{factory:null,nodeFlags:viewNodeFlags,rootNodeFlags:viewRootNodeFlags,nodeMatchedQueries:viewMatchedQueries,flags:flags,nodes:nodes,updateDirectives:updateDirectives||NOOP,updateRenderer:updateRenderer||NOOP,handleEvent:(view,nodeIndex,eventName,event)=>nodes[nodeIndex].element.handleEvent(view,eventName,event),bindingCount:viewBindingCount,outputCount:viewDisposableCount,lastRenderRootNode:lastRenderRootNode}}function isNgContainer(node){return 0!=(1&node.flags)&&null===node.element.name}function validateNode(parent,node,nodeCount){const template=node.element&&node.element.template;if(template){if(!template.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(template.lastRenderRootNode&&16777216&template.lastRenderRootNode.flags)throw new Error(`Illegal State: Last root node of a template can't have embedded views, at index ${node.nodeIndex}!`)}if(20224&node.flags&&0==(1&(parent?parent.flags:0)))throw new Error(`Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ${node.nodeIndex}!`);if(node.query){if(67108864&node.flags&&(!parent||0==(16384&parent.flags)))throw new Error(`Illegal State: Content Query nodes need to be children of directives, at index ${node.nodeIndex}!`);if(134217728&node.flags&&parent)throw new Error(`Illegal State: View Query nodes have to be top level nodes, at index ${node.nodeIndex}!`)}if(node.childCount){const parentEnd=parent?parent.nodeIndex+parent.childCount:nodeCount-1;if(node.nodeIndex<=parentEnd&&node.nodeIndex+node.childCount>parentEnd)throw new Error(`Illegal State: childCount of node leads outside of parent, at index ${node.nodeIndex}!`)}}function createEmbeddedView(parent,anchorDef,viewDef,context){const view=createView(parent.root,parent.renderer,parent,anchorDef,viewDef);return initView(view,parent.component,context),createViewNodes(view),view}function createRootView(root,def,context){const view=createView(root,root.renderer,null,null,def);return initView(view,context,context),createViewNodes(view),view}function createComponentView(parentView,nodeDef,viewDef,hostElement){const rendererType=nodeDef.element.componentRendererType;let compRenderer;return compRenderer=rendererType?parentView.root.rendererFactory.createRenderer(hostElement,rendererType):parentView.root.renderer,createView(parentView.root,compRenderer,parentView,nodeDef.element.componentProvider,viewDef)}function createView(root,renderer,parent,parentNodeDef,def){const nodes=new Array(def.nodes.length),disposables=def.outputCount?new Array(def.outputCount):null;return{def:def,parent:parent,viewContainerParent:null,parentNodeDef:parentNodeDef,context:null,component:null,nodes:nodes,state:13,root:root,renderer:renderer,oldValues:new Array(def.bindingCount),disposables:disposables,initIndex:-1}}function initView(view,component,context){view.component=component,view.context=context}function createViewNodes(view){let renderHost;isComponentView(view)&&(renderHost=asElementData(view.parent,view.parentNodeDef.parent.nodeIndex).renderElement);const def=view.def,nodes=view.nodes;for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];let nodeData;switch(Services.setCurrentNode(view,i),201347067&nodeDef.flags){case 1:const el=core_createElement(view,renderHost,nodeDef);let componentView=void 0;if(33554432&nodeDef.flags){const compViewDef=resolveDefinition(nodeDef.element.componentView);componentView=Services.createComponentView(view,nodeDef,compViewDef,el)}listenToElementOutputs(view,componentView,nodeDef,el),nodeData={renderElement:el,componentView:componentView,viewContainer:null,template:nodeDef.element.template?createTemplateData(view,nodeDef):void 0},16777216&nodeDef.flags&&(nodeData.viewContainer=createViewContainerData(view,nodeDef,nodeData));break;case 2:nodeData=createText(view,renderHost,nodeDef);break;case 512:case 1024:case 2048:case 256:(nodeData=nodes[i])||4096&nodeDef.flags||(nodeData={instance:createProviderInstance(view,nodeDef)});break;case 16:nodeData={instance:createPipeInstance(view,nodeDef)};break;case 16384:(nodeData=nodes[i])||(nodeData={instance:createDirectiveInstance(view,nodeDef)}),32768&nodeDef.flags&&initView(asElementData(view,nodeDef.parent.nodeIndex).componentView,nodeData.instance,nodeData.instance);break;case 32:case 64:case 128:nodeData={value:void 0};break;case 67108864:case 134217728:nodeData=new QueryList;break;case 8:appendNgContent(view,renderHost,nodeDef),nodeData=void 0}nodes[i]=nodeData}execComponentViewsAction(view,ViewAction.CreateViewNodes),execQueriesAction(view,201326592,268435456,0)}function checkNoChangesView(view){markProjectedViewsForCheck(view),Services.updateDirectives(view,1),execEmbeddedViewsAction(view,ViewAction.CheckNoChanges),Services.updateRenderer(view,1),execComponentViewsAction(view,ViewAction.CheckNoChanges),view.state&=-97}function checkAndUpdateView(view){1&view.state?(view.state&=-2,view.state|=2):view.state&=-3,shiftInitState(view,0,256),markProjectedViewsForCheck(view),Services.updateDirectives(view,0),execEmbeddedViewsAction(view,ViewAction.CheckAndUpdate),execQueriesAction(view,67108864,536870912,0);let callInit=shiftInitState(view,256,512);callLifecycleHooksChildrenFirst(view,2097152|(callInit?1048576:0)),Services.updateRenderer(view,0),execComponentViewsAction(view,ViewAction.CheckAndUpdate),execQueriesAction(view,134217728,536870912,0),callLifecycleHooksChildrenFirst(view,8388608|((callInit=shiftInitState(view,512,768))?4194304:0)),2&view.def.flags&&(view.state&=-9),view.state&=-97,shiftInitState(view,768,1024)}function checkAndUpdateNode(view,nodeDef,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){return 0===argStyle?function(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){switch(201347067&nodeDef.flags){case 1:return function(view,def,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const bindLen=def.bindings.length;let changed=!1;return bindLen>0&&checkAndUpdateElementValue(view,def,0,v0)&&(changed=!0),bindLen>1&&checkAndUpdateElementValue(view,def,1,v1)&&(changed=!0),bindLen>2&&checkAndUpdateElementValue(view,def,2,v2)&&(changed=!0),bindLen>3&&checkAndUpdateElementValue(view,def,3,v3)&&(changed=!0),bindLen>4&&checkAndUpdateElementValue(view,def,4,v4)&&(changed=!0),bindLen>5&&checkAndUpdateElementValue(view,def,5,v5)&&(changed=!0),bindLen>6&&checkAndUpdateElementValue(view,def,6,v6)&&(changed=!0),bindLen>7&&checkAndUpdateElementValue(view,def,7,v7)&&(changed=!0),bindLen>8&&checkAndUpdateElementValue(view,def,8,v8)&&(changed=!0),bindLen>9&&checkAndUpdateElementValue(view,def,9,v9)&&(changed=!0),changed}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);case 2:return function(view,def,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){let changed=!1;const bindings=def.bindings,bindLen=bindings.length;if(bindLen>0&&checkAndUpdateBinding(view,def,0,v0)&&(changed=!0),bindLen>1&&checkAndUpdateBinding(view,def,1,v1)&&(changed=!0),bindLen>2&&checkAndUpdateBinding(view,def,2,v2)&&(changed=!0),bindLen>3&&checkAndUpdateBinding(view,def,3,v3)&&(changed=!0),bindLen>4&&checkAndUpdateBinding(view,def,4,v4)&&(changed=!0),bindLen>5&&checkAndUpdateBinding(view,def,5,v5)&&(changed=!0),bindLen>6&&checkAndUpdateBinding(view,def,6,v6)&&(changed=!0),bindLen>7&&checkAndUpdateBinding(view,def,7,v7)&&(changed=!0),bindLen>8&&checkAndUpdateBinding(view,def,8,v8)&&(changed=!0),bindLen>9&&checkAndUpdateBinding(view,def,9,v9)&&(changed=!0),changed){let value=def.text.prefix;bindLen>0&&(value+=_addInterpolationPart(v0,bindings[0])),bindLen>1&&(value+=_addInterpolationPart(v1,bindings[1])),bindLen>2&&(value+=_addInterpolationPart(v2,bindings[2])),bindLen>3&&(value+=_addInterpolationPart(v3,bindings[3])),bindLen>4&&(value+=_addInterpolationPart(v4,bindings[4])),bindLen>5&&(value+=_addInterpolationPart(v5,bindings[5])),bindLen>6&&(value+=_addInterpolationPart(v6,bindings[6])),bindLen>7&&(value+=_addInterpolationPart(v7,bindings[7])),bindLen>8&&(value+=_addInterpolationPart(v8,bindings[8])),bindLen>9&&(value+=_addInterpolationPart(v9,bindings[9]));const renderNode=asTextData(view,def.nodeIndex).renderText;view.renderer.setValue(renderNode,value)}return changed}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);case 16384:return function(view,def,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const providerData=asProviderData(view,def.nodeIndex),directive=providerData.instance;let changed=!1,changes=void 0;const bindLen=def.bindings.length;return bindLen>0&&checkBinding(view,def,0,v0)&&(changed=!0,changes=updateProp(view,providerData,def,0,v0,changes)),bindLen>1&&checkBinding(view,def,1,v1)&&(changed=!0,changes=updateProp(view,providerData,def,1,v1,changes)),bindLen>2&&checkBinding(view,def,2,v2)&&(changed=!0,changes=updateProp(view,providerData,def,2,v2,changes)),bindLen>3&&checkBinding(view,def,3,v3)&&(changed=!0,changes=updateProp(view,providerData,def,3,v3,changes)),bindLen>4&&checkBinding(view,def,4,v4)&&(changed=!0,changes=updateProp(view,providerData,def,4,v4,changes)),bindLen>5&&checkBinding(view,def,5,v5)&&(changed=!0,changes=updateProp(view,providerData,def,5,v5,changes)),bindLen>6&&checkBinding(view,def,6,v6)&&(changed=!0,changes=updateProp(view,providerData,def,6,v6,changes)),bindLen>7&&checkBinding(view,def,7,v7)&&(changed=!0,changes=updateProp(view,providerData,def,7,v7,changes)),bindLen>8&&checkBinding(view,def,8,v8)&&(changed=!0,changes=updateProp(view,providerData,def,8,v8,changes)),bindLen>9&&checkBinding(view,def,9,v9)&&(changed=!0,changes=updateProp(view,providerData,def,9,v9,changes)),changes&&directive.ngOnChanges(changes),65536&def.flags&&shouldCallLifecycleInitHook(view,256,def.nodeIndex)&&directive.ngOnInit(),262144&def.flags&&directive.ngDoCheck(),changed}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);case 32:case 64:case 128:return function(view,def,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const bindings=def.bindings;let changed=!1;const bindLen=bindings.length;if(bindLen>0&&checkAndUpdateBinding(view,def,0,v0)&&(changed=!0),bindLen>1&&checkAndUpdateBinding(view,def,1,v1)&&(changed=!0),bindLen>2&&checkAndUpdateBinding(view,def,2,v2)&&(changed=!0),bindLen>3&&checkAndUpdateBinding(view,def,3,v3)&&(changed=!0),bindLen>4&&checkAndUpdateBinding(view,def,4,v4)&&(changed=!0),bindLen>5&&checkAndUpdateBinding(view,def,5,v5)&&(changed=!0),bindLen>6&&checkAndUpdateBinding(view,def,6,v6)&&(changed=!0),bindLen>7&&checkAndUpdateBinding(view,def,7,v7)&&(changed=!0),bindLen>8&&checkAndUpdateBinding(view,def,8,v8)&&(changed=!0),bindLen>9&&checkAndUpdateBinding(view,def,9,v9)&&(changed=!0),changed){const data=asPureExpressionData(view,def.nodeIndex);let value;switch(201347067&def.flags){case 32:value=new Array(bindings.length),bindLen>0&&(value[0]=v0),bindLen>1&&(value[1]=v1),bindLen>2&&(value[2]=v2),bindLen>3&&(value[3]=v3),bindLen>4&&(value[4]=v4),bindLen>5&&(value[5]=v5),bindLen>6&&(value[6]=v6),bindLen>7&&(value[7]=v7),bindLen>8&&(value[8]=v8),bindLen>9&&(value[9]=v9);break;case 64:value={},bindLen>0&&(value[bindings[0].name]=v0),bindLen>1&&(value[bindings[1].name]=v1),bindLen>2&&(value[bindings[2].name]=v2),bindLen>3&&(value[bindings[3].name]=v3),bindLen>4&&(value[bindings[4].name]=v4),bindLen>5&&(value[bindings[5].name]=v5),bindLen>6&&(value[bindings[6].name]=v6),bindLen>7&&(value[bindings[7].name]=v7),bindLen>8&&(value[bindings[8].name]=v8),bindLen>9&&(value[bindings[9].name]=v9);break;case 128:const pipe=v0;switch(bindLen){case 1:value=pipe.transform(v0);break;case 2:value=pipe.transform(v1);break;case 3:value=pipe.transform(v1,v2);break;case 4:value=pipe.transform(v1,v2,v3);break;case 5:value=pipe.transform(v1,v2,v3,v4);break;case 6:value=pipe.transform(v1,v2,v3,v4,v5);break;case 7:value=pipe.transform(v1,v2,v3,v4,v5,v6);break;case 8:value=pipe.transform(v1,v2,v3,v4,v5,v6,v7);break;case 9:value=pipe.transform(v1,v2,v3,v4,v5,v6,v7,v8);break;case 10:value=pipe.transform(v1,v2,v3,v4,v5,v6,v7,v8,v9)}}data.value=value}return changed}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);default:throw"unreachable"}}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9):function(view,nodeDef,values){switch(201347067&nodeDef.flags){case 1:return function(view,def,values){let changed=!1;for(let i=0;i<values.length;i++)checkAndUpdateElementValue(view,def,i,values[i])&&(changed=!0);return changed}(view,nodeDef,values);case 2:return function(view,def,values){const bindings=def.bindings;let changed=!1;for(let i=0;i<values.length;i++)checkAndUpdateBinding(view,def,i,values[i])&&(changed=!0);if(changed){let value="";for(let i=0;i<values.length;i++)value+=_addInterpolationPart(values[i],bindings[i]);value=def.text.prefix+value;const renderNode=asTextData(view,def.nodeIndex).renderText;view.renderer.setValue(renderNode,value)}return changed}(view,nodeDef,values);case 16384:return function(view,def,values){const providerData=asProviderData(view,def.nodeIndex),directive=providerData.instance;let changed=!1,changes=void 0;for(let i=0;i<values.length;i++)checkBinding(view,def,i,values[i])&&(changed=!0,changes=updateProp(view,providerData,def,i,values[i],changes));return changes&&directive.ngOnChanges(changes),65536&def.flags&&shouldCallLifecycleInitHook(view,256,def.nodeIndex)&&directive.ngOnInit(),262144&def.flags&&directive.ngDoCheck(),changed}(view,nodeDef,values);case 32:case 64:case 128:return function(view,def,values){const bindings=def.bindings;let changed=!1;for(let i=0;i<values.length;i++)checkAndUpdateBinding(view,def,i,values[i])&&(changed=!0);if(changed){const data=asPureExpressionData(view,def.nodeIndex);let value;switch(201347067&def.flags){case 32:value=values;break;case 64:value={};for(let i=0;i<values.length;i++)value[bindings[i].name]=values[i];break;case 128:const pipe=values[0],params=values.slice(1);value=pipe.transform(...params)}data.value=value}return changed}(view,nodeDef,values);default:throw"unreachable"}}(view,nodeDef,v0)}function markProjectedViewsForCheck(view){const def=view.def;if(4&def.nodeFlags)for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];if(4&nodeDef.flags){const projectedViews=asElementData(view,i).template._projectedViews;if(projectedViews)for(let i=0;i<projectedViews.length;i++){const projectedView=projectedViews[i];projectedView.state|=32,markParentViewsForCheckProjectedViews(projectedView,view)}}else 0==(4&nodeDef.childFlags)&&(i+=nodeDef.childCount)}}function checkNoChangesNode(view,nodeDef,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){return 0===argStyle?function(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const bindLen=nodeDef.bindings.length;bindLen>0&&checkBindingNoChanges(view,nodeDef,0,v0),bindLen>1&&checkBindingNoChanges(view,nodeDef,1,v1),bindLen>2&&checkBindingNoChanges(view,nodeDef,2,v2),bindLen>3&&checkBindingNoChanges(view,nodeDef,3,v3),bindLen>4&&checkBindingNoChanges(view,nodeDef,4,v4),bindLen>5&&checkBindingNoChanges(view,nodeDef,5,v5),bindLen>6&&checkBindingNoChanges(view,nodeDef,6,v6),bindLen>7&&checkBindingNoChanges(view,nodeDef,7,v7),bindLen>8&&checkBindingNoChanges(view,nodeDef,8,v8),bindLen>9&&checkBindingNoChanges(view,nodeDef,9,v9)}(view,nodeDef,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9):function(view,nodeDef,values){for(let i=0;i<values.length;i++)checkBindingNoChanges(view,nodeDef,i,values[i])}(view,nodeDef,v0),!1}function checkNoChangesQuery(view,nodeDef){if(asQueryList(view,nodeDef.nodeIndex).dirty)throw expressionChangedAfterItHasBeenCheckedError(Services.createDebugContext(view,nodeDef.nodeIndex),`Query ${nodeDef.query.id} not dirty`,`Query ${nodeDef.query.id} dirty`,0!=(1&view.state))}function destroyView(view){if(!(128&view.state)){if(execEmbeddedViewsAction(view,ViewAction.Destroy),execComponentViewsAction(view,ViewAction.Destroy),callLifecycleHooksChildrenFirst(view,131072),view.disposables)for(let i=0;i<view.disposables.length;i++)view.disposables[i]();!function(view){if(!(16&view.state))return;const dvcElementData=declaredViewContainer(view);if(dvcElementData){const projectedViews=dvcElementData.template._projectedViews;projectedViews&&(removeFromArray(projectedViews,projectedViews.indexOf(view)),Services.dirtyParentQueries(view))}}(view),view.renderer.destroyNode&&function(view){const len=view.def.nodes.length;for(let i=0;i<len;i++){const def=view.def.nodes[i];1&def.flags?view.renderer.destroyNode(asElementData(view,i).renderElement):2&def.flags?view.renderer.destroyNode(asTextData(view,i).renderText):(67108864&def.flags||134217728&def.flags)&&asQueryList(view,i).destroy()}}(view),isComponentView(view)&&view.renderer.destroy(),view.state|=128}}const ViewAction=function(){var ViewAction={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return ViewAction[ViewAction.CreateViewNodes]="CreateViewNodes",ViewAction[ViewAction.CheckNoChanges]="CheckNoChanges",ViewAction[ViewAction.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",ViewAction[ViewAction.CheckAndUpdate]="CheckAndUpdate",ViewAction[ViewAction.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",ViewAction[ViewAction.Destroy]="Destroy",ViewAction}();function execComponentViewsAction(view,action){const def=view.def;if(33554432&def.nodeFlags)for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];33554432&nodeDef.flags?callViewAction(asElementData(view,i).componentView,action):0==(33554432&nodeDef.childFlags)&&(i+=nodeDef.childCount)}}function execEmbeddedViewsAction(view,action){const def=view.def;if(16777216&def.nodeFlags)for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];if(16777216&nodeDef.flags){const embeddedViews=asElementData(view,i).viewContainer._embeddedViews;for(let k=0;k<embeddedViews.length;k++)callViewAction(embeddedViews[k],action)}else 0==(16777216&nodeDef.childFlags)&&(i+=nodeDef.childCount)}}function callViewAction(view,action){const viewState=view.state;switch(action){case ViewAction.CheckNoChanges:0==(128&viewState)&&(12==(12&viewState)?checkNoChangesView(view):64&viewState&&execProjectedViewsAction(view,ViewAction.CheckNoChangesProjectedViews));break;case ViewAction.CheckNoChangesProjectedViews:0==(128&viewState)&&(32&viewState?checkNoChangesView(view):64&viewState&&execProjectedViewsAction(view,action));break;case ViewAction.CheckAndUpdate:0==(128&viewState)&&(12==(12&viewState)?checkAndUpdateView(view):64&viewState&&execProjectedViewsAction(view,ViewAction.CheckAndUpdateProjectedViews));break;case ViewAction.CheckAndUpdateProjectedViews:0==(128&viewState)&&(32&viewState?checkAndUpdateView(view):64&viewState&&execProjectedViewsAction(view,action));break;case ViewAction.Destroy:destroyView(view);break;case ViewAction.CreateViewNodes:createViewNodes(view)}}function execProjectedViewsAction(view,action){execEmbeddedViewsAction(view,action),execComponentViewsAction(view,action)}function execQueriesAction(view,queryFlags,staticDynamicQueryFlag,checkType){if(!(view.def.nodeFlags&queryFlags&&view.def.nodeFlags&staticDynamicQueryFlag))return;const nodeCount=view.def.nodes.length;for(let i=0;i<nodeCount;i++){const nodeDef=view.def.nodes[i];if(nodeDef.flags&queryFlags&&nodeDef.flags&staticDynamicQueryFlag)switch(Services.setCurrentNode(view,nodeDef.nodeIndex),checkType){case 0:checkAndUpdateQuery(view,nodeDef);break;case 1:checkNoChangesQuery(view,nodeDef)}nodeDef.childFlags&queryFlags&&nodeDef.childFlags&staticDynamicQueryFlag||(i+=nodeDef.childCount)}}let initialized=!1;function createProdRootView(elInjector,projectableNodes,rootSelectorOrNode,def,ngModule,context){const rendererFactory=ngModule.injector.get(RendererFactory2);return createRootView(createRootData(elInjector,ngModule,rendererFactory,projectableNodes,rootSelectorOrNode),def,context)}function debugCreateRootView(elInjector,projectableNodes,rootSelectorOrNode,def,ngModule,context){const rendererFactory=ngModule.injector.get(RendererFactory2),root=createRootData(elInjector,ngModule,new DebugRendererFactory2(rendererFactory),projectableNodes,rootSelectorOrNode),defWithOverride=applyProviderOverridesToView(def);return callWithDebugContext(DebugAction.create,createRootView,null,[root,defWithOverride,context])}function createRootData(elInjector,ngModule,rendererFactory,projectableNodes,rootSelectorOrNode){const sanitizer=ngModule.injector.get(Sanitizer),errorHandler=ngModule.injector.get(ErrorHandler),renderer=rendererFactory.createRenderer(null,null);return{ngModule:ngModule,injector:elInjector,projectableNodes:projectableNodes,selectorOrNode:rootSelectorOrNode,sanitizer:sanitizer,rendererFactory:rendererFactory,renderer:renderer,errorHandler:errorHandler}}function debugCreateEmbeddedView(parentView,anchorDef,viewDef,context){const defWithOverride=applyProviderOverridesToView(viewDef);return callWithDebugContext(DebugAction.create,createEmbeddedView,null,[parentView,anchorDef,defWithOverride,context])}function debugCreateComponentView(parentView,nodeDef,viewDef,hostElement){return viewDef=viewDefOverrides.get(nodeDef.element.componentProvider.provider.token)||applyProviderOverridesToView(viewDef),callWithDebugContext(DebugAction.create,createComponentView,null,[parentView,nodeDef,viewDef,hostElement])}function debugCreateNgModuleRef(moduleType,parentInjector,bootstrapComponents,def){return createNgModuleRef(moduleType,parentInjector,bootstrapComponents,function(def){const{hasOverrides:hasOverrides,hasDeprecatedOverrides:hasDeprecatedOverrides}=function(def){let hasOverrides=!1,hasDeprecatedOverrides=!1;return 0===providerOverrides.size?{hasOverrides:hasOverrides,hasDeprecatedOverrides:hasDeprecatedOverrides}:(def.providers.forEach(node=>{const override=providerOverrides.get(node.token);3840&node.flags&&override&&(hasOverrides=!0,hasDeprecatedOverrides=hasDeprecatedOverrides||override.deprecatedBehavior)}),def.modules.forEach(module=>{providerOverridesWithScope.forEach((override,token)=>{getInjectableDef(token).providedIn===module&&(hasOverrides=!0,hasDeprecatedOverrides=hasDeprecatedOverrides||override.deprecatedBehavior)})}),{hasOverrides:hasOverrides,hasDeprecatedOverrides:hasDeprecatedOverrides})}(def);return hasOverrides?(function(def){for(let i=0;i<def.providers.length;i++){const provider=def.providers[i];hasDeprecatedOverrides&&(provider.flags|=4096);const override=providerOverrides.get(provider.token);override&&(provider.flags=-3841&provider.flags|override.flags,provider.deps=splitDepsDsl(override.deps),provider.value=override.value)}if(providerOverridesWithScope.size>0){let moduleSet=new Set(def.modules);providerOverridesWithScope.forEach((override,token)=>{if(moduleSet.has(getInjectableDef(token).providedIn)){let provider={token:token,flags:override.flags|(hasDeprecatedOverrides?4096:0),deps:splitDepsDsl(override.deps),value:override.value,index:def.providers.length};def.providers.push(provider),def.providersByKey[tokenKey(token)]=provider}})}}(def=def.factory(()=>NOOP)),def):def}(def))}const providerOverrides=new Map,providerOverridesWithScope=new Map,viewDefOverrides=new Map;function debugOverrideProvider(override){let injectableDef;providerOverrides.set(override.token,override),"function"==typeof override.token&&(injectableDef=getInjectableDef(override.token))&&"function"==typeof injectableDef.providedIn&&providerOverridesWithScope.set(override.token,override)}function debugOverrideComponentView(comp,compFactory){const hostViewDef=resolveDefinition(compFactory.viewDefFactory),compViewDef=resolveDefinition(hostViewDef.nodes[0].element.componentView);viewDefOverrides.set(comp,compViewDef)}function debugClearOverrides(){providerOverrides.clear(),providerOverridesWithScope.clear(),viewDefOverrides.clear()}function applyProviderOverridesToView(def){if(0===providerOverrides.size)return def;const elementIndicesWithOverwrittenProviders=function(def){const elIndicesWithOverwrittenProviders=[];let lastElementDef=null;for(let i=0;i<def.nodes.length;i++){const nodeDef=def.nodes[i];1&nodeDef.flags&&(lastElementDef=nodeDef),lastElementDef&&3840&nodeDef.flags&&providerOverrides.has(nodeDef.provider.token)&&(elIndicesWithOverwrittenProviders.push(lastElementDef.nodeIndex),lastElementDef=null)}return elIndicesWithOverwrittenProviders}(def);if(0===elementIndicesWithOverwrittenProviders.length)return def;def=def.factory(()=>NOOP);for(let i=0;i<elementIndicesWithOverwrittenProviders.length;i++)applyProviderOverridesToElement(def,elementIndicesWithOverwrittenProviders[i]);return def;function applyProviderOverridesToElement(viewDef,elIndex){for(let i=elIndex+1;i<viewDef.nodes.length;i++){const nodeDef=viewDef.nodes[i];if(1&nodeDef.flags)return;if(3840&nodeDef.flags){const provider=nodeDef.provider,override=providerOverrides.get(provider.token);override&&(nodeDef.flags=-3841&nodeDef.flags|override.flags,provider.deps=splitDepsDsl(override.deps),provider.value=override.value)}}}}function prodCheckAndUpdateNode(view,checkIndex,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const nodeDef=view.def.nodes[checkIndex];return checkAndUpdateNode(view,nodeDef,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9),224&nodeDef.flags?asPureExpressionData(view,checkIndex).value:void 0}function prodCheckNoChangesNode(view,checkIndex,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9){const nodeDef=view.def.nodes[checkIndex];return checkNoChangesNode(view,nodeDef,argStyle,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9),224&nodeDef.flags?asPureExpressionData(view,checkIndex).value:void 0}function debugCheckAndUpdateView(view){return callWithDebugContext(DebugAction.detectChanges,checkAndUpdateView,null,[view])}function debugCheckNoChangesView(view){return callWithDebugContext(DebugAction.checkNoChanges,checkNoChangesView,null,[view])}function debugDestroyView(view){return callWithDebugContext(DebugAction.destroy,destroyView,null,[view])}const DebugAction=function(){var DebugAction={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return DebugAction[DebugAction.create]="create",DebugAction[DebugAction.detectChanges]="detectChanges",DebugAction[DebugAction.checkNoChanges]="checkNoChanges",DebugAction[DebugAction.destroy]="destroy",DebugAction[DebugAction.handleEvent]="handleEvent",DebugAction}();let _currentAction,_currentView,_currentNodeIndex;function debugSetCurrentNode(view,nodeIndex){_currentView=view,_currentNodeIndex=nodeIndex}function debugHandleEvent(view,nodeIndex,eventName,event){return debugSetCurrentNode(view,nodeIndex),callWithDebugContext(DebugAction.handleEvent,view.def.handleEvent,null,[view,nodeIndex,eventName,event])}function debugUpdateDirectives(view,checkType){if(128&view.state)throw viewDestroyedError(DebugAction[_currentAction]);return debugSetCurrentNode(view,nextDirectiveWithBinding(view,0)),view.def.updateDirectives(function(view,nodeIndex,argStyle,...values){const nodeDef=view.def.nodes[nodeIndex];return 0===checkType?debugCheckAndUpdateNode(view,nodeDef,argStyle,values):debugCheckNoChangesNode(view,nodeDef,argStyle,values),16384&nodeDef.flags&&debugSetCurrentNode(view,nextDirectiveWithBinding(view,nodeIndex)),224&nodeDef.flags?asPureExpressionData(view,nodeDef.nodeIndex).value:void 0},view)}function debugUpdateRenderer(view,checkType){if(128&view.state)throw viewDestroyedError(DebugAction[_currentAction]);return debugSetCurrentNode(view,nextRenderNodeWithBinding(view,0)),view.def.updateRenderer(function(view,nodeIndex,argStyle,...values){const nodeDef=view.def.nodes[nodeIndex];return 0===checkType?debugCheckAndUpdateNode(view,nodeDef,argStyle,values):debugCheckNoChangesNode(view,nodeDef,argStyle,values),3&nodeDef.flags&&debugSetCurrentNode(view,nextRenderNodeWithBinding(view,nodeIndex)),224&nodeDef.flags?asPureExpressionData(view,nodeDef.nodeIndex).value:void 0},view)}function debugCheckAndUpdateNode(view,nodeDef,argStyle,givenValues){if(checkAndUpdateNode(view,nodeDef,argStyle,...givenValues)){const values=1===argStyle?givenValues[0]:givenValues;if(16384&nodeDef.flags){const bindingValues={};for(let i=0;i<nodeDef.bindings.length;i++){const binding=nodeDef.bindings[i],value=values[i];8&binding.flags&&(bindingValues[(name=binding.nonMinifiedName,input=void 0,input=name.replace(/[$@]/g,"_"),`ng-reflect-${name=input.replace(CAMEL_CASE_REGEXP,(...m)=>"-"+m[1].toLowerCase())}`)]=normalizeDebugBindingValue(value))}const elDef=nodeDef.parent,el=asElementData(view,elDef.nodeIndex).renderElement;if(elDef.element.name)for(let attr in bindingValues){const value=bindingValues[attr];null!=value?view.renderer.setAttribute(el,attr,value):view.renderer.removeAttribute(el,attr)}else view.renderer.setValue(el,`bindings=${JSON.stringify(bindingValues,null,2)}`)}}var name,input}function debugCheckNoChangesNode(view,nodeDef,argStyle,values){checkNoChangesNode(view,nodeDef,argStyle,...values)}function nextDirectiveWithBinding(view,nodeIndex){for(let i=nodeIndex;i<view.def.nodes.length;i++){const nodeDef=view.def.nodes[i];if(16384&nodeDef.flags&&nodeDef.bindings&&nodeDef.bindings.length)return i}return null}function nextRenderNodeWithBinding(view,nodeIndex){for(let i=nodeIndex;i<view.def.nodes.length;i++){const nodeDef=view.def.nodes[i];if(3&nodeDef.flags&&nodeDef.bindings&&nodeDef.bindings.length)return i}return null}class DebugContext_{constructor(view,nodeIndex){this.view=view,this.nodeIndex=nodeIndex,null==nodeIndex&&(this.nodeIndex=nodeIndex=0),this.nodeDef=view.def.nodes[nodeIndex];let elDef=this.nodeDef,elView=view;for(;elDef&&0==(1&elDef.flags);)elDef=elDef.parent;if(!elDef)for(;!elDef&&elView;)elDef=viewParentEl(elView),elView=elView.parent;this.elDef=elDef,this.elView=elView}get elOrCompView(){return asElementData(this.elView,this.elDef.nodeIndex).componentView||this.view}get injector(){return createInjector$1(this.elView,this.elDef)}get component(){return this.elOrCompView.component}get context(){return this.elOrCompView.context}get providerTokens(){const tokens=[];if(this.elDef)for(let i=this.elDef.nodeIndex+1;i<=this.elDef.nodeIndex+this.elDef.childCount;i++){const childDef=this.elView.def.nodes[i];20224&childDef.flags&&tokens.push(childDef.provider.token),i+=childDef.childCount}return tokens}get references(){const references={};if(this.elDef){collectReferences(this.elView,this.elDef,references);for(let i=this.elDef.nodeIndex+1;i<=this.elDef.nodeIndex+this.elDef.childCount;i++){const childDef=this.elView.def.nodes[i];20224&childDef.flags&&collectReferences(this.elView,childDef,references),i+=childDef.childCount}}return references}get componentRenderElement(){const elData=function(view){for(;view&&!isComponentView(view);)view=view.parent;return view.parent?asElementData(view.parent,viewParentEl(view).nodeIndex):null}(this.elOrCompView);return elData?elData.renderElement:void 0}get renderNode(){return 2&this.nodeDef.flags?renderNode(this.view,this.nodeDef):renderNode(this.elView,this.elDef)}logError(console,...values){let logViewDef,logNodeIndex;2&this.nodeDef.flags?(logViewDef=this.view.def,logNodeIndex=this.nodeDef.nodeIndex):(logViewDef=this.elView.def,logNodeIndex=this.elDef.nodeIndex);const renderNodeIndex=function(viewDef,nodeIndex){let renderNodeIndex=-1;for(let i=0;i<=nodeIndex;i++)3&viewDef.nodes[i].flags&&renderNodeIndex++;return renderNodeIndex}(logViewDef,logNodeIndex);let currRenderNodeIndex=-1;logViewDef.factory(()=>++currRenderNodeIndex===renderNodeIndex?console.error.bind(console,...values):NOOP),currRenderNodeIndex<renderNodeIndex&&(console.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),console.error(...values))}}function collectReferences(view,nodeDef,references){for(let refName in nodeDef.references)references[refName]=getQueryValue(view,nodeDef,nodeDef.references[refName])}function callWithDebugContext(action,fn,self,args){const oldAction=_currentAction,oldView=_currentView,oldNodeIndex=_currentNodeIndex;try{_currentAction=action;const result=fn.apply(self,args);return _currentView=oldView,_currentNodeIndex=oldNodeIndex,_currentAction=oldAction,result}catch(e){if(getDebugContext(e)||!_currentView)throw e;throw function(err,context){return err instanceof Error||(err=new Error(err.toString())),_addDebugContext(err,context),err}(e,getCurrentDebugContext())}}function getCurrentDebugContext(){return _currentView?new DebugContext_(_currentView,_currentNodeIndex):null}class DebugRendererFactory2{constructor(delegate){this.delegate=delegate}createRenderer(element,renderData){return new DebugRenderer2(this.delegate.createRenderer(element,renderData))}begin(){this.delegate.begin&&this.delegate.begin()}end(){this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}class DebugRenderer2{constructor(delegate){this.delegate=delegate,this.debugContextFactory=getCurrentDebugContext,this.data=this.delegate.data}createDebugContext(nativeElement){return this.debugContextFactory(nativeElement)}destroyNode(node){const debugNode=getDebugNode(node);_nativeNodeToDebugNode.delete(debugNode.nativeNode),debugNode instanceof DebugNode__PRE_R3__&&(debugNode.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(node)}destroy(){this.delegate.destroy()}createElement(name,namespace){const el=this.delegate.createElement(name,namespace),debugCtx=this.createDebugContext(el);if(debugCtx){const debugEl=new DebugElement__PRE_R3__(el,null,debugCtx);debugEl.name=name,indexDebugNode(debugEl)}return el}createComment(value){const comment=this.delegate.createComment(value),debugCtx=this.createDebugContext(comment);return debugCtx&&indexDebugNode(new DebugNode__PRE_R3__(comment,null,debugCtx)),comment}createText(value){const text=this.delegate.createText(value),debugCtx=this.createDebugContext(text);return debugCtx&&indexDebugNode(new DebugNode__PRE_R3__(text,null,debugCtx)),text}appendChild(parent,newChild){const debugEl=getDebugNode(parent),debugChildEl=getDebugNode(newChild);debugEl&&debugChildEl&&debugEl instanceof DebugElement__PRE_R3__&&debugEl.addChild(debugChildEl),this.delegate.appendChild(parent,newChild)}insertBefore(parent,newChild,refChild){const debugEl=getDebugNode(parent),debugChildEl=getDebugNode(newChild),debugRefEl=getDebugNode(refChild);debugEl&&debugChildEl&&debugEl instanceof DebugElement__PRE_R3__&&debugEl.insertBefore(debugRefEl,debugChildEl),this.delegate.insertBefore(parent,newChild,refChild)}removeChild(parent,oldChild){const debugEl=getDebugNode(parent),debugChildEl=getDebugNode(oldChild);debugEl&&debugChildEl&&debugEl instanceof DebugElement__PRE_R3__&&debugEl.removeChild(debugChildEl),this.delegate.removeChild(parent,oldChild)}selectRootElement(selectorOrNode,preserveContent){const el=this.delegate.selectRootElement(selectorOrNode,preserveContent),debugCtx=getCurrentDebugContext();return debugCtx&&indexDebugNode(new DebugElement__PRE_R3__(el,null,debugCtx)),el}setAttribute(el,name,value,namespace){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.attributes[namespace?namespace+":"+name:name]=value),this.delegate.setAttribute(el,name,value,namespace)}removeAttribute(el,name,namespace){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.attributes[namespace?namespace+":"+name:name]=null),this.delegate.removeAttribute(el,name,namespace)}addClass(el,name){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.classes[name]=!0),this.delegate.addClass(el,name)}removeClass(el,name){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.classes[name]=!1),this.delegate.removeClass(el,name)}setStyle(el,style,value,flags){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.styles[style]=value),this.delegate.setStyle(el,style,value,flags)}removeStyle(el,style,flags){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.styles[style]=null),this.delegate.removeStyle(el,style,flags)}setProperty(el,name,value){const debugEl=getDebugNode(el);debugEl&&debugEl instanceof DebugElement__PRE_R3__&&(debugEl.properties[name]=value),this.delegate.setProperty(el,name,value)}listen(target,eventName,callback){if("string"!=typeof target){const debugEl=getDebugNode(target);debugEl&&debugEl.listeners.push(new DebugEventListener(eventName,callback))}return this.delegate.listen(target,eventName,callback)}parentNode(node){return this.delegate.parentNode(node)}nextSibling(node){return this.delegate.nextSibling(node)}setValue(node,value){return this.delegate.setValue(node,value)}}function createNgModuleFactory(ngModuleType,bootstrapComponents,defFactory){return new NgModuleFactory_(ngModuleType,bootstrapComponents,defFactory)}class NgModuleFactory_ extends NgModuleFactory{constructor(moduleType,_bootstrapComponents,_ngModuleDefFactory){super(),this.moduleType=moduleType,this._bootstrapComponents=_bootstrapComponents,this._ngModuleDefFactory=_ngModuleDefFactory}create(parentInjector){!function(){if(initialized)return;initialized=!0;const services=isDevMode()?{setCurrentNode:debugSetCurrentNode,createRootView:debugCreateRootView,createEmbeddedView:debugCreateEmbeddedView,createComponentView:debugCreateComponentView,createNgModuleRef:debugCreateNgModuleRef,overrideProvider:debugOverrideProvider,overrideComponentView:debugOverrideComponentView,clearOverrides:debugClearOverrides,checkAndUpdateView:debugCheckAndUpdateView,checkNoChangesView:debugCheckNoChangesView,destroyView:debugDestroyView,createDebugContext:(view,nodeIndex)=>new DebugContext_(view,nodeIndex),handleEvent:debugHandleEvent,updateDirectives:debugUpdateDirectives,updateRenderer:debugUpdateRenderer}:{setCurrentNode:()=>{},createRootView:createProdRootView,createEmbeddedView:createEmbeddedView,createComponentView:createComponentView,createNgModuleRef:createNgModuleRef,overrideProvider:NOOP,overrideComponentView:NOOP,clearOverrides:NOOP,checkAndUpdateView:checkAndUpdateView,checkNoChangesView:checkNoChangesView,destroyView:destroyView,createDebugContext:(view,nodeIndex)=>new DebugContext_(view,nodeIndex),handleEvent:(view,nodeIndex,eventName,event)=>view.def.handleEvent(view,nodeIndex,eventName,event),updateDirectives:(view,checkType)=>view.def.updateDirectives(0===checkType?prodCheckAndUpdateNode:prodCheckNoChangesNode,view),updateRenderer:(view,checkType)=>view.def.updateRenderer(0===checkType?prodCheckAndUpdateNode:prodCheckNoChangesNode,view)};Services.setCurrentNode=services.setCurrentNode,Services.createRootView=services.createRootView,Services.createEmbeddedView=services.createEmbeddedView,Services.createComponentView=services.createComponentView,Services.createNgModuleRef=services.createNgModuleRef,Services.overrideProvider=services.overrideProvider,Services.overrideComponentView=services.overrideComponentView,Services.clearOverrides=services.clearOverrides,Services.checkAndUpdateView=services.checkAndUpdateView,Services.checkNoChangesView=services.checkNoChangesView,Services.destroyView=services.destroyView,Services.resolveDep=resolveDep,Services.createDebugContext=services.createDebugContext,Services.handleEvent=services.handleEvent,Services.updateDirectives=services.updateDirectives,Services.updateRenderer=services.updateRenderer,Services.dirtyParentQueries=dirtyParentQueries}();const def=function(def){const providers=Array.from(def.providers),modules=Array.from(def.modules),providersByKey={};for(const key in def.providersByKey)providersByKey[key]=def.providersByKey[key];return{factory:def.factory,isRoot:def.isRoot,providers:providers,modules:modules,providersByKey:providersByKey}}(resolveDefinition(this._ngModuleDefFactory));return Services.createNgModuleRef(this.moduleType,parentInjector||Injector.NULL,this._bootstrapComponents,def)}}class AppModule{}let projectResources=[{resourceId:1,resourceName:"Project Manager"},{resourceId:2,resourceName:"Software Analyst"},{resourceId:3,resourceName:"Developer"},{resourceId:4,resourceName:"Testing Engineer"}],projectData=[{taskID:1,taskName:"OTRO",startDate:new Date("07/24/2019 06:00"),endDate:new Date("07/25/2019 23:00"),subtasks:[{taskID:4,taskName:"PS009",startDate:new Date("07/24/2019 06:00"),endDate:new Date("07/24/2019 08:00"),duration:5,progress:"100",resourceId:[1]},{taskID:5,taskName:"VM186",startDate:new Date("07/24/2019 06:00"),endDate:new Date("07/24/2019 14:00"),duration:5,progress:"100",resourceId:[1]},{taskID:6,taskName:"VM182",startDate:new Date("07/24/2019 14:00"),endDate:new Date("07/24/2019 22:00"),duration:5,progress:"100",resourceId:[1]},{taskID:7,taskName:"SN003",startDate:new Date("07/25/2019 14:00"),endDate:new Date("07/25/2019 23:00"),duration:0}]},{taskID:2,taskName:"VOLVO",duration:3,startDate:new Date("07/24/2019 06:00"),endDate:new Date("07/25/2019 16:00"),subtasks:[{taskID:8,taskName:"VO134",startDate:new Date("07/24/2019 06:00"),endDate:new Date("07/24/2019 14:00"),duration:3,progress:"60",resourceId:[2]},{taskID:9,taskName:"EX003",startDate:new Date("07/25/2019 08:00"),endDate:new Date("07/25/2019 10:00"),duration:3,progress:"100",predecessor:"VOLVO",resourceId:[3]},{taskID:10,taskName:"VU010",startDate:new Date("07/25/2019 14:00"),endDate:new Date("07/25/2019 17:00"),duration:2,progress:"80",predecessor:"VOLVO",resourceId:[1]}]}];class app_component_AppComponent{constructor(){this.yearformat=[{id:'MMM "yy',format:'Jan "18'},{id:"y",format:"2018"},{id:"MMMM, y",format:"January, 18"}],this.monthformat=[{id:"MMM dd, yyyy",format:"Jan 01, 2018"},{id:"MMMM",format:"January"},{id:"MMM",format:"Jan"}],this.weekformat=[{id:"MMM dd, yyyy",format:"Jan 01, 2019"},{id:'EEE MMM dd, "yy',format:'Mon Jan 01, "19'},{id:"EEE MMM dd",format:"Mon Jan 01"}],this.dayformat=[{id:"EEE, dd",format:"Mon, 01"},{id:"E",format:"Mon"},{id:"dd",format:"01"}],this.hourformat=[{id:"hh",format:"00"},{id:"hh : mm a",format:"00 : 00 AM"},{id:"h : mm a",format:"0 : 00 AM"}],this.unit=[{id:"Year",unit:"Year"},{id:"Month",unit:"Month"},{id:"Week",unit:"Week"},{id:"Day",unit:"Day"},{id:"Hour",unit:"Hour"}],this.formatFields={text:"format",value:"id"},this.unitFields={text:"unit",value:"id"},this.unitValue="Week",this.topFormatValue="MMM dd, yyyy",this.bottomUnitValue="Day"}ngAfterViewInit(){}ngOnInit(){this.data=projectData,this.taskSettings={id:"taskID",name:"taskName",startDate:"startDate",endDate:"endDate",duration:"duration",progress:"progress",dependency:"predecessor",child:"subtasks"},this.timelineSettings={topTier:{unit:"Week",format:"MMM dd, yyyy"},bottomTier:{unit:"Day",count:1}},this.labelSettings={rightLabel:"taskName"},this.splitterSettings={columnIndex:4},this.projectStartDate=new Date("07/12/2019"),this.projectEndDate=new Date("08/30/2019"),this.eventMarkers=[{day:"07/21/2019",label:"Deliveries"}],this.resources=projectResources}onUnitWidthChange(args){this.ganttObj.timelineSettings.timelineUnitSize=+args.value}onTopTierChange(args){args.checked?(this.enableDisableTopTierInputs(!0),this.ganttObj.timelineSettings.topTier.unit="Week"):(this.enableDisableTopTierInputs(!1),this.ganttObj.timelineSettings.topTier.unit="None")}onBottomTierChange(args){args.checked?(this.enableDisableBottomTierInputs(!0),this.ganttObj.timelineSettings.bottomTier.unit="Day"):(this.enableDisableBottomTierInputs(!1),this.ganttObj.timelineSettings.bottomTier.unit="None")}onTopCountChange(args){this.ganttObj.timelineSettings.topTier.count=+args.value}onChangeUnit(args){const unit=args.value;"Year"===unit?this.topTierFormatObj.dataSource=this.yearformat:"Month"===unit?this.topTierFormatObj.dataSource=this.monthformat:"Week"===unit?this.topTierFormatObj.dataSource=this.weekformat:"Day"===unit?this.topTierFormatObj.dataSource=this.dayformat:"Hour"===unit&&(this.topTierFormatObj.dataSource=this.hourformat),this.topTierFormatObj.refresh(),this.updateUnitWidth(unit,"top"),this.ganttObj.timelineSettings.topTier.unit=unit}onChangeFormat(args){this.ganttObj.timelineSettings.topTier.format=args.value.toString()}onBottomCountChange(args){this.ganttObj.timelineSettings.bottomTier.count=+args.value}onChangebtUnit(args){const unit=args.value;"Year"===unit?this.bottomTierFormatObj.dataSource=this.yearformat:"Month"===unit?this.bottomTierFormatObj.dataSource=this.monthformat:"Week"===unit?this.bottomTierFormatObj.dataSource=this.weekformat:"Day"===unit?this.bottomTierFormatObj.dataSource=this.dayformat:"Hour"===unit&&(this.bottomTierFormatObj.dataSource=this.hourformat),this.bottomTierFormatObj.refresh(),this.updateUnitWidth(unit,"bottom"),this.ganttObj.timelineSettings.bottomTier.unit=unit}onChangebtFormat(args){this.ganttObj.timelineSettings.bottomTier.format=args.value.toString()}enableDisableTopTierInputs(value){this.topCountNumericObj.enabled=value,this.topUnitDropdownObj.enabled=value,this.topTierFormatObj.enabled=value}enableDisableBottomTierInputs(value){this.bottomCountNumericObj.enabled=value,this.bottomUnitDropdownObj.enabled=value,this.bottomTierFormatObj.enabled=value}updateUnitWidth(unit,tier){const topUnit="top"===tier?unit:this.ganttObj.timelineSettings.topTier.unit,bottomUnit="bottom"===tier?unit:this.ganttObj.timelineSettings.bottomTier.unit,units=["None","Hour","Day","Week","Month","Year"];let bootomCellUnit,unitWidth;"Year"===(bootomCellUnit=0===units.indexOf(topUnit)&&0===units.indexOf(bottomUnit)?"Day":0===units.indexOf(topUnit)&&units.indexOf(bottomUnit)>0?bottomUnit:units.indexOf(topUnit)>0&&0===units.indexOf(bottomUnit)?topUnit:units.indexOf(topUnit)<=units.indexOf(bottomUnit)?topUnit:bottomUnit)?unitWidth=2e3:"Month"===bootomCellUnit?unitWidth=300:"Week"===bootomCellUnit?unitWidth=150:"Day"===bootomCellUnit?unitWidth=33:"Hour"===bootomCellUnit&&(unitWidth=25),this.unitWidthNumericObject.value=unitWidth}}class PlatformLocation{}const LOCATION_INITIALIZED=new InjectionToken("Location Initialized");class LocationStrategy{}const APP_BASE_HREF=new InjectionToken("appBaseHref");class common_Location{constructor(platformStrategy,platformLocation){this._subject=new core_EventEmitter,this._urlChangeListeners=[],this._platformStrategy=platformStrategy;const browserBaseHref=this._platformStrategy.getBaseHref();this._platformLocation=platformLocation,this._baseHref=common_Location.stripTrailingSlash(_stripIndexHtml(browserBaseHref)),this._platformStrategy.onPopState(ev=>{this._subject.emit({url:this.path(!0),pop:!0,state:ev.state,type:ev.type})})}path(includeHash=!1){return this.normalize(this._platformStrategy.path(includeHash))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(path,query=""){return this.path()==this.normalize(path+common_Location.normalizeQueryParams(query))}normalize(url){return common_Location.stripTrailingSlash(function(baseHref,url){return baseHref&&url.startsWith(baseHref)?url.substring(baseHref.length):url}(this._baseHref,_stripIndexHtml(url)))}prepareExternalUrl(url){return url&&"/"!==url[0]&&(url="/"+url),this._platformStrategy.prepareExternalUrl(url)}go(path,query="",state=null){this._platformStrategy.pushState(state,"",path,query),this._notifyUrlChangeListeners(this.prepareExternalUrl(path+common_Location.normalizeQueryParams(query)),state)}replaceState(path,query="",state=null){this._platformStrategy.replaceState(state,"",path,query),this._notifyUrlChangeListeners(this.prepareExternalUrl(path+common_Location.normalizeQueryParams(query)),state)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(fn){this._urlChangeListeners.push(fn),this.subscribe(v=>{this._notifyUrlChangeListeners(v.url,v.state)})}_notifyUrlChangeListeners(url="",state){this._urlChangeListeners.forEach(fn=>fn(url,state))}subscribe(onNext,onThrow,onReturn){return this._subject.subscribe({next:onNext,error:onThrow,complete:onReturn})}static normalizeQueryParams(params){return params&&"?"!==params[0]?"?"+params:params}static joinWithSlash(start,end){if(0==start.length)return end;if(0==end.length)return start;let slashes=0;return start.endsWith("/")&&slashes++,end.startsWith("/")&&slashes++,2==slashes?start+end.substring(1):1==slashes?start+end:start+"/"+end}static stripTrailingSlash(url){const match=url.match(/#|\?|$/),pathEndIdx=match&&match.index||url.length;return url.slice(0,pathEndIdx-("/"===url[pathEndIdx-1]?1:0))+url.slice(pathEndIdx)}}function _stripIndexHtml(url){return url.replace(/\/index.html$/,"")}class HashLocationStrategy extends LocationStrategy{constructor(_platformLocation,_baseHref){super(),this._platformLocation=_platformLocation,this._baseHref="",null!=_baseHref&&(this._baseHref=_baseHref)}onPopState(fn){this._platformLocation.onPopState(fn),this._platformLocation.onHashChange(fn)}getBaseHref(){return this._baseHref}path(includeHash=!1){let path=this._platformLocation.hash;return null==path&&(path="#"),path.length>0?path.substring(1):path}prepareExternalUrl(internal){const url=common_Location.joinWithSlash(this._baseHref,internal);return url.length>0?"#"+url:url}pushState(state,title,path,queryParams){let url=this.prepareExternalUrl(path+common_Location.normalizeQueryParams(queryParams));0==url.length&&(url=this._platformLocation.pathname),this._platformLocation.pushState(state,title,url)}replaceState(state,title,path,queryParams){let url=this.prepareExternalUrl(path+common_Location.normalizeQueryParams(queryParams));0==url.length&&(url=this._platformLocation.pathname),this._platformLocation.replaceState(state,title,url)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}class PathLocationStrategy extends LocationStrategy{constructor(_platformLocation,href){if(super(),this._platformLocation=_platformLocation,null==href&&(href=this._platformLocation.getBaseHrefFromDOM()),null==href)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=href}onPopState(fn){this._platformLocation.onPopState(fn),this._platformLocation.onHashChange(fn)}getBaseHref(){return this._baseHref}prepareExternalUrl(internal){return common_Location.joinWithSlash(this._baseHref,internal)}path(includeHash=!1){const pathname=this._platformLocation.pathname+common_Location.normalizeQueryParams(this._platformLocation.search),hash=this._platformLocation.hash;return hash&&includeHash?`${pathname}${hash}`:pathname}pushState(state,title,url,queryParams){const externalUrl=this.prepareExternalUrl(url+common_Location.normalizeQueryParams(queryParams));this._platformLocation.pushState(state,title,externalUrl)}replaceState(state,title,url,queryParams){const externalUrl=this.prepareExternalUrl(url+common_Location.normalizeQueryParams(queryParams));this._platformLocation.replaceState(state,title,externalUrl)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}const Plural=function(){var Plural={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return Plural[Plural.Zero]="Zero",Plural[Plural.One]="One",Plural[Plural.Two]="Two",Plural[Plural.Few]="Few",Plural[Plural.Many]="Many",Plural[Plural.Other]="Other",Plural}(),common_getLocalePluralCase=function(locale){return function(locale){const normalizedLocale=locale.toLowerCase().replace(/_/g,"-");let match=LOCALE_DATA[normalizedLocale];if(match)return match;const parentLocale=normalizedLocale.split("-")[0];if(match=LOCALE_DATA[parentLocale])return match;if("en"===parentLocale)return localeEn;throw new Error(`Missing locale data for the locale "${locale}".`)}(locale)[LocaleDataIndex.PluralCase]},DEPRECATED_PLURAL_FN=new InjectionToken("UseV4Plurals");class NgLocalization{}class NgLocaleLocalization extends NgLocalization{constructor(locale,deprecatedPluralFn){super(),this.locale=locale,this.deprecatedPluralFn=deprecatedPluralFn}getPluralCategory(value,locale){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(locale||this.locale,value):common_getLocalePluralCase(locale||this.locale)(value)){case Plural.Zero:return"zero";case Plural.One:return"one";case Plural.Two:return"two";case Plural.Few:return"few";case Plural.Many:return"many";default:return"other"}}}class CommonModule{}const DOCUMENT=new InjectionToken("DocumentToken"),PLATFORM_SERVER_ID="server";let common_ViewportScroller=(()=>{class ViewportScroller{}return ViewportScroller.ngInjectableDef=ɵɵdefineInjectable({token:ViewportScroller,providedIn:"root",factory:()=>new BrowserViewportScroller(ɵɵinject(DOCUMENT),window,ɵɵinject(ErrorHandler))}),ViewportScroller})();class BrowserViewportScroller{constructor(document,window,errorHandler){this.document=document,this.window=window,this.errorHandler=errorHandler,this.offset=()=>[0,0]}setOffset(offset){this.offset=Array.isArray(offset)?()=>offset:offset}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(position){this.supportScrollRestoration()&&this.window.scrollTo(position[0],position[1])}scrollToAnchor(anchor){if(this.supportScrollRestoration()){anchor=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(anchor):anchor.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const elSelectedById=this.document.querySelector(`#${anchor}`);if(elSelectedById)return void this.scrollToElement(elSelectedById);const elSelectedByName=this.document.querySelector(`[name='${anchor}']`);if(elSelectedByName)return void this.scrollToElement(elSelectedByName)}catch(e){this.errorHandler.handleError(e)}}}setHistoryScrollRestoration(scrollRestoration){if(this.supportScrollRestoration()){const history=this.window.history;history&&history.scrollRestoration&&(history.scrollRestoration=scrollRestoration)}}scrollToElement(el){const rect=el.getBoundingClientRect(),left=rect.left+this.window.pageXOffset,top=rect.top+this.window.pageYOffset,offset=this.offset();this.window.scrollTo(left-offset[0],top-offset[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(_a){return!1}}}const empty_EMPTY=new Observable_Observable(subscriber=>subscriber.complete());function empty_empty(scheduler){return scheduler?function(scheduler){return new Observable_Observable(subscriber=>scheduler.schedule(()=>subscriber.complete()))}(scheduler):empty_EMPTY}function scalar(value){const result=new Observable_Observable(subscriber=>{subscriber.next(value),subscriber.complete()});return result._isScalar=!0,result.value=value,result}function of(...args){let scheduler=args[args.length-1];switch(isScheduler(scheduler)?args.pop():scheduler=void 0,args.length){case 0:return empty_empty(scheduler);case 1:return scheduler?fromArray(args,scheduler):scalar(args[0]);default:return fromArray(args,scheduler)}}class BehaviorSubject_BehaviorSubject extends Subject_Subject{constructor(_value){super(),this._value=_value}get value(){return this.getValue()}_subscribe(subscriber){const subscription=super._subscribe(subscriber);return subscription&&!subscription.closed&&subscriber.next(this._value),subscription}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError;return this._value}next(value){super.next(this._value=value)}}function EmptyErrorImpl(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}EmptyErrorImpl.prototype=Object.create(Error.prototype);const EmptyError=EmptyErrorImpl,NONE={};class CombineLatestOperator{constructor(resultSelector){this.resultSelector=resultSelector}call(subscriber,source){return source.subscribe(new combineLatest_CombineLatestSubscriber(subscriber,this.resultSelector))}}class combineLatest_CombineLatestSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,resultSelector){super(destination),this.resultSelector=resultSelector,this.active=0,this.values=[],this.observables=[]}_next(observable){this.values.push(NONE),this.observables.push(observable)}_complete(){const observables=this.observables,len=observables.length;if(0===len)this.destination.complete();else{this.active=len,this.toRespond=len;for(let i=0;i<len;i++){const observable=observables[i];this.add(subscribeToResult(this,observable,observable,i))}}}notifyComplete(unused){0==(this.active-=1)&&this.destination.complete()}notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){const values=this.values,toRespond=this.toRespond?values[outerIndex]===NONE?--this.toRespond:this.toRespond:0;values[outerIndex]=innerValue,0===toRespond&&(this.resultSelector?this._tryResultSelector(values):this.destination.next(values.slice()))}_tryResultSelector(values){let result;try{result=this.resultSelector.apply(this,values)}catch(err){return void this.destination.error(err)}this.destination.next(result)}}function defer_defer(observableFactory){return new Observable_Observable(subscriber=>{let input;try{input=observableFactory()}catch(err){return void subscriber.error(err)}return(input?from_from(input):empty_empty()).subscribe(subscriber)})}function concatAll(){return mergeAll(1)}function filter_filter(predicate,thisArg){return function(source){return source.lift(new FilterOperator(predicate,thisArg))}}class FilterOperator{constructor(predicate,thisArg){this.predicate=predicate,this.thisArg=thisArg}call(subscriber,source){return source.subscribe(new filter_FilterSubscriber(subscriber,this.predicate,this.thisArg))}}class filter_FilterSubscriber extends Subscriber_Subscriber{constructor(destination,predicate,thisArg){super(destination),this.predicate=predicate,this.thisArg=thisArg,this.count=0}_next(value){let result;try{result=this.predicate.call(this.thisArg,value,this.count++)}catch(err){return void this.destination.error(err)}result&&this.destination.next(value)}}function ArgumentOutOfRangeErrorImpl(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}ArgumentOutOfRangeErrorImpl.prototype=Object.create(Error.prototype);const ArgumentOutOfRangeError=ArgumentOutOfRangeErrorImpl;function takeLast(count){return function(source){return 0===count?empty_empty():source.lift(new takeLast_TakeLastOperator(count))}}class takeLast_TakeLastOperator{constructor(total){if(this.total=total,this.total<0)throw new ArgumentOutOfRangeError}call(subscriber,source){return source.subscribe(new takeLast_TakeLastSubscriber(subscriber,this.total))}}class takeLast_TakeLastSubscriber extends Subscriber_Subscriber{constructor(destination,total){super(destination),this.total=total,this.ring=new Array,this.count=0}_next(value){const ring=this.ring,total=this.total,count=this.count++;ring.length<total?ring.push(value):ring[count%total]=value}_complete(){const destination=this.destination;let count=this.count;if(count>0){const total=this.count>=this.total?this.total:this.count,ring=this.ring;for(let i=0;i<total;i++){const idx=count++%total;destination.next(ring[idx])}}destination.complete()}}function tap(nextOrObserver,error,complete){return function(source){return source.lift(new DoOperator(nextOrObserver,error,complete))}}class DoOperator{constructor(nextOrObserver,error,complete){this.nextOrObserver=nextOrObserver,this.error=error,this.complete=complete}call(subscriber,source){return source.subscribe(new tap_TapSubscriber(subscriber,this.nextOrObserver,this.error,this.complete))}}class tap_TapSubscriber extends Subscriber_Subscriber{constructor(destination,observerOrNext,error,complete){super(destination),this._tapNext=noop,this._tapError=noop,this._tapComplete=noop,this._tapError=error||noop,this._tapComplete=complete||noop,isFunction(observerOrNext)?(this._context=this,this._tapNext=observerOrNext):observerOrNext&&(this._context=observerOrNext,this._tapNext=observerOrNext.next||noop,this._tapError=observerOrNext.error||noop,this._tapComplete=observerOrNext.complete||noop)}_next(value){try{this._tapNext.call(this._context,value)}catch(err){return void this.destination.error(err)}this.destination.next(value)}_error(err){try{this._tapError.call(this._context,err)}catch(err){return void this.destination.error(err)}this.destination.error(err)}_complete(){try{this._tapComplete.call(this._context)}catch(err){return void this.destination.error(err)}return this.destination.complete()}}const throwIfEmpty=(errorFactory=function(){return new EmptyError})=>tap({hasValue:!1,next(){this.hasValue=!0},complete(){if(!this.hasValue)throw errorFactory()}});function defaultIfEmpty(defaultValue=null){return source=>source.lift(new DefaultIfEmptyOperator(defaultValue))}class DefaultIfEmptyOperator{constructor(defaultValue){this.defaultValue=defaultValue}call(subscriber,source){return source.subscribe(new defaultIfEmpty_DefaultIfEmptySubscriber(subscriber,this.defaultValue))}}class defaultIfEmpty_DefaultIfEmptySubscriber extends Subscriber_Subscriber{constructor(destination,defaultValue){super(destination),this.defaultValue=defaultValue,this.isEmpty=!0}_next(value){this.isEmpty=!1,this.destination.next(value)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function last_last(predicate,defaultValue){const hasDefaultValue=arguments.length>=2;return source=>source.pipe(predicate?filter_filter((v,i)=>predicate(v,i,source)):identity,takeLast(1),hasDefaultValue?defaultIfEmpty(defaultValue):throwIfEmpty(()=>new EmptyError))}function catchError(selector){return function(source){const operator=new CatchOperator(selector),caught=source.lift(operator);return operator.caught=caught}}class CatchOperator{constructor(selector){this.selector=selector}call(subscriber,source){return source.subscribe(new catchError_CatchSubscriber(subscriber,this.selector,this.caught))}}class catchError_CatchSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,selector,caught){super(destination),this.selector=selector,this.caught=caught}error(err){if(!this.isStopped){let result;try{result=this.selector(err,this.caught)}catch(err2){return void super.error(err2)}this._unsubscribeAndRecycle();const innerSubscriber=new InnerSubscriber_InnerSubscriber(this,void 0,void 0);this.add(innerSubscriber),subscribeToResult(this,result,void 0,void 0,innerSubscriber)}}}function take(count){return source=>0===count?empty_empty():source.lift(new take_TakeOperator(count))}class take_TakeOperator{constructor(total){if(this.total=total,this.total<0)throw new ArgumentOutOfRangeError}call(subscriber,source){return source.subscribe(new take_TakeSubscriber(subscriber,this.total))}}class take_TakeSubscriber extends Subscriber_Subscriber{constructor(destination,total){super(destination),this.total=total,this.count=0}_next(value){const total=this.total,count=++this.count;count<=total&&(this.destination.next(value),count===total&&(this.destination.complete(),this.unsubscribe()))}}function first_first(predicate,defaultValue){const hasDefaultValue=arguments.length>=2;return source=>source.pipe(predicate?filter_filter((v,i)=>predicate(v,i,source)):identity,take(1),hasDefaultValue?defaultIfEmpty(defaultValue):throwIfEmpty(()=>new EmptyError))}class EveryOperator{constructor(predicate,thisArg,source){this.predicate=predicate,this.thisArg=thisArg,this.source=source}call(observer,source){return source.subscribe(new every_EverySubscriber(observer,this.predicate,this.thisArg,this.source))}}class every_EverySubscriber extends Subscriber_Subscriber{constructor(destination,predicate,thisArg,source){super(destination),this.predicate=predicate,this.thisArg=thisArg,this.source=source,this.index=0,this.thisArg=thisArg||this}notifyComplete(everyValueMatch){this.destination.next(everyValueMatch),this.destination.complete()}_next(value){let result=!1;try{result=this.predicate.call(this.thisArg,value,this.index++,this.source)}catch(err){return void this.destination.error(err)}result||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function switchMap(project,resultSelector){return"function"==typeof resultSelector?source=>source.pipe(switchMap((a,i)=>from_from(project(a,i)).pipe(map((b,ii)=>resultSelector(a,b,i,ii))))):source=>source.lift(new SwitchMapOperator(project))}class SwitchMapOperator{constructor(project){this.project=project}call(subscriber,source){return source.subscribe(new switchMap_SwitchMapSubscriber(subscriber,this.project))}}class switchMap_SwitchMapSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,project){super(destination),this.project=project,this.index=0}_next(value){let result;const index=this.index++;try{result=this.project(value,index)}catch(error){return void this.destination.error(error)}this._innerSub(result,value,index)}_innerSub(result,value,index){const innerSubscription=this.innerSubscription;innerSubscription&&innerSubscription.unsubscribe();const innerSubscriber=new InnerSubscriber_InnerSubscriber(this,void 0,void 0);this.destination.add(innerSubscriber),this.innerSubscription=subscribeToResult(this,result,value,index,innerSubscriber)}_complete(){const{innerSubscription:innerSubscription}=this;innerSubscription&&!innerSubscription.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(innerSub){this.destination.remove(innerSub),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.destination.next(innerValue)}}function scan(accumulator,seed){let hasSeed=!1;return arguments.length>=2&&(hasSeed=!0),function(source){return source.lift(new ScanOperator(accumulator,seed,hasSeed))}}class ScanOperator{constructor(accumulator,seed,hasSeed=!1){this.accumulator=accumulator,this.seed=seed,this.hasSeed=hasSeed}call(subscriber,source){return source.subscribe(new scan_ScanSubscriber(subscriber,this.accumulator,this.seed,this.hasSeed))}}class scan_ScanSubscriber extends Subscriber_Subscriber{constructor(destination,accumulator,_seed,hasSeed){super(destination),this.accumulator=accumulator,this._seed=_seed,this.hasSeed=hasSeed,this.index=0}get seed(){return this._seed}set seed(value){this.hasSeed=!0,this._seed=value}_next(value){if(this.hasSeed)return this._tryNext(value);this.seed=value,this.destination.next(value)}_tryNext(value){const index=this.index++;let result;try{result=this.accumulator(this.seed,value,index)}catch(err){this.destination.error(err)}this.seed=result,this.destination.next(result)}}function concatMap(project,resultSelector){return mergeMap(project,resultSelector,1)}class FinallyOperator{constructor(callback){this.callback=callback}call(subscriber,source){return source.subscribe(new finalize_FinallySubscriber(subscriber,this.callback))}}class finalize_FinallySubscriber extends Subscriber_Subscriber{constructor(destination,callback){super(destination),this.add(new Subscription_Subscription(callback))}}let _DOM=null;function getDOM(){return _DOM}class DomAdapter{constructor(){this.resourceLoaderType=null}get attrToPropMap(){return this._attrToPropMap}set attrToPropMap(value){this._attrToPropMap=value}}class GenericBrowserDomAdapter extends DomAdapter{constructor(){super(),this._animationPrefix=null,this._transitionEnd=null;try{const element=this.createElement("div",document);if(null!=this.getStyle(element,"animationName"))this._animationPrefix="";else{const domPrefixes=["Webkit","Moz","O","ms"];for(let i=0;i<domPrefixes.length;i++)if(null!=this.getStyle(element,domPrefixes[i]+"AnimationName")){this._animationPrefix="-"+domPrefixes[i].toLowerCase()+"-";break}}const transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(transEndEventNames).forEach(key=>{null!=this.getStyle(element,key)&&(this._transitionEnd=transEndEventNames[key])})}catch(_a){this._animationPrefix=null,this._transitionEnd=null}}getDistributedNodes(el){return el.getDistributedNodes()}resolveAndSetHref(el,baseUrl,href){el.href=null==href?baseUrl:baseUrl+"/../"+href}supportsDOMEvents(){return!0}supportsNativeShadowDOM(){return"function"==typeof document.body.createShadowRoot}getAnimationPrefix(){return this._animationPrefix?this._animationPrefix:""}getTransitionEnd(){return this._transitionEnd?this._transitionEnd:""}supportsAnimation(){return null!=this._animationPrefix&&null!=this._transitionEnd}}const _attrToPropMap={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},DOM_KEY_LOCATION_NUMPAD=3,_keyMap={"\b":"Backspace","\t":"Tab","":"Delete","":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_chromeNumKeyPadMap={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","":"NumLock"},nodeContains=(()=>{if(_global.Node)return _global.Node.prototype.contains||function(node){return!!(16&this.compareDocumentPosition(node))}})();class platform_browser_BrowserDomAdapter extends GenericBrowserDomAdapter{parse(templateHtml){throw new Error("parse not implemented")}static makeCurrent(){var adapter;adapter=new platform_browser_BrowserDomAdapter,_DOM||(_DOM=adapter)}hasProperty(element,name){return name in element}setProperty(el,name,value){el[name]=value}getProperty(el,name){return el[name]}invoke(el,methodName,args){el[methodName](...args)}logError(error){window.console&&(console.error?console.error(error):console.log(error))}log(error){window.console&&window.console.log&&window.console.log(error)}logGroup(error){window.console&&window.console.group&&window.console.group(error)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}get attrToPropMap(){return _attrToPropMap}contains(nodeA,nodeB){return nodeContains.call(nodeA,nodeB)}querySelector(el,selector){return el.querySelector(selector)}querySelectorAll(el,selector){return el.querySelectorAll(selector)}on(el,evt,listener){el.addEventListener(evt,listener,!1)}onAndCancel(el,evt,listener){return el.addEventListener(evt,listener,!1),()=>{el.removeEventListener(evt,listener,!1)}}dispatchEvent(el,evt){el.dispatchEvent(evt)}createMouseEvent(eventType){const evt=this.getDefaultDocument().createEvent("MouseEvent");return evt.initEvent(eventType,!0,!0),evt}createEvent(eventType){const evt=this.getDefaultDocument().createEvent("Event");return evt.initEvent(eventType,!0,!0),evt}preventDefault(evt){evt.preventDefault(),evt.returnValue=!1}isPrevented(evt){return evt.defaultPrevented||null!=evt.returnValue&&!evt.returnValue}getInnerHTML(el){return el.innerHTML}getTemplateContent(el){return"content"in el&&this.isTemplateElement(el)?el.content:null}getOuterHTML(el){return el.outerHTML}nodeName(node){return node.nodeName}nodeValue(node){return node.nodeValue}type(node){return node.type}content(node){return this.hasProperty(node,"content")?node.content:node}firstChild(el){return el.firstChild}nextSibling(el){return el.nextSibling}parentElement(el){return el.parentNode}childNodes(el){return el.childNodes}childNodesAsList(el){const childNodes=el.childNodes,res=new Array(childNodes.length);for(let i=0;i<childNodes.length;i++)res[i]=childNodes[i];return res}clearNodes(el){for(;el.firstChild;)el.removeChild(el.firstChild)}appendChild(el,node){el.appendChild(node)}removeChild(el,node){el.removeChild(node)}replaceChild(el,newChild,oldChild){el.replaceChild(newChild,oldChild)}remove(node){return node.parentNode&&node.parentNode.removeChild(node),node}insertBefore(parent,ref,node){parent.insertBefore(node,ref)}insertAllBefore(parent,ref,nodes){nodes.forEach(n=>parent.insertBefore(n,ref))}insertAfter(parent,ref,node){parent.insertBefore(node,ref.nextSibling)}setInnerHTML(el,value){el.innerHTML=value}getText(el){return el.textContent}setText(el,value){el.textContent=value}getValue(el){return el.value}setValue(el,value){el.value=value}getChecked(el){return el.checked}setChecked(el,value){el.checked=value}createComment(text){return this.getDefaultDocument().createComment(text)}createTemplate(html){const t=this.getDefaultDocument().createElement("template");return t.innerHTML=html,t}createElement(tagName,doc){return(doc=doc||this.getDefaultDocument()).createElement(tagName)}createElementNS(ns,tagName,doc){return(doc=doc||this.getDefaultDocument()).createElementNS(ns,tagName)}createTextNode(text,doc){return(doc=doc||this.getDefaultDocument()).createTextNode(text)}createScriptTag(attrName,attrValue,doc){const el=(doc=doc||this.getDefaultDocument()).createElement("SCRIPT");return el.setAttribute(attrName,attrValue),el}createStyleElement(css,doc){const style=(doc=doc||this.getDefaultDocument()).createElement("style");return this.appendChild(style,this.createTextNode(css,doc)),style}createShadowRoot(el){return el.createShadowRoot()}getShadowRoot(el){return el.shadowRoot}getHost(el){return el.host}clone(node){return node.cloneNode(!0)}getElementsByClassName(element,name){return element.getElementsByClassName(name)}getElementsByTagName(element,name){return element.getElementsByTagName(name)}classList(element){return Array.prototype.slice.call(element.classList,0)}addClass(element,className){element.classList.add(className)}removeClass(element,className){element.classList.remove(className)}hasClass(element,className){return element.classList.contains(className)}setStyle(element,styleName,styleValue){element.style[styleName]=styleValue}removeStyle(element,stylename){element.style[stylename]=""}getStyle(element,stylename){return element.style[stylename]}hasStyle(element,styleName,styleValue){const value=this.getStyle(element,styleName)||"";return styleValue?value==styleValue:value.length>0}tagName(element){return element.tagName}attributeMap(element){const res=new Map,elAttrs=element.attributes;for(let i=0;i<elAttrs.length;i++){const attrib=elAttrs.item(i);res.set(attrib.name,attrib.value)}return res}hasAttribute(element,attribute){return element.hasAttribute(attribute)}hasAttributeNS(element,ns,attribute){return element.hasAttributeNS(ns,attribute)}getAttribute(element,attribute){return element.getAttribute(attribute)}getAttributeNS(element,ns,name){return element.getAttributeNS(ns,name)}setAttribute(element,name,value){element.setAttribute(name,value)}setAttributeNS(element,ns,name,value){element.setAttributeNS(ns,name,value)}removeAttribute(element,attribute){element.removeAttribute(attribute)}removeAttributeNS(element,ns,name){element.removeAttributeNS(ns,name)}templateAwareRoot(el){return this.isTemplateElement(el)?this.content(el):el}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}getBoundingClientRect(el){try{return el.getBoundingClientRect()}catch(_a){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}getTitle(doc){return doc.title}setTitle(doc,newTitle){doc.title=newTitle||""}elementMatches(n,selector){return!!this.isElementNode(n)&&(n.matches&&n.matches(selector)||n.msMatchesSelector&&n.msMatchesSelector(selector)||n.webkitMatchesSelector&&n.webkitMatchesSelector(selector))}isTemplateElement(el){return this.isElementNode(el)&&"TEMPLATE"===el.nodeName}isTextNode(node){return node.nodeType===Node.TEXT_NODE}isCommentNode(node){return node.nodeType===Node.COMMENT_NODE}isElementNode(node){return node.nodeType===Node.ELEMENT_NODE}hasShadowRoot(node){return null!=node.shadowRoot&&node instanceof HTMLElement}isShadowRoot(node){return node instanceof DocumentFragment}importIntoDoc(node){return document.importNode(this.templateAwareRoot(node),!0)}adoptNode(node){return document.adoptNode(node)}getHref(el){return el.getAttribute("href")}getEventKey(event){let key=event.key;if(null==key){if(null==(key=event.keyIdentifier))return"Unidentified";key.startsWith("U+")&&(key=String.fromCharCode(parseInt(key.substring(2),16)),event.location===DOM_KEY_LOCATION_NUMPAD&&_chromeNumKeyPadMap.hasOwnProperty(key)&&(key=_chromeNumKeyPadMap[key]))}return _keyMap[key]||key}getGlobalEventTarget(doc,target){return"window"===target?window:"document"===target?doc:"body"===target?doc.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(doc){const href=baseElement||(baseElement=document.querySelector("base"))?baseElement.getAttribute("href"):null;return null==href?null:(url=href,urlParsingNode||(urlParsingNode=document.createElement("a")),urlParsingNode.setAttribute("href",url),"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname);var url}resetBaseElement(){baseElement=null}getUserAgent(){return window.navigator.userAgent}setData(element,name,value){this.setAttribute(element,"data-"+name,value)}getData(element,name){return this.getAttribute(element,"data-"+name)}getComputedStyle(element){return getComputedStyle(element)}supportsWebAnimation(){return"function"==typeof Element.prototype.animate}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(name){return function(cookieStr,name){name=encodeURIComponent(name);for(const cookie of cookieStr.split(";")){const eqIndex=cookie.indexOf("="),[cookieName,cookieValue]=-1==eqIndex?[cookie,""]:[cookie.slice(0,eqIndex),cookie.slice(eqIndex+1)];if(cookieName.trim()===name)return decodeURIComponent(cookieValue)}return null}(document.cookie,name)}setCookie(name,value){document.cookie=encodeURIComponent(name)+"="+encodeURIComponent(value)}}let urlParsingNode,baseElement=null;function supportsState(){return!!window.history.pushState}const TRANSITION_ID=new InjectionToken("TRANSITION_ID"),SERVER_TRANSITION_PROVIDERS=[{provide:APP_INITIALIZER,useFactory:function(transitionId,document,injector){return()=>{injector.get(ApplicationInitStatus).donePromise.then(()=>{const dom=getDOM();Array.prototype.slice.apply(dom.querySelectorAll(document,"style[ng-transition]")).filter(el=>dom.getAttribute(el,"ng-transition")===transitionId).forEach(el=>dom.remove(el))})}},deps:[TRANSITION_ID,DOCUMENT,Injector],multi:!0}];class platform_browser_BrowserGetTestability{static init(){!function(getter){_testabilityGetter=getter}(new platform_browser_BrowserGetTestability)}addToWindow(registry){_global.getAngularTestability=(elem,findInAncestors=!0)=>{const testability=registry.findTestabilityInTree(elem,findInAncestors);if(null==testability)throw new Error("Could not find testability for element.");return testability},_global.getAllAngularTestabilities=()=>registry.getAllTestabilities(),_global.getAllAngularRootElements=()=>registry.getAllRootElements(),_global.frameworkStabilizers||(_global.frameworkStabilizers=[]),_global.frameworkStabilizers.push(callback=>{const testabilities=_global.getAllAngularTestabilities();let count=testabilities.length,didWork=!1;const decrement=function(didWork_){didWork=didWork||didWork_,0==--count&&callback(didWork)};testabilities.forEach(function(testability){testability.whenStable(decrement)})})}findTestabilityInTree(registry,elem,findInAncestors){if(null==elem)return null;const t=registry.getTestability(elem);return null!=t?t:findInAncestors?getDOM().isShadowRoot(elem)?this.findTestabilityInTree(registry,getDOM().getHost(elem),!0):this.findTestabilityInTree(registry,getDOM().parentElement(elem),!0):null}}function exportNgVar(name,value){"undefined"!=typeof COMPILED&&COMPILED||((_global.ng=_global.ng||{})[name]=value)}const CORE_TOKENS=(()=>({ApplicationRef:core_ApplicationRef,NgZone:NgZone}))();function inspectNativeElement(element){return getDebugNode(element)}const EVENT_MANAGER_PLUGINS=new InjectionToken("EventManagerPlugins");class EventManager{constructor(plugins,_zone){this._zone=_zone,this._eventNameToPlugin=new Map,plugins.forEach(p=>p.manager=this),this._plugins=plugins.slice().reverse()}addEventListener(element,eventName,handler){return this._findPluginFor(eventName).addEventListener(element,eventName,handler)}addGlobalEventListener(target,eventName,handler){return this._findPluginFor(eventName).addGlobalEventListener(target,eventName,handler)}getZone(){return this._zone}_findPluginFor(eventName){const plugin=this._eventNameToPlugin.get(eventName);if(plugin)return plugin;const plugins=this._plugins;for(let i=0;i<plugins.length;i++){const plugin=plugins[i];if(plugin.supports(eventName))return this._eventNameToPlugin.set(eventName,plugin),plugin}throw new Error(`No event manager plugin found for event ${eventName}`)}}class EventManagerPlugin{constructor(_doc){this._doc=_doc}addGlobalEventListener(element,eventName,handler){const target=getDOM().getGlobalEventTarget(this._doc,element);if(!target)throw new Error(`Unsupported event target ${target} for event ${eventName}`);return this.addEventListener(target,eventName,handler)}}class SharedStylesHost{constructor(){this._stylesSet=new Set}addStyles(styles){const additions=new Set;styles.forEach(style=>{this._stylesSet.has(style)||(this._stylesSet.add(style),additions.add(style))}),this.onStylesAdded(additions)}onStylesAdded(additions){}getAllStyles(){return Array.from(this._stylesSet)}}class DomSharedStylesHost extends SharedStylesHost{constructor(_doc){super(),this._doc=_doc,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(_doc.head)}_addStylesToHost(styles,host){styles.forEach(style=>{const styleEl=this._doc.createElement("style");styleEl.textContent=style,this._styleNodes.add(host.appendChild(styleEl))})}addHost(hostNode){this._addStylesToHost(this._stylesSet,hostNode),this._hostNodes.add(hostNode)}removeHost(hostNode){this._hostNodes.delete(hostNode)}onStylesAdded(additions){this._hostNodes.forEach(hostNode=>this._addStylesToHost(additions,hostNode))}ngOnDestroy(){this._styleNodes.forEach(styleNode=>getDOM().remove(styleNode))}}const NAMESPACE_URIS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},COMPONENT_REGEX=/%COMP%/g,HOST_ATTR="_nghost-%COMP%",CONTENT_ATTR="_ngcontent-%COMP%";function flattenStyles(compId,styles,target){for(let i=0;i<styles.length;i++){let style=styles[i];Array.isArray(style)?flattenStyles(compId,style,target):(style=style.replace(COMPONENT_REGEX,compId),target.push(style))}return target}function decoratePreventDefault(eventHandler){return event=>{!1===eventHandler(event)&&(event.preventDefault(),event.returnValue=!1)}}class platform_browser_DomRendererFactory2{constructor(eventManager,sharedStylesHost,appId){this.eventManager=eventManager,this.sharedStylesHost=sharedStylesHost,this.appId=appId,this.rendererByCompId=new Map,this.defaultRenderer=new platform_browser_DefaultDomRenderer2(eventManager)}createRenderer(element,type){if(!element||!type)return this.defaultRenderer;switch(type.encapsulation){case ViewEncapsulation.Emulated:{let renderer=this.rendererByCompId.get(type.id);return renderer||(renderer=new EmulatedEncapsulationDomRenderer2(this.eventManager,this.sharedStylesHost,type,this.appId),this.rendererByCompId.set(type.id,renderer)),renderer.applyToHost(element),renderer}case ViewEncapsulation.Native:case ViewEncapsulation.ShadowDom:return new platform_browser_ShadowDomRenderer(this.eventManager,this.sharedStylesHost,element,type);default:if(!this.rendererByCompId.has(type.id)){const styles=flattenStyles(type.id,type.styles,[]);this.sharedStylesHost.addStyles(styles),this.rendererByCompId.set(type.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}class platform_browser_DefaultDomRenderer2{constructor(eventManager){this.eventManager=eventManager,this.data=Object.create(null)}destroy(){}createElement(name,namespace){return namespace?document.createElementNS(NAMESPACE_URIS[namespace]||namespace,name):document.createElement(name)}createComment(value){return document.createComment(value)}createText(value){return document.createTextNode(value)}appendChild(parent,newChild){parent.appendChild(newChild)}insertBefore(parent,newChild,refChild){parent&&parent.insertBefore(newChild,refChild)}removeChild(parent,oldChild){parent&&parent.removeChild(oldChild)}selectRootElement(selectorOrNode,preserveContent){let el="string"==typeof selectorOrNode?document.querySelector(selectorOrNode):selectorOrNode;if(!el)throw new Error(`The selector "${selectorOrNode}" did not match any elements`);return preserveContent||(el.textContent=""),el}parentNode(node){return node.parentNode}nextSibling(node){return node.nextSibling}setAttribute(el,name,value,namespace){if(namespace){name=namespace+":"+name;const namespaceUri=NAMESPACE_URIS[namespace];namespaceUri?el.setAttributeNS(namespaceUri,name,value):el.setAttribute(name,value)}else el.setAttribute(name,value)}removeAttribute(el,name,namespace){if(namespace){const namespaceUri=NAMESPACE_URIS[namespace];namespaceUri?el.removeAttributeNS(namespaceUri,name):el.removeAttribute(`${namespace}:${name}`)}else el.removeAttribute(name)}addClass(el,name){el.classList.add(name)}removeClass(el,name){el.classList.remove(name)}setStyle(el,style,value,flags){flags&RendererStyleFlags2.DashCase?el.style.setProperty(style,value,flags&RendererStyleFlags2.Important?"important":""):el.style[style]=value}removeStyle(el,style,flags){flags&RendererStyleFlags2.DashCase?el.style.removeProperty(style):el.style[style]=""}setProperty(el,name,value){checkNoSyntheticProp(name,"property"),el[name]=value}setValue(node,value){node.nodeValue=value}listen(target,event,callback){return checkNoSyntheticProp(event,"listener"),"string"==typeof target?this.eventManager.addGlobalEventListener(target,event,decoratePreventDefault(callback)):this.eventManager.addEventListener(target,event,decoratePreventDefault(callback))}}const AT_CHARCODE=(()=>"@".charCodeAt(0))();function checkNoSyntheticProp(name,nameKind){if(name.charCodeAt(0)===AT_CHARCODE)throw new Error(`Found the synthetic ${nameKind} ${name}. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.`)}class EmulatedEncapsulationDomRenderer2 extends platform_browser_DefaultDomRenderer2{constructor(eventManager,sharedStylesHost,component,appId){super(eventManager),this.component=component;const styles=flattenStyles(appId+"-"+component.id,component.styles,[]);sharedStylesHost.addStyles(styles),this.contentAttr=CONTENT_ATTR.replace(COMPONENT_REGEX,appId+"-"+component.id),this.hostAttr=HOST_ATTR.replace(COMPONENT_REGEX,appId+"-"+component.id)}applyToHost(element){super.setAttribute(element,this.hostAttr,"")}createElement(parent,name){const el=super.createElement(parent,name);return super.setAttribute(el,this.contentAttr,""),el}}class platform_browser_ShadowDomRenderer extends platform_browser_DefaultDomRenderer2{constructor(eventManager,sharedStylesHost,hostEl,component){super(eventManager),this.sharedStylesHost=sharedStylesHost,this.hostEl=hostEl,this.component=component,this.shadowRoot=component.encapsulation===ViewEncapsulation.ShadowDom?hostEl.attachShadow({mode:"open"}):hostEl.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const styles=flattenStyles(component.id,component.styles,[]);for(let i=0;i<styles.length;i++){const styleEl=document.createElement("style");styleEl.textContent=styles[i],this.shadowRoot.appendChild(styleEl)}}nodeOrShadowRoot(node){return node===this.hostEl?this.shadowRoot:node}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(parent,newChild){return super.appendChild(this.nodeOrShadowRoot(parent),newChild)}insertBefore(parent,newChild,refChild){return super.insertBefore(this.nodeOrShadowRoot(parent),newChild,refChild)}removeChild(parent,oldChild){return super.removeChild(this.nodeOrShadowRoot(parent),oldChild)}parentNode(node){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(node)))}}const __symbol__=(()=>"undefined"!=typeof Zone&&Zone.__symbol__||function(v){return"__zone_symbol__"+v})(),ADD_EVENT_LISTENER=__symbol__("addEventListener"),REMOVE_EVENT_LISTENER=__symbol__("removeEventListener"),symbolNames={},FALSE="FALSE",ANGULAR="ANGULAR",NATIVE_ADD_LISTENER="addEventListener",NATIVE_REMOVE_LISTENER="removeEventListener",stopSymbol="__zone_symbol__propagationStopped",stopMethodSymbol="__zone_symbol__stopImmediatePropagation",blackListedMap=(()=>{const blackListedEvents="undefined"!=typeof Zone&&Zone[__symbol__("BLACK_LISTED_EVENTS")];if(blackListedEvents){const res={};return blackListedEvents.forEach(eventName=>{res[eventName]=eventName}),res}})(),isBlackListedEvent=function(eventName){return!!blackListedMap&&blackListedMap.hasOwnProperty(eventName)},globalListener=function(event){const symbolName=symbolNames[event.type];if(!symbolName)return;const taskDatas=this[symbolName];if(!taskDatas)return;const args=[event];if(1===taskDatas.length){const taskData=taskDatas[0];return taskData.zone!==Zone.current?taskData.zone.run(taskData.handler,this,args):taskData.handler.apply(this,args)}{const copiedTasks=taskDatas.slice();for(let i=0;i<copiedTasks.length&&!0!==event[stopSymbol];i++){const taskData=copiedTasks[i];taskData.zone!==Zone.current?taskData.zone.run(taskData.handler,this,args):taskData.handler.apply(this,args)}}};class platform_browser_DomEventsPlugin extends EventManagerPlugin{constructor(doc,ngZone,platformId){super(doc),this.ngZone=ngZone,platformId&&function(platformId){return platformId===PLATFORM_SERVER_ID}(platformId)||this.patchEvent()}patchEvent(){if("undefined"==typeof Event||!Event||!Event.prototype)return;if(Event.prototype[stopMethodSymbol])return;const delegate=Event.prototype[stopMethodSymbol]=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[stopSymbol]=!0),delegate&&delegate.apply(this,arguments)}}supports(eventName){return!0}addEventListener(element,eventName,handler){let callback=handler;if(!element[ADD_EVENT_LISTENER]||NgZone.isInAngularZone()&&!isBlackListedEvent(eventName))element[NATIVE_ADD_LISTENER](eventName,callback,!1);else{let symbolName=symbolNames[eventName];symbolName||(symbolName=symbolNames[eventName]=__symbol__(ANGULAR+eventName+FALSE));let taskDatas=element[symbolName];const globalListenerRegistered=taskDatas&&taskDatas.length>0;taskDatas||(taskDatas=element[symbolName]=[]);const zone=isBlackListedEvent(eventName)?Zone.root:Zone.current;if(0===taskDatas.length)taskDatas.push({zone:zone,handler:callback});else{let callbackRegistered=!1;for(let i=0;i<taskDatas.length;i++)if(taskDatas[i].handler===callback){callbackRegistered=!0;break}callbackRegistered||taskDatas.push({zone:zone,handler:callback})}globalListenerRegistered||element[ADD_EVENT_LISTENER](eventName,globalListener,!1)}return()=>this.removeEventListener(element,eventName,callback)}removeEventListener(target,eventName,callback){let underlyingRemove=target[REMOVE_EVENT_LISTENER];if(!underlyingRemove)return target[NATIVE_REMOVE_LISTENER].apply(target,[eventName,callback,!1]);let symbolName=symbolNames[eventName],taskDatas=symbolName&&target[symbolName];if(!taskDatas)return target[NATIVE_REMOVE_LISTENER].apply(target,[eventName,callback,!1]);let found=!1;for(let i=0;i<taskDatas.length;i++)if(taskDatas[i].handler===callback){found=!0,taskDatas.splice(i,1);break}found?0===taskDatas.length&&underlyingRemove.apply(target,[eventName,globalListener,!1]):target[NATIVE_REMOVE_LISTENER].apply(target,[eventName,callback,!1])}}const EVENT_NAMES={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},HAMMER_GESTURE_CONFIG=new InjectionToken("HammerGestureConfig"),HAMMER_LOADER=new InjectionToken("HammerLoader");class HammerGestureConfig{constructor(){this.events=[],this.overrides={}}buildHammer(element){const mc=new Hammer(element,this.options);mc.get("pinch").set({enable:!0}),mc.get("rotate").set({enable:!0});for(const eventName in this.overrides)mc.get(eventName).set(this.overrides[eventName]);return mc}}class HammerGesturesPlugin extends EventManagerPlugin{constructor(doc,_config,console,loader){super(doc),this._config=_config,this.console=console,this.loader=loader}supports(eventName){return!(!EVENT_NAMES.hasOwnProperty(eventName.toLowerCase())&&!this.isCustomEvent(eventName)||!window.Hammer&&!this.loader&&(this.console.warn(`The "${eventName}" event cannot be bound because Hammer.JS is not `+"loaded and no custom loader has been specified."),1))}addEventListener(element,eventName,handler){const zone=this.manager.getZone();if(eventName=eventName.toLowerCase(),!window.Hammer&&this.loader){let cancelRegistration=!1,deregister=()=>{cancelRegistration=!0};return this.loader().then(()=>{if(!window.Hammer)return this.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(deregister=()=>{});cancelRegistration||(deregister=this.addEventListener(element,eventName,handler))}).catch(()=>{this.console.warn(`The "${eventName}" event cannot be bound because the custom `+"Hammer.JS loader failed."),deregister=()=>{}}),()=>{deregister()}}return zone.runOutsideAngular(()=>{const mc=this._config.buildHammer(element),callback=function(eventObj){zone.runGuarded(function(){handler(eventObj)})};return mc.on(eventName,callback),()=>{mc.off(eventName,callback),"function"==typeof mc.destroy&&mc.destroy()}})}isCustomEvent(eventName){return this._config.events.indexOf(eventName)>-1}}const MODIFIER_KEYS=["alt","control","meta","shift"],MODIFIER_KEY_GETTERS={alt:event=>event.altKey,control:event=>event.ctrlKey,meta:event=>event.metaKey,shift:event=>event.shiftKey};class KeyEventsPlugin extends EventManagerPlugin{constructor(doc){super(doc)}supports(eventName){return null!=KeyEventsPlugin.parseEventName(eventName)}addEventListener(element,eventName,handler){const parsedEvent=KeyEventsPlugin.parseEventName(eventName),outsideHandler=KeyEventsPlugin.eventCallback(parsedEvent.fullKey,handler,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>getDOM().onAndCancel(element,parsedEvent.domEventName,outsideHandler))}static parseEventName(eventName){const parts=eventName.toLowerCase().split("."),domEventName=parts.shift();if(0===parts.length||"keydown"!==domEventName&&"keyup"!==domEventName)return null;const key=KeyEventsPlugin._normalizeKey(parts.pop());let fullKey="";if(MODIFIER_KEYS.forEach(modifierName=>{const index=parts.indexOf(modifierName);index>-1&&(parts.splice(index,1),fullKey+=modifierName+".")}),fullKey+=key,0!=parts.length||0===key.length)return null;const result={};return result.domEventName=domEventName,result.fullKey=fullKey,result}static getEventFullKey(event){let fullKey="",key=getDOM().getEventKey(event);return" "===(key=key.toLowerCase())?key="space":"."===key&&(key="dot"),MODIFIER_KEYS.forEach(modifierName=>{modifierName!=key&&(0,MODIFIER_KEY_GETTERS[modifierName])(event)&&(fullKey+=modifierName+".")}),fullKey+=key}static eventCallback(fullKey,handler,zone){return event=>{KeyEventsPlugin.getEventFullKey(event)===fullKey&&zone.runGuarded(()=>handler(event))}}static _normalizeKey(keyName){switch(keyName){case"esc":return"escape";default:return keyName}}}class DomSanitizer{}class platform_browser_DomSanitizerImpl extends DomSanitizer{constructor(_doc){super(),this._doc=_doc}sanitize(ctx,value){if(null==value)return null;switch(ctx){case SecurityContext.NONE:return value;case SecurityContext.HTML:return value instanceof SafeHtmlImpl?value.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(value,"HTML"),function(defaultDoc,unsafeHtmlInput){let inertBodyElement=null;try{inertBodyHelper=inertBodyHelper||new InertBodyHelper(defaultDoc);let unsafeHtml=unsafeHtmlInput?String(unsafeHtmlInput):"";inertBodyElement=inertBodyHelper.getInertBodyElement(unsafeHtml);let mXSSAttempts=5,parsedHtml=unsafeHtml;do{if(0===mXSSAttempts)throw new Error("Failed to sanitize html because the input is unstable");mXSSAttempts--,unsafeHtml=parsedHtml,parsedHtml=inertBodyElement.innerHTML,inertBodyElement=inertBodyHelper.getInertBodyElement(unsafeHtml)}while(unsafeHtml!==parsedHtml);const sanitizer=new SanitizingHtmlSerializer,safeHtml=sanitizer.sanitizeChildren(getTemplateContent(inertBodyElement)||inertBodyElement);return isDevMode()&&sanitizer.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),safeHtml}finally{if(inertBodyElement){const parent=getTemplateContent(inertBodyElement)||inertBodyElement;for(;parent.firstChild;)parent.removeChild(parent.firstChild)}}}(this._doc,String(value)));case SecurityContext.STYLE:return value instanceof SafeStyleImpl?value.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(value,"Style"),function(value){if(!(value=String(value).trim()))return"";const urlMatch=value.match(URL_RE);return urlMatch&&_sanitizeUrl(urlMatch[1])===urlMatch[1]||value.match(SAFE_STYLE_VALUE)&&function(value){let outsideSingle=!0,outsideDouble=!0;for(let i=0;i<value.length;i++){const c=value.charAt(i);"'"===c&&outsideDouble?outsideSingle=!outsideSingle:'"'===c&&outsideSingle&&(outsideDouble=!outsideDouble)}return outsideSingle&&outsideDouble}(value)?value:(isDevMode()&&console.warn(`WARNING: sanitizing unsafe style value ${value} (see http://g.co/ng/security#xss).`),"unsafe")}(value));case SecurityContext.SCRIPT:if(value instanceof SafeScriptImpl)return value.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(value,"Script"),new Error("unsafe value used in a script context");case SecurityContext.URL:return value instanceof SafeResourceUrlImpl||value instanceof SafeUrlImpl?value.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(value,"URL"),_sanitizeUrl(String(value)));case SecurityContext.RESOURCE_URL:if(value instanceof SafeResourceUrlImpl)return value.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(value,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${ctx} (see http://g.co/ng/security#xss)`)}}checkNotSafeValue(value,expectedType){if(value instanceof SafeValueImpl)throw new Error(`Required a safe ${expectedType}, got a ${value.getTypeName()} `+"(see http://g.co/ng/security#xss)")}bypassSecurityTrustHtml(value){return new SafeHtmlImpl(value)}bypassSecurityTrustStyle(value){return new SafeStyleImpl(value)}bypassSecurityTrustScript(value){return new SafeScriptImpl(value)}bypassSecurityTrustUrl(value){return new SafeUrlImpl(value)}bypassSecurityTrustResourceUrl(value){return new SafeResourceUrlImpl(value)}}class SafeValueImpl{constructor(changingThisBreaksApplicationSecurity){this.changingThisBreaksApplicationSecurity=changingThisBreaksApplicationSecurity}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity}`+" (see http://g.co/ng/security#xss)"}}class SafeHtmlImpl extends SafeValueImpl{getTypeName(){return"HTML"}}class SafeStyleImpl extends SafeValueImpl{getTypeName(){return"Style"}}class SafeScriptImpl extends SafeValueImpl{getTypeName(){return"Script"}}class SafeUrlImpl extends SafeValueImpl{getTypeName(){return"URL"}}class SafeResourceUrlImpl extends SafeValueImpl{getTypeName(){return"ResourceURL"}}const platformBrowser=createPlatformFactory(platformCore,"browser",[{provide:PLATFORM_ID,useValue:"browser"},{provide:PLATFORM_INITIALIZER,useValue:function(){platform_browser_BrowserDomAdapter.makeCurrent(),platform_browser_BrowserGetTestability.init()},multi:!0},{provide:PlatformLocation,useClass:class extends PlatformLocation{constructor(_doc){super(),this._doc=_doc,this._init()}_init(){this.location=getDOM().getLocation(),this._history=getDOM().getHistory()}getBaseHrefFromDOM(){return getDOM().getBaseHref(this._doc)}onPopState(fn){getDOM().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",fn,!1)}onHashChange(fn){getDOM().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",fn,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(newPath){this.location.pathname=newPath}pushState(state,title,url){supportsState()?this._history.pushState(state,title,url):this.location.hash=url}replaceState(state,title,url){supportsState()?this._history.replaceState(state,title,url):this.location.hash=url}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}},deps:[DOCUMENT]},{provide:DOCUMENT,useFactory:function(){return document},deps:[]}]);function errorHandler(){return new ErrorHandler}class platform_browser_BrowserModule{constructor(parentModule){if(parentModule)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(params){return{ngModule:platform_browser_BrowserModule,providers:[{provide:APP_ID,useValue:params.appId},{provide:TRANSITION_ID,useExisting:APP_ID},SERVER_TRANSITION_PROVIDERS]}}}"undefined"!=typeof window&&window;class RouterEvent{constructor(id,url){this.id=id,this.url=url}}class NavigationStart extends RouterEvent{constructor(id,url,navigationTrigger="imperative",restoredState=null){super(id,url),this.navigationTrigger=navigationTrigger,this.restoredState=restoredState}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class NavigationEnd extends RouterEvent{constructor(id,url,urlAfterRedirects){super(id,url),this.urlAfterRedirects=urlAfterRedirects}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class NavigationCancel extends RouterEvent{constructor(id,url,reason){super(id,url),this.reason=reason}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class NavigationError extends RouterEvent{constructor(id,url,error){super(id,url),this.error=error}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class RoutesRecognized extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GuardsCheckStart extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GuardsCheckEnd extends RouterEvent{constructor(id,url,urlAfterRedirects,state,shouldActivate){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state,this.shouldActivate=shouldActivate}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ResolveStart extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ResolveEnd extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class RouteConfigLoadStart{constructor(route){this.route=route}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class RouteConfigLoadEnd{constructor(route){this.route=route}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ChildActivationStart{constructor(snapshot){this.snapshot=snapshot}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ChildActivationEnd{constructor(snapshot){this.snapshot=snapshot}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ActivationStart{constructor(snapshot){this.snapshot=snapshot}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ActivationEnd{constructor(snapshot){this.snapshot=snapshot}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class router_Scroll{constructor(routerEvent,position,anchor){this.routerEvent=routerEvent,this.position=position,this.anchor=anchor}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ɵEmptyOutletComponent{}const PRIMARY_OUTLET="primary";class ParamsAsMap{constructor(params){this.params=params||{}}has(name){return this.params.hasOwnProperty(name)}get(name){if(this.has(name)){const v=this.params[name];return Array.isArray(v)?v[0]:v}return null}getAll(name){if(this.has(name)){const v=this.params[name];return Array.isArray(v)?v:[v]}return[]}get keys(){return Object.keys(this.params)}}function convertToParamMap(params){return new ParamsAsMap(params)}const NAVIGATION_CANCELING_ERROR="ngNavigationCancelingError";function navigationCancelingError(message){const error=Error("NavigationCancelingError: "+message);return error[NAVIGATION_CANCELING_ERROR]=!0,error}function defaultUrlMatcher(segments,segmentGroup,route){const parts=route.path.split("/");if(parts.length>segments.length)return null;if("full"===route.pathMatch&&(segmentGroup.hasChildren()||parts.length<segments.length))return null;const posParams={};for(let index=0;index<parts.length;index++){const part=parts[index],segment=segments[index];if(part.startsWith(":"))posParams[part.substring(1)]=segment;else if(part!==segment.path)return null}return{consumed:segments.slice(0,parts.length),posParams:posParams}}class LoadedRouterConfig{constructor(routes,module){this.routes=routes,this.module=module}}function validateConfig(config,parentPath=""){for(let i=0;i<config.length;i++){const route=config[i];router_validateNode(route,getFullPath(parentPath,route))}}function router_validateNode(route,fullPath){if(!route)throw new Error(`\n      Invalid configuration of route '${fullPath}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(route))throw new Error(`Invalid configuration of route '${fullPath}': Array cannot be specified`);if(!route.component&&!route.children&&!route.loadChildren&&route.outlet&&route.outlet!==PRIMARY_OUTLET)throw new Error(`Invalid configuration of route '${fullPath}': a componentless route without children or loadChildren cannot have a named outlet set`);if(route.redirectTo&&route.children)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and children cannot be used together`);if(route.redirectTo&&route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and loadChildren cannot be used together`);if(route.children&&route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}': children and loadChildren cannot be used together`);if(route.redirectTo&&route.component)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and component cannot be used together`);if(route.path&&route.matcher)throw new Error(`Invalid configuration of route '${fullPath}': path and matcher cannot be used together`);if(void 0===route.redirectTo&&!route.component&&!route.children&&!route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===route.path&&void 0===route.matcher)throw new Error(`Invalid configuration of route '${fullPath}': routes must have either a path or a matcher specified`);if("string"==typeof route.path&&"/"===route.path.charAt(0))throw new Error(`Invalid configuration of route '${fullPath}': path cannot start with a slash`);if(""===route.path&&void 0!==route.redirectTo&&void 0===route.pathMatch)throw new Error(`Invalid configuration of route '{path: "${fullPath}", redirectTo: "${route.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==route.pathMatch&&"full"!==route.pathMatch&&"prefix"!==route.pathMatch)throw new Error(`Invalid configuration of route '${fullPath}': pathMatch can only be set to 'prefix' or 'full'`);route.children&&validateConfig(route.children,fullPath)}function getFullPath(parentPath,currentRoute){return currentRoute?parentPath||currentRoute.path?parentPath&&!currentRoute.path?`${parentPath}/`:!parentPath&&currentRoute.path?currentRoute.path:`${parentPath}/${currentRoute.path}`:"":parentPath}function standardizeConfig(r){const children=r.children&&r.children.map(standardizeConfig),c=children?Object.assign({},r,{children:children}):Object.assign({},r);return!c.component&&(children||c.loadChildren)&&c.outlet&&c.outlet!==PRIMARY_OUTLET&&(c.component=ɵEmptyOutletComponent),c}function shallowEqual(a,b){const k1=Object.keys(a),k2=Object.keys(b);if(!k1||!k2||k1.length!=k2.length)return!1;let key;for(let i=0;i<k1.length;i++)if(a[key=k1[i]]!==b[key])return!1;return!0}function router_flatten(arr){return Array.prototype.concat.apply([],arr)}function router_last(a){return a.length>0?a[a.length-1]:null}function forEach(map,callback){for(const prop in map)map.hasOwnProperty(prop)&&callback(map[prop],prop)}function wrapIntoObservable(value){return isObservable(value)?value:core_isPromise(value)?from_from(Promise.resolve(value)):of(value)}function containsTree(container,containee,exact){return exact?function(container,containee){return shallowEqual(container,containee)}(container.queryParams,containee.queryParams)&&function equalSegmentGroups(container,containee){if(!equalPath(container.segments,containee.segments))return!1;if(container.numberOfChildren!==containee.numberOfChildren)return!1;for(const c in containee.children){if(!container.children[c])return!1;if(!equalSegmentGroups(container.children[c],containee.children[c]))return!1}return!0}(container.root,containee.root):function(container,containee){return Object.keys(containee).length<=Object.keys(container).length&&Object.keys(containee).every(key=>containee[key]===container[key])}(container.queryParams,containee.queryParams)&&function containsSegmentGroup(container,containee){return function containsSegmentGroupHelper(container,containee,containeePaths){if(container.segments.length>containeePaths.length){return!!equalPath(container.segments.slice(0,containeePaths.length),containeePaths)&&!containee.hasChildren()}if(container.segments.length===containeePaths.length){if(!equalPath(container.segments,containeePaths))return!1;for(const c in containee.children){if(!container.children[c])return!1;if(!containsSegmentGroup(container.children[c],containee.children[c]))return!1}return!0}{const current=containeePaths.slice(0,container.segments.length),next=containeePaths.slice(container.segments.length);return!!equalPath(container.segments,current)&&!!container.children[PRIMARY_OUTLET]&&containsSegmentGroupHelper(container.children[PRIMARY_OUTLET],containee,next)}}(container,containee,containee.segments)}(container.root,containee.root)}class UrlTree{constructor(root,queryParams,fragment){this.root=root,this.queryParams=queryParams,this.fragment=fragment}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=convertToParamMap(this.queryParams)),this._queryParamMap}toString(){return DEFAULT_SERIALIZER.serialize(this)}}class UrlSegmentGroup{constructor(segments,children){this.segments=segments,this.children=children,this.parent=null,forEach(children,(v,k)=>v.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return serializePaths(this)}}class UrlSegment{constructor(path,parameters){this.path=path,this.parameters=parameters}get parameterMap(){return this._parameterMap||(this._parameterMap=convertToParamMap(this.parameters)),this._parameterMap}toString(){return serializePath(this)}}function equalPath(as,bs){return as.length===bs.length&&as.every((a,i)=>a.path===bs[i].path)}function mapChildrenIntoArray(segment,fn){let res=[];return forEach(segment.children,(child,childOutlet)=>{childOutlet===PRIMARY_OUTLET&&(res=res.concat(fn(child,childOutlet)))}),forEach(segment.children,(child,childOutlet)=>{childOutlet!==PRIMARY_OUTLET&&(res=res.concat(fn(child,childOutlet)))}),res}class UrlSerializer{}class DefaultUrlSerializer{parse(url){const p=new UrlParser(url);return new UrlTree(p.parseRootSegment(),p.parseQueryParams(),p.parseFragment())}serialize(tree){var s;return`${`/${function serializeSegment(segment,root){if(!segment.hasChildren())return serializePaths(segment);if(root){const primary=segment.children[PRIMARY_OUTLET]?serializeSegment(segment.children[PRIMARY_OUTLET],!1):"",children=[];return forEach(segment.children,(v,k)=>{k!==PRIMARY_OUTLET&&children.push(`${k}:${serializeSegment(v,!1)}`)}),children.length>0?`${primary}(${children.join("//")})`:primary}{const children=mapChildrenIntoArray(segment,(v,k)=>k===PRIMARY_OUTLET?[serializeSegment(segment.children[PRIMARY_OUTLET],!1)]:[`${k}:${serializeSegment(v,!1)}`]);return`${serializePaths(segment)}/(${children.join("//")})`}}(tree.root,!0)}`}${function(params){const strParams=Object.keys(params).map(name=>{const value=params[name];return Array.isArray(value)?value.map(v=>`${encodeUriQuery(name)}=${encodeUriQuery(v)}`).join("&"):`${encodeUriQuery(name)}=${encodeUriQuery(value)}`});return strParams.length?`?${strParams.join("&")}`:""}(tree.queryParams)}${"string"==typeof tree.fragment?`#${s=tree.fragment,encodeURI(s)}`:""}`}}const DEFAULT_SERIALIZER=new DefaultUrlSerializer;function serializePaths(segment){return segment.segments.map(p=>serializePath(p)).join("/")}function encodeUriString(s){return encodeURIComponent(s).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function encodeUriQuery(s){return encodeUriString(s).replace(/%3B/gi,";")}function encodeUriSegment(s){return encodeUriString(s).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function decode(s){return decodeURIComponent(s)}function decodeQuery(s){return decode(s.replace(/\+/g,"%20"))}function serializePath(path){return`${encodeUriSegment(path.path)}${params=path.parameters,Object.keys(params).map(key=>`;${encodeUriSegment(key)}=${encodeUriSegment(params[key])}`).join("")}`;var params}const SEGMENT_RE=/^[^\/()?;=#]+/;function matchSegments(str){const match=str.match(SEGMENT_RE);return match?match[0]:""}const QUERY_PARAM_RE=/^[^=?&#]+/,QUERY_PARAM_VALUE_RE=/^[^?&#]+/;class UrlParser{constructor(url){this.url=url,this.remaining=url}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new UrlSegmentGroup([],{}):new UrlSegmentGroup([],this.parseChildren())}parseQueryParams(){const params={};if(this.consumeOptional("?"))do{this.parseQueryParam(params)}while(this.consumeOptional("&"));return params}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const segments=[];for(this.peekStartsWith("(")||segments.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),segments.push(this.parseSegment());let children={};this.peekStartsWith("/(")&&(this.capture("/"),children=this.parseParens(!0));let res={};return this.peekStartsWith("(")&&(res=this.parseParens(!1)),(segments.length>0||Object.keys(children).length>0)&&(res[PRIMARY_OUTLET]=new UrlSegmentGroup(segments,children)),res}parseSegment(){const path=matchSegments(this.remaining);if(""===path&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(path),new UrlSegment(decode(path),this.parseMatrixParams())}parseMatrixParams(){const params={};for(;this.consumeOptional(";");)this.parseParam(params);return params}parseParam(params){const key=matchSegments(this.remaining);if(!key)return;this.capture(key);let value="";if(this.consumeOptional("=")){const valueMatch=matchSegments(this.remaining);valueMatch&&this.capture(value=valueMatch)}params[decode(key)]=decode(value)}parseQueryParam(params){const key=function(str){const match=str.match(QUERY_PARAM_RE);return match?match[0]:""}(this.remaining);if(!key)return;this.capture(key);let value="";if(this.consumeOptional("=")){const valueMatch=function(str){const match=str.match(QUERY_PARAM_VALUE_RE);return match?match[0]:""}(this.remaining);valueMatch&&this.capture(value=valueMatch)}const decodedKey=decodeQuery(key),decodedVal=decodeQuery(value);if(params.hasOwnProperty(decodedKey)){let currentVal=params[decodedKey];Array.isArray(currentVal)||(params[decodedKey]=currentVal=[currentVal]),currentVal.push(decodedVal)}else params[decodedKey]=decodedVal}parseParens(allowPrimary){const segments={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const path=matchSegments(this.remaining),next=this.remaining[path.length];if("/"!==next&&")"!==next&&";"!==next)throw new Error(`Cannot parse url '${this.url}'`);let outletName=void 0;path.indexOf(":")>-1?(outletName=path.substr(0,path.indexOf(":")),this.capture(outletName),this.capture(":")):allowPrimary&&(outletName=PRIMARY_OUTLET);const children=this.parseChildren();segments[outletName]=1===Object.keys(children).length?children[PRIMARY_OUTLET]:new UrlSegmentGroup([],children),this.consumeOptional("//")}return segments}peekStartsWith(str){return this.remaining.startsWith(str)}consumeOptional(str){return!!this.peekStartsWith(str)&&(this.remaining=this.remaining.substring(str.length),!0)}capture(str){if(!this.consumeOptional(str))throw new Error(`Expected "${str}".`)}}class Tree{constructor(root){this._root=root}get root(){return this._root.value}parent(t){const p=this.pathFromRoot(t);return p.length>1?p[p.length-2]:null}children(t){const n=findNode(t,this._root);return n?n.children.map(t=>t.value):[]}firstChild(t){const n=findNode(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const p=findPath(t,this._root);return p.length<2?[]:p[p.length-2].children.map(c=>c.value).filter(cc=>cc!==t)}pathFromRoot(t){return findPath(t,this._root).map(s=>s.value)}}function findNode(value,node){if(value===node.value)return node;for(const child of node.children){const node=findNode(value,child);if(node)return node}return null}function findPath(value,node){if(value===node.value)return[node];for(const child of node.children){const path=findPath(value,child);if(path.length)return path.unshift(node),path}return[]}class TreeNode{constructor(value,children){this.value=value,this.children=children}toString(){return`TreeNode(${this.value})`}}function nodeChildrenAsMap(node){const map={};return node&&node.children.forEach(child=>map[child.value.outlet]=child),map}class RouterState extends Tree{constructor(root,snapshot){super(root),this.snapshot=snapshot,setRouterState(this,root)}toString(){return this.snapshot.toString()}}function createEmptyState(urlTree,rootComponent){const snapshot=function(urlTree,rootComponent){const activated=new ActivatedRouteSnapshot([],{},{},"",{},PRIMARY_OUTLET,rootComponent,null,urlTree.root,-1,{});return new RouterStateSnapshot("",new TreeNode(activated,[]))}(urlTree,rootComponent),emptyUrl=new BehaviorSubject_BehaviorSubject([new UrlSegment("",{})]),emptyParams=new BehaviorSubject_BehaviorSubject({}),emptyData=new BehaviorSubject_BehaviorSubject({}),emptyQueryParams=new BehaviorSubject_BehaviorSubject({}),fragment=new BehaviorSubject_BehaviorSubject(""),activated=new router_ActivatedRoute(emptyUrl,emptyParams,emptyQueryParams,fragment,emptyData,PRIMARY_OUTLET,rootComponent,snapshot.root);return activated.snapshot=snapshot.root,new RouterState(new TreeNode(activated,[]),snapshot)}class router_ActivatedRoute{constructor(url,params,queryParams,fragment,data,outlet,component,futureSnapshot){this.url=url,this.params=params,this.queryParams=queryParams,this.fragment=fragment,this.data=data,this.outlet=outlet,this.component=component,this._futureSnapshot=futureSnapshot}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(map(p=>convertToParamMap(p)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(map(p=>convertToParamMap(p)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function inheritedParamsDataResolve(route,paramsInheritanceStrategy="emptyOnly"){const pathFromRoot=route.pathFromRoot;let inheritingStartingFrom=0;if("always"!==paramsInheritanceStrategy)for(inheritingStartingFrom=pathFromRoot.length-1;inheritingStartingFrom>=1;){const current=pathFromRoot[inheritingStartingFrom],parent=pathFromRoot[inheritingStartingFrom-1];if(current.routeConfig&&""===current.routeConfig.path)inheritingStartingFrom--;else{if(parent.component)break;inheritingStartingFrom--}}return function(pathFromRoot){return pathFromRoot.reduce((res,curr)=>({params:Object.assign({},res.params,curr.params),data:Object.assign({},res.data,curr.data),resolve:Object.assign({},res.resolve,curr._resolvedData)}),{params:{},data:{},resolve:{}})}(pathFromRoot.slice(inheritingStartingFrom))}class ActivatedRouteSnapshot{constructor(url,params,queryParams,fragment,data,outlet,component,routeConfig,urlSegment,lastPathIndex,resolve){this.url=url,this.params=params,this.queryParams=queryParams,this.fragment=fragment,this.data=data,this.outlet=outlet,this.component=component,this.routeConfig=routeConfig,this._urlSegment=urlSegment,this._lastPathIndex=lastPathIndex,this._resolve=resolve}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=convertToParamMap(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=convertToParamMap(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(segment=>segment.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class RouterStateSnapshot extends Tree{constructor(url,root){super(root),this.url=url,setRouterState(this,root)}toString(){return serializeNode(this._root)}}function setRouterState(state,node){node.value._routerState=state,node.children.forEach(c=>setRouterState(state,c))}function serializeNode(node){const c=node.children.length>0?` { ${node.children.map(serializeNode).join(", ")} } `:"";return`${node.value}${c}`}function advanceActivatedRoute(route){if(route.snapshot){const currentSnapshot=route.snapshot,nextSnapshot=route._futureSnapshot;route.snapshot=nextSnapshot,shallowEqual(currentSnapshot.queryParams,nextSnapshot.queryParams)||route.queryParams.next(nextSnapshot.queryParams),currentSnapshot.fragment!==nextSnapshot.fragment&&route.fragment.next(nextSnapshot.fragment),shallowEqual(currentSnapshot.params,nextSnapshot.params)||route.params.next(nextSnapshot.params),function(a,b){if(a.length!==b.length)return!1;for(let i=0;i<a.length;++i)if(!shallowEqual(a[i],b[i]))return!1;return!0}(currentSnapshot.url,nextSnapshot.url)||route.url.next(nextSnapshot.url),shallowEqual(currentSnapshot.data,nextSnapshot.data)||route.data.next(nextSnapshot.data)}else route.snapshot=route._futureSnapshot,route.data.next(route._futureSnapshot.data)}function equalParamsAndUrlSegments(a,b){var as,bs;return shallowEqual(a.params,b.params)&&equalPath(as=a.url,bs=b.url)&&as.every((a,i)=>shallowEqual(a.parameters,bs[i].parameters))&&!(!a.parent!=!b.parent)&&(!a.parent||equalParamsAndUrlSegments(a.parent,b.parent))}function isMatrixParams(command){return"object"==typeof command&&null!=command&&!command.outlets&&!command.segmentPath}function router_tree(oldSegmentGroup,newSegmentGroup,urlTree,queryParams,fragment){let qp={};return queryParams&&forEach(queryParams,(value,name)=>{qp[name]=Array.isArray(value)?value.map(v=>`${v}`):`${value}`}),new UrlTree(urlTree.root===oldSegmentGroup?newSegmentGroup:function replaceSegment(current,oldSegment,newSegment){const children={};return forEach(current.children,(c,outletName)=>{children[outletName]=c===oldSegment?newSegment:replaceSegment(c,oldSegment,newSegment)}),new UrlSegmentGroup(current.segments,children)}(urlTree.root,oldSegmentGroup,newSegmentGroup),qp,fragment)}class Navigation{constructor(isAbsolute,numberOfDoubleDots,commands){if(this.isAbsolute=isAbsolute,this.numberOfDoubleDots=numberOfDoubleDots,this.commands=commands,isAbsolute&&commands.length>0&&isMatrixParams(commands[0]))throw new Error("Root segment cannot have matrix parameters");const cmdWithOutlet=commands.find(c=>"object"==typeof c&&null!=c&&c.outlets);if(cmdWithOutlet&&cmdWithOutlet!==router_last(commands))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class router_Position{constructor(segmentGroup,processChildren,index){this.segmentGroup=segmentGroup,this.processChildren=processChildren,this.index=index}}function getPath(command){return"object"==typeof command&&null!=command&&command.outlets?command.outlets[PRIMARY_OUTLET]:`${command}`}function updateSegmentGroup(segmentGroup,startIndex,commands){if(segmentGroup||(segmentGroup=new UrlSegmentGroup([],{})),0===segmentGroup.segments.length&&segmentGroup.hasChildren())return updateSegmentGroupChildren(segmentGroup,startIndex,commands);const m=function(segmentGroup,startIndex,commands){let currentCommandIndex=0,currentPathIndex=startIndex;const noMatch={match:!1,pathIndex:0,commandIndex:0};for(;currentPathIndex<segmentGroup.segments.length;){if(currentCommandIndex>=commands.length)return noMatch;const path=segmentGroup.segments[currentPathIndex],curr=getPath(commands[currentCommandIndex]),next=currentCommandIndex<commands.length-1?commands[currentCommandIndex+1]:null;if(currentPathIndex>0&&void 0===curr)break;if(curr&&next&&"object"==typeof next&&void 0===next.outlets){if(!compare(curr,next,path))return noMatch;currentCommandIndex+=2}else{if(!compare(curr,{},path))return noMatch;currentCommandIndex++}currentPathIndex++}return{match:!0,pathIndex:currentPathIndex,commandIndex:currentCommandIndex}}(segmentGroup,startIndex,commands),slicedCommands=commands.slice(m.commandIndex);if(m.match&&m.pathIndex<segmentGroup.segments.length){const g=new UrlSegmentGroup(segmentGroup.segments.slice(0,m.pathIndex),{});return g.children[PRIMARY_OUTLET]=new UrlSegmentGroup(segmentGroup.segments.slice(m.pathIndex),segmentGroup.children),updateSegmentGroupChildren(g,0,slicedCommands)}return m.match&&0===slicedCommands.length?new UrlSegmentGroup(segmentGroup.segments,{}):m.match&&!segmentGroup.hasChildren()?createNewSegmentGroup(segmentGroup,startIndex,commands):m.match?updateSegmentGroupChildren(segmentGroup,0,slicedCommands):createNewSegmentGroup(segmentGroup,startIndex,commands)}function updateSegmentGroupChildren(segmentGroup,startIndex,commands){if(0===commands.length)return new UrlSegmentGroup(segmentGroup.segments,{});{const outlets=function(commands){return"object"!=typeof commands[0]?{[PRIMARY_OUTLET]:commands}:void 0===commands[0].outlets?{[PRIMARY_OUTLET]:commands}:commands[0].outlets}(commands),children={};return forEach(outlets,(commands,outlet)=>{null!==commands&&(children[outlet]=updateSegmentGroup(segmentGroup.children[outlet],startIndex,commands))}),forEach(segmentGroup.children,(child,childOutlet)=>{void 0===outlets[childOutlet]&&(children[childOutlet]=child)}),new UrlSegmentGroup(segmentGroup.segments,children)}}function createNewSegmentGroup(segmentGroup,startIndex,commands){const paths=segmentGroup.segments.slice(0,startIndex);let i=0;for(;i<commands.length;){if("object"==typeof commands[i]&&void 0!==commands[i].outlets){const children=createNewSegmentChildren(commands[i].outlets);return new UrlSegmentGroup(paths,children)}if(0===i&&isMatrixParams(commands[0])){paths.push(new UrlSegment(segmentGroup.segments[startIndex].path,commands[0])),i++;continue}const curr=getPath(commands[i]),next=i<commands.length-1?commands[i+1]:null;curr&&next&&isMatrixParams(next)?(paths.push(new UrlSegment(curr,router_stringify(next))),i+=2):(paths.push(new UrlSegment(curr,{})),i++)}return new UrlSegmentGroup(paths,{})}function createNewSegmentChildren(outlets){const children={};return forEach(outlets,(commands,outlet)=>{null!==commands&&(children[outlet]=createNewSegmentGroup(new UrlSegmentGroup([],{}),0,commands))}),children}function router_stringify(params){const res={};return forEach(params,(v,k)=>res[k]=`${v}`),res}function compare(path,params,segment){return path==segment.path&&shallowEqual(params,segment.parameters)}const activateRoutes=(rootContexts,routeReuseStrategy,forwardEvent)=>map(t=>(new ActivateRoutes(routeReuseStrategy,t.targetRouterState,t.currentRouterState,forwardEvent).activate(rootContexts),t));class ActivateRoutes{constructor(routeReuseStrategy,futureState,currState,forwardEvent){this.routeReuseStrategy=routeReuseStrategy,this.futureState=futureState,this.currState=currState,this.forwardEvent=forwardEvent}activate(parentContexts){const futureRoot=this.futureState._root,currRoot=this.currState?this.currState._root:null;this.deactivateChildRoutes(futureRoot,currRoot,parentContexts),advanceActivatedRoute(this.futureState.root),this.activateChildRoutes(futureRoot,currRoot,parentContexts)}deactivateChildRoutes(futureNode,currNode,contexts){const children=nodeChildrenAsMap(currNode);futureNode.children.forEach(futureChild=>{const childOutletName=futureChild.value.outlet;this.deactivateRoutes(futureChild,children[childOutletName],contexts),delete children[childOutletName]}),forEach(children,(v,childName)=>{this.deactivateRouteAndItsChildren(v,contexts)})}deactivateRoutes(futureNode,currNode,parentContext){const future=futureNode.value,curr=currNode?currNode.value:null;if(future===curr)if(future.component){const context=parentContext.getContext(future.outlet);context&&this.deactivateChildRoutes(futureNode,currNode,context.children)}else this.deactivateChildRoutes(futureNode,currNode,parentContext);else curr&&this.deactivateRouteAndItsChildren(currNode,parentContext)}deactivateRouteAndItsChildren(route,parentContexts){this.routeReuseStrategy.shouldDetach(route.value.snapshot)?this.detachAndStoreRouteSubtree(route,parentContexts):this.deactivateRouteAndOutlet(route,parentContexts)}detachAndStoreRouteSubtree(route,parentContexts){const context=parentContexts.getContext(route.value.outlet);if(context&&context.outlet){const componentRef=context.outlet.detach(),contexts=context.children.onOutletDeactivated();this.routeReuseStrategy.store(route.value.snapshot,{componentRef:componentRef,route:route,contexts:contexts})}}deactivateRouteAndOutlet(route,parentContexts){const context=parentContexts.getContext(route.value.outlet);if(context){const children=nodeChildrenAsMap(route),contexts=route.value.component?context.children:parentContexts;forEach(children,(v,k)=>this.deactivateRouteAndItsChildren(v,contexts)),context.outlet&&(context.outlet.deactivate(),context.children.onOutletDeactivated())}}activateChildRoutes(futureNode,currNode,contexts){const children=nodeChildrenAsMap(currNode);futureNode.children.forEach(c=>{this.activateRoutes(c,children[c.value.outlet],contexts),this.forwardEvent(new ActivationEnd(c.value.snapshot))}),futureNode.children.length&&this.forwardEvent(new ChildActivationEnd(futureNode.value.snapshot))}activateRoutes(futureNode,currNode,parentContexts){const future=futureNode.value,curr=currNode?currNode.value:null;if(advanceActivatedRoute(future),future===curr)if(future.component){const context=parentContexts.getOrCreateContext(future.outlet);this.activateChildRoutes(futureNode,currNode,context.children)}else this.activateChildRoutes(futureNode,currNode,parentContexts);else if(future.component){const context=parentContexts.getOrCreateContext(future.outlet);if(this.routeReuseStrategy.shouldAttach(future.snapshot)){const stored=this.routeReuseStrategy.retrieve(future.snapshot);this.routeReuseStrategy.store(future.snapshot,null),context.children.onOutletReAttached(stored.contexts),context.attachRef=stored.componentRef,context.route=stored.route.value,context.outlet&&context.outlet.attach(stored.componentRef,stored.route.value),advanceActivatedRouteNodeAndItsChildren(stored.route)}else{const config=function(snapshot){for(let s=future.snapshot.parent;s;s=s.parent){const route=s.routeConfig;if(route&&route._loadedConfig)return route._loadedConfig;if(route&&route.component)return null}return null}(),cmpFactoryResolver=config?config.module.componentFactoryResolver:null;context.attachRef=null,context.route=future,context.resolver=cmpFactoryResolver,context.outlet&&context.outlet.activateWith(future,cmpFactoryResolver),this.activateChildRoutes(futureNode,null,context.children)}}else this.activateChildRoutes(futureNode,null,parentContexts)}}function advanceActivatedRouteNodeAndItsChildren(node){advanceActivatedRoute(node.value),node.children.forEach(advanceActivatedRouteNodeAndItsChildren)}function router_isFunction(v){return"function"==typeof v}function isUrlTree(v){return v instanceof UrlTree}class NoMatch{constructor(segmentGroup){this.segmentGroup=segmentGroup||null}}class AbsoluteRedirect{constructor(urlTree){this.urlTree=urlTree}}function noMatch(segmentGroup){return new Observable_Observable(obs=>obs.error(new NoMatch(segmentGroup)))}function absoluteRedirect(newTree){return new Observable_Observable(obs=>obs.error(new AbsoluteRedirect(newTree)))}function namedOutletsRedirect(redirectTo){return new Observable_Observable(obs=>obs.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${redirectTo}'`)))}class router_ApplyRedirects{constructor(moduleInjector,configLoader,urlSerializer,urlTree,config){this.configLoader=configLoader,this.urlSerializer=urlSerializer,this.urlTree=urlTree,this.config=config,this.allowRedirects=!0,this.ngModule=moduleInjector.get(NgModuleRef)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,PRIMARY_OUTLET).pipe(map(rootSegmentGroup=>this.createUrlTree(rootSegmentGroup,this.urlTree.queryParams,this.urlTree.fragment))).pipe(catchError(e=>{if(e instanceof AbsoluteRedirect)return this.allowRedirects=!1,this.match(e.urlTree);if(e instanceof NoMatch)throw this.noMatchError(e);throw e}))}match(tree){return this.expandSegmentGroup(this.ngModule,this.config,tree.root,PRIMARY_OUTLET).pipe(map(rootSegmentGroup=>this.createUrlTree(rootSegmentGroup,tree.queryParams,tree.fragment))).pipe(catchError(e=>{if(e instanceof NoMatch)throw this.noMatchError(e);throw e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(rootCandidate,queryParams,fragment){const root=rootCandidate.segments.length>0?new UrlSegmentGroup([],{[PRIMARY_OUTLET]:rootCandidate}):rootCandidate;return new UrlTree(root,queryParams,fragment)}expandSegmentGroup(ngModule,routes,segmentGroup,outlet){return 0===segmentGroup.segments.length&&segmentGroup.hasChildren()?this.expandChildren(ngModule,routes,segmentGroup).pipe(map(children=>new UrlSegmentGroup([],children))):this.expandSegment(ngModule,segmentGroup,routes,segmentGroup.segments,outlet,!0)}expandChildren(ngModule,routes,segmentGroup){return function(obj,fn){if(0===Object.keys(obj).length)return of({});const waitHead=[],waitTail=[],res={};return forEach(obj,(a,k)=>{const mapped=fn(k,a).pipe(map(r=>res[k]=r));k===PRIMARY_OUTLET?waitHead.push(mapped):waitTail.push(mapped)}),of.apply(null,waitHead.concat(waitTail)).pipe(concatAll(),last_last(),map(()=>res))}(segmentGroup.children,(childOutlet,child)=>this.expandSegmentGroup(ngModule,routes,child,childOutlet))}expandSegment(ngModule,segmentGroup,routes,segments,outlet,allowRedirects){return of(...routes).pipe(map(r=>this.expandSegmentAgainstRoute(ngModule,segmentGroup,routes,r,segments,outlet,allowRedirects).pipe(catchError(e=>{if(e instanceof NoMatch)return of(null);throw e}))),concatAll(),first_first(s=>!!s),catchError((e,_)=>{if(e instanceof EmptyError||"EmptyError"===e.name){if(this.noLeftoversInUrl(segmentGroup,segments,outlet))return of(new UrlSegmentGroup([],{}));throw new NoMatch(segmentGroup)}throw e}))}noLeftoversInUrl(segmentGroup,segments,outlet){return 0===segments.length&&!segmentGroup.children[outlet]}expandSegmentAgainstRoute(ngModule,segmentGroup,routes,route,paths,outlet,allowRedirects){return getOutlet(route)!==outlet?noMatch(segmentGroup):void 0===route.redirectTo?this.matchSegmentAgainstRoute(ngModule,segmentGroup,route,paths):allowRedirects&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,paths,outlet):noMatch(segmentGroup)}expandSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet){return"**"===route.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(ngModule,routes,route,outlet):this.expandRegularSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet)}expandWildCardWithParamsAgainstRouteUsingRedirect(ngModule,routes,route,outlet){const newTree=this.applyRedirectCommands([],route.redirectTo,{});return route.redirectTo.startsWith("/")?absoluteRedirect(newTree):this.lineralizeSegments(route,newTree).pipe(mergeMap(newSegments=>{const group=new UrlSegmentGroup(newSegments,{});return this.expandSegment(ngModule,group,routes,newSegments,outlet,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet){const{matched:matched,consumedSegments:consumedSegments,lastChild:lastChild,positionalParamSegments:positionalParamSegments}=router_match(segmentGroup,route,segments);if(!matched)return noMatch(segmentGroup);const newTree=this.applyRedirectCommands(consumedSegments,route.redirectTo,positionalParamSegments);return route.redirectTo.startsWith("/")?absoluteRedirect(newTree):this.lineralizeSegments(route,newTree).pipe(mergeMap(newSegments=>this.expandSegment(ngModule,segmentGroup,routes,newSegments.concat(segments.slice(lastChild)),outlet,!1)))}matchSegmentAgainstRoute(ngModule,rawSegmentGroup,route,segments){if("**"===route.path)return route.loadChildren?this.configLoader.load(ngModule.injector,route).pipe(map(cfg=>(route._loadedConfig=cfg,new UrlSegmentGroup(segments,{})))):of(new UrlSegmentGroup(segments,{}));const{matched:matched,consumedSegments:consumedSegments,lastChild:lastChild}=router_match(rawSegmentGroup,route,segments);if(!matched)return noMatch(rawSegmentGroup);const rawSlicedSegments=segments.slice(lastChild);return this.getChildConfig(ngModule,route,segments).pipe(mergeMap(routerConfig=>{const childModule=routerConfig.module,childConfig=routerConfig.routes,{segmentGroup:segmentGroup,slicedSegments:slicedSegments}=function(segmentGroup,consumedSegments,slicedSegments,config){return slicedSegments.length>0&&function(segmentGroup,segments,routes){return config.some(r=>isEmptyPathRedirect(segmentGroup,segments,r)&&getOutlet(r)!==PRIMARY_OUTLET)}(segmentGroup,slicedSegments)?{segmentGroup:mergeTrivialChildren(new UrlSegmentGroup(consumedSegments,function(routes,primarySegmentGroup){const res={};res[PRIMARY_OUTLET]=primarySegmentGroup;for(const r of routes)""===r.path&&getOutlet(r)!==PRIMARY_OUTLET&&(res[getOutlet(r)]=new UrlSegmentGroup([],{}));return res}(config,new UrlSegmentGroup(slicedSegments,segmentGroup.children)))),slicedSegments:[]}:0===slicedSegments.length&&function(segmentGroup,segments,routes){return config.some(r=>isEmptyPathRedirect(segmentGroup,segments,r))}(segmentGroup,slicedSegments)?{segmentGroup:mergeTrivialChildren(new UrlSegmentGroup(segmentGroup.segments,function(segmentGroup,slicedSegments,routes,children){const res={};for(const r of routes)isEmptyPathRedirect(segmentGroup,slicedSegments,r)&&!children[getOutlet(r)]&&(res[getOutlet(r)]=new UrlSegmentGroup([],{}));return Object.assign({},children,res)}(segmentGroup,slicedSegments,config,segmentGroup.children))),slicedSegments:slicedSegments}:{segmentGroup:segmentGroup,slicedSegments:slicedSegments}}(rawSegmentGroup,consumedSegments,rawSlicedSegments,childConfig);return 0===slicedSegments.length&&segmentGroup.hasChildren()?this.expandChildren(childModule,childConfig,segmentGroup).pipe(map(children=>new UrlSegmentGroup(consumedSegments,children))):0===childConfig.length&&0===slicedSegments.length?of(new UrlSegmentGroup(consumedSegments,{})):this.expandSegment(childModule,segmentGroup,childConfig,slicedSegments,PRIMARY_OUTLET,!0).pipe(map(cs=>new UrlSegmentGroup(consumedSegments.concat(cs.segments),cs.children)))}))}getChildConfig(ngModule,route,segments){return route.children?of(new LoadedRouterConfig(route.children,ngModule)):route.loadChildren?void 0!==route._loadedConfig?of(route._loadedConfig):function(moduleInjector,route,segments){const canLoad=route.canLoad;return canLoad&&0!==canLoad.length?from_from(canLoad).pipe(map(injectionToken=>{const guard=moduleInjector.get(injectionToken);let guardVal;if(function(guard){return guard&&router_isFunction(guard.canLoad)}(guard))guardVal=guard.canLoad(route,segments);else{if(!router_isFunction(guard))throw new Error("Invalid CanLoad guard");guardVal=guard(route,segments)}return wrapIntoObservable(guardVal)})).pipe(concatAll(),(predicate=result=>!0===result,source=>source.lift(new EveryOperator(predicate,void 0,source)))):of(!0);var predicate}(ngModule.injector,route,segments).pipe(mergeMap(shouldLoad=>shouldLoad?this.configLoader.load(ngModule.injector,route).pipe(map(cfg=>(route._loadedConfig=cfg,cfg))):function(route){return new Observable_Observable(obs=>obs.error(navigationCancelingError(`Cannot load children because the guard of the route "path: '${route.path}'" returned false`)))}(route))):of(new LoadedRouterConfig([],ngModule))}lineralizeSegments(route,urlTree){let res=[],c=urlTree.root;for(;;){if(res=res.concat(c.segments),0===c.numberOfChildren)return of(res);if(c.numberOfChildren>1||!c.children[PRIMARY_OUTLET])return namedOutletsRedirect(route.redirectTo);c=c.children[PRIMARY_OUTLET]}}applyRedirectCommands(segments,redirectTo,posParams){return this.applyRedirectCreatreUrlTree(redirectTo,this.urlSerializer.parse(redirectTo),segments,posParams)}applyRedirectCreatreUrlTree(redirectTo,urlTree,segments,posParams){const newRoot=this.createSegmentGroup(redirectTo,urlTree.root,segments,posParams);return new UrlTree(newRoot,this.createQueryParams(urlTree.queryParams,this.urlTree.queryParams),urlTree.fragment)}createQueryParams(redirectToParams,actualParams){const res={};return forEach(redirectToParams,(v,k)=>{if("string"==typeof v&&v.startsWith(":")){const sourceName=v.substring(1);res[k]=actualParams[sourceName]}else res[k]=v}),res}createSegmentGroup(redirectTo,group,segments,posParams){const updatedSegments=this.createSegments(redirectTo,group.segments,segments,posParams);let children={};return forEach(group.children,(child,name)=>{children[name]=this.createSegmentGroup(redirectTo,child,segments,posParams)}),new UrlSegmentGroup(updatedSegments,children)}createSegments(redirectTo,redirectToSegments,actualSegments,posParams){return redirectToSegments.map(s=>s.path.startsWith(":")?this.findPosParam(redirectTo,s,posParams):this.findOrReturn(s,actualSegments))}findPosParam(redirectTo,redirectToUrlSegment,posParams){const pos=posParams[redirectToUrlSegment.path.substring(1)];if(!pos)throw new Error(`Cannot redirect to '${redirectTo}'. Cannot find '${redirectToUrlSegment.path}'.`);return pos}findOrReturn(redirectToUrlSegment,actualSegments){let idx=0;for(const s of actualSegments){if(s.path===redirectToUrlSegment.path)return actualSegments.splice(idx),s;idx++}return redirectToUrlSegment}}function router_match(segmentGroup,route,segments){if(""===route.path)return"full"===route.pathMatch&&(segmentGroup.hasChildren()||segments.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const res=(route.matcher||defaultUrlMatcher)(segments,segmentGroup,route);return res?{matched:!0,consumedSegments:res.consumed,lastChild:res.consumed.length,positionalParamSegments:res.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function mergeTrivialChildren(s){if(1===s.numberOfChildren&&s.children[PRIMARY_OUTLET]){const c=s.children[PRIMARY_OUTLET];return new UrlSegmentGroup(s.segments.concat(c.segments),c.children)}return s}function isEmptyPathRedirect(segmentGroup,segments,r){return(!(segmentGroup.hasChildren()||segments.length>0)||"full"!==r.pathMatch)&&""===r.path&&void 0!==r.redirectTo}function getOutlet(route){return route.outlet||PRIMARY_OUTLET}class CanActivate{constructor(path){this.path=path,this.route=this.path[this.path.length-1]}}class CanDeactivate{constructor(component,route){this.component=component,this.route=route}}function getAllRouteGuards(future,curr,parentContexts){const futureRoot=future._root;return function getChildRouteGuards(futureNode,currNode,contexts,futurePath,checks={canDeactivateChecks:[],canActivateChecks:[]}){const prevChildren=nodeChildrenAsMap(currNode);return futureNode.children.forEach(c=>{!function(futureNode,currNode,parentContexts,futurePath,checks={canDeactivateChecks:[],canActivateChecks:[]}){const future=futureNode.value,curr=currNode?currNode.value:null,context=parentContexts?parentContexts.getContext(futureNode.value.outlet):null;if(curr&&future.routeConfig===curr.routeConfig){const shouldRun=function(curr,future,mode){if("function"==typeof mode)return mode(curr,future);switch(mode){case"pathParamsChange":return!equalPath(curr.url,future.url);case"pathParamsOrQueryParamsChange":return!equalPath(curr.url,future.url)||!shallowEqual(curr.queryParams,future.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!equalParamsAndUrlSegments(curr,future)||!shallowEqual(curr.queryParams,future.queryParams);case"paramsChange":default:return!equalParamsAndUrlSegments(curr,future)}}(curr,future,future.routeConfig.runGuardsAndResolvers);shouldRun?checks.canActivateChecks.push(new CanActivate(futurePath)):(future.data=curr.data,future._resolvedData=curr._resolvedData),getChildRouteGuards(futureNode,currNode,future.component?context?context.children:null:parentContexts,futurePath,checks),shouldRun&&checks.canDeactivateChecks.push(new CanDeactivate(context&&context.outlet&&context.outlet.component||null,curr))}else curr&&deactivateRouteAndItsChildren(currNode,context,checks),checks.canActivateChecks.push(new CanActivate(futurePath)),getChildRouteGuards(futureNode,null,future.component?context?context.children:null:parentContexts,futurePath,checks)}(c,prevChildren[c.value.outlet],contexts,futurePath.concat([c.value]),checks),delete prevChildren[c.value.outlet]}),forEach(prevChildren,(v,k)=>deactivateRouteAndItsChildren(v,contexts.getContext(k),checks)),checks}(futureRoot,curr?curr._root:null,parentContexts,[futureRoot.value])}function getToken(token,snapshot,moduleInjector){const config=function(snapshot){if(!snapshot)return null;for(let s=snapshot.parent;s;s=s.parent){const route=s.routeConfig;if(route&&route._loadedConfig)return route._loadedConfig}return null}(snapshot);return(config?config.module.injector:moduleInjector).get(token)}function deactivateRouteAndItsChildren(route,context,checks){const children=nodeChildrenAsMap(route),r=route.value;forEach(children,(node,childName)=>{deactivateRouteAndItsChildren(node,r.component?context?context.children.getContext(childName):null:context,checks)}),checks.canDeactivateChecks.push(new CanDeactivate(r.component&&context&&context.outlet&&context.outlet.isActivated?context.outlet.component:null,r))}const INITIAL_VALUE=Symbol("INITIAL_VALUE");function prioritizedGuardValue(){return switchMap(obs=>(function(...observables){let resultSelector=null,scheduler=null;return isScheduler(observables[observables.length-1])&&(scheduler=observables.pop()),"function"==typeof observables[observables.length-1]&&(resultSelector=observables.pop()),1===observables.length&&isArray(observables[0])&&(observables=observables[0]),fromArray(observables,scheduler).lift(new CombineLatestOperator(resultSelector))})(...obs.map(o=>o.pipe(take(1),function(...array){return source=>{let scheduler=array[array.length-1];isScheduler(scheduler)?array.pop():scheduler=null;const len=array.length;return function(...observables){return concatAll()(of(...observables))}(1!==len||scheduler?len>0?fromArray(array,scheduler):empty_empty(scheduler):scalar(array[0]),source)}}(INITIAL_VALUE)))).pipe(scan((acc,list)=>{let isPending=!1;return list.reduce((innerAcc,val,i)=>{if(innerAcc!==INITIAL_VALUE)return innerAcc;if(val===INITIAL_VALUE&&(isPending=!0),!isPending){if(!1===val)return val;if(i===list.length-1||isUrlTree(val))return val}return innerAcc},acc)},INITIAL_VALUE),filter_filter(item=>item!==INITIAL_VALUE),map(item=>isUrlTree(item)?item:!0===item),take(1)))}function fireActivationStart(snapshot,forwardEvent){return null!==snapshot&&forwardEvent&&forwardEvent(new ActivationStart(snapshot)),of(!0)}function fireChildActivationStart(snapshot,forwardEvent){return null!==snapshot&&forwardEvent&&forwardEvent(new ChildActivationStart(snapshot)),of(!0)}function runCanActivate(futureRSS,futureARS,moduleInjector){const canActivate=futureARS.routeConfig?futureARS.routeConfig.canActivate:null;return canActivate&&0!==canActivate.length?of(canActivate.map(c=>defer_defer(()=>{const guard=getToken(c,futureARS,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canActivate)}(guard))observable=wrapIntoObservable(guard.canActivate(futureARS,futureRSS));else{if(!router_isFunction(guard))throw new Error("Invalid CanActivate guard");observable=wrapIntoObservable(guard(futureARS,futureRSS))}return observable.pipe(first_first())}))).pipe(prioritizedGuardValue()):of(!0)}function runCanActivateChild(futureRSS,path,moduleInjector){const futureARS=path[path.length-1],canActivateChildGuardsMapped=path.slice(0,path.length-1).reverse().map(p=>(function(p){const canActivateChild=p.routeConfig?p.routeConfig.canActivateChild:null;return canActivateChild&&0!==canActivateChild.length?{node:p,guards:canActivateChild}:null})(p)).filter(_=>null!==_).map(d=>defer_defer(()=>of(d.guards.map(c=>{const guard=getToken(c,d.node,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canActivateChild)}(guard))observable=wrapIntoObservable(guard.canActivateChild(futureARS,futureRSS));else{if(!router_isFunction(guard))throw new Error("Invalid CanActivateChild guard");observable=wrapIntoObservable(guard(futureARS,futureRSS))}return observable.pipe(first_first())})).pipe(prioritizedGuardValue())));return of(canActivateChildGuardsMapped).pipe(prioritizedGuardValue())}class NoMatch$1{}class router_Recognizer{constructor(rootComponentType,config,urlTree,url,paramsInheritanceStrategy,relativeLinkResolution){this.rootComponentType=rootComponentType,this.config=config,this.urlTree=urlTree,this.url=url,this.paramsInheritanceStrategy=paramsInheritanceStrategy,this.relativeLinkResolution=relativeLinkResolution}recognize(){try{const rootSegmentGroup=split$1(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,children=this.processSegmentGroup(this.config,rootSegmentGroup,PRIMARY_OUTLET),root=new ActivatedRouteSnapshot([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},PRIMARY_OUTLET,this.rootComponentType,null,this.urlTree.root,-1,{}),rootNode=new TreeNode(root,children),routeState=new RouterStateSnapshot(this.url,rootNode);return this.inheritParamsAndData(routeState._root),of(routeState)}catch(e){return new Observable_Observable(obs=>obs.error(e))}}inheritParamsAndData(routeNode){const route=routeNode.value,i=inheritedParamsDataResolve(route,this.paramsInheritanceStrategy);route.params=Object.freeze(i.params),route.data=Object.freeze(i.data),routeNode.children.forEach(n=>this.inheritParamsAndData(n))}processSegmentGroup(config,segmentGroup,outlet){return 0===segmentGroup.segments.length&&segmentGroup.hasChildren()?this.processChildren(config,segmentGroup):this.processSegment(config,segmentGroup,segmentGroup.segments,outlet)}processChildren(config,segmentGroup){const children=mapChildrenIntoArray(segmentGroup,(child,childOutlet)=>this.processSegmentGroup(config,child,childOutlet));return function(nodes){const names={};children.forEach(n=>{const routeWithSameOutletName=names[n.value.outlet];if(routeWithSameOutletName){const p=routeWithSameOutletName.url.map(s=>s.toString()).join("/"),c=n.value.url.map(s=>s.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${p}' and '${c}'.`)}names[n.value.outlet]=n.value})}(),children.sort((a,b)=>a.value.outlet===PRIMARY_OUTLET?-1:b.value.outlet===PRIMARY_OUTLET?1:a.value.outlet.localeCompare(b.value.outlet)),children}processSegment(config,segmentGroup,segments,outlet){for(const r of config)try{return this.processSegmentAgainstRoute(r,segmentGroup,segments,outlet)}catch(e){if(!(e instanceof NoMatch$1))throw e}if(this.noLeftoversInUrl(segmentGroup,segments,outlet))return[];throw new NoMatch$1}noLeftoversInUrl(segmentGroup,segments,outlet){return 0===segments.length&&!segmentGroup.children[outlet]}processSegmentAgainstRoute(route,rawSegment,segments,outlet){if(route.redirectTo)throw new NoMatch$1;if((route.outlet||PRIMARY_OUTLET)!==outlet)throw new NoMatch$1;let snapshot,consumedSegments=[],rawSlicedSegments=[];if("**"===route.path){const params=segments.length>0?router_last(segments).parameters:{};snapshot=new ActivatedRouteSnapshot(segments,params,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,getData(route),outlet,route.component,route,getSourceSegmentGroup(rawSegment),getPathIndexShift(rawSegment)+segments.length,getResolve(route))}else{const result=function(segmentGroup,route,segments){if(""===route.path){if("full"===route.pathMatch&&(segmentGroup.hasChildren()||segments.length>0))throw new NoMatch$1;return{consumedSegments:[],lastChild:0,parameters:{}}}const res=(route.matcher||defaultUrlMatcher)(segments,segmentGroup,route);if(!res)throw new NoMatch$1;const posParams={};forEach(res.posParams,(v,k)=>{posParams[k]=v.path});const parameters=res.consumed.length>0?Object.assign({},posParams,res.consumed[res.consumed.length-1].parameters):posParams;return{consumedSegments:res.consumed,lastChild:res.consumed.length,parameters:parameters}}(rawSegment,route,segments);consumedSegments=result.consumedSegments,rawSlicedSegments=segments.slice(result.lastChild),snapshot=new ActivatedRouteSnapshot(consumedSegments,result.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,getData(route),outlet,route.component,route,getSourceSegmentGroup(rawSegment),getPathIndexShift(rawSegment)+consumedSegments.length,getResolve(route))}const childConfig=function(route){return route.children?route.children:route.loadChildren?route._loadedConfig.routes:[]}(route),{segmentGroup:segmentGroup,slicedSegments:slicedSegments}=split$1(rawSegment,consumedSegments,rawSlicedSegments,childConfig,this.relativeLinkResolution);if(0===slicedSegments.length&&segmentGroup.hasChildren()){const children=this.processChildren(childConfig,segmentGroup);return[new TreeNode(snapshot,children)]}if(0===childConfig.length&&0===slicedSegments.length)return[new TreeNode(snapshot,[])];const children=this.processSegment(childConfig,segmentGroup,slicedSegments,PRIMARY_OUTLET);return[new TreeNode(snapshot,children)]}}function getSourceSegmentGroup(segmentGroup){let s=segmentGroup;for(;s._sourceSegment;)s=s._sourceSegment;return s}function getPathIndexShift(segmentGroup){let s=segmentGroup,res=s._segmentIndexShift?s._segmentIndexShift:0;for(;s._sourceSegment;)res+=(s=s._sourceSegment)._segmentIndexShift?s._segmentIndexShift:0;return res-1}function split$1(segmentGroup,consumedSegments,slicedSegments,config,relativeLinkResolution){if(slicedSegments.length>0&&function(segmentGroup,slicedSegments,routes){return config.some(r=>emptyPathMatch(segmentGroup,slicedSegments,r)&&getOutlet$1(r)!==PRIMARY_OUTLET)}(segmentGroup,slicedSegments)){const s=new UrlSegmentGroup(consumedSegments,function(segmentGroup,consumedSegments,routes,primarySegment){const res={};res[PRIMARY_OUTLET]=primarySegment,primarySegment._sourceSegment=segmentGroup,primarySegment._segmentIndexShift=consumedSegments.length;for(const r of routes)if(""===r.path&&getOutlet$1(r)!==PRIMARY_OUTLET){const s=new UrlSegmentGroup([],{});s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,res[getOutlet$1(r)]=s}return res}(segmentGroup,consumedSegments,config,new UrlSegmentGroup(slicedSegments,segmentGroup.children)));return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:[]}}if(0===slicedSegments.length&&function(segmentGroup,slicedSegments,routes){return config.some(r=>emptyPathMatch(segmentGroup,slicedSegments,r))}(segmentGroup,slicedSegments)){const s=new UrlSegmentGroup(segmentGroup.segments,function(segmentGroup,consumedSegments,slicedSegments,routes,children,relativeLinkResolution){const res={};for(const r of routes)if(emptyPathMatch(segmentGroup,slicedSegments,r)&&!children[getOutlet$1(r)]){const s=new UrlSegmentGroup([],{});s._sourceSegment=segmentGroup,s._segmentIndexShift="legacy"===relativeLinkResolution?segmentGroup.segments.length:consumedSegments.length,res[getOutlet$1(r)]=s}return Object.assign({},children,res)}(segmentGroup,consumedSegments,slicedSegments,config,segmentGroup.children,relativeLinkResolution));return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:slicedSegments}}const s=new UrlSegmentGroup(segmentGroup.segments,segmentGroup.children);return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:slicedSegments}}function emptyPathMatch(segmentGroup,slicedSegments,r){return(!(segmentGroup.hasChildren()||slicedSegments.length>0)||"full"!==r.pathMatch)&&""===r.path&&void 0===r.redirectTo}function getOutlet$1(route){return route.outlet||PRIMARY_OUTLET}function getData(route){return route.data||{}}function getResolve(route){return route.resolve||{}}function getResolver(injectionToken,futureARS,futureRSS,moduleInjector){const resolver=getToken(injectionToken,futureARS,moduleInjector);return wrapIntoObservable(resolver.resolve?resolver.resolve(futureARS,futureRSS):resolver(futureARS,futureRSS))}function switchTap(next){return function(source){return source.pipe(switchMap(v=>{const nextResult=next(v);return nextResult?from_from(nextResult).pipe(map(()=>v)):from_from([v])}))}}class RouteReuseStrategy{}class DefaultRouteReuseStrategy{shouldDetach(route){return!1}store(route,detachedTree){}shouldAttach(route){return!1}retrieve(route){return null}shouldReuseRoute(future,curr){return future.routeConfig===curr.routeConfig}}const ROUTES=new InjectionToken("ROUTES");class router_RouterConfigLoader{constructor(loader,compiler,onLoadStartListener,onLoadEndListener){this.loader=loader,this.compiler=compiler,this.onLoadStartListener=onLoadStartListener,this.onLoadEndListener=onLoadEndListener}load(parentInjector,route){return this.onLoadStartListener&&this.onLoadStartListener(route),this.loadModuleFactory(route.loadChildren).pipe(map(factory=>{this.onLoadEndListener&&this.onLoadEndListener(route);const module=factory.create(parentInjector);return new LoadedRouterConfig(router_flatten(module.injector.get(ROUTES)).map(standardizeConfig),module)}))}loadModuleFactory(loadChildren){return"string"==typeof loadChildren?from_from(this.loader.load(loadChildren)):wrapIntoObservable(loadChildren()).pipe(mergeMap(t=>t instanceof NgModuleFactory?of(t):from_from(this.compiler.compileModuleAsync(t))))}}class UrlHandlingStrategy{}class DefaultUrlHandlingStrategy{shouldProcessUrl(url){return!0}extract(url){return url}merge(newUrlPart,wholeUrl){return newUrlPart}}function defaultErrorHandler(error){throw error}function defaultMalformedUriErrorHandler(error,urlSerializer,url){return urlSerializer.parse("/")}function defaultRouterHook(snapshot,runExtras){return of(null)}class router_Router{constructor(rootComponentType,urlSerializer,rootContexts,location,injector,loader,compiler,config){this.rootComponentType=rootComponentType,this.urlSerializer=urlSerializer,this.rootContexts=rootContexts,this.location=location,this.config=config,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new Subject_Subject,this.errorHandler=defaultErrorHandler,this.malformedUriErrorHandler=defaultMalformedUriErrorHandler,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:defaultRouterHook,afterPreactivation:defaultRouterHook},this.urlHandlingStrategy=new DefaultUrlHandlingStrategy,this.routeReuseStrategy=new DefaultRouteReuseStrategy,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=injector.get(NgModuleRef),this.console=injector.get(Console);const ngZone=injector.get(NgZone);this.isNgZoneEnabled=ngZone instanceof NgZone,this.resetConfig(config),this.currentUrlTree=new UrlTree(new UrlSegmentGroup([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new router_RouterConfigLoader(loader,compiler,r=>this.triggerEvent(new RouteConfigLoadStart(r)),r=>this.triggerEvent(new RouteConfigLoadEnd(r))),this.routerState=createEmptyState(this.currentUrlTree,this.rootComponentType),this.transitions=new BehaviorSubject_BehaviorSubject({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(transitions){const eventsSubject=this.events;return transitions.pipe(filter_filter(t=>0!==t.id),map(t=>Object.assign({},t,{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),switchMap(t=>{let completed=!1,errored=!1;return of(t).pipe(tap(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign({},this.lastSuccessfulNavigation,{previousNavigation:null}):null}}),switchMap(t=>{const urlTransition=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||urlTransition)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return of(t).pipe(switchMap(t=>{const transition=this.transitions.getValue();return eventsSubject.next(new NavigationStart(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),transition!==this.transitions.getValue()?empty_EMPTY:[t]}),switchMap(t=>Promise.resolve(t)),function(moduleInjector,configLoader,urlSerializer,config){return function(source){return source.pipe(switchMap(t=>(function(moduleInjector,configLoader,urlSerializer,urlTree,config){return new router_ApplyRedirects(moduleInjector,configLoader,urlSerializer,t.extractedUrl,config).apply()})(moduleInjector,configLoader,urlSerializer,0,config).pipe(map(urlAfterRedirects=>Object.assign({},t,{urlAfterRedirects:urlAfterRedirects})))))}}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),tap(t=>{this.currentNavigation=Object.assign({},this.currentNavigation,{finalUrl:t.urlAfterRedirects})}),function(rootComponentType,config,serializer,paramsInheritanceStrategy,relativeLinkResolution){return function(source){return source.pipe(mergeMap(t=>(function(rootComponentType,config,urlTree,url,paramsInheritanceStrategy="emptyOnly",relativeLinkResolution="legacy"){return new router_Recognizer(rootComponentType,config,urlTree,url,paramsInheritanceStrategy,relativeLinkResolution).recognize()})(rootComponentType,config,t.urlAfterRedirects,serializer(t.urlAfterRedirects),paramsInheritanceStrategy,relativeLinkResolution).pipe(map(targetSnapshot=>Object.assign({},t,{targetSnapshot:targetSnapshot})))))}}(this.rootComponentType,this.config,url=>this.serializeUrl(url),this.paramsInheritanceStrategy,this.relativeLinkResolution),tap(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),tap(t=>{const routesRecognized=new RoutesRecognized(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);eventsSubject.next(routesRecognized)}));if(urlTransition&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:id,extractedUrl:extractedUrl,source:source,restoredState:restoredState,extras:extras}=t,navStart=new NavigationStart(id,this.serializeUrl(extractedUrl),source,restoredState);eventsSubject.next(navStart);const targetSnapshot=createEmptyState(extractedUrl,this.rootComponentType).snapshot;return of(Object.assign({},t,{targetSnapshot:targetSnapshot,urlAfterRedirects:extractedUrl,extras:Object.assign({},extras,{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),empty_EMPTY}),switchTap(t=>{const{targetSnapshot:targetSnapshot,id:navigationId,extractedUrl:appliedUrlTree,rawUrl:rawUrlTree,extras:{skipLocationChange:skipLocationChange,replaceUrl:replaceUrl}}=t;return this.hooks.beforePreactivation(targetSnapshot,{navigationId:navigationId,appliedUrlTree:appliedUrlTree,rawUrlTree:rawUrlTree,skipLocationChange:!!skipLocationChange,replaceUrl:!!replaceUrl})}),tap(t=>{const guardsStart=new GuardsCheckStart(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(guardsStart)}),map(t=>Object.assign({},t,{guards:getAllRouteGuards(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(moduleInjector,forwardEvent){return function(source){return source.pipe(mergeMap(t=>{const{targetSnapshot:targetSnapshot,currentSnapshot:currentSnapshot,guards:{canActivateChecks:canActivateChecks,canDeactivateChecks:canDeactivateChecks}}=t;return 0===canDeactivateChecks.length&&0===canActivateChecks.length?of(Object.assign({},t,{guardsResult:!0})):function(checks,futureRSS,currRSS,moduleInjector){return from_from(canDeactivateChecks).pipe(mergeMap(check=>(function(component,currARS,currRSS,futureRSS,moduleInjector){const canDeactivate=currARS&&currARS.routeConfig?currARS.routeConfig.canDeactivate:null;return canDeactivate&&0!==canDeactivate.length?of(canDeactivate.map(c=>{const guard=getToken(c,currARS,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canDeactivate)}(guard))observable=wrapIntoObservable(guard.canDeactivate(component,currARS,currRSS,futureRSS));else{if(!router_isFunction(guard))throw new Error("Invalid CanDeactivate guard");observable=wrapIntoObservable(guard(component,currARS,currRSS,futureRSS))}return observable.pipe(first_first())})).pipe(prioritizedGuardValue()):of(!0)})(check.component,check.route,currRSS,futureRSS,moduleInjector)),first_first(result=>!0!==result,!0))}(0,targetSnapshot,currentSnapshot,moduleInjector).pipe(mergeMap(canDeactivate=>canDeactivate&&function(v){return"boolean"==typeof canDeactivate}()?function(futureSnapshot,checks,moduleInjector,forwardEvent){return from_from(canActivateChecks).pipe(concatMap(check=>from_from([fireChildActivationStart(check.route.parent,forwardEvent),fireActivationStart(check.route,forwardEvent),runCanActivateChild(futureSnapshot,check.path,moduleInjector),runCanActivate(futureSnapshot,check.route,moduleInjector)]).pipe(concatAll(),first_first(result=>!0!==result,!0))),first_first(result=>!0!==result,!0))}(targetSnapshot,0,moduleInjector,forwardEvent):of(canDeactivate)),map(guardsResult=>Object.assign({},t,{guardsResult:guardsResult})))}))}}(this.ngModule.injector,evt=>this.triggerEvent(evt)),tap(t=>{if(isUrlTree(t.guardsResult)){const error=navigationCancelingError(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw error.url=t.guardsResult,error}}),tap(t=>{const guardsEnd=new GuardsCheckEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(guardsEnd)}),filter_filter(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),"");return eventsSubject.next(navCancel),t.resolve(!1),!1}return!0}),switchTap(t=>{if(t.guards.canActivateChecks.length)return of(t).pipe(tap(t=>{const resolveStart=new ResolveStart(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(resolveStart)}),function(paramsInheritanceStrategy,moduleInjector){return function(source){return source.pipe(mergeMap(t=>{const{targetSnapshot:targetSnapshot,guards:{canActivateChecks:canActivateChecks}}=t;return canActivateChecks.length?from_from(canActivateChecks).pipe(concatMap(check=>(function(futureARS,futureRSS,paramsInheritanceStrategy,moduleInjector){return function(resolve,futureARS,futureRSS,moduleInjector){const keys=Object.keys(resolve);if(0===keys.length)return of({});if(1===keys.length){const key=keys[0];return getResolver(resolve[key],futureARS,futureRSS,moduleInjector).pipe(map(value=>({[key]:value})))}const data={};return from_from(keys).pipe(mergeMap(key=>getResolver(resolve[key],futureARS,futureRSS,moduleInjector).pipe(map(value=>(data[key]=value,value))))).pipe(last_last(),map(()=>data))}(futureARS._resolve,futureARS,targetSnapshot,moduleInjector).pipe(map(resolvedData=>(futureARS._resolvedData=resolvedData,futureARS.data=Object.assign({},futureARS.data,inheritedParamsDataResolve(futureARS,paramsInheritanceStrategy).resolve),null)))})(check.route,0,paramsInheritanceStrategy,moduleInjector)),function(accumulator,seed){return arguments.length>=2?function(source){return pipe(scan(accumulator,seed),takeLast(1),defaultIfEmpty(seed))(source)}:function(source){return pipe(scan((acc,value,index)=>accumulator(acc,value,index+1)),takeLast(1))(source)}}((_,__)=>_),map(_=>t)):of(t)}))}}(this.paramsInheritanceStrategy,this.ngModule.injector),tap(t=>{const resolveEnd=new ResolveEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(resolveEnd)}))}),switchTap(t=>{const{targetSnapshot:targetSnapshot,id:navigationId,extractedUrl:appliedUrlTree,rawUrl:rawUrlTree,extras:{skipLocationChange:skipLocationChange,replaceUrl:replaceUrl}}=t;return this.hooks.afterPreactivation(targetSnapshot,{navigationId:navigationId,appliedUrlTree:appliedUrlTree,rawUrlTree:rawUrlTree,skipLocationChange:!!skipLocationChange,replaceUrl:!!replaceUrl})}),map(t=>{const targetRouterState=function(routeReuseStrategy,curr,prevState){const root=function createNode(routeReuseStrategy,curr,prevState){if(prevState&&routeReuseStrategy.shouldReuseRoute(curr.value,prevState.value.snapshot)){const value=prevState.value;value._futureSnapshot=curr.value;const children=function(routeReuseStrategy,curr,prevState){return curr.children.map(child=>{for(const p of prevState.children)if(routeReuseStrategy.shouldReuseRoute(p.value.snapshot,child.value))return createNode(routeReuseStrategy,child,p);return createNode(routeReuseStrategy,child)})}(routeReuseStrategy,curr,prevState);return new TreeNode(value,children)}{const detachedRouteHandle=routeReuseStrategy.retrieve(curr.value);if(detachedRouteHandle){const tree=detachedRouteHandle.route;return function setFutureSnapshotsOfActivatedRoutes(curr,result){if(curr.value.routeConfig!==result.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(curr.children.length!==result.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");result.value._futureSnapshot=curr.value;for(let i=0;i<curr.children.length;++i)setFutureSnapshotsOfActivatedRoutes(curr.children[i],result.children[i])}(curr,tree),tree}{const value=new router_ActivatedRoute(new BehaviorSubject_BehaviorSubject((c=curr.value).url),new BehaviorSubject_BehaviorSubject(c.params),new BehaviorSubject_BehaviorSubject(c.queryParams),new BehaviorSubject_BehaviorSubject(c.fragment),new BehaviorSubject_BehaviorSubject(c.data),c.outlet,c.component,c),children=curr.children.map(c=>createNode(routeReuseStrategy,c));return new TreeNode(value,children)}}var c}(routeReuseStrategy,curr._root,prevState?prevState._root:void 0);return new RouterState(root,curr)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign({},t,{targetRouterState:targetRouterState})}),tap(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),activateRoutes(this.rootContexts,this.routeReuseStrategy,evt=>this.triggerEvent(evt)),tap({next(){completed=!0},complete(){completed=!0}}),function(callback){return source=>source.lift(new FinallyOperator(callback))}(()=>{if(!completed&&!errored){this.resetUrlToCurrentUrlTree();const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);eventsSubject.next(navCancel),t.resolve(!1)}this.currentNavigation=null}),catchError(e=>{if(errored=!0,function(error){return e&&e[NAVIGATION_CANCELING_ERROR]}()){const redirecting=isUrlTree(e.url);redirecting||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),e.message);eventsSubject.next(navCancel),t.resolve(!1),redirecting&&this.navigateByUrl(e.url)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const navError=new NavigationError(t.id,this.serializeUrl(t.extractedUrl),e);eventsSubject.next(navError);try{t.resolve(this.errorHandler(e))}catch(ee){t.reject(ee)}}return empty_EMPTY}))}))}resetRootComponentType(rootComponentType){this.rootComponentType=rootComponentType,this.routerState.root.component=this.rootComponentType}getTransition(){const transition=this.transitions.value;return transition.urlAfterRedirects=this.browserUrlTree,transition}setTransition(t){this.transitions.next(Object.assign({},this.getTransition(),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(change=>{let rawUrlTree=this.parseUrl(change.url);const source="popstate"===change.type?"popstate":"hashchange",state=change.state&&change.state.navigationId?change.state:null;setTimeout(()=>{this.scheduleNavigation(rawUrlTree,source,state,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(event){this.events.next(event)}resetConfig(config){validateConfig(config),this.config=config.map(standardizeConfig),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(commands,navigationExtras={}){const{relativeTo:relativeTo,queryParams:queryParams,fragment:fragment,preserveQueryParams:preserveQueryParams,queryParamsHandling:queryParamsHandling,preserveFragment:preserveFragment}=navigationExtras;isDevMode()&&preserveQueryParams&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const a=relativeTo||this.routerState.root,f=preserveFragment?this.currentUrlTree.fragment:fragment;let q=null;if(queryParamsHandling)switch(queryParamsHandling){case"merge":q=Object.assign({},this.currentUrlTree.queryParams,queryParams);break;case"preserve":q=this.currentUrlTree.queryParams;break;default:q=queryParams||null}else q=preserveQueryParams?this.currentUrlTree.queryParams:queryParams||null;return null!==q&&(q=this.removeEmptyProps(q)),function(route,urlTree,commands,queryParams,fragment){if(0===commands.length)return router_tree(urlTree.root,urlTree.root,urlTree,queryParams,fragment);const nav=function(commands){if("string"==typeof commands[0]&&1===commands.length&&"/"===commands[0])return new Navigation(!0,0,commands);let numberOfDoubleDots=0,isAbsolute=!1;const res=commands.reduce((res,cmd,cmdIdx)=>{if("object"==typeof cmd&&null!=cmd){if(cmd.outlets){const outlets={};return forEach(cmd.outlets,(commands,name)=>{outlets[name]="string"==typeof commands?commands.split("/"):commands}),[...res,{outlets:outlets}]}if(cmd.segmentPath)return[...res,cmd.segmentPath]}return"string"!=typeof cmd?[...res,cmd]:0===cmdIdx?(cmd.split("/").forEach((urlPart,partIndex)=>{0==partIndex&&"."===urlPart||(0==partIndex&&""===urlPart?isAbsolute=!0:".."===urlPart?numberOfDoubleDots++:""!=urlPart&&res.push(urlPart))}),res):[...res,cmd]},[]);return new Navigation(isAbsolute,numberOfDoubleDots,res)}(commands);if(nav.toRoot())return router_tree(urlTree.root,new UrlSegmentGroup([],{}),urlTree,queryParams,fragment);const startingPosition=function(nav,tree,route){if(nav.isAbsolute)return new router_Position(urlTree.root,!0,0);if(-1===route.snapshot._lastPathIndex)return new router_Position(route.snapshot._urlSegment,!0,0);const modifier=isMatrixParams(nav.commands[0])?0:1;return function(group,index,numberOfDoubleDots){let g=route.snapshot._urlSegment,ci=route.snapshot._lastPathIndex+modifier,dd=nav.numberOfDoubleDots;for(;dd>ci;){if(dd-=ci,!(g=g.parent))throw new Error("Invalid number of '../'");ci=g.segments.length}return new router_Position(g,!1,ci-dd)}()}(nav,0,route),segmentGroup=startingPosition.processChildren?updateSegmentGroupChildren(startingPosition.segmentGroup,startingPosition.index,nav.commands):updateSegmentGroup(startingPosition.segmentGroup,startingPosition.index,nav.commands);return router_tree(startingPosition.segmentGroup,segmentGroup,urlTree,queryParams,fragment)}(a,this.currentUrlTree,commands,q,f)}navigateByUrl(url,extras={skipLocationChange:!1}){isDevMode()&&this.isNgZoneEnabled&&!NgZone.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const urlTree=isUrlTree(url)?url:this.parseUrl(url),mergedTree=this.urlHandlingStrategy.merge(urlTree,this.rawUrlTree);return this.scheduleNavigation(mergedTree,"imperative",null,extras)}navigate(commands,extras={skipLocationChange:!1}){return function(commands){for(let i=0;i<commands.length;i++){const cmd=commands[i];if(null==cmd)throw new Error(`The requested path contains ${cmd} segment at index ${i}`)}}(commands),this.navigateByUrl(this.createUrlTree(commands,extras),extras)}serializeUrl(url){return this.urlSerializer.serialize(url)}parseUrl(url){let urlTree;try{urlTree=this.urlSerializer.parse(url)}catch(e){urlTree=this.malformedUriErrorHandler(e,this.urlSerializer,url)}return urlTree}isActive(url,exact){if(isUrlTree(url))return containsTree(this.currentUrlTree,url,exact);const urlTree=this.parseUrl(url);return containsTree(this.currentUrlTree,urlTree,exact)}removeEmptyProps(params){return Object.keys(params).reduce((result,key)=>{const value=params[key];return null!=value&&(result[key]=value),result},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new NavigationEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},e=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(rawUrl,source,restoredState,extras){const lastNavigation=this.getTransition();if(lastNavigation&&"imperative"!==source&&"imperative"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);if(lastNavigation&&"hashchange"==source&&"popstate"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);if(lastNavigation&&"popstate"==source&&"hashchange"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);let resolve=null,reject=null;const promise=new Promise((res,rej)=>{resolve=res,reject=rej}),id=++this.navigationId;return this.setTransition({id:id,source:source,restoredState:restoredState,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:rawUrl,extras:extras,resolve:resolve,reject:reject,promise:promise,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),promise.catch(e=>Promise.reject(e))}setBrowserUrl(url,replaceUrl,id,state){const path=this.urlSerializer.serialize(url);state=state||{},this.location.isCurrentPathEqualTo(path)||replaceUrl?this.location.replaceState(path,"",Object.assign({},state,{navigationId:id})):this.location.go(path,"",Object.assign({},state,{navigationId:id}))}resetStateAndUrl(storedState,storedUrl,rawUrl){this.routerState=storedState,this.currentUrlTree=storedUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,rawUrl),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}class OutletContext{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new ChildrenOutletContexts,this.attachRef=null}}class ChildrenOutletContexts{constructor(){this.contexts=new Map}onChildOutletCreated(childName,outlet){const context=this.getOrCreateContext(childName);context.outlet=outlet,this.contexts.set(childName,context)}onChildOutletDestroyed(childName){const context=this.getContext(childName);context&&(context.outlet=null)}onOutletDeactivated(){const contexts=this.contexts;return this.contexts=new Map,contexts}onOutletReAttached(contexts){this.contexts=contexts}getOrCreateContext(childName){let context=this.getContext(childName);return context||(context=new OutletContext,this.contexts.set(childName,context)),context}getContext(childName){return this.contexts.get(childName)||null}}class router_RouterOutlet{constructor(parentContexts,location,resolver,name,changeDetector){this.parentContexts=parentContexts,this.location=location,this.resolver=resolver,this.changeDetector=changeDetector,this.activated=null,this._activatedRoute=null,this.activateEvents=new core_EventEmitter,this.deactivateEvents=new core_EventEmitter,this.name=name||PRIMARY_OUTLET,parentContexts.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const context=this.parentContexts.getContext(this.name);context&&context.route&&(context.attachRef?this.attach(context.attachRef,context.route):this.activateWith(context.route,context.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const cmp=this.activated;return this.activated=null,this._activatedRoute=null,cmp}attach(ref,activatedRoute){this.activated=ref,this._activatedRoute=activatedRoute,this.location.insert(ref.hostView)}deactivate(){if(this.activated){const c=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(c)}}activateWith(activatedRoute,resolver){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=activatedRoute;const factory=(resolver=resolver||this.resolver).resolveComponentFactory(activatedRoute._futureSnapshot.routeConfig.component),childContexts=this.parentContexts.getOrCreateContext(this.name).children,injector=new OutletInjector(activatedRoute,childContexts,this.location.injector);this.activated=this.location.createComponent(factory,this.location.length,injector),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}class OutletInjector{constructor(route,childContexts,parent){this.route=route,this.childContexts=childContexts,this.parent=parent}get(token,notFoundValue){return token===router_ActivatedRoute?this.route:token===ChildrenOutletContexts?this.childContexts:this.parent.get(token,notFoundValue)}}class PreloadingStrategy{}class router_PreloadAllModules{preload(route,fn){return fn().pipe(catchError(()=>of(null)))}}class router_NoPreloading{preload(route,fn){return of(null)}}class router_RouterPreloader{constructor(router,moduleLoader,compiler,injector,preloadingStrategy){this.router=router,this.injector=injector,this.preloadingStrategy=preloadingStrategy,this.loader=new router_RouterConfigLoader(moduleLoader,compiler,r=>router.triggerEvent(new RouteConfigLoadStart(r)),r=>router.triggerEvent(new RouteConfigLoadEnd(r)))}setUpPreloading(){this.subscription=this.router.events.pipe(filter_filter(e=>e instanceof NavigationEnd),concatMap(()=>this.preload())).subscribe(()=>{})}preload(){const ngModule=this.injector.get(NgModuleRef);return this.processRoutes(ngModule,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(ngModule,routes){const res=[];for(const route of routes)if(route.loadChildren&&!route.canLoad&&route._loadedConfig){const childConfig=route._loadedConfig;res.push(this.processRoutes(childConfig.module,childConfig.routes))}else route.loadChildren&&!route.canLoad?res.push(this.preloadConfig(ngModule,route)):route.children&&res.push(this.processRoutes(ngModule,route.children));return from_from(res).pipe(mergeAll(),map(_=>void 0))}preloadConfig(ngModule,route){return this.preloadingStrategy.preload(route,()=>this.loader.load(ngModule.injector,route).pipe(mergeMap(config=>(route._loadedConfig=config,this.processRoutes(config.module,config.routes)))))}}class RouterScroller{constructor(router,viewportScroller,options={}){this.router=router,this.viewportScroller=viewportScroller,this.options=options,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},options.scrollPositionRestoration=options.scrollPositionRestoration||"disabled",options.anchorScrolling=options.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof NavigationStart?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof NavigationEnd&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof router_Scroll&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(routerEvent,anchor){this.router.triggerEvent(new router_Scroll(routerEvent,"popstate"===this.lastSource?this.store[this.restoredId]:null,anchor))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}const ROUTER_CONFIGURATION=new InjectionToken("ROUTER_CONFIGURATION"),ROUTER_FORROOT_GUARD=new InjectionToken("ROUTER_FORROOT_GUARD"),ROUTER_PROVIDERS=[common_Location,{provide:UrlSerializer,useClass:DefaultUrlSerializer},{provide:router_Router,useFactory:setupRouter,deps:[core_ApplicationRef,UrlSerializer,ChildrenOutletContexts,common_Location,Injector,NgModuleFactoryLoader,Compiler,ROUTES,ROUTER_CONFIGURATION,[UrlHandlingStrategy,new Optional],[RouteReuseStrategy,new Optional]]},ChildrenOutletContexts,{provide:router_ActivatedRoute,useFactory:rootRoute,deps:[router_Router]},{provide:NgModuleFactoryLoader,useClass:SystemJsNgModuleLoader},router_RouterPreloader,router_NoPreloading,router_PreloadAllModules,{provide:ROUTER_CONFIGURATION,useValue:{enableTracing:!1}}];function routerNgProbeToken(){return new NgProbeToken("Router",router_Router)}class router_RouterModule{constructor(guard,router){}static forRoot(routes,config){return{ngModule:router_RouterModule,providers:[ROUTER_PROVIDERS,provideRoutes(routes),{provide:ROUTER_FORROOT_GUARD,useFactory:provideForRootGuard,deps:[[router_Router,new Optional,new SkipSelf]]},{provide:ROUTER_CONFIGURATION,useValue:config||{}},{provide:LocationStrategy,useFactory:provideLocationStrategy,deps:[PlatformLocation,[new Inject(APP_BASE_HREF),new Optional],ROUTER_CONFIGURATION]},{provide:RouterScroller,useFactory:createRouterScroller,deps:[router_Router,common_ViewportScroller,ROUTER_CONFIGURATION]},{provide:PreloadingStrategy,useExisting:config&&config.preloadingStrategy?config.preloadingStrategy:router_NoPreloading},{provide:NgProbeToken,multi:!0,useFactory:routerNgProbeToken},[router_RouterInitializer,{provide:APP_INITIALIZER,multi:!0,useFactory:getAppInitializer,deps:[router_RouterInitializer]},{provide:ROUTER_INITIALIZER,useFactory:getBootstrapListener,deps:[router_RouterInitializer]},{provide:APP_BOOTSTRAP_LISTENER,multi:!0,useExisting:ROUTER_INITIALIZER}]]}}static forChild(routes){return{ngModule:router_RouterModule,providers:[provideRoutes(routes)]}}}function createRouterScroller(router,viewportScroller,config){return config.scrollOffset&&viewportScroller.setOffset(config.scrollOffset),new RouterScroller(router,viewportScroller,config)}function provideLocationStrategy(platformLocationStrategy,baseHref,options={}){return options.useHash?new HashLocationStrategy(platformLocationStrategy,baseHref):new PathLocationStrategy(platformLocationStrategy,baseHref)}function provideForRootGuard(router){if(router)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function provideRoutes(routes){return[{provide:ANALYZE_FOR_ENTRY_COMPONENTS,multi:!0,useValue:routes},{provide:ROUTES,multi:!0,useValue:routes}]}function setupRouter(ref,urlSerializer,contexts,location,injector,loader,compiler,config,opts={},urlHandlingStrategy,routeReuseStrategy){const router=new router_Router(null,urlSerializer,contexts,location,injector,loader,compiler,router_flatten(config));if(urlHandlingStrategy&&(router.urlHandlingStrategy=urlHandlingStrategy),routeReuseStrategy&&(router.routeReuseStrategy=routeReuseStrategy),opts.errorHandler&&(router.errorHandler=opts.errorHandler),opts.malformedUriErrorHandler&&(router.malformedUriErrorHandler=opts.malformedUriErrorHandler),opts.enableTracing){const dom=getDOM();router.events.subscribe(e=>{dom.logGroup(`Router Event: ${e.constructor.name}`),dom.log(e.toString()),dom.log(e),dom.logGroupEnd()})}return opts.onSameUrlNavigation&&(router.onSameUrlNavigation=opts.onSameUrlNavigation),opts.paramsInheritanceStrategy&&(router.paramsInheritanceStrategy=opts.paramsInheritanceStrategy),opts.urlUpdateStrategy&&(router.urlUpdateStrategy=opts.urlUpdateStrategy),opts.relativeLinkResolution&&(router.relativeLinkResolution=opts.relativeLinkResolution),router}function rootRoute(router){return router.routerState.root}class router_RouterInitializer{constructor(injector){this.injector=injector,this.initNavigation=!1,this.resultOfPreactivationDone=new Subject_Subject}appInitializer(){return this.injector.get(LOCATION_INITIALIZED,Promise.resolve(null)).then(()=>{let resolve=null;const res=new Promise(r=>resolve=r),router=this.injector.get(router_Router),opts=this.injector.get(ROUTER_CONFIGURATION);if(this.isLegacyDisabled(opts)||this.isLegacyEnabled(opts))resolve(!0);else if("disabled"===opts.initialNavigation)router.setUpLocationChangeListener(),resolve(!0);else{if("enabled"!==opts.initialNavigation)throw new Error(`Invalid initialNavigation options: '${opts.initialNavigation}'`);router.hooks.afterPreactivation=()=>this.initNavigation?of(null):(this.initNavigation=!0,resolve(!0),this.resultOfPreactivationDone),router.initialNavigation()}return res})}bootstrapListener(bootstrappedComponentRef){const opts=this.injector.get(ROUTER_CONFIGURATION),preloader=this.injector.get(router_RouterPreloader),routerScroller=this.injector.get(RouterScroller),router=this.injector.get(router_Router),ref=this.injector.get(core_ApplicationRef);bootstrappedComponentRef===ref.components[0]&&(this.isLegacyEnabled(opts)?router.initialNavigation():this.isLegacyDisabled(opts)&&router.setUpLocationChangeListener(),preloader.setUpPreloading(),routerScroller.init(),router.resetRootComponentType(ref.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(opts){return"legacy_enabled"===opts.initialNavigation||!0===opts.initialNavigation||void 0===opts.initialNavigation}isLegacyDisabled(opts){return"legacy_disabled"===opts.initialNavigation||!1===opts.initialNavigation}}function getAppInitializer(r){return r.appInitializer.bind(r)}function getBootstrapListener(r){return r.bootstrapListener.bind(r)}const ROUTER_INITIALIZER=new InjectionToken("Router Initializer");var RenderType_ɵangular_packages_router_router_l=createRendererType2({encapsulation:2,styles:[],data:{}});function View_ɵangular_packages_router_router_l_0(_l){return viewDef(0,[(_l()(),elementDef(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),directiveDef(1,212992,null,0,router_RouterOutlet,[ChildrenOutletContexts,ViewContainerRef,ComponentFactoryResolver,[8,null],ChangeDetectorRef],null,null)],function(_ck,_v){_ck(_v,1,0)},null)}function View_ɵangular_packages_router_router_l_Host_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"ng-component",[],null,null,null,View_ɵangular_packages_router_router_l_0,RenderType_ɵangular_packages_router_router_l)),directiveDef(1,49152,null,0,ɵEmptyOutletComponent,[],null,null)],null,null)}var ɵangular_packages_router_router_lNgFactory=createComponentFactory("ng-component",ɵEmptyOutletComponent,View_ɵangular_packages_router_router_l_Host_0,{},{},[]);function __decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function __metadata(metadataKey,metadataValue){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)}let instances="ej2_instances",ej2_base_es2015_uid=0;function createInstance(classFunction,params){let arrayParam=params;return arrayParam.unshift(void 0),new(Function.prototype.bind.apply(classFunction,arrayParam))}function getValue(nameSpace,obj){let value=obj,splits=nameSpace.replace(/\[/g,".").replace(/\]/g,"").split(".");for(let i=0;i<splits.length&&!isUndefined(value);i++)value=value[splits[i]];return value}function setValue(nameSpace,value,obj){let i,key,keys=nameSpace.replace(/\[/g,".").replace(/\]/g,"").split("."),start=obj||{},fromObj=start,length=keys.length;for(i=0;i<length;i++)key=keys[i],i+1===length?fromObj[key]=void 0===value?{}:value:isNullOrUndefined(fromObj[key])&&(fromObj[key]={}),fromObj=fromObj[key];return start}function deleteObject(obj,key){delete obj[key]}function ej2_base_es2015_isObject(obj){return!isNullOrUndefined(obj)&&obj.constructor==={}.constructor}function getEnumValue(enumObject,enumValue){return enumObject[enumValue]}function ej2_base_es2015_merge(source,destination){if(!isNullOrUndefined(destination)){let temrObj=source,tempProp=destination,keys=Object.keys(destination),deepmerge="deepMerge";for(let key of keys)isNullOrUndefined(temrObj[deepmerge])||-1===temrObj[deepmerge].indexOf(key)||!ej2_base_es2015_isObject(tempProp[key])&&!Array.isArray(tempProp[key])?temrObj[key]=tempProp[key]:extend(temrObj[key],temrObj[key],tempProp[key],!0)}}function extend(copied,first,second,deep){let result=copied||{},length=arguments.length;deep&&(length-=1);for(let i=1;i<length;i++){if(!arguments[i])continue;let obj1=arguments[i];Object.keys(obj1).forEach(key=>{let clone,src=result[key],copy=obj1[key];result[key]=deep&&(ej2_base_es2015_isObject(copy)||Array.isArray(copy))?ej2_base_es2015_isObject(copy)?extend({},clone=src||{},copy,deep):extend([],clone=src||[],copy,deep):copy})}return result}function isNullOrUndefined(value){return null==value}function isUndefined(value){return void 0===value}function getUniqueID(definedName){return definedName+"_"+ej2_base_es2015_uid++}function debounce(eventFunction,delay){let out;return function(){let args=arguments,later=()=>(out=null,eventFunction.apply(this,args));clearTimeout(out),out=setTimeout(later,delay)}}function compareElementParent(child,parent){return child===parent||!(child===document||!child)&&compareElementParent(child.parentNode,parent)}function ej2_base_es2015_throwError(message){try{throw new Error(message)}catch(e){throw e.message+"\n"+e.stack}}function print(element,printWindow){let div=document.createElement("div"),links=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("link, style")),reference="";isNullOrUndefined(printWindow)&&(printWindow=window.open("","print","height=452,width=1024,tabbar=no")),div.appendChild(element.cloneNode(!0));for(let i=0,len=links.length;i<len;i++)reference+=links[i].outerHTML;printWindow.document.write("<!DOCTYPE html> <html><head>"+reference+"</head><body>"+div.innerHTML+"<script> (function() { window.ready = true; })(); <\/script></body></html>"),printWindow.document.close(),printWindow.focus();let interval=setInterval(()=>{printWindow.ready&&(printWindow.print(),printWindow.close(),clearInterval(interval))},500);return printWindow}function formatUnit(value){let result=value+"";return"auto"===result||-1!==result.indexOf("%")||-1!==result.indexOf("px")?result:result+"px"}function isBlazor(){return window&&Object.keys(window).indexOf("Blazor")>=0}function getElement(element){return element instanceof Node||!isBlazor()||isNullOrUndefined(element.xPath)?element:document.evaluate(element.xPath,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}function getInstance(element,component){let elem="string"==typeof element?document.querySelector(element):element;if(elem[instances])for(let inst of elem[instances])if(inst instanceof component)return inst;return null}const headerRegex=/^(.*?):[ \t]*([^\r\n]*)$/gm,defaultType="GET";class Ajax{constructor(options,type,async,contentType){this.mode=!0,this.emitError=!0,this.options={},"string"==typeof options?(this.url=options,this.type=type?type.toUpperCase():defaultType,this.mode=!!isNullOrUndefined(async)||async):"object"==typeof options&&(this.options=options,ej2_base_es2015_merge(this,this.options)),this.type=this.type?this.type.toUpperCase():defaultType,this.contentType=void 0!==this.contentType?this.contentType:contentType}send(data){this.data=isNullOrUndefined(data)?this.data:data;let eventArgs={cancel:!1,httpRequest:null};return new Promise((resolve,reject)=>{this.httpRequest=new XMLHttpRequest,this.httpRequest.onreadystatechange=()=>{this.stateChange(resolve,reject)},isNullOrUndefined(this.onLoad)||(this.httpRequest.onload=this.onLoad),isNullOrUndefined(this.onProgress)||(this.httpRequest.onprogress=this.onProgress),isNullOrUndefined(this.onAbort)||(this.httpRequest.onabort=this.onAbort),isNullOrUndefined(this.onError)||(this.httpRequest.onerror=this.onError),isNullOrUndefined(this.onUploadProgress)||(this.httpRequest.upload.onprogress=this.onUploadProgress),this.httpRequest.open(this.type,this.url,this.mode),isNullOrUndefined(this.data)||null===this.contentType||this.httpRequest.setRequestHeader("Content-Type",this.contentType||"application/json; charset=utf-8"),this.beforeSend&&(eventArgs.httpRequest=this.httpRequest,this.beforeSend(eventArgs)),eventArgs.cancel||this.httpRequest.send(isNullOrUndefined(this.data)?null:this.data)})}successHandler(data){return this.onSuccess&&this.onSuccess(data,this),data}failureHandler(reason){return this.onFailure&&this.onFailure(this.httpRequest),reason}stateChange(resolve,reject){let data=this.httpRequest.responseText;if(this.dataType&&"json"===this.dataType.toLowerCase())if(""===data)data=void 0;else try{data=JSON.parse(data)}catch(error){}4===this.httpRequest.readyState&&(this.httpRequest.status>=200&&this.httpRequest.status<=299||304===this.httpRequest.status?resolve(this.successHandler(data)):this.emitError?reject(new Error(this.failureHandler(this.httpRequest.statusText))):resolve())}getResponseHeader(key){let responseHeaders,header;responseHeaders={};let headers=headerRegex.exec(this.httpRequest.getAllResponseHeaders());for(;headers;)responseHeaders[headers[1].toLowerCase()]=headers[2],headers=headerRegex.exec(this.httpRequest.getAllResponseHeaders());return isNullOrUndefined(header=responseHeaders[key.toLowerCase()])?null:header}}class EventHandler{static addOrGetEventData(element){return"__eventList"in element?element.__eventList.events:(element.__eventList={},element.__eventList.events=[])}static add(element,eventName,listener,bindTo,intDebounce){let debounceListener,eventData=EventHandler.addOrGetEventData(element);debounceListener=intDebounce?debounce(listener,intDebounce):listener,bindTo&&(debounceListener=debounceListener.bind(bindTo));let event=eventName.split(" ");for(let i=0;i<event.length;i++)eventData.push({name:event[i],listener:listener,debounce:debounceListener}),element.addEventListener(event[i],debounceListener);return debounceListener}static remove(element,eventName,listener){let eventData=EventHandler.addOrGetEventData(element),event=eventName.split(" ");for(let j=0;j<event.length;j++){let debounceListener,index=-1;eventData&&0!==eventData.length&&eventData.some((x,i)=>x.name===event[j]&&x.listener===listener&&(index=i,debounceListener=x.debounce,!0)),-1!==index&&eventData.splice(index,1),debounceListener&&element.removeEventListener(event[j],debounceListener)}}static clearEvents(element){let eventData,copyData;copyData=extend([],copyData,eventData=EventHandler.addOrGetEventData(element));for(let i=0;i<copyData.length;i++)element.removeEventListener(copyData[i].name,copyData[i].debounce),eventData.shift()}static trigger(element,eventName,eventProp){let eventData=EventHandler.addOrGetEventData(element);for(let event of eventData)event.name===eventName&&event.debounce.call(this,eventProp)}}const SVG_REG=/^svg|^path|^g/;function ej2_base_es2015_createElement(tagName,properties){let element=SVG_REG.test(tagName)?document.createElementNS("http://www.w3.org/2000/svg",tagName):document.createElement(tagName);return void 0===properties?element:(element.innerHTML=properties.innerHTML?properties.innerHTML:"",void 0!==properties.className&&(element.className=properties.className),void 0!==properties.id&&(element.id=properties.id),void 0!==properties.styles&&element.setAttribute("style",properties.styles),void 0!==properties.attrs&&attributes(element,properties.attrs),element)}function addClass(elements,classes){let classList=getClassList(classes);for(let ele of elements)for(let className of classList)ele.classList.contains(className)||ele.classList.add(className);return elements}function removeClass(elements,classes){let classList=getClassList(classes);for(let ele of elements)if(""!==ele.className)for(let className of classList)ele.classList.remove(className);return elements}function getClassList(classes){let classList=[];return"string"==typeof classes?classList.push(classes):classList=classes,classList}function isVisible(element){return""===element.style.visibility&&element.offsetWidth>0}function prepend(fromElements,toElement,isEval){let docFrag=document.createDocumentFragment();for(let ele of fromElements)docFrag.appendChild(ele);return toElement.insertBefore(docFrag,toElement.firstElementChild),isEval&&executeScript(toElement),fromElements}function append(fromElements,toElement,isEval){let docFrag=document.createDocumentFragment();for(let ele of fromElements)docFrag.appendChild(ele);return toElement.appendChild(docFrag),isEval&&executeScript(toElement),fromElements}function executeScript(ele){ele.querySelectorAll("script").forEach(element=>{let script=document.createElement("script");script.text=element.innerHTML,document.head.appendChild(script),detach(script)})}function detach(element){return element.parentNode.removeChild(element)}function ej2_base_es2015_remove(element){let parentNode=element.parentNode;EventHandler.clearEvents(element),parentNode.removeChild(element)}function attributes(element,attributes){let keys=Object.keys(attributes),ele=element;for(let key of keys)ele.setAttribute(key,attributes[key]);return ele}function ej2_base_es2015_select(selector,context=document){return context.querySelector(selector)}function ej2_base_es2015_selectAll(selector,context=document){return context.querySelectorAll(selector)}function closest(element,selector){let el=element;if("function"==typeof el.closest)return el.closest(selector);for(;el&&1===el.nodeType;){if(matches(el,selector))return el;el=el.parentNode}return null}function setStyleAttribute(element,attrs){void 0!==attrs&&Object.keys(attrs).forEach(key=>{element.style[key]=attrs[key]})}function ej2_base_es2015_classList(element,addClasses,removeClasses){addClass([element],addClasses),removeClass([element],removeClasses)}function matches(element,selector){let matches=element.matches||element.msMatchesSelector||element.webkitMatchesSelector;return matches?matches.call(element,selector):-1!==[].indexOf.call(document.querySelectorAll(selector),element)}class Observer{constructor(context){this.ranArray=[],this.boundedEvents={},isNullOrUndefined(context)||(this.context=context)}on(property,handler,context,id){if(isNullOrUndefined(handler))return;let cntxt=context||this.context;this.notExist(property)?this.boundedEvents[property]=[{handler:handler,context:cntxt}]:isNullOrUndefined(id)?this.isHandlerPresent(this.boundedEvents[property],handler)||this.boundedEvents[property].push({handler:handler,context:cntxt}):-1===this.ranArray.indexOf(id)&&(this.ranArray.push(id),this.boundedEvents[property].push({handler:handler,context:cntxt,id:id}))}off(property,handler,id){if(this.notExist(property))return;let curObject=getValue(property,this.boundedEvents);if(handler){for(let i=0;i<curObject.length;i++)if(id){if(curObject[i].id===id){curObject.splice(i,1);let indexLocation=this.ranArray.indexOf(id);-1!==indexLocation&&this.ranArray.splice(indexLocation,1);break}}else if(handler===curObject[i].handler){curObject.splice(i,1);break}}else delete this.boundedEvents[property]}notify(property,argument,successHandler,errorHandler){if(this.notExist(property))return void(successHandler&&successHandler.call(this,argument));argument&&(argument.name=property);let curObject=getValue(property,this.boundedEvents).slice(0);if(window.Blazor)return this.blazorCallback(curObject,argument,successHandler,errorHandler,0);for(let cur of curObject)cur.handler.call(cur.context,argument);successHandler&&successHandler.call(this,argument)}blazorCallback(objs,argument,successHandler,errorHandler,index){let isTrigger=index===objs.length-1;if(index<objs.length){let obj=objs[index],promise=obj.handler.call(obj.context,argument);if(promise&&"function"==typeof promise.then){if(!successHandler)return promise;promise.then(data=>{if(data="string"==typeof data&&this.isJson(data)?JSON.parse(data):data,extend(argument,argument,data,!0),!successHandler||!isTrigger)return this.blazorCallback(objs,argument,successHandler,errorHandler,index+1);successHandler.call(obj.context,argument)}).catch(data=>{errorHandler&&errorHandler.call(obj.context,"string"==typeof data&&this.isJson(data)?JSON.parse(data):data)})}else{if(!successHandler||!isTrigger)return this.blazorCallback(objs,argument,successHandler,errorHandler,index+1);successHandler.call(obj.context,argument)}}}isJson(value){try{JSON.parse(value)}catch(e){return!1}return!0}destroy(){this.boundedEvents=this.context=void 0}notExist(prop){return!1===this.boundedEvents.hasOwnProperty(prop)||this.boundedEvents[prop].length<=0}isHandlerPresent(boundedEvents,handler){for(let cur of boundedEvents)if(cur.handler===handler)return!0;return!1}}const isColEName=new RegExp("]");class Base{constructor(options,element){this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.refreshing=!1,this.finalUpdate=()=>{},this.childChangedProperties={},this.modelObserver=new Observer(this),isUndefined(element)||(this.element="string"==typeof element?document.querySelector(element):element,isNullOrUndefined(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),isUndefined(options)||this.setProperties(options,!0),this.isDestroyed=!1}setProperties(prop,muteOnChange){let prevDetection=this.isProtectedOnChange;this.isProtectedOnChange=!!muteOnChange,ej2_base_es2015_merge(this,prop),!0!==muteOnChange&&(ej2_base_es2015_merge(this.changedProperties,prop),this.dataBind()),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=prevDetection}static callChildDataBind(obj,parent){let keys=Object.keys(obj);for(let key of keys)if(parent[key]instanceof Array)for(let obj of parent[key])void 0!==obj.dataBind&&obj.dataBind();else parent[key].dataBind()}clearChanges(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}}dataBind(){if(Base.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){let prevDetection=this.isProtectedOnChange,newChanges=this.changedProperties,oldChanges=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(newChanges,oldChanges),this.isProtectedOnChange=prevDetection}}saveChanges(key,newValue,oldValue){this.isProtectedOnChange||(this.oldProperties[key]=oldValue,this.changedProperties[key]=newValue,this.finalUpdate(),this.finalUpdate=function(handler){let unbind,num=new Uint16Array(5);(window.msCrypto||window.crypto).getRandomValues(num);let secret="ej2"+function(num){let ret="";for(let i=0;i<5;i++)ret+=(i?",":"")+num[i];return ret}(num),messageHandler=event=>{event.source===window&&"string"==typeof event.data&&event.data.length<=32&&event.data===secret&&(handler(),unbind())};return window.addEventListener("message",messageHandler,!1),window.postMessage(secret,"*"),unbind=()=>{window.removeEventListener("message",messageHandler),handler=messageHandler=secret=void 0}}(this.dataBind.bind(this)))}addEventListener(eventName,handler){this.modelObserver.on(eventName,handler)}removeEventListener(eventName,handler){this.modelObserver.off(eventName,handler)}trigger(eventName,eventProp,successHandler,errorHandler){if(!0!==this.isDestroyed){let prevDetection=this.isProtectedOnChange;this.isProtectedOnChange=!1;let data=this.modelObserver.notify(eventName,eventProp,successHandler,errorHandler);if(isColEName.test(eventName)){let handler=getValue(eventName,this);if(handler)if(window.Blazor){let promise=handler.call(this,eventProp);promise&&"function"==typeof promise.then?successHandler?promise.then(data=>{successHandler&&(data="string"==typeof data&&this.modelObserver.isJson(data)?JSON.parse(data):data,successHandler.call(this,data))}).catch(data=>{errorHandler&&(data="string"==typeof data&&this.modelObserver.isJson(data)?JSON.parse(data):data,errorHandler.call(this,data))}):data=promise:successHandler&&successHandler.call(this,eventProp)}else handler.call(this,eventProp),successHandler&&successHandler.call(this,eventProp);else successHandler&&successHandler.call(this,eventProp)}return this.isProtectedOnChange=prevDetection,data}}addInstance(){let moduleClass="e-"+this.getModuleName().toLowerCase();addClass([this.element],["e-lib",moduleClass]),isNullOrUndefined(this.element.ej2_instances)?setValue("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)}destroy(){this.element.ej2_instances=this.element.ej2_instances.filter(i=>i!==this),removeClass([this.element],["e-"+this.getModuleName()]),0===this.element.ej2_instances.length&&removeClass([this.element],["e-lib"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0}}const REGX_MOBILE=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,REGX_IE=/msie|trident/i,REGX_IE11=/Trident\/7\./,REGX_IOS=/(ipad|iphone|ipod touch)/i,REGX_IOS7=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,REGX_ANDROID=/android/i,REGX_WINDOWS=/trident|windows phone|edge/i,REGX_VERSION=/(version)[ \/]([\w.]+)/i,REGX_BROWSER={OPERA:/(opera|opr)(?:.*version|)[ \/]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ \/]([\w.]+)/i,CHROME:/(chrome|crios)[ \/]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ \/]([\w.]+)/i,SAFARI:/(safari)[ \/]([\w.]+)/i,WEBKIT:/(webkit)[ \/]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};"undefined"!=typeof window&&(window.browserDetails=window.browserDetails||{});let Browser=(()=>{class Browser{static extractBrowserDetail(){let browserInfo={culture:{}},keys=Object.keys(REGX_BROWSER),clientInfo=[];for(let key of keys)if(clientInfo=Browser.userAgent.match(REGX_BROWSER[key])){if(browserInfo.name="opr"===clientInfo[1].toLowerCase()?"opera":clientInfo[1].toLowerCase(),browserInfo.name="crios"===clientInfo[1].toLowerCase()?"chrome":browserInfo.name,browserInfo.version=clientInfo[2],browserInfo.culture.name=browserInfo.culture.language=navigator.language,Browser.userAgent.match(REGX_IE11)){browserInfo.name="msie";break}let version=Browser.userAgent.match(REGX_VERSION);"safari"===browserInfo.name&&version&&(browserInfo.version=version[2]);break}return browserInfo}static getEvent(event){let events={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return Browser.isPointer?events[event].isPointer:Browser.isTouch?events[event].isTouch+(Browser.isDevice?"":" "+events[event].isDevice):events[event].isDevice}static getTouchStartEvent(){return Browser.getEvent("start")}static getTouchEndEvent(){return Browser.getEvent("end")}static getTouchMoveEvent(){return Browser.getEvent("move")}static getTouchCancelEvent(){return Browser.getEvent("cancel")}static getValue(key,regX){let browserDetails=window.browserDetails;return void 0===browserDetails[key]?browserDetails[key]=regX.test(Browser.userAgent):browserDetails[key]}static set userAgent(uA){Browser.uA=uA,window.browserDetails={}}static get userAgent(){return Browser.uA}static get info(){return isUndefined(window.browserDetails.info)?window.browserDetails.info=Browser.extractBrowserDetail():window.browserDetails.info}static get isIE(){return Browser.getValue("isIE",REGX_IE)}static get isTouch(){return isUndefined(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window:window.browserDetails.isTouch}static get isPointer(){return isUndefined(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer}static get isMSPointer(){return isUndefined(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer}static get isDevice(){return Browser.getValue("isDevice",REGX_MOBILE)}static get isIos(){return Browser.getValue("isIos",REGX_IOS)}static get isIos7(){return Browser.getValue("isIos7",REGX_IOS7)}static get isAndroid(){return Browser.getValue("isAndroid",REGX_ANDROID)}static get isWebView(){return isUndefined(window.browserDetails.isWebView)?(window.browserDetails.isWebView=!(isUndefined(window.cordova)&&isUndefined(window.PhoneGap)&&isUndefined(window.phonegap)&&"object"!==window.forge),window.browserDetails.isWebView):window.browserDetails.isWebView}static get isWindows(){return Browser.getValue("isWindows",REGX_WINDOWS)}static get touchStartEvent(){return isUndefined(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=Browser.getTouchStartEvent():window.browserDetails.touchStartEvent}static get touchMoveEvent(){return isUndefined(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=Browser.getTouchMoveEvent():window.browserDetails.touchMoveEvent}static get touchEndEvent(){return isUndefined(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=Browser.getTouchEndEvent():window.browserDetails.touchEndEvent}static get touchCancelEvent(){return isUndefined(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=Browser.getTouchCancelEvent():window.browserDetails.touchCancelEvent}}return Browser.uA="undefined"!=typeof navigator?navigator.userAgent:"",Browser})();function getObject(instance,curKey,defaultValue,type){return instance.properties.hasOwnProperty(curKey)&&instance.properties[curKey]instanceof type||(instance.properties[curKey]=createInstance(type,[instance,curKey,defaultValue])),instance.properties[curKey]}function getObjectArray(instance,curKey,defaultValue,type,isSetter,isFactory){let result=[],len=defaultValue?defaultValue.length:0;for(let i=0;i<len;i++){let curType=type;if(isFactory&&(curType=type(defaultValue[i],instance)),isSetter){let inst=createInstance(curType,[instance,curKey,{},!0]);inst.setProperties(defaultValue[i],!0),result.push(inst)}else result.push(createInstance(curType,[instance,curKey,defaultValue[i],!0]))}return result}function propertyGetter(defaultValue,curKey){return function(){return this.properties.hasOwnProperty(curKey)||(this.properties[curKey]=defaultValue),this.properties[curKey]}}function propertySetter(defaultValue,curKey){return function(newValue){if(this.properties[curKey]!==newValue){let oldVal=this.properties.hasOwnProperty(curKey)?this.properties[curKey]:defaultValue;this.saveChanges(curKey,newValue,oldVal),this.properties[curKey]=newValue}}}function complexGetter(defaultValue,curKey,type){return function(){return getObject(this,curKey,defaultValue,type)}}function complexSetter(defaultValue,curKey,type){return function(newValue){getObject(this,curKey,defaultValue,type).setProperties(newValue)}}function complexArrayGetter(defaultValue,curKey,type){return function(){if(!this.properties.hasOwnProperty(curKey)){let defCollection=getObjectArray(this,curKey,defaultValue,type,!1);this.properties[curKey]=defCollection}return this.properties[curKey]}}function complexArraySetter(defaultValue,curKey,type){return function(newValue){let oldValueCollection=getObjectArray(this,curKey,defaultValue,type,!1),newValCollection=getObjectArray(this,curKey,newValue,type,!0);this.saveChanges(curKey,newValCollection,oldValueCollection),this.properties[curKey]=newValCollection}}function Property(defaultValue){return(target,key)=>{let propertyDescriptor={set:propertySetter(defaultValue,key),get:propertyGetter(defaultValue,key),enumerable:!0,configurable:!0};Object.defineProperty(target,key,propertyDescriptor),addPropertyCollection(target,key,"prop",defaultValue)}}function Complex(defaultValue,type){return(target,key)=>{let propertyDescriptor={set:complexSetter(defaultValue,key,type),get:complexGetter(defaultValue,key,type),enumerable:!0,configurable:!0};Object.defineProperty(target,key,propertyDescriptor),addPropertyCollection(target,key,"complexProp",defaultValue,type)}}function Collection(defaultValue,type){return(target,key)=>{let propertyDescriptor={set:complexArraySetter(defaultValue,key,type),get:complexArrayGetter(defaultValue,key,type),enumerable:!0,configurable:!0};Object.defineProperty(target,key,propertyDescriptor),addPropertyCollection(target,key,"colProp",defaultValue,type)}}function ej2_base_es2015_Event(){return(target,key)=>{let eventDescriptor={set:function(newValue){let oldValue=this.properties[key];if(oldValue!==newValue){let finalContext=function getParentContext(context,prefix){if(!1===context.hasOwnProperty("parentObj"))return{context:context,prefix:prefix};{let curText=getValue("propName",context);return curText&&(prefix=curText+"-"+prefix),getParentContext(getValue("parentObj",context),prefix)}}(this,key);!1===isUndefined(oldValue)&&finalContext.context.removeEventListener(finalContext.prefix,oldValue),finalContext.context.addEventListener(finalContext.prefix,newValue),this.properties[key]=newValue}},get:propertyGetter(void 0,key),enumerable:!0,configurable:!0};Object.defineProperty(target,key,eventDescriptor),addPropertyCollection(target,key,"event")}}function NotifyPropertyChanges(classConstructor){}function addPropertyCollection(target,key,propertyType,defaultValue,type){isUndefined(target.propList)&&(target.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),target.propList[propertyType+"s"].push({propertyName:key,defaultValue:defaultValue,type:type}),target.propList[propertyType+"Names"].push(key)}var Animation_1;let ej2_base_es2015_Animation=(()=>{let Animation=Animation_1=class extends Base{constructor(options){super(options,void 0),this.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"}}animate(element,options){let model=this.getModel(options=options||{});if("string"==typeof element){let elements=Array.prototype.slice.call(ej2_base_es2015_selectAll(element,document));for(let element of elements)model.element=element,Animation_1.delayAnimation(model)}else model.element=element,Animation_1.delayAnimation(model)}static stop(element,model){element.style.animation="",element.removeAttribute("e-animate");let animationId=element.getAttribute("e-animation-id");if(animationId){let frameId=parseInt(animationId,10);cancelAnimationFrame(frameId),element.removeAttribute("e-animation-id")}model&&model.end&&model.end.call(this,model)}static delayAnimation(model){model.delay?setTimeout(()=>{Animation_1.applyAnimation(model)},model.delay):Animation_1.applyAnimation(model)}static applyAnimation(model){model.timeStamp=0;let step=0,timerId=0,startTime=0,prevTimeStamp=0,duration=model.duration;model.element.setAttribute("e-animate","true");let startAnimation=timeStamp=>{try{if(timeStamp){model.timeStamp=timeStamp+model.timeStamp-(prevTimeStamp=0===prevTimeStamp?timeStamp:prevTimeStamp),prevTimeStamp=timeStamp,!step&&model.begin&&model.begin.call(this,model);let avg=model.timeStamp/(step+=1);model.timeStamp<duration&&model.timeStamp+avg<duration&&model.element.getAttribute("e-animate")?(model.element.style.animation=model.name+" "+model.duration+"ms "+model.timingFunction,model.progress&&model.progress.call(this,model),requestAnimationFrame(startAnimation)):(cancelAnimationFrame(timerId),model.element.removeAttribute("e-animation-id"),model.element.removeAttribute("e-animate"),model.element.style.animation="",model.end&&model.end.call(this,model))}else startTime=performance.now(),timerId=requestAnimationFrame(startAnimation),model.element.setAttribute("e-animation-id",timerId.toString())}catch(e){cancelAnimationFrame(timerId),model.element.removeAttribute("e-animation-id"),model.fail&&model.fail.call(this,e)}};startAnimation()}getModel(options){return{name:options.name||this.name,delay:options.delay||this.delay,duration:void 0!==options.duration?options.duration:this.duration,begin:options.begin||this.begin,end:options.end||this.end,fail:options.fail||this.fail,progress:options.progress||this.progress,timingFunction:this.easing[options.timingFunction]?this.easing[options.timingFunction]:options.timingFunction||this.easing[this.timingFunction]}}onPropertyChanged(newProp,oldProp){}getModuleName(){return"animation"}destroy(){}};return __decorate([Property("FadeIn")],Animation.prototype,"name",void 0),__decorate([Property(400)],Animation.prototype,"duration",void 0),__decorate([Property("ease")],Animation.prototype,"timingFunction",void 0),__decorate([Property(0)],Animation.prototype,"delay",void 0),__decorate([ej2_base_es2015_Event()],Animation.prototype,"progress",void 0),__decorate([ej2_base_es2015_Event()],Animation.prototype,"begin",void 0),__decorate([ej2_base_es2015_Event()],Animation.prototype,"end",void 0),__decorate([ej2_base_es2015_Event()],Animation.prototype,"fail",void 0),Animation_1=__decorate([NotifyPropertyChanges],Animation)})();function rippleEffect(element,rippleOptions,done){let rippleModel=function(rippleOptions){return{selector:rippleOptions&&rippleOptions.selector?rippleOptions.selector:null,ignore:rippleOptions&&rippleOptions.ignore?rippleOptions.ignore:null,rippleFlag:rippleOptions&&rippleOptions.rippleFlag,isCenterRipple:rippleOptions&&rippleOptions.isCenterRipple,duration:rippleOptions&&rippleOptions.duration?rippleOptions.duration:350}}(rippleOptions);return!1===rippleModel.rippleFlag||void 0===rippleModel.rippleFlag&&!isRippleEnabled?Function:(element.setAttribute("data-ripple","true"),EventHandler.add(element,"mousedown",rippleHandler,{parent:element,rippleOptions:rippleModel}),EventHandler.add(element,"mouseup",rippleUpHandler,{parent:element,rippleOptions:rippleModel,done:done}),EventHandler.add(element,"mouseleave",rippleLeaveHandler,{parent:element,rippleOptions:rippleModel}),Browser.isPointer&&EventHandler.add(element,"transitionend",rippleLeaveHandler,{parent:element,rippleOptions:rippleModel}),()=>{element.removeAttribute("data-ripple"),EventHandler.remove(element,"mousedown",rippleHandler),EventHandler.remove(element,"mouseup",rippleUpHandler),EventHandler.remove(element,"mouseleave",rippleLeaveHandler),EventHandler.remove(element,"transitionend",rippleLeaveHandler)})}function rippleHandler(e){let target=e.target,selector=this.rippleOptions.selector,element=selector?closest(target,selector):target;if(!element||this.rippleOptions&&closest(target,this.rippleOptions.ignore))return;let offset=element.getBoundingClientRect(),offsetX=e.pageX-document.body.scrollLeft,offsetY=e.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),pageX=Math.max(Math.abs(offsetX-offset.left),Math.abs(offsetX-offset.right)),pageY=Math.max(Math.abs(offsetY-offset.top),Math.abs(offsetY-offset.bottom)),radius=Math.sqrt(pageX*pageX+pageY*pageY),diameter=2*radius+"px",x=offsetX-offset.left-radius,y=offsetY-offset.top-radius;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(x=0,y=0,diameter="100%"),element.classList.add("e-ripple");let rippleElement=ej2_base_es2015_createElement("div",{className:"e-ripple-element",styles:"width: "+diameter+";height: "+diameter+";left: "+x+"px;top: "+y+"px;transition-duration: "+this.rippleOptions.duration.toString()+"ms;"});element.appendChild(rippleElement),window.getComputedStyle(rippleElement).getPropertyValue("opacity"),rippleElement.style.transform="scale(1)",element!==this.parent&&EventHandler.add(element,"mouseleave",rippleLeaveHandler,{parent:this.parent,rippleOptions:this.rippleOptions})}function rippleUpHandler(e){removeRipple(e,this)}function rippleLeaveHandler(e){removeRipple(e,this)}function removeRipple(e,eventArgs){let duration=eventArgs.rippleOptions.duration,target=e.target,selector=eventArgs.rippleOptions.selector,element=selector?closest(target,selector):target;if(!element||element&&-1===element.className.indexOf("e-ripple"))return;let rippleElements=ej2_base_es2015_selectAll(".e-ripple-element",element),rippleElement=rippleElements[rippleElements.length-1];rippleElement&&(rippleElement.style.opacity="0.5"),eventArgs.parent!==element&&EventHandler.remove(element,"mouseleave",rippleLeaveHandler),setTimeout(()=>{rippleElement&&rippleElement.parentNode&&rippleElement.parentNode.removeChild(rippleElement),element.getElementsByClassName("e-ripple-element").length||element.classList.remove("e-ripple"),eventArgs.done&&eventArgs.done(e)},duration)}let isRippleEnabled=!1;const MODULE_SUFFIX="Module";class ModuleLoader{constructor(parent){this.loadedModules=[],this.parent=parent}inject(requiredModules,moduleList){let reqLength=requiredModules.length;if(0!==reqLength){this.loadedModules.length&&this.clearUnusedModule(requiredModules);for(let i=0;i<reqLength;i++){let modl=requiredModules[i];for(let module of moduleList){let modName=modl.member;if(module.prototype.getModuleName()===modl.member&&!this.isModuleLoaded(modName)){let moduleObject=createInstance(module,modl.args),memberName=this.getMemberName(modName);setValue(memberName,modl.isProperty?module:moduleObject,this.parent);let loadedModule=modl;loadedModule.member=memberName,this.loadedModules.push(loadedModule)}}}}else this.clean()}clean(){for(let modules of this.loadedModules)modules.isProperty||getValue(modules.member,this.parent).destroy();this.loadedModules=[]}clearUnusedModule(moduleList){let usedModules=moduleList.map(arg=>this.getMemberName(arg.member)),removableModule=this.loadedModules.filter(module=>-1===usedModules.indexOf(module.member));for(let mod of removableModule)mod.isProperty||getValue(mod.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(mod),1),deleteObject(this.parent,mod.member)}getMemberName(name){return name[0].toLowerCase()+name.substring(1)+MODULE_SUFFIX}isModuleLoaded(modName){for(let mod of this.loadedModules)if(mod.member===this.getMemberName(modName))return!0;return!1}}class ChildProperty{constructor(parent,propName,defaultValue,isArray){this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=()=>{},this.callChildDataBind=getValue("callChildDataBind",Base),this.parentObj=parent,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=propName,this.setProperties(defaultValue,!0),this.isParentArray=isArray}updateChange(val,propName){!0===val?this.parentObj.childChangedProperties[propName]=val:delete this.parentObj.childChangedProperties[propName],this.parentObj.updateChange&&this.parentObj.updateChange(val,this.parentObj.propName)}updateTimeOut(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{let changeTime=setTimeout(this.parentObj.dataBind.bind(this.parentObj));this.finalUpdate=()=>{clearTimeout(changeTime)}}}clearChanges(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}}setProperties(prop,muteOnChange){!0===muteOnChange?(ej2_base_es2015_merge(this,prop),this.updateChange(!1,this.propName),this.clearChanges()):ej2_base_es2015_merge(this,prop)}dataBind(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){let curIndex=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(setValue(this.propName+"."+curIndex,this.changedProperties,this.parentObj.changedProperties),setValue(this.propName+"."+curIndex,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()}saveChanges(key,newValue,oldValue){if(this.controlParent.isRendered&&isBlazor()){let ejsInterop="ejsInterop";window&&window[ejsInterop]&&window[ejsInterop].childSaveChanges.call(this,key,newValue,oldValue)}this.controlParent.isProtectedOnChange||(this.oldProperties[key]=oldValue,this.changedProperties[key]=newValue,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())}}const defaultNumberingSystem={latn:{_digits:"0123456789",_type:"numeric"}},defaultNumberSymbols={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"∞",nan:"NaN",exponential:"E"},latnNumberSystem=[0,1,2,3,4,5,6,7,8,9];let ParserBase=(()=>{class ParserBase{static getMainObject(obj,cName){return getValue("main."+cName,obj)}static getNumberingSystem(obj){return getValue("supplemental.numberingSystems",obj)||this.numberingSystems}static reverseObject(prop,keys){let propKeys=keys||Object.keys(prop),res={};for(let key of propKeys)res.hasOwnProperty(prop[key])||(res[prop[key]]=key);return res}static getSymbolRegex(props){let regexStr=props.map(str=>str.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")).join("|");return new RegExp(regexStr,"g")}static getSymbolMatch(prop){let matchKeys=Object.keys(defaultNumberSymbols),ret={};for(let key of matchKeys)ret[prop[key]]=defaultNumberSymbols[key];return ret}static constructRegex(val){let len=val.length,ret="";for(let i=0;i<len;i++)ret+=i!==len-1?val[i]+"|":val[i];return ret}static convertValueParts(value,regex,obj){return value.replace(regex,str=>obj[str])}static getDefaultNumberingSystem(obj){let ret={};return ret.obj=getValue("numbers",obj),ret.nSystem=getValue("defaultNumberingSystem",ret.obj),ret}static getCurrentNumericOptions(curObj,numberSystem,needSymbols){let ret={},cur=this.getDefaultNumberingSystem(curObj);if(!isUndefined(cur.nSystem)){let digits=getValue(cur.nSystem+"._digits",numberSystem);isUndefined(digits)||(ret.numericPair=this.reverseObject(digits,latnNumberSystem),ret.numberParseRegex=new RegExp(this.constructRegex(digits),"g"),ret.numericRegex="["+digits[0]+"-"+digits[9]+"]",needSymbols&&(ret.numericRegex=digits[0]+"-"+digits[9],ret.symbolNumberSystem=getValue("symbols-numberSystem-"+cur.nSystem,cur.obj),ret.symbolMatch=this.getSymbolMatch(ret.symbolNumberSystem),ret.numberSystem=cur.nSystem))}return ret}static getNumberMapper(curObj,numberSystem,isNumber){let ret={mapper:{}},cur=this.getDefaultNumberingSystem(curObj);if(!isUndefined(cur.nSystem)){ret.numberSystem=cur.nSystem,ret.numberSymbols=getValue("symbols-numberSystem-"+cur.nSystem,cur.obj),ret.timeSeparator=getValue("timeSeparator",ret.numberSymbols);let digits=getValue(cur.nSystem+"._digits",numberSystem);if(!isUndefined(digits))for(let i of latnNumberSystem)ret.mapper[i]=digits[i]}return ret}}return ParserBase.nPair="numericPair",ParserBase.nRegex="numericRegex",ParserBase.numberingSystems=defaultNumberingSystem,ParserBase})();const errorText={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},percentSign="percentSign",minusSign="minusSign",mapper$1=["infinity","nan","group","decimal","exponential"];class NumberFormat{static numberFormatter(culture,option,cldr){let symbolPattern,fOptions=extend({},option),cOptions={},dOptions={},dependable=IntlBase.getDependables(cldr,culture,"",!0);dOptions.numberMapper=ParserBase.getNumberMapper(dependable.parserObject,ParserBase.getNumberingSystem(cldr),!0),dOptions.currencySymbol=IntlBase.getCurrencySymbol(dependable.numericObject,fOptions.currency||defaultCurrencyCode),dOptions.percentSymbol=dOptions.numberMapper.numberSymbols[percentSign],dOptions.minusSymbol=dOptions.numberMapper.numberSymbols[minusSign];let symbols=dOptions.numberMapper.numberSymbols;if(option.format&&!IntlBase.formatRegex.test(option.format))cOptions=IntlBase.customFormat(option.format,dOptions,dependable.numericObject);else{extend(fOptions,IntlBase.getProperNumericSkeleton(option.format||"N")),fOptions.isCurrency="currency"===fOptions.type,fOptions.isPercent="percent"===fOptions.type,symbolPattern=IntlBase.getSymbolPattern(fOptions.type,dOptions.numberMapper.numberSystem,dependable.numericObject,fOptions.isAccount),fOptions.groupOne=this.checkValueRange(fOptions.maximumSignificantDigits,fOptions.minimumSignificantDigits,!0),this.checkValueRange(fOptions.maximumFractionDigits,fOptions.minimumFractionDigits,!1,!0),isUndefined(fOptions.fractionDigits)||(fOptions.minimumFractionDigits=fOptions.maximumFractionDigits=fOptions.fractionDigits),isUndefined(fOptions.useGrouping)&&(fOptions.useGrouping=!0),fOptions.isCurrency&&(symbolPattern=symbolPattern.replace(/\u00A4/g,IntlBase.defaultCurrency));let split=symbolPattern.split(";");if(cOptions.nData=IntlBase.getFormatData(split[1]||"-"+split[0],!0,dOptions.currencySymbol),cOptions.pData=IntlBase.getFormatData(split[0],!1,dOptions.currencySymbol),fOptions.useGrouping&&(fOptions.groupSeparator=symbols[mapper$1[2]],fOptions.groupData=this.getGroupingDetails(split[0])),isUndefined(fOptions.minimumFractionDigits)&&(fOptions.minimumFractionDigits=cOptions.nData.minimumFraction),isUndefined(fOptions.maximumFractionDigits)){let mval=cOptions.nData.maximumFraction;fOptions.maximumFractionDigits=isUndefined(mval)&&fOptions.isPercent?0:mval}let mfrac=fOptions.minimumFractionDigits,lfrac=fOptions.maximumFractionDigits;isUndefined(mfrac)||isUndefined(lfrac)||mfrac>lfrac&&(fOptions.maximumFractionDigits=mfrac)}return extend(cOptions.nData,fOptions),extend(cOptions.pData,fOptions),value=>isNaN(value)?symbols[mapper$1[1]]:isFinite(value)?this.intNumberFormatter(value,cOptions,dOptions):symbols[mapper$1[0]]}static getGroupingDetails(pattern){let ret={},match=pattern.match(IntlBase.negativeDataRegex);if(match&&match[4]){let pattern=match[4],p=pattern.lastIndexOf(",");if(-1!==p){let temp=pattern.split(".")[0];ret.primary=temp.length-p-1;let s=pattern.lastIndexOf(",",p-1);-1!==s&&(ret.secondary=p-1-s)}}return ret}static checkValueRange(val1,val2,checkbothExist,isFraction){let decide=isFraction?"f":"s",dint=0,str1=errorText["l"+decide],str2=errorText["m"+decide];if(isUndefined(val1)||(this.checkRange(val1,str1,isFraction),dint++),isUndefined(val2)||(this.checkRange(val2,str2,isFraction),dint++),2===dint){if(!(val1<val2))return!0;ej2_base_es2015_throwError(str2+"specified must be less than the"+str1)}else checkbothExist&&1===dint&&ej2_base_es2015_throwError("Both"+str2+"and"+str2+"must be present");return!1}static checkRange(val,text,isFraction){let range=isFraction?[0,20]:[1,21];(val<range[0]||val>range[1])&&ej2_base_es2015_throwError(text+"value must be within the range"+range[0]+"to"+range[1])}static intNumberFormatter(value,fOptions,dOptions){let curData;if(!isUndefined(fOptions.nData.type)){value<0?(value*=-1,curData=fOptions.nData):curData=0===value&&fOptions.zeroData||fOptions.pData;let fValue="";return curData.isPercent&&(value*=100),curData.groupOne?fValue=this.processSignificantDigits(value,curData.minimumSignificantDigits,curData.maximumSignificantDigits):(fValue=this.processFraction(value,curData.minimumFractionDigits,curData.maximumFractionDigits),curData.minimumIntegerDigits&&(fValue=this.processMinimumIntegers(fValue,curData.minimumIntegerDigits))),"scientific"===curData.type&&(fValue=(fValue=value.toExponential(curData.maximumFractionDigits)).replace("e",dOptions.numberMapper.numberSymbols[mapper$1[4]])),fValue=fValue.replace(".",dOptions.numberMapper.numberSymbols[mapper$1[3]]),curData.useGrouping&&(fValue=this.groupNumbers(fValue,curData.groupData.primary,curData.groupSeparator||",",dOptions.numberMapper.numberSymbols[mapper$1[3]]||".",curData.groupData.secondary)),fValue=ParserBase.convertValueParts(fValue,IntlBase.latnParseRegex,dOptions.numberMapper.mapper),"N/A"===curData.nlead?curData.nlead:curData.nlead+fValue+curData.nend}}static processSignificantDigits(value,min,max){let tn,temp=value+"";return temp.length<min?value.toPrecision(min):(tn=+(temp=value.toPrecision(max)))+""}static groupNumbers(val,level1,sep,decimalSymbol,level2){let flag=!isNullOrUndefined(level2)&&0!==level2,split=val.split(decimalSymbol),prefix=split[0],length=prefix.length,str="";for(;length>level1;)str=prefix.slice(length-level1,length)+(str.length?sep+str:""),length-=level1,flag&&(level1=level2,flag=!1);return split[0]=prefix.slice(0,length)+(str.length?sep:"")+str,split.join(decimalSymbol)}static processFraction(value,min,max){let temp=(value+"").split(".")[1],length=temp?temp.length:0;if(min&&length<min){let ret="";if(0!==length){ret+=value;for(let j=0;j<min-length;j++)ret+="0";return ret}return ret=value.toFixed(min),value.toFixed(min)}return!isNullOrUndefined(max)&&(length>max||0===max)?value.toFixed(max):value+""}static processMinimumIntegers(value,min){let temp=value.split("."),lead=temp[0],len=lead.length;if(len<min){for(let i=0;i<min-len;i++)lead="0"+lead;temp[0]=lead}return temp.join(".")}}var IntlBase,HijriParser;!function(IntlBase){IntlBase.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,IntlBase.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,IntlBase.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;const fractionRegex=/[0-9]/g;IntlBase.defaultCurrency="$";const mapper=["infinity","nan","group","decimal"],patternRegex=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,patternMatch={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};IntlBase.islamicRegex=/^islamic/;const firstDayMapper={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};IntlBase.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i,IntlBase.currencyFormatRegex=/(^[ca]{1})([0-1]?[0-9]|20)?$/i,IntlBase.curWithoutNumberRegex=/(c|a)$/gi;const typeMapper={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};function getResultantPattern(skeleton,dateObject,type,isIslamic){let resPattern,iType=type||"date";if(-1!==IntlBase.basicPatterns.indexOf(skeleton)){if(resPattern=getValue(iType+"Formats."+skeleton,dateObject),"dateTime"===iType){let dPattern=getValue("dateFormats."+skeleton,dateObject),tPattern=getValue("timeFormats."+skeleton,dateObject);resPattern=resPattern.replace("{1}",dPattern).replace("{0}",tPattern)}}else resPattern=getValue("dateTimeFormats.availableFormats."+skeleton,dateObject);return isUndefined(resPattern)&&"yMd"===skeleton&&(resPattern="M/d/y"),resPattern}function getDependables(cldr,culture,mode,isNumber){let ret={},calendartype=mode||"gregorian";return ret.parserObject=ParserBase.getMainObject(cldr,culture)||IntlBase.defaultObject,isNumber?ret.numericObject=getValue("numbers",ret.parserObject):ret.dateObject=getValue("dates.calendars."+calendartype,ret.parserObject),ret}function getSymbolPattern(type,numSystem,obj,isAccount){return getValue(type+"Formats-numberSystem-"+numSystem+(isAccount?".accounting":".standard"),obj)||(isAccount?getValue(type+"Formats-numberSystem-"+numSystem+".standard",obj):"")}function getProperNumericSkeleton(skeleton){let matches=skeleton.match(IntlBase.formatRegex),ret={},pattern=matches[1].toUpperCase();return ret.isAccount="A"===pattern,ret.type=IntlBase.patternMatcher[pattern],skeleton.length>1&&(ret.fractionDigits=parseInt(matches[2],10)),ret}function getFormatData(pattern,needFraction,cSymbol,fractionOnly){let nData=fractionOnly?{}:{nlead:"",nend:""},match=pattern.match(IntlBase.customRegex);if(match){fractionOnly||(nData.nlead=changeCurrencySymbol(match[1],cSymbol),nData.nend=changeCurrencySymbol(match[10],cSymbol),nData.groupPattern=match[4]);let fraction=match[7];if(fraction&&needFraction){let fmatch=fraction.match(fractionRegex);nData.minimumFraction=isNullOrUndefined(fmatch)?0:fmatch.length,nData.maximumFraction=fraction.length-1}}return nData}function changeCurrencySymbol(val,sym){return val?val.replace(IntlBase.defaultCurrency,sym):""}function getCurrencySymbol(numericObject,currencyCode){return getValue("currencies."+currencyCode+".symbol",numericObject)||getValue("currencies."+currencyCode+".symbol-alt-narrow",numericObject)||"$"}function customNumberFormat(format,dOptions,numObject){let cOptions={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},pattern=format.match(IntlBase.customRegex);(isNullOrUndefined(pattern)||""===pattern[5]&&"N/A"!==format)&&(cOptions.type=void 0),cOptions.nlead=pattern[1],cOptions.nend=pattern[10];let integerPart=pattern[6];cOptions.useGrouping=-1!==integerPart.indexOf(","),integerPart=integerPart.replace(/,/g,"");let fractionPart=pattern[7];if(-1!==integerPart.indexOf("0")&&(cOptions.minimumIntegerDigits=integerPart.length-integerPart.indexOf("0")),isNullOrUndefined(fractionPart)||(cOptions.minimumFractionDigits=fractionPart.lastIndexOf("0"),cOptions.maximumFractionDigits=fractionPart.lastIndexOf("#"),-1===cOptions.minimumFractionDigits&&(cOptions.minimumFractionDigits=0),(-1===cOptions.maximumFractionDigits||cOptions.maximumFractionDigits<cOptions.minimumFractionDigits)&&(cOptions.maximumFractionDigits=cOptions.minimumFractionDigits)),isNullOrUndefined(dOptions)?extend(cOptions,isCurrencyPercent([cOptions.nlead,cOptions.nend],"%","%")):(extend(cOptions,isCurrencyPercent([cOptions.nlead,cOptions.nend],"$",dOptions.currencySymbol)),cOptions.isCurrency||extend(cOptions,isCurrencyPercent([cOptions.nlead,cOptions.nend],"%",dOptions.percentSymbol))),!isNullOrUndefined(numObject)){let symbolPattern=getSymbolPattern(cOptions.type,dOptions.numberMapper.numberSystem,numObject,!1);cOptions.useGrouping&&(cOptions.groupSeparator=dOptions.numberMapper.numberSymbols[mapper[2]],cOptions.groupData=NumberFormat.getGroupingDetails(symbolPattern.split(";")[0])),cOptions.nlead=cOptions.nlead.replace(/\'/g,""),cOptions.nend=cOptions.nend.replace(/\'/g,"")}return cOptions}function isCurrencyPercent(parts,actual,symbol){let options={nlead:parts[0],nend:parts[1]};for(let i=0;i<2;i++){let part=parts[i],loc=part.indexOf(actual);if(-1!==loc&&(loc<part.indexOf("'")||loc>part.lastIndexOf("'"))){options[typeMapper[i]]=part.substr(0,loc)+symbol+part.substr(loc+1),options[typeMapper[actual]]=!0,options.type=options.isCurrency?"currency":"percent";break}}return options}IntlBase.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,IntlBase.basicPatterns=["short","medium","long","full"],IntlBase.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhuʻl-Q.",12:"Dhuʻl-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabiʻ I",4:"Rabiʻ II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Shaʻban",9:"Ramadan",10:"Shawwal",11:"Dhuʻl-Qiʻdah",12:"Dhuʻl-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"€","symbol-alt-narrow":"€"},GBP:{displayName:"British Pound","symbol-alt-narrow":"£"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"×",perMille:"‰",infinity:"∞",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"¤#,##0.00",accounting:"¤#,##0.00;(¤#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},IntlBase.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},IntlBase.month="months",IntlBase.days="days",IntlBase.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"},IntlBase.getResultantPattern=getResultantPattern,IntlBase.getDependables=getDependables,IntlBase.getSymbolPattern=getSymbolPattern,IntlBase.getProperNumericSkeleton=getProperNumericSkeleton,IntlBase.getFormatData=getFormatData,IntlBase.getCurrencySymbol=getCurrencySymbol,IntlBase.customFormat=function(format,dOptions,obj){let options={},formatSplit=format.split(";"),data=["pData","nData","zeroData"];for(let i=0;i<formatSplit.length;i++)options[data[i]]=customNumberFormat(formatSplit[i],dOptions,obj);return isNullOrUndefined(options.nData)&&(options.nData=extend({},options.pData),options.nData.nlead=isNullOrUndefined(dOptions)?"-"+options.nData.nlead:dOptions.minusSymbol+options.nData.nlead),options},IntlBase.isCurrencyPercent=isCurrencyPercent,IntlBase.getDateSeparator=function(dateObj){let value=(getValue("dateFormats.short",dateObj)||"").match(/[d‏M‏]([^d‏M])[d‏M‏]/i);return value?value[1]:"/"},IntlBase.getActualDateTimeFormat=function(culture,options,cldr,isExcelFormat){let dependable=getDependables(cldr,culture,options.calendar),actualPattern=options.format||getResultantPattern(options.skeleton,dependable.dateObject,options.type);if(isExcelFormat){if(-1!==(actualPattern=actualPattern.replace(patternRegex,pattern=>patternMatch[pattern])).indexOf("z")){let timeZonePattern,tLength=actualPattern.match(/z/g).length,options={timeZone:{}};options.numMapper=ParserBase.getNumberMapper(dependable.parserObject,ParserBase.getNumberingSystem(cldr)),options.timeZone=getValue("dates.timeZoneNames",dependable.parserObject);let timezone=(new Date).getTimezoneOffset(),pattern=tLength<4?"+H;-H":options.timeZone.hourFormat;pattern=pattern.replace(/:/g,options.numMapper.timeSeparator),0===timezone?timeZonePattern=options.timeZone.gmtZeroFormat:(timeZonePattern=DateFormat.getTimeZoneValue(timezone,pattern),timeZonePattern=options.timeZone.gmtFormat.replace(/\{0\}/,timeZonePattern)),actualPattern=actualPattern.replace(/[z]+/,'"'+timeZonePattern+'"')}actualPattern=actualPattern.replace(/ $/,"")}return actualPattern},IntlBase.getActualNumberFormat=function(culture,options,cldr){let minFrac,actualPattern,dependable=getDependables(cldr,culture,"",!0),parseOptions={custom:!0},curObj={},curMatch=(options.format||"").match(IntlBase.currencyFormatRegex);if(curMatch){let dOptions={};dOptions.numberMapper=ParserBase.getNumberMapper(dependable.parserObject,ParserBase.getNumberingSystem(cldr),!0);let curCode=getCurrencySymbol(dependable.numericObject,options.currency||defaultCurrencyCode),symbolPattern=getSymbolPattern("currency",dOptions.numberMapper.numberSystem,dependable.numericObject,/a/i.test(options.format)),split=(symbolPattern=symbolPattern.replace(/\u00A4/g,curCode)).split(";");curObj.hasNegativePattern=split.length>1,curObj.nData=getFormatData(split[1]||"-"+split[0],!0,curCode),curObj.pData=getFormatData(split[0],!1,curCode),curMatch[2]||options.minimumFractionDigits||options.maximumFractionDigits||(minFrac=getFormatData(symbolPattern.split(";")[0],!0,"",!0).minimumFraction)}if(IntlBase.formatRegex.test(options.format)||!options.format){if(extend(parseOptions,getProperNumericSkeleton(options.format||"N")),parseOptions.custom=!1,actualPattern="###0",parseOptions.fractionDigits||options.minimumFractionDigits||options.maximumFractionDigits||minFrac){let defaultMinimum=0;parseOptions.fractionDigits&&(options.minimumFractionDigits=options.maximumFractionDigits=parseOptions.fractionDigits),actualPattern=function(pattern,minDigits,maxDigits){pattern+=".";for(let a=0;a<minDigits;a++)pattern+="0";if(minDigits<maxDigits){let diff=maxDigits-minDigits;for(let b=0;b<diff;b++)pattern+="#"}return pattern}(actualPattern,minFrac||parseOptions.fractionDigits||options.minimumFractionDigits||defaultMinimum,options.maximumFractionDigits||defaultMinimum)}if(options.minimumIntegerDigits&&(actualPattern=function(pattern,digits){let temp=actualPattern.split("."),integer="";for(let x=0;x<digits;x++)integer+="0";return temp[1]?integer+"."+temp[1]:integer}(0,options.minimumIntegerDigits)),options.useGrouping&&(actualPattern=function(pattern){let temp=pattern.split("."),integer=temp[0],no=3-integer.length%3;pattern="";for(let x=(integer=(no&&1===no?"#":2===no?"##":"")+integer).length-1;x>0;x-=3)pattern=","+integer[x-2]+integer[x-1]+integer[x]+pattern;return pattern=pattern.slice(1),temp[1]?pattern+"."+temp[1]:pattern}(actualPattern)),"currency"===parseOptions.type){let cPattern=actualPattern;actualPattern=curObj.pData.nlead+cPattern+curObj.pData.nend,curObj.hasNegativePattern&&(actualPattern+=";"+curObj.nData.nlead+cPattern+curObj.nData.nend)}"percent"===parseOptions.type&&(actualPattern+=" %")}else actualPattern=options.format.replace(/\'/g,'"');return actualPattern},IntlBase.getWeekData=function(culture,cldr){let firstDay="sun",mapper=getValue("supplemental.weekData.firstDay",cldr),iCulture=culture;return/en-/.test(iCulture)&&(iCulture=iCulture.slice(3)),iCulture=iCulture.slice(0,2).toUpperCase()+iCulture.substr(2),mapper&&(firstDay=mapper[iCulture]||"sun"),firstDayMapper[firstDay]}}(IntlBase||(IntlBase={})),function(HijriParser){const dateCorrection=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];HijriParser.getHijriDate=function(gDate){let day=gDate.getDate(),month=gDate.getMonth(),year=gDate.getFullYear(),tMonth=month+1,tYear=year;tMonth<3&&(tYear-=1,tMonth+=12);let yPrefix=Math.floor(tYear/100),julilanOffset=yPrefix-Math.floor(yPrefix/4)-2,julianNumber=Math.floor(365.25*(tYear+4716))+Math.floor(30.6001*(tMonth+1))+day-julilanOffset-1524,b=julianNumber+(julilanOffset=(yPrefix=Math.floor((julianNumber-1867216.25)/36524.25))-Math.floor(yPrefix/4)+1)+1524,c=Math.floor((b-122.1)/365.25),d=Math.floor(365.25*c),tempMonth=Math.floor((b-d)/30.6001);day=b-d-Math.floor(30.6001*tempMonth),(month=Math.floor((b-d)/20.6001))>13&&(c+=1,month-=12),month-=1,year=c-4716;let modifiedJulianDate=julianNumber-24e5,z=julianNumber-1948084,cyc=Math.floor(z/10631);z-=10631*cyc;let j=Math.floor((z-.1335)/(10631/30)),iy=30*cyc+j;z-=Math.floor(j*(10631/30)+.1335);let im=Math.floor((z+28.5001)/29.5);13===im&&(im=12);let tempDay=z-Math.floor(29.5001*im-29),i=0;for(;i<dateCorrection.length&&!(dateCorrection[i]>modifiedJulianDate);i++);let iln=i+16260,ii=Math.floor((iln-1)/12),hYear=ii+1,hmonth=iln-12*ii,hDate=modifiedJulianDate-dateCorrection[i-1]+1;return(hDate+"").length>2&&(hDate=tempDay,hmonth=im,hYear=iy),{year:hYear,month:hmonth,date:hDate}},HijriParser.toGregorian=function(year,month,day){let z=Math.floor(day+dateCorrection[12*(year-1)+1+(month-1)-16260-1]-1+24e5+.5),a=Math.floor((z-1867216.25)/36524.25),b=1524+(a=z+1+a-Math.floor(a/4)),c=Math.floor((b-122.1)/365.25),d=Math.floor(365.25*c),e=Math.floor((b-d)/30.6001),gDay=b-d-Math.floor(30.6001*e),gMonth=e-(e>13.5?13:1),gYear=c-(gMonth>2.5?4716:4715);return gYear<=0&&gMonth--,new Date(gYear+"/"+gMonth+"/"+gDay)}}(HijriParser||(HijriParser={}));const abbreviateRegexGlobal=/\/MMMMM|MMMM|MMM|a|LLL|EEEEE|EEEE|E|K|cccc|ccc|G+|z+/gi,standalone="stand-alone",weekdayKey=["sun","mon","tue","wed","thu","fri","sat"],timeSetter={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate"},datePartMatcher={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era"},timeSeparator="timeSeparator";class DateFormat{static dateFormat(culture,option,cldr){let dependable=IntlBase.getDependables(cldr,culture,option.calendar),formatOptions={isIslamic:IntlBase.islamicRegex.test(option.calendar)},resPattern=option.format||IntlBase.getResultantPattern(option.skeleton,dependable.dateObject,option.type);if(formatOptions.dateSeperator=IntlBase.getDateSeparator(dependable.dateObject),isUndefined(resPattern))ej2_base_es2015_throwError("Format options or type given must be invalid");else{formatOptions.pattern=resPattern,formatOptions.numMapper=ParserBase.getNumberMapper(dependable.parserObject,ParserBase.getNumberingSystem(cldr));let patternMatch=resPattern.match(abbreviateRegexGlobal)||[];for(let str of patternMatch){let len=str.length,char=str[0];switch("K"===char&&(char="h"),char){case"E":case"c":formatOptions.weekday=dependable.dateObject[IntlBase.days][standalone][IntlBase.monthIndex[len]];break;case"M":case"L":formatOptions.month=dependable.dateObject[IntlBase.month][standalone][IntlBase.monthIndex[len]];break;case"a":formatOptions.designator=getValue("dayPeriods.format.wide",dependable.dateObject);break;case"G":formatOptions.era=getValue("eras."+(len<=3?"eraAbbr":4===len?"eraNames":"eraNarrow"),dependable.dateObject);break;case"z":formatOptions.timeZone=getValue("dates.timeZoneNames",dependable.parserObject)}}}return value=>isNaN(value.getDate())?null:this.intDateFormatter(value,formatOptions)}static intDateFormatter(value,options){let ret="",matches=options.pattern.match(IntlBase.dateParseRegex),dObject=this.getCurrentDateValue(value,options.isIslamic);for(let match of matches){let curval,isNumber,processNumber,length=match.length,char=match[0];"K"===char&&(char="h");let curstr="";switch(char){case"M":case"L":curval=dObject.month,length>2?ret+=options.month[curval]:isNumber=!0;break;case"E":case"c":ret+=options.weekday[weekdayKey[value.getDay()]];break;case"H":case"h":case"m":case"s":case"d":isNumber=!0,curval="d"===char?dObject.date:value[timeSetter[char]](),"h"===char&&(curval=curval%12||12);break;case"y":processNumber=!0,curstr+=dObject.year,2===length&&(curstr=curstr.substr(curstr.length-2));break;case"a":let desig=value.getHours()<12?"am":"pm";ret+=options.designator[desig];break;case"G":let dec=value.getFullYear()<0?0:1,retu=options.era[dec];isNullOrUndefined(retu)&&(retu=options.era[dec?0:1]),ret+=retu||"";break;case"'":ret+="''"===match?"'":match.replace(/\'/g,"");break;case"z":let timezone=value.getTimezoneOffset(),pattern=length<4?"+H;-H":options.timeZone.hourFormat;pattern=pattern.replace(/:/g,options.numMapper.timeSeparator),0===timezone?ret+=options.timeZone.gmtZeroFormat:(processNumber=!0,curstr=this.getTimeZoneValue(timezone,pattern)),curstr=options.timeZone.gmtFormat.replace(/\{0\}/,curstr);break;case":":ret+=options.numMapper.numberSymbols[timeSeparator];break;case"/":ret+=options.dateSeperator;break;default:ret+=match}isNumber&&(processNumber=!0,curstr=this.checkTwodigitNumber(curval,length)),processNumber&&(ret+=ParserBase.convertValueParts(curstr,IntlBase.latnParseRegex,options.numMapper.mapper))}return ret}static getCurrentDateValue(value,isIslamic){return isIslamic?HijriParser.getHijriDate(value):{year:value.getFullYear(),month:value.getMonth()+1,date:value.getDate()}}static checkTwodigitNumber(val,len){let ret=val+"";return 2===len&&2!==ret.length?"0"+ret:ret}static getTimeZoneValue(tVal,pattern){let curPattern=pattern.split(";")[tVal>0?1:0],no=Math.abs(tVal);return curPattern.replace(/HH?|mm/g,str=>{let len=str.length,ishour=-1!==str.indexOf("H");return this.checkTwodigitNumber(Math.floor(ishour?no/60:no%60),len)})}}const standalone$1="stand-alone",latnRegex$1=/^[0-9]*$/,timeSetter$1={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth"},ej2_base_es2015_month="months";class DateParser{static dateParser(culture,option,cldr){let hourOnly,dependable=IntlBase.getDependables(cldr,culture,option.calendar),numOptions=ParserBase.getCurrentNumericOptions(dependable.parserObject,ParserBase.getNumberingSystem(cldr)),parseOptions={},resPattern=option.format||IntlBase.getResultantPattern(option.skeleton,dependable.dateObject,option.type),regexString="";if(isUndefined(resPattern))ej2_base_es2015_throwError("Format options or type given must be invalid");else{parseOptions={isIslamic:IntlBase.islamicRegex.test(option.calendar),pattern:resPattern,evalposition:{}};let patternMatch=resPattern.match(IntlBase.dateParseRegex)||[],length=patternMatch.length,gmtCorrection=0,zCorrectTemp=0,isgmtTraversed=!1,nRegx=numOptions.numericRegex,numMapper=ParserBase.getNumberMapper(dependable.parserObject,ParserBase.getNumberingSystem(cldr));for(let i=0;i<length;i++){let isNumber,canUpdate,str=patternMatch[i],len=str.length,char="K"===str[0]?"h":str[0],charKey=datePartMatcher[char],optional=2===len?"":"?";switch(isgmtTraversed&&(gmtCorrection=zCorrectTemp,isgmtTraversed=!1),char){case"E":case"c":let weekObject=ParserBase.reverseObject(dependable.dateObject[IntlBase.days][standalone$1][IntlBase.monthIndex[len]]);regexString+="("+Object.keys(weekObject).join("|")+")";break;case"M":case"L":case"d":case"m":case"s":case"h":case"H":canUpdate=!0,("M"===char||"L"===char)&&len>2?(parseOptions[charKey]=ParserBase.reverseObject(dependable.dateObject[ej2_base_es2015_month][standalone$1][IntlBase.monthIndex[len]]),regexString+="("+Object.keys(parseOptions[charKey]).join("|")+")"):(isNumber=!0,regexString+="("+nRegx+nRegx+optional+")"),"h"===char&&(parseOptions.hour12=!0);break;case"y":canUpdate=isNumber=!0,regexString+=2===len?"("+nRegx+nRegx+")":"("+nRegx+"{"+len+",})";break;case"a":canUpdate=!0,parseOptions[charKey]=ParserBase.reverseObject(getValue("dayPeriods.format.wide",dependable.dateObject)),regexString+="("+Object.keys(parseOptions[charKey]).join("|")+")";break;case"G":canUpdate=!0,parseOptions[charKey]=ParserBase.reverseObject(getValue("eras."+(len<=3?"eraAbbr":4===len?"eraNames":"eraNarrow"),dependable.dateObject)),regexString+="("+Object.keys(parseOptions[charKey]).join("|")+"?)";break;case"z":canUpdate=0!==(new Date).getTimezoneOffset(),parseOptions[charKey]=getValue("dates.timeZoneNames",dependable.parserObject);let tzone=parseOptions[charKey],hpattern=(hourOnly=len<4)?"+H;-H":tzone.hourFormat;hpattern=hpattern.replace(/:/g,numMapper.timeSeparator),regexString+="("+this.parseTimeZoneRegx(hpattern,tzone,nRegx)+")?",isgmtTraversed=!0,zCorrectTemp=hourOnly?6:12;break;case"'":regexString+="("+str.replace(/\'/g,"")+")?";break;default:regexString+="([\\D])"}canUpdate&&(parseOptions.evalposition[charKey]={isNumber:isNumber,pos:i+1+gmtCorrection,hourOnly:hourOnly}),i!==length-1||isNullOrUndefined(regexString)||(parseOptions.parserRegex=new RegExp("^"+regexString+"$"))}}return value=>{let parsedDateParts=this.internalDateParse(value,parseOptions,numOptions);if(isNullOrUndefined(parsedDateParts)||!Object.keys(parsedDateParts).length)return null;if(parseOptions.isIslamic){let dobj={},tYear=parsedDateParts.year,tDate=parsedDateParts.day,tMonth=parsedDateParts.month,ystrig=tYear?tYear+"":"",is2DigitYear=2===ystrig.length;tYear&&tMonth&&tDate&&!is2DigitYear||(dobj=HijriParser.getHijriDate(new Date)),is2DigitYear&&(tYear=parseInt((dobj.year+"").slice(0,2)+ystrig,10));let dateObject=HijriParser.toGregorian(tYear||dobj.year,tMonth||dobj.month,tDate||dobj.date);parsedDateParts.year=dateObject.getFullYear(),parsedDateParts.month=dateObject.getMonth()+1,parsedDateParts.day=dateObject.getDate()}return this.getDateObject(parsedDateParts)}}static getDateObject(options,value){let res=value||new Date;res.setMilliseconds(0);let tKeys=["hour","minute","second","month","day"],y=options.year,desig=options.designator,tzone=options.timeZone;isUndefined(y)||((y+"").length<=2&&(y+=100*Math.floor(res.getFullYear()/100)),res.setFullYear(y));for(let key of tKeys){let tValue=options[key];if(isUndefined(tValue)&&"day"===key&&res.setDate(1),!isUndefined(tValue))if("month"===key){if((tValue-=1)<0||tValue>11)return new Date("invalid");let pDate=res.getDate();res.setDate(1),res[timeSetter$1[key]](tValue);let lDate=new Date(res.getFullYear(),tValue+1,0).getDate();res.setDate(pDate<lDate?pDate:lDate)}else{if("day"===key){let lastDay=new Date(res.getFullYear(),res.getMonth()+1,0).getDate();if(tValue<1||tValue>lastDay)return null}res[timeSetter$1[key]](tValue)}}if(!isUndefined(desig)){let hour=res.getHours();"pm"===desig?res.setHours(hour+(12===hour?0:12)):12===hour&&res.setHours(0)}if(!isUndefined(tzone)){let tzValue=tzone-res.getTimezoneOffset();0!==tzValue&&res.setMinutes(res.getMinutes()+tzValue)}return res}static internalDateParse(value,parseOptions,num){let matches=value.match(parseOptions.parserRegex),retOptions={hour:0,minute:0,second:0};if(isNullOrUndefined(matches))return null;{let props=Object.keys(parseOptions.evalposition);for(let prop of props){let curObject=parseOptions.evalposition[prop],matchString=matches[curObject.pos];if(curObject.isNumber)retOptions[prop]=this.internalNumberParser(matchString,num);else if("timeZone"!==prop||isUndefined(matchString))retOptions[prop]=parseOptions[prop][matchString];else{let val,pos=curObject.pos,tmatch=matches[pos+1],flag=!isUndefined(tmatch);curObject.hourOnly?val=60*this.getZoneValue(flag,tmatch,matches[pos+4],num):(val=60*this.getZoneValue(flag,tmatch,matches[pos+7],num),val+=this.getZoneValue(flag,matches[pos+4],matches[pos+10],num)),isNullOrUndefined(val)||(retOptions[prop]=val)}}parseOptions.hour12&&(retOptions.hour12=!0)}return retOptions}static internalNumberParser(value,option){return value=ParserBase.convertValueParts(value,option.numberParseRegex,option.numericPair),latnRegex$1.test(value)?+value:null}static parseTimeZoneRegx(hourFormat,tZone,nRegex){let ret,splitStr,pattern=tZone.gmtFormat,cRegex="("+nRegex+")("+nRegex+")";return ret=hourFormat.replace("+","\\+"),(splitStr=(ret=-1!==hourFormat.indexOf("HH")?ret.replace(/HH|mm/g,"("+cRegex+")"):ret.replace(/H|m/g,"("+cRegex+"?)")).split(";").map(str=>pattern.replace("{0}",str))).join("|")+"|"+tZone.gmtZeroFormat}static getZoneValue(flag,val1,val2,num){let ival=flag?val1:val2;if(!ival)return 0;let value=this.internalNumberParser(ival,num);return flag?-value:value}}const parseRegex=/^([^0-9]*)(([0-9,]*[0-9]+)(\.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$/,groupRegex=/,/g,ej2_base_es2015_keys=["minusSign","infinity"];class NumberParser{static numberParser(culture,option,cldr){let numOptions,dependable=IntlBase.getDependables(cldr,culture,"",!0),parseOptions={custom:!0};IntlBase.formatRegex.test(option.format)||!option.format?(extend(parseOptions,IntlBase.getProperNumericSkeleton(option.format||"N")),parseOptions.custom=!1):extend(parseOptions,IntlBase.customFormat(option.format,null,null)),numOptions=ParserBase.getCurrentNumericOptions(dependable.parserObject,ParserBase.getNumberingSystem(cldr),!0),parseOptions.symbolRegex=ParserBase.getSymbolRegex(Object.keys(numOptions.symbolMatch)),parseOptions.infinity=numOptions.symbolNumberSystem[ej2_base_es2015_keys[1]];let symbolpattern=IntlBase.getSymbolPattern(parseOptions.type,numOptions.numberSystem,dependable.numericObject,parseOptions.isAccount);if(symbolpattern){let split=(symbolpattern=symbolpattern.replace(/\u00A4/g,IntlBase.defaultCurrency)).split(";");parseOptions.nData=IntlBase.getFormatData(split[1]||"-"+split[0],!0,""),parseOptions.pData=IntlBase.getFormatData(split[0],!0,"")}return value=>this.getParsedNumber(value,parseOptions,numOptions)}static getParsedNumber(value,options,numOptions){let isNegative,isPercent,tempValue,lead,end,ret;if(-1!==value.indexOf(options.infinity))return 1/0;{value=ParserBase.convertValueParts(value,options.symbolRegex,numOptions.symbolMatch),0===(value=ParserBase.convertValueParts(value,numOptions.numberParseRegex,numOptions.numericPair)).indexOf(".")&&(value="0"+value);let matches=value.match(parseRegex);if(isNullOrUndefined(matches))return NaN;lead=matches[1],tempValue=matches[2];let exponent=matches[5];return end=matches[6],isPercent=(isNegative=options.custom?lead===options.nData.nlead&&end===options.nData.nend:-1!==lead.indexOf(options.nData.nlead)&&-1!==end.indexOf(options.nData.nend))?options.nData.isPercent:options.pData.isPercent,tempValue=tempValue.replace(groupRegex,""),exponent&&(tempValue+=exponent),ret=+tempValue,("percent"===options.type||isPercent)&&(ret/=100),(options.custom||options.fractionDigits)&&(ret=parseFloat(ret.toFixed(options.custom?isNegative?options.nData.maximumFractionDigits:options.pData.maximumFractionDigits:options.fractionDigits))),isNegative&&(ret*=-1),ret}}}let onIntlChange=new Observer,cldrData={},defaultCulture="en-US",defaultCurrencyCode="USD";const ej2_base_es2015_mapper=["numericObject","dateObject"];class Internationalization{constructor(cultureName){cultureName&&(this.culture=cultureName)}getDateFormat(options){return DateFormat.dateFormat(this.getCulture(),options||{type:"date",skeleton:"short"},cldrData)}getNumberFormat(options){return options&&!options.currency&&(options.currency=defaultCurrencyCode),NumberFormat.numberFormatter(this.getCulture(),options||{},cldrData)}getDateParser(options){return DateParser.dateParser(this.getCulture(),options||{skeleton:"short",type:"date"},cldrData)}getNumberParser(options){return NumberParser.numberParser(this.getCulture(),options||{format:"N"},cldrData)}formatNumber(value,option){return this.getNumberFormat(option)(value)}formatDate(value,option){return this.getDateFormat(option)(value)}parseDate(value,option){return this.getDateParser(option)(value)}parseNumber(value,option){return this.getNumberParser(option)(value)}getDatePattern(option,isExcelFormat){return IntlBase.getActualDateTimeFormat(this.getCulture(),option,cldrData,isExcelFormat)}getNumberPattern(option){return IntlBase.getActualNumberFormat(this.getCulture(),option,cldrData)}getFirstDayOfWeek(){return IntlBase.getWeekData(this.getCulture(),cldrData)}getCulture(){return this.culture||defaultCulture}}function getNumericObject(locale,type){let numObject=IntlBase.getDependables(cldrData,locale,"",!0)[ej2_base_es2015_mapper[0]],dateObject=IntlBase.getDependables(cldrData,locale,"")[ej2_base_es2015_mapper[1]],numSystem=getValue("defaultNumberingSystem",numObject),symbPattern=getValue("symbols-numberSystem-"+numSystem,numObject),pattern=IntlBase.getSymbolPattern(type||"decimal",numSystem,numObject,!1);return extend(symbPattern,IntlBase.getFormatData(pattern,!0,"",!0),{dateSeparator:IntlBase.getDateSeparator(dateObject)})}function getDefaultDateObject(mode){return IntlBase.getDependables(cldrData,"",mode,!1)[ej2_base_es2015_mapper[1]]}let lastPageID,componentCount=0,lastHistoryLen=0,ej2_base_es2015_Component=(()=>{let Component=class extends Base{constructor(options,selector){super(options,selector),this.randomId=function(){if("undefined"==typeof window)return;let num=new Uint16Array(5);return(window.msCrypto||window.crypto).getRandomValues(num)}(),this.isStringTemplate=!1,this.needsID=!1,this.isRendered=!1,this.createElement=ej2_base_es2015_createElement,isNullOrUndefined(this.enableRtl)&&this.setProperties({enableRtl:!1},!0),isNullOrUndefined(this.locale)&&this.setProperties({locale:defaultCulture},!0),this.moduleLoader=new ModuleLoader(this),this.localObserver=new Observer(this),onIntlChange.on("notifyExternalChange",this.detectFunction,this,this.randomId),isUndefined(selector)||this.appendTo()}requiredModules(){return[]}destroy(){this.isDestroyed||(this.enablePersistence&&this.setPersistData(),this.localObserver.destroy(),this.refreshing||(removeClass([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),super.destroy(),this.moduleLoader.clean(),onIntlChange.off("notifyExternalChange",this.detectFunction,this.randomId)))}refresh(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new Observer(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1}appendTo(selector){if(isNullOrUndefined(selector)||"string"!=typeof selector?isNullOrUndefined(selector)||(this.element=selector):this.element=document.querySelector(selector),!isNullOrUndefined(this.element)){let moduleClass="e-"+this.getModuleName().toLowerCase();addClass([this.element],["e-control",moduleClass]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),window.addEventListener("unload",this.setPersistData.bind(this)));let inst=getValue("ej2_instances",this.element);inst&&-1!==inst.indexOf(this)||super.addInstance(),this.preRender(),this.injectModules(),this.render(),this.trigger("created")}}renderComplete(wrapperElement){isBlazor()&&window.ejsInterop.renderComplete(this.element,wrapperElement),this.isRendered=!0}dataBind(){this.injectModules(),super.dataBind()}on(event,handler,context){if("string"==typeof event)this.localObserver.on(event,handler,context);else for(let arg of event)this.localObserver.on(arg.event,arg.handler,arg.context)}off(event,handler){if("string"==typeof event)this.localObserver.off(event,handler);else for(let arg of event)this.localObserver.off(arg.event,arg.handler)}notify(property,argument){!0!==this.isDestroyed&&this.localObserver.notify(property,argument)}getInjectedModules(){return this.injectedModules}static Inject(...moduleList){this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(let i=0;i<moduleList.length;i++)-1===this.prototype.injectedModules.indexOf(moduleList[i])&&this.prototype.injectedModules.push(moduleList[i])}injectModules(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)}detectFunction(args){let prop=Object.keys(args);prop.length&&(this[prop[0]]=args[prop[0]])}mergePersistData(){let data=window.localStorage.getItem(this.getModuleName()+this.element.id);isNullOrUndefined(data)||""===data||this.setProperties(JSON.parse(data),!0)}setPersistData(){this.isDestroyed||window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData())}clearTemplate(templateName,index){}getUniqueID(definedName){return this.isHistoryChanged()&&(componentCount=0),lastPageID=this.pageID(location.href),lastHistoryLen=history.length,definedName+"_"+lastPageID+"_"+componentCount++}pageID(url){let hash=0;if(0===url.length)return hash;for(let i=0;i<url.length;i++)hash=(hash<<5)-hash+url.charCodeAt(i),hash&=hash;return Math.abs(hash)}isHistoryChanged(){return lastPageID!==this.pageID(location.href)||lastHistoryLen!==history.length}addOnPersist(options){let persistObj={};for(let key of options){let objValue;isUndefined(objValue=getValue(key,this))||setValue(key,this.getActualProperties(objValue),persistObj)}return JSON.stringify(persistObj,(key,value)=>this.getActualProperties(value))}getActualProperties(obj){return obj instanceof ChildProperty?getValue("properties",obj):obj}ignoreOnPersist(options){return JSON.stringify(this.iterateJsonProperties(this.properties,options))}iterateJsonProperties(obj,ignoreList){let newObj={};for(let key of Object.keys(obj))if(-1===ignoreList.indexOf(key)){let value=obj[key];if("object"!=typeof value||value instanceof Array)newObj[key]=value;else{let newList=ignoreList.filter(str=>new RegExp(key+".").test(str)).map(str=>str.replace(key+".",""));newObj[key]=this.iterateJsonProperties(this.getActualProperties(value),newList)}}return newObj}};return __decorate([Property(!1)],Component.prototype,"enablePersistence",void 0),__decorate([Property()],Component.prototype,"enableRtl",void 0),__decorate([Property()],Component.prototype,"locale",void 0),__decorate([NotifyPropertyChanges],Component)})();var Draggable_1;"undefined"!=typeof window&&window.addEventListener("popstate",()=>{componentCount=0});const defaultPosition={left:0,top:0,bottom:0,right:0};let ej2_base_es2015_Position=(()=>{class Position extends ChildProperty{}return __decorate([Property(0)],Position.prototype,"left",void 0),__decorate([Property(0)],Position.prototype,"top",void 0),Position})(),ej2_base_es2015_Draggable=(()=>{let Draggable=Draggable_1=class extends Base{constructor(element,options){super(options,element),this.dragLimit=Draggable_1.getDefaultPosition(),this.borderWidth=Draggable_1.getDefaultPosition(),this.padding=Draggable_1.getDefaultPosition(),this.diffX=0,this.prevLeft=0,this.prevTop=0,this.dragProcessStarted=!1,this.tapHoldTimer=0,this.externalInitialize=!1,this.diffY=0,this.parentScrollX=0,this.parentScrollY=0,this.droppables={},this.bind()}bind(){this.toggleEvents(),Browser.isIE&&addClass([this.element],"e-block-touch"),this.droppables[this.scope]={}}static getDefaultPosition(){return extend({},defaultPosition)}toggleEvents(isUnWire){let ele;isUndefined(this.handle)||(ele=ej2_base_es2015_select(this.handle,this.element));let handler=this.enableTapHold&&Browser.isDevice&&Browser.isTouch?this.mobileInitialize:this.initialize;isUnWire?EventHandler.remove(ele||this.element,Browser.touchStartEvent,handler):EventHandler.add(ele||this.element,Browser.touchStartEvent,handler,this)}mobileInitialize(evt){let target=evt.currentTarget;this.tapHoldTimer=setTimeout(()=>{this.externalInitialize=!0,this.removeTapholdTimer(),this.initialize(evt,target)},this.tapHoldThreshold),EventHandler.add(document,Browser.touchMoveEvent,this.removeTapholdTimer,this),EventHandler.add(document,Browser.touchEndEvent,this.removeTapholdTimer,this)}removeTapholdTimer(){clearTimeout(this.tapHoldTimer),EventHandler.remove(document,Browser.touchMoveEvent,this.removeTapholdTimer),EventHandler.remove(document,Browser.touchEndEvent,this.removeTapholdTimer)}getScrollableParent(element,axis){return isNullOrUndefined(element)?null:element[{vertical:"scrollHeight",horizontal:"scrollWidth"}[axis]]>element[{vertical:"clientHeight",horizontal:"clientWidth"}[axis]]&&("vertical"===axis?element.scrollTop>0:element.scrollLeft>0)?("vertical"===axis?this.parentScrollY=this.parentScrollY+(0===this.parentScrollY?element.scrollTop:element.scrollTop-this.parentScrollY):this.parentScrollX=this.parentScrollX+(0===this.parentScrollX?element.scrollLeft:element.scrollLeft-this.parentScrollX),isNullOrUndefined(element)?element:this.getScrollableParent(element.parentNode,axis)):this.getScrollableParent(element.parentNode,axis)}getScrollableValues(){this.parentScrollX=0,this.parentScrollY=0,this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal"),this.getScrollableParent(this.element.parentNode,"vertical"),this.getScrollableParent(this.element.parentNode,"horizontal")}initialize(evt,curTarget){if(this.target=evt.currentTarget||curTarget,this.dragProcessStarted=!1,this.abort&&!isNullOrUndefined(closest(evt.target,this.abort)))return;this.preventDefault&&!isUndefined(evt.changedTouches)&&evt.preventDefault(),this.element.setAttribute("aria-grabbed","true");let intCoord=this.getCoordinates(evt);if(this.initialPosition={x:intCoord.pageX,y:intCoord.pageY},!this.clone){let pos=this.element.getBoundingClientRect();this.getScrollableValues(),evt.clientX===evt.pageX&&(this.parentScrollX=0),evt.clientY===evt.pageY&&(this.parentScrollY=0),this.relativeXPosition=intCoord.pageX-(pos.left+this.parentScrollX),this.relativeYPosition=intCoord.pageY-(pos.top+this.parentScrollY)}this.externalInitialize?this.intDragStart(evt):(EventHandler.add(document,Browser.touchMoveEvent,this.intDragStart,this),EventHandler.add(document,Browser.touchEndEvent,this.intDestroy,this)),this.toggleEvents(!0),document.body.classList.add("e-prevent-select"),this.externalInitialize=!1,EventHandler.trigger(document.documentElement,Browser.touchStartEvent,evt)}intDragStart(evt){this.removeTapholdTimer();let isChangeTouch=!isUndefined(evt.changedTouches);if(isChangeTouch&&1!==evt.changedTouches.length)return;isChangeTouch&&evt.preventDefault();let pos,intCordinate=this.getCoordinates(evt),styleProp=getComputedStyle(this.element);this.margin={left:parseInt(styleProp.marginLeft,10),top:parseInt(styleProp.marginTop,10),right:parseInt(styleProp.marginRight,10),bottom:parseInt(styleProp.marginBottom,10)};let element=this.element;if(this.clone&&this.dragTarget){let intClosest=closest(evt.target,this.dragTarget);isNullOrUndefined(intClosest)||(element=intClosest)}this.offset=this.calculateParentPosition(element),this.position=this.getMousePosition(evt);let x=this.initialPosition.x-intCordinate.pageX,y=this.initialPosition.y-intCordinate.pageY;if(Math.sqrt(x*x+y*y)>=this.distance||this.externalInitialize){let ele=this.getHelperElement(evt);if(!ele||isNullOrUndefined(ele))return;let dragTargetElement=this.helperElement=ele;if(this.parentClientRect=this.calculateParentPosition(dragTargetElement.offsetParent),this.dragStart){let args={event:evt,element:element,target:this.getProperTargetElement(evt),bindEvents:isBlazor()?this.bindDragEvents.bind(this):null,dragElement:dragTargetElement};this.trigger("dragStart",args)}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),pos={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top),this.getScrollableValues();let posValue=this.getProcessedPositionValue({top:pos.top-this.diffY+"px",left:pos.left-this.diffX+"px"});setStyleAttribute(dragTargetElement,this.getDragPosition({position:"absolute",left:posValue.left,top:posValue.top})),EventHandler.remove(document,Browser.touchMoveEvent,this.intDragStart),EventHandler.remove(document,Browser.touchEndEvent,this.intDestroy),isBlazor()||this.bindDragEvents(dragTargetElement)}}bindDragEvents(dragTargetElement){isVisible(dragTargetElement)?(EventHandler.add(document,Browser.touchMoveEvent,this.intDrag,this),EventHandler.add(document,Browser.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,dragTargetElement)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))}elementInViewport(el){for(this.top=el.offsetTop,this.left=el.offsetLeft,this.width=el.offsetWidth,this.height=el.offsetHeight;el.offsetParent;)this.top+=(el=el.offsetParent).offsetTop,this.left+=el.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth}getProcessedPositionValue(value){return this.queryPositionInfo?this.queryPositionInfo(value):value}calculateParentPosition(ele){if(isNullOrUndefined(ele))return{left:0,top:0};let rect=ele.getBoundingClientRect(),style=getComputedStyle(ele);return{left:rect.left+window.pageXOffset-parseInt(style.marginLeft,10),top:rect.top+window.pageYOffset-parseInt(style.marginTop,10)}}intDrag(evt){if(!isUndefined(evt.changedTouches)&&1!==evt.changedTouches.length)return;let left,top;this.position=this.getMousePosition(evt);let docHeight=this.getDocumentWidthHeight("Height");docHeight<this.position.top&&(this.position.top=docHeight);let docWidth=this.getDocumentWidthHeight("Width");if(docWidth<this.position.left&&(this.position.left=docWidth),this.drag){let curTarget=this.getProperTargetElement(evt);this.trigger("drag",{event:evt,element:this.element,target:curTarget})}let eleObj=this.checkTargetElement(evt);eleObj.target&&eleObj.instance?(eleObj.instance.dragData[this.scope]=this.droppables[this.scope],eleObj.instance.intOver(evt,eleObj.target),this.hoverObject=eleObj):this.hoverObject&&(this.hoverObject.instance.intOut(evt,eleObj.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null);let helperElement=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);let tLeft=this.parentClientRect.left,tTop=this.parentClientRect.top,intCoord=this.getCoordinates(evt),pagex=intCoord.pageX,pagey=intCoord.pageY,dLeft=this.position.left-this.diffX,dTop=this.position.top-this.diffY;if(this.dragArea){let styles=getComputedStyle(helperElement);if(this.pageX!==pagex||this.skipDistanceCheck){let helperWidth=helperElement.offsetWidth+(parseFloat(styles.marginLeft)+parseFloat(styles.marginRight));left=this.dragLimit.left+window.pageXOffset>dLeft?this.dragLimit.left:this.dragLimit.right+window.pageXOffset<dLeft+helperWidth?dLeft-(dLeft-this.dragLimit.right)+window.pageXOffset-helperWidth:dLeft}if(this.pageY!==pagey||this.skipDistanceCheck){let helperHeight=helperElement.offsetHeight+(parseFloat(styles.marginTop)+parseFloat(styles.marginBottom));top=this.dragLimit.top+window.pageYOffset>dTop?this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<dTop+helperHeight?dTop-(dTop-this.dragLimit.bottom)+window.pageYOffset-helperHeight:dTop}}else left=dLeft,top=dTop;let iTop=tTop+this.borderWidth.top,iLeft=tLeft+this.borderWidth.left;this.dragProcessStarted&&(isNullOrUndefined(top)&&(top=this.prevTop),isNullOrUndefined(left)&&(left=this.prevLeft));let dragValue=this.getProcessedPositionValue({top:top-iTop+"px",left:left-iLeft+"px"});setStyleAttribute(helperElement,this.getDragPosition(dragValue)),!this.elementInViewport(helperElement)&&this.enableAutoScroll&&this.helperElement.scrollIntoView(),this.dragProcessStarted=!0,this.prevLeft=left,this.prevTop=top,this.position.left=left,this.position.top=top,this.pageX=pagex,this.pageY=pagey}getDragPosition(dragValue){let temp=extend({},dragValue);return this.axis&&("x"===this.axis?delete temp.top:"y"===this.axis&&delete temp.left),temp}getDocumentWidthHeight(str){let docBody=document.body,docEle=document.documentElement;return Math.max(docBody["scroll"+str],docEle["scroll"+str],docBody["offset"+str],docEle["offset"+str],docEle["client"+str])}intDragStop(evt){if(this.dragProcessStarted=!1,!isUndefined(evt.changedTouches)&&1!==evt.changedTouches.length)return;if(-1!==["touchend","pointerup","mouseup"].indexOf(evt.type)){if(this.dragStop){let curTarget=this.getProperTargetElement(evt);this.trigger("dragStop",{event:evt,element:this.element,target:curTarget,helper:this.helperElement})}this.intDestroy(evt)}else this.element.setAttribute("aria-grabbed","false");let eleObj=this.checkTargetElement(evt);eleObj.target&&eleObj.instance&&(eleObj.instance.dragStopCalled=!0,eleObj.instance.dragData[this.scope]=this.droppables[this.scope],eleObj.instance.intDrop(evt,eleObj.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}intDestroy(evt){this.dragProcessStarted=!1,this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),EventHandler.remove(document,Browser.touchMoveEvent,this.intDragStart),EventHandler.remove(document,Browser.touchEndEvent,this.intDragStop),EventHandler.remove(document,Browser.touchEndEvent,this.intDestroy),EventHandler.remove(document,Browser.touchMoveEvent,this.intDrag)}onPropertyChanged(newProp,oldProp){}getModuleName(){return"draggable"}setDragArea(){let eleWidthBound,eleHeightBound,ele,top=0,left=0;if(ele="string"==typeof this.dragArea?ej2_base_es2015_select(this.dragArea):this.dragArea){let elementArea=ele.getBoundingClientRect();eleWidthBound=elementArea.width?elementArea.width:elementArea.right-elementArea.left,eleHeightBound=elementArea.height?elementArea.height:elementArea.bottom-elementArea.top;let keys=["Top","Left","Bottom","Right"],styles=getComputedStyle(ele);for(let i=0;i<keys.length;i++){let key=keys[i],tborder=styles["border"+key+"Width"],tpadding=styles["padding"+key],lowerKey=key.toLowerCase();this.borderWidth[lowerKey]=isNaN(parseFloat(tborder))?0:parseFloat(tborder),this.padding[lowerKey]=isNaN(parseFloat(tpadding))?0:parseFloat(tpadding)}top=elementArea.top,this.dragLimit.left=(left=elementArea.left)+this.borderWidth.left+this.padding.left,this.dragLimit.top=top+this.borderWidth.top+this.padding.top,this.dragLimit.right=left+eleWidthBound-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=top+eleHeightBound-(this.borderWidth.bottom+this.padding.bottom)}}getProperTargetElement(evt){let ele,intCoord=this.getCoordinates(evt),prevStyle=this.helperElement.style.pointerEvents||"";return compareElementParent(evt.target,this.helperElement)||-1!==evt.type.indexOf("touch")?(this.helperElement.style.pointerEvents="none",ele=document.elementFromPoint(intCoord.clientX,intCoord.clientY),this.helperElement.style.pointerEvents=prevStyle):ele=evt.target,ele}getMousePosition(evt){let intCoord=this.getCoordinates(evt),pageX=this.clone?intCoord.pageX:intCoord.clientX+window.pageXOffset-this.relativeXPosition,pageY=this.clone?intCoord.pageY:intCoord.clientY+window.pageYOffset-this.relativeYPosition;return{left:pageX-(this.margin.left+this.cursorAt.left),top:pageY-(this.margin.top+this.cursorAt.top)}}getCoordinates(evt){return evt.type.indexOf("touch")>-1?evt.changedTouches[0]:evt}getHelperElement(evt){let element;return this.clone?this.helper?element=this.helper({sender:evt,element:this.target}):(element=ej2_base_es2015_createElement("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(element)):element=this.element,element}setGlobalDroppables(reset,drag,helper){this.droppables[this.scope]=reset?null:{draggable:drag,helper:helper,draggedElement:this.element}}checkTargetElement(evt){let target=this.getProperTargetElement(evt),dropIns=this.getDropInstance(target);if(!dropIns&&target&&!isNullOrUndefined(target.parentNode)){let parent=closest(target.parentNode,".e-droppable")||target.parentElement;parent&&(dropIns=this.getDropInstance(parent))}return{target:target,instance:dropIns}}getDropInstance(ele){let drop,eleInst=ele&&ele.ej2_instances;if(eleInst)for(let inst of eleInst)if("droppable"===inst.getModuleName()){drop=inst;break}return drop}destroy(){this.toggleEvents(!0),super.destroy()}};return __decorate([Complex({},ej2_base_es2015_Position)],Draggable.prototype,"cursorAt",void 0),__decorate([Property(!0)],Draggable.prototype,"clone",void 0),__decorate([Property()],Draggable.prototype,"dragArea",void 0),__decorate([ej2_base_es2015_Event()],Draggable.prototype,"drag",void 0),__decorate([ej2_base_es2015_Event()],Draggable.prototype,"dragStart",void 0),__decorate([ej2_base_es2015_Event()],Draggable.prototype,"dragStop",void 0),__decorate([Property(1)],Draggable.prototype,"distance",void 0),__decorate([Property()],Draggable.prototype,"handle",void 0),__decorate([Property()],Draggable.prototype,"abort",void 0),__decorate([Property()],Draggable.prototype,"helper",void 0),__decorate([Property("default")],Draggable.prototype,"scope",void 0),__decorate([Property("")],Draggable.prototype,"dragTarget",void 0),__decorate([Property()],Draggable.prototype,"axis",void 0),__decorate([Property()],Draggable.prototype,"queryPositionInfo",void 0),__decorate([Property(!1)],Draggable.prototype,"enableTailMode",void 0),__decorate([Property(!1)],Draggable.prototype,"skipDistanceCheck",void 0),__decorate([Property(!0)],Draggable.prototype,"preventDefault",void 0),__decorate([Property(!1)],Draggable.prototype,"enableAutoScroll",void 0),__decorate([Property(!1)],Draggable.prototype,"enableTapHold",void 0),__decorate([Property(750)],Draggable.prototype,"tapHoldThreshold",void 0),Draggable_1=__decorate([NotifyPropertyChanges],Draggable)})(),ej2_base_es2015_Droppable=(()=>{let Droppable=class extends Base{constructor(element,options){super(options,element),this.mouseOver=!1,this.dragData={},this.dragStopCalled=!1,this.bind()}bind(){this.wireEvents()}wireEvents(){EventHandler.add(this.element,Browser.touchEndEvent,this.intDrop,this)}onPropertyChanged(newProp,oldProp){}getModuleName(){return"droppable"}intOver(event,element){this.mouseOver||(this.trigger("over",{event:event,target:element,dragData:this.dragData[this.scope]}),this.mouseOver=!0)}intOut(event,element){this.mouseOver&&(this.trigger("out",{evt:event,target:element}),this.mouseOver=!1)}intDrop(evt,element){if(!this.dragStopCalled)return;this.dragStopCalled=!1;let area,accept=!0,drag=this.dragData[this.scope],isDrag=!!drag&&drag.helper&&isVisible(drag.helper);isDrag&&(area=this.isDropArea(evt,drag.helper,element),this.accept&&(accept=matches(drag.helper,this.accept))),isDrag&&this.drop&&area.canDrop&&accept&&this.trigger("drop",{event:evt,target:area.target,droppedElement:drag.helper,dragData:drag}),this.mouseOver=!1}isDropArea(evt,helper,element){let area={canDrop:!0,target:element||evt.target},isTouch="touchend"===evt.type;if(isTouch||area.target===helper){helper.style.display="none";let coord=isTouch?evt.changedTouches[0]:evt,ele=document.elementFromPoint(coord.clientX,coord.clientY);area.canDrop=!1,area.canDrop=compareElementParent(ele,this.element),area.canDrop&&(area.target=ele),helper.style.display=""}return area}destroy(){EventHandler.remove(this.element,Browser.touchEndEvent,this.intDrop),super.destroy()}};return __decorate([Property()],Droppable.prototype,"accept",void 0),__decorate([Property("default")],Droppable.prototype,"scope",void 0),__decorate([ej2_base_es2015_Event()],Droppable.prototype,"drop",void 0),__decorate([ej2_base_es2015_Event()],Droppable.prototype,"over",void 0),__decorate([ej2_base_es2015_Event()],Droppable.prototype,"out",void 0),__decorate([NotifyPropertyChanges],Droppable)})();var KeyboardEvents_1;let ej2_base_es2015_keyCode={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},ej2_base_es2015_KeyboardEvents=(()=>{let KeyboardEvents=KeyboardEvents_1=class extends Base{constructor(element,options){super(options,element),this.keyPressHandler=e=>{let isAltKey=e.altKey,isCtrlKey=e.ctrlKey,isShiftKey=e.shiftKey,curkeyCode=e.which,keys=Object.keys(this.keyConfigs);for(let key of keys){let configCollection=this.keyConfigs[key].split(",");for(let rconfig of configCollection){let rKeyObj=KeyboardEvents_1.getKeyConfigData(rconfig.trim());isAltKey===rKeyObj.altKey&&isCtrlKey===rKeyObj.ctrlKey&&isShiftKey===rKeyObj.shiftKey&&curkeyCode===rKeyObj.keyCode&&(e.action=key,this.keyAction&&this.keyAction(e))}}},this.bind()}destroy(){this.unwireEvents(),super.destroy()}onPropertyChanged(newProp,oldProp){}bind(){this.wireEvents()}getModuleName(){return"keyboard"}wireEvents(){this.element.addEventListener(this.eventName,this.keyPressHandler)}unwireEvents(){this.element.removeEventListener(this.eventName,this.keyPressHandler)}static getKeyConfigData(config){if(config in this.configCache)return this.configCache[config];let keys=config.toLowerCase().split("+"),keyData={altKey:-1!==keys.indexOf("alt"),ctrlKey:-1!==keys.indexOf("ctrl"),shiftKey:-1!==keys.indexOf("shift"),keyCode:null};return keyData.keyCode=keys[keys.length-1].length>1&&Number(keys[keys.length-1])?Number(keys[keys.length-1]):KeyboardEvents_1.getKeyCode(keys[keys.length-1]),KeyboardEvents_1.configCache[config]=keyData,keyData}static getKeyCode(keyVal){return ej2_base_es2015_keyCode[keyVal]||keyVal.toUpperCase().charCodeAt(0)}};return KeyboardEvents.configCache={},__decorate([Property({})],KeyboardEvents.prototype,"keyConfigs",void 0),__decorate([Property("keyup")],KeyboardEvents.prototype,"eventName",void 0),__decorate([ej2_base_es2015_Event()],KeyboardEvents.prototype,"keyAction",void 0),KeyboardEvents_1=__decorate([NotifyPropertyChanges],KeyboardEvents)})(),L10n=(()=>{class L10n{constructor(controlName,localeStrings,locale){this.controlName=controlName,this.localeStrings=localeStrings,this.setLocale(locale||defaultCulture)}setLocale(locale){let intLocale=this.intGetControlConstant(L10n.locale,locale);this.currentLocale=intLocale||this.localeStrings}static load(localeObject){this.locale=extend(this.locale,localeObject,{},!0)}getConstant(prop){return isNullOrUndefined(this.currentLocale[prop])?this.localeStrings[prop]||"":this.currentLocale[prop]}intGetControlConstant(curObject,locale){return curObject[locale]?curObject[locale][this.controlName]:null}}return L10n.locale={},L10n})(),ej2_base_es2015_SwipeSettings=(()=>{class SwipeSettings extends ChildProperty{}return __decorate([Property(50)],SwipeSettings.prototype,"swipeThresholdDistance",void 0),SwipeSettings})();const swipeRegex=/(Up|Down)/;let ej2_base_es2015_Touch=(()=>{let Touch=class extends Base{constructor(element,options){super(options,element),this.touchAction=!0,this.tapCount=0,this.startEvent=evt=>{if(!0===this.touchAction){let point=evt.changedTouches?evt.changedTouches[0]:evt;void 0!==evt.changedTouches&&(this.touchAction=!1),this.isTouchMoved=!1,this.movedDirection="",this.startPoint=this.lastMovedPoint={clientX:point.clientX,clientY:point.clientY},this.startEventData=point,this.hScrollLocked=this.vScrollLocked=!1,this.tStampStart=Date.now(),this.timeOutTapHold=setTimeout(()=>{this.tapHoldEvent(evt)},this.tapHoldThreshold),EventHandler.add(this.element,Browser.touchMoveEvent,this.moveEvent,this),EventHandler.add(this.element,Browser.touchEndEvent,this.endEvent,this),EventHandler.add(this.element,Browser.touchCancelEvent,this.cancelEvent,this)}},this.moveEvent=evt=>{let point=evt.changedTouches?evt.changedTouches[0]:evt;this.movedPoint=point,this.isTouchMoved=!(point.clientX===this.startPoint.clientX&&point.clientY===this.startPoint.clientY);let eScrollArgs={};this.isTouchMoved&&(clearTimeout(this.timeOutTapHold),this.calcScrollPoints(evt),eScrollArgs=extend(eScrollArgs,{},{startEvents:this.startEventData,originalEvent:evt,startX:this.startPoint.clientX,startY:this.startPoint.clientY,distanceX:this.distanceX,distanceY:this.distanceY,scrollDirection:this.scrollDirection,velocity:this.getVelocity(point)}),this.trigger("scroll",eScrollArgs),this.lastMovedPoint={clientX:point.clientX,clientY:point.clientY})},this.cancelEvent=evt=>{clearTimeout(this.timeOutTapHold),clearTimeout(this.timeOutTap),this.tapCount=0,this.swipeFn(evt),EventHandler.remove(this.element,Browser.touchCancelEvent,this.cancelEvent)},this.endEvent=evt=>{this.swipeFn(evt),this.isTouchMoved||"function"==typeof this.tap&&(this.trigger("tap",{originalEvent:evt,tapCount:++this.tapCount}),this.timeOutTap=setTimeout(()=>{this.tapCount=0},this.tapThreshold)),this.modeclear()},this.swipeFn=evt=>{clearTimeout(this.timeOutTapHold),clearTimeout(this.timeOutTap);let point=evt;evt.changedTouches&&(point=evt.changedTouches[0]);let diffX=point.clientX-this.startPoint.clientX,diffY=point.clientY-this.startPoint.clientY;diffX=Math.floor(diffX<0?-1*diffX:diffX),diffY=Math.floor(diffY<0?-1*diffY:diffX),this.isTouchMoved=diffX>1||diffY>1,this.endPoint=point,this.calcPoints(evt);let swipeArgs={originalEvent:evt,startEvents:this.startEventData,startX:this.startPoint.clientX,startY:this.startPoint.clientY,distanceX:this.distanceX,distanceY:this.distanceY,swipeDirection:this.movedDirection,velocity:this.getVelocity(point)};if(this.isTouchMoved){let eSwipeArgs,tDistance=this.swipeSettings.swipeThresholdDistance;eSwipeArgs=extend(eSwipeArgs,this.defaultArgs,swipeArgs);let canTrigger=!1,ele=this.element,scrollBool=this.isScrollable(ele),moved=swipeRegex.test(this.movedDirection);(tDistance<this.distanceX&&!moved||tDistance<this.distanceY&&moved)&&(canTrigger=!scrollBool||this.checkSwipe(ele,moved)),canTrigger&&this.trigger("swipe",eSwipeArgs)}this.modeclear()},this.modeclear=()=>{this.modeClear=setTimeout(()=>{this.touchAction=!0},"function"!=typeof this.tap?0:20),this.lastTapTime=(new Date).getTime(),EventHandler.remove(this.element,Browser.touchMoveEvent,this.moveEvent),EventHandler.remove(this.element,Browser.touchEndEvent,this.endEvent),EventHandler.remove(this.element,Browser.touchCancelEvent,this.cancelEvent)},this.bind()}onPropertyChanged(newProp,oldProp){}bind(){this.wireEvents(),Browser.isIE&&this.element.classList.add("e-block-touch")}destroy(){this.unwireEvents(),super.destroy()}wireEvents(){EventHandler.add(this.element,Browser.touchStartEvent,this.startEvent,this)}unwireEvents(){EventHandler.remove(this.element,Browser.touchStartEvent,this.startEvent)}getModuleName(){return"touch"}isScrollable(element){let eleStyle=getComputedStyle(element);return!!/(auto|scroll)/.test(eleStyle.overflow+eleStyle.overflowX+eleStyle.overflowY)}tapHoldEvent(evt){let eTapArgs;this.tapCount=0,this.touchAction=!0,EventHandler.remove(this.element,Browser.touchMoveEvent,this.moveEvent),EventHandler.remove(this.element,Browser.touchEndEvent,this.endEvent),this.trigger("tapHold",eTapArgs={originalEvent:evt}),EventHandler.remove(this.element,Browser.touchCancelEvent,this.cancelEvent)}calcPoints(evt){let point=evt.changedTouches?evt.changedTouches[0]:evt;this.defaultArgs={originalEvent:evt},this.distanceX=Math.abs(Math.abs(point.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(point.clientY)-Math.abs(this.startPoint.clientY)),this.movedDirection=this.distanceX>this.distanceY?point.clientX>this.startPoint.clientX?"Right":"Left":point.clientY<this.startPoint.clientY?"Up":"Down"}calcScrollPoints(evt){let point=evt.changedTouches?evt.changedTouches[0]:evt;this.defaultArgs={originalEvent:evt},this.distanceX=Math.abs(Math.abs(point.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(point.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||!0===this.hScrollLocked)&&!1===this.vScrollLocked?(this.scrollDirection=point.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=point.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)}getVelocity(pnt){let newX=pnt.clientX,newY=pnt.clientY,newT=Date.now(),xDist=newX-this.startPoint.clientX,yDist=newY-this.startPoint.clientX,interval=newT-this.tStampStart;return Math.sqrt(xDist*xDist+yDist*yDist)/interval}checkSwipe(ele,flag){let keys=["scroll","offset"],temp=flag?["Height","Top"]:["Width","Left"];return ele[keys[0]+temp[0]]<=ele[keys[1]+temp[0]]||0===ele[keys[0]+temp[1]]||ele[keys[1]+temp[0]]+ele[keys[0]+temp[1]]>=ele[keys[0]+temp[0]]}};return __decorate([ej2_base_es2015_Event()],Touch.prototype,"tap",void 0),__decorate([ej2_base_es2015_Event()],Touch.prototype,"tapHold",void 0),__decorate([ej2_base_es2015_Event()],Touch.prototype,"swipe",void 0),__decorate([ej2_base_es2015_Event()],Touch.prototype,"scroll",void 0),__decorate([Property(350)],Touch.prototype,"tapThreshold",void 0),__decorate([Property(750)],Touch.prototype,"tapHoldThreshold",void 0),__decorate([Complex({},ej2_base_es2015_SwipeSettings)],Touch.prototype,"swipeSettings",void 0),__decorate([NotifyPropertyChanges],Touch)})();const LINES=new RegExp("\\n|\\r|\\s\\s+","g"),QUOTES=new RegExp(/'|"/g),IF_STMT=new RegExp("if ?\\("),ELSEIF_STMT=new RegExp("else if ?\\("),ELSE_STMT=new RegExp("else"),FOR_STMT=new RegExp("for ?\\("),IF_OR_FOR=new RegExp("(/if|/for)"),CALL_FUNCTION=new RegExp("\\((.*)\\)",""),NOT_NUMBER=new RegExp("^[0-9]+$","g"),WORD=new RegExp("[\\w\"'.\\s+]+","g"),DBL_QUOTED_STR=new RegExp('"(.*?)"',"g"),WORDIF=new RegExp("[\\w\"'@#$.\\s+]+","g");let ej2_base_es2015_exp=new RegExp("\\${([^}]*)}","g"),ARR_OBJ=/^\..*/gm,SINGLE_SLASH=/\\/gi,DOUBLE_SLASH=/\\\\/gi;function addNameSpace(str,addNS,nameSpace,ignoreList){return addNS&&!NOT_NUMBER.test(str)&&-1===ignoreList.indexOf(str.split(".")[0])?nameSpace+"."+str:str}function NameSpaceForspecialChar(str,addNS,nameSpace,ignoreList){return addNS&&!NOT_NUMBER.test(str)&&-1===ignoreList.indexOf(str.split(".")[0])?nameSpace+'["'+str:str}function SlashReplace(tempStr){return tempStr.match(DOUBLE_SLASH)?tempStr:tempStr.replace(SINGLE_SLASH,"\\\\")}const HAS_ROW=/^[\n\r.]+\<tr|^\<tr/,HAS_SVG=/^[\n\r.]+\<svg|^\<path|^\<g/;let blazorTemplates={};function compile$$1(templateString,helper){let compiler=engineObj.compile(templateString,helper);return(data,component,propName,templateId,isStringTemplate,index)=>{let result=compiler(data,component,propName);if(window&&window.Blazor&&!isStringTemplate){let blazorId=templateId+"-"+Math.random().toString(36).substr(2,5);if(blazorTemplates[templateId]||(blazorTemplates[templateId]=[]),isNullOrUndefined(index))data.BlazorTemplateId=blazorId,blazorTemplates[templateId].push(data);else{let keys=Object.keys(blazorTemplates[templateId][index]);for(let key of keys)"BlazorTemplateId"!==key&&data[key]&&(blazorTemplates[templateId][index][key]=data[key]),"BlazorTemplateId"===key&&(blazorId=blazorTemplates[templateId][index][key])}return"rowTemplate"===propName?[ej2_base_es2015_createElement("tr",{id:blazorId,className:"e-blazor-template"})]:[ej2_base_es2015_createElement("div",{id:blazorId,className:"e-blazor-template"})]}return"string"==typeof result?HAS_SVG.test(result)?ej2_base_es2015_createElement("svg",{innerHTML:result}).childNodes:ej2_base_es2015_createElement(HAS_ROW.test(result)?"table":"div",{innerHTML:result}).childNodes:result}}function updateBlazorTemplate(templateId,templateName,comp,isEmpty,callBack){window&&window.Blazor&&(window.ejsInterop.updateTemplate(templateName,blazorTemplates[templateId],templateId,comp,callBack),!1!==isEmpty&&(blazorTemplates[templateId]=[]))}function resetBlazorTemplate(templateId,templateName,index){let templateDiv=document.getElementById(templateId);if(templateDiv){let innerTemplates=templateDiv.getElementsByClassName("blazor-inner-template");for(let i=0;i<innerTemplates.length;i++){let tempId=" ";tempId=isNullOrUndefined(index)?innerTemplates[i].getAttribute("data-templateId"):innerTemplates[index].getAttribute("data-templateId");let tempElement=document.getElementById(tempId);if(tempElement){let length=tempElement.childNodes.length;for(let j=0;j<length;j++)isNullOrUndefined(index)?innerTemplates[i].appendChild(tempElement.childNodes[0]):(innerTemplates[index].appendChild(tempElement.childNodes[0]),i=innerTemplates.length)}}}}let engineObj={compile:(new class{compile(templateString,helper={}){return function(template,helper){let evalExpResult=function(str,nameSpace,helper){let varCOunt=0,localKeys=[],isClass=str.match(/class="([^\"]+|)\s{2}/g),singleSpace="";return isClass&&isClass.forEach(value=>{singleSpace=value.replace(/\s\s+/g," "),str=str.replace(value,singleSpace)}),str.replace(LINES,"").replace(DBL_QUOTED_STR,"'$1'").replace(ej2_base_es2015_exp,(match,cnt,offset,matchStr)=>{let matches=cnt.match(CALL_FUNCTION);if(matches){let rlStr=matches[1];if(ELSEIF_STMT.test(cnt))cnt='";} '+cnt.replace(matches[1],rlStr.replace(WORD,str=>addNameSpace(str=str.trim(),!QUOTES.test(str)&&-1===localKeys.indexOf(str),"data",localKeys)))+'{ \n str = str + "';else if(IF_STMT.test(cnt))cnt='"; '+cnt.replace(matches[1],rlStr.replace(WORDIF,strs=>(strs=strs.trim(),/\@|\$|\#/gm.test(strs)&&(strs=NameSpaceForspecialChar(strs,-1===localKeys.indexOf(strs),"data",localKeys)+'"]'),ARR_OBJ.test(strs)?function(str,addNS,nameSpace,ignoreList){return!addNS||NOT_NUMBER.test(str)||-1!==ignoreList.indexOf(str.split(".")[0])||/^\..*/gm.test(str)?str:"data."+str}(strs,!QUOTES.test(strs)&&-1===localKeys.indexOf(strs),0,localKeys):addNameSpace(strs,!QUOTES.test(strs)&&-1===localKeys.indexOf(strs),"data",localKeys))))+'{ \n str = str + "';else if(FOR_STMT.test(cnt)){let rlStr=matches[1].split(" of ");cnt='"; '+cnt.replace(matches[1],mtc=>(localKeys.push(rlStr[0]),localKeys.push(rlStr[0]+"Index"),"var i"+(varCOunt+=1)+"=0; i"+varCOunt+" < "+addNameSpace(rlStr[1],!0,"data",localKeys)+".length; i"+varCOunt+"++"))+"{ \n "+rlStr[0]+"= "+addNameSpace(rlStr[1],!0,"data",localKeys)+"[i"+varCOunt+"]; \n var "+rlStr[0]+"Index=i"+varCOunt+'; \n str = str + "'}else{let fnStr=cnt.split("("),fNameSpace=helper&&helper.hasOwnProperty(fnStr[0])?"this.":"global";fNameSpace=/\./.test(fnStr[0])?"":fNameSpace;let ftArray=matches[1].split(",");0===matches[1].length||/data/.test(ftArray[0])||/window./.test(ftArray[0])||(matches[1]="global"===fNameSpace?"data."+matches[1]:matches[1]),cnt='" + '+("global"===fNameSpace?"":fNameSpace)+cnt.replace(rlStr,addNameSpace(matches[1].replace(/,( |)data.|,/gi,",data.").replace(/,( |)data.window/gi,",window"),"global"!==fNameSpace,"data",localKeys))+'+"'}}else ELSE_STMT.test(cnt)?cnt='"; '+cnt.replace(ELSE_STMT,'} else { \n str = str + "'):cnt.match(IF_OR_FOR)?cnt=cnt.replace(IF_OR_FOR,'"; \n } \n str = str + "'):/\@|\#|\$/gm.test(cnt)?(cnt.match(SINGLE_SLASH)&&(cnt=SlashReplace(cnt)),cnt='"+'+NameSpaceForspecialChar(cnt,-1===localKeys.indexOf(cnt),"data",localKeys)+'"]+"'):cnt=cnt.match(SINGLE_SLASH)?'"+'+NameSpaceForspecialChar(cnt=SlashReplace(cnt),-1===localKeys.indexOf(cnt),"data",localKeys)+'"]+"':'"+'+addNameSpace(cnt.replace(/\,/gi,"+data."),-1===localKeys.indexOf(cnt),"data",localKeys)+'+"';return cnt})}(templateString,0,helper);return new Function("data",`var str="${evalExpResult}"; return str;`).bind(helper)}(0,helper)}}).compile};function ComponentMixins(baseClass){return function(derivedClass){!function(derivedClass,baseClass){baseClass.forEach(function(baseClass){Object.getOwnPropertyNames(baseClass.prototype).forEach(function(name){derivedClass.prototype[name]=baseClass.prototype[name]})})}(derivedClass,baseClass)}}function util_setValue(nameSpace,value,object){for(var keys=nameSpace.replace(/\[/g,".").replace(/\]/g,"").split("."),fromObj=object||{},i=0;i<keys.length;i++){var key=keys[i];i+1===keys.length?fromObj[key]=void 0===value?{}:value:void 0===fromObj[key]&&(fromObj[key]={}),fromObj=fromObj[key]}return fromObj}var component_base_ComponentBase=function(){function ComponentBase(){this.isProtectedOnChange=!0}return ComponentBase.prototype.saveChanges=function(key,newValue,oldValue){if(!this.isProtectedOnChange){this.oldProperties[key]=oldValue,this.changedProperties[key]=newValue,this.finalUpdate();var changeTime=setTimeout(this.dataBind.bind(this));this.finalUpdate=function(){clearTimeout(changeTime)}}},ComponentBase.prototype.ngOnInit=function(){var _this=this;this.registeredTemplate={},this.ngBoundedEvents={},this.isAngular=!0,this.tags=this.tags||[],this.complexTemplate=this.complexTemplate||[],this.tagObjects=[],this.ngAttr=this.getAngularAttr(this.element),this.createElement=function(tagName,prop){var ele=_this.srenderer?_this.srenderer.createElement(tagName):ej2_base_es2015_createElement(tagName);return void 0===prop?ele:(ele.innerHTML=prop.innerHTML?prop.innerHTML:"",void 0!==prop.className&&(ele.className=prop.className),void 0!==prop.id&&(ele.id=prop.id),void 0!==prop.styles&&ele.setAttribute("style",prop.styles),void 0!==_this.ngAttr&&ele.setAttribute(_this.ngAttr,""),void 0!==prop.attrs&&attributes(ele,prop.attrs),ele)};for(var _i=0,_a=this.tags;_i<_a.length;_i++){var tag=_a[_i],tagObject={instance:getValue("child"+tag.substring(0,1).toUpperCase()+tag.substring(1),this),name:tag};this.tagObjects.push(tagObject)}for(var complexTemplates=Object.keys(this),_b=0,complexTemplates_1=complexTemplates=complexTemplates.filter(function(val){return/Ref$/i.test(val)&&/\_/i.test(val)});_b<complexTemplates_1.length;_b++){var propName=complexTemplates_1[_b].replace("Ref",""),val={};setValue(propName.replace("_","."),getValue(propName,this),val),this.setProperties(val,!0)}},ComponentBase.prototype.getAngularAttr=function(ele){for(var ngAr,attributes=ele.attributes,length=attributes.length,i=0;i<length;i++)/_ngcontent/g.test(attributes[i].name)&&(ngAr=attributes[i].name);return ngAr},ComponentBase.prototype.ngAfterViewInit=function(){var _this=this;setTimeout(function(){"undefined"!=typeof window&&_this.appendTo(_this.element)})},ComponentBase.prototype.ngOnDestroy=function(){"undefined"!=typeof window&&this.element.classList.contains("e-control")&&(this.destroy(),this.clearTemplate(null))},ComponentBase.prototype.clearTemplate=function(templateNames,index){!function(_this,templateNames,index){var regTemplates=Object.keys(_this.registeredTemplate);if(regTemplates.length)for(var regProperties=templateNames&&templateNames.filter(function(val){return!/\./g.test(val)}),_i=0,_a=regProperties&&regProperties||regTemplates;_i<_a.length;_i++){var registeredTemplate=_a[_i];if(index&&index.length)for(var e=0;e<index.length;e++)for(var m=0;m<_this.registeredTemplate.template.length;m++)_this.registeredTemplate.template[m].rootNodes[0]===index[e]&&(rt=_this.registeredTemplate[registeredTemplate])[m].destroy();else for(var _b=0,_c=_this.registeredTemplate[registeredTemplate];_b<_c.length;_b++){var rt;if(!(rt=_c[_b]).destroyed){var pNode=rt._view.renderer.parentNode(rt.rootNodes[0]);for(m=0;m<rt.rootNodes.length;m++)pNode.appendChild(rt.rootNodes[m]);rt.destroy()}}delete _this.registeredTemplate[registeredTemplate]}for(var _loop_1=function(tagObject){tagObject.instance&&tagObject.instance.clearTemplate(templateNames&&templateNames.filter(function(val){return!!new RegExp(tagObject.name).test(val)}))},_d=0,_e=_this.tagObjects;_d<_e.length;_d++)_loop_1(_e[_d])}(this,templateNames,index)},ComponentBase.prototype.ngAfterContentChecked=function(){for(var _i=0,_a=this.tagObjects;_i<_a.length;_i++){var tagObject=_a[_i];if(!isUndefined(tagObject.instance)&&(tagObject.instance.isInitChanges||tagObject.instance.hasChanges||tagObject.instance.hasNewChildren))if(tagObject.instance.isInitChanges){var propObj={};propObj[tagObject.name]=tagObject.instance.getProperties(),this.setProperties(propObj,tagObject.instance.isInitChanges)}else for(var _b=0,_c=tagObject.instance.list;_b<_c.length;_b++){var list=_c[_b];if(list.hasChanges){var curIndex=tagObject.instance.list.indexOf(list),curChild=getValue(tagObject.name,this)[curIndex];void 0!==curChild&&void 0!==curChild.setProperties&&curChild.setProperties(list.getProperties()),list.isUpdated=!0}}}},ComponentBase.prototype.registerEvents=function(eventList){!function(eventList,obj,direct){var ngEventsEmitter={};if(eventList&&eventList.length){for(var _i=0,eventList_1=eventList;_i<eventList_1.length;_i++){var event_1=eventList_1[_i];ngEventsEmitter[event_1]=new core_EventEmitter(!1)}obj.setProperties(ngEventsEmitter,!0)}}(eventList,this)},ComponentBase.prototype.twoWaySetter=function(newVal,prop){var oldVal=getValue(prop,this.properties);oldVal!==newVal&&(this.saveChanges(prop,newVal,oldVal),setValue(prop,isNullOrUndefined(newVal)?null:newVal,this.properties),getValue(prop+"Change",this).emit(newVal))},ComponentBase.prototype.addTwoWay=function(propList){for(var _this=this,_loop_1=function(prop){getValue(prop,this_1),Object.defineProperty(this_1,prop,{get:function(){return getValue(prop,_this.properties)},set:function(newVal){return _this.twoWaySetter(newVal,prop)}}),setValue(prop+"Change",new core_EventEmitter,this_1)},this_1=this,_i=0,propList_1=propList;_i<propList_1.length;_i++)_loop_1(propList_1[_i])},ComponentBase.prototype.addEventListener=function(eventName,handler){var eventObj=getValue(eventName,this);isUndefined(eventObj)||(this.ngBoundedEvents[eventName]||(this.ngBoundedEvents[eventName]=new Map),this.ngBoundedEvents[eventName].set(handler,eventObj.subscribe(handler)))},ComponentBase.prototype.removeEventListener=function(eventName,handler){isUndefined(getValue(eventName,this))||this.ngBoundedEvents[eventName].get(handler).unsubscribe()},ComponentBase.prototype.trigger=function(eventName,eventArgs,success){var eventObj=getValue(eventName,this),prevDetection=this.isProtectedOnChange;this.isProtectedOnChange=!1,eventArgs&&(eventArgs.name=eventName),isUndefined(eventObj)||eventObj.next(eventArgs);var localEventObj=getValue("local"+eventName.charAt(0).toUpperCase()+eventName.slice(1),this);isUndefined(localEventObj)||localEventObj.call(this,eventArgs),this.isProtectedOnChange=prevDetection,success&&success.call(this,eventArgs)},ComponentBase}(),form_base_FormBase=function(){function FormBase(){}return FormBase.prototype.propagateChange=function(_){},FormBase.prototype.propagateTouch=function(){},FormBase.prototype.localChange=function(e){var value=void 0===e.checked?e.value:e.checked;this.objCheck=ej2_base_es2015_isObject(value),!0===this.objCheck?(this.duplicateValue=JSON.stringify(value),this.duplicateAngularValue=JSON.stringify(this.angularValue),this.duplicateValue!==this.duplicateAngularValue&&void 0!==this.propagateChange&&void 0!==value&&(this.propagateChange(value),this.angularValue=value)):value!==this.angularValue&&void 0!==this.propagateChange&&void 0!==value&&(this.propagateChange(value),this.angularValue=value)},FormBase.prototype.registerOnChange=function(registerFunction){this.propagateChange=registerFunction},FormBase.prototype.registerOnTouched=function(registerFunction){this.propagateTouch=registerFunction},FormBase.prototype.twoWaySetter=function(newVal,prop){var oldVal=getValue(prop,this.properties),ele=this.inputElement||this.element;(oldVal!==newVal||void 0!==ele.value&&""!==ele.value)&&(this.saveChanges(prop,newVal,oldVal),setValue(prop,isNullOrUndefined(newVal)?null:newVal,this.properties),getValue(prop+"Change",this).emit(newVal))},FormBase.prototype.ngAfterViewInit=function(){if("undefined"!=typeof window){this.appendTo(this.element);var ele=this.inputElement||this.element;ele.addEventListener("focus",this.ngOnFocus.bind(this)),ele.addEventListener("blur",this.ngOnBlur.bind(this))}},FormBase.prototype.setDisabledState=function(disabled){this.enabled=!disabled,this.disabled=disabled},FormBase.prototype.writeValue=function(value){void 0===this.checked?this.value=value:this.checked="boolean"==typeof value?value:value===this.value,null!==value&&(this.angularValue=value,this.preventChange=!0)},FormBase.prototype.ngOnFocus=function(e){!0!==this.skipFromEvent&&this.focus.emit(e)},FormBase.prototype.ngOnBlur=function(e){this.propagateTouch(),!0!==this.skipFromEvent&&this.blur.emit(e)},FormBase}(),stringCompiler=engineObj.compile;function Template(defaultValue){return function(target,key){var propertyDescriptor={set:setter(key),get:getter(key,defaultValue),enumerable:!0,configurable:!0};Object.defineProperty(target,key,propertyDescriptor)}}function setter(key){return function(val){void 0!==val&&(setValue(key+"Ref",val,this),"string"!=typeof val?(val.elementRef.nativeElement._viewContainerRef=this.viewContainerRef,val.elementRef.nativeElement.propName=key):this.saveChanges&&(this.saveChanges(key,val,void 0),this.dataBind()))}}function getter(key,defaultValue){return function(){return getValue(key+"Ref",this)||defaultValue}}function wrapperInitialize(createElement,tag,type,element,WRAPPER,role){let input=element;if(element.tagName===tag){let ejInstance=getValue("ej2_instances",element);input=createElement("input",{attrs:{type:type}});let props=["change","cssClass","label","labelPosition","id"];for(let index=0,len=element.attributes.length;index<len;index++)-1===props.indexOf(element.attributes[index].nodeName)&&input.setAttribute(element.attributes[index].nodeName,element.attributes[index].nodeValue);attributes(element,{class:WRAPPER,role:role,"aria-checked":"false"}),element.appendChild(input),setValue("ej2_instances",ejInstance,input),deleteObject(element,"ej2_instances")}return input}function getTextNode(element){let node,childnode=element.childNodes;for(let i=0;i<childnode.length;i++)if(3===(node=childnode[i]).nodeType)return node;return null}function createCheckBox(createElement,enableRipple=!1,options={}){let wrapper=createElement("div",{className:"e-checkbox-wrapper e-css"});if(options.cssClass&&addClass([wrapper],options.cssClass.split(" ")),options.enableRtl&&wrapper.classList.add("e-rtl"),enableRipple){let rippleSpan=createElement("span",{className:"e-ripple-container"});rippleEffect(rippleSpan,{isCenterRipple:!0,duration:400}),wrapper.appendChild(rippleSpan)}let frameSpan=createElement("span",{className:"e-frame e-icons"});if(options.checked&&frameSpan.classList.add("e-check"),wrapper.appendChild(frameSpan),options.label){let labelSpan=createElement("span",{className:"e-label",innerHTML:options.label});wrapper.appendChild(labelSpan)}return wrapper}function rippleMouseHandler(e,rippleSpan){if(rippleSpan){let event=document.createEvent("MouseEvents");event.initEvent(e.type,!1,!0),rippleSpan.dispatchEvent(event)}}engineObj.compile=function(templateEle,helper){if("string"==typeof templateEle)return stringCompiler(templateEle,helper);var contRef_1=templateEle.elementRef.nativeElement._viewContainerRef,pName_1=templateEle.elementRef.nativeElement.propName;return function(data,component,propName){var conRef=contRef_1||component.viewContainerRef,viewRef=conRef.createEmbeddedView(templateEle,{$implicit:data});viewRef.markForCheck();var viewCollection=component?component.registeredTemplate:getValue("currentInstance.registeredTemplate",conRef);return void 0===viewCollection[propName=propName||pName_1]&&(viewCollection[propName]=[]),viewCollection[propName].push(viewRef),viewRef.rootNodes}};let ej2_buttons_es2015_Button=(()=>{let Button=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}preRender(){}render(){this.initialize(),this.renderComplete()}initialize(){this.cssClass&&addClass([this.element],this.cssClass.split(" ")),this.isPrimary&&this.element.classList.add("e-primary"),this.content&&(this.element.innerHTML=this.content),this.setIconCss(),this.enableRtl&&this.element.classList.add("e-rtl"),this.disabled?this.controlStatus(this.disabled):this.wireEvents(),this.removeRippleEffect=rippleEffect(this.element,{selector:".e-btn"})}controlStatus(disabled){this.element.disabled=disabled}setIconCss(){if(this.iconCss){let span=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(span.classList.add("e-icon-"+this.iconPosition.toLowerCase()),"Top"!==this.iconPosition&&"Bottom"!==this.iconPosition||this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add("e-icon-btn");let node=this.element.childNodes[0];!node||"Left"!==this.iconPosition&&"Top"!==this.iconPosition?this.element.appendChild(span):this.element.insertBefore(span,node)}}wireEvents(){this.isToggle&&EventHandler.add(this.element,"click",this.btnClickHandler,this)}unWireEvents(){this.isToggle&&EventHandler.remove(this.element,"click",this.btnClickHandler)}btnClickHandler(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")}destroy(){let span,classList=["e-primary","e-rtl","e-icon-btn","e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(classList=classList.concat(this.cssClass.split(" "))),super.destroy(),removeClass([this.element],classList),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,"")),(span=this.element.querySelector("span.e-btn-icon"))&&detach(span),this.unWireEvents(),this.removeRippleEffect()}getModuleName(){return"btn"}getPersistData(){return this.addOnPersist([])}static Inject(){}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"isPrimary":newProp.isPrimary?this.element.classList.add("e-primary"):this.element.classList.remove("e-primary");break;case"disabled":this.controlStatus(newProp.disabled),this.unWireEvents();break;case"iconCss":let span=this.element.querySelector("span.e-btn-icon");span?newProp.iconCss?(span.className="e-btn-icon "+newProp.iconCss,this.element.textContent.trim()&&span.classList.add("Left"===this.iconPosition?"e-icon-left":"e-icon-right")):detach(span):this.setIconCss();break;case"iconPosition":removeClass([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),(span=this.element.querySelector("span.e-btn-icon"))&&detach(span),this.setIconCss();break;case"cssClass":oldProp.cssClass&&removeClass([this.element],oldProp.cssClass.split(" ")),newProp.cssClass&&addClass([this.element],newProp.cssClass.split(" "));break;case"enableRtl":newProp.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl");break;case"content":getTextNode(this.element)||this.element.classList.remove("e-icon-btn"),this.element.innerHTML=newProp.content,this.setIconCss();break;case"isToggle":newProp.isToggle?EventHandler.add(this.element,"click",this.btnClickHandler,this):(EventHandler.remove(this.element,"click",this.btnClickHandler),removeClass([this.element],["e-active"]))}}click(){this.element.click()}focusIn(){this.element.focus()}};return __decorate([Property("Left")],Button.prototype,"iconPosition",void 0),__decorate([Property("")],Button.prototype,"iconCss",void 0),__decorate([Property(!1)],Button.prototype,"disabled",void 0),__decorate([Property(!1)],Button.prototype,"isPrimary",void 0),__decorate([Property("")],Button.prototype,"cssClass",void 0),__decorate([Property("")],Button.prototype,"content",void 0),__decorate([Property(!1)],Button.prototype,"isToggle",void 0),__decorate([Property()],Button.prototype,"locale",void 0),__decorate([ej2_base_es2015_Event()],Button.prototype,"created",void 0),__decorate([NotifyPropertyChanges],Button)})();const RIPPLE="e-ripple-container";let ej2_buttons_es2015_CheckBox=(()=>{let CheckBox=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.isFocused=!1,this.isMouseClick=!1}changeState(state){let ariaState,rippleSpan,frameSpan=this.getWrapper().getElementsByClassName("e-frame")[0];isRippleEnabled&&(rippleSpan=this.getWrapper().getElementsByClassName(RIPPLE)[0]),"check"===state?(frameSpan.classList.remove("e-stop"),frameSpan.classList.add("e-check"),rippleSpan&&(rippleSpan.classList.remove("e-ripple-stop"),rippleSpan.classList.add("e-ripple-check")),ariaState="true",this.element.checked=!0):"uncheck"===state?(removeClass([frameSpan],["e-check","e-stop"]),rippleSpan&&removeClass([rippleSpan],["e-ripple-check","e-ripple-stop"]),ariaState="false",this.element.checked=!1):(frameSpan.classList.remove("e-check"),frameSpan.classList.add("e-stop"),rippleSpan&&(rippleSpan.classList.remove("e-ripple-check"),rippleSpan.classList.add("e-ripple-stop")),ariaState="mixed",this.element.indeterminate=!0),this.getWrapper().setAttribute("aria-checked",ariaState)}clickHandler(event){this.isMouseClick&&(this.focusOutHandler(),this.isMouseClick=!1),this.indeterminate?(this.changeState(this.checked?"check":"uncheck"),this.indeterminate=!1,this.element.indeterminate=!1):this.checked?(this.changeState("uncheck"),this.checked=!1):(this.changeState("check"),this.checked=!0),this.trigger("change",{checked:this.element.checked,event:event})}destroy(){let wrapper=this.getWrapper();super.destroy(),this.disabled||this.unWireEvents(),"INPUT"===this.tagName?(wrapper.parentNode.insertBefore(this.element,wrapper),detach(wrapper),this.element.checked=!1,this.indeterminate&&(this.element.indeterminate=!1),["name","value","disabled"].forEach(key=>{this.element.removeAttribute(key)})):(["role","aria-checked","class"].forEach(key=>{wrapper.removeAttribute(key)}),wrapper.innerHTML="")}focusHandler(){this.isFocused=!0}focusOutHandler(){this.getWrapper().classList.remove("e-focus"),this.isFocused=!1}getModuleName(){return"checkbox"}getPersistData(){return this.addOnPersist(["checked","indeterminate"])}getWrapper(){return this.element.parentElement.parentElement}initialize(){isNullOrUndefined(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.name&&this.element.setAttribute("name",this.name),this.value&&this.element.setAttribute("value",this.value),this.checked&&this.changeState("check"),this.indeterminate&&this.changeState(),this.disabled&&this.setDisabled()}initWrapper(){let wrapper=this.element.parentElement;wrapper.classList.contains("e-checkbox-wrapper")||(wrapper=this.createElement("div",{className:"e-checkbox-wrapper",attrs:{role:"checkbox","aria-checked":"false"}}),this.element.parentNode.insertBefore(wrapper,this.element));let label=this.createElement("label",{attrs:{for:this.element.id}}),frameSpan=this.createElement("span",{className:"e-icons e-frame"});if(this.enableRtl&&wrapper.classList.add("e-rtl"),this.cssClass&&addClass([wrapper],this.cssClass.split(" ")),wrapper.appendChild(label),label.appendChild(this.element),wrap=label,(proxy=this).element.getAttribute("ejs-for")&&wrap.appendChild(proxy.createElement("input",{attrs:{name:proxy.name||proxy.element.name,value:"false",type:"hidden"}})),label.appendChild(frameSpan),isRippleEnabled){let rippleSpan=this.createElement("span",{className:RIPPLE});"Before"===this.labelPosition?label.appendChild(rippleSpan):label.insertBefore(rippleSpan,frameSpan),rippleEffect(rippleSpan,{duration:400,isCenterRipple:!0})}var proxy,wrap;this.label&&this.setText(this.label)}keyUpHandler(){this.isFocused&&this.getWrapper().classList.add("e-focus")}labelMouseHandler(e){this.isMouseClick=!0,rippleMouseHandler(e,this.getWrapper().getElementsByClassName(RIPPLE)[0])}onPropertyChanged(newProp,oldProp){let wrapper=this.getWrapper();for(let prop of Object.keys(newProp))switch(prop){case"checked":this.indeterminate=!1,this.element.indeterminate=!1,this.changeState(newProp.checked?"check":"uncheck");break;case"indeterminate":newProp.indeterminate?this.changeState():(this.element.indeterminate=!1,this.changeState(this.checked?"check":"uncheck"));break;case"disabled":newProp.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,wrapper.classList.remove("e-checkbox-disabled"),wrapper.setAttribute("aria-disabled","false"),this.wireEvents());break;case"cssClass":oldProp.cssClass&&removeClass([wrapper],oldProp.cssClass.split(" ")),newProp.cssClass&&addClass([wrapper],newProp.cssClass.split(" "));break;case"enableRtl":newProp.enableRtl?wrapper.classList.add("e-rtl"):wrapper.classList.remove("e-rtl");break;case"label":this.setText(newProp.label);break;case"labelPosition":let label=wrapper.getElementsByClassName("e-label")[0],labelWrap=wrapper.getElementsByTagName("label")[0];detach(label),"After"===newProp.labelPosition?labelWrap.appendChild(label):labelWrap.insertBefore(label,wrapper.getElementsByClassName("e-frame")[0]);break;case"name":this.element.setAttribute("name",newProp.name);break;case"value":this.element.setAttribute("value",newProp.value)}}preRender(){let element=this.element;this.formElement=closest(this.element,"form"),this.tagName=this.element.tagName,element=wrapperInitialize(this.createElement,"EJS-CHECKBOX","checkbox",element,"e-checkbox-wrapper","checkbox"),this.element=element,"checkbox"!==this.element.getAttribute("type")&&this.element.setAttribute("type","checkbox"),this.element.id||(this.element.id=getUniqueID("e-"+this.getModuleName()))}render(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()}setDisabled(){let wrapper=this.getWrapper();this.element.disabled=!0,wrapper.classList.add("e-checkbox-disabled"),wrapper.setAttribute("aria-disabled","true")}setText(text){let label=this.getWrapper().getElementsByClassName("e-label")[0];if(label)label.textContent=text;else{label=this.createElement("span",{className:"e-label",innerHTML:text});let labelWrap=this.getWrapper().getElementsByTagName("label")[0];"Before"===this.labelPosition?labelWrap.insertBefore(label,this.getWrapper().getElementsByClassName("e-frame")[0]):labelWrap.appendChild(label)}}changeHandler(e){e.stopPropagation()}formResetHandler(){this.checked=this.initialCheckedValue,attributes(this.element,{checked:this.initialCheckedValue.toString()})}unWireEvents(){let wrapper=this.getWrapper();EventHandler.remove(this.element,"click",this.clickHandler),EventHandler.remove(this.element,"keyup",this.keyUpHandler),EventHandler.remove(this.element,"focus",this.focusHandler),EventHandler.remove(this.element,"focusout",this.focusOutHandler);let label=wrapper.getElementsByTagName("label")[0];EventHandler.remove(label,"mousedown",this.labelMouseHandler),EventHandler.remove(label,"mouseup",this.labelMouseHandler),this.formElement&&EventHandler.remove(this.formElement,"reset",this.formResetHandler),"EJS-CHECKBOX"===this.tagName&&EventHandler.remove(this.element,"change",this.changeHandler)}wireEvents(){let wrapper=this.getWrapper();EventHandler.add(this.element,"click",this.clickHandler,this),EventHandler.add(this.element,"keyup",this.keyUpHandler,this),EventHandler.add(this.element,"focus",this.focusHandler,this),EventHandler.add(this.element,"focusout",this.focusOutHandler,this);let label=wrapper.getElementsByTagName("label")[0];EventHandler.add(label,"mousedown",this.labelMouseHandler,this),EventHandler.add(label,"mouseup",this.labelMouseHandler,this),this.formElement&&EventHandler.add(this.formElement,"reset",this.formResetHandler,this),"EJS-CHECKBOX"===this.tagName&&EventHandler.add(this.element,"change",this.changeHandler,this)}click(){this.element.click()}focusIn(){this.element.focus()}};return __decorate([ej2_base_es2015_Event()],CheckBox.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],CheckBox.prototype,"created",void 0),__decorate([Property(!1)],CheckBox.prototype,"checked",void 0),__decorate([Property("")],CheckBox.prototype,"cssClass",void 0),__decorate([Property(!1)],CheckBox.prototype,"disabled",void 0),__decorate([Property(!1)],CheckBox.prototype,"indeterminate",void 0),__decorate([Property("")],CheckBox.prototype,"label",void 0),__decorate([Property("After")],CheckBox.prototype,"labelPosition",void 0),__decorate([Property("")],CheckBox.prototype,"name",void 0),__decorate([Property("")],CheckBox.prototype,"value",void 0),__decorate([NotifyPropertyChanges],CheckBox)})();var RadioButton_1;let ej2_popups_es2015_elementRect,popupRect,ej2_popups_es2015_element,parentDocument,parentDocument$1,targetContainer,ej2_buttons_es2015_RadioButton=(()=>{let RadioButton=RadioButton_1=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.isFocused=!1}changeHandler(event){this.checked=!0,this.dataBind(),this.trigger("change",{value:this.value,event:event}),"EJS-RADIOBUTTON"===this.tagName&&event.stopPropagation()}updateChange(state){let input,instance,radioGrp=this.getRadioGroup();for(let i=0;i<radioGrp.length;i++)(input=radioGrp[i])!==this.element&&((instance=getInstance(input,RadioButton_1)).checked=!1,"EJS-RADIOBUTTON"===this.tagName&&(instance.angularValue=this.value))}destroy(){let radioWrap=this.element.parentElement;super.destroy(),this.disabled||this.unWireEvents(),"INPUT"===this.tagName?(radioWrap.parentNode.insertBefore(this.element,radioWrap),detach(radioWrap),this.element.checked=!1,["name","value","disabled"].forEach(key=>{this.element.removeAttribute(key)})):(["role","aria-checked","class"].forEach(key=>{radioWrap.removeAttribute(key)}),radioWrap.innerHTML="")}focusHandler(){this.isFocused=!0}focusOutHandler(){this.getLabel().classList.remove("e-focus")}getModuleName(){return"radio"}getSelectedValue(){let input,radioGrp=this.getRadioGroup();for(let i=0,len=radioGrp.length;i<len;i++)if((input=radioGrp[i]).checked)return input.value;return""}getRadioGroup(){return document.querySelectorAll('input.e-radio[name="'+this.element.getAttribute("name")+'"]')}getPersistData(){return this.addOnPersist(["checked"])}getLabel(){return this.element.nextElementSibling}initialize(){isNullOrUndefined(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.initWrapper(),this.name&&this.element.setAttribute("name",this.name),this.value&&this.element.setAttribute("value",this.value),this.checked&&(this.element.checked=!0),this.disabled&&this.setDisabled()}initWrapper(){let rippleSpan,wrapper=this.element.parentElement;wrapper.classList.contains("e-radio-wrapper")||(wrapper=this.createElement("div",{className:"e-radio-wrapper"}),this.element.parentNode.insertBefore(wrapper,this.element));let label=this.createElement("label",{attrs:{for:this.element.id}});wrapper.appendChild(this.element),wrapper.appendChild(label),isRippleEnabled&&(rippleSpan=this.createElement("span",{className:"e-ripple-container"}),label.appendChild(rippleSpan),rippleEffect(rippleSpan,{duration:400,isCenterRipple:!0})),this.enableRtl&&label.classList.add("e-rtl"),this.cssClass&&addClass([label],this.cssClass.split(" ")),this.label&&this.setText(this.label)}keyUpHandler(){this.isFocused&&this.getLabel().classList.add("e-focus")}labelRippleHandler(e){rippleMouseHandler(e,this.getLabel().getElementsByClassName("e-ripple-container")[0])}formResetHandler(){this.checked=this.initialCheckedValue,this.initialCheckedValue&&attributes(this.element,{checked:"true"})}onPropertyChanged(newProp,oldProp){let label=this.getLabel();for(let prop of Object.keys(newProp))switch(prop){case"checked":newProp.checked&&this.updateChange(newProp.checked),this.element.checked=newProp.checked;break;case"disabled":newProp.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,this.wireEvents());break;case"cssClass":oldProp.cssClass&&removeClass([label],oldProp.cssClass.split(" ")),newProp.cssClass&&addClass([label],newProp.cssClass.split(" "));break;case"enableRtl":newProp.enableRtl?label.classList.add("e-rtl"):label.classList.remove("e-rtl");break;case"label":this.setText(newProp.label);break;case"labelPosition":"Before"===newProp.labelPosition?label.classList.add("e-right"):label.classList.remove("e-right");break;case"name":this.element.setAttribute("name",newProp.name);break;case"value":this.element.setAttribute("value",newProp.value)}}preRender(){let element=this.element;if(this.formElement=closest(this.element,"form"),this.tagName=this.element.tagName,element=wrapperInitialize(this.createElement,"EJS-RADIOBUTTON","radio",element,"e-radio-wrapper","radio"),this.element=element,"radio"!==this.element.getAttribute("type")&&this.element.setAttribute("type","radio"),this.element.id||(this.element.id=getUniqueID("e-"+this.getModuleName())),"EJS-RADIOBUTTON"===this.tagName){let formControlName=this.element.getAttribute("formcontrolname");formControlName&&(this.setProperties({name:formControlName},!0),this.element.setAttribute("name",formControlName))}}render(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()}setDisabled(){this.element.disabled=!0}setText(text){let label=this.getLabel(),textLabel=label.getElementsByClassName("e-label")[0];textLabel?textLabel.textContent=text:(textLabel=this.createElement("span",{className:"e-label",innerHTML:text}),label.appendChild(textLabel)),"Before"===this.labelPosition?this.getLabel().classList.add("e-right"):this.getLabel().classList.remove("e-right")}unWireEvents(){let label=this.getLabel();EventHandler.remove(this.element,"change",this.changeHandler),EventHandler.remove(this.element,"focus",this.focusHandler),EventHandler.remove(this.element,"focusout",this.focusOutHandler),EventHandler.remove(this.element,"keyup",this.keyUpHandler);let rippleLabel=label.getElementsByClassName("e-label")[0];rippleLabel&&(EventHandler.remove(rippleLabel,"mousedown",this.labelRippleHandler),EventHandler.remove(rippleLabel,"mouseup",this.labelRippleHandler)),this.formElement&&EventHandler.remove(this.formElement,"reset",this.formResetHandler)}wireEvents(){let label=this.getLabel();EventHandler.add(this.element,"change",this.changeHandler,this),EventHandler.add(this.element,"keyup",this.keyUpHandler,this),EventHandler.add(this.element,"focus",this.focusHandler,this),EventHandler.add(this.element,"focusout",this.focusOutHandler,this);let rippleLabel=label.getElementsByClassName("e-label")[0];rippleLabel&&(EventHandler.add(rippleLabel,"mousedown",this.labelRippleHandler,this),EventHandler.add(rippleLabel,"mouseup",this.labelRippleHandler,this)),this.formElement&&EventHandler.add(this.formElement,"reset",this.formResetHandler,this)}click(){this.element.click()}focusIn(){this.element.focus()}};return __decorate([ej2_base_es2015_Event()],RadioButton.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],RadioButton.prototype,"created",void 0),__decorate([Property(!1)],RadioButton.prototype,"checked",void 0),__decorate([Property("")],RadioButton.prototype,"cssClass",void 0),__decorate([Property(!1)],RadioButton.prototype,"disabled",void 0),__decorate([Property("")],RadioButton.prototype,"label",void 0),__decorate([Property("After")],RadioButton.prototype,"labelPosition",void 0),__decorate([Property("")],RadioButton.prototype,"name",void 0),__decorate([Property("")],RadioButton.prototype,"value",void 0),RadioButton_1=__decorate([NotifyPropertyChanges],RadioButton)})(),fixedParent=!1;function calculateRelativeBasedPosition(anchor,element){let fixedElement=!1,anchorPos={left:0,top:0},tempAnchor=anchor;if(!anchor||!element)return anchorPos;for(isNullOrUndefined(element.offsetParent)&&"fixed"===element.style.position&&(fixedElement=!0);(element.offsetParent||fixedElement)&&anchor&&element.offsetParent!==anchor;)anchorPos.left+=anchor.offsetLeft,anchorPos.top+=anchor.offsetTop,anchor=anchor.offsetParent;for(anchor=tempAnchor;(element.offsetParent||fixedElement)&&anchor&&element.offsetParent!==anchor;)anchorPos.left-=anchor.scrollLeft,anchorPos.top-=anchor.scrollTop,anchor=anchor.parentElement;return anchorPos}function calculatePosition(currentElement,positionX,positionY,parentElement,targetValues){return popupRect=positionY+positionX==="topright"?void 0:targetValues,popupRect=targetValues,fixedParent=!!parentElement,currentElement?(positionX||(positionX="left"),positionY||(positionY="top"),parentDocument=currentElement.ownerDocument,ej2_popups_es2015_element=currentElement,function(posX,posY,pos){switch(ej2_popups_es2015_elementRect=ej2_popups_es2015_element.getBoundingClientRect(),posY+posX){case"topcenter":setPosx(getElementHCenter(),pos),setPosy(getElementTop(),pos);break;case"topright":setPosx(getElementRight(),pos),setPosy(getElementTop(),pos);break;case"centercenter":setPosx(getElementHCenter(),pos),setPosy(getElementVCenter(),pos);break;case"centerright":setPosx(getElementRight(),pos),setPosy(getElementVCenter(),pos);break;case"centerleft":setPosx(getElementLeft(),pos),setPosy(getElementVCenter(),pos);break;case"bottomcenter":setPosx(getElementHCenter(),pos),setPosy(getElementBottom(),pos);break;case"bottomright":setPosx(getElementRight(),pos),setPosy(getElementBottom(),pos);break;case"bottomleft":setPosx(getElementLeft(),pos),setPosy(getElementBottom(),pos);break;default:case"topleft":setPosx(getElementLeft(),pos),setPosy(getElementTop(),pos)}return pos}(positionX.toLowerCase(),positionY.toLowerCase(),{left:0,top:0})):{left:0,top:0}}function setPosx(value,pos){pos.left=value}function setPosy(value,pos){pos.top=value}function getBodyScrollTop(){return parentDocument.documentElement.scrollTop||parentDocument.body.scrollTop}function getBodyScrollLeft(){return parentDocument.documentElement.scrollLeft||parentDocument.body.scrollLeft}function getElementBottom(){return fixedParent?ej2_popups_es2015_elementRect.bottom:ej2_popups_es2015_elementRect.bottom+getBodyScrollTop()}function getElementVCenter(){return getElementTop()+ej2_popups_es2015_elementRect.height/2}function getElementTop(){return fixedParent?ej2_popups_es2015_elementRect.top:ej2_popups_es2015_elementRect.top+getBodyScrollTop()}function getElementLeft(){return ej2_popups_es2015_elementRect.left+getBodyScrollLeft()}function getElementRight(){return ej2_popups_es2015_elementRect.right+getBodyScrollLeft()-(popupRect?popupRect.width:0)}function getElementHCenter(){return getElementLeft()+ej2_popups_es2015_elementRect.width/2}function fit(element,viewPortElement=null,axis={X:!1,Y:!1},position){if(!axis.Y&&!axis.X)return{left:0,top:0};let elemData=element.getBoundingClientRect();if(targetContainer=viewPortElement,parentDocument$1=element.ownerDocument,position||(position=calculatePosition(element,"left","top")),axis.X){let containerWidth=targetContainer?getTargetContainerWidth():getViewPortWidth(),containerLeft=ContainerLeft(),containerRight=ContainerRight(),overLeft=containerLeft-position.left,overRight=position.left+elemData.width-containerRight;elemData.width>containerWidth?position.left=overLeft>0&&overRight<=0?containerRight-elemData.width:overRight>0&&overLeft<=0?containerLeft:overLeft>overRight?containerRight-elemData.width:containerLeft:overLeft>0?position.left+=overLeft:overRight>0&&(position.left-=overRight)}if(axis.Y){let containerHeight=targetContainer?getTargetContainerHeight():getViewPortHeight(),containerTop=ContainerTop(),containerBottom=ContainerBottom(),overTop=containerTop-position.top,overBottom=position.top+elemData.height-containerBottom;elemData.height>containerHeight?position.top=overTop>0&&overBottom<=0?containerBottom-elemData.height:overBottom>0&&overTop<=0?containerTop:overTop>overBottom?containerBottom-elemData.height:containerTop:overTop>0?position.top+=overTop:overBottom>0&&(position.top-=overBottom)}return position}function isCollide(element,viewPortElement=null,x,y){let elemOffset=calculatePosition(element,"left","top");x&&(elemOffset.left=x),y&&(elemOffset.top=y);let data=[];targetContainer=viewPortElement,parentDocument$1=element.ownerDocument;let elementRect=element.getBoundingClientRect(),left=elemOffset.left,right=elemOffset.left+elementRect.width,yAxis=topCollideCheck(elemOffset.top,elemOffset.top+elementRect.height),xAxis=leftCollideCheck(left,right);return yAxis.topSide&&data.push("top"),xAxis.rightSide&&data.push("right"),xAxis.leftSide&&data.push("left"),yAxis.bottomSide&&data.push("bottom"),data}function setPosition(eStatus,pos,elementRect){eStatus.TL={top:pos.position.top+pos.offsetY,left:pos.position.left+pos.offsetX},eStatus.TR={top:eStatus.TL.top,left:eStatus.TL.left+elementRect.width},eStatus.BL={top:eStatus.TL.top+elementRect.height,left:eStatus.TL.left},eStatus.BR={top:eStatus.TL.top+elementRect.height,left:eStatus.TL.left+elementRect.width}}function leftCollideCheck(left,right){let leftSide=!1,rightSide=!1;return left-getBodyScrollLeft$1()<ContainerLeft()&&(leftSide=!0),right>ContainerRight()&&(rightSide=!0),{leftSide:leftSide,rightSide:rightSide}}function topCollideCheck(top,bottom){let topSide=!1,bottomSide=!1;return top-getBodyScrollTop$1()<ContainerTop()&&(topSide=!0),bottom>ContainerBottom()&&(bottomSide=!0),{topSide:topSide,bottomSide:bottomSide}}function getTargetContainerWidth(){return targetContainer.getBoundingClientRect().width}function getTargetContainerHeight(){return targetContainer.getBoundingClientRect().height}function getTargetContainerLeft(){return targetContainer.getBoundingClientRect().left}function getTargetContainerTop(){return targetContainer.getBoundingClientRect().top}function ContainerTop(){return targetContainer?getTargetContainerTop():0}function ContainerLeft(){return targetContainer?getTargetContainerLeft():0}function ContainerRight(){return targetContainer?getBodyScrollLeft$1()+getTargetContainerLeft()+getTargetContainerWidth():getBodyScrollLeft$1()+getViewPortWidth()}function ContainerBottom(){return targetContainer?getBodyScrollTop$1()+getTargetContainerTop()+getTargetContainerHeight():getBodyScrollTop$1()+getViewPortHeight()}function getBodyScrollTop$1(){return parentDocument$1.documentElement.scrollTop||parentDocument$1.body.scrollTop}function getBodyScrollLeft$1(){return parentDocument$1.documentElement.scrollLeft||parentDocument$1.body.scrollLeft}function getViewPortHeight(){return window.innerHeight}function getViewPortWidth(){let windowWidth=window.innerWidth;return windowWidth-(windowWidth-(isNullOrUndefined(document.documentElement)?0:document.documentElement.offsetWidth))}let ej2_popups_es2015_PositionData=(()=>{class PositionData extends ChildProperty{}return __decorate([Property("left")],PositionData.prototype,"X",void 0),__decorate([Property("top")],PositionData.prototype,"Y",void 0),PositionData})(),ej2_popups_es2015_Popup=(()=>{let Popup=class extends ej2_base_es2015_Component{constructor(element,options){super(options,element)}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"width":setStyleAttribute(this.element,{width:formatUnit(newProp.width)});break;case"height":setStyleAttribute(this.element,{height:formatUnit(newProp.height)});break;case"zIndex":setStyleAttribute(this.element,{zIndex:newProp.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":let x=newProp.offsetX-oldProp.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+x).toString()+"px";break;case"offsetY":let y=newProp.offsetY-oldProp.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+y).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":"none"!==newProp.actionOnScroll?this.wireScrollEvents():this.unwireScrollEvents()}}getModuleName(){return"popup"}getPersistData(){return this.addOnPersist([])}destroy(){this.element.classList.remove("e-popup","e-rtl"),this.unwireEvents(),super.destroy()}render(){this.element.classList.add("e-popup");let styles={};1e3!==this.zIndex&&(styles.zIndex=this.zIndex),"auto"!==this.width&&(styles.width=formatUnit(this.width)),"auto"!==this.height&&(styles.height=formatUnit(this.height)),setStyleAttribute(this.element,styles),this.fixedParent=!1,this.setEnableRtl(),this.setContent(),this.wireEvents()}wireEvents(){Browser.isDevice&&EventHandler.add(window,"orientationchange",this.orientationOnChange,this),"none"!==this.actionOnScroll&&this.wireScrollEvents()}wireScrollEvents(){if(this.getRelateToElement())for(let parent of this.getScrollableParent(this.getRelateToElement()))EventHandler.add(parent,"scroll",this.scrollRefresh,this)}unwireEvents(){Browser.isDevice&&EventHandler.remove(window,"orientationchange",this.orientationOnChange),"none"!==this.actionOnScroll&&this.unwireScrollEvents()}unwireScrollEvents(){if(this.getRelateToElement())for(let parent of this.getScrollableParent(this.getRelateToElement()))EventHandler.remove(parent,"scroll",this.scrollRefresh)}getRelateToElement(){let relateToElement=""===this.relateTo||isNullOrUndefined(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:relateToElement},!0),"string"==typeof this.relateTo?document.querySelector(this.relateTo):this.relateTo}scrollRefresh(e){if("reposition"===this.actionOnScroll?this.element.offsetParent===e.target||this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&null==e.target.parentElement||this.refreshPosition():"hide"===this.actionOnScroll&&this.hide(),"none"!==this.actionOnScroll&&this.getRelateToElement()){let targetVisible=this.isElementOnViewport(this.getRelateToElement(),e.target);targetVisible||this.targetInvisibleStatus?targetVisible&&(this.targetInvisibleStatus=!1):(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0)}}isElementOnViewport(relateToElement,scrollElement){let scrollParents=this.getScrollableParent(relateToElement);for(let parent=0;parent<scrollParents.length;parent++)if(!this.isElementVisible(relateToElement,scrollParents[parent]))return!1;return!0}isElementVisible(relateToElement,scrollElement){let rect=this.checkGetBoundingClientRect(relateToElement);if(!rect.height||!rect.width)return!1;if(isNullOrUndefined(this.checkGetBoundingClientRect(scrollElement))){let win=window,windowView={top:win.scrollY,left:win.scrollX,right:win.scrollX+win.outerWidth,bottom:win.scrollY+win.outerHeight},off=calculatePosition(relateToElement),ele={top:off.top,left:off.left,right:off.left+rect.width,bottom:off.top+rect.height},elementView={top:windowView.bottom-ele.top,left:windowView.right-ele.left,bottom:ele.bottom-windowView.top,right:ele.right-windowView.left};return elementView.top>0&&elementView.left>0&&elementView.right>0&&elementView.bottom>0}{let parent=scrollElement.getBoundingClientRect();return!(rect.bottom<parent.top||rect.bottom>parent.bottom||rect.right>parent.right||rect.left<parent.left)}}preRender(){}setEnableRtl(){this.reposition(),this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}setContent(){isNullOrUndefined(this.content)||(this.element.innerHTML="","string"==typeof this.content?this.element.textContent=this.content:this.element.appendChild(this.content))}orientationOnChange(){setTimeout(()=>{this.refreshPosition()},200)}refreshPosition(target,collision){isNullOrUndefined(target)||this.checkFixedParent(target),this.reposition(),collision||this.checkCollision()}reposition(){let pos,position,relateToElement=this.getRelateToElement();if("number"==typeof this.position.X&&"number"==typeof this.position.Y)pos={left:this.position.X,top:this.position.Y};else if("string"==typeof this.position.X&&"number"==typeof this.position.Y||"number"==typeof this.position.X&&"string"==typeof this.position.Y){let parentDisplay,display=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(parentDisplay=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),position=this.getAnchorPosition(relateToElement,this.element,this.position,this.offsetX,this.offsetY),pos="string"==typeof this.position.X?{left:position.left,top:this.position.Y}:{left:this.position.X,top:position.top},this.element.style.display=display,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=parentDisplay)}else if(relateToElement){let display=this.element.style.display;this.element.style.display="block",pos=this.getAnchorPosition(relateToElement,this.element,this.position,this.offsetX,this.offsetY),this.element.style.display=display}else pos={left:0,top:0};isNullOrUndefined(pos)||(this.element.style.left=pos.left+"px",this.element.style.top=pos.top+"px")}checkGetBoundingClientRect(ele){try{return ele.getBoundingClientRect()}catch(error){return null}}getAnchorPosition(anchorEle,ele,position,offsetX,offsetY){let eleRect=this.checkGetBoundingClientRect(ele),anchorRect=this.checkGetBoundingClientRect(anchorEle);if(isNullOrUndefined(eleRect)||isNullOrUndefined(anchorRect))return null;let anchor=anchorEle,anchorPos={left:0,top:0};switch(ele.offsetParent&&"BODY"===ele.offsetParent.tagName&&"BODY"===anchorEle.tagName?anchorPos=calculatePosition(anchorEle):(ele.classList.contains("e-dlg-modal")&&"BODY"!==anchor.tagName&&(ele=ele.parentElement),anchorPos=calculateRelativeBasedPosition(anchor,ele)),position.X){default:case"left":break;case"center":ele.classList.contains("e-dlg-modal")&&"BODY"===anchor.tagName&&"container"===this.targetType?anchorPos.left+=window.innerWidth/2-eleRect.width/2:anchorPos.left+="container"===this.targetType?anchorRect.width/2-eleRect.width/2:anchorRect.width/2;break;case"right":ele.classList.contains("e-dlg-modal")&&"BODY"===anchor.tagName&&"container"===this.targetType?anchorPos.left+=window.innerWidth-eleRect.width:anchorPos.left+="container"===this.targetType?anchorRect.width-eleRect.width:anchorRect.width}switch(position.Y){default:case"top":break;case"center":ele.classList.contains("e-dlg-modal")&&"BODY"===anchor.tagName&&"container"===this.targetType?anchorPos.top+=window.innerHeight/2-eleRect.height/2:anchorPos.top+="container"===this.targetType?anchorRect.height/2-eleRect.height/2:anchorRect.height/2;break;case"bottom":ele.classList.contains("e-dlg-modal")&&"BODY"===anchor.tagName&&"container"===this.targetType?anchorPos.top+=window.innerHeight-eleRect.height:anchorPos.top+="container"===this.targetType?anchorRect.height-eleRect.height:anchorRect.height}return anchorPos.left+=offsetX,anchorPos.top+=offsetY,anchorPos}callFlip(param){let relateToElement=this.getRelateToElement();!function(element,target,offsetX,offsetY,positionX,positionY,viewPortElement=null,axis={X:!0,Y:!0},fixedParent){if(!(target&&element&&positionX&&positionY&&(axis.X||axis.Y)))return;let tEdge={TL:null,TR:null,BL:null,BR:null},eEdge={TL:null,TR:null,BL:null,BR:null},elementRect=element.getBoundingClientRect(),pos={posX:positionX,posY:positionY,offsetX:offsetX,offsetY:offsetY,position:{left:0,top:0}};targetContainer=viewPortElement,parentDocument$1=target.ownerDocument,function(target,edge,pos,fixedParent,elementRect){pos.position=calculatePosition(target,pos.posX,pos.posY,fixedParent,elementRect),edge.TL=calculatePosition(target,"left","top",fixedParent,elementRect),edge.TR=calculatePosition(target,"right","top",fixedParent,elementRect),edge.BR=calculatePosition(target,"left","bottom",fixedParent,elementRect),edge.BL=calculatePosition(target,"right","bottom",fixedParent,elementRect)}(target,tEdge,pos,fixedParent,elementRect),setPosition(eEdge,pos,elementRect),axis.X&&function leftFlip(target,edge,tEdge,pos,elementRect,deepCheck){let collideSide=leftCollideCheck(edge.TL.left,edge.TR.left);tEdge.TL.left-getBodyScrollLeft$1()<=ContainerLeft()&&(collideSide.leftSide=!1),tEdge.TR.left>=ContainerRight()&&(collideSide.rightSide=!1),(collideSide.leftSide&&!collideSide.rightSide||!collideSide.leftSide&&collideSide.rightSide)&&(pos.posX="right"===pos.posX?"left":"right",pos.offsetX=pos.offsetX+elementRect.width,pos.offsetX=-1*pos.offsetX,pos.position=calculatePosition(target,pos.posX,pos.posY,!1),setPosition(edge,pos,elementRect),deepCheck&&leftFlip(target,edge,tEdge,pos,elementRect,!1))}(target,eEdge,tEdge,pos,elementRect,!0),axis.Y&&tEdge.TL.top>-1&&function topFlip(target,edge,tEdge,pos,elementRect,deepCheck){let collideSide=topCollideCheck(edge.TL.top,edge.BL.top);tEdge.TL.top-getBodyScrollTop$1()<=ContainerTop()&&(collideSide.topSide=!1),tEdge.BL.top>=ContainerBottom()&&(collideSide.bottomSide=!1),(collideSide.topSide&&!collideSide.bottomSide||!collideSide.topSide&&collideSide.bottomSide)&&(pos.posY="top"===pos.posY?"bottom":"top",pos.offsetY=pos.offsetY+elementRect.height,pos.offsetY=-1*pos.offsetY,pos.position=calculatePosition(target,pos.posX,pos.posY,!1,elementRect),setPosition(edge,pos,elementRect),deepCheck&&topFlip(target,edge,tEdge,pos,elementRect,!1))}(target,eEdge,tEdge,pos,elementRect,!0),function(element,pos,elementRect){let left=0,top=0;if(null!=element.offsetParent&&("absolute"===getComputedStyle(element.offsetParent).position||"relative"===getComputedStyle(element.offsetParent).position)){let data=calculatePosition(element.offsetParent,"left","top",!1,elementRect);left=data.left,top=data.top}element.style.top=pos.position.top+pos.offsetY-top+"px",element.style.left=pos.position.left+pos.offsetX-left+"px"}(element,pos,elementRect)}(this.element,relateToElement,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,param,this.fixedParent)}callFit(param){if(0!==isCollide(this.element,this.viewPortElement).length)if(isNullOrUndefined(this.viewPortElement)){let data=fit(this.element,this.viewPortElement,param);param.X&&(this.element.style.left=data.left+"px"),param.Y&&(this.element.style.top=data.top+"px")}else{let elementRect=this.checkGetBoundingClientRect(this.element),viewPortRect=this.checkGetBoundingClientRect(this.viewPortElement);if(isNullOrUndefined(elementRect)||isNullOrUndefined(viewPortRect))return null;param&&!0===param.Y&&(viewPortRect.top>elementRect.top?this.element.style.top="0px":viewPortRect.bottom<elementRect.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(elementRect.bottom-viewPortRect.bottom)+"px")),param&&!0===param.X&&(viewPortRect.right<elementRect.right?this.element.style.left=parseInt(this.element.style.left,10)-(elementRect.right-viewPortRect.right)+"px":viewPortRect.left>elementRect.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(viewPortRect.left-elementRect.left)+"px"))}}checkCollision(){let horz=this.collision.X,vert=this.collision.Y;"none"===horz&&"none"===vert||("flip"===horz&&"flip"===vert?this.callFlip({X:!0,Y:!0}):"fit"===horz&&"fit"===vert?this.callFit({X:!0,Y:!0}):("flip"===horz?this.callFlip({X:!0,Y:!1}):"flip"===vert&&this.callFlip({Y:!0,X:!1}),"fit"===horz?this.callFit({X:!0,Y:!1}):"fit"===vert&&this.callFit({X:!1,Y:!0})))}show(animationOptions,relativeElement){if(1e3===this.zIndex||!isNullOrUndefined(relativeElement)){let zIndexElement=isNullOrUndefined(relativeElement)?this.element:relativeElement;this.zIndex=getZindexPartial(zIndexElement),setStyleAttribute(this.element,{zIndex:this.zIndex})}animationOptions=isNullOrUndefined(animationOptions)||"object"!=typeof animationOptions?this.showAnimation:animationOptions,"none"===this.collision.X&&"none"===this.collision.Y||(removeClass([this.element],"e-popup-close"),addClass([this.element],"e-popup-open"),this.checkCollision(),removeClass([this.element],"e-popup-open"),addClass([this.element],"e-popup-close")),isNullOrUndefined(animationOptions)?(removeClass([this.element],"e-popup-close"),addClass([this.element],"e-popup-open"),this.trigger("open")):(animationOptions.begin=()=>{this.isDestroyed||(removeClass([this.element],"e-popup-close"),addClass([this.element],"e-popup-open"))},animationOptions.end=()=>{this.isDestroyed||this.trigger("open")},new ej2_base_es2015_Animation(animationOptions).animate(this.element))}hide(animationOptions){animationOptions=isNullOrUndefined(animationOptions)||"object"!=typeof animationOptions?this.hideAnimation:animationOptions,isNullOrUndefined(animationOptions)?(removeClass([this.element],"e-popup-open"),addClass([this.element],"e-popup-close"),this.trigger("close")):(animationOptions.end=()=>{this.isDestroyed||(removeClass([this.element],"e-popup-open"),addClass([this.element],"e-popup-close"),this.trigger("close"))},new ej2_base_es2015_Animation(animationOptions).animate(this.element))}getScrollableParent(element){return this.checkFixedParent(element),getScrollableParent(element,this.fixedParent)}checkFixedParent(element){let parent=element.parentElement;for(;parent&&"HTML"!==parent.tagName;){let parentStyle=getComputedStyle(parent);"fixed"===parentStyle.position&&this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&(this.element.style.position="fixed",this.fixedParent=!0),parent=parent.parentElement,isNullOrUndefined(this.element.offsetParent)&&"fixed"===parentStyle.position&&"fixed"===this.element.style.position&&(this.fixedParent=!0)}}};return __decorate([Property("auto")],Popup.prototype,"height",void 0),__decorate([Property("auto")],Popup.prototype,"width",void 0),__decorate([Property(null)],Popup.prototype,"content",void 0),__decorate([Property("container")],Popup.prototype,"targetType",void 0),__decorate([Property(null)],Popup.prototype,"viewPortElement",void 0),__decorate([Property({X:"none",Y:"none"})],Popup.prototype,"collision",void 0),__decorate([Property("")],Popup.prototype,"relateTo",void 0),__decorate([Complex({},ej2_popups_es2015_PositionData)],Popup.prototype,"position",void 0),__decorate([Property(0)],Popup.prototype,"offsetX",void 0),__decorate([Property(0)],Popup.prototype,"offsetY",void 0),__decorate([Property(1e3)],Popup.prototype,"zIndex",void 0),__decorate([Property(!1)],Popup.prototype,"enableRtl",void 0),__decorate([Property("reposition")],Popup.prototype,"actionOnScroll",void 0),__decorate([Property(null)],Popup.prototype,"showAnimation",void 0),__decorate([Property(null)],Popup.prototype,"hideAnimation",void 0),__decorate([ej2_base_es2015_Event()],Popup.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],Popup.prototype,"close",void 0),__decorate([ej2_base_es2015_Event()],Popup.prototype,"targetExitViewport",void 0),__decorate([NotifyPropertyChanges],Popup)})();function getScrollableParent(element,fixedParent){let eleStyle=getComputedStyle(element),scrollParents=[],overflowRegex=/(auto|scroll)/,parent=element.parentElement;for(;parent&&"HTML"!==parent.tagName;){let parentStyle=getComputedStyle(parent);"absolute"===eleStyle.position&&"static"===parentStyle.position||!overflowRegex.test(parentStyle.overflow+parentStyle.overflowY+parentStyle.overflowX)||scrollParents.push(parent),parent=parent.parentElement}return fixedParent||scrollParents.push(document),scrollParents}function getZindexPartial(element){let parent=element.parentElement,parentZindex=[];for(;parent&&"BODY"!==parent.tagName;){let index=document.defaultView.getComputedStyle(parent,null).getPropertyValue("z-index"),position=document.defaultView.getComputedStyle(parent,null).getPropertyValue("position");"auto"!==index&&"static"!==position&&parentZindex.push(index),parent=parent.parentElement}let childrenZindex=[];for(let i=0;i<document.body.children.length;i++)if(!element.isEqualNode(document.body.children[i])){let index=document.defaultView.getComputedStyle(document.body.children[i],null).getPropertyValue("z-index"),position=document.defaultView.getComputedStyle(document.body.children[i],null).getPropertyValue("position");"auto"!==index&&"static"!==position&&childrenZindex.push(index)}childrenZindex.push("999");let siblingsZindex=[];if(!isNullOrUndefined(element.parentElement)&&"BODY"!==element.parentElement.tagName){let childNodes=[].slice.call(element.parentElement.children);for(let i=0;i<childNodes.length;i++){let index=document.defaultView.getComputedStyle(childNodes[i],null).getPropertyValue("z-index"),position=document.defaultView.getComputedStyle(childNodes[i],null).getPropertyValue("position");"auto"!==index&&"static"!==position&&siblingsZindex.push(index)}}let finalValue=parentZindex.concat(childrenZindex,siblingsZindex),currentZindexValue=Math.max.apply(Math,finalValue)+1;return currentZindexValue>2147483647?2147483647:currentZindexValue}let ej2_popups_es2015_targetElement,selectedHandler,ej2_popups_es2015_elementClass=["north-west","north","north-east","west","east","south-west","south","south-east"],originalWidth=0,originalHeight=0,originalX=0,originalY=0,originalMouseX=0,originalMouseY=0;const RESIZE_HANDLER="e-resize-handle",FOCUSED_HANDLER="e-focused-handle";let RESTRICT_LEFT=["e-restrict-left"];const RESIZE_WITHIN_VIEWPORT="e-resize-viewport";let minHeight,maxHeight,minWidth,maxWidth,containerElement,resizeWestWidth,resizeStart=null,resize=null,resizeEnd=null,setLeft=!0,previousWidth=0,setWidth=!0;function getDOMElement(element){let domElement;return isNullOrUndefined(element)||(domElement="string"==typeof element?document.querySelector(element):element),domElement}function getEventType(e){return e.indexOf("mouse")>-1?"mouse":"touch"}function onMouseDown(e){if(e.preventDefault(),ej2_popups_es2015_targetElement=e.target.parentElement,calculateValues(),originalMouseX=e.pageX,originalMouseY=e.pageY,e.target.classList.add(FOCUSED_HANDLER),!isNullOrUndefined(resizeStart)&&!0===resizeStart(e))return;let target=isNullOrUndefined(containerElement)?document:containerElement;EventHandler.add(target,"mousemove",onMouseMove,this),EventHandler.add(document,"mouseup",onMouseUp,this);for(let i=0;i<RESTRICT_LEFT.length;i++)setLeft=!ej2_popups_es2015_targetElement.classList.contains(RESTRICT_LEFT[i])}function onMouseUp(e){let touchMoveEvent="msie"===Browser.info.name?"pointermove":"touchmove",touchEndEvent="msie"===Browser.info.name?"pointerup":"touchend",target=isNullOrUndefined(containerElement)?document:containerElement;EventHandler.remove(target,"mousemove",onMouseMove),EventHandler.remove(target,touchMoveEvent,onMouseMove),EventHandler.remove(target,"msie"===Browser.info.name?"pointerdown":"touchstart",onMouseMove),isNullOrUndefined(document.body.querySelector("."+FOCUSED_HANDLER))||document.body.querySelector("."+FOCUSED_HANDLER).classList.remove(FOCUSED_HANDLER),isNullOrUndefined(resizeEnd)||resizeEnd(e),EventHandler.remove(document,"mouseup",onMouseUp),EventHandler.remove(document,touchEndEvent,onMouseUp)}function calculateValues(){originalWidth=parseFloat(getComputedStyle(ej2_popups_es2015_targetElement,null).getPropertyValue("width").replace("px","")),originalHeight=parseFloat(getComputedStyle(ej2_popups_es2015_targetElement,null).getPropertyValue("height").replace("px","")),originalX=ej2_popups_es2015_targetElement.getBoundingClientRect().left,originalY=ej2_popups_es2015_targetElement.getBoundingClientRect().top}function onTouchStart(e){if(ej2_popups_es2015_targetElement=e.target.parentElement,calculateValues(),originalMouseX=e.touches[0].pageX,originalMouseY=e.touches[0].pageY,!isNullOrUndefined(resizeStart)&&!0===resizeStart(e))return;let touchMoveEvent="msie"===Browser.info.name?"pointermove":"touchmove",touchEndEvent="msie"===Browser.info.name?"pointerup":"touchend",target=isNullOrUndefined(containerElement)?document:containerElement;EventHandler.add(target,touchMoveEvent,onMouseMove,this),EventHandler.add(document,touchEndEvent,onMouseUp)}function onMouseMove(e){if(e.target.classList.contains(RESIZE_HANDLER)&&e.target.classList.contains(FOCUSED_HANDLER)?selectedHandler=e.target:isNullOrUndefined(document.body.querySelector("."+FOCUSED_HANDLER))||(selectedHandler=document.body.querySelector("."+FOCUSED_HANDLER)),!isNullOrUndefined(selectedHandler)){let resizeTowards="";for(let i=0;i<ej2_popups_es2015_elementClass.length;i++)selectedHandler.classList.contains("e-"+ej2_popups_es2015_elementClass[i])&&(resizeTowards=ej2_popups_es2015_elementClass[i]);switch(isNullOrUndefined(resize)||resize(e),resizeTowards){case"south":resizeSouth(e);break;case"north":resizeNorth(e);break;case"west":resizeWest(e);break;case"east":resizeEast(e);break;case"south-east":resizeSouth(e),resizeEast(e);break;case"south-west":resizeSouth(e),resizeWest(e);break;case"north-east":resizeNorth(e),resizeEast(e);break;case"north-west":resizeNorth(e),resizeWest(e)}}}function getClientRectValues(element){return element.getBoundingClientRect()}function resizeSouth(e){let containerRectValues,documentHeight=document.documentElement.clientHeight,calculateValue=!1,currentpageY="mouse"===getEventType(e.type)?e.pageY:e.touches[0].pageY,targetRectValues=getClientRectValues(ej2_popups_es2015_targetElement);isNullOrUndefined(containerElement)||(containerRectValues=getClientRectValues(containerElement)),isNullOrUndefined(containerElement)?isNullOrUndefined(containerElement)&&(documentHeight-currentpageY>=0||targetRectValues.top<0)&&(calculateValue=!0):calculateValue=!0;let calculatedHeight=originalHeight+(currentpageY-originalMouseY);calculatedHeight=calculatedHeight>minHeight?calculatedHeight:minHeight;let containerTop=0;isNullOrUndefined(containerElement)||(containerTop=containerRectValues.top);let borderValue=isNullOrUndefined(containerElement)?0:containerElement.offsetHeight-containerElement.clientHeight,topWithoutborder=targetRectValues.top-containerTop-borderValue/2;if(topWithoutborder=topWithoutborder<0?0:topWithoutborder,targetRectValues.top>0&&topWithoutborder+calculatedHeight>maxHeight){if(calculateValue=!1,ej2_popups_es2015_targetElement.classList.contains(RESIZE_WITHIN_VIEWPORT))return;return void(ej2_popups_es2015_targetElement.style.height=maxHeight-parseInt(topWithoutborder.toString(),10)+"px")}let targetTop=0;if(calculateValue){targetRectValues.top<0&&documentHeight+(targetRectValues.height+targetRectValues.top)>0&&calculatedHeight+(targetTop=targetRectValues.top)<=30&&(calculatedHeight=targetRectValues.height-(targetRectValues.height+targetRectValues.top)+30),calculatedHeight+targetRectValues.top>=maxHeight&&(ej2_popups_es2015_targetElement.style.height=targetRectValues.height+(documentHeight-(targetRectValues.height+targetRectValues.top))+"px");let calculatedTop=isNullOrUndefined(containerElement)?targetTop:topWithoutborder;calculatedHeight>=minHeight&&calculatedHeight+calculatedTop<=maxHeight&&(ej2_popups_es2015_targetElement.style.height=calculatedHeight+"px")}}function resizeNorth(e){let boundaryRectValues,calculateValue=!1,pageY="mouse"===getEventType(e.type)?e.pageY:e.touches[0].pageY,targetRectValues=getClientRectValues(ej2_popups_es2015_targetElement);isNullOrUndefined(containerElement)||(boundaryRectValues=getClientRectValues(containerElement)),!isNullOrUndefined(containerElement)&&targetRectValues.top-boundaryRectValues.top>0?calculateValue=!0:isNullOrUndefined(containerElement)&&pageY>0&&(calculateValue=!0);let currentHeight=originalHeight-(pageY-originalMouseY);if(getClientRectValues(ej2_popups_es2015_targetElement).bottom+currentHeight>maxHeight&&(calculateValue=!1,ej2_popups_es2015_targetElement.style.height=maxHeight-getClientRectValues(ej2_popups_es2015_targetElement).bottom+"px"),calculateValue&&currentHeight>=minHeight&&currentHeight<=maxHeight){let containerTop=0;isNullOrUndefined(containerElement)||(containerTop=boundaryRectValues.top);let top=originalY-containerTop+(pageY-originalMouseY);top=top>0?top:1,ej2_popups_es2015_targetElement.style.height=currentHeight+"px",ej2_popups_es2015_targetElement.style.top=top+"px"}}function resizeWest(e){let rectValues,documentWidth=document.documentElement.clientWidth,calculateValue=!1;isNullOrUndefined(containerElement)||(rectValues=getClientRectValues(containerElement));let pageX="mouse"===getEventType(e.type)?e.pageX:e.touches[0].pageX,targetRectValues=getClientRectValues(ej2_popups_es2015_targetElement),borderValue=isNullOrUndefined(containerElement)?0:containerElement.offsetWidth-containerElement.clientWidth,left=isNullOrUndefined(containerElement)?0:rectValues.left,containerWidth=isNullOrUndefined(containerElement)?0:rectValues.width;isNullOrUndefined(resizeWestWidth)&&(isNullOrUndefined(containerElement)?resizeWestWidth=documentWidth:(resizeWestWidth=targetRectValues.left-left-borderValue/2+targetRectValues.width,resizeWestWidth+=containerWidth-borderValue-resizeWestWidth)),!isNullOrUndefined(containerElement)&&targetRectValues.left-rectValues.left+targetRectValues.width+(rectValues.right-targetRectValues.right)-borderValue<=maxWidth?calculateValue=!0:isNullOrUndefined(containerElement)&&pageX>=0&&(calculateValue=!0);let calculatedWidth=originalWidth-(pageX-originalMouseX);if(setLeft&&(calculatedWidth=calculatedWidth>resizeWestWidth?resizeWestWidth:calculatedWidth),calculateValue&&calculatedWidth>=minWidth&&calculatedWidth<=maxWidth){let containerLeft=0;isNullOrUndefined(containerElement)||(containerLeft=rectValues.left);let left=originalX-containerLeft+(pageX-originalMouseX);left=left>0?left:1,calculatedWidth!==previousWidth&&setWidth&&(ej2_popups_es2015_targetElement.style.width=calculatedWidth+"px"),setLeft&&(ej2_popups_es2015_targetElement.style.left=left+"px",setWidth=1!==left)}previousWidth=calculatedWidth}function resizeEast(e){let containerRectValues,documentWidth=document.documentElement.clientWidth,calculateValue=!1;isNullOrUndefined(containerElement)||(containerRectValues=getClientRectValues(containerElement));let pageX="mouse"===getEventType(e.type)?e.pageX:e.touches[0].pageX,targetRectValues=getClientRectValues(ej2_popups_es2015_targetElement);!isNullOrUndefined(containerElement)&&(targetRectValues.left-containerRectValues.left+targetRectValues.width<maxWidth||targetRectValues.right-containerRectValues.left>targetRectValues.width)?calculateValue=!0:isNullOrUndefined(containerElement)&&documentWidth-pageX>0&&(calculateValue=!0);let calculatedWidth=originalWidth+(pageX-originalMouseX),containerLeft=0;if(isNullOrUndefined(containerElement)||(containerLeft=containerRectValues.left),targetRectValues.left-containerLeft+calculatedWidth>maxWidth){if(calculateValue=!1,ej2_popups_es2015_targetElement.classList.contains(RESIZE_WITHIN_VIEWPORT))return;ej2_popups_es2015_targetElement.style.width=maxWidth-(targetRectValues.left-containerLeft)+"px"}calculateValue&&calculatedWidth>=minWidth&&calculatedWidth<=maxWidth&&(ej2_popups_es2015_targetElement.style.width=calculatedWidth+"px")}function removeResize(){let handlers=ej2_popups_es2015_targetElement.querySelectorAll("."+RESIZE_HANDLER);for(let i=0;i<handlers.length;i++)detach(handlers[i])}let ej2_popups_es2015_ButtonProps=(()=>{class ButtonProps extends ChildProperty{}return __decorate([Property()],ButtonProps.prototype,"buttonModel",void 0),__decorate([Property("Button")],ButtonProps.prototype,"type",void 0),__decorate([ej2_base_es2015_Event()],ButtonProps.prototype,"click",void 0),ButtonProps})(),ej2_popups_es2015_AnimationSettings=(()=>{class AnimationSettings extends ChildProperty{}return __decorate([Property("Fade")],AnimationSettings.prototype,"effect",void 0),__decorate([Property(400)],AnimationSettings.prototype,"duration",void 0),__decorate([Property(0)],AnimationSettings.prototype,"delay",void 0),AnimationSettings})();const ROOT="e-dialog",DLG_UTIL_DEFAULT_TITLE="Information";let ej2_popups_es2015_Dialog=(()=>{let Dialog=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}render(){this.initialize(),this.initRender(),this.wireEvents(),"100%"===this.width&&(this.element.style.width=""),this.enableResize&&(this.setResize(),"None"===this.animationSettings.effect&&this.getMinHeight()),this.renderComplete()}preRender(){this.headerContent=null,this.allowMaxHeight=!0;let classArray=[];for(let j=0;j<this.element.classList.length;j++)isNullOrUndefined(this.element.classList[j].match("e-control"))&&isNullOrUndefined(this.element.classList[j].match(ROOT))||classArray.push(this.element.classList[j]);if(removeClass([this.element],classArray),this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=event=>{this.hide(event)},this.dlgOverlayClickEventHandler=event=>{this.trigger("overlayClick",event),this.focusContent()},this.l10n=new L10n("dialog",{close:"Close"},this.locale),this.checkPositionData(),isNullOrUndefined(this.target)){let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=prevOnChange}}isNumberValue(value){return/^[-+]?\d*\.?\d+$/.test(value)}checkPositionData(){if(!isNullOrUndefined(this.position)){if(!isNullOrUndefined(this.position.X)&&"number"!=typeof this.position.X&&this.isNumberValue(this.position.X)){let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.X=parseFloat(this.position.X),this.isProtectedOnChange=prevOnChange}if(!isNullOrUndefined(this.position.Y)&&"number"!=typeof this.position.Y&&this.isNumberValue(this.position.Y)){let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.Y=parseFloat(this.position.Y),this.isProtectedOnChange=prevOnChange}}}getEle(list,selector){let element=void 0;for(let i=0;i<list.length;i++)if(list[i].classList.contains(selector)){element=list[i];break}return element}getMinHeight(){let computedHeaderHeight="0px",computedFooterHeight="0px";isNullOrUndefined(this.element.querySelector(".e-dlg-header-content"))||(computedHeaderHeight=getComputedStyle(this.headerContent).height);let footerEle=this.getEle(this.element.children,"e-footer-content");isNullOrUndefined(footerEle)||(computedFooterHeight=getComputedStyle(footerEle).height);let headerHeight=parseInt(computedHeaderHeight.slice(0,computedHeaderHeight.indexOf("p")),10),footerHeight=parseInt(computedFooterHeight.slice(0,computedFooterHeight.indexOf("p")),10);minHeight=headerHeight+30+footerHeight}onResizeStart(args){return this.trigger("resizeStart",args),args.cancel}onResizing(args){this.trigger("resizing",args)}onResizeComplete(args){this.trigger("resizeStop",args)}setResize(){if(this.enableResize){this.element.classList.add("e-dlg-resizable");let computedHeight=getComputedStyle(this.element).minHeight,computedWidth=getComputedStyle(this.element).minWidth,direction=this.enableRtl?"south-west":"south-east";this.isModal&&this.enableRtl?this.element.classList.add("e-restrict-left"):this.isModal&&this.target===document.body&&this.element.classList.add("e-resize-viewport"),function(args){resizeStart=args.resizeBegin,resize=args.resizing,resizeEnd=args.resizeComplete,ej2_popups_es2015_targetElement=getDOMElement(args.element),containerElement=getDOMElement(args.boundary);let directions=args.direction.split(" ");for(let i=0;i<directions.length;i++){let resizeHandler=ej2_base_es2015_createElement("div",{className:"e-icons "+RESIZE_HANDLER+" e-"+directions[i]});ej2_popups_es2015_targetElement.appendChild(resizeHandler)}minHeight=args.minHeight,minWidth=args.minWidth,maxWidth=args.maxWidth,maxHeight=args.maxHeight,function(){let resizers=ej2_popups_es2015_targetElement.querySelectorAll("."+RESIZE_HANDLER);for(let i=0;i<resizers.length;i++)EventHandler.add(selectedHandler=resizers[i],"mousedown",onMouseDown,this),EventHandler.add(selectedHandler,"msie"===Browser.info.name?"pointerdown":"touchstart",onTouchStart,this)}()}({element:this.element,direction:direction,minHeight:parseInt(computedHeight.slice(0,computedWidth.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(computedWidth.slice(0,computedWidth.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:this.target===document.body?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this)})}else removeResize(),this.element.classList.remove(this.isModal?"e-restrict-left":"e-resize-viewport"),this.element.classList.remove("e-dlg-resizable")}keyDown(event){if(9===event.keyCode&&this.isModal){let buttonObj;isNullOrUndefined(this.btnObj)||(buttonObj=this.btnObj[this.btnObj.length-1]),isNullOrUndefined(buttonObj)||document.activeElement!==buttonObj.element||event.shiftKey||(event.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&event.shiftKey&&(event.preventDefault(),isNullOrUndefined(buttonObj)||buttonObj.element.focus())}let element=document.activeElement,isTagName=["input","textarea"].indexOf(element.tagName.toLowerCase())>-1,isContentEdit=!1;if(isTagName||(isContentEdit=element.hasAttribute("contenteditable")&&"true"===element.getAttribute("contenteditable")),27===event.keyCode&&this.closeOnEscape&&this.hide(event),13===event.keyCode&&!event.ctrlKey&&"textarea"!==element.tagName.toLowerCase()&&isTagName&&!isNullOrUndefined(this.primaryButtonEle)||13===event.keyCode&&event.ctrlKey&&("textarea"===element.tagName.toLowerCase()||isContentEdit)&&!isNullOrUndefined(this.primaryButtonEle)){let buttonIndex;this.buttons.some((data,index)=>{buttonIndex=index;let buttonModel=data.buttonModel;return!isNullOrUndefined(buttonModel)&&!0===buttonModel.isPrimary})&&"function"==typeof this.buttons[buttonIndex].click&&setTimeout(()=>{this.buttons[buttonIndex].click.call(this,event)})}}initialize(){isNullOrUndefined(this.target)||(this.targetEle="string"==typeof this.target?document.querySelector(this.target):this.target),addClass([this.element],ROOT),Browser.isDevice&&addClass([this.element],"e-device"),this.setCSSClass(),this.setMaxHeight()}initRender(){this.initialRender=!0,attributes(this.element,{role:"dialog"}),1e3===this.zIndex?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.setTargetContent(),""===this.header||isNullOrUndefined(this.header)||this.setHeader(),this.showCloseIcon&&this.renderCloseIcon(),this.setContent(),""===this.footerTemplate||isNullOrUndefined(this.footerTemplate)?isNullOrUndefined(this.buttons[0].buttonModel)||this.setButton():this.setFooterTemplate(),this.allowDragging&&!isNullOrUndefined(this.headerContent)&&this.setAllowDragging(),attributes(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal(),isNullOrUndefined(this.targetEle)||this.targetEle.appendChild(this.isModal?this.dlgContainer:this.element),this.popupObj=new ej2_popups_es2015_Popup(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",open:event=>{this.focusContent();let eventArgs={container:this.isModal?this.dlgContainer:this.element,element:this.element,target:this.target};this.enableResize&&this.getMinHeight(),this.trigger("open",eventArgs)},close:event=>{this.isModal&&addClass([this.dlgOverlay],"e-fade"),this.unBindEvent(this.element),this.isModal&&(this.dlgContainer.style.display="none"),this.trigger("close",this.closeArgs);let activeEle=document.activeElement;isNullOrUndefined(activeEle)||isNullOrUndefined(activeEle.blur)||activeEle.blur(),isNullOrUndefined(this.storeActiveElement)||this.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),addClass([this.element],"e-popup-close"),this.isModal&&this.setOverlayZindex(),this.visible?this.show():this.isModal&&(this.dlgOverlay.style.display="none"),this.initialRender=!1}setOverlayZindex(zIndexValue){let zIndex;zIndex=isNullOrUndefined(zIndexValue)?parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:zIndexValue,this.dlgOverlay.style.zIndex=(zIndex-1).toString(),this.dlgContainer.style.zIndex=zIndex.toString()}positionChange(){this.isModal&&(isNaN(parseFloat(this.position.X))||isNaN(parseFloat(this.position.Y)))?!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()}setPopupPosition(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})}setAllowDragging(){this.dragObj=new ej2_base_es2015_Draggable(this.element,{clone:!1,abort:".e-dlg-closeicon-btn",handle:".e-dlg-header-content",dragStart:event=>{this.trigger("dragStart",event)},dragStop:event=>{this.isModal&&(isNullOrUndefined(this.position)||this.dlgContainer.classList.remove("e-dlg-"+this.position.X+"-"+this.position.Y),this.element.style.position="relative"),this.trigger("dragStop",event),this.element.classList.remove("e-restrict-left")},drag:event=>{this.trigger("drag",event)}}),isNullOrUndefined(this.targetEle)||(this.dragObj.dragArea=this.targetEle)}setButton(){this.buttonContent=[],this.btnObj=[];for(let i=0;i<this.buttons.length;i++){let buttonType=isNullOrUndefined(this.buttons[i].type)?"button":this.buttons[i].type.toLowerCase(),btn=this.createElement("button",{attrs:{type:buttonType}});this.buttonContent.push(btn.outerHTML)}this.setFooterTemplate();for(let i=0;i<this.buttons.length;i++)this.btnObj[i]=new ej2_buttons_es2015_Button(this.buttons[i].buttonModel),"function"==typeof this.buttons[i].click&&EventHandler.add(this.ftrTemplateContent.children[i],"click",this.buttons[i].click,this),this.btnObj[i].appendTo(this.ftrTemplateContent.children[i]),this.btnObj[i].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]}setContent(){if(attributes(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.contentEle=this.createElement("div",{className:"e-dlg-content",id:this.element.id+"_dialog-content"}),this.innerContentElement)this.contentEle.appendChild(this.innerContentElement);else if(!isNullOrUndefined(this.content)&&""!==this.content||!this.initialRender){let blazorContain=Object.keys(window);"string"==typeof this.content&&-1===blazorContain.indexOf("ejsInterop")?this.contentEle.innerHTML=this.content:this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle)}isNullOrUndefined(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),"auto"===this.height&&this.setMaxHeight()}setTemplate(template,toElement){let templateFn,templateProps,templateValue,blazorContain=Object.keys(window);templateProps=toElement.classList.contains("e-dlg-header")?this.element.id+"header":toElement.classList.contains("e-footer-content")?this.element.id+"footerTemplate":this.element.id+"content",isNullOrUndefined(template.outerHTML)?(templateFn=compile$$1(template),templateValue=template):(templateFn=compile$$1(template.outerHTML),templateValue=template.outerHTML);let fromElements=[];if(!isNullOrUndefined(templateFn)){let isString=!(-1!==blazorContain.indexOf("ejsInterop")&&!this.isStringTemplate&&0===templateValue.indexOf("<div>Blazor"))||this.isStringTemplate;for(let item of templateFn({},null,null,templateProps,isString))fromElements.push(item);append([].slice.call(fromElements),toElement),-1===blazorContain.indexOf("ejsInterop")||this.isStringTemplate||0!==templateValue.indexOf("<div>Blazor")||this.blazorTemplate(templateProps)}}blazorTemplate(templateProps){updateBlazorTemplate(templateProps,templateProps===this.element.id+"header"?"Header":templateProps===this.element.id+"footerTemplate"?"FooterTemplate":"Content",this)}setMaxHeight(){if(!this.allowMaxHeight)return;let display=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!isNullOrUndefined(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=display}setEnableRTL(){this.enableRtl?addClass([this.element],"e-rtl"):removeClass([this.element],"e-rtl"),isNullOrUndefined(this.element.querySelector(".e-resize-handle"))||(removeResize(),this.setResize())}setTargetContent(){if(isNullOrUndefined(this.content)||""===this.content){let isContent=""!==this.element.innerHTML.replace(/\s|<(\/?|\!?)(!--!--)>/g,"");(this.element.children.length>0||isContent)&&(this.innerContentElement=document.createDocumentFragment(),[].slice.call(this.element.childNodes).forEach(el=>{8!==el.nodeType&&this.innerContentElement.appendChild(el)}))}}setHeader(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:"e-dlg-header"}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle),attributes(this.element,{"aria-labelledby":this.element.id+"_title"}),this.element.insertBefore(this.headerContent,this.element.children[0])}setFooterTemplate(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:"e-footer-content"}),""===this.footerTemplate||isNullOrUndefined(this.footerTemplate)?this.ftrTemplateContent.innerHTML=this.buttonContent.join(""):this.setTemplate(this.footerTemplate,this.ftrTemplateContent),this.element.appendChild(this.ftrTemplateContent)}createHeaderContent(){isNullOrUndefined(this.headerContent)&&(this.headerContent=this.createElement("div",{className:"e-dlg-header-content"}))}renderCloseIcon(){this.closeIcon=this.createElement("button",{className:"e-dlg-closeicon-btn",attrs:{type:"button"}}),this.closeIconBtnObj=new ej2_buttons_es2015_Button({cssClass:"e-flat",iconCss:"e-icon-dlg-close e-icons"}),this.closeIconTitle(),isNullOrUndefined(this.headerContent)?(this.createHeaderContent(),prepend([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):prepend([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon)}closeIconTitle(){this.l10n.setLocale(this.locale);let closeIconTitle=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",closeIconTitle)}setCSSClass(oldCSSClass){this.cssClass&&addClass([this.element],this.cssClass.split(" ")),oldCSSClass&&removeClass([this.element],oldCSSClass.split(" "))}setIsModal(){this.dlgContainer=this.createElement("div",{className:"e-dlg-container"}),this.element.classList.remove("e-popup-open"),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),addClass([this.element],"e-dlg-modal"),this.dlgOverlay=this.createElement("div",{className:"e-dlg-overlay"}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)}getValidFocusNode(items){let node;for(let u=0;u<items.length;u++)if(((node=items[u]).clientHeight>0||"a"===node.tagName.toLowerCase()&&node.hasAttribute("href"))&&node.tabIndex>-1&&!node.disabled&&!this.disableElement(node,'[disabled],[aria-disabled="true"],[type="hidden"]'))return node;return node}focusableElements(content){if(!isNullOrUndefined(content)){let items=content.querySelectorAll('input,select,textarea,button,a,[contenteditable="true"],[tabindex]');return this.getValidFocusNode(items)}return null}getAutoFocusNode(container){let node=container.querySelector(".e-dlg-closeicon-btn"),items=container.querySelectorAll("[autofocus]"),validNode=this.getValidFocusNode(items);if(isNullOrUndefined(validNode)){if(!isNullOrUndefined(validNode=this.focusableElements(this.contentEle)))return validNode;if(!isNullOrUndefined(this.primaryButtonEle))return this.element.querySelector(".e-primary")}else node=validNode;return node}disableElement(element,t){let elementMatch=element?element.matches||element.webkitMatchesSelector||element.msMatchesSelector:null;if(elementMatch)for(;element;element=element.parentNode)if(element instanceof Element&&elementMatch.call(element,t))return element;return null}focusContent(){let element=this.getAutoFocusNode(this.element);(isNullOrUndefined(element)?this.element:element).focus(),this.bindEvent(this.element)}bindEvent(element){EventHandler.add(element,"keydown",this.keyDown,this)}unBindEvent(element){EventHandler.remove(element,"keydown",this.keyDown)}getModuleName(){return"dialog"}onPropertyChanged(newProp,oldProp){if(this.element.classList.contains(ROOT))for(let prop of Object.keys(newProp))switch(prop){case"content":isNullOrUndefined(this.content)||""===this.content?isNullOrUndefined(this.contentEle)||(detach(this.contentEle),this.contentEle=null):isNullOrUndefined(this.contentEle)||"dialog"===this.contentEle.getAttribute("role")?this.setContent():(this.contentEle.innerHTML="","string"==typeof this.content?this.contentEle.innerHTML=this.content:this.contentEle.appendChild(this.content),this.setMaxHeight());break;case"header":""===this.header||isNullOrUndefined(this.header)?this.headerEle&&(detach(this.headerEle),this.headerEle=null):this.setHeader();break;case"footerTemplate":if(""===this.footerTemplate||isNullOrUndefined(this.footerTemplate)){if(!this.ftrTemplateContent)return;detach(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName("e-icon-dlg-close").length>0?this.showCloseIcon||""!==this.header&&!isNullOrUndefined(this.header)?this.showCloseIcon||detach(this.closeIcon):(detach(this.headerContent),this.headerContent=null):(this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":setStyleAttribute(this.element,{height:formatUnit(newProp.height)});break;case"width":setStyleAttribute(this.element,{width:formatUnit(newProp.width)});break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.calculatezIndex=!1;break;case"cssClass":this.setCSSClass(oldProp.cssClass);break;case"buttons":let buttonCount=this.buttons.length;isNullOrUndefined(this.ftrTemplateContent)||(detach(this.ftrTemplateContent),this.ftrTemplateContent=null);for(let i=0;i<buttonCount;i++)isNullOrUndefined(this.buttons[i].buttonModel)||(this.footerTemplate="",this.setButton());break;case"allowDragging":this.allowDragging&&!isNullOrUndefined(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.popupObj.relateTo=newProp.target;break;case"position":if(this.checkPositionData(),this.isModal){let positionX=isNullOrUndefined(oldProp.position.X)?this.position.X:oldProp.position.X,positionY=isNullOrUndefined(oldProp.position.Y)?this.position.Y:oldProp.position.Y;this.dlgContainer.classList.contains("e-dlg-"+positionX+"-"+positionY)&&this.dlgContainer.classList.remove("e-dlg-"+positionX+"-"+positionY)}this.positionChange();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize()}}updateIsModal(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",isNullOrUndefined(this.targetEle)||this.targetEle.appendChild(this.dlgContainer);else{for(removeClass([this.element],"e-dlg-modal"),removeClass([document.body],"e-scroll-disabled"),detach(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange(),this.isModal&&this.dlgOverlay&&EventHandler.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)}setzIndex(zIndexElement,setPopupZindex){let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.zIndex=getZindexPartial(zIndexElement),this.isProtectedOnChange=prevOnChange,setPopupZindex&&(this.popupObj.zIndex=this.zIndex)}getPersistData(){return this.addOnPersist([])}destroy(){if(this.element.classList.contains(ROOT)){if(this.unWireEvents(),super.destroy(),removeClass([this.element,this.element],[ROOT,"e-rtl","e-dlg-modal"]),this.popupObj.element.classList.contains("e-popup")&&this.popupObj.destroy(),!isNullOrUndefined(this.btnObj))for(let i;i<this.btnObj.length;i++)this.btnObj[i].destroy();for(this.isModal&&(detach(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),detach(this.dlgContainer)),this.element.innerHTML="";this.element.attributes.length>0;)this.element.removeAttribute(this.element.attributes[0].name);for(let k=0;k<this.clonedEle.attributes.length;k++)this.element.setAttribute(this.clonedEle.attributes[k].name,this.clonedEle.attributes[k].value)}}wireEvents(){this.showCloseIcon&&EventHandler.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&this.dlgOverlay&&EventHandler.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)}unWireEvents(){if(this.showCloseIcon&&EventHandler.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&EventHandler.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler),!isNullOrUndefined(this.buttons[0].buttonModel))for(let i=0;i<this.buttons.length;i++)"function"==typeof this.buttons[i].click&&EventHandler.remove(this.ftrTemplateContent.children[i],"click",this.buttons[i].click)}refreshPosition(){this.popupObj.refreshPosition()}show(isFullScreen){if(this.element.classList.contains(ROOT)&&(!this.element.classList.contains("e-popup-open")||!isNullOrUndefined(isFullScreen))){isNullOrUndefined(isFullScreen)||this.fullScreen(isFullScreen);let eventArgs=isBlazor()?{cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,maxHeight:this.element.style.maxHeight}:{cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target,maxHeight:this.element.style.maxHeight};this.trigger("beforeOpen",eventArgs,beforeOpenArgs=>{if(!beforeOpenArgs.cancel){this.element.style.maxHeight!==eventArgs.maxHeight&&(this.allowMaxHeight=!1,this.element.style.maxHeight=eventArgs.maxHeight),this.storeActiveElement=document.activeElement,this.element.tabIndex=-1,this.isModal&&!isNullOrUndefined(this.dlgOverlay)&&(this.dlgOverlay.style.display="block",this.dlgContainer.style.display="flex",removeClass([this.dlgOverlay],"e-fade"),isNullOrUndefined(this.targetEle)?addClass([document.body],"e-scroll-disabled"):(this.dlgContainer.style.position=this.targetEle===document.body?"fixed":"absolute",this.dlgOverlay.style.position="absolute",this.element.style.position="relative",addClass([this.targetEle],"e-scroll-disabled")));let openAnimation={name:this.animationSettings.effect+"In",duration:this.animationSettings.duration,delay:this.animationSettings.delay},zIndexElement=this.isModal?this.element.parentElement:this.element;this.calculatezIndex&&(this.setzIndex(zIndexElement,!0),setStyleAttribute(this.element,{zIndex:this.zIndex}),this.isModal&&this.setOverlayZindex(this.zIndex)),"None"===this.animationSettings.effect?this.popupObj.show():this.popupObj.show(openAnimation),this.dialogOpen=!0;let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!0,this.isProtectedOnChange=prevOnChange}})}}hide(event){if(this.element.classList.contains(ROOT)&&this.visible){let eventArgs=isBlazor()?{cancel:!1,isInteraction:!!event,isInteracted:!!event,element:this.element,container:this.isModal?this.dlgContainer:this.element,event:event}:{cancel:!1,isInteraction:!!event,isInteracted:!!event,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:event};this.closeArgs=eventArgs,this.trigger("beforeClose",eventArgs,beforeCloseArgs=>{if(!beforeCloseArgs.cancel){this.isModal&&(isNullOrUndefined(this.targetEle)?removeClass([document.body],"e-scroll-disabled"):removeClass([this.targetEle],"e-scroll-disabled"));let closeAnimation={name:this.animationSettings.effect+"Out",duration:this.animationSettings.duration,delay:this.animationSettings.delay};"None"===this.animationSettings.effect?this.popupObj.hide():this.popupObj.hide(closeAnimation),this.dialogOpen=!1;let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!1,this.isProtectedOnChange=prevOnChange}})}}fullScreen(args){if(args){addClass([this.element],"e-dlg-fullscreen");let display=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=isNullOrUndefined(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=display,addClass([document.body],"e-scroll-disabled"),this.allowDragging&&!isNullOrUndefined(this.dragObj)&&this.dragObj.destroy()}else removeClass([this.element],"e-dlg-fullscreen"),removeClass([document.body],"e-scroll-disabled"),this.allowDragging&&!isNullOrUndefined(this.headerContent)&&this.setAllowDragging();return args}getButtons(index){return isNullOrUndefined(index)?this.btnObj:this.btnObj[index]}};return __decorate([Property("")],Dialog.prototype,"content",void 0),__decorate([Property(!1)],Dialog.prototype,"showCloseIcon",void 0),__decorate([Property(!1)],Dialog.prototype,"isModal",void 0),__decorate([Property("")],Dialog.prototype,"header",void 0),__decorate([Property(!0)],Dialog.prototype,"visible",void 0),__decorate([Property(!1)],Dialog.prototype,"enableResize",void 0),__decorate([Property("auto")],Dialog.prototype,"height",void 0),__decorate([Property("100%")],Dialog.prototype,"width",void 0),__decorate([Property("")],Dialog.prototype,"cssClass",void 0),__decorate([Property(1e3)],Dialog.prototype,"zIndex",void 0),__decorate([Property(null)],Dialog.prototype,"target",void 0),__decorate([Property("")],Dialog.prototype,"footerTemplate",void 0),__decorate([Property(!1)],Dialog.prototype,"allowDragging",void 0),__decorate([Collection([{}],ej2_popups_es2015_ButtonProps)],Dialog.prototype,"buttons",void 0),__decorate([Property(!0)],Dialog.prototype,"closeOnEscape",void 0),__decorate([Complex({},ej2_popups_es2015_AnimationSettings)],Dialog.prototype,"animationSettings",void 0),__decorate([Complex({X:"center",Y:"center"},ej2_popups_es2015_PositionData)],Dialog.prototype,"position",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"beforeOpen",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"close",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"beforeClose",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"dragStart",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"dragStop",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"drag",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"overlayClick",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"resizeStart",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"resizing",void 0),__decorate([ej2_base_es2015_Event()],Dialog.prototype,"resizeStop",void 0),__decorate([NotifyPropertyChanges],Dialog)})();var ej2_popups_es2015_DialogUtility;!function(DialogUtility){function createDialog(options,element){let dialogObject=new ej2_popups_es2015_Dialog(options);return dialogObject.appendTo(element),dialogObject}function formOptions(options,option){return options.header=isNullOrUndefined(option.title)?DLG_UTIL_DEFAULT_TITLE:option.title,options.content=isNullOrUndefined(option.content)?"":option.content,options.isModal=!!isNullOrUndefined(option.isModal)||option.isModal,options.showCloseIcon=!isNullOrUndefined(option.showCloseIcon)&&option.showCloseIcon,options.allowDragging=!isNullOrUndefined(option.isDraggable)&&option.isDraggable,options.closeOnEscape=!isNullOrUndefined(option.closeOnEscape)&&option.closeOnEscape,options.position=isNullOrUndefined(option.position)?{X:"center",Y:"top"}:option.position,options.animationSettings=isNullOrUndefined(option.animationSettings)?{effect:"Fade",duration:400,delay:0}:option.animationSettings,options.cssClass=isNullOrUndefined(option.cssClass)?"":option.cssClass,options.zIndex=isNullOrUndefined(option.zIndex)?1e3:option.zIndex,options.open=isNullOrUndefined(option.open)?null:option.open,options}function formButtonModel(buttonModel,option,buttonPropModel){let buttonProps=buttonPropModel;return isNullOrUndefined(option.text)||(buttonProps.buttonModel.content=option.text),isNullOrUndefined(option.icon)||(buttonProps.buttonModel.iconCss=option.icon),isNullOrUndefined(option.cssClass)||(buttonProps.buttonModel.cssClass=option.cssClass),isNullOrUndefined(option.click)||(buttonProps.click=option.click),buttonProps}DialogUtility.alert=function(args){let alertDialogObj,dialogElement=ej2_base_es2015_createElement("div",{className:"e-alert-dialog"});return document.body.appendChild(dialogElement),(alertDialogObj=createDialog("string"==typeof args?{content:args,position:{X:"center",Y:"top"},isModal:!0,header:DLG_UTIL_DEFAULT_TITLE,buttons:[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}]}:function(option){let options={buttons:[]};return function(options,option){let alertButtonModel=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return isNullOrUndefined(option.okButton)?options.buttons=alertButtonModel:options.buttons[0]=formButtonModel(0,option.okButton,alertButtonModel[0]),options}(options=formOptions(options,option),option)}(args),dialogElement)).close=()=>{args&&args.close&&args.close.apply(alertDialogObj),alertDialogObj.destroy(),alertDialogObj.element.classList.contains("e-dlg-modal")?(alertDialogObj.element.parentElement.remove(),alertDialogObj.target.classList.remove("e-scroll-disabled")):alertDialogObj.element.remove()},alertDialogObj},DialogUtility.confirm=function(args){let confirmDialogObj,dialogElement=ej2_base_es2015_createElement("div",{className:"e-confirm-dialog"});return document.body.appendChild(dialogElement),(confirmDialogObj=createDialog("string"==typeof args?{position:{X:"center",Y:"top"},content:args,isModal:!0,header:DLG_UTIL_DEFAULT_TITLE,buttons:[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},{buttonModel:{content:"Cancel"},click:function(){this.hide()}}]}:function(option){let options={buttons:[]};return function(options,option){let okButtonModel={buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},cancelButtonModel={buttonModel:{content:"Cancel"},click:function(){this.hide()}};return options.buttons[0]=isNullOrUndefined(option.okButton)?okButtonModel:formButtonModel(0,option.okButton,okButtonModel),options.buttons[1]=isNullOrUndefined(option.cancelButton)?cancelButtonModel:formButtonModel(0,option.cancelButton,cancelButtonModel),options}(options=formOptions(options,option),option)}(args),dialogElement)).close=()=>{args&&args.close&&args.close.apply(confirmDialogObj),confirmDialogObj.destroy(),confirmDialogObj.element.classList.contains("e-dlg-modal")?(confirmDialogObj.element.parentElement.remove(),confirmDialogObj.target.classList.remove("e-scroll-disabled")):confirmDialogObj.element.remove()},confirmDialogObj}}(ej2_popups_es2015_DialogUtility||(ej2_popups_es2015_DialogUtility={}));let ej2_popups_es2015_Animation$1=(()=>{class Animation$1 extends ChildProperty{}return __decorate([Property({effect:"FadeIn",duration:150,delay:0})],Animation$1.prototype,"open",void 0),__decorate([Property({effect:"FadeOut",duration:150,delay:0})],Animation$1.prototype,"close",void 0),Animation$1})(),ej2_popups_es2015_Tooltip=(()=>{let Tooltip=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}initialize(){this.formatPosition(),addClass([this.element],"e-tooltip")}formatPosition(){0===this.position.indexOf("Top")||0===this.position.indexOf("Bottom")?[this.tooltipPositionY,this.tooltipPositionX]=this.position.split(/(?=[A-Z])/):[this.tooltipPositionX,this.tooltipPositionY]=this.position.split(/(?=[A-Z])/)}renderArrow(){this.setTipClass(this.position);let tip=this.createElement("div",{className:"e-arrow-tip "+this.tipClass});tip.appendChild(this.createElement("div",{className:"e-arrow-tip-outer "+this.tipClass})),tip.appendChild(this.createElement("div",{className:"e-arrow-tip-inner "+this.tipClass})),this.tooltipEle.appendChild(tip)}setTipClass(position){this.tipClass=0===position.indexOf("Right")?"e-tip-left":0===position.indexOf("Bottom")?"e-tip-top":0===position.indexOf("Left")?"e-tip-right":"e-tip-bottom"}renderPopup(target){let elePos=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(target);this.tooltipEle.classList.remove("e-lib"),this.popupObj=new ej2_popups_es2015_Popup(this.tooltipEle,{height:this.height,width:this.width,position:{X:elePos.left,Y:elePos.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})}getTooltipPosition(target){this.tooltipEle.style.display="none";let pos=calculatePosition(target,this.tooltipPositionX,this.tooltipPositionY);this.tooltipEle.style.display="";let offsetPos=this.calculateTooltipOffset(this.position);return this.collisionFlipFit(target,pos.left+offsetPos.left,pos.top+offsetPos.top)}reposition(target){let elePos=this.getTooltipPosition(target);this.popupObj.position={X:elePos.left,Y:elePos.top},this.popupObj.dataBind()}openPopupHandler(){this.needTemplateReposition()&&!this.mouseTrail&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs)}closePopupHandler(){resetBlazorTemplate(this.element.id+"content"),this.clear(),this.trigger("afterClose",this.tooltipEventArgs)}calculateTooltipOffset(position){let pos={top:0,left:0},tooltipEleWidth=this.tooltipEle.offsetWidth,tooltipEleHeight=this.tooltipEle.offsetHeight,arrowEle=this.tooltipEle.querySelector(".e-arrow-tip"),tipWidth=arrowEle?arrowEle.offsetWidth:0,tipHeight=arrowEle?arrowEle.offsetHeight:0,tipAdjust=this.showTipPointer?0:8,tipHeightAdjust=tipHeight/2+2+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),tipWidthAdjust=tipWidth/2+2+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(tipAdjust+=2),position){case"RightTop":pos.left+=tipWidth+tipAdjust,pos.top-=tooltipEleHeight-tipHeightAdjust;break;case"RightCenter":pos.left+=tipWidth+tipAdjust,pos.top-=tooltipEleHeight/2;break;case"RightBottom":pos.left+=tipWidth+tipAdjust,pos.top-=tipHeightAdjust;break;case"BottomRight":pos.top+=tipHeight+tipAdjust,pos.left-=tipWidthAdjust;break;case"BottomCenter":pos.top+=tipHeight+tipAdjust,pos.left-=tooltipEleWidth/2;break;case"BottomLeft":pos.top+=tipHeight+tipAdjust,pos.left-=tooltipEleWidth-tipWidthAdjust;break;case"LeftBottom":pos.left-=tipWidth+tooltipEleWidth+tipAdjust,pos.top-=tipHeightAdjust;break;case"LeftCenter":pos.left-=tipWidth+tooltipEleWidth+tipAdjust,pos.top-=tooltipEleHeight/2;break;case"LeftTop":pos.left-=tipWidth+tooltipEleWidth+tipAdjust,pos.top-=tooltipEleHeight-tipHeightAdjust;break;case"TopLeft":pos.top-=tooltipEleHeight+tipHeight+tipAdjust,pos.left-=tooltipEleWidth-tipWidthAdjust;break;case"TopRight":pos.top-=tooltipEleHeight+tipHeight+tipAdjust,pos.left-=tipWidthAdjust;break;default:pos.top-=tooltipEleHeight+tipHeight+tipAdjust,pos.left-=tooltipEleWidth/2}return pos.left+=this.offsetX,pos.top+=this.offsetY,pos}updateTipPosition(position){let selEle=this.tooltipEle.querySelectorAll(".e-arrow-tip,.e-arrow-tip-outer,.e-arrow-tip-inner");removeClass(selEle,["e-tip-bottom","e-tip-top","e-tip-left","e-tip-right"]),this.setTipClass(position),addClass(selEle,this.tipClass)}adjustArrow(target,position,tooltipPositionX,tooltipPositionY){if(!1===this.showTipPointer)return;let leftValue,topValue;this.updateTipPosition(position);let tooltipWidth=this.tooltipEle.clientWidth,tooltipHeight=this.tooltipEle.clientHeight,arrowEle=this.tooltipEle.querySelector(".e-arrow-tip"),arrowInnerELe=this.tooltipEle.querySelector(".e-arrow-tip-inner"),tipWidth=arrowEle.offsetWidth,tipHeight=arrowEle.offsetHeight;if("e-tip-bottom"===this.tipClass||"e-tip-top"===this.tipClass){"e-tip-bottom"===this.tipClass?(topValue="99.9%",arrowInnerELe.style.top="-"+(tipHeight-2)+"px"):(topValue=-(tipHeight-1)+"px",arrowInnerELe.style.top="-"+(tipHeight-6)+"px");let tipPosExclude="Center"!==tooltipPositionX||tooltipWidth>target.offsetWidth||this.mouseTrail;leftValue=tipPosExclude&&"Left"===tooltipPositionX||!tipPosExclude&&"End"===this.tipPointerPosition?tooltipWidth-tipWidth-2+"px":tipPosExclude&&"Right"===tooltipPositionX||!tipPosExclude&&"Start"===this.tipPointerPosition?"2px":tooltipWidth/2-tipWidth/2+"px"}else{"e-tip-right"===this.tipClass?(leftValue="99.9%",arrowInnerELe.style.left="-"+(tipWidth-2)+"px"):(leftValue=-(tipWidth-1)+"px",arrowInnerELe.style.left=tipWidth-2-tipWidth+"px");let tipPosExclude="Center"!==tooltipPositionY||tooltipHeight>target.offsetHeight||this.mouseTrail;topValue=tipPosExclude&&"Top"===tooltipPositionY||!tipPosExclude&&"End"===this.tipPointerPosition?tooltipHeight-tipHeight-2+"px":tipPosExclude&&"Bottom"===tooltipPositionY||!tipPosExclude&&"Start"===this.tipPointerPosition?"2px":tooltipHeight/2-tipHeight/2+"px"}arrowEle.style.top=topValue,arrowEle.style.left=leftValue}renderContent(target){let tooltipContent=this.tooltipEle.querySelector(".e-tip-content");target&&!isNullOrUndefined(target.getAttribute("title"))&&(target.setAttribute("data-content",target.getAttribute("title")),target.removeAttribute("title")),isNullOrUndefined(this.content)?target&&!isNullOrUndefined(target.getAttribute("data-content"))&&(tooltipContent.innerHTML=target.getAttribute("data-content")):(tooltipContent.innerHTML="",this.content instanceof HTMLElement?tooltipContent.appendChild(this.content):"string"==typeof this.content&&this.content.indexOf("<div>Blazor")<0?tooltipContent.innerHTML=this.content:(append(compile$$1(this.content)({},null,null,this.element.id+"content"),tooltipContent),"string"==typeof this.content&&this.content.indexOf("<div>Blazor")>=0&&(this.isBlazorTemplate=!0,updateBlazorTemplate(this.element.id+"content","Content",this))))}renderCloseIcon(){if(!this.isSticky)return;let tipClose=this.createElement("div",{className:"e-icons e-tooltip-close"});this.tooltipEle.appendChild(tipClose),EventHandler.add(tipClose,Browser.touchStartEvent,this.onStickyClose,this)}addDescribedBy(target,id){let describedby=(target.getAttribute("aria-describedby")||"").split(/\s+/);describedby.indexOf(id)<0&&describedby.push(id),attributes(target,{"aria-describedby":describedby.join(" ").trim(),"data-tooltip-id":id})}removeDescribedBy(target){let id=target.getAttribute("data-tooltip-id"),describedby=(target.getAttribute("aria-describedby")||"").split(/\s+/),index=describedby.indexOf(id);-1!==index&&describedby.splice(index,1),target.removeAttribute("data-tooltip-id");let orgdescribedby=describedby.join(" ").trim();orgdescribedby?target.setAttribute("aria-describedby",orgdescribedby):target.removeAttribute("aria-describedby")}tapHoldHandler(evt){clearTimeout(this.autoCloseTimer),this.targetHover(evt.originalEvent)}touchEndHandler(e){this.isSticky||(this.autoCloseTimer=setTimeout(()=>{this.close()},1500))}targetClick(e){let target;isNullOrUndefined(target=this.target?closest(e.target,this.target):this.element)||(null===target.getAttribute("data-tooltip-id")?this.targetHover(e):this.isSticky||this.hideTooltip(this.animation.close,e,target))}targetHover(e){let target;if(isNullOrUndefined(target=this.target?closest(e.target,this.target):this.element)||null!==target.getAttribute("data-tooltip-id"))return;let targetList=[].slice.call(document.querySelectorAll("[data-tooltip-id= "+this.ctrlId+"_content]"));for(let target of targetList)this.restoreElement(target);this.showTooltip(target,this.animation.open,e),this.wireMouseEvents(e,target)}showTooltip(target,showAnimation,e){clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.tooltipEventArgs=e?{type:e.type,cancel:!1,target:target,event:e,element:this.tooltipEle}:{type:null,cancel:!1,target:target,event:null,element:this.tooltipEle},this.trigger("beforeRender",this.tooltipEventArgs,beforeRenderArgs=>{if(beforeRenderArgs.cancel)this.isHidden=!0,this.clear();else{this.isHidden=!1,isNullOrUndefined(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?getUniqueID(this.element.getAttribute("id")):getUniqueID("tooltip"),this.tooltipEle=this.createElement("div",{className:"e-tooltip-wrap e-popup e-lib",attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"},styles:"width:"+formatUnit(this.width)+";height:"+formatUnit(this.height)+";position:absolute;"}),this.cssClass&&addClass([this.tooltipEle],this.cssClass.split(" ")),Browser.isDevice&&addClass([this.tooltipEle],"e-bigger"),"auto"!==this.width&&(this.tooltipEle.style.maxWidth=formatUnit(this.width)),this.tooltipEle.appendChild(this.createElement("div",{className:"e-tip-content"})),document.body.appendChild(this.tooltipEle),this.addDescribedBy(target,this.ctrlId+"_content"),this.renderContent(target),addClass([this.tooltipEle],"e-popup-open"),this.showTipPointer&&this.renderArrow(),this.renderCloseIcon(),this.renderPopup(target)):(this.adjustArrow(target,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(target,this.ctrlId+"_content"),this.renderContent(target),ej2_base_es2015_Animation.stop(this.tooltipEle),this.reposition(target)),removeClass([this.tooltipEle],"e-popup-open"),addClass([this.tooltipEle],"e-popup-close"),this.tooltipEventArgs=e?{type:e.type,cancel:!1,target:target,event:e,element:this.tooltipEle}:{type:null,cancel:!1,target:target,event:null,element:this.tooltipEle};const this$=this;this.needTemplateReposition()&&!this.mouseTrail&&(this.tooltipEle.style.display="none"),this.trigger("beforeOpen",this.tooltipEventArgs,observedArgs=>{if(observedArgs.cancel)this$.isHidden=!0,this$.clear(),this$.restoreElement(target);else{let openAnimation={name:showAnimation.effect,duration:showAnimation.duration,delay:showAnimation.delay,timingFunction:"easeOut"};if("None"===showAnimation.effect&&(openAnimation=void 0),this$.openDelay>0){let show=()=>{this$.popupObj&&this$.popupObj.show(openAnimation,target)};this$.showTimer=setTimeout(show,this$.openDelay)}else this$.popupObj.show(openAnimation,target)}})}})}needTemplateReposition(){return!isNullOrUndefined(this.viewContainerRef)&&"string"!=typeof this.viewContainerRef||isBlazor()&&this.isBlazorTemplate}checkCollision(target,x,y){let elePos={left:x,top:y,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},affectedPos=isCollide(this.tooltipEle,this.target?this.element:null,x,y);return affectedPos.length>0&&(elePos.horizontal=affectedPos.indexOf("left")>=0?"Right":affectedPos.indexOf("right")>=0?"Left":this.tooltipPositionX,elePos.vertical=affectedPos.indexOf("top")>=0?"Bottom":affectedPos.indexOf("bottom")>=0?"Top":this.tooltipPositionY),elePos}collisionFlipFit(target,x,y){let elePos=this.checkCollision(target,x,y),newpos=elePos.position;if(this.tooltipPositionY!==elePos.vertical&&(newpos=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?elePos.vertical+this.tooltipPositionX:this.tooltipPositionX+elePos.vertical),this.tooltipPositionX!==elePos.horizontal&&(0===newpos.indexOf("Left")&&(elePos.vertical="LeftTop"===newpos||"LeftCenter"===newpos?"Top":"Bottom",newpos=elePos.vertical+"Left"),0===newpos.indexOf("Right")&&(elePos.vertical="RightTop"===newpos||"RightCenter"===newpos?"Top":"Bottom",newpos=elePos.vertical+"Right"),elePos.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:target,event:null,element:this.tooltipEle,collidedPosition:newpos},this.trigger("beforeCollision",this.tooltipEventArgs),elePos.position!==newpos){let pos=calculatePosition(target,elePos.horizontal,elePos.vertical);this.adjustArrow(target,newpos,elePos.horizontal,elePos.vertical);let offsetPos=this.calculateTooltipOffset(newpos);offsetPos.top-=-1!=="TopBottom".indexOf(this.position.split(/(?=[A-Z])/)[0])&&-1!=="TopBottom".indexOf(newpos.split(/(?=[A-Z])/)[0])?2*this.offsetY:0,offsetPos.left-=-1!=="RightLeft".indexOf(this.position.split(/(?=[A-Z])/)[0])&&-1!=="RightLeft".indexOf(newpos.split(/(?=[A-Z])/)[0])?2*this.offsetX:0,elePos.position=newpos,elePos.left=pos.left+offsetPos.left,elePos.top=pos.top+offsetPos.top}else this.adjustArrow(target,newpos,elePos.horizontal,elePos.vertical);let eleOffset={left:elePos.left,top:elePos.top},left=fit(this.tooltipEle,this.target?this.element:null,{X:!0,Y:!1},eleOffset).left;if(this.showTipPointer&&(0===newpos.indexOf("Bottom")||0===newpos.indexOf("Top"))){let arrowEle=this.tooltipEle.querySelector(".e-arrow-tip"),arrowleft=parseInt(arrowEle.style.left,10)-(left-elePos.left);arrowleft<0?arrowleft=0:arrowleft+arrowEle.offsetWidth>this.tooltipEle.clientWidth&&(arrowleft=this.tooltipEle.clientWidth-arrowEle.offsetWidth),arrowEle.style.left=arrowleft.toString()+"px"}return eleOffset.left=left,eleOffset}hideTooltip(hideAnimation,e,targetElement){let target;e?this.tooltipEventArgs={type:e.type,cancel:!1,target:target=this.target?targetElement||e.target:this.element,event:e,element:this.tooltipEle}:(target=document.querySelector("[data-tooltip-id= "+this.ctrlId+"_content]"),this.tooltipEventArgs={type:null,cancel:!1,target:target,event:null,element:this.tooltipEle}),isNullOrUndefined(target)||this.trigger("beforeClose",this.tooltipEventArgs,observedArgs=>{if(observedArgs.cancel)this.isHidden=!1;else{this.restoreElement(target),this.isHidden=!0;let closeAnimation={name:hideAnimation.effect,duration:hideAnimation.duration,delay:hideAnimation.delay,timingFunction:"easeIn"};"None"===hideAnimation.effect&&(closeAnimation=void 0),this.closeDelay>0?this.hideTimer=setTimeout(()=>{this.popupObj&&this.popupObj.hide(closeAnimation)},this.closeDelay):this.popupObj.hide(closeAnimation)}})}restoreElement(target){this.unwireMouseEvents(target),isNullOrUndefined(target.getAttribute("data-content"))||(target.setAttribute("title",target.getAttribute("data-content")),target.removeAttribute("data-content")),this.removeDescribedBy(target)}clear(){this.tooltipEle&&(removeClass([this.tooltipEle],"e-popup-close"),addClass([this.tooltipEle],"e-popup-open")),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&ej2_base_es2015_remove(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)}onMouseOut(e){const enteredElement=e.relatedTarget;if(enteredElement&&!this.mouseTrail){const checkForTooltipElement=closest(enteredElement,".e-tooltip-wrap.e-lib.e-popup");checkForTooltipElement?(EventHandler.add(checkForTooltipElement,"mouseleave",this.tooltipElementMouseOut,this),this.unwireMouseEvents(e.target)):this.hideTooltip(this.animation.close,e)}else this.hideTooltip(this.animation.close,e)}tooltipElementMouseOut(e){this.hideTooltip(this.animation.close,e,this.findTarget()),EventHandler.remove(this.element,"mouseleave",this.tooltipElementMouseOut)}onStickyClose(e){this.close()}onMouseMove(event){let eventPageX=0,eventPageY=0;event.type.indexOf("touch")>-1?(event.preventDefault(),eventPageX=event.touches[0].pageX,eventPageY=event.touches[0].pageY):(eventPageX=event.pageX,eventPageY=event.pageY),ej2_base_es2015_Animation.stop(this.tooltipEle),removeClass([this.tooltipEle],"e-popup-close"),addClass([this.tooltipEle],"e-popup-open"),this.adjustArrow(event.target,this.position,this.tooltipPositionX,this.tooltipPositionY);let pos=this.calculateTooltipOffset(this.position),elePos=this.checkCollision(event.target,eventPageX+pos.left+this.offsetX,eventPageY+pos.top+this.offsetY);if(this.tooltipPositionX!==elePos.horizontal||this.tooltipPositionY!==elePos.vertical){let newpos=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?elePos.vertical+elePos.horizontal:elePos.horizontal+elePos.vertical;elePos.position=newpos,this.adjustArrow(event.target,elePos.position,elePos.horizontal,elePos.vertical);let colpos=this.calculateTooltipOffset(elePos.position);elePos.left=eventPageX+colpos.left-this.offsetX,elePos.top=eventPageY+colpos.top-this.offsetY}this.tooltipEle.style.left=elePos.left+"px",this.tooltipEle.style.top=elePos.top+"px"}keyDown(event){this.tooltipEle&&27===event.keyCode&&this.close()}touchEnd(e){this.tooltipEle&&null===closest(e.target,".e-tooltip")&&this.close()}scrollHandler(e){this.tooltipEle&&this.close()}render(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()}preRender(){this.tipClass="e-tip-bottom",this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0}wireEvents(trigger){let triggerList=this.getTriggerList(trigger);for(let opensOn of triggerList){if("Custom"===opensOn)return;"Focus"===opensOn&&this.wireFocusEvents(),"Click"===opensOn&&EventHandler.add(this.element,Browser.touchStartEvent,this.targetClick,this),"Hover"===opensOn&&(Browser.isDevice?(this.touchModule=new ej2_base_es2015_Touch(this.element,{tapHoldThreshold:500,tapHold:this.tapHoldHandler.bind(this)}),EventHandler.add(this.element,Browser.touchEndEvent,this.touchEndHandler,this)):EventHandler.add(this.element,"mouseover",this.targetHover,this))}EventHandler.add(document,"touchend",this.touchEnd,this),EventHandler.add(document,"scroll",this.scrollHandler,this),EventHandler.add(document,"keydown",this.keyDown,this)}getTriggerList(trigger){return"Auto"===trigger&&(trigger=Browser.isDevice?"Hover":"Hover Focus"),trigger.split(" ")}wireFocusEvents(){if(isNullOrUndefined(this.target))EventHandler.add(this.element,"focus",this.targetHover,this);else{let targetList=[].slice.call(this.element.querySelectorAll(this.target));for(let target of targetList)EventHandler.add(target,"focus",this.targetHover,this)}}wireMouseEvents(e,target){this.tooltipEle&&(this.isSticky||("focus"===e.type&&EventHandler.add(target,"blur",this.onMouseOut,this),"mouseover"===e.type&&EventHandler.add(target,"mouseleave",this.onMouseOut,this)),this.mouseTrail&&EventHandler.add(target,"mousemove touchstart mouseenter",this.onMouseMove,this))}unwireEvents(trigger){let triggerList=this.getTriggerList(trigger);for(let opensOn of triggerList){if("Custom"===opensOn)return;"Focus"===opensOn&&this.unwireFocusEvents(),"Click"===opensOn&&EventHandler.remove(this.element,Browser.touchStartEvent,this.targetClick),"Hover"===opensOn&&(Browser.isDevice?(this.touchModule&&this.touchModule.destroy(),EventHandler.remove(this.element,Browser.touchEndEvent,this.touchEndHandler)):EventHandler.remove(this.element,"mouseover",this.targetHover))}EventHandler.remove(document,"touchend",this.touchEnd),EventHandler.remove(document,"scroll",this.scrollHandler),EventHandler.remove(document,"keydown",this.keyDown)}unwireFocusEvents(){if(isNullOrUndefined(this.target))EventHandler.remove(this.element,"focus",this.targetHover);else{let targetList=[].slice.call(this.element.querySelectorAll(this.target));for(let target of targetList)EventHandler.remove(target,"focus",this.targetHover)}}unwireMouseEvents(target){if(!this.isSticky){let triggerList=this.getTriggerList(this.opensOn);for(let opensOn of triggerList)"Focus"===opensOn&&EventHandler.remove(target,"blur",this.onMouseOut),"Hover"!==opensOn||Browser.isDevice||EventHandler.remove(target,"mouseleave",this.onMouseOut)}this.mouseTrail&&EventHandler.remove(target,"mousemove touchstart mouseenter",this.onMouseMove)}findTarget(){return document.querySelector("[data-tooltip-id= "+this.ctrlId+"_content]")}getModuleName(){return"tooltip"}getPersistData(){return this.addOnPersist([])}onPropertyChanged(newProp,oldProp){let targetElement=this.findTarget();for(let prop of Object.keys(newProp))switch(prop){case"width":this.tooltipEle&&targetElement&&(this.tooltipEle.style.width=formatUnit(newProp.width),this.reposition(targetElement));break;case"height":this.tooltipEle&&targetElement&&(this.tooltipEle.style.height=formatUnit(newProp.height),this.reposition(targetElement));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(oldProp.opensOn),this.wireEvents(newProp.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&targetElement){let arrowInnerELe=this.tooltipEle.querySelector(".e-arrow-tip-inner");arrowInnerELe.style.top=arrowInnerELe.style.left=null,this.reposition(targetElement)}break;case"tipPointerPosition":this.tooltipEle&&targetElement&&this.reposition(targetElement);break;case"offsetX":if(this.tooltipEle){let x=newProp.offsetX-oldProp.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+x).toString()+"px"}break;case"offsetY":if(this.tooltipEle){let y=newProp.offsetY-oldProp.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+y).toString()+"px"}break;case"cssClass":this.tooltipEle&&(oldProp.cssClass&&removeClass([this.tooltipEle],oldProp.cssClass.split(" ")),newProp.cssClass&&addClass([this.tooltipEle],newProp.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?addClass([this.tooltipEle],"e-rtl"):removeClass([this.tooltipEle],"e-rtl"))}}open(element,animation=this.animation.open){"none"!==element.style.display&&this.showTooltip(element,animation)}close(animation=this.animation.close){this.hideTooltip(animation)}refresh(target){this.tooltipEle&&this.renderContent(target),this.popupObj&&target&&this.reposition(target)}destroy(){super.destroy(),removeClass([this.element],"e-tooltip"),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&ej2_base_es2015_remove(this.tooltipEle),this.tooltipEle=null,this.popupObj=null}};return __decorate([Property("auto")],Tooltip.prototype,"width",void 0),__decorate([Property("auto")],Tooltip.prototype,"height",void 0),__decorate([Property()],Tooltip.prototype,"content",void 0),__decorate([Property()],Tooltip.prototype,"target",void 0),__decorate([Property("TopCenter")],Tooltip.prototype,"position",void 0),__decorate([Property(0)],Tooltip.prototype,"offsetX",void 0),__decorate([Property(0)],Tooltip.prototype,"offsetY",void 0),__decorate([Property(!0)],Tooltip.prototype,"showTipPointer",void 0),__decorate([Property("Auto")],Tooltip.prototype,"tipPointerPosition",void 0),__decorate([Property("Auto")],Tooltip.prototype,"opensOn",void 0),__decorate([Property(!1)],Tooltip.prototype,"mouseTrail",void 0),__decorate([Property(!1)],Tooltip.prototype,"isSticky",void 0),__decorate([Complex({},ej2_popups_es2015_Animation$1)],Tooltip.prototype,"animation",void 0),__decorate([Property(0)],Tooltip.prototype,"openDelay",void 0),__decorate([Property(0)],Tooltip.prototype,"closeDelay",void 0),__decorate([Property()],Tooltip.prototype,"cssClass",void 0),__decorate([ej2_base_es2015_Event()],Tooltip.prototype,"beforeRender",void 0),__decorate([ej2_base_es2015_Event()],Tooltip.prototype,"beforeOpen",void 0),__decorate([ej2_base_es2015_Event()],Tooltip.prototype,"afterOpen",void 0),__decorate([ej2_base_es2015_Event()],Tooltip.prototype,"beforeClose",void 0),__decorate([ej2_base_es2015_Event()],Tooltip.prototype,"afterClose",void 0),__decorate([ej2_base_es2015_Event()],Tooltip.prototype,"beforeCollision",void 0),__decorate([ej2_base_es2015_Event()],Tooltip.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],Tooltip.prototype,"destroyed",void 0),__decorate([NotifyPropertyChanges],Tooltip)})(),globalTimeOut={},spinTemplate=null,spinCSSClass=null;const DEFT_MAT_WIDTH=30,DEFT_FAB_WIDTH=30,DEFT_BOOT_WIDTH=30,DEFT_BOOT4_WIDTH=36,CLS_SHOWSPIN="e-spin-show",CLS_HIDESPIN="e-spin-hide",CLS_MATERIALSPIN="e-spin-material",CLS_FABRICSPIN="e-spin-fabric",CLS_BOOTSPIN="e-spin-bootstrap",CLS_BOOT4SPIN="e-spin-bootstrap4",CLS_HIGHCONTRASTSPIN="e-spin-high-contrast",CLS_SPINWRAP="e-spinner-pane",CLS_SPININWRAP="e-spinner-inner",CLS_SPINCIRCLE="e-path-circle",CLS_SPINARC="e-path-arc",CLS_SPINLABEL="e-spin-label",CLS_SPINTEMPLATE="e-spin-template";function createSpinner(args,internalCreateElement){let radius,makeElement=isNullOrUndefined(internalCreateElement)?ej2_base_es2015_createElement:internalCreateElement,container=function(target,makeElement){let spinnerContainer=makeElement("div",{});spinnerContainer.classList.add(CLS_SPINWRAP);let spinnerInnerContainer=makeElement("div",{});return spinnerInnerContainer.classList.add(CLS_SPININWRAP),target.appendChild(spinnerContainer),spinnerContainer.appendChild(spinnerInnerContainer),{wrap:spinnerContainer,inner_wrap:spinnerInnerContainer}}(args.target,makeElement);if(isNullOrUndefined(args.cssClass)||container.wrap.classList.add(args.cssClass),isNullOrUndefined(args.template)&&isNullOrUndefined(spinTemplate)){let theme=isNullOrUndefined(args.type)?function(container){return window.getComputedStyle(container,":after").getPropertyValue("content").replace(/['"]+/g,"")}(container.wrap):args.type;radius=function(width,theme){let defaultSize;switch(theme){case"Material":defaultSize=DEFT_MAT_WIDTH;break;case"Fabric":defaultSize=DEFT_FAB_WIDTH;break;case"Bootstrap4":defaultSize=DEFT_BOOT4_WIDTH;break;default:defaultSize=DEFT_BOOT_WIDTH}return width=width?parseFloat(width+""):defaultSize,"Bootstrap"===theme?width:width/2}(isNullOrUndefined(args.width)?void 0:args.width,theme),function(theme,container,radius,makeElement){let innerContainer=container.querySelector("."+CLS_SPININWRAP),svg=innerContainer.querySelector("svg");switch(isNullOrUndefined(svg)||innerContainer.removeChild(svg),theme){case"Material":!function(container,radius,makeElement){let uniqueID=random_generator();globalTimeOut[uniqueID]={timeOut:0,type:"Material",radius:radius},create_material_element(container,uniqueID,0,CLS_MATERIALSPIN),mat_calculate_attributes(radius,container,"Material",CLS_MATERIALSPIN)}(innerContainer,radius);break;case"Fabric":!function(container,radius,makeElement){let uniqueID=random_generator();globalTimeOut[uniqueID]={timeOut:0,type:"Fabric",radius:radius},create_fabric_element(container,uniqueID,CLS_FABRICSPIN),fb_calculate_attributes(radius,container,CLS_FABRICSPIN)}(innerContainer,radius);break;case"Bootstrap":!function(innerContainer,radius,makeElement){let uniqueID=random_generator();globalTimeOut[uniqueID]={timeOut:0,type:"Bootstrap",radius:radius},function(innerContainer,uniqueID,makeElement){let svgBoot=document.createElementNS("http://www.w3.org/2000/svg","svg");svgBoot.setAttribute("id",uniqueID),svgBoot.setAttribute("class",CLS_BOOTSPIN),svgBoot.setAttribute("viewBox","0 0 64 64"),innerContainer.insertBefore(svgBoot,innerContainer.firstChild);for(let item=0;item<=7;item++){let bootCircle=document.createElementNS("http://www.w3.org/2000/svg","circle");bootCircle.setAttribute("class",CLS_SPINCIRCLE+"_"+item),bootCircle.setAttribute("r","2"),bootCircle.setAttribute("transform","translate(32,32)"),svgBoot.appendChild(bootCircle)}}(innerContainer,uniqueID),function(innerContainer,radius){let svg=innerContainer.querySelector("svg.e-spin-bootstrap");svg.style.width=svg.style.height=radius+"px";let startArc=90;for(let item=0;item<=7;item++){let start=defineArcPoints(0,0,24,startArc),circleEle=svg.querySelector("."+CLS_SPINCIRCLE+"_"+item);circleEle.setAttribute("cx",start.x+""),circleEle.setAttribute("cy",start.y+""),startArc=startArc>=360?0:startArc,startArc+=45}}(innerContainer,radius)}(innerContainer,radius);break;case"HighContrast":!function(container,radius,makeElement){let uniqueID=random_generator();globalTimeOut[uniqueID]={timeOut:0,type:"HighContrast",radius:radius},create_fabric_element(container,uniqueID,CLS_HIGHCONTRASTSPIN),fb_calculate_attributes(radius,container,CLS_HIGHCONTRASTSPIN)}(innerContainer,radius);break;case"Bootstrap4":!function(container,radius,makeElement){let uniqueID=random_generator();globalTimeOut[uniqueID]={timeOut:0,type:"Bootstrap4",radius:radius},create_material_element(container,uniqueID,0,CLS_BOOT4SPIN),mat_calculate_attributes(radius,container,"Bootstrap4",CLS_BOOT4SPIN)}(innerContainer,radius)}}(theme,container.wrap,radius),isNullOrUndefined(args.label)||function(container,label,makeElement){let labelEle=makeElement("div",{});labelEle.classList.add(CLS_SPINLABEL),labelEle.textContent=label,container.appendChild(labelEle)}(container.inner_wrap,args.label,makeElement)}else{let template=isNullOrUndefined(args.template)?spinTemplate:args.template;container.wrap.classList.add(CLS_SPINTEMPLATE),function(container,template,cssClass){isNullOrUndefined(cssClass)||container.classList.add(cssClass),container.querySelector(".e-spinner-inner").innerHTML=template}(container.wrap,template,spinCSSClass)}container.wrap.classList.add(CLS_HIDESPIN),container=null}function generateSeries(begin,stop){let series=[],start=begin,end=stop,increment=!1,count=1;return function formSeries(i){series.push(i),i===end&&1!==count||(i<=start&&i>1&&!increment?i=parseFloat((i-.2).toFixed(2)):1===i?(i=7,i=parseFloat((i+.2).toFixed(2)),increment=!0):i<8&&increment?8===(i=parseFloat((i+.2).toFixed(2)))&&(increment=!1):i<=8&&!increment&&(i=parseFloat((i-.2).toFixed(2))),++count,formSeries(i))}(start),series}function random_generator(){let random="",combine="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<5;i++)random+=combine.charAt(Math.floor(Math.random()*combine.length));return random}function create_fabric_element(innerCon,uniqueID,themeClass,makeElement){let svgFabric=document.createElementNS("http://www.w3.org/2000/svg","svg");svgFabric.setAttribute("id",uniqueID),svgFabric.setAttribute("class",themeClass);let fabricCirclePath=document.createElementNS("http://www.w3.org/2000/svg","path");fabricCirclePath.setAttribute("class",CLS_SPINCIRCLE);let fabricCircleArc=document.createElementNS("http://www.w3.org/2000/svg","path");fabricCircleArc.setAttribute("class",CLS_SPINARC),innerCon.insertBefore(svgFabric,innerCon.firstChild),svgFabric.appendChild(fabricCirclePath),svgFabric.appendChild(fabricCircleArc)}function create_material_element(innerContainer,uniqueID,makeElement,cls){let svgMaterial=document.createElementNS("http://www.w3.org/2000/svg","svg");svgMaterial.setAttribute("class",cls),svgMaterial.setAttribute("id",uniqueID);let matCirclePath=document.createElementNS("http://www.w3.org/2000/svg","path");matCirclePath.setAttribute("class",CLS_SPINCIRCLE),innerContainer.insertBefore(svgMaterial,innerContainer.firstChild),svgMaterial.appendChild(matCirclePath)}function mat_calculate_attributes(radius,container,type,cls){let diameter=2*radius,svg=container.querySelector("svg."+cls),path=svg.querySelector("path.e-path-circle"),strokeSize=getStrokeSize(diameter),transformOrigin=diameter/2+"px";svg.setAttribute("viewBox","0 0 "+diameter+" "+diameter),svg.style.width=svg.style.height=diameter+"px",svg.style.transformOrigin=transformOrigin+" "+transformOrigin+" "+transformOrigin,path.setAttribute("d",function(diameter,strokeSize){let radius=diameter/2,offset=strokeSize/2;return"M"+radius+","+offset+"A"+(radius-offset)+","+(radius-offset)+" 0 1 1 "+offset+","+radius}(diameter,strokeSize)),"Material"===type&&(path.setAttribute("stroke-width",strokeSize+""),path.setAttribute("stroke-dasharray",(diameter-strokeSize)*Math.PI*.75+""),path.setAttribute("stroke-dashoffset",getDashOffset(diameter,strokeSize,1,75)+""))}function getStrokeSize(diameter){return.1*diameter}function getDashOffset(diameter,strokeSize,value,max){return(diameter-strokeSize)*Math.PI*(3*max/100-value/100)}function easeAnimation(current,start,change,duration){let timestamp=(current/=duration)*current,timecount=timestamp*current;return start+change*(6*timecount*timestamp+-15*timestamp*timestamp+10*timecount)}function fb_calculate_attributes(radius,innerConainer,trgClass){let centerX=radius,centerY=radius,diameter=2*radius,svg=innerConainer.querySelector("."+trgClass),circle=svg.querySelector(".e-path-circle"),path=svg.querySelector(".e-path-arc"),transformOrigin=diameter/2+"px";circle.setAttribute("d",function(x,y,radius){return["M",centerX,centerY,"m",-radius,0,"a",radius,radius,0,1,0,2*radius,0,"a",radius,radius,0,1,0,2*-radius,0].join(" ")}(0,0,radius)),path.setAttribute("d",function(x,y,radius,startArc,endArc){let start=defineArcPoints(x,y,radius,45),end=defineArcPoints(x,y,radius,315);return["M",start.x,start.y,"A",radius,radius,0,0,0,end.x,end.y].join(" ")}(centerX,centerY,radius)),svg.setAttribute("viewBox","0 0 "+diameter+" "+diameter),svg.style.transformOrigin=transformOrigin+" "+transformOrigin+" "+transformOrigin,svg.style.width=svg.style.height=diameter+"px"}function defineArcPoints(centerX,centerY,radius,angle){let radians=(angle-90)*Math.PI/180;return{x:centerX+radius*Math.cos(radians),y:centerY+radius*Math.sin(radians)}}function showSpinner(container){showHideSpinner(container,!1),container=null}function showHideSpinner(container,isHide){let spinCheck,spinnerWrap=container.classList.contains(CLS_SPINWRAP)?container:container.querySelector("."+CLS_SPINWRAP),inner=spinnerWrap.querySelector("."+CLS_SPININWRAP);if(spinCheck=isHide?!spinnerWrap.classList.contains(CLS_SPINTEMPLATE)&&!spinnerWrap.classList.contains(CLS_HIDESPIN):!spinnerWrap.classList.contains(CLS_SPINTEMPLATE)&&!spinnerWrap.classList.contains(CLS_SHOWSPIN)){let svgEle=spinnerWrap.querySelector("svg");if(isNullOrUndefined(svgEle))return;let id=svgEle.getAttribute("id");switch(globalTimeOut[id].isAnimate=!isHide,globalTimeOut[id].type){case"Material":isHide?clearTimeout(globalTimeOut[id].timeOut):function(container,uniqueID,radius){let globalObject={};globalTimeOut[uniqueID].timeOut=0,globalObject[uniqueID]=function(id,radius,count,previousId){return{radius:radius,count:0,previousId:0}}(0,radius),function animateMaterial(spinnerInfo){!function(start,end,easing,duration,count,max,spinnerInfo){let id=++spinnerInfo.globalInfo[spinnerInfo.uniqueID].previousId,startTime=(new Date).getTime(),diameter=parseFloat(2*spinnerInfo.globalInfo[spinnerInfo.uniqueID].radius+""),strokeSize=getStrokeSize(diameter),rotate=-90*(spinnerInfo.globalInfo[spinnerInfo.uniqueID].count||0);!function mat_animation(spinnerInfo){let currentTime=Math.max(0,Math.min((new Date).getTime()-startTime,1333));!function(value,container){if(!isNullOrUndefined(container.querySelector("svg.e-spin-material"))&&!isNullOrUndefined(container.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))){let path=container.querySelector("svg.e-spin-material").querySelector("path.e-path-circle");path.setAttribute("stroke-dashoffset",getDashOffset(diameter,strokeSize,value,75)+""),path.setAttribute("transform","rotate("+rotate+" "+diameter/2+" "+diameter/2+")")}}(easing(currentTime,1,148,1333),spinnerInfo.container),id===spinnerInfo.globalInfo[spinnerInfo.uniqueID].previousId&&currentTime<1333?globalTimeOut[spinnerInfo.uniqueID].timeOut=setTimeout(mat_animation.bind(null,spinnerInfo),1):animateMaterial(spinnerInfo)}(spinnerInfo)}(0,0,easeAnimation,0,0,0,spinnerInfo),spinnerInfo.globalInfo[spinnerInfo.uniqueID].count=++spinnerInfo.globalInfo[spinnerInfo.uniqueID].count%4}({uniqueID:uniqueID,container:container,globalInfo:globalObject,timeOutVar:0})}(inner,id,globalTimeOut[id].radius);break;case"Bootstrap":isHide?clearTimeout(globalTimeOut[id].timeOut):function(innerContainer){let id=innerContainer.querySelector("svg.e-spin-bootstrap").getAttribute("id");for(let i=1;i<=8;i++)rotation(innerContainer.getElementsByClassName("e-path-circle_"+(8===i?0:i))[0],i,0,generateSeries(i,i),id);function rotation(circle,start,end,series,id){let count=0;!function boot_animate(radius){globalTimeOut[id].isAnimate&&(++count,circle.setAttribute("r",radius+""),count>=series.length&&(count=0),globalTimeOut[id].timeOut=setTimeout(boot_animate.bind(null,series[count]),18))}(start)}}(inner)}}isHide?ej2_base_es2015_classList(spinnerWrap,[CLS_HIDESPIN],[CLS_SHOWSPIN]):ej2_base_es2015_classList(spinnerWrap,[CLS_SHOWSPIN],[CLS_HIDESPIN]),container=null}function hideSpinner(container){showHideSpinner(container,!0),container=null}class ej2_data_es2015_Query{constructor(from){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="","string"==typeof from?this.fromTable=from:from&&from instanceof Array&&(this.lookups=from),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this}setKey(field){return this.key=field,this}using(dataManager){return this.dataManager=dataManager,this}execute(dataManager,done,fail,always){return(dataManager=dataManager||this.dataManager)?dataManager.executeQuery(this,done,fail,always):ej2_data_es2015_DataUtil.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')}executeLocal(dataManager){return(dataManager=dataManager||this.dataManager)?dataManager.executeLocal(this):ej2_data_es2015_DataUtil.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')}clone(){let cloned=new ej2_data_es2015_Query;return cloned.queries=this.queries.slice(0),cloned.key=this.key,cloned.isChild=this.isChild,cloned.dataManager=this.dataManager,cloned.fromTable=this.fromTable,cloned.params=this.params.slice(0),cloned.expands=this.expands.slice(0),cloned.sortedColumns=this.sortedColumns.slice(0),cloned.groupedColumns=this.groupedColumns.slice(0),cloned.subQuerySelector=this.subQuerySelector,cloned.subQuery=this.subQuery,cloned.fKey=this.fKey,cloned.isCountRequired=this.isCountRequired,cloned.distincts=this.distincts.slice(0),cloned}from(tableName){return this.fromTable=tableName,this}addParams(key,value){return this.params.push("function"==typeof value?{key:key,fn:value}:{key:key,value:value}),this}distinct(fields){return this.distincts="string"==typeof fields?[].slice.call([fields],0):fields.slice(0),this}expand(tables){return this.expands="string"==typeof tables?[].slice.call([tables],0):tables.slice(0),this}where(fieldName,operator,value,ignoreCase,ignoreAccent){operator=operator?operator.toLowerCase():null;let predicate=null;return"string"==typeof fieldName?predicate=new ej2_data_es2015_Predicate(fieldName,operator,value,ignoreCase,ignoreAccent):fieldName instanceof ej2_data_es2015_Predicate&&(predicate=fieldName),this.queries.push({fn:"onWhere",e:predicate}),this}search(searchKey,fieldNames,operator,ignoreCase,ignoreAccent){return"string"==typeof fieldNames&&(fieldNames=[fieldNames]),this.queries.push({fn:"onSearch",e:{fieldNames:fieldNames,operator:operator=operator||"contains",searchKey:searchKey,ignoreCase:ignoreCase,ignoreAccent:ignoreAccent,comparer:ej2_data_es2015_DataUtil.fnOperators[operator]}}),this}sortBy(fieldName,comparer,isFromGroup){let sorts,temp,order="ascending";if("string"==typeof fieldName&&ej2_data_es2015_DataUtil.endsWith(fieldName.toLowerCase()," desc")&&(fieldName=fieldName.replace(/ desc$/i,""),comparer="descending"),comparer&&"string"!=typeof comparer||(order=comparer?comparer.toLowerCase():"ascending",comparer=ej2_data_es2015_DataUtil.fnSort(comparer)),isFromGroup){sorts=ej2_data_es2015_Query.filterQueries(this.queries,"onSortBy");for(let i=0;i<sorts.length;i++)if("string"==typeof(temp=sorts[i].e.fieldName)){if(temp===fieldName)return this}else if(temp instanceof Array)for(let j=0;j<temp.length;j++)if(temp[j]===fieldName||fieldName.toLowerCase()===temp[j]+" desc")return this}return this.queries.push({fn:"onSortBy",e:{fieldName:fieldName,comparer:comparer,direction:order}}),this}sortByDesc(fieldName){return this.sortBy(fieldName,"descending")}group(fieldName,fn,format){return this.sortBy(fieldName,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:fieldName,comparer:fn||null,format:format||null}}),this}page(pageIndex,pageSize){return this.queries.push({fn:"onPage",e:{pageIndex:pageIndex,pageSize:pageSize}}),this}range(start,end){return this.queries.push({fn:"onRange",e:{start:start,end:end}}),this}take(nos){return this.queries.push({fn:"onTake",e:{nos:nos}}),this}skip(nos){return this.queries.push({fn:"onSkip",e:{nos:nos}}),this}select(fieldNames){return"string"==typeof fieldNames&&(fieldNames=[].slice.call([fieldNames],0)),this.queries.push({fn:"onSelect",e:{fieldNames:fieldNames}}),this}hierarchy(query,selectorFn){return this.subQuerySelector=selectorFn,this.subQuery=query,this}foreignKey(key){return this.fKey=key,this}requiresCount(){return this.isCountRequired=!0,this}aggregate(type,field){return this.queries.push({fn:"onAggregates",e:{field:field,type:type}}),this}static filterQueries(queries,name){return queries.filter(q=>q.fn===name)}static filterQueryLists(queries,singles){let filtered=queries.filter(q=>-1!==singles.indexOf(q.fn)),res={};for(let i=0;i<filtered.length;i++)res[filtered[i].fn]||(res[filtered[i].fn]=filtered[i].e);return res}}class ej2_data_es2015_Predicate{constructor(field,operator,value,ignoreCase=!1,ignoreAccent){return this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof field?(this.field=field,this.operator=operator.toLowerCase(),this.value=value,this.ignoreCase=ignoreCase,this.ignoreAccent=ignoreAccent,this.isComplex=!1,this.comparer=ej2_data_es2015_DataUtil.fnOperators.processOperator(this.operator)):(field instanceof ej2_data_es2015_Predicate&&value instanceof ej2_data_es2015_Predicate||value instanceof Array)&&(this.isComplex=!0,this.condition=operator.toLowerCase(),this.predicates=[field],value instanceof Array?[].push.apply(this.predicates,value):this.predicates.push(value)),this}static and(...args){return ej2_data_es2015_Predicate.combinePredicates([].slice.call(args,0),"and")}and(field,operator,value,ignoreCase,ignoreAccent){return ej2_data_es2015_Predicate.combine(this,field,operator,value,"and",ignoreCase,ignoreAccent)}static or(...args){return ej2_data_es2015_Predicate.combinePredicates([].slice.call(args,0),"or")}or(field,operator,value,ignoreCase,ignoreAccent){return ej2_data_es2015_Predicate.combine(this,field,operator,value,"or",ignoreCase,ignoreAccent)}static fromJson(json){if(json instanceof Array){let res=[];for(let i=0,len=json.length;i<len;i++)res.push(this.fromJSONData(json[i]));return res}return this.fromJSONData(json)}validate(record){let isAnd,ret,predicate=this.predicates?this.predicates:[];if(!this.isComplex&&this.comparer)return this.comparer.call(this,ej2_data_es2015_DataUtil.getObject(this.field,record),this.value,this.ignoreCase,this.ignoreAccent);isAnd="and"===this.condition;for(let i=0;i<predicate.length;i++)if(ret=predicate[i].validate(record),isAnd){if(!ret)return!1}else if(ret)return!0;return isAnd}toJson(){let predicates,p;if(this.isComplex){predicates=[],p=this.predicates;for(let i=0;i<p.length;i++)predicates.push(p[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:predicates}}static combinePredicates(predicates,operator){if(1===predicates.length){if(!(predicates[0]instanceof Array))return predicates[0];predicates=predicates[0]}return new ej2_data_es2015_Predicate(predicates[0],operator,predicates.slice(1))}static combine(pred,field,operator,value,condition,ignoreCase,ignoreAccent){return field instanceof ej2_data_es2015_Predicate?ej2_data_es2015_Predicate[condition](pred,field):"string"==typeof field?ej2_data_es2015_Predicate[condition](pred,new ej2_data_es2015_Predicate(field,operator,value,ignoreCase,ignoreAccent)):ej2_data_es2015_DataUtil.throwError("Predicate - "+condition+" : invalid arguments")}static fromJSONData(json){let preds=json.predicates||[],len=preds.length,predicates=[];for(let i=0;i<len;i++)predicates.push(this.fromJSONData(preds[i]));return json.isComplex?new ej2_data_es2015_Predicate(predicates[0],json.condition,predicates.slice(1)):new ej2_data_es2015_Predicate(json.field,json.operator,json.value,json.ignoreCase,json.ignoreAccent)}}const consts={GroupGuid:"{271bbba0-1ee7}"};let ej2_data_es2015_DataUtil=(()=>{class DataUtil{static getValue(value,inst){return"function"==typeof value?value.call(inst||{}):value}static endsWith(input,substr){return input.slice(-substr.length)===substr}static startsWith(input,start){return input.slice(0,start.length)===start}static fnSort(order){return"ascending"===(order=order?DataUtil.toLowerCase(order):"ascending")?this.fnAscending:this.fnDescending}static fnAscending(x,y){return null==y?-1:"string"==typeof x?x.localeCompare(y):null==x?1:x-y}static fnDescending(x,y){return null==y?1:"string"==typeof x?-1*x.localeCompare(y):null==x?-1:y-x}static extractFields(obj,fields){let newObj={};for(let i=0;i<fields.length;i++)newObj=this.setValue(fields[i],this.getObject(fields[i],obj),newObj);return newObj}static select(jsonArray,fields){let newData=[];for(let i=0;i<jsonArray.length;i++)newData.push(this.extractFields(jsonArray[i],fields));return newData}static group(jsonArray,field,aggregates,level,groupDs,format){level=level||1;let jsonData=jsonArray;if(jsonData.GroupGuid===consts.GroupGuid){for(let j=0;j<jsonData.length;j++)if(isNullOrUndefined(groupDs))jsonData[j].items=this.group(jsonData[j].items,field,aggregates,jsonData.level+1,null,format),jsonData[j].count=jsonData[j].items.length;else{let indx=-1,temp=groupDs.filter(e=>e.key===jsonData[j].key);indx=groupDs.indexOf(temp[0]),jsonData[j].items=this.group(jsonData[j].items,field,aggregates,jsonData.level+1,groupDs[indx].items,format),jsonData[j].count=groupDs[indx].count}return jsonData.childLevels+=1,jsonData}let grouped={},groupedArray=[];groupedArray.GroupGuid=consts.GroupGuid,groupedArray.level=level,groupedArray.childLevels=0,groupedArray.records=jsonData;for(let i=0;i<jsonData.length;i++){let val=this.getVal(jsonData,i,field);if(isNullOrUndefined(format)||(val=format(val,field)),!grouped[val]&&(grouped[val]={key:val,count:0,items:[],aggregates:{},field:field},groupedArray.push(grouped[val]),!isNullOrUndefined(groupDs))){let tempObj=groupDs.filter(e=>e.key===grouped[val].key);grouped[val].count=tempObj[0].count}grouped[val].count=isNullOrUndefined(groupDs)?grouped[val].count+=1:grouped[val].count,grouped[val].items.push(jsonData[i])}if(aggregates&&aggregates.length)for(let i=0;i<groupedArray.length;i++){let fn,res={},aggs=aggregates;for(let j=0;j<aggregates.length;j++)if(fn=DataUtil.aggregates[aggregates[j].type],isNullOrUndefined(groupDs))fn&&(res[aggs[j].field+" - "+aggs[j].type]=fn(groupedArray[i].items,aggs[j].field));else{let temp=groupDs.filter(e=>e.key===groupedArray[i].key);fn&&(res[aggs[j].field+" - "+aggs[j].type]=fn(temp[0].items,aggs[j].field))}groupedArray[i].aggregates=res}return jsonData.length&&groupedArray||jsonData}static buildHierarchy(fKey,from,source,lookup,pKey){let i,temp,grp={};for(lookup.result&&(lookup=lookup.result),lookup.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),i=0;i<lookup.length;i++){let fKeyData=this.getObject(fKey,lookup[i]);(temp=grp[fKeyData]||(grp[fKeyData]=[])).push(lookup[i])}for(i=0;i<source.length;i++){let fKeyData=this.getObject(pKey||fKey,source[i]);source[i][from]=grp[fKeyData]}}static getFieldList(obj,fields,prefix){if(void 0===prefix&&(prefix=""),null==fields)return this.getFieldList(obj,[],prefix);let copyObj=obj,keys=Object.keys(obj);for(let prop of keys)"object"!=typeof copyObj[prop]||copyObj[prop]instanceof Array?fields.push(prefix+prop):this.getFieldList(copyObj[prop],fields,prefix+prop+".");return fields}static getObject(nameSpace,from){if(!nameSpace)return from;if(!from)return;if(-1===nameSpace.indexOf("."))return from[nameSpace];let value=from,splits=nameSpace.split(".");for(let i=0;i<splits.length&&null!=value;i++)value=value[splits[i]];return value}static setValue(nameSpace,value,obj){let i,key,keys=nameSpace.toString().split("."),start=obj||{},fromObj=start,length=keys.length;for(i=0;i<length;i++)key=keys[i],i+1===length?fromObj[key]=void 0===value?void 0:value:isNullOrUndefined(fromObj[key])&&(fromObj[key]={}),fromObj=fromObj[key];return start}static sort(ds,field,comparer){if(ds.length<=1)return ds;let middle=parseInt((ds.length/2).toString(),10),left=ds.slice(0,middle),right=ds.slice(middle);return left=this.sort(left,field,comparer),right=this.sort(right,field,comparer),this.merge(left,right,field,comparer)}static ignoreDiacritics(value){return"string"!=typeof value?value:value.split("").map(temp=>temp in DataUtil.diacritics?DataUtil.diacritics[temp]:temp).join("")}static merge(left,right,fieldName,comparer){let current,result=[];for(;left.length>0||right.length>0;)current=left.length>0&&right.length>0?comparer?comparer(this.getVal(left,0,fieldName),this.getVal(right,0,fieldName),left[0],right[0])<=0?left:right:left[0][fieldName]<left[0][fieldName]?left:right:left.length>0?left:right,result.push(current.shift());return result}static getVal(array,index,field){return field?this.getObject(field,array[index]):array[index]}static toLowerCase(val){return val?"string"==typeof val?val.toLowerCase():val.toString():0===val||!1===val?val.toString():""}static callAdaptorFunction(adaptor,fnName,param1,param2){if(fnName in adaptor){let res=adaptor[fnName](param1,param2);isNullOrUndefined(res)||(param1=res)}return param1}static getAddParams(adp,dm,query){let req={};return DataUtil.callAdaptorFunction(adp,"addParams",{dm:dm,query:query,params:query.params,reqParams:req}),req}static isPlainObject(obj){return!!obj&&obj.constructor===Object}static isCors(){let xhr=null;try{xhr=new window.XMLHttpRequest}catch(e){}return!!xhr&&"withCredentials"in xhr}static getGuid(prefix){let rand;return(prefix||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,(val,i)=>{if("crypto"in window&&"getRandomValues"in crypto){let arr=new Uint8Array(1);window.crypto.getRandomValues(arr),rand=arr[0]%16|0}else rand=16*Math.random()|0;return"0123456789abcdef"[19===i?3&rand|8:rand]})}static isNull(val){return null==val}static getItemFromComparer(array,field,comparer){let keyVal,current,key,i=0,castRequired="string"==typeof DataUtil.getVal(array,0,field);if(array.length)for(;isNullOrUndefined(keyVal)&&i<array.length;)keyVal=DataUtil.getVal(array,i,field),key=array[i++];for(;i<array.length;i++)isNullOrUndefined(current=DataUtil.getVal(array,i,field))||(castRequired&&(keyVal=+keyVal,current=+current),comparer(keyVal,current)>0&&(keyVal=current,key=array[i]));return key}static distinct(json,fieldName,requiresCompleteRecord){requiresCompleteRecord=!isNullOrUndefined(requiresCompleteRecord)&&requiresCompleteRecord;let val,result=[],tmp={};return json.forEach((data,index)=>{(val=DataUtil.getVal(json,index,fieldName))in tmp||(result.push(requiresCompleteRecord?json[index]:val),tmp[val]=1)}),result}}return DataUtil.serverTimezoneOffset=null,DataUtil.timeZoneHandling=!0,DataUtil.throwError=error=>{try{throw new Error(error)}catch(e){throw e.message+"\n"+e.stack}},DataUtil.aggregates={sum:(ds,field)=>{let val,result=0,castRequired="number"!=typeof DataUtil.getVal(ds,0,field);for(let i=0;i<ds.length;i++)val=DataUtil.getVal(ds,i,field),isNaN(val)||null===val||(castRequired&&(val=+val),result+=val);return result},average:(ds,field)=>DataUtil.aggregates.sum(ds,field)/ds.length,min:(ds,field)=>{let comparer;return"function"==typeof field&&(comparer=field,field=null),DataUtil.getObject(field,DataUtil.getItemFromComparer(ds,field,comparer||DataUtil.fnAscending))},max:(ds,field)=>{let comparer;return"function"==typeof field&&(comparer=field,field=null),DataUtil.getObject(field,DataUtil.getItemFromComparer(ds,field,comparer||DataUtil.fnDescending))},truecount:(ds,field)=>new ej2_data_es2015_DataManager(ds).executeLocal((new ej2_data_es2015_Query).where(field,"equal",!0,!0)).length,falsecount:(ds,field)=>new ej2_data_es2015_DataManager(ds).executeLocal((new ej2_data_es2015_Query).where(field,"equal",!1,!0)).length,count:(ds,field)=>ds.length},DataUtil.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},DataUtil.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},DataUtil.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},DataUtil.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},DataUtil.diacritics={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"},DataUtil.fnOperators={equal:(actual,expected,ignoreCase,ignoreAccent)=>(ignoreAccent&&(actual=DataUtil.ignoreDiacritics(actual),expected=DataUtil.ignoreDiacritics(expected)),ignoreCase?DataUtil.toLowerCase(actual)===DataUtil.toLowerCase(expected):actual===expected),notequal:(actual,expected,ignoreCase,ignoreAccent)=>(ignoreAccent&&(actual=DataUtil.ignoreDiacritics(actual),expected=DataUtil.ignoreDiacritics(expected)),!DataUtil.fnOperators.equal(actual,expected,ignoreCase)),lessthan:(actual,expected,ignoreCase)=>ignoreCase?DataUtil.toLowerCase(actual)<DataUtil.toLowerCase(expected):actual<expected,greaterthan:(actual,expected,ignoreCase)=>ignoreCase?DataUtil.toLowerCase(actual)>DataUtil.toLowerCase(expected):actual>expected,lessthanorequal:(actual,expected,ignoreCase)=>ignoreCase?DataUtil.toLowerCase(actual)<=DataUtil.toLowerCase(expected):actual<=expected,greaterthanorequal:(actual,expected,ignoreCase)=>ignoreCase?DataUtil.toLowerCase(actual)>=DataUtil.toLowerCase(expected):actual>=expected,contains:(actual,expected,ignoreCase,ignoreAccent)=>(ignoreAccent&&(actual=DataUtil.ignoreDiacritics(actual),expected=DataUtil.ignoreDiacritics(expected)),ignoreCase?!isNullOrUndefined(actual)&&!isNullOrUndefined(expected)&&-1!==DataUtil.toLowerCase(actual).indexOf(DataUtil.toLowerCase(expected)):!isNullOrUndefined(actual)&&!isNullOrUndefined(expected)&&-1!==actual.toString().indexOf(expected)),notnull:actual=>null!==actual,isnull:actual=>null===actual,startswith:(actual,expected,ignoreCase,ignoreAccent)=>(ignoreAccent&&(actual=DataUtil.ignoreDiacritics(actual),expected=DataUtil.ignoreDiacritics(expected)),ignoreCase?actual&&expected&&DataUtil.startsWith(DataUtil.toLowerCase(actual),DataUtil.toLowerCase(expected)):actual&&expected&&DataUtil.startsWith(actual,expected)),endswith:(actual,expected,ignoreCase,ignoreAccent)=>(ignoreAccent&&(actual=DataUtil.ignoreDiacritics(actual),expected=DataUtil.ignoreDiacritics(expected)),ignoreCase?actual&&expected&&DataUtil.endsWith(DataUtil.toLowerCase(actual),DataUtil.toLowerCase(expected)):actual&&expected&&DataUtil.endsWith(actual,expected)),processSymbols:operator=>{let fnName=DataUtil.operatorSymbols[operator];return fnName?DataUtil.fnOperators[fnName]:DataUtil.throwError("Query - Process Operator : Invalid operator")},processOperator:operator=>DataUtil.fnOperators[operator]||DataUtil.fnOperators.processSymbols(operator)},DataUtil.parse={parseJson:jsonText=>("string"==typeof jsonText?jsonText=JSON.parse(jsonText,DataUtil.parse.jsonReviver):jsonText instanceof Array?DataUtil.parse.iterateAndReviveArray(jsonText):"object"==typeof jsonText&&null!==jsonText&&DataUtil.parse.iterateAndReviveJson(jsonText),jsonText),iterateAndReviveArray:array=>{for(let i=0;i<array.length;i++)"object"==typeof array[i]&&null!==array[i]?DataUtil.parse.iterateAndReviveJson(array[i]):array[i]="string"!=typeof array[i]||/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(array[i])?DataUtil.parse.parseJson(array[i]):DataUtil.parse.jsonReviver("",array[i])},iterateAndReviveJson:json=>{let value,keys=Object.keys(json);for(let prop of keys)DataUtil.startsWith(prop,"__")||("object"==typeof(value=json[prop])?value instanceof Array?DataUtil.parse.iterateAndReviveArray(value):value&&DataUtil.parse.iterateAndReviveJson(value):json[prop]=DataUtil.parse.jsonReviver(json[prop],value))},jsonReviver:(field,value)=>{let dupValue=value;if("string"==typeof value){let ms=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(value),offSet=DataUtil.timeZoneHandling?DataUtil.serverTimezoneOffset:null;if(ms)return DataUtil.dateParse.toTimeZone(new Date(parseInt(ms[1],10)),offSet,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(value)){let arr=dupValue.split(/[^0-9]/);value=DataUtil.dateParse.toTimeZone(new Date(parseInt(arr[0],10),parseInt(arr[1],10)-1,parseInt(arr[2],10),parseInt(arr[3],10),parseInt(arr[4],10),parseInt(arr[5],10)),offSet,!0)}}return value},isJson:jsonData=>"string"==typeof jsonData[0]?jsonData:DataUtil.parse.parseJson(jsonData),isGuid:value=>null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(value),replacer:(value,stringify)=>DataUtil.isPlainObject(value)?DataUtil.parse.jsonReplacer(value,stringify):value instanceof Array?DataUtil.parse.arrayReplacer(value):value instanceof Date?DataUtil.parse.jsonReplacer({val:value},stringify).val:value,jsonReplacer:(val,stringify)=>{let value,keys=Object.keys(val);for(let prop of keys)(value=val[prop])instanceof Date&&(val[prop]=DataUtil.dateParse.toTimeZone(DataUtil.dateParse.addSelfOffset(value),DataUtil.serverTimezoneOffset).toJSON());return val},arrayReplacer:val=>{for(let i=0;i<val.length;i++)DataUtil.isPlainObject(val[i])?val[i]=DataUtil.parse.jsonReplacer(val[i]):val[i]instanceof Date&&(val[i]=DataUtil.parse.jsonReplacer({date:val[i]}).date);return val},jsonDateReplacer:(key,value)=>{if("value"===key&&value){if("string"==typeof value){let ms=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(value);if(ms)value=DataUtil.dateParse.toTimeZone(new Date(parseInt(ms[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(value)){let arr=value.split(/[^0-9]/);value=DataUtil.dateParse.toTimeZone(new Date(parseInt(arr[0],10),parseInt(arr[1],10)-1,parseInt(arr[2],10),parseInt(arr[3],10),parseInt(arr[4],10),parseInt(arr[5],10)),null,!0)}}if(value instanceof Date)return value=DataUtil.dateParse.addSelfOffset(value),null===DataUtil.serverTimezoneOffset?DataUtil.dateParse.toTimeZone(DataUtil.dateParse.addSelfOffset(value),null).toJSON():(value=DataUtil.dateParse.toTimeZone(value,value.getTimezoneOffset()/60*2-DataUtil.serverTimezoneOffset,!1)).toJSON()}return value}},DataUtil.dateParse={addSelfOffset:input=>new Date(+input-6e4*input.getTimezoneOffset()),toUTC:input=>new Date(+input+6e4*input.getTimezoneOffset()),toTimeZone:(input,offset,utc)=>{if(null===offset)return input;let unix=utc?DataUtil.dateParse.toUTC(input):input;return new Date(+unix-36e5*offset)},toLocalTime:input=>{let datefn=input,timeZone=-datefn.getTimezoneOffset(),differenceString=timeZone>=0?"+":"-",localtimefn=num=>{let norm=Math.floor(Math.abs(num));return(norm<10?"0":"")+norm};return datefn.getFullYear()+"-"+localtimefn(datefn.getMonth()+1)+"-"+localtimefn(datefn.getDate())+"T"+localtimefn(datefn.getHours())+":"+localtimefn(datefn.getMinutes())+":"+localtimefn(datefn.getSeconds())+differenceString+localtimefn(timeZone/60)+":"+localtimefn(timeZone%60)}},DataUtil})();class Adaptor{constructor(ds){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates"},this.type=Adaptor,this.dataSource=ds,this.pvt={}}processResponse(data,ds,query,xhr){return data}}class ej2_data_es2015_JsonAdaptor extends Adaptor{processQuery(dataManager,query){let ret,key,result=dataManager.dataSource.json.slice(0),count=result.length,countFlg=!0,agg={};for(let i=0;i<query.queries.length;i++)ret=this[(key=query.queries[i]).fn].call(this,result,key.e,query),"onAggregates"===key.fn?agg[key.e.field+" - "+key.e.type]=ret:result=void 0!==ret?ret:result,"onPage"!==key.fn&&"onSkip"!==key.fn&&"onTake"!==key.fn&&"onRange"!==key.fn||(countFlg=!1),countFlg&&(count=result.length);return query.isCountRequired&&(result={result:result,count:count,aggregates:agg}),result}batchRequest(dm,changes,e){let i,deletedRecordsLen=changes.deletedRecords.length;for(i=0;i<changes.addedRecords.length;i++)this.insert(dm,changes.addedRecords[i]);for(i=0;i<changes.changedRecords.length;i++)this.update(dm,e.key,changes.changedRecords[i]);for(i=0;i<deletedRecordsLen;i++)this.remove(dm,e.key,changes.deletedRecords[i]);return changes}onWhere(ds,e){return ds&&ds.length?ds.filter(obj=>{if(e)return e.validate(obj)}):ds}onAggregates(ds,e){let fn=ej2_data_es2015_DataUtil.aggregates[e.type];return ds&&fn&&0!==ds.length?fn(ds,e.field):null}onSearch(ds,e){return ds&&ds.length?(0===e.fieldNames.length&&ej2_data_es2015_DataUtil.getFieldList(ds[0],e.fieldNames),ds.filter(obj=>{for(let j=0;j<e.fieldNames.length;j++)if(e.comparer.call(obj,ej2_data_es2015_DataUtil.getObject(e.fieldNames[j],obj),e.searchKey,e.ignoreCase,e.ignoreAccent))return!0;return!1})):ds}onSortBy(ds,e,query){if(!ds||!ds.length)return ds;let fnCompare,field=ej2_data_es2015_DataUtil.getValue(e.fieldName,query);if(!field)return ds.sort(e.comparer);if(field instanceof Array){for(let i=(field=field.slice(0)).length-1;i>=0;i--)field[i]&&(fnCompare=e.comparer,ej2_data_es2015_DataUtil.endsWith(field[i]," desc")&&(fnCompare=ej2_data_es2015_DataUtil.fnSort("descending"),field[i]=field[i].replace(" desc","")),ds=ej2_data_es2015_DataUtil.sort(ds,field[i],fnCompare));return ds}return ej2_data_es2015_DataUtil.sort(ds,field,e.comparer)}onGroup(ds,e,query){if(!ds||!ds.length)return ds;let aggQuery=ej2_data_es2015_Query.filterQueries(query.queries,"onAggregates"),agg=[];if(aggQuery.length){let tmp;for(let i=0;i<aggQuery.length;i++)agg.push({type:(tmp=aggQuery[i].e).type,field:ej2_data_es2015_DataUtil.getValue(tmp.field,query)})}return ej2_data_es2015_DataUtil.group(ds,ej2_data_es2015_DataUtil.getValue(e.fieldName,query),agg,null,null,e.comparer)}onPage(ds,e,query){let size=ej2_data_es2015_DataUtil.getValue(e.pageSize,query),start=(ej2_data_es2015_DataUtil.getValue(e.pageIndex,query)-1)*size;return ds&&ds.length?ds.slice(start,start+size):ds}onRange(ds,e){return ds&&ds.length?ds.slice(ej2_data_es2015_DataUtil.getValue(e.start),ej2_data_es2015_DataUtil.getValue(e.end)):ds}onTake(ds,e){return ds&&ds.length?ds.slice(0,ej2_data_es2015_DataUtil.getValue(e.nos)):ds}onSkip(ds,e){return ds&&ds.length?ds.slice(ej2_data_es2015_DataUtil.getValue(e.nos)):ds}onSelect(ds,e){return ds&&ds.length?ej2_data_es2015_DataUtil.select(ds,ej2_data_es2015_DataUtil.getValue(e.fieldNames)):ds}insert(dm,data,tableName,query,position){return isNullOrUndefined(position)?dm.dataSource.json.push(data):dm.dataSource.json.splice(position,0,data)}remove(dm,keyField,value,tableName){let i,ds=dm.dataSource.json;for("object"!=typeof value||value instanceof Date||(value=value[keyField]),i=0;i<ds.length&&ds[i][keyField]!==value;i++);return i!==ds.length?ds.splice(i,1):null}update(dm,keyField,value,tableName){let i,ds=dm.dataSource.json,key=value[keyField];for(i=0;i<ds.length&&ds[i][keyField]!==key;i++);return i<ds.length?ej2_base_es2015_merge(ds[i],value):null}}class ej2_data_es2015_UrlAdaptor extends Adaptor{processQuery(dm,query,hierarchyFilters){let temp,skip,queries=this.getQueryRequest(query),singles=ej2_data_es2015_Query.filterQueryLists(query.queries,["onSelect","onPage","onSkip","onTake","onRange"]),params=query.params,url=dm.dataSource.url,take=null,options=this.options,request={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in singles?skip=((skip=ej2_data_es2015_DataUtil.getValue((temp=singles.onPage).pageIndex,query))-1)*(take=ej2_data_es2015_DataUtil.getValue(temp.pageSize,query)):"onRange"in singles&&(skip=(temp=singles.onRange).start,take=temp.end-temp.start);for(let i=0;i<queries.sorts.length;i++)temp=ej2_data_es2015_DataUtil.getValue(queries.sorts[i].e.fieldName,query),request.sorts.push(ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onEachSort",{name:temp,direction:queries.sorts[i].e.direction},query));hierarchyFilters&&(temp=this.getFiltersFrom(hierarchyFilters,query))&&request.filters.push(ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onEachWhere",temp.toJson(),query));for(let i=0;i<queries.filters.length;i++){request.filters.push(ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onEachWhere",queries.filters[i].e.toJson(),query));let keys="object"==typeof request.filters[i]?Object.keys(request.filters[i]):[];for(let prop of keys)ej2_data_es2015_DataUtil.isNull(request[prop])&&delete request[prop]}for(let i=0;i<queries.searches.length;i++)request.searches.push(ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onEachSearch",{fields:(temp=queries.searches[i].e).fieldNames,operator:temp.operator,key:temp.searchKey,ignoreCase:temp.ignoreCase},query));for(let i=0;i<queries.groups.length;i++)request.groups.push(ej2_data_es2015_DataUtil.getValue(queries.groups[i].e.fieldName,query));for(let i=0;i<queries.aggregates.length;i++)request.aggregates.push({type:(temp=queries.aggregates[i].e).type,field:ej2_data_es2015_DataUtil.getValue(temp.field,query)});let req={};this.getRequestQuery(options,query,singles,request,req),ej2_data_es2015_DataUtil.callAdaptorFunction(this,"addParams",{dm:dm,query:query,params:params,reqParams:req});let keys=Object.keys(req);for(let prop of keys)(ej2_data_es2015_DataUtil.isNull(req[prop])||""===req[prop]||0===req[prop].length)&&delete req[prop];options.skip in req&&options.take in req||null===take||(req[options.skip]=ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onSkip",skip,query),req[options.take]=ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onTake",take,query));let p=this.pvt;return this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(req,ej2_data_es2015_DataUtil.parse.jsonDateReplacer),url:url,pvtData:p,type:"POST",contentType:"application/json; charset=utf-8"}:(temp=this.convertToQueryString(req,query,dm),{type:"GET",url:(temp=(-1!==dm.dataSource.url.indexOf("?")?"&":"/")+temp).length?url.replace(/\/*$/,temp):url,pvtData:p})}getRequestQuery(options,query,singles,request,request1){let req=request1;req[options.from]=query.fromTable,options.apply&&query.distincts.length&&(req[options.apply]="onDistinct"in this?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onDistinct",query.distincts):""),!query.distincts.length&&options.expand&&(req[options.expand]="onExpand"in this&&"onSelect"in singles?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onExpand",{selects:ej2_data_es2015_DataUtil.getValue(singles.onSelect.fieldNames,query),expands:query.expands},query):query.expands),req[options.select]="onSelect"in singles&&!query.distincts.length?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onSelect",ej2_data_es2015_DataUtil.getValue(singles.onSelect.fieldNames,query),query):"",req[options.count]=query.isCountRequired?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onCount",query.isCountRequired,query):"",req[options.search]=request.searches.length?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onSearch",request.searches,query):"",req[options.skip]="onSkip"in singles?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onSkip",ej2_data_es2015_DataUtil.getValue(singles.onSkip.nos,query),query):"",req[options.take]="onTake"in singles?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onTake",ej2_data_es2015_DataUtil.getValue(singles.onTake.nos,query),query):"",req[options.where]=request.filters.length||request.searches.length?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onWhere",request.filters,query):"",req[options.sortBy]=request.sorts.length?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onSortBy",request.sorts,query):"",req[options.group]=request.groups.length?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onGroup",request.groups,query):"",req[options.aggregates]=request.aggregates.length?ej2_data_es2015_DataUtil.callAdaptorFunction(this,"onAggregates",request.aggregates,query):"",req.param=[]}convertToQueryString(request,query,dm){return""}processResponse(data,ds,query,xhr,request,changes){if(xhr&&xhr.getResponseHeader("Content-Type")&&-1!==xhr.getResponseHeader("Content-Type").indexOf("application/json")){let handleTimeZone=ej2_data_es2015_DataUtil.timeZoneHandling;ds&&!ds.timeZoneHandling&&(ej2_data_es2015_DataUtil.timeZoneHandling=!1),data=ej2_data_es2015_DataUtil.parse.parseJson(data),ej2_data_es2015_DataUtil.timeZoneHandling=handleTimeZone}let requests=request,pvt=requests.pvtData||{},groupDs=data?data.groupDs:[];if(xhr&&xhr.getResponseHeader("Content-Type")&&-1!==xhr.getResponseHeader("Content-Type").indexOf("xml"))return query.isCountRequired?{result:[],count:0}:[];let d=JSON.parse(requests.data);if(d&&"batch"===d.action&&data&&data.addedRecords)return changes.addedRecords=data.addedRecords,changes;data&&data.d&&(data=data.d);let args={};return data&&"count"in data&&(args.count=data.count),args.result=data&&data.result?data.result:data,this.getAggregateResult(pvt,data,args,groupDs,query),ej2_data_es2015_DataUtil.isNull(args.count)?args.result:{result:args.result,count:args.count,aggregates:args.aggregates}}onGroup(e){return this.pvt.groups=e,e}onAggregates(e){this.pvt.aggregates=e}batchRequest(dm,changes,e,query,original){return{type:"POST",url:dm.dataSource.batchUrl||dm.dataSource.crudUrl||dm.dataSource.removeUrl||dm.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(extend({},{changed:changes.changedRecords,added:changes.addedRecords,deleted:changes.deletedRecords,action:"batch",table:e[void 0],key:e[void 0]},ej2_data_es2015_DataUtil.getAddParams(this,dm,query)))}}beforeSend(dm,request){}insert(dm,data,tableName,query){return{url:dm.dataSource.insertUrl||dm.dataSource.crudUrl||dm.dataSource.url,data:JSON.stringify(extend({},{value:data,table:tableName,action:"insert"},ej2_data_es2015_DataUtil.getAddParams(this,dm,query)))}}remove(dm,keyField,value,tableName,query){return{type:"POST",url:dm.dataSource.removeUrl||dm.dataSource.crudUrl||dm.dataSource.url,data:JSON.stringify(extend({},{key:value,keyColumn:keyField,table:tableName,action:"remove"},ej2_data_es2015_DataUtil.getAddParams(this,dm,query)))}}update(dm,keyField,value,tableName,query){return{type:"POST",url:dm.dataSource.updateUrl||dm.dataSource.crudUrl||dm.dataSource.url,data:JSON.stringify(extend({},{value:value,action:"update",keyColumn:keyField,key:value[keyField],table:tableName},ej2_data_es2015_DataUtil.getAddParams(this,dm,query)))}}getFiltersFrom(data,query){let value,key=query.fKey,prop=key,pKey=query.key,predicats=[];"object"!=typeof data[0]&&(prop=null);for(let i=0;i<data.length;i++)value="object"==typeof data[0]?ej2_data_es2015_DataUtil.getObject(pKey||prop,data[i]):data[i],predicats.push(new ej2_data_es2015_Predicate(key,"equal",value));return ej2_data_es2015_Predicate.or(predicats)}getAggregateResult(pvt,data,args,groupDs,query){let pData=data;if(data&&data.result&&(pData=data.result),pvt&&pvt.aggregates&&pvt.aggregates.length){let fn,agg=pvt.aggregates,aggregateData=pData,res={};data.aggregate&&(aggregateData=data.aggregate);for(let i=0;i<agg.length;i++)(fn=ej2_data_es2015_DataUtil.aggregates[agg[i].type])&&(res[agg[i].field+" - "+agg[i].type]=fn(aggregateData,agg[i].field));args.aggregates=res}if(pvt&&pvt.groups&&pvt.groups.length){let groups=pvt.groups;for(let i=0;i<groups.length;i++){let level=null;isNullOrUndefined(groupDs)||(groupDs=ej2_data_es2015_DataUtil.group(groupDs,groups[i]));let groupQuery=ej2_data_es2015_Query.filterQueries(query.queries,"onGroup")[i].e;pData=ej2_data_es2015_DataUtil.group(pData,groups[i],pvt.aggregates,level,groupDs,groupQuery.comparer)}args.result=pData}return args}getQueryRequest(query){let req={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return req.sorts=ej2_data_es2015_Query.filterQueries(query.queries,"onSortBy"),req.groups=ej2_data_es2015_Query.filterQueries(query.queries,"onGroup"),req.filters=ej2_data_es2015_Query.filterQueries(query.queries,"onWhere"),req.searches=ej2_data_es2015_Query.filterQueries(query.queries,"onSearch"),req.aggregates=ej2_data_es2015_Query.filterQueries(query.queries,"onAggregates"),req}addParams(options){let req=options.reqParams;options.params.length&&(req.params={});for(let tmp of options.params){if(req[tmp.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");req[tmp.key]=tmp.value,tmp.fn&&(req[tmp.key]=tmp.fn.call(options.query,tmp.key,options.query,options.dm)),req.params[tmp.key]=req[tmp.key]}}}class ej2_data_es2015_ODataAdaptor extends ej2_data_es2015_UrlAdaptor{constructor(props){super(),this.options=extend({},this.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),extend(this.options,props||{})}getModuleName(){return"ODataAdaptor"}onPredicate(predicate,query,requiresCast){let operator,guid,returnValue="",val=predicate.value,type=typeof val,field=predicate.field?ej2_data_es2015_ODataAdaptor.getField(predicate.field):null;if(val instanceof Date&&(val="datetime'"+ej2_data_es2015_DataUtil.parse.replacer(val)+"'"),"string"===type&&(val=encodeURIComponent(val),requiresCast&&(field="cast("+field+", 'Edm.String')"),ej2_data_es2015_DataUtil.parse.isGuid(val="'"+val+"'")&&(guid="guid"),predicate.ignoreCase&&(guid||(field="tolower("+field+")"),val=val.toLowerCase())),operator=ej2_data_es2015_DataUtil.odBiOperator[predicate.operator])return returnValue+=field,returnValue+=operator,guid&&(returnValue+=guid),returnValue+val;if("substringof"===(operator=isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?ej2_data_es2015_DataUtil.odUniOperator[predicate.operator]:ej2_data_es2015_DataUtil.odv4UniOperator[predicate.operator])){let temp=val;val=field,field=temp}return returnValue+=operator+"(",returnValue+=field+",",guid&&(returnValue+=guid),returnValue+(val+")")}addParams(options){super.addParams(options),delete options.reqParams.params}onComplexPredicate(predicate,query,requiresCast){let res=[];for(let i=0;i<predicate.predicates.length;i++)res.push("("+this.onEachWhere(predicate.predicates[i],query,requiresCast)+")");return res.join(" "+predicate.condition+" ")}onEachWhere(filter,query,requiresCast){return filter.isComplex?this.onComplexPredicate(filter,query,requiresCast):this.onPredicate(filter,query,requiresCast)}onWhere(filters){return this.pvt.search&&filters.push(this.onEachWhere(this.pvt.search,null,!0)),filters.join(" and ")}onEachSearch(e){e.fields&&0===e.fields.length&&ej2_data_es2015_DataUtil.throwError("Query() - Search : oData search requires list of field names to search");let filter=this.pvt.search||[];for(let i=0;i<e.fields.length;i++)filter.push(new ej2_data_es2015_Predicate(e.fields[i],e.operator,e.key,e.ignoreCase));this.pvt.search=filter}onSearch(e){return this.pvt.search=ej2_data_es2015_Predicate.or(this.pvt.search),""}onEachSort(e){let res=[];if(e.name instanceof Array)for(let i=0;i<e.name.length;i++)res.push(ej2_data_es2015_ODataAdaptor.getField(e.name[i])+("descending"===e.direction?" desc":""));else res.push(ej2_data_es2015_ODataAdaptor.getField(e.name)+("descending"===e.direction?" desc":""));return res.join(",")}onSortBy(e){return e.reverse().join(",")}onGroup(e){return this.pvt.groups=e,[]}onSelect(e){for(let i=0;i<e.length;i++)e[i]=ej2_data_es2015_ODataAdaptor.getField(e[i]);return e.join(",")}onAggregates(e){return this.pvt.aggregates=e,""}onCount(e){return!0===e?"allpages":""}beforeSend(dm,request,settings){ej2_data_es2015_DataUtil.endsWith(settings.url,this.options.batch)&&"post"===settings.type.toLowerCase()?(request.setRequestHeader("Accept",this.options.multipartAccept),request.setRequestHeader("DataServiceVersion","2.0"),request.overrideMimeType("text/plain; charset=x-user-defined")):request.setRequestHeader("Accept",this.options.accept),request.setRequestHeader("DataServiceVersion","2.0"),request.setRequestHeader("MaxDataServiceVersion","2.0")}processResponse(data,ds,query,xhr,request,changes){if(request&&"GET"===request.type&&!this.rootUrl&&data["odata.metadata"]){let dataUrls=data["odata.metadata"].split("/$metadata#");this.rootUrl=dataUrls[0],this.resourceTableName=dataUrls[1]}if(!isNullOrUndefined(data.d)){let dataCopy=query&&query.isCountRequired?data.d.results:data.d,metaData="__metadata";if(!isNullOrUndefined(dataCopy))for(let i=0;i<dataCopy.length;i++)isNullOrUndefined(dataCopy[i][metaData])||delete dataCopy[i][metaData]}let pvt=request&&request.pvtData,emptyAndBatch=this.processBatchResponse(data,query,xhr,request,changes);if(emptyAndBatch)return emptyAndBatch;let versionCheck=xhr&&request.getResponseHeader("DataServiceVersion"),count=null,version=versionCheck&&parseInt(versionCheck,10)||2;if(query&&query.isCountRequired){let oDataCount="__count";(data[oDataCount]||data["odata.count"])&&(count=data[oDataCount]||data["odata.count"]),data.d&&(data=data.d),(data[oDataCount]||data["odata.count"])&&(count=data[oDataCount]||data["odata.count"])}3===version&&data.value&&(data=data.value),data.d&&(data=data.d),version<3&&data.results&&(data=data.results);let args={};return args.count=count,args.result=data,this.getAggregateResult(pvt,data,args,null,query),ej2_data_es2015_DataUtil.isNull(count)?args.result:{result:args.result,count:args.count,aggregates:args.aggregates}}convertToQueryString(request,query,dm){let res=[],tableName=request.table||"";delete request.table,dm.dataSource.requiresFormat&&(request.$format="json");let keys=Object.keys(request);for(let prop of keys)res.push(prop+"="+request[prop]);return res=res.join("&"),dm.dataSource.url&&-1!==dm.dataSource.url.indexOf("?")&&!tableName?res:res.length?tableName+"?"+res:tableName||""}localTimeReplacer(key,convertObj){for(let prop of isNullOrUndefined(convertObj)?[]:Object.keys(convertObj))convertObj[prop]instanceof Date&&(convertObj[prop]=ej2_data_es2015_DataUtil.dateParse.toLocalTime(convertObj[prop]));return convertObj}insert(dm,data,tableName){return{url:(dm.dataSource.insertUrl||dm.dataSource.url).replace(/\/*$/,tableName?"/"+tableName:""),data:JSON.stringify(data,this.options.localTime?this.localTimeReplacer:null)}}remove(dm,keyField,value,tableName){let url;return url="string"!=typeof value||ej2_data_es2015_DataUtil.parse.isGuid(value)?`(${value})`:`('${value}')`,{type:"DELETE",url:(dm.dataSource.removeUrl||dm.dataSource.url).replace(/\/*$/,tableName?"/"+tableName:"")+url}}update(dm,keyField,value,tableName,query,original){let url;return"PATCH"!==this.options.updateType||isNullOrUndefined(original)||(value=this.compareAndRemove(value,original,keyField)),url="string"!=typeof value[keyField]||ej2_data_es2015_DataUtil.parse.isGuid(value[keyField])?`(${value[keyField]})`:`('${value[keyField]}')`,{type:this.options.updateType,url:(dm.dataSource.updateUrl||dm.dataSource.url).replace(/\/*$/,tableName?"/"+tableName:"")+url,data:JSON.stringify(value,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}}batchRequest(dm,changes,e,query,original){let initialGuid=e.guid=ej2_data_es2015_DataUtil.getGuid(this.options.batchPre),url=this.rootUrl?this.rootUrl+"/"+this.options.batch:dm.dataSource.url.replace(/\/*$/,"/"+this.options.batch);e.url=this.resourceTableName?this.resourceTableName:e.url;let args={url:e.url,key:e.key,cid:1,cSet:ej2_data_es2015_DataUtil.getGuid(this.options.changeSet)},req="--"+initialGuid+"\n";return req+="Content-Type: multipart/mixed; boundary="+args.cSet.replace("--","")+"\n",this.pvt.changeSet=0,req+=this.generateInsertRequest(changes.addedRecords,args,dm),req+=this.generateUpdateRequest(changes.changedRecords,args,dm,original?original.changedRecords:[]),req+=this.generateDeleteRequest(changes.deletedRecords,args,dm),req+=args.cSet+"--\n",{type:"POST",url:url,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+initialGuid,data:req+="--"+initialGuid+"--"}}generateDeleteRequest(arr,e,dm){if(!arr)return"";let req="";return(req=this.generateBodyContent(arr,e,{method:"DELETE ",url:(data,i,key)=>{let url=ej2_data_es2015_DataUtil.getObject(key,data[i]);return"number"==typeof url||ej2_data_es2015_DataUtil.parse.isGuid(url)?"("+url+")":url instanceof Date?"("+data[i][key].toJSON()+")":`('${url}')`},data:(data,i)=>""},dm))+"\n"}generateInsertRequest(arr,e,dm){return arr?this.generateBodyContent(arr,e,{method:"POST ",url:(data,i,key)=>"",data:(data,i)=>JSON.stringify(data[i])+"\n\n"},dm):""}generateUpdateRequest(arr,e,dm,org){return arr?(arr.forEach(change=>change=this.compareAndRemove(change,org.filter(o=>ej2_data_es2015_DataUtil.getObject(e.key,o)===ej2_data_es2015_DataUtil.getObject(e.key,change))[0],e.key)),this.generateBodyContent(arr,e,{method:this.options.updateType+" ",url:(data,i,key)=>"number"==typeof data[i][key]||ej2_data_es2015_DataUtil.parse.isGuid(data[i][key])?"("+data[i][key]+")":data[i][key]instanceof Date?"("+data[i][key].toJSON()+")":`('${data[i][key]}')`,data:(data,i)=>JSON.stringify(data[i])+"\n\n"},dm)):""}static getField(prop){return prop.replace(/\./g,"/")}generateBodyContent(arr,e,stat,dm){let req="";for(let i=0;i<arr.length;i++)req+="\n"+e.cSet+"\n",req+=this.options.changeSetContent+"\n\n",req+=stat.method,"POST "===stat.method?req+=(dm.dataSource.insertUrl||dm.dataSource.crudUrl||e.url)+stat.url(arr,i,e.key)+" HTTP/1.1\n":"PUT "===stat.method||"PATCH "===stat.method?req+=(dm.dataSource.updateUrl||dm.dataSource.crudUrl||e.url)+stat.url(arr,i,e.key)+" HTTP/1.1\n":"DELETE "===stat.method&&(req+=(dm.dataSource.removeUrl||dm.dataSource.crudUrl||e.url)+stat.url(arr,i,e.key)+" HTTP/1.1\n"),req+="Accept: "+this.options.accept+"\n",req+="Content-Id: "+this.pvt.changeSet+++"\n",req+=this.options.batchChangeSetContentType+"\n",isNullOrUndefined(arr[i]["@odata.etag"])?req+="\n":(req+="If-Match: "+arr[i]["@odata.etag"]+"\n\n",delete arr[i]["@odata.etag"]),req+=stat.data(arr,i);return req}processBatchResponse(data,query,xhr,request,changes){if(xhr&&xhr.getResponseHeader("Content-Type")&&-1!==xhr.getResponseHeader("Content-Type").indexOf("xml"))return query.isCountRequired?{result:[],count:0}:[];if(request&&this.options.batch&&ej2_data_es2015_DataUtil.endsWith(request.url,this.options.batch)&&"post"===request.type.toLowerCase()){let cIdx,jsonObj,guid=xhr.getResponseHeader("Content-Type"),d=data+"";if(guid=guid.substring(guid.indexOf("=batchresponse")+1),(d=d.split(guid)).length<2)return{};let exVal=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(d=d[1]);exVal&&d.replace(exVal[0],"");for(let i=(d=d.split(exVal?exVal[1]:"")).length;i>-1;i--)/\bContent-ID:/i.test(d[i])&&/\bHTTP.+201/.test(d[i])&&(cIdx=parseInt(/\bContent-ID: (\d+)/i.exec(d[i])[1],10),changes.addedRecords[cIdx]&&(jsonObj=ej2_data_es2015_DataUtil.parse.parseJson(/^\{.+\}/m.exec(d[i])[0]),extend({},changes.addedRecords[cIdx],this.processResponse(jsonObj))));return changes}return null}compareAndRemove(data,original,key){return isNullOrUndefined(original)?data:(Object.keys(data).forEach(prop=>{prop!==key&&"@odata.etag"!==prop&&(ej2_data_es2015_DataUtil.isPlainObject(data[prop])?(this.compareAndRemove(data[prop],original[prop]),0===Object.keys(data[prop]).filter(data=>"@odata.etag"!==data).length&&delete data[prop]):data[prop]===original[prop]?delete data[prop]:data[prop]&&original[prop]&&data[prop].valueOf()===original[prop].valueOf()&&delete data[prop])}),data)}}class WebApiAdaptor extends ej2_data_es2015_ODataAdaptor{getModuleName(){return"WebApiAdaptor"}insert(dm,data,tableName){return{type:"POST",url:dm.dataSource.url,data:JSON.stringify(data)}}remove(dm,keyField,value,tableName){return{type:"DELETE",url:dm.dataSource.url+"/"+value,data:JSON.stringify(value)}}update(dm,keyField,value,tableName){return{type:"PUT",url:dm.dataSource.url,data:JSON.stringify(value)}}batchRequest(dm,changes,e){let initialGuid=e.guid=ej2_data_es2015_DataUtil.getGuid(this.options.batchPre),url=dm.dataSource.url.replace(/\/*$/,"/"+this.options.batch);e.url=this.resourceTableName?this.resourceTableName:e.url;let req=[];for(let i=0,x=changes.addedRecords.length;i<x;i++)changes.addedRecords.forEach((j,d)=>{req.push("--"+initialGuid),req.push("Content-Type: application/http; msgtype=request",""),req.push("POST /api/"+(dm.dataSource.insertUrl||dm.dataSource.crudUrl||e.url)+" HTTP/1.1"),req.push("Content-Type: application/json; charset=utf-8"),req.push("Host: "+location.host),req.push("",j?JSON.stringify(j):"")});for(let i=0,x=changes.changedRecords.length;i<x;i++)changes.changedRecords.forEach((j,d)=>{req.push("--"+initialGuid),req.push("Content-Type: application/http; msgtype=request",""),req.push("PUT /api/"+(dm.dataSource.updateUrl||dm.dataSource.crudUrl||e.url)+" HTTP/1.1"),req.push("Content-Type: application/json; charset=utf-8"),req.push("Host: "+location.host),req.push("",j?JSON.stringify(j):"")});for(let i=0,x=changes.deletedRecords.length;i<x;i++)changes.deletedRecords.forEach((j,d)=>{req.push("--"+initialGuid),req.push("Content-Type: application/http; msgtype=request",""),req.push("DELETE /api/"+(dm.dataSource.removeUrl||dm.dataSource.crudUrl||e.url)+((data,i,key)=>{let url=ej2_data_es2015_DataUtil.getObject(key,data[i]);return"number"==typeof url||ej2_data_es2015_DataUtil.parse.isGuid(url)?"/"+url:url instanceof Date?"/"+data[i][key].toJSON():`/'${url}'`})(changes.deletedRecords,i,e.key)+" HTTP/1.1"),req.push("Content-Type: application/json; charset=utf-8"),req.push("Host: "+location.host),req.push("",j?JSON.stringify(j):"")});return req.push("--"+initialGuid+"--",""),{type:"POST",url:url,contentType:"multipart/mixed; boundary="+initialGuid,data:req.join("\r\n")}}beforeSend(dm,request,settings){request.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01")}processResponse(data,ds,query,xhr,request,changes){let pvt=request&&request.pvtData,count=null,args={};if(request&&"post"!==request.type.toLowerCase()){let versionCheck=xhr&&request.getResponseHeader("DataServiceVersion"),version=versionCheck&&parseInt(versionCheck,10)||2;query&&query.isCountRequired&&(ej2_data_es2015_DataUtil.isNull(data.Count)||(count=data.Count)),version<3&&data.Items&&(data=data.Items),args.count=count,args.result=data,this.getAggregateResult(pvt,data,args,null,query)}return args.result=args.result||data,ej2_data_es2015_DataUtil.isNull(count)?args.result:{result:args.result,count:args.count,aggregates:args.aggregates}}}class WebMethodAdaptor extends ej2_data_es2015_UrlAdaptor{processQuery(dm,query,hierarchyFilters){let obj=(new ej2_data_es2015_UrlAdaptor).processQuery(dm,query,hierarchyFilters),data=ej2_data_es2015_DataUtil.parse.parseJson(obj.data),result={};if(data.param)for(let i=0;i<data.param.length;i++){let param=data.param[i],key=Object.keys(param)[0];result[key]=param[key]}return result.value=data,{data:JSON.stringify(result),url:obj.url,pvtData:obj.pvtData,type:"POST",contentType:"application/json; charset=utf-8"}}}class ej2_data_es2015_RemoteSaveAdaptor extends ej2_data_es2015_JsonAdaptor{constructor(){super(),setValue("beforeSend",ej2_data_es2015_UrlAdaptor.prototype.beforeSend,this)}insert(dm,data,tableName,query,position){return this.pvt.position=position,this.updateType="add",{url:dm.dataSource.insertUrl||dm.dataSource.crudUrl||dm.dataSource.url,data:JSON.stringify(extend({},{value:data,table:tableName,action:"insert"},ej2_data_es2015_DataUtil.getAddParams(this,dm,query)))}}remove(dm,keyField,val,tableName,query){return super.remove(dm,keyField,val),{type:"POST",url:dm.dataSource.removeUrl||dm.dataSource.crudUrl||dm.dataSource.url,data:JSON.stringify(extend({},{key:val,keyColumn:keyField,table:tableName,action:"remove"},ej2_data_es2015_DataUtil.getAddParams(this,dm,query)))}}update(dm,keyField,val,tableName,query){return this.updateType="update",this.updateKey=keyField,{type:"POST",url:dm.dataSource.updateUrl||dm.dataSource.crudUrl||dm.dataSource.url,data:JSON.stringify(extend({},{value:val,action:"update",keyColumn:keyField,key:val[keyField],table:tableName},ej2_data_es2015_DataUtil.getAddParams(this,dm,query)))}}processResponse(data,ds,query,xhr,request,changes,e){let i;if("add"===this.updateType&&super.insert(ds,data,null,null,this.pvt.position),"update"===this.updateType&&super.update(ds,this.updateKey,data),this.updateType=void 0,data.added)for(i=0;i<data.added.length;i++)super.insert(ds,data.added[i]);if(data.changed)for(i=0;i<data.changed.length;i++)super.update(ds,e.key,data.changed[i]);if(data.deleted)for(i=0;i<data.deleted.length;i++)super.remove(ds,e.key,data.deleted[i]);return data}batchRequest(dm,changes,e){return{type:"POST",url:dm.dataSource.batchUrl||dm.dataSource.crudUrl||dm.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({changed:changes.changedRecords,added:changes.addedRecords,deleted:changes.deletedRecords,action:"batch",table:e.url,key:e.key})}}addParams(options){(new ej2_data_es2015_UrlAdaptor).addParams(options)}}class ej2_data_es2015_CacheAdaptor extends ej2_data_es2015_UrlAdaptor{constructor(adaptor,timeStamp,pageSize){super(),this.isCrudAction=!1,this.isInsertAction=!1,isNullOrUndefined(adaptor)||(this.cacheAdaptor=adaptor),this.pageSize=pageSize,this.guidId=ej2_data_es2015_DataUtil.getGuid("cacheAdaptor"),window.localStorage.setItem(this.guidId,JSON.stringify({keys:[],results:[]}));let guid=this.guidId;isNullOrUndefined(timeStamp)||setInterval(()=>{let data;data=ej2_data_es2015_DataUtil.parse.parseJson(window.localStorage.getItem(guid));let forDel=[];for(let i=0;i<data.results.length;i++){let currentTime=+new Date,requestTime=+new Date(data.results[i].timeStamp);data.results[i].timeStamp=currentTime-requestTime,currentTime-requestTime>timeStamp&&forDel.push(i)}for(let i=0;i<forDel.length;i++)data.results.splice(forDel[i],1),data.keys.splice(forDel[i],1);window.localStorage.removeItem(guid),window.localStorage.setItem(guid,JSON.stringify(data))},timeStamp)}generateKey(url,query){let queries=this.getQueryRequest(query),singles=ej2_data_es2015_Query.filterQueryLists(query.queries,["onSelect","onPage","onSkip","onTake","onRange"]),key=url;"onPage"in singles&&(key+=singles.onPage.pageIndex),queries.sorts.forEach(obj=>{key+=obj.e.direction+obj.e.fieldName}),queries.groups.forEach(obj=>{key+=obj.e.fieldName}),queries.searches.forEach(obj=>{key+=obj.e.searchKey});for(let filter=0;filter<queries.filters.length;filter++){let currentFilter=queries.filters[filter];if(currentFilter.e.isComplex){let newQuery=query.clone();newQuery.queries=[];for(let i=0;i<currentFilter.e.predicates.length;i++)newQuery.queries.push({fn:"onWhere",e:currentFilter.e.predicates[i],filter:query.queries.filter});key+=currentFilter.e.condition+this.generateKey(url,newQuery)}else key+=currentFilter.e.field+currentFilter.e.operator+currentFilter.e.value}return key}processQuery(dm,query,hierarchyFilters){let cachedItems,key=this.generateKey(dm.dataSource.url,query),data=(cachedItems=ej2_data_es2015_DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId)))?cachedItems.results[cachedItems.keys.indexOf(key)]:null;return null==data||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):data}processResponse(data,ds,query,xhr,request,changes){if(this.isInsertAction||request&&this.cacheAdaptor.options.batch&&ej2_data_es2015_DataUtil.endsWith(request.url,this.cacheAdaptor.options.batch)&&"post"===request.type.toLowerCase())return this.cacheAdaptor.processResponse(data,ds,query,xhr,request,changes);data=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));let key=query?this.generateKey(ds.dataSource.url,query):ds.dataSource.url,obj={},index=(obj=ej2_data_es2015_DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId))).keys.indexOf(key);for(-1!==index&&(obj.results.splice(index,1),obj.keys.splice(index,1)),obj.results[obj.keys.push(key)-1]={keys:key,result:data.result,timeStamp:new Date,count:data.count};obj.results.length>this.pageSize;)obj.results.splice(0,1),obj.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(obj)),data}beforeSend(dm,request,settings){!isNullOrUndefined(this.cacheAdaptor.options.batch)&&ej2_data_es2015_DataUtil.endsWith(settings.url,this.cacheAdaptor.options.batch)&&"post"===settings.type.toLowerCase()&&request.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept),dm.dataSource.crossDomain||request.setRequestHeader("Accept",this.cacheAdaptor.options.accept)}update(dm,keyField,value,tableName){return this.isCrudAction=!0,this.cacheAdaptor.update(dm,keyField,value,tableName)}insert(dm,data,tableName){return this.isInsertAction=!0,this.cacheAdaptor.insert(dm,data,tableName)}remove(dm,keyField,value,tableName){return this.isCrudAction=!0,this.cacheAdaptor.remove(dm,keyField,value,tableName)}batchRequest(dm,changes,e){return this.cacheAdaptor.batchRequest(dm,changes,e)}}class ej2_data_es2015_DataManager{constructor(dataSource,query,adaptor){let data;return this.dateParse=!0,this.timeZoneHandling=!0,this.requests=[],dataSource||this.dataSource||(dataSource=[]),adaptor=adaptor||dataSource.adaptor,dataSource&&!1===dataSource.timeZoneHandling&&(this.timeZoneHandling=dataSource.timeZoneHandling),dataSource instanceof Array?data={json:dataSource,offline:!0}:"object"==typeof dataSource?(dataSource.json||(dataSource.json=[]),data={url:dataSource.url,insertUrl:dataSource.insertUrl,removeUrl:dataSource.removeUrl,updateUrl:dataSource.updateUrl,crudUrl:dataSource.crudUrl,batchUrl:dataSource.batchUrl,json:dataSource.json,headers:dataSource.headers,accept:dataSource.accept,data:dataSource.data,timeTillExpiration:dataSource.timeTillExpiration,cachingPageSize:dataSource.cachingPageSize,enableCaching:dataSource.enableCaching,requestType:dataSource.requestType,key:dataSource.key,crossDomain:dataSource.crossDomain,jsonp:dataSource.jsonp,dataType:dataSource.dataType,offline:void 0!==dataSource.offline?dataSource.offline:!(dataSource.adaptor instanceof ej2_data_es2015_RemoteSaveAdaptor||dataSource.url),requiresFormat:dataSource.requiresFormat}):ej2_data_es2015_DataUtil.throwError("DataManager: Invalid arguments"),void 0!==data.requiresFormat||ej2_data_es2015_DataUtil.isCors()||(data.requiresFormat=!!isNullOrUndefined(data.crossDomain)||data.crossDomain),void 0===data.dataType&&(data.dataType="json"),this.dataSource=data,this.defaultQuery=query,data.url&&data.offline&&!data.json.length?(this.isDataAvailable=!1,this.adaptor=adaptor||new ej2_data_es2015_ODataAdaptor,this.dataSource.offline=!1,this.ready=this.executeQuery(query||new ej2_data_es2015_Query),this.ready.then(e=>{this.dataSource.offline=!0,this.isDataAvailable=!0,data.json=e.result,this.adaptor=new ej2_data_es2015_JsonAdaptor})):this.adaptor=data.offline?new ej2_data_es2015_JsonAdaptor:new ej2_data_es2015_ODataAdaptor,!data.jsonp&&this.adaptor instanceof ej2_data_es2015_ODataAdaptor&&(data.jsonp="callback"),this.adaptor=adaptor||this.adaptor,data.enableCaching&&(this.adaptor=new ej2_data_es2015_CacheAdaptor(this.adaptor,data.timeTillExpiration,data.cachingPageSize)),this}setDefaultQuery(query){return this.defaultQuery=query,this}executeLocal(query){this.defaultQuery||query instanceof ej2_data_es2015_Query||ej2_data_es2015_DataUtil.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||ej2_data_es2015_DataUtil.throwError("DataManager - executeLocal() : Json data is required to execute");let result=this.adaptor.processQuery(this,query=query||this.defaultQuery);if(query.subQuery){let from=query.subQuery.fromTable,lookup=query.subQuery.lookups,res=query.isCountRequired?result.result:result;lookup&&lookup instanceof Array&&ej2_data_es2015_DataUtil.buildHierarchy(query.subQuery.fKey,from,res,lookup,query.subQuery.key);for(let j=0;j<res.length;j++)res[j][from]instanceof Array&&(res[j]=extend({},{},res[j]),res[j][from]=this.adaptor.processResponse(query.subQuery.using(new ej2_data_es2015_DataManager(res[j][from].slice(0))).executeLocal(),this,query))}return this.adaptor.processResponse(result,this,query)}executeQuery(query,done,fail,always){"function"==typeof query&&(always=fail,fail=done,done=query,query=null),query||(query=this.defaultQuery),query instanceof ej2_data_es2015_Query||ej2_data_es2015_DataUtil.throwError("DataManager - executeQuery() : A query is required to execute");let deffered=new Deferred,args={query:query};if(!this.dataSource.offline&&void 0!==this.dataSource.url&&""!==this.dataSource.url||!isNullOrUndefined(this.adaptor.makeRequest)){let result=this.adaptor.processQuery(this,query);isNullOrUndefined(this.adaptor.makeRequest)?isNullOrUndefined(result.url)?(args=ej2_data_es2015_DataManager.getDeferedArgs(query,result,args),deffered.resolve(args)):this.makeRequest(result,deffered,args,query):this.adaptor.makeRequest(result,deffered,args,query)}else ej2_data_es2015_DataManager.nextTick(()=>{let res=this.executeLocal(query);args=ej2_data_es2015_DataManager.getDeferedArgs(query,res,args),deffered.resolve(args)});return(done||fail)&&deffered.promise.then(done,fail),always&&deffered.promise.then(always,always),deffered.promise}static getDeferedArgs(query,result,args){return query.isCountRequired?(args.result=result.result,args.count=result.count,args.aggregates=result.aggregates):args.result=result,args}static nextTick(fn){(window.setImmediate||window.setTimeout)(fn,0)}extendRequest(url,fnSuccess,fnFail){return extend({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:fnSuccess,onFailure:fnFail},url)}makeRequest(url,deffered,args,query){let isSelector=!!query.subQuerySelector,fnFail=e=>{args.error=e,deffered.reject(args)},process=(data,count,xhr,request,actual,aggregates,virtualSelectRecords)=>{args.xhr=xhr,args.count=count?parseInt(count.toString(),10):0,args.result=data,args.request=request,args.aggregates=aggregates,args.actual=actual,args.virtualSelectRecords=virtualSelectRecords,deffered.resolve(args)},fnQueryChild=(data,selector)=>{let subDeffer=new Deferred,childArgs={parent:args};query.subQuery.isChild=!0;let subUrl=this.adaptor.processQuery(this,query.subQuery,data?this.adaptor.processResponse(data):selector),childReq=this.makeRequest(subUrl,subDeffer,childArgs,query.subQuery);return isSelector||subDeffer.then(subData=>{data&&(ej2_data_es2015_DataUtil.buildHierarchy(query.subQuery.fKey,query.subQuery.fromTable,data,subData,query.subQuery.key),process(data,subData.count,subData.xhr))},fnFail),childReq},req=this.extendRequest(url,(data,request)=>{-1===request.httpRequest.getResponseHeader("Content-Type").indexOf("xml")&&this.dateParse&&(data=ej2_data_es2015_DataUtil.parse.parseJson(data));let result=this.adaptor.processResponse(data,this,query,request.httpRequest,request),count=0,aggregates=null,virtualRecords=data.virtualSelectRecords;query.isCountRequired&&(count=result.count,aggregates=result.aggregates,result=result.result),query.subQuery?isSelector||fnQueryChild(result,request):process(result,count,request.httpRequest,request.type,data,aggregates,virtualRecords)},fnFail),ajax=new Ajax(req);if(ajax.beforeSend=()=>{this.beforeSend(ajax.httpRequest,ajax)},(req=ajax.send()).catch(e=>!0),this.requests.push(ajax),isSelector){let promise,res=query.subQuerySelector.call(this,{query:query.subQuery,parent:query});res&&res.length?(promise=Promise.all([req,fnQueryChild(null,res)])).then((...args)=>{let result=args[0],pResult=this.adaptor.processResponse(result[0],this,query,this.requests[0].httpRequest,this.requests[0]),count=0;query.isCountRequired&&(count=pResult.count,pResult=pResult.result);let cResult=this.adaptor.processResponse(result[1],this,query.subQuery,this.requests[1].httpRequest,this.requests[1]);count=0,query.subQuery.isCountRequired&&(count=cResult.count,cResult=cResult.result),ej2_data_es2015_DataUtil.buildHierarchy(query.subQuery.fKey,query.subQuery.fromTable,pResult,cResult,query.subQuery.key),isSelector=!1,process(pResult,count,this.requests[0].httpRequest)}):isSelector=!1}return req}beforeSend(request,settings){this.adaptor.beforeSend(this,request,settings);let props,headers=this.dataSource.headers;for(let i=0;headers&&i<headers.length;i++){props=[];let keys=Object.keys(headers[i]);for(let prop of keys)props.push(prop),request.setRequestHeader(prop,headers[i][prop])}}saveChanges(changes,key,tableName,query,original){tableName instanceof ej2_data_es2015_Query&&(query=tableName,tableName=null);let args={url:tableName,key:key||this.dataSource.key},req=this.adaptor.batchRequest(this,changes,args,query||new ej2_data_es2015_Query,original);if(this.dataSource.offline)return req;if(isNullOrUndefined(this.adaptor.doAjaxRequest)){let deff=new Deferred,ajax=new Ajax(req);return ajax.beforeSend=()=>{this.beforeSend(ajax.httpRequest,ajax)},ajax.onSuccess=(data,request)=>{deff.resolve(this.adaptor.processResponse(data,this,null,request.httpRequest,request,changes,args))},ajax.onFailure=e=>{deff.reject([{error:e}])},ajax.send().catch(e=>!0),deff.promise}return this.adaptor.doAjaxRequest(req)}insert(data,tableName,query,position){tableName instanceof ej2_data_es2015_Query&&(query=tableName,tableName=null);let req=this.adaptor.insert(this,data,tableName,query,position);return this.dataSource.offline?req:isNullOrUndefined(this.adaptor.doAjaxRequest)?this.doAjaxRequest(req):this.adaptor.doAjaxRequest(req)}remove(keyField,value,tableName,query){"object"==typeof value&&(value=value[keyField]),tableName instanceof ej2_data_es2015_Query&&(query=tableName,tableName=null);let res=this.adaptor.remove(this,keyField,value,tableName,query);return this.dataSource.offline?res:isNullOrUndefined(this.adaptor.doAjaxRequest)?this.doAjaxRequest(res):this.adaptor.doAjaxRequest(res)}update(keyField,value,tableName,query,original){tableName instanceof ej2_data_es2015_Query&&(query=tableName,tableName=null);let res=this.adaptor.update(this,keyField,value,tableName,query,original);return this.dataSource.offline?res:isNullOrUndefined(this.adaptor.doAjaxRequest)?this.doAjaxRequest(res):this.adaptor.doAjaxRequest(res)}doAjaxRequest(res){let defer=new Deferred;res=extend({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},res);let ajax=new Ajax(res);return ajax.beforeSend=()=>{this.beforeSend(ajax.httpRequest,ajax)},ajax.onSuccess=(record,request)=>{try{ej2_data_es2015_DataUtil.parse.parseJson(record)}catch(e){record=[]}record=this.adaptor.processResponse(ej2_data_es2015_DataUtil.parse.parseJson(record),this,null,request.httpRequest,request),defer.resolve(record)},ajax.onFailure=e=>{defer.reject([{error:e}])},ajax.send().catch(e=>!0),defer.promise}}class Deferred{constructor(){this.promise=new Promise((resolve,reject)=>{this.resolve=resolve,this.reject=reject}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}}function getModel(props,model){let obj=extend({},props);for(let prop of Object.keys(obj))model.indexOf(prop)<0&&deleteObject(obj,prop);return obj}let ej2_splitbuttons_es2015_Item=(()=>{class Item extends ChildProperty{}return __decorate([Property("")],Item.prototype,"iconCss",void 0),__decorate([Property("")],Item.prototype,"id",void 0),__decorate([Property(!1)],Item.prototype,"separator",void 0),__decorate([Property("")],Item.prototype,"text",void 0),__decorate([Property("")],Item.prototype,"url",void 0),Item})(),ej2_splitbuttons_es2015_DropDownButton=(()=>{let DropDownButton=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}preRender(){}getPersistData(){return this.addOnPersist([])}toggle(){this.canOpen()?this.openPopUp():this.closePopup()}render(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()}createPopup(){let div=this.createElement("div",{className:"e-dropdown-popup",id:this.element.id+"-popup"});document.body.appendChild(div),this.dropDown=new ej2_popups_es2015_Popup(div,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),"fixed"===this.dropDown.element.style.position&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),attributes(this.element,{"aria-haspopup":this.items.length||this.target?"true":"false","aria-expanded":"false","aria-owns":this.getPopUpElement().id,type:"button"}),this.cssClass&&addClass([div],this.cssClass.split(" "))}getTargetElement(){return"string"==typeof this.target?ej2_base_es2015_select(this.target):this.target}createItems(items){let span,item,li,eventArgs,showIcon=this.hasIcon(items,"iconCss"),ul=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}});for(let i=0;i<items.length;i++)li=this.createElement("li",{innerHTML:(item=items[i]).url?"":item.text,className:item.separator?"e-item e-separator":"e-item",attrs:{role:"menuItem",tabindex:"-1"},id:item.id?item.id:getUniqueID("e-"+this.getModuleName()+"-item")}),item.iconCss?(span=this.createElement("span",{className:"e-menu-icon "+item.iconCss}),li.insertBefore(span,li.childNodes[0])):showIcon&&!item.separator&&li.classList.add("e-blank-icon"),item.url&&li.appendChild(this.createAnchor(item)),this.trigger("beforeItemRender",eventArgs={item:item,element:li}),ul.appendChild(li);return ul}hasIcon(items,field){for(let i=0,len=items.length;i<len;i++)if(items[i][field])return!0;return!1}createAnchor(item){return this.createElement("a",{className:"e-menu-text e-menu-url",innerHTML:item.text,attrs:{href:item.url}})}initialize(){this.button=new ej2_buttons_es2015_Button({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=getUniqueID("e-"+this.getModuleName())),this.appendArrowSpan(),this.createPopup(),this.setActiveElem([this.element])}appendArrowSpan(){this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf("e-vertical")>-1?"bottom":"right")+" e-caret"}))}setActiveElem(elem){this.activeElem=elem}getModuleName(){return"dropdown-btn"}canOpen(){return this.getPopUpElement().classList.contains("e-popup-close")}destroy(){if(super.destroy(),"dropdown-btn"===this.getModuleName()){let attrList,classList$$1;this.element.querySelector("span.e-caret")&&detach(this.element.querySelector("span.e-caret")),this.cssClass&&(classList$$1=this.cssClass.split(" ")),this.button.destroy(),classList$$1&&removeClass([this.element],classList$$1),removeClass(this.activeElem,["e-active"]),(attrList=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"]).forEach(key=>{this.element.removeAttribute(key)}),this.dropDown.destroy();let popupEle=document.getElementById(this.getPopUpElement().id);popupEle&&(removeClass([popupEle],["e-popup-open","e-popup-close"]),detach(popupEle)),this.disabled||this.unWireEvents()}}getPopUpElement(){return this.dropDown.element}getULElement(){return this.getPopUpElement().children[0]}wireEvents(){let popupElement=this.getPopUpElement();this.delegateMousedownHandler=this.mousedownHandler.bind(this),EventHandler.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),EventHandler.add(this.element,"click",this.clickHandler,this),EventHandler.add(popupElement,"click",this.clickHandler,this),EventHandler.add(this.element,"keydown",this.keyBoardHandler,this),EventHandler.add(popupElement,"keydown",this.keyBoardHandler,this),this.rippleFn=rippleEffect(popupElement,{selector:".e-item"})}keyBoardHandler(e){if(e.target!==this.element||9!==e.keyCode&&(e.altKey||40!==e.keyCode)&&38!==e.keyCode)switch(e.keyCode){case 38:case 40:!e.altKey||38!==e.keyCode&&40!==e.keyCode?this.upDownKeyHandler(e):this.keyEventHandler(e);break;case 9:case 13:case 27:case 32:this.keyEventHandler(e)}}upDownKeyHandler(e){if(this.target&&(38===e.keyCode||40===e.keyCode))return;e.preventDefault();let ul=this.getULElement(),defaultIdx=40===e.keyCode?0:ul.childElementCount-1,liIdx=defaultIdx,li=null;this.removeCustomSelection();for(let i=0,len=ul.children.length;i<len;i++)ul.children[i].classList.contains("e-focused")&&(liIdx=i,(li=ul.children[i]).classList.remove("e-focused"),40===e.keyCode?liIdx++:liIdx--,liIdx===(40===e.keyCode?ul.childElementCount:-1)&&(liIdx=defaultIdx));-1!==(liIdx=this.isValidLI(li=ul.children[liIdx],liIdx,e.keyCode))&&(addClass([ul.children[liIdx]],"e-focused"),ul.children[liIdx].focus())}removeCustomSelection(){let selectedLi=this.getULElement().querySelector(".e-selected");selectedLi&&selectedLi.classList.remove("e-selected")}isValidLI(li,index,keyCode,count=0){if((li.classList.contains("e-separator")||li.classList.contains("e-disabled"))&&(index===(40===keyCode?this.items.length-1:0)?index=40===keyCode?0:this.items.length-1:40===keyCode?index++:index--),(li=this.getULElement().children[index]).classList.contains("e-separator")||li.classList.contains("e-disabled")){if(++count===this.items.length)return-1;index=this.isValidLI(li,index,keyCode,count)}return index}keyEventHandler(e){(!this.target||13!==e.keyCode&&9!==e.keyCode)&&(9!==e.keyCode&&e.preventDefault(),27===e.keyCode||38===e.keyCode||9===e.keyCode?this.canOpen()||this.closePopup(e,this.element):this.clickHandler(e))}getLI(elem){return"LI"===elem.tagName?elem:closest(elem,"li")}mousedownHandler(e){let trgt=e.target;this.canOpen()||closest(trgt,"#"+this.getPopUpElement().id)||closest(trgt,"#"+this.element.id)||this.closePopup(e)}clickHandler(e){let trgt=e.target,canOpen=this.canOpen();if(closest(trgt,"#"+this.element.id))canOpen?this.openPopUp(e):this.closePopup(e,this.activeElem[0]);else if(closest(trgt,"#"+this.getPopUpElement().id)){let eventArgs,liIdx,item,li=this.getLI(trgt);li&&(liIdx=Array.prototype.indexOf.call(this.getULElement().children,li),(item=this.items[liIdx])&&this.trigger("select",eventArgs={element:li,item:item}),this.closePopup(e,this.activeElem[0]))}}openPopUp(e=null){this.target||this.getPopUpElement().appendChild(this.createItems(this.items));let ul=this.getULElement();this.trigger("beforeOpen",{element:ul,items:this.items,event:e,cancel:!1},observedArgs=>{if(!observedArgs.cancel){let ul=this.getULElement();this.dropDown.show(null,this.element),addClass([this.element],"e-active"),this.element.setAttribute("aria-expanded","true"),ul.focus(),this.trigger("open",{element:ul,items:this.items})}})}closePopup(e=null,focusEle){let ul=this.getULElement();this.trigger("beforeClose",{element:ul,items:this.items,event:e,cancel:!1},observedArgs=>{if(!observedArgs.cancel){let ul=this.getULElement();this.removeCustomSelection(),this.dropDown.hide(),removeClass(this.activeElem,"e-active"),this.element.setAttribute("aria-expanded","false"),focusEle&&focusEle.focus(),this.trigger("close",{element:ul,items:this.items}),!this.target&&ul&&detach(ul)}})}unWireEvents(){EventHandler.remove(document,"mousedown touchstart",this.delegateMousedownHandler),EventHandler.remove(this.element,"click",this.clickHandler),EventHandler.remove(this.getPopUpElement(),"click",this.clickHandler),EventHandler.remove(this.element,"keydown",this.keyBoardHandler),EventHandler.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.rippleFn()}onPropertyChanged(newProp,oldProp){this.button.setProperties(getModel(newProp,["content","cssClass","iconCss","iconPosition","disabled","enableRtl"])),this.dropDown.setProperties(getModel(newProp,["enableRtl"]));let popupElement=this.getPopUpElement();for(let prop of Object.keys(newProp))switch(prop){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":newProp.disabled?(this.unWireEvents(),this.canOpen()||this.closePopup()):this.wireEvents();break;case"cssClass":newProp.cssClass.indexOf("e-vertical")>-1&&ej2_base_es2015_classList(this.element.querySelector("span.e-caret"),["e-icon-bottom"],["e-icon-right"]),oldProp.cssClass&&removeClass([popupElement],oldProp.cssClass.split(" ")),newProp.cssClass&&addClass([popupElement],newProp.cssClass.split(" "));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.dropDown.refresh(),popupElement.classList.contains("e-popup-open")&&ej2_base_es2015_classList(popupElement,["e-popup-close"],["e-popup-open"])}}focusIn(){this.element.focus()}};return __decorate([Property("")],DropDownButton.prototype,"content",void 0),__decorate([Property("")],DropDownButton.prototype,"cssClass",void 0),__decorate([Property(!1)],DropDownButton.prototype,"disabled",void 0),__decorate([Property("")],DropDownButton.prototype,"iconCss",void 0),__decorate([Property("Left")],DropDownButton.prototype,"iconPosition",void 0),__decorate([Collection([],ej2_splitbuttons_es2015_Item)],DropDownButton.prototype,"items",void 0),__decorate([Property("")],DropDownButton.prototype,"target",void 0),__decorate([ej2_base_es2015_Event()],DropDownButton.prototype,"beforeItemRender",void 0),__decorate([ej2_base_es2015_Event()],DropDownButton.prototype,"beforeOpen",void 0),__decorate([ej2_base_es2015_Event()],DropDownButton.prototype,"beforeClose",void 0),__decorate([ej2_base_es2015_Event()],DropDownButton.prototype,"close",void 0),__decorate([ej2_base_es2015_Event()],DropDownButton.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],DropDownButton.prototype,"select",void 0),__decorate([ej2_base_es2015_Event()],DropDownButton.prototype,"created",void 0),__decorate([NotifyPropertyChanges],DropDownButton)})();const TAGNAME="EJS-SPLITBUTTON";let ej2_splitbuttons_es2015_SplitButton=(()=>{let SplitButton=class extends ej2_splitbuttons_es2015_DropDownButton{constructor(options,element){super(options,element)}preRender(){let ele=this.element;if(ele.tagName===TAGNAME){let ejInstance=getValue("ej2_instances",ele),btn=this.createElement("button",{attrs:{type:"button"}}),wrapper=this.createElement(TAGNAME,{className:"e-"+this.getModuleName()+"-wrapper"});for(let idx=0,len=ele.attributes.length;idx<len;idx++)btn.setAttribute(ele.attributes[idx].nodeName,ele.attributes[idx].nodeValue);ele.parentNode.insertBefore(wrapper,ele),detach(ele),wrapper.appendChild(ele=btn),setValue("ej2_instances",ejInstance,ele),this.wrapper=wrapper,this.element=ele}this.element.id||(this.element.id=getUniqueID("e-"+this.getModuleName()))}render(){this.initWrapper(),this.createPrimaryButton(),this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents(),this.renderComplete()}initWrapper(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add("e-rtl"),this.cssClass&&addClass([this.wrapper],this.cssClass.split(" "))}createPrimaryButton(){this.primaryBtnObj=new ej2_buttons_es2015_Button({cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled}),this.primaryBtnObj.createElement=this.createElement,this.primaryBtnObj.appendTo(this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element)}createSecondaryButton(){let btnElem=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(btnElem);let dropDownBtnModel={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,beforeItemRender:args=>{this.trigger("beforeItemRender",args)},open:args=>{this.trigger("open",args)},close:args=>{this.trigger("close",args)},select:args=>{this.trigger("select",args)}};dropDownBtnModel.beforeOpen=args=>{let callBackPromise=new ej2_splitbuttons_es2015_Deferred;return this.trigger("beforeOpen",args,observedArgs=>{callBackPromise.resolve(observedArgs)}),callBackPromise},dropDownBtnModel.beforeClose=args=>{let callBackPromise=new ej2_splitbuttons_es2015_Deferred;return this.trigger("beforeClose",args,observedArgs=>{callBackPromise.resolve(observedArgs)}),callBackPromise},this.secondaryBtnObj=new ej2_splitbuttons_es2015_DropDownButton(dropDownBtnModel),this.secondaryBtnObj.createElement=this.createElement,this.secondaryBtnObj.appendTo(btnElem),this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown,this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],EventHandler.remove(this.getPopUpElement(),"keydown",this.secondaryBtnObj.keyBoardHandler),this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right")}setAria(){attributes(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent+" splitbutton","aria-owns":this.secondaryBtnObj.dropDown.element.id})}getModuleName(){return"split-btn"}toggle(){this.secondaryBtnObj.toggle()}destroy(){let classList$$1=["e-rtl"],element=document.getElementById(this.element.id);this.cssClass&&(classList$$1=classList$$1.concat(this.cssClass.split(" "))),element&&element.parentElement===this.wrapper&&(this.wrapper.tagName===TAGNAME?(this.wrapper.innerHTML="",removeClass([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),removeClass([this.wrapper],this.cssClass.split(" "))):(removeClass([this.element],classList$$1),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(key=>{this.element.removeAttribute(key)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),ej2_base_es2015_remove(this.wrapper)),this.unWireEvents()),this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy(),super.destroy(),this.element.getAttribute("class")||this.element.removeAttribute("class")}wireEvents(){EventHandler.add(this.element,"click",this.primaryBtnClickHandler,this),EventHandler.add(this.getPopUpElement(),"keydown",this.keyBoardHandler,this),new ej2_base_es2015_KeyboardEvents(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow"}})}unWireEvents(){EventHandler.remove(this.element,"click",this.primaryBtnClickHandler),getInstance(this.element,ej2_base_es2015_KeyboardEvents).destroy()}primaryBtnClickHandler(){this.trigger("click",{element:this.element})}btnKeyBoardHandler(e){switch(e.action){case"altdownarrow":this.clickHandler(e)}}onPropertyChanged(newProp,oldProp){let model=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"];this.primaryBtnObj.setProperties(getModel(newProp,model)),this.secondaryBtnObj.setProperties(getModel(newProp,model=["items","beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl"]));for(let prop of Object.keys(newProp))switch(prop){case"cssClass":oldProp.cssClass&&removeClass([this.wrapper],oldProp.cssClass.split(" ")),addClass([this.wrapper],newProp.cssClass.split(" "));break;case"enableRtl":newProp.enableRtl?addClass([this.wrapper],"e-rtl"):removeClass([this.wrapper],"e-rtl")}}focusIn(){this.element.focus()}};return __decorate([Property("")],SplitButton.prototype,"content",void 0),__decorate([Property("")],SplitButton.prototype,"cssClass",void 0),__decorate([Property(!1)],SplitButton.prototype,"disabled",void 0),__decorate([Property("")],SplitButton.prototype,"iconCss",void 0),__decorate([Property("Left")],SplitButton.prototype,"iconPosition",void 0),__decorate([Collection([],ej2_splitbuttons_es2015_Item)],SplitButton.prototype,"items",void 0),__decorate([Property("")],SplitButton.prototype,"target",void 0),__decorate([ej2_base_es2015_Event()],SplitButton.prototype,"beforeItemRender",void 0),__decorate([ej2_base_es2015_Event()],SplitButton.prototype,"beforeOpen",void 0),__decorate([ej2_base_es2015_Event()],SplitButton.prototype,"beforeClose",void 0),__decorate([ej2_base_es2015_Event()],SplitButton.prototype,"click",void 0),__decorate([ej2_base_es2015_Event()],SplitButton.prototype,"close",void 0),__decorate([ej2_base_es2015_Event()],SplitButton.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],SplitButton.prototype,"select",void 0),__decorate([ej2_base_es2015_Event()],SplitButton.prototype,"created",void 0),__decorate([NotifyPropertyChanges],SplitButton)})();class ej2_splitbuttons_es2015_Deferred{constructor(){this.promise=new Promise((resolve,reject)=>{this.resolve=resolve,this.reject=reject}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}}const ej2_inputs_es2015_CLASSNAMES={RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",TEXTAREA:"e-multi-line-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"};var ej2_inputs_es2015_Input;!function(Input){let floatType;function checkInputValue(floatLabelType,inputElement){let inputValue=inputElement.value;""===inputValue||isNullOrUndefined(inputValue)?"Always"!==floatLabelType&&inputElement.parentElement.classList.remove("e-valid-input"):inputElement.parentElement.classList.add("e-valid-input")}function _focusFn(){let label=getParentNode(this).getElementsByClassName("e-float-text")[0];addClass([label],ej2_inputs_es2015_CLASSNAMES.LABELTOP),label.classList.contains(ej2_inputs_es2015_CLASSNAMES.LABELBOTTOM)&&removeClass([label],ej2_inputs_es2015_CLASSNAMES.LABELBOTTOM)}function _blurFn(){let parent=getParentNode(this);if(parent.getElementsByTagName("textarea")[0]?""===parent.getElementsByTagName("textarea")[0].value:""===parent.getElementsByTagName("input")[0].value){let label=parent.getElementsByClassName("e-float-text")[0];label.classList.contains(ej2_inputs_es2015_CLASSNAMES.LABELTOP)&&removeClass([label],ej2_inputs_es2015_CLASSNAMES.LABELTOP),addClass([label],ej2_inputs_es2015_CLASSNAMES.LABELBOTTOM)}}function createFloatingInput(args,inputObject,internalCreateElement){let floatLinelement,floatLabelElement,makeElement=isNullOrUndefined(internalCreateElement)?ej2_base_es2015_createElement:internalCreateElement;var element;"Auto"===args.floatLabelType&&((element=args.element).addEventListener("focus",_focusFn),element.addEventListener("blur",_blurFn)),isNullOrUndefined(inputObject.container)?(inputObject.container=createInputContainer(args,ej2_inputs_es2015_CLASSNAMES.FLOATINPUT,ej2_inputs_es2015_CLASSNAMES.FLOATCUSTOMTAG,"div",makeElement),args.element.parentNode.insertBefore(inputObject.container,args.element)):(isNullOrUndefined(args.customTag)||inputObject.container.classList.add(ej2_inputs_es2015_CLASSNAMES.FLOATCUSTOMTAG),inputObject.container.classList.add(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)),floatLinelement=makeElement("span",{className:ej2_inputs_es2015_CLASSNAMES.FLOATLINE}),floatLabelElement=makeElement("label",{className:ej2_inputs_es2015_CLASSNAMES.FLOATTEXT}),isNullOrUndefined(args.element.id)||""===args.element.id||(floatLabelElement.id="label_"+args.element.id.replace(/ /g,"_"),attributes(args.element,{"aria-labelledby":floatLabelElement.id})),isNullOrUndefined(args.element.placeholder)||""===args.element.placeholder||(floatLabelElement.innerHTML=args.element.placeholder,args.element.removeAttribute("placeholder")),isNullOrUndefined(args.properties)||isNullOrUndefined(args.properties.placeholder)||""===args.properties.placeholder||(floatLabelElement.innerHTML=args.properties.placeholder),floatLabelElement.innerHTML||inputObject.container.classList.add(ej2_inputs_es2015_CLASSNAMES.NOFLOATLABEL),inputObject.container.appendChild(args.element),inputObject.container.appendChild(floatLinelement),inputObject.container.appendChild(floatLabelElement),updateLabelState(args.element.value,floatLabelElement),"Always"===args.floatLabelType&&(floatLabelElement.classList.contains(ej2_inputs_es2015_CLASSNAMES.LABELBOTTOM)&&removeClass([floatLabelElement],ej2_inputs_es2015_CLASSNAMES.LABELBOTTOM),addClass([floatLabelElement],ej2_inputs_es2015_CLASSNAMES.LABELTOP)),"Auto"===args.floatLabelType&&(args.element.addEventListener("input",event=>{updateLabelState(args.element.value,floatLabelElement)}),args.element.addEventListener("blur",event=>{updateLabelState(args.element.value,floatLabelElement)})),isNullOrUndefined(args.element.getAttribute("id"))||floatLabelElement.setAttribute("for",args.element.getAttribute("id"))}function checkFloatLabelType(type,container){"Always"===type&&container.classList.contains("e-outline")&&container.classList.add("e-valid-input")}function updateIconState(value,button){value?removeClass([button],ej2_inputs_es2015_CLASSNAMES.CLEARICONHIDE):addClass([button],ej2_inputs_es2015_CLASSNAMES.CLEARICONHIDE)}function updateLabelState(value,label){value?(addClass([label],ej2_inputs_es2015_CLASSNAMES.LABELTOP),label.classList.contains(ej2_inputs_es2015_CLASSNAMES.LABELBOTTOM)&&removeClass([label],ej2_inputs_es2015_CLASSNAMES.LABELBOTTOM)):(label.classList.contains(ej2_inputs_es2015_CLASSNAMES.LABELTOP)&&removeClass([label],ej2_inputs_es2015_CLASSNAMES.LABELTOP),addClass([label],ej2_inputs_es2015_CLASSNAMES.LABELBOTTOM))}function getParentNode(element){return element.parentNode}function validateLabel(element,floatLabelType){if(getParentNode(element).classList.contains(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)&&"Auto"===floatLabelType){let label=getParentNode(element).getElementsByClassName("e-float-text")[0];updateLabelState(element.value,label)}}function createInputContainer(args,className,tagClass,tag,internalCreateElement){let container,makeElement=isNullOrUndefined(internalCreateElement)?ej2_base_es2015_createElement:internalCreateElement;return isNullOrUndefined(args.customTag)?container=makeElement(tag,{className:className}):(container=makeElement(args.customTag,{className:className})).classList.add(tagClass),container.classList.add("e-control-wrapper"),container}function setCssClass(cssClass,elements,oldClass){isNullOrUndefined(oldClass)||""===oldClass||removeClass(elements,oldClass.split(" ")),isNullOrUndefined(cssClass)||""===cssClass||addClass(elements,cssClass.split(" "))}function setPlaceholder(placeholder,element){let parentElement;placeholder=function(placeholder){let result="";if(!isNullOrUndefined(placeholder)&&""!==placeholder){let spanEle=document.createElement("span");spanEle.innerHTML=placeholder,result=spanEle.innerHTML}return result}(placeholder),(parentElement=getParentNode(element)).classList.contains(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)?isNullOrUndefined(placeholder)||""===placeholder?(parentElement.classList.add(ej2_inputs_es2015_CLASSNAMES.NOFLOATLABEL),parentElement.getElementsByClassName(ej2_inputs_es2015_CLASSNAMES.FLOATTEXT)[0].textContent=""):(parentElement.getElementsByClassName(ej2_inputs_es2015_CLASSNAMES.FLOATTEXT)[0].textContent=placeholder,parentElement.classList.remove(ej2_inputs_es2015_CLASSNAMES.NOFLOATLABEL),element.removeAttribute("placeholder")):isNullOrUndefined(placeholder)||""===placeholder?(element.removeAttribute("placeholder"),element.removeAttribute("aria-placeholder")):attributes(element,{placeholder:placeholder,"aria-placeholder":placeholder})}function setReadonly(isReadonly,element,floatLabelType){isReadonly?attributes(element,{readonly:""}):element.removeAttribute("readonly"),isNullOrUndefined(floatLabelType)||validateLabel(element,floatLabelType)}function setEnableRtl(isRtl,elements){isRtl?addClass(elements,ej2_inputs_es2015_CLASSNAMES.RTL):removeClass(elements,ej2_inputs_es2015_CLASSNAMES.RTL)}function setEnabled(isEnable,element,floatLabelType,inputContainer){let disabledAttrs={disabled:"disabled","aria-disabled":"true"},considerWrapper=!isNullOrUndefined(inputContainer);isEnable?(element.classList.remove(ej2_inputs_es2015_CLASSNAMES.DISABLE),removeAttributes(disabledAttrs,element),considerWrapper&&removeClass([inputContainer],ej2_inputs_es2015_CLASSNAMES.DISABLE)):(element.classList.add(ej2_inputs_es2015_CLASSNAMES.DISABLE),addAttributes(disabledAttrs,element),considerWrapper&&addClass([inputContainer],ej2_inputs_es2015_CLASSNAMES.DISABLE)),isNullOrUndefined(floatLabelType)||validateLabel(element,floatLabelType)}function setClearButton(isClear,element,inputObject,initial,internalCreateElement){let makeElement=isNullOrUndefined(internalCreateElement)?ej2_base_es2015_createElement:internalCreateElement;isClear?inputObject.clearButton=function(element,inputObject,initial,internalCreateElement){let button=(isNullOrUndefined(internalCreateElement)?ej2_base_es2015_createElement:internalCreateElement)("span",{className:ej2_inputs_es2015_CLASSNAMES.CLEARICON}),container=inputObject.container;return isNullOrUndefined(initial)?(inputObject.container.classList.contains(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)?inputObject.container.querySelector("."+ej2_inputs_es2015_CLASSNAMES.FLOATTEXT):element).insertAdjacentElement("afterend",button):container.appendChild(button),!isNullOrUndefined(container)&&container.classList.contains(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)&&addClass([container],ej2_inputs_es2015_CLASSNAMES.INPUTGROUP),addClass([button],ej2_inputs_es2015_CLASSNAMES.CLEARICONHIDE),function(element,button,container){button.addEventListener("click",event=>{element.classList.contains(ej2_inputs_es2015_CLASSNAMES.DISABLE)||element.readOnly||(event.preventDefault(),element!==document.activeElement&&element.focus(),element.value="",addClass([button],ej2_inputs_es2015_CLASSNAMES.CLEARICONHIDE))}),element.addEventListener("input",event=>{updateIconState(element.value,button)}),element.addEventListener("focus",event=>{updateIconState(element.value,button)}),element.addEventListener("blur",event=>{setTimeout(()=>{addClass([button],ej2_inputs_es2015_CLASSNAMES.CLEARICONHIDE)},200)})}(element,button),button.setAttribute("aria-label","close"),button}(element,inputObject,initial,makeElement):(inputObject.clearButton.remove(),inputObject.clearButton=null)}function removeAttributes(attrs,element){for(let key of Object.keys(attrs)){let parentElement;parentElement=getParentNode(element),"disabled"===key&&element.classList.remove(ej2_inputs_es2015_CLASSNAMES.DISABLE),"disabled"===key&&parentElement.classList.contains(ej2_inputs_es2015_CLASSNAMES.INPUTGROUP)&&parentElement.classList.remove(ej2_inputs_es2015_CLASSNAMES.DISABLE),"placeholder"===key&&parentElement.classList.contains(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)?parentElement.getElementsByClassName(ej2_inputs_es2015_CLASSNAMES.FLOATTEXT)[0].textContent="":element.removeAttribute(key)}}function addAttributes(attrs,element){for(let key of Object.keys(attrs)){let parentElement;parentElement=getParentNode(element),"disabled"===key&&element.classList.add(ej2_inputs_es2015_CLASSNAMES.DISABLE),"disabled"===key&&parentElement.classList.contains(ej2_inputs_es2015_CLASSNAMES.INPUTGROUP)&&parentElement.classList.add(ej2_inputs_es2015_CLASSNAMES.DISABLE),"placeholder"===key&&parentElement.classList.contains(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)?parentElement.getElementsByClassName(ej2_inputs_es2015_CLASSNAMES.FLOATTEXT)[0].textContent=attrs[key]:element.setAttribute(key,attrs[key])}}function _internalRipple(isRipple,container,button){let argsButton=[];argsButton.push(button);let buttons=isNullOrUndefined(button)?container.querySelectorAll(".e-input-group-icon"):argsButton;if(isRipple&&buttons.length>0)for(let index=0;index<buttons.length;index++)buttons[index].addEventListener("mousedown",_onMouseDownRipple,!1),buttons[index].addEventListener("mouseup",_onMouseUpRipple,!1);else if(buttons.length>0)for(let index=0;index<buttons.length;index++)buttons[index].removeEventListener("mousedown",_onMouseDownRipple,this),buttons[index].removeEventListener("mouseup",_onMouseUpRipple,this)}function _onMouseDownRipple(){let parentEle=this.parentElement;for(;!parentEle.classList.contains("e-input-group");)parentEle=parentEle.parentElement;var container;(container=parentEle).classList.contains("e-disabled")||container.querySelector("input").readOnly||this.classList.add("e-input-btn-ripple")}function _onMouseUpRipple(){let ele=this;setTimeout(()=>{ele.classList.remove("e-input-btn-ripple")},500)}function appendSpan(iconClass,container,internalCreateElement){let button=(isNullOrUndefined(internalCreateElement)?ej2_base_es2015_createElement:internalCreateElement)("span",{className:iconClass});return button.classList.add("e-input-group-icon"),container.appendChild(button),container.classList.contains(ej2_inputs_es2015_CLASSNAMES.INPUTGROUP)||container.classList.add(ej2_inputs_es2015_CLASSNAMES.INPUTGROUP),_internalRipple(!0,container,button),button}Input.createInput=function(args,internalCreateElement){let makeElement=isNullOrUndefined(internalCreateElement)?ej2_base_es2015_createElement:internalCreateElement,inputObject={container:null,buttons:[],clearButton:null};if(floatType=args.floatLabelType,isNullOrUndefined(args.floatLabelType)||"Never"===args.floatLabelType?(inputObject.container=createInputContainer(args,ej2_inputs_es2015_CLASSNAMES.INPUTGROUP,ej2_inputs_es2015_CLASSNAMES.INPUTCUSTOMTAG,"span",makeElement),args.element.parentNode.insertBefore(inputObject.container,args.element),addClass([args.element],ej2_inputs_es2015_CLASSNAMES.INPUT),inputObject.container.appendChild(args.element)):createFloatingInput(args,inputObject,makeElement),checkInputValue(args.floatLabelType,args.element),args.element.addEventListener("focus",function(){let parent=getParentNode(this);(parent.classList.contains("e-input-group")||parent.classList.contains("e-outline")||parent.classList.contains("e-filled"))&&parent.classList.add("e-input-focus")}),args.element.addEventListener("blur",function(){let parent=getParentNode(this);(parent.classList.contains("e-input-group")||parent.classList.contains("e-outline")||parent.classList.contains("e-filled"))&&parent.classList.remove("e-input-focus")}),args.element.addEventListener("input",()=>{checkInputValue(floatType,args.element)}),isNullOrUndefined(args.properties)||isNullOrUndefined(args.properties.showClearButton)||!args.properties.showClearButton||"TEXTAREA"===args.element.tagName||(setClearButton(args.properties.showClearButton,args.element,inputObject,!0,makeElement),inputObject.clearButton.setAttribute("role","button"),inputObject.container.classList.contains(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)&&addClass([inputObject.container],ej2_inputs_es2015_CLASSNAMES.INPUTGROUP)),!isNullOrUndefined(args.buttons)&&"TEXTAREA"!==args.element.tagName)for(let i=0;i<args.buttons.length;i++)inputObject.buttons.push(appendSpan(args.buttons[i],inputObject.container,makeElement));return isNullOrUndefined(args.element)||"TEXTAREA"!==args.element.tagName||addClass([inputObject.container],ej2_inputs_es2015_CLASSNAMES.TEXTAREA),function(args,inputObject){if(!isNullOrUndefined(args.properties))for(let prop of Object.keys(args.properties))switch(prop){case"cssClass":setCssClass(args.properties.cssClass,[inputObject.container]),checkFloatLabelType(args.floatLabelType,inputObject.container);break;case"enabled":setEnabled(args.properties.enabled,args.element,args.floatLabelType,inputObject.container);break;case"enableRtl":setEnableRtl(args.properties.enableRtl,[inputObject.container]);break;case"placeholder":setPlaceholder(args.properties.placeholder,args.element);break;case"readonly":setReadonly(args.properties.readonly,args.element)}return inputObject}(args,inputObject)},Input.setValue=function(value,element,floatLabelType,clearButton){if(element.value=value,isNullOrUndefined(floatLabelType)||"Auto"!==floatLabelType||validateLabel(element,floatLabelType),!isNullOrUndefined(clearButton)&&clearButton){let parentElement=getParentNode(element);if(!isNullOrUndefined(parentElement)){let button=parentElement.getElementsByClassName(ej2_inputs_es2015_CLASSNAMES.CLEARICON)[0];element.value&&parentElement.classList.contains("e-input-focus")?removeClass([button],ej2_inputs_es2015_CLASSNAMES.CLEARICONHIDE):addClass([button],ej2_inputs_es2015_CLASSNAMES.CLEARICONHIDE)}}checkInputValue(floatLabelType,element)},Input.setCssClass=setCssClass,Input.setPlaceholder=setPlaceholder,Input.setReadonly=setReadonly,Input.setEnableRtl=setEnableRtl,Input.setEnabled=setEnabled,Input.setClearButton=setClearButton,Input.removeAttributes=removeAttributes,Input.addAttributes=addAttributes,Input.removeFloating=function(input){let container=input.container;if(!isNullOrUndefined(container)&&container.classList.contains(ej2_inputs_es2015_CLASSNAMES.FLOATINPUT)){let inputEle=container.querySelector("textarea")?container.querySelector("textarea"):container.querySelector("input"),placeholder=container.querySelector("."+ej2_inputs_es2015_CLASSNAMES.FLOATTEXT).textContent,clearButton=null!==container.querySelector(".e-clear-icon");detach(container.querySelector("."+ej2_inputs_es2015_CLASSNAMES.FLOATLINE)),detach(container.querySelector("."+ej2_inputs_es2015_CLASSNAMES.FLOATTEXT)),ej2_base_es2015_classList(container,[ej2_inputs_es2015_CLASSNAMES.INPUTGROUP],[ej2_inputs_es2015_CLASSNAMES.FLOATINPUT]),(element=inputEle).removeEventListener("focus",_focusFn),element.removeEventListener("blur",_blurFn),attributes(inputEle,{placeholder:placeholder}),inputEle.classList.add(ej2_inputs_es2015_CLASSNAMES.INPUT),clearButton||"INPUT"!==inputEle.tagName||inputEle.removeAttribute("required")}var element},Input.addFloating=function(input,type,placeholder,internalCreateElement){let makeElement=isNullOrUndefined(internalCreateElement)?ej2_base_es2015_createElement:internalCreateElement,container=closest(input,"."+ej2_inputs_es2015_CLASSNAMES.INPUTGROUP);if(floatType=type,"Never"!==type){let customTag=container.tagName,args={element:input,floatLabelType:type,customTag:customTag="DIV"!==customTag&&"SPAN"!==customTag?customTag:null,properties:{placeholder:placeholder}},iconEle=container.querySelector(".e-clear-icon"),inputObj={container:container};if(input.classList.remove(ej2_inputs_es2015_CLASSNAMES.INPUT),createFloatingInput(args,inputObj,makeElement),isNullOrUndefined(iconEle)&&(iconEle=container.querySelector(".e-input-group-icon")),isNullOrUndefined(iconEle))container.classList.remove(ej2_inputs_es2015_CLASSNAMES.INPUTGROUP);else{let floatLine=container.querySelector("."+ej2_inputs_es2015_CLASSNAMES.FLOATLINE),floatText=container.querySelector("."+ej2_inputs_es2015_CLASSNAMES.FLOATTEXT);container.insertBefore(input,iconEle),container.insertBefore(floatLine,iconEle),container.insertBefore(floatText,iconEle)}}checkFloatLabelType(type,input.parentElement)},Input.setRipple=function(isRipple,inputObj){for(let i=0;i<inputObj.length;i++)_internalRipple(isRipple,inputObj[i].container)},Input.appendSpan=appendSpan}(ej2_inputs_es2015_Input||(ej2_inputs_es2015_Input={}));const SPINICON="e-input-group-icon",INTREGEXP=new RegExp("^(-)?(\\d*)$"),wrapperAttributes=["title","style","class"];let ej2_inputs_es2015_NumericTextBox=(()=>{let NumericTextBox=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.numericOptions=options}preRender(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;let ejInstance=getValue("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),removeClass([this.cloneElement],["e-control","e-numerictextbox","e-lib"]),this.angularTagName=null,this.formEle=closest(this.element,"form"),"EJS-NUMERICTEXTBOX"===this.element.tagName){this.angularTagName=this.element.tagName;let input=this.createElement("input"),index=0;for(;index<this.element.attributes.length;index++)"id"!==this.element.attributes[index].nodeName&&(input.setAttribute(this.element.attributes[index].nodeName,this.element.attributes[index].nodeValue),input.innerHTML=this.element.innerHTML);this.element.hasAttribute("name")&&this.element.removeAttribute("name"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(input),this.element=input,setValue("ej2_instances",ejInstance,this.element)}attributes(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off","aria-live":"assertive"}),this.l10n=new L10n("numerictextbox",{incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:this.placeholder},this.locale),""!==this.l10n.getConstant("placeholder")&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.updateHTMLAttrToElement(),this.checkAttributes(!1),this.prevValue=this.value,this.formEle&&(this.inputEleValue=this.value),this.validateMinMax(),this.validateStep(),null===this.placeholder&&this.updatePlaceholder()}render(){"input"===this.element.tagName.toLowerCase()&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),isNullOrUndefined(this.width)||setStyleAttribute(this.container,{width:formatUnit(this.width)}),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(null===this.value||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),null===this.value||isNaN(this.value)||this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0),(this.element.getAttribute("value")||this.value)&&this.element.setAttribute("value",this.element.value),this.renderComplete())}checkAttributes(isDynamic){let attributes$$1=isDynamic?isNullOrUndefined(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","step","disabled","readonly","style","name","placeholder"];for(let prop of attributes$$1)if(!isNullOrUndefined(this.element.getAttribute(prop)))switch(prop){case"disabled":if(isNullOrUndefined(this.numericOptions)||void 0===this.numericOptions.enabled||isDynamic){let enabled="disabled"!==this.element.getAttribute(prop)&&""!==this.element.getAttribute(prop)&&"true"!==this.element.getAttribute(prop);this.setProperties({enabled:enabled},!isDynamic)}break;case"readonly":if(isNullOrUndefined(this.numericOptions)||void 0===this.numericOptions.readonly||isDynamic){let readonly="readonly"===this.element.getAttribute(prop)||""===this.element.getAttribute(prop)||"true"===this.element.getAttribute(prop);this.setProperties({readonly:readonly},!isDynamic)}break;case"placeholder":(isNullOrUndefined(this.numericOptions)||void 0===this.numericOptions.placeholder||isDynamic)&&this.setProperties({placeholder:this.element.placeholder},!isDynamic);break;case"value":if(isNullOrUndefined(this.numericOptions)||void 0===this.numericOptions.value||isDynamic){let setNumber=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(prop));this.setProperties(setValue(prop,setNumber,{}),!isDynamic)}break;case"min":if(isNullOrUndefined(this.numericOptions)||void 0===this.numericOptions.min||isDynamic){let minValue=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(prop));null===minValue||isNaN(minValue)||this.setProperties(setValue(prop,minValue,{}),!isDynamic)}break;case"max":if(isNullOrUndefined(this.numericOptions)||void 0===this.numericOptions.max||isDynamic){let maxValue=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(prop));null===maxValue||isNaN(maxValue)||this.setProperties(setValue(prop,maxValue,{}),!isDynamic)}break;case"step":if(isNullOrUndefined(this.numericOptions)||void 0===this.numericOptions.step||isDynamic){let stepValue=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(prop));null===stepValue||isNaN(stepValue)||this.setProperties(setValue(prop,stepValue,{}),!isDynamic)}break;case"style":this.inputStyle=this.element.getAttribute(prop);break;case"name":this.inputName=this.element.getAttribute(prop);break;default:let value=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(prop));(null!==value&&!isNaN(value)||"value"===prop)&&this.setProperties(setValue(prop,value,{}),!0)}}updatePlaceholder(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)}initCultureFunc(){this.instance=new Internationalization(this.locale)}initCultureInfo(){this.cultureInfo.format=this.format,null!==getValue("currency",this)&&(setValue("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))}createWrapper(){let inputObj=ej2_inputs_es2015_Input.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:this.cssClass,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}},this.createElement);this.inputWrapper=inputObj,this.container=inputObj.container,this.container.setAttribute("class","e-control-wrapper e-numeric "+this.container.getAttribute("class")),this.updateHTMLAttrToWrapper(),this.readonly&&attributes(this.element,{"aria-readonly":"true"}),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",validateHidden:"true"}}),this.inputName=null!==this.inputName?this.inputName:this.element.id,this.element.removeAttribute("name"),attributes(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),null!==this.inputStyle&&attributes(this.container,{style:this.inputStyle})}updateHTMLAttrToElement(){if(!isNullOrUndefined(this.htmlAttributes))for(let pro of Object.keys(this.htmlAttributes))wrapperAttributes.indexOf(pro)<0&&this.element.setAttribute(pro,this.htmlAttributes[pro])}updateHTMLAttrToWrapper(){if(!isNullOrUndefined(this.htmlAttributes))for(let pro of Object.keys(this.htmlAttributes))if(wrapperAttributes.indexOf(pro)>-1)if("class"===pro)addClass([this.container],this.htmlAttributes[pro].split(" "));else if("style"===pro){let numericStyle=this.container.getAttribute(pro);numericStyle=isNullOrUndefined(numericStyle)?this.htmlAttributes[pro]:numericStyle+this.htmlAttributes[pro],this.container.setAttribute(pro,numericStyle)}else this.container.setAttribute(pro,this.htmlAttributes[pro])}spinBtnCreation(){this.spinDown=ej2_inputs_es2015_Input.appendSpan(SPINICON+" e-spin-down",this.container,this.createElement),attributes(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),this.spinUp=ej2_inputs_es2015_Input.appendSpan(SPINICON+" e-spin-up",this.container,this.createElement),attributes(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()}validateMinMax(){("number"!=typeof this.min||isNaN(this.min))&&this.setProperties({min:-Number.MAX_VALUE},!0),("number"!=typeof this.max||isNaN(this.max))&&this.setProperties({max:Number.MAX_VALUE},!0),null!==this.decimals&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),attributes(this.element,{"aria-valuemin":this.min.toString(),"aria-valuemax":this.max.toString()})}formattedValue(decimals,value){return this.instance.getNumberFormat({maximumFractionDigits:decimals,minimumFractionDigits:decimals,useGrouping:!1})(value)}validateStep(){null!==this.decimals&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)}action(operation,event){this.isInteract=!0;let value=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(value,this.step,operation)),this.raiseChangeEvent(event)}checkErrorClass(){this.isValidState?removeClass([this.container],"e-error"):addClass([this.container],"e-error"),attributes(this.element,{"aria-invalid":this.isValidState?"false":"true"})}bindClearEvent(){this.showClearButton&&EventHandler.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)}resetHandler(e){e.preventDefault(),this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.clear(e),this.isInteract=!0,this.raiseChangeEvent(e)}clear(event){this.setProperties({value:null},!0),this.setElementValue("")}resetFormHandler(){this.updateValue("EJS-NUMERICTEXTBOX"===this.element.tagName?null:this.inputEleValue)}setSpinButton(){isNullOrUndefined(this.spinDown)||attributes(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),isNullOrUndefined(this.spinUp)||attributes(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")})}wireEvents(){EventHandler.add(this.element,"focus",this.focusHandler,this),EventHandler.add(this.element,"blur",this.focusOutHandler,this),EventHandler.add(this.element,"keydown",this.keyDownHandler,this),EventHandler.add(this.element,"keyup",this.keyUpHandler,this),EventHandler.add(this.element,"input",this.inputHandler,this),EventHandler.add(this.element,"keypress",this.keyPressHandler,this),EventHandler.add(this.element,"change",this.changeHandler,this),EventHandler.add(this.element,"paste",this.pasteHandler,this),this.enabled&&(this.bindClearEvent(),this.formEle&&EventHandler.add(this.formEle,"reset",this.resetFormHandler,this))}wireSpinBtnEvents(){EventHandler.add(this.spinUp,Browser.touchStartEvent,this.mouseDownOnSpinner,this),EventHandler.add(this.spinDown,Browser.touchStartEvent,this.mouseDownOnSpinner,this),EventHandler.add(this.spinUp,Browser.touchEndEvent,this.mouseUpOnSpinner,this),EventHandler.add(this.spinDown,Browser.touchEndEvent,this.mouseUpOnSpinner,this),EventHandler.add(this.spinUp,Browser.touchMoveEvent,this.touchMoveOnSpinner,this),EventHandler.add(this.spinDown,Browser.touchMoveEvent,this.touchMoveOnSpinner,this)}unwireEvents(){EventHandler.remove(this.element,"focus",this.focusHandler),EventHandler.remove(this.element,"blur",this.focusOutHandler),EventHandler.remove(this.element,"keyup",this.keyUpHandler),EventHandler.remove(this.element,"input",this.inputHandler),EventHandler.remove(this.element,"keydown",this.keyDownHandler),EventHandler.remove(this.element,"keypress",this.keyPressHandler),EventHandler.remove(this.element,"change",this.changeHandler),EventHandler.remove(this.element,"paste",this.pasteHandler),this.formEle&&EventHandler.remove(this.formEle,"reset",this.resetFormHandler)}unwireSpinBtnEvents(){EventHandler.remove(this.spinUp,Browser.touchStartEvent,this.mouseDownOnSpinner),EventHandler.remove(this.spinDown,Browser.touchStartEvent,this.mouseDownOnSpinner),EventHandler.remove(this.spinUp,Browser.touchEndEvent,this.mouseUpOnSpinner),EventHandler.remove(this.spinDown,Browser.touchEndEvent,this.mouseUpOnSpinner),EventHandler.remove(this.spinUp,Browser.touchMoveEvent,this.touchMoveOnSpinner),EventHandler.remove(this.spinDown,Browser.touchMoveEvent,this.touchMoveOnSpinner)}changeHandler(event){event.stopPropagation(),this.element.value.length||this.setProperties({value:null},!0);let parsedInput=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(parsedInput,event)}raiseChangeEvent(event){if(this.prevValue!==this.value){let eventArgs={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteracted:this.isInteract,isInteraction:this.isInteract,event:event},event&&(this.changeEventArgs.event=event),void 0===this.changeEventArgs.event&&(this.changeEventArgs.isInteracted=!1,this.changeEventArgs.isInteraction=!1),ej2_base_es2015_merge(eventArgs,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.trigger("change",eventArgs)}}pasteHandler(){if(!this.enabled||this.readonly)return;let beforeUpdate=this.element.value;setTimeout(()=>{this.numericRegex().test(this.element.value)||this.setElementValue(beforeUpdate)})}preventHandler(){let iOS=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(()=>{if(this.element.selectionStart>0){let ignoreKeyCode,currentPos=this.element.selectionStart,prevPos=this.element.selectionStart-1,start=0,valArray=this.element.value.split("");ignoreKeyCode=getValue("decimal",getNumericObject(this.locale)).charCodeAt(0)," "===this.element.value[prevPos]&&this.element.selectionStart>0&&!iOS?(isNullOrUndefined(this.prevVal)?this.element.value=this.element.value.trim():0!==prevPos?this.element.value=this.prevVal:0===prevPos&&(this.element.value=this.element.value.trim()),this.element.setSelectionRange(prevPos,prevPos)):isNaN(parseFloat(this.element.value[this.element.selectionStart-1]))&&45!==this.element.value[this.element.selectionStart-1].charCodeAt(0)?(valArray.indexOf(this.element.value[this.element.selectionStart-1])!==valArray.lastIndexOf(this.element.value[this.element.selectionStart-1])&&this.element.value[this.element.selectionStart-1].charCodeAt(0)===ignoreKeyCode||this.element.value[this.element.selectionStart-1].charCodeAt(0)!==ignoreKeyCode)&&(this.element.value=this.element.value.substring(0,prevPos)+this.element.value.substring(currentPos,this.element.value.length),this.element.setSelectionRange(prevPos,prevPos),isNaN(parseFloat(this.element.value[this.element.selectionStart-1]))&&this.element.selectionStart>0&&this.element.value.length&&this.preventHandler()):isNaN(parseFloat(this.element.value[this.element.selectionStart-2]))&&this.element.selectionStart>1&&45!==this.element.value[this.element.selectionStart-2].charCodeAt(0)&&(valArray.indexOf(this.element.value[this.element.selectionStart-2])!==valArray.lastIndexOf(this.element.value[this.element.selectionStart-2])&&this.element.value[this.element.selectionStart-2].charCodeAt(0)===ignoreKeyCode||this.element.value[this.element.selectionStart-2].charCodeAt(0)!==ignoreKeyCode)&&(this.element.setSelectionRange(prevPos,prevPos),this.nextEle=this.element.value[this.element.selectionStart],this.cursorPosChanged=!0,this.preventHandler()),!0===this.cursorPosChanged&&this.element.value[this.element.selectionStart]===this.nextEle&&isNaN(parseFloat(this.element.value[this.element.selectionStart-1]))&&(this.element.setSelectionRange(this.element.selectionStart+1,this.element.selectionStart+1),this.cursorPosChanged=!1,this.nextEle=null),""===this.element.value.trim()&&this.element.setSelectionRange(start,start),this.element.selectionStart>0&&45===this.element.value[this.element.selectionStart-1].charCodeAt(0)&&this.element.selectionStart>1&&(this.element.value=isNullOrUndefined(this.prevVal)?this.element.value:this.prevVal,this.element.setSelectionRange(this.element.selectionStart,this.element.selectionStart)),this.prevVal=this.element.value}})}keyUpHandler(event){if(!this.enabled||this.readonly)return;(!navigator.platform||!/iPad|iPhone|iPod/.test(navigator.platform))&&Browser.isDevice&&this.preventHandler();let parseValue=this.instance.getNumberParser({format:"n"})(this.element.value);if(parseValue=null===parseValue||isNaN(parseValue)?null:parseValue,this.hiddenInput.value=parseValue||0===parseValue?parseValue.toString():null,closest(this.element,"form")){let element=this.element.nextElementSibling,keyupEvent=document.createEvent("KeyboardEvent");keyupEvent.initEvent("keyup",!1,!0),element.dispatchEvent(keyupEvent)}}inputHandler(event){if(!this.enabled||this.readonly)return;let iOS=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);(navigator.userAgent.toLowerCase().indexOf("firefox")>-1||iOS)&&Browser.isDevice&&this.preventHandler()}keyDownHandler(event){if(!this.readonly)switch(event.keyCode){case 38:event.preventDefault(),this.action("increment",event);break;case 40:event.preventDefault(),this.action("decrement",event)}}performAction(value,step,operation){(null===value||isNaN(value))&&(value=0);let updatedValue="increment"===operation?value+step:value-step;return updatedValue=this.correctRounding(value,step,updatedValue),this.strictMode?this.trimValue(updatedValue):updatedValue}correctRounding(value,step,result){let floatExp=new RegExp("[,.](.*)"),floatValue=(value.toString(),step.toString(),floatExp.test(value.toString())),floatStep=floatExp.test(step.toString());if(floatValue||floatStep){let valueCount=floatValue?floatExp.exec(value.toString())[0].length:0,stepCount=floatStep?floatExp.exec(step.toString())[0].length:0,max=Math.max(valueCount,stepCount);return this.roundValue(result,max)}return result}roundValue(result,precision){precision=precision||0;let divide=Math.pow(10,precision);return Math.round(result*=divide)/divide}updateValue(value,event){event&&(this.isInteract=!0),null===value||isNaN(value)||this.decimals&&(value=this.roundNumber(value,this.decimals)),this.changeValue(null===value||isNaN(value)?null:this.strictMode?this.trimValue(value):value),this.raiseChangeEvent(event)}updateCurrency(prop,propVal){setValue(prop,propVal,this.cultureInfo),this.updateValue(this.value)}changeValue(value){if(value||0===value){let numberOfDecimals,decimalPart=value.toString().split(".")[1];numberOfDecimals=decimalPart&&decimalPart.length?decimalPart.length:0,null!==this.decimals&&(numberOfDecimals=numberOfDecimals<this.decimals?numberOfDecimals:this.decimals),this.setProperties({value:this.roundNumber(value,numberOfDecimals)},!0)}else this.setProperties({value:value=null},!0);this.modifyText(),this.strictMode||this.validateState()}modifyText(){if(this.value||0===this.value){let value=this.formatNumber(),elementValue=this.isFocused?value:this.instance.getNumberFormat(this.cultureInfo)(this.value);this.setElementValue(elementValue),attributes(this.element,{"aria-valuenow":value}),this.hiddenInput.value=this.value.toString()}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null}setElementValue(val,element){ej2_inputs_es2015_Input.setValue(val,element||this.element,this.floatLabelType,this.showClearButton)}validateState(){this.isValidState=!0,(this.value||0===this.value)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()}formatNumber(){let numberOfDecimals,decimalPart=this.value.toString().split(".")[1];return numberOfDecimals=decimalPart&&decimalPart.length?decimalPart.length:0,null!==this.decimals&&(numberOfDecimals=numberOfDecimals<this.decimals?numberOfDecimals:this.decimals),this.instance.getNumberFormat({maximumFractionDigits:numberOfDecimals,minimumFractionDigits:numberOfDecimals,useGrouping:!1})(this.value)}trimValue(value){return value>this.max?this.max:value<this.min?this.min:value}roundNumber(value,precision){let result=value,decimals=precision||0,result1=result.toString().split("e"),result2=(result=Math.round(Number(result1[0]+"e"+(result1[1]?Number(result1[1])+decimals:decimals)))).toString().split("e");return result=Number(result2[0]+"e"+(result2[1]?Number(result2[1])-decimals:-decimals)),Number(result.toFixed(decimals))}cancelEvent(event){return event.preventDefault(),!1}keyPressHandler(event){if(!this.enabled||this.readonly)return!0;if(!Browser.isDevice&&"11.0"===Browser.info.version&&13===event.keyCode){let parsedInput=this.instance.getNumberParser({format:"n"})(this.element.value);return this.updateValue(parsedInput,event),!0}if(0===event.which||event.metaKey||event.ctrlKey||8===event.keyCode||13===event.keyCode)return!0;let currentChar=String.fromCharCode(event.which),text=this.element.value;return text=text.substring(0,this.element.selectionStart)+currentChar+text.substring(this.element.selectionEnd),!!this.numericRegex().test(text)||(event.preventDefault(),event.stopPropagation(),!1)}numericRegex(){let decimalSeparator=getValue("decimal",getNumericObject(this.locale)),fractionRule="*";return"."===decimalSeparator&&(decimalSeparator="\\"+decimalSeparator),0===this.decimals&&this.validateDecimalOnType?INTREGEXP:(this.decimals&&this.validateDecimalOnType&&(fractionRule="{0,"+this.decimals+"}"),new RegExp("^(-)?(((\\d+("+decimalSeparator+"\\d"+fractionRule+")?)|("+decimalSeparator+"\\d"+fractionRule+")))?$"))}mouseWheel(event){let delta;event.preventDefault(),event.wheelDelta?delta=event.wheelDelta/120:event.detail&&(delta=-event.detail/3),delta>0?this.action("increment",event):delta<0&&this.action("decrement",event),this.cancelEvent(event)}focusHandler(event){if(this.focusEventArgs={event:event,value:this.value,container:this.container},this.trigger("focus",this.focusEventArgs),this.enabled&&!this.readonly){if(this.isFocused=!0,removeClass([this.container],"e-error"),this.prevValue=this.value,this.value||0===this.value){let formatValue=this.formatNumber();this.setElementValue(formatValue),this.isPrevFocused||(Browser.isDevice||"11.0"!==Browser.info.version?setTimeout(()=>{this.element.setSelectionRange(0,formatValue.length)},Browser.isDevice&&Browser.isIos?600:0):this.element.setSelectionRange(0,formatValue.length))}Browser.isDevice||EventHandler.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}}focusOutHandler(event){if(this.blurEventArgs={event:event,value:this.value,container:this.container},this.trigger("blur",this.blurEventArgs),this.enabled&&!this.readonly){if(this.isPrevFocused){if(event.preventDefault(),Browser.isDevice){let value=this.element.value;this.element.focus(),this.isPrevFocused=!1;let ele=this.element;setTimeout(()=>{this.setElementValue(value,ele)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);let parsedInput=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(parsedInput),Browser.isDevice||EventHandler.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}if(closest(this.element,"form")){let element=this.element.nextElementSibling,focusEvent=document.createEvent("FocusEvent");focusEvent.initEvent("focusout",!1,!0),element.dispatchEvent(focusEvent)}}}mouseDownOnSpinner(event){if(this.isFocused&&(this.isPrevFocused=!0,event.preventDefault()),!this.getElementData(event))return;this.getElementData(event);let target=event.currentTarget,action=target.classList.contains("e-spin-up")?"increment":"decrement";EventHandler.add(target,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(()=>{this.isCalled=!0,this.action(action,event)},150),EventHandler.add(document,"mouseup",this.mouseUpClick,this)}touchMoveOnSpinner(event){document.elementFromPoint(event.clientX,event.clientY).classList.contains(SPINICON)||clearInterval(this.timeOut)}mouseUpOnSpinner(event){if(this.isPrevFocused&&(this.element.focus(),Browser.isDevice||(this.isPrevFocused=!1)),Browser.isDevice||event.preventDefault(),!this.getElementData(event))return;let target=event.currentTarget,action=target.classList.contains("e-spin-up")?"increment":"decrement";if(EventHandler.remove(target,"mouseleave",this.mouseUpClick),this.isCalled||this.action(action,event),this.isCalled=!1,EventHandler.remove(document,"mouseup",this.mouseUpClick),closest(this.element,"form")){let element=this.element.nextElementSibling,keyupEvent=document.createEvent("KeyboardEvent");keyupEvent.initEvent("keyup",!1,!0),element.dispatchEvent(keyupEvent)}}getElementData(event){return!(event.which&&3===event.which||event.button&&2===event.button||!this.enabled||this.readonly||(clearInterval(this.timeOut),0))}floatLabelTypeUpdate(){ej2_inputs_es2015_Input.removeFloating(this.inputWrapper);let hiddenInput=this.hiddenInput;this.hiddenInput.remove(),ej2_inputs_es2015_Input.addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement),this.container.insertBefore(hiddenInput,this.container.childNodes[1])}mouseUpClick(event){event.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,EventHandler.remove(this.spinUp,"mouseleave",this.mouseUpClick),EventHandler.remove(this.spinDown,"mouseleave",this.mouseUpClick)}increment(step=this.step){this.isInteract=!1,this.changeValue(this.performAction(this.value,step,"increment")),this.raiseChangeEvent()}decrement(step=this.step){this.isInteract=!1,this.changeValue(this.performAction(this.value,step,"decrement")),this.raiseChangeEvent()}destroy(){this.unwireEvents(),detach(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),detach(this.spinUp),detach(this.spinDown)),["aria-labelledby","role","autocomplete","aria-readonly","autocorrect","aria-disabled","aria-placeholder","autocapitalize","spellcheck","aria-autocomplete","tabindex","aria-valuemin","aria-valuemax","aria-live","aria-valuenow","aria-invalid"].forEach(value=>{this.element.removeAttribute(value)}),this.element.classList.remove("e-input"),this.container.insertAdjacentElement("afterend",this.element),detach(this.container),super.destroy()}getText(){return this.element.value}focusIn(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),addClass([this.container],["e-input-focus"]))}focusOut(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),removeClass([this.container],["e-input-focus"]))}getPersistData(){return this.addOnPersist(["value"])}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"width":setStyleAttribute(this.container,{width:formatUnit(newProp.width)});break;case"cssClass":ej2_inputs_es2015_Input.setCssClass(newProp.cssClass,[this.container],oldProp.cssClass);break;case"enabled":ej2_inputs_es2015_Input.setEnabled(newProp.enabled,this.element);break;case"enableRtl":ej2_inputs_es2015_Input.setEnableRtl(newProp.enableRtl,[this.container]);break;case"readonly":ej2_inputs_es2015_Input.setReadonly(newProp.readonly,this.element),this.readonly?attributes(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkAttributes(!0);break;case"placeholder":ej2_inputs_es2015_Input.setPlaceholder(newProp.placeholder,this.element);break;case"step":this.step=newProp.step,this.validateStep();break;case"showSpinButton":newProp.showSpinButton?this.spinBtnCreation():(detach(this.spinUp),detach(this.spinDown));break;case"showClearButton":ej2_inputs_es2015_Input.setClearButton(newProp.showClearButton,this.element,this.inputWrapper,void 0,this.createElement),this.bindClearEvent();break;case"floatLabelType":this.floatLabelType=newProp.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.updateValue(newProp.value);break;case"min":case"max":setValue(prop,getValue(prop,newProp),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=newProp.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),this.setSpinButton(),this.updatePlaceholder(),ej2_inputs_es2015_Input.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":let propVal=getValue(prop,newProp);this.setProperties({currencyCode:propVal},!0),this.updateCurrency(prop,propVal);break;case"currencyCode":let propValue=getValue(prop,newProp);this.setProperties({currency:propValue},!0),this.updateCurrency("currency",propValue);break;case"format":setValue(prop,getValue(prop,newProp),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=newProp.decimals,this.updateValue(this.value)}}getModuleName(){return"numerictextbox"}};return __decorate([Property("")],NumericTextBox.prototype,"cssClass",void 0),__decorate([Property(null)],NumericTextBox.prototype,"value",void 0),__decorate([Property(-Number.MAX_VALUE)],NumericTextBox.prototype,"min",void 0),__decorate([Property(Number.MAX_VALUE)],NumericTextBox.prototype,"max",void 0),__decorate([Property(1)],NumericTextBox.prototype,"step",void 0),__decorate([Property(null)],NumericTextBox.prototype,"width",void 0),__decorate([Property(null)],NumericTextBox.prototype,"placeholder",void 0),__decorate([Property({})],NumericTextBox.prototype,"htmlAttributes",void 0),__decorate([Property(!0)],NumericTextBox.prototype,"showSpinButton",void 0),__decorate([Property(!1)],NumericTextBox.prototype,"readonly",void 0),__decorate([Property(!0)],NumericTextBox.prototype,"enabled",void 0),__decorate([Property(!1)],NumericTextBox.prototype,"showClearButton",void 0),__decorate([Property(!1)],NumericTextBox.prototype,"enablePersistence",void 0),__decorate([Property("n2")],NumericTextBox.prototype,"format",void 0),__decorate([Property(null)],NumericTextBox.prototype,"decimals",void 0),__decorate([Property(null)],NumericTextBox.prototype,"currency",void 0),__decorate([Property(null)],NumericTextBox.prototype,"currencyCode",void 0),__decorate([Property(!0)],NumericTextBox.prototype,"strictMode",void 0),__decorate([Property(!1)],NumericTextBox.prototype,"validateDecimalOnType",void 0),__decorate([Property("Never")],NumericTextBox.prototype,"floatLabelType",void 0),__decorate([ej2_base_es2015_Event()],NumericTextBox.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],NumericTextBox.prototype,"destroyed",void 0),__decorate([ej2_base_es2015_Event()],NumericTextBox.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],NumericTextBox.prototype,"focus",void 0),__decorate([ej2_base_es2015_Event()],NumericTextBox.prototype,"blur",void 0),__decorate([NotifyPropertyChanges],NumericTextBox)})();const ERROR$1="e-error",INPUTGROUP="e-input-group",FLOATINPUT="e-float-input",TOPLABEL="e-label-top",BOTTOMLABEL="e-label-bottom";let regularExpressions={0:"[0-9]",9:"[0-9 ]","#":"[0-9 +-]",L:"[A-Za-z]","?":"[A-Za-z ]","&":"[^ ]+",C:"[^]+",A:"[A-Za-z0-9]",a:"[A-Za-z0-9 ]"};function unwireEvents(){EventHandler.remove(this.element,"keydown",maskInputKeyDownHandler),EventHandler.remove(this.element,"keypress",maskInputKeyPressHandler),EventHandler.remove(this.element,"keyup",maskInputKeyUpHandler),EventHandler.remove(this.element,"input",maskInputHandler),EventHandler.remove(this.element,"focus",maskInputFocusHandler),EventHandler.remove(this.element,"blur",maskInputBlurHandler),EventHandler.remove(this.element,"paste",maskInputPasteHandler),EventHandler.remove(this.element,"cut",maskInputCutHandler),this.formElement&&EventHandler.remove(this.formElement,"reset",resetFormHandler)}function bindClearEvent(){this.showClearButton&&EventHandler.add(this.inputObj.clearButton,"mousedown touchstart",resetHandler,this)}function resetHandler(e){e.preventDefault(),this.inputObj.clearButton.classList.contains("e-clear-icon-hide")||((function(event){let value=this.element.value;setElementValue.call(this,this.promptMask),this.redoCollec.unshift({value:this.promptMask,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),triggerMaskChangeEvent.call(this,event,value),this.element.setSelectionRange(0,0)}).call(this,e),this.value="")}function resetFormHandler(){"EJS-MASKEDTEXTBOX"===this.element.tagName?setElementValue.call(this,this.promptMask):this.value=this.initInputValue}function strippedValue(element,maskValues){let value="",k=0,checkMask=!1,maskValue=isNullOrUndefined(maskValues)?isNullOrUndefined(element)||isNullOrUndefined(this)?maskValues:element.value:maskValues;if(maskValue!==this.promptMask)for(let i=0;i<this.customRegExpCollec.length;i++)checkMask&&(checkMask=!1),">"!==this.customRegExpCollec[k]&&"<"!==this.customRegExpCollec[k]&&"|"!==this.customRegExpCollec[k]&&"\\"!==this.customRegExpCollec[k]||(--i,checkMask=!0),checkMask||maskValue[i]===this.promptChar||isNullOrUndefined(this.customRegExpCollec[k])||isNullOrUndefined(this.regExpCollec[this.customRegExpCollec[k]])&&!(this.customRegExpCollec[k].length>2&&"["===this.customRegExpCollec[k][0]&&"]"===this.customRegExpCollec[k][this.customRegExpCollec[k].length-1])&&(isNullOrUndefined(this.customCharacters)||isNullOrUndefined(this.customCharacters[this.customRegExpCollec[k]]))||""===maskValue||(value+=maskValue[i]),++k;return(null===this.mask||""===this.mask&&void 0!==this.value)&&(value=maskValue),value}function pushIntoRegExpCollec(value){for(let k=0;k<value.length;k++)this.hiddenMask+=value[k],"\\"!==value[k]&&this.customRegExpCollec.push(value[k])}function maskInputFocusHandler(event){this.trigger("focus",{selectionStart:0,event:event,value:this.value,maskedValue:this.element.value,container:this.inputObj.container,selectionEnd:this.promptMask.length>0?this.promptMask.length:this.element.value.length},eventArgs=>{this.mask&&(this.isFocus=!0,setElementValue.call(this,""===this.element.value?this.promptMask:this.element.value),Browser.isDevice||"11.0"!==Browser.info.version?setTimeout(()=>{this.element.setSelectionRange(eventArgs.selectionStart,eventArgs.selectionEnd)},Browser.isDevice&&Browser.isIos?450:0):this.element.setSelectionRange(eventArgs.selectionStart,eventArgs.selectionEnd))})}function maskInputBlurHandler(event){if(this.blurEventArgs={event:event,value:this.value,maskedValue:this.element.value,container:this.inputObj.container},this.trigger("blur",this.blurEventArgs),this.mask&&(this.isFocus=!1,this.placeholder&&this.element.value===this.promptMask&&"Always"!==this.floatLabelType)){setElementValue.call(this,"");let labelElement=this.element.parentNode.querySelector(".e-float-text");"Auto"===this.floatLabelType&&!isNullOrUndefined(labelElement)&&labelElement.classList.contains(TOPLABEL)&&removeClass([labelElement],TOPLABEL)}}function maskInputPasteHandler(event){if(this.mask&&!this.readonly){let sIndex=this.element.selectionStart,eIndex=this.element.selectionEnd,oldValue=this.element.value;setElementValue.call(this,""),this._callPasteHandler=!0,setTimeout(()=>{let value=this.element.value.replace(/ /g,"");this.redoCollec.length>0&&this.redoCollec[0].value===this.element.value&&(value=strippedValue.call(this,this.element)),setElementValue.call(this,oldValue),this.element.selectionStart=sIndex,this.element.selectionEnd=eIndex;let i=0;this.maskKeyPress=!0;do{validateValue.call(this,value[i],!1,null),++i}while(i<value.length);if(this.maskKeyPress=!1,this._callPasteHandler=!1,this.element.value===oldValue){let i=0;this.maskKeyPress=!0;do{validateValue.call(this,value[i],!1,null),++i}while(i<value.length);this.maskKeyPress=!1}else triggerMaskChangeEvent.call(this,event,oldValue)},1)}}function maskInputCutHandler(event){if(this.mask&&!this.readonly){let preValue=this.element.value,sIndex=this.element.selectionStart,eIndex=this.element.selectionEnd;this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd});let value=this.element.value.substring(0,sIndex)+this.promptMask.substring(sIndex,eIndex)+this.element.value.substring(eIndex);setTimeout(()=>{setElementValue.call(this,value),this.element.selectionStart=this.element.selectionEnd=sIndex,this.element.value!==preValue&&triggerMaskChangeEvent.call(this,event,null)},0)}}function maskInputDropHandler(event){event.preventDefault()}function maskInputHandler(event){if((!0!==Browser.isIE||""!==this.element.value||"Never"!==this.floatLabelType)&&(extend(event,{ctrlKey:!1,keyCode:229}),this.mask)){if(""===this.element.value&&this.redoCollec.unshift({value:this.promptMask,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),1===this.element.value.length&&(this.element.value=this.element.value+this.promptMask,this.element.setSelectionRange(1,1)),this._callPasteHandler||removeMaskInputValues.call(this,event),this.element.value.length>this.promptMask.length){let startIndex=this.element.selectionStart,value=this.element.value.substring(startIndex-(this.element.value.length-this.promptMask.length),startIndex);this.maskKeyPress=!1;let i=0;do{validateValue.call(this,value[i],event.ctrlKey,event),++i}while(i<value.length);this.element.value!==this.preEleVal&&triggerMaskChangeEvent.call(this,event,null)}let val=strippedValue.call(this,this.element);this.prevValue=val,this.value=val,""===val&&(setElementValue.call(this,this.promptMask),this.element.setSelectionRange(0,0))}}function maskInputKeyDownHandler(event){if(this.mask&&!this.readonly){229!==event.keyCode&&(!event.ctrlKey||89!==event.keyCode&&90!==event.keyCode||event.preventDefault(),removeMaskInputValues.call(this,event));let startValue=this.element.value;if(event.ctrlKey&&(89===event.keyCode||90===event.keyCode)){let collec;90===event.keyCode&&this.undoCollec.length>0&&startValue!==this.undoCollec[this.undoCollec.length-1].value?(collec=this.undoCollec[this.undoCollec.length-1],this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),setElementValue.call(this,collec.value),this.element.selectionStart=collec.startIndex,this.element.selectionEnd=collec.endIndex,this.undoCollec.splice(this.undoCollec.length-1,1)):89===event.keyCode&&this.redoCollec.length>0&&startValue!==this.redoCollec[0].value&&(collec=this.redoCollec[0],this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),setElementValue.call(this,collec.value),this.element.selectionStart=collec.startIndex,this.element.selectionEnd=collec.endIndex,this.redoCollec.splice(0,1))}}}function autoFillMaskInputValues(isRemove,oldEventVal,event){return"input"===event.type&&(isRemove=!1,oldEventVal=this.element.value,setElementValue.call(this,this.promptMask),setMaskValue.call(this,oldEventVal)),isRemove}function removeMaskInputValues(event){let oldEventVal,isRemove=!1,isDeleted=!1;this.element.value.length<this.promptMask.length&&(isRemove=autoFillMaskInputValues.call(this,isRemove=!0,oldEventVal=this.element.value,event),(function(){let collec,sIndex=this.element.selectionStart,eIndex=this.element.selectionEnd;this.redoCollec.length>0?(setElementValue.call(this,(collec=this.redoCollec[0]).value),collec.startIndex-sIndex==1?(this.element.selectionStart=collec.startIndex,this.element.selectionEnd=collec.endIndex):(this.element.selectionStart=sIndex+1,this.element.selectionEnd=eIndex+1)):(setElementValue.call(this,this.promptMask),this.element.selectionStart=this.element.selectionEnd=sIndex)}).call(this)),this.element.value.length>=this.promptMask.length&&"input"===event.type&&(isRemove=autoFillMaskInputValues.call(this,isRemove,oldEventVal,event));let initStartIndex=this.element.selectionStart,initEndIndex=this.element.selectionEnd,startIndex=this.element.selectionStart,endIndex=this.element.selectionEnd,maskValue=this.hiddenMask.replace(/[>|\\<]/g,""),curMask=maskValue[startIndex-1];if(isRemove||8===event.keyCode||46===event.keyCode){this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:endIndex});let multipleDel=!1,preValue=this.element.value;if(startIndex>0||(8===event.keyCode||46===event.keyCode)&&startIndex<this.element.value.length&&this.element.selectionEnd-startIndex!==this.element.value.length){let index=startIndex;startIndex!==endIndex?(startIndex=endIndex,46===event.keyCode&&(multipleDel=!0)):46===event.keyCode?++index:--index;for(let k=startIndex;8===event.keyCode||isRemove||multipleDel?k>index:k<index;8===event.keyCode||isRemove||multipleDel?k--:k++)for(let i=startIndex;8===event.keyCode||isRemove||multipleDel?i>0:i<this.element.value.length;8===event.keyCode||isRemove||multipleDel?i--:i++){let sIndex;(8===event.keyCode||multipleDel)&&(initStartIndex!==initEndIndex&&initStartIndex!==startIndex||initStartIndex===initEndIndex)||isRemove?(curMask=maskValue[i-1],sIndex=startIndex-1):(curMask=maskValue[i],sIndex=startIndex,++startIndex);let oldValue=this.element.value[sIndex];if(isNullOrUndefined(this.regExpCollec[curMask])&&!isNullOrUndefined(this.customCharacters)&&isNullOrUndefined(this.customCharacters[curMask])&&this.hiddenMask[sIndex]!==this.promptChar&&"["!==this.customRegExpCollec[sIndex][0]&&"]"!==this.customRegExpCollec[sIndex][this.customRegExpCollec[sIndex].length-1]||this.promptMask[sIndex]!==this.promptChar&&isNullOrUndefined(this.customCharacters))this.element.selectionStart=this.element.selectionEnd=sIndex,event.preventDefault(),46!==event.keyCode||multipleDel||++this.element.selectionStart;else{let value=this.element.value,prompt=this.promptChar,elementValue=value.substring(0,sIndex)+prompt+value.substring(startIndex,value.length);setElementValue.call(this,elementValue),event.preventDefault(),this.element.selectionStart=this.element.selectionEnd=sIndex,isDeleted=!0}if(startIndex=this.element.selectionStart,!isDeleted&&8===event.keyCode||multipleDel||!isDeleted&&46!==event.keyCode?sIndex=startIndex-1:(sIndex=startIndex,isDeleted=!1),oldValue=this.element.value[sIndex],initStartIndex!==initEndIndex&&this.element.selectionStart===initStartIndex||this.promptMask[sIndex]===this.promptChar||oldValue!==this.promptMask[sIndex]&&this.promptMask[sIndex]!==this.promptChar&&!isNullOrUndefined(this.customCharacters))break}}0===this.element.selectionStart&&this.element.selectionEnd===this.element.value.length&&(setElementValue.call(this,this.promptMask),event.preventDefault(),this.element.selectionStart=this.element.selectionEnd=startIndex),this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),this.element.value!==preValue&&triggerMaskChangeEvent.call(this,event,oldEventVal)}}function maskInputKeyPressHandler(event){if(this.mask&&!this.readonly){let oldValue=this.element.value;if(!event.ctrlKey||event.ctrlKey&&"KeyA"!==event.code&&"KeyY"!==event.code&&"KeyZ"!==event.code&&"KeyX"!==event.code&&"KeyC"!==event.code&&"KeyV"!==event.code){this.maskKeyPress=!0;let key=event.key;"Spacebar"===key&&(key=String.fromCharCode(event.keyCode)),key?key&&1===key.length&&(validateValue.call(this,key,event.ctrlKey,event),event.preventDefault()):(this.isIosInvalid=!0,validateValue.call(this,String.fromCharCode(event.keyCode),event.ctrlKey,event),event.preventDefault(),this.isIosInvalid=!1),32===event.keyCode&&" "===key&&" "===this.promptChar&&(this.element.selectionStart=this.element.selectionEnd=this.element.selectionStart-key.length)}this.element.value!==oldValue&&triggerMaskChangeEvent.call(this,event,oldValue)}}function triggerMaskChangeEvent(event,oldValue){let prevOnChange=this.isProtectedOnChange;if(!isNullOrUndefined(this.changeEventArgs)&&!this.isInitial){let eventArgs={};this.changeEventArgs={value:this.element.value,maskedValue:this.element.value,isInteraction:!1,isInteracted:!1},this.mask&&(this.changeEventArgs.value=strippedValue.call(this,this.element)),isNullOrUndefined(event)||(this.changeEventArgs.isInteracted=!0,this.changeEventArgs.isInteraction=!0,this.changeEventArgs.event=event),this.isProtectedOnChange=!0,this.value=this.changeEventArgs.value,this.isProtectedOnChange=prevOnChange,ej2_base_es2015_merge(eventArgs,this.changeEventArgs),this.trigger("change",eventArgs)}this.preEleVal=this.element.value,this.prevValue=strippedValue.call(this,this.element),attributes(this.element,{"aria-valuenow":this.element.value})}function maskInputKeyUpHandler(event){if(this.mask&&!this.readonly){let collec;if(this.maskKeyPress||229!==event.keyCode)removeMaskError.call(this);else{let oldEventVal;if(1===this.element.value.length&&(this.element.value=this.element.value+this.promptMask,this.element.setSelectionRange(1,1)),this.element.value.length>this.promptMask.length){let startIndex=this.element.selectionStart,addedValues=this.element.value.length-this.promptMask.length,val=this.element.value.substring(startIndex-addedValues,startIndex);if(this.undoCollec.length>0){let startIndex=this.element.selectionStart;oldEventVal=(collec=this.undoCollec[this.undoCollec.length-1]).value;let oldVal=collec.value.substring(startIndex-addedValues,startIndex);collec=this.redoCollec[0],val=val.trim();let isSpace=Browser.isAndroid&&""===val;isSpace||oldVal===val||collec.value.substring(startIndex-addedValues,startIndex)===val?isSpace&&preventUnsupportedValues.call(this,event,startIndex-1,this.element.selectionEnd-1,val,event.ctrlKey,!1):validateValue.call(this,val,event.ctrlKey,event)}else oldEventVal=this.promptMask,validateValue.call(this,val,event.ctrlKey,event);this.maskKeyPress=!1,triggerMaskChangeEvent.call(this,event,oldEventVal)}}let val=strippedValue.call(this,this.element);(0!==this.element.selectionStart||this.promptMask!==this.element.value||""!==val||""===val&&this.value!==val)&&(this.prevValue=val,this.value=val)}else triggerMaskChangeEvent.call(this,event);if(0===this.element.selectionStart&&0===this.element.selectionEnd){let temp=this.element;setTimeout(()=>{temp.setSelectionRange(0,0)},0)}}function validateValue(key,isCtrlKey,event){if((function(key){this.maskKeyPress||(function(key){if(key.length>1&&this.promptMask.length+key.length<this.element.value.length){let elementValue=this.redoCollec[0].value.substring(0,this.redoCollec[0].startIndex)+key+this.redoCollec[0].value.substring(this.redoCollec[0].startIndex,this.redoCollec[0].value.length);setElementValue.call(this,elementValue),this.element.selectionStart=this.element.selectionEnd=this.redoCollec[0].startIndex+key.length}this.element.selectionStart=this.element.selectionStart-key.length,this.element.selectionEnd=this.element.selectionEnd-key.length}).call(this,key)}).call(this,key),isNullOrUndefined(this)||isNullOrUndefined(key))return;let curMask,eventOldVal,startIndex=this.element.selectionStart,initStartIndex=startIndex,endIndex=this.element.selectionEnd,allowText=!1,value=this.element.value,prevSupport=!1,isEqualVal=!1;for(let k=0;k<key.length;k++){let keyValue=key[k];if(startIndex=this.element.selectionStart,endIndex=this.element.selectionEnd,this.maskKeyPress||initStartIndex!==startIndex||(startIndex+=k),!this.maskKeyPress||startIndex<this.promptMask.length){for(let i=startIndex;i<this.promptMask.length;i++)"\\"===this.hiddenMask[startIndex]&&this.hiddenMask[startIndex+1]===key&&(isEqualVal=!0),(isNullOrUndefined(this.regExpCollec[curMask=this.escapeMaskValue[startIndex]])&&(isNullOrUndefined(this.customCharacters)||!isNullOrUndefined(this.customCharacters)&&isNullOrUndefined(this.customCharacters[curMask]))&&this.hiddenMask[startIndex]!==this.promptChar&&"["!==this.customRegExpCollec[startIndex][0]&&"]"!==this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length-1]||this.promptMask[startIndex]!==this.promptChar&&isNullOrUndefined(this.customCharacters)||this.promptChar===curMask&&this.escapeMaskValue===this.mask)&&(this.element.selectionStart=this.element.selectionEnd=startIndex+1,curMask=this.hiddenMask[startIndex=this.element.selectionStart]);if(isNullOrUndefined(this.customCharacters)||isNullOrUndefined(this.customCharacters[curMask]))!isNullOrUndefined(this.regExpCollec[curMask])&&keyValue.match(new RegExp(this.regExpCollec[curMask]))&&this.promptMask[startIndex]===this.promptChar?allowText=!0:this.promptMask[startIndex]===this.promptChar&&"["===this.customRegExpCollec[startIndex][0]&&"]"===this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length-1]&&keyValue.match(new RegExp(this.customRegExpCollec[startIndex]))&&(allowText=!0);else{let customValArr=this.customCharacters[curMask].split(",");for(let i=0;i<customValArr.length;i++)if(keyValue.match(new RegExp("["+customValArr[i]+"]"))){allowText=!0;break}}if((!this.maskKeyPress||startIndex<this.hiddenMask.length)&&allowText){if(0===k)if(this.maskKeyPress)this.undoCollec.push({value:value,startIndex:startIndex,endIndex:startIndex});else{let sIndex=this.element.selectionStart,eIndex=this.element.selectionEnd;this.redoCollec.length>0?(setElementValue.call(this,eventOldVal=this.redoCollec[0].value),this.undoCollec.push(this.redoCollec[0])):(this.undoCollec.push({value:this.promptMask,startIndex:startIndex,endIndex:startIndex}),setElementValue.call(this,eventOldVal=this.promptMask)),this.element.selectionStart=sIndex,this.element.selectionEnd=eIndex}applySupportedValues.call(this,event,startIndex=this.element.selectionStart,keyValue,eventOldVal,isEqualVal),prevSupport=!0,k===key.length-1&&this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),allowText=!1}else preventUnsupportedValues.call(this,event,startIndex=this.element.selectionStart,initStartIndex,key,isCtrlKey,prevSupport);k!==key.length-1||allowText||(!Browser.isAndroid||Browser.isAndroid&&startIndex<this.promptMask.length)&&this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd})}else 1!==key.length||isCtrlKey||isNullOrUndefined(event)||addMaskErrorClass.call(this)}}function applySupportedValues(event,startIndex,keyValue,eventOldVal,isEqualVal){if(this.hiddenMask.length>this.promptMask.length&&(keyValue=(function(key,value){let promptMask,i,curVal=value,caseCount=0;for(i=0;i<this.hiddenMask.length;i++)if("\\"===this.hiddenMask[i]&&(promptMask=curVal.substring(0,i)+"\\"+curVal.substring(i,curVal.length)),">"!==this.hiddenMask[i]&&"<"!==this.hiddenMask[i]&&"|"!==this.hiddenMask[i]||(this.hiddenMask[i]!==curVal[i]&&(promptMask=curVal.substring(0,i)+this.hiddenMask[i]+curVal.substring(i,curVal.length)),++caseCount),promptMask){if(promptMask[i]===this.promptChar&&i>this.element.selectionStart||this.element.value.indexOf(this.promptChar)<0&&this.element.selectionStart+caseCount===i){caseCount=0;break}curVal=promptMask}for(;i>=0&&promptMask;){if(0===i||"\\"!==promptMask[i-1]){if(">"===promptMask[i]){key=key.toUpperCase();break}if("<"===promptMask[i]){key=key.toLowerCase();break}if("|"===promptMask[i])break}--i}return key}).call(this,keyValue,this.element.value)),!isEqualVal){let value=this.element.value,elementValue=value.substring(0,startIndex)+keyValue+value.substring(startIndex+1,value.length);setElementValue.call(this,elementValue),this.element.selectionStart=this.element.selectionEnd=startIndex+1}}function preventUnsupportedValues(event,sIdx,idx,key,ctrl,chkSupport){if(!this.maskKeyPress){let eventOldVal,value=this.element.value;sIdx>=this.promptMask.length?setElementValue.call(this,value.substring(0,sIdx)):(setElementValue.call(this,idx===sIdx?value.substring(0,sIdx)+value.substring(sIdx+1,value.length):this.promptMask.length===this.element.value.length?value.substring(0,sIdx)+value.substring(sIdx,value.length):value.substring(0,idx)+value.substring(idx+1,value.length)),this.element.selectionStart=this.element.selectionEnd=chkSupport||this.element.value[idx]!==this.promptChar?sIdx:idx),eventOldVal=this.element.value,addMaskErrorClass.call(this)}1!==key.length||ctrl||isNullOrUndefined(event)||addMaskErrorClass.call(this)}function addMaskErrorClass(){let parentElement=this.element.parentNode,timer=200;parentElement.classList.contains(INPUTGROUP)||parentElement.classList.contains(FLOATINPUT)?addClass([parentElement],ERROR$1):addClass([this.element],ERROR$1),!0===this.isIosInvalid&&(timer=400),attributes(this.element,{"aria-invalid":"true"}),setTimeout(()=>{this.maskKeyPress||removeMaskError.call(this)},timer)}function removeMaskError(){let parentElement=this.element.parentNode;isNullOrUndefined(parentElement)||removeClass([parentElement],ERROR$1),removeClass([this.element],ERROR$1),attributes(this.element,{"aria-invalid":"false"})}function setMaskValue(val){if(this.mask&&void 0!==val&&(void 0===this.prevValue||this.prevValue!==val)){if(this.maskKeyPress=!0,setElementValue.call(this,this.promptMask),""===val||null===val&&"Never"===this.floatLabelType&&this.placeholder||(this.element.selectionStart=0,this.element.selectionEnd=0),null!==val)for(let i=0;i<val.length;i++)validateValue.call(this,val[i],!1,null);let newVal=strippedValue.call(this,this.element);this.prevValue=newVal,this.value=newVal,triggerMaskChangeEvent.call(this,null,null),this.maskKeyPress=!1;let labelElement=this.element.parentNode.querySelector(".e-float-text");this.element.value===this.promptMask&&"Auto"===this.floatLabelType&&this.placeholder&&!isNullOrUndefined(labelElement)&&labelElement.classList.contains(TOPLABEL)&&!this.isFocus&&(removeClass([labelElement],TOPLABEL),addClass([labelElement],BOTTOMLABEL),setElementValue.call(this,""))}(null===this.mask||""===this.mask&&void 0!==this.value)&&setElementValue.call(this,this.value)}function setElementValue(val,element){!this.isFocus&&"Auto"===this.floatLabelType&&this.placeholder&&isNullOrUndefined(this.value)&&(val="");let value=strippedValue.call(this,element||this.element,val);null===value||""===value?(ej2_inputs_es2015_Input.setValue(val,element||this.element,this.floatLabelType,!1),this.showClearButton&&this.inputObj.clearButton.classList.add("e-clear-icon-hide")):ej2_inputs_es2015_Input.setValue(val,element||this.element,this.floatLabelType,this.showClearButton)}const wrapperAttr=["title","style","class"];let ej2_inputs_es2015_MaskedTextBox=(()=>{let MaskedTextBox=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.initInputValue="",this.maskOptions=options}getModuleName(){return"maskedtextbox"}preRender(){this.promptMask="",this.hiddenMask="",this.escapeMaskValue="",this.regExpCollec=regularExpressions,this.customRegExpCollec=[],this.undoCollec=[],this.redoCollec=[],this.changeEventArgs={},this.focusEventArgs={},this.blurEventArgs={},this.maskKeyPress=!1,this.isFocus=!1,this.isInitial=!1,this.isIosInvalid=!1;let ejInstance=getValue("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),removeClass([this.cloneElement],["e-control","e-maskedtextbox","e-lib"]),this.angularTagName=null,this.formElement=closest(this.element,"form"),"EJS-MASKEDTEXTBOX"===this.element.tagName){this.angularTagName=this.element.tagName;let input=this.createElement("input");for(let i=0;i<this.element.attributes.length;i++)input.setAttribute(this.element.attributes[i].nodeName,this.element.attributes[i].nodeValue),input.innerHTML=this.element.innerHTML;this.element.hasAttribute("id")&&this.element.removeAttribute("id"),this.element.classList.remove("e-control","e-maskedtextbox"),this.element.classList.add("e-mask-container"),this.element.appendChild(input),this.element=input,setValue("ej2_instances",ejInstance,this.element)}this.updateHTMLAttrToElement(),this.checkHtmlAttributes(!1),this.formElement&&(this.initInputValue=this.value)}getPersistData(){return this.addOnPersist(["value"])}render(){"input"===this.element.tagName.toLowerCase()&&("Never"===this.floatLabelType&&addClass([this.element],"e-input"),this.createWrapper(),this.updateHTMLAttrToWrapper(),""===this.element.name&&this.element.setAttribute("name",this.element.id),this.isInitial=!0,this.resetMaskedTextBox(),this.isInitial=!1,this.setMaskPlaceholder(!0,!1),this.setWidth(this.width),this.preEleVal=this.element.value,Browser.isDevice||"11.0"!==Browser.info.version&&"edge"!==Browser.info.name||this.element.blur(),(this.element.getAttribute("value")||this.value)&&this.element.setAttribute("value",this.element.value),this.renderComplete())}updateHTMLAttrToElement(){if(!isNullOrUndefined(this.htmlAttributes))for(let key of Object.keys(this.htmlAttributes))wrapperAttr.indexOf(key)<0&&this.element.setAttribute(key,this.htmlAttributes[key])}updateHTMLAttrToWrapper(){if(!isNullOrUndefined(this.htmlAttributes))for(let key of Object.keys(this.htmlAttributes))if(wrapperAttr.indexOf(key)>-1)if("class"===key)addClass([this.inputObj.container],this.htmlAttributes[key].split(" "));else if("style"===key){let maskStyle=this.inputObj.container.getAttribute(key);maskStyle=isNullOrUndefined(maskStyle)?this.htmlAttributes[key]:maskStyle+this.htmlAttributes[key],this.inputObj.container.setAttribute(key,maskStyle)}else this.inputObj.container.setAttribute(key,this.htmlAttributes[key])}resetMaskedTextBox(){this.promptMask="",this.hiddenMask="",this.escapeMaskValue="",this.customRegExpCollec=[],this.undoCollec=[],this.redoCollec=[],this.promptChar.length>1&&(this.promptChar=this.promptChar[0]),(function(){if(attributes(this.element,{role:"textbox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-live":"assertive","aria-valuenow":""}),this.mask){let splitMask=this.mask.split("]");for(let i=0;i<splitMask.length;i++)if("\\"===splitMask[i][splitMask[i].length-1]){splitMask[i]=splitMask[i]+"]";let splitInnerMask=splitMask[i].split("[");for(let j=0;j<splitInnerMask.length;j++)"\\"===splitInnerMask[j][splitInnerMask[j].length-1]&&(splitInnerMask[j]=splitInnerMask[j]+"["),pushIntoRegExpCollec.call(this,splitInnerMask[j])}else{let splitInnerMask=splitMask[i].split("[");if(splitInnerMask.length>1){let chkSpace=!1;for(let j=0;j<splitInnerMask.length;j++)"\\"===splitInnerMask[j]?(this.customRegExpCollec.push("["),this.hiddenMask+=splitInnerMask[j]+"["):""===splitInnerMask[j]?chkSpace=!0:""!==splitInnerMask[j]&&chkSpace||j===splitInnerMask.length-1?(this.customRegExpCollec.push("["+splitInnerMask[j]+"]"),this.hiddenMask+=this.promptChar,chkSpace=!1):pushIntoRegExpCollec.call(this,splitInnerMask[j])}else pushIntoRegExpCollec.call(this,splitInnerMask[0])}if(this.escapeMaskValue=this.hiddenMask,this.promptMask=this.hiddenMask.replace(/[09?LCAa#&]/g,this.promptChar),!isNullOrUndefined(this.customCharacters))for(let i=0;i<this.promptMask.length;i++)isNullOrUndefined(this.customCharacters[this.promptMask[i]])||(this.promptMask=this.promptMask.replace(new RegExp(this.promptMask[i],"g"),this.promptChar));let escapeNumber=0;if(this.hiddenMask.match(new RegExp(/\\/)))for(let i=0;i<this.hiddenMask.length;i++){let j=0;i>=1&&(j=i),j-=escapeNumber=this.hiddenMask.length-this.promptMask.length,i>0&&"\\"!==this.hiddenMask[i-1]&&(">"===this.hiddenMask[i]||"<"===this.hiddenMask[i]||"|"===this.hiddenMask[i])&&(this.promptMask=this.promptMask.substring(0,j)+this.promptMask.substring(i+1-escapeNumber,this.promptMask.length),this.escapeMaskValue=this.escapeMaskValue.substring(0,j)+this.escapeMaskValue.substring(i+1-escapeNumber,this.escapeMaskValue.length)),"\\"===this.hiddenMask[i]&&(this.promptMask=this.promptMask.substring(0,j)+this.hiddenMask[i+1]+this.promptMask.substring(i+2-escapeNumber,this.promptMask.length),this.escapeMaskValue=this.escapeMaskValue.substring(0,j)+this.escapeMaskValue[i+1]+this.escapeMaskValue.substring(i+2-escapeNumber,this.escapeMaskValue.length))}else this.promptMask=this.promptMask.replace(/[>|<]/g,""),this.escapeMaskValue=this.hiddenMask.replace(/[>|<]/g,"");attributes(this.element,{"aria-invalid":"false"})}}).call(this),(function(){setElementValue.call(this,this.promptMask),setMaskValue.call(this,this.value)}).call(this),(null===this.mask||""===this.mask&&void 0!==this.value)&&setElementValue.call(this,this.value);let val=strippedValue.call(this,this.element);this.prevValue=val,this.value=val,this.isInitial||unwireEvents.call(this),(function(){EventHandler.add(this.element,"keydown",maskInputKeyDownHandler,this),EventHandler.add(this.element,"keypress",maskInputKeyPressHandler,this),EventHandler.add(this.element,"keyup",maskInputKeyUpHandler,this),EventHandler.add(this.element,"input",maskInputHandler,this),EventHandler.add(this.element,"focus",maskInputFocusHandler,this),EventHandler.add(this.element,"blur",maskInputBlurHandler,this),EventHandler.add(this.element,"paste",maskInputPasteHandler,this),EventHandler.add(this.element,"cut",maskInputCutHandler,this),EventHandler.add(this.element,"drop",maskInputDropHandler,this),this.enabled&&(bindClearEvent.call(this),this.formElement&&EventHandler.add(this.formElement,"reset",resetFormHandler,this))}).call(this)}setMaskPlaceholder(setVal,dynamicPlaceholder){(dynamicPlaceholder||this.placeholder)&&(ej2_inputs_es2015_Input.setPlaceholder(this.placeholder,this.element),this.element.value===this.promptMask&&setVal&&"Always"!==this.floatLabelType&&setElementValue.call(this,""),"Never"===this.floatLabelType&&maskInputBlurHandler.call(this))}setWidth(width){isNullOrUndefined(width)||(this.element.style.width=formatUnit(width),this.inputObj.container.style.width=formatUnit(width))}checkHtmlAttributes(isDynamic){let attributes$$1=isDynamic?isNullOrUndefined(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly"];for(let key of attributes$$1)if(!isNullOrUndefined(this.element.getAttribute(key)))switch(key){case"placeholder":(isNullOrUndefined(this.maskOptions)||void 0===this.maskOptions.placeholder||isDynamic)&&this.setProperties({placeholder:this.element.placeholder},!isDynamic);break;case"disabled":if(isNullOrUndefined(this.maskOptions)||void 0===this.maskOptions.enabled||isDynamic){let enabled="disabled"!==this.element.getAttribute(key)&&""!==this.element.getAttribute(key)&&"true"!==this.element.getAttribute(key);this.setProperties({enabled:enabled},!isDynamic)}break;case"value":(isNullOrUndefined(this.maskOptions)||void 0===this.maskOptions.value||isDynamic)&&this.setProperties({value:this.element.value},!isDynamic);break;case"readonly":if(isNullOrUndefined(this.maskOptions)||void 0===this.maskOptions.readonly||isDynamic){let readonly="readonly"===this.element.getAttribute(key)||""===this.element.getAttribute(key)||"true"===this.element.getAttribute(key);this.setProperties({readonly:readonly},!isDynamic)}}}createWrapper(){this.inputObj=ej2_inputs_es2015_Input.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{enableRtl:this.enableRtl,cssClass:this.cssClass,enabled:this.enabled,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}},this.createElement),this.inputObj.container.setAttribute("class","e-widget e-control-wrapper e-mask "+this.inputObj.container.getAttribute("class"))}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"value":setMaskValue.call(this,this.value),this.placeholder&&this.setMaskPlaceholder(!1,!1);break;case"placeholder":this.setMaskPlaceholder(!0,!0);break;case"width":this.setWidth(newProp.width);break;case"cssClass":ej2_inputs_es2015_Input.setCssClass(newProp.cssClass,[this.inputObj.container],oldProp.cssClass);break;case"enabled":ej2_inputs_es2015_Input.setEnabled(newProp.enabled,this.element);break;case"readonly":ej2_inputs_es2015_Input.setReadonly(newProp.readonly,this.element);break;case"enableRtl":ej2_inputs_es2015_Input.setEnableRtl(newProp.enableRtl,[this.inputObj.container]);break;case"customCharacters":this.customCharacters=newProp.customCharacters,this.resetMaskedTextBox();break;case"showClearButton":ej2_inputs_es2015_Input.setClearButton(newProp.showClearButton,this.element,this.inputObj,void 0,this.createElement),bindClearEvent.call(this);break;case"floatLabelType":this.floatLabelType=newProp.floatLabelType,ej2_inputs_es2015_Input.removeFloating(this.inputObj),ej2_inputs_es2015_Input.addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement);break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkHtmlAttributes(!0);break;case"mask":let strippedValue$$1=this.value;this.mask=newProp.mask,this.updateValue(strippedValue$$1);break;case"promptChar":newProp.promptChar.length>1&&(newProp.promptChar=newProp.promptChar[0]),this.promptChar=newProp.promptChar?newProp.promptChar:"_";let value=this.element.value.replace(new RegExp("["+oldProp.promptChar+"]","g"),this.promptChar);this.promptMask===this.element.value&&(value=this.promptMask.replace(new RegExp("["+oldProp.promptChar+"]","g"),this.promptChar)),this.promptMask=this.promptMask.replace(new RegExp("["+oldProp.promptChar+"]","g"),this.promptChar),this.undoCollec=this.redoCollec=[],setElementValue.call(this,value)}}updateValue(strippedVal){this.resetMaskedTextBox(),setMaskValue.call(this,strippedVal)}getMaskedValue(){return(function(element){return element.value}).call(this,this.element)}focusIn(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),addClass([this.inputObj.container],["e-input-focus"]))}focusOut(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),removeClass([this.inputObj.container],["e-input-focus"]))}destroy(){unwireEvents.call(this),["aria-labelledby","role","autocomplete","aria-readonly","autocorrect","aria-disabled","aria-placeholder","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-valuenow","aria-invalid"].forEach(value=>{this.element.removeAttribute(value)}),this.element.classList.remove("e-input"),this.inputObj.container.insertAdjacentElement("afterend",this.element),detach(this.inputObj.container),super.destroy()}};return __decorate([Property(null)],MaskedTextBox.prototype,"cssClass",void 0),__decorate([Property(null)],MaskedTextBox.prototype,"width",void 0),__decorate([Property(null)],MaskedTextBox.prototype,"placeholder",void 0),__decorate([Property("Never")],MaskedTextBox.prototype,"floatLabelType",void 0),__decorate([Property({})],MaskedTextBox.prototype,"htmlAttributes",void 0),__decorate([Property(!0)],MaskedTextBox.prototype,"enabled",void 0),__decorate([Property(!1)],MaskedTextBox.prototype,"readonly",void 0),__decorate([Property(!1)],MaskedTextBox.prototype,"showClearButton",void 0),__decorate([Property(!1)],MaskedTextBox.prototype,"enablePersistence",void 0),__decorate([Property(null)],MaskedTextBox.prototype,"mask",void 0),__decorate([Property("_")],MaskedTextBox.prototype,"promptChar",void 0),__decorate([Property(null)],MaskedTextBox.prototype,"value",void 0),__decorate([Property(null)],MaskedTextBox.prototype,"customCharacters",void 0),__decorate([ej2_base_es2015_Event()],MaskedTextBox.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],MaskedTextBox.prototype,"destroyed",void 0),__decorate([ej2_base_es2015_Event()],MaskedTextBox.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],MaskedTextBox.prototype,"focus",void 0),__decorate([ej2_base_es2015_Event()],MaskedTextBox.prototype,"blur",void 0),__decorate([NotifyPropertyChanges],MaskedTextBox)})(),ej2_inputs_es2015_TicksData=(()=>{class TicksData extends ChildProperty{}return __decorate([Property("None")],TicksData.prototype,"placement",void 0),__decorate([Property(10)],TicksData.prototype,"largeStep",void 0),__decorate([Property(1)],TicksData.prototype,"smallStep",void 0),__decorate([Property(!1)],TicksData.prototype,"showSmallTicks",void 0),__decorate([Property(null)],TicksData.prototype,"format",void 0),TicksData})(),ej2_inputs_es2015_LimitData=(()=>{class LimitData extends ChildProperty{}return __decorate([Property(!1)],LimitData.prototype,"enabled",void 0),__decorate([Property(null)],LimitData.prototype,"minStart",void 0),__decorate([Property(null)],LimitData.prototype,"minEnd",void 0),__decorate([Property(null)],LimitData.prototype,"maxStart",void 0),__decorate([Property(null)],LimitData.prototype,"maxEnd",void 0),__decorate([Property(!1)],LimitData.prototype,"startHandleFixed",void 0),__decorate([Property(!1)],LimitData.prototype,"endHandleFixed",void 0),LimitData})(),ej2_inputs_es2015_TooltipData=(()=>{class TooltipData extends ChildProperty{}return __decorate([Property("")],TooltipData.prototype,"cssClass",void 0),__decorate([Property("Before")],TooltipData.prototype,"placement",void 0),__decorate([Property("Focus")],TooltipData.prototype,"showOn",void 0),__decorate([Property(!1)],TooltipData.prototype,"isVisible",void 0),__decorate([Property(null)],TooltipData.prototype,"format",void 0),TooltipData})(),ej2_inputs_es2015_Slider=(()=>{let Slider=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.horDir="left",this.verDir="bottom",this.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},this.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, top 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},this.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",this.customAriaText=null,this.drag=!0}preRender(){this.l10n=new L10n("slider",{incrementTitle:"Increase",decrementTitle:"Decrease"},this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc(),this.formChecker()}formChecker(){const formElement=closest(this.element,"form");formElement?(this.isForm=!0,isNullOrUndefined(this.formResetValue)||this.setProperties({value:this.formResetValue},!0),this.formResetValue=this.value,"Range"!==this.type||!isNullOrUndefined(this.formResetValue)&&"object"==typeof this.formResetValue?isNullOrUndefined(this.formResetValue)&&(this.formResetValue=parseFloat(formatUnit(this.min))):this.formResetValue=[parseFloat(formatUnit(this.min)),parseFloat(formatUnit(this.max))],this.formElement=formElement):this.isForm=!1}initCultureFunc(){this.internationalization=new Internationalization(this.locale)}initCultureInfo(){this.tooltipFormatInfo.format=isNullOrUndefined(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=isNullOrUndefined(this.ticks.format)?null:this.ticks.format}formatString(value,formatInfo){let formatValue=null,formatString=null;if(value||0===value){formatValue=this.formatNumber(value);let numberOfDecimals=this.numberOfDecimals(value);formatString=this.internationalization.getNumberFormat(formatInfo)(this.makeRoundNumber(value,numberOfDecimals))}return{elementVal:formatValue,formatString:formatString}}formatNumber(value){let numberOfDecimals=this.numberOfDecimals(value);return this.internationalization.getNumberFormat({maximumFractionDigits:numberOfDecimals,minimumFractionDigits:numberOfDecimals,useGrouping:!1})(value)}numberOfDecimals(value){let decimalPart=value.toString().split(".")[1];return decimalPart&&decimalPart.length?decimalPart.length:0}makeRoundNumber(value,precision){return Number(value.toFixed(precision||0))}fractionalToInteger(value){value=0===this.numberOfDecimals(value)?Number(value).toFixed(this.noOfDecimals):value;let tens=1;for(let i=0;i<this.noOfDecimals;i++)tens*=10;return Number((value*tens).toFixed(0))}render(){this.initialize(),this.initRender(),this.wireEvents(),this.setZindex(),this.renderComplete()}initialize(){addClass([this.element],"e-slider"),this.setCSSClass()}setCSSClass(oldCSSClass){oldCSSClass&&removeClass([this.element],oldCSSClass.split(" ")),this.cssClass&&addClass([this.element],this.cssClass.split(" "))}setEnabled(){this.enabled?(removeClass([this.sliderContainer],["e-disabled"]),this.tooltip.isVisible&&this.tooltipElement&&"Always"===this.tooltip.showOn&&this.tooltipElement.classList.remove("e-disabled"),this.wireEvents()):(addClass([this.sliderContainer],["e-disabled"]),this.tooltip.isVisible&&this.tooltipElement&&"Always"===this.tooltip.showOn&&this.tooltipElement.classList.add("e-disabled"),this.unwireEvents())}getTheme(container){return window.getComputedStyle(container,":after").getPropertyValue("content").replace(/['"]+/g,"")}initRender(){this.sliderContainer=this.createElement("div",{className:"e-slider-container e-control-wrapper"}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:"e-slider-track"}),this.element.appendChild(this.sliderTrack),this.element.tabIndex=-1,this.getThemeInitialization(),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:isNullOrUndefined(this.value)?this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(1e3*Math.random()).toFixed(0)+"slider",class:"e-slider-input"}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),"Range"===this.type?this.rangeValueUpdate():this.value=isNullOrUndefined(this.value)?parseFloat(formatUnit(this.min.toString())):this.value,this.previousVal="Range"!==this.type?this.checkHandleValue(parseFloat(formatUnit(this.value.toString()))):[this.checkHandleValue(parseFloat(formatUnit(this.value[0].toString()))),this.checkHandleValue(parseFloat(formatUnit(this.value[1].toString())))],this.previousChanged=this.previousVal,isNullOrUndefined(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),"None"!==this.ticks.placement&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?removeClass([this.sliderContainer],["e-disabled"]):addClass([this.sliderContainer],["e-disabled"]),this.readonly?addClass([this.sliderContainer],["e-read-only"]):removeClass([this.sliderContainer],["e-read-only"])}getThemeInitialization(){this.isMaterial="material"===this.getTheme(this.sliderContainer)||"material-dark"===this.getTheme(this.sliderContainer),this.isBootstrap="bootstrap"===this.getTheme(this.sliderContainer)||"bootstrap-dark"===this.getTheme(this.sliderContainer),this.isBootstrap4="bootstrap4"===this.getTheme(this.sliderContainer),this.isMaterialTooltip=this.isMaterial&&"Range"!==this.type&&this.tooltip.isVisible}createRangeBar(){"Default"!==this.type&&(this.rangeBar=this.createElement("div",{attrs:{class:"e-range"}}),this.element.appendChild(this.rangeBar),this.drag&&"Range"===this.type&&this.rangeBar.classList.add("Horizontal"===this.orientation?"e-drag-horizontal":"e-drag-vertical"))}createLimitBar(){let firstElementClassName="Range"!==this.type?"e-limit-bar":"e-limit-first";this.limitBarFirst=this.createElement("div",{attrs:{class:firstElementClassName+=" e-limits"}}),this.element.appendChild(this.limitBarFirst),"Range"===this.type&&(this.limitBarSecond=this.createElement("div",{attrs:{class:"e-limit-second e-limits"}}),this.element.appendChild(this.limitBarSecond))}setOrientClass(){"Vertical"!==this.orientation?(this.sliderContainer.classList.remove("e-vertical"),this.sliderContainer.classList.add("e-horizontal"),this.firstHandle.setAttribute("aria-orientation","horizontal"),"Range"===this.type&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove("e-horizontal"),this.sliderContainer.classList.add("e-vertical"),this.firstHandle.setAttribute("aria-orientation","vertical"),"Range"===this.type&&this.secondHandle.setAttribute("aria-orientation","vertical"))}setAriaAttributes(element){let min=this.min,max=this.max;!isNullOrUndefined(this.customValues)&&this.customValues.length>0&&(min=this.customValues[0],max=this.customValues[this.customValues.length-1]),"Range"!==this.type?attributes(element,{"aria-valuemin":min.toString(),"aria-valuemax":max.toString()}):(!isNullOrUndefined(this.customValues)&&this.customValues.length>0?[[min.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),max.toString()]]:[[min.toString(),this.value[1].toString()],[this.value[0].toString(),max.toString()]]).forEach((range,index)=>{let element=0===index?this.firstHandle:this.secondHandle;element&&attributes(element,{"aria-valuemin":range[0],"aria-valuemax":range[1]})})}createSecondHandle(){this.secondHandle=this.createElement("div",{attrs:{class:"e-handle",role:"slider","aria-labelledby":this.element.id+"_title",tabIndex:"0"}}),this.secondHandle.classList.add("e-handle-second"),this.element.appendChild(this.secondHandle)}createFirstHandle(){this.firstHandle=this.createElement("div",{attrs:{class:"e-handle",role:"slider","aria-labelledby":this.element.id+"_title",tabIndex:"0"}}),this.firstHandle.classList.add("e-handle-first"),this.element.appendChild(this.firstHandle),this.isMaterialTooltip&&(this.materialHandle=this.createElement("div",{attrs:{class:"e-handle e-material-handle"}}),this.element.appendChild(this.materialHandle))}wireFirstHandleEvt(destroy){destroy?(EventHandler.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),EventHandler.remove(this.firstHandle,"transitionend",this.transitionEnd),EventHandler.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),EventHandler.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(EventHandler.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),EventHandler.add(this.firstHandle,"transitionend",this.transitionEnd,this),EventHandler.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),EventHandler.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))}wireSecondHandleEvt(destroy){destroy?(EventHandler.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),EventHandler.remove(this.secondHandle,"transitionend",this.transitionEnd),EventHandler.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),EventHandler.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(EventHandler.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),EventHandler.add(this.secondHandle,"transitionend",this.transitionEnd,this),EventHandler.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),EventHandler.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))}handleStart(){"Range"!==this.type&&(this.firstHandle.classList[0===this.handlePos1?"add":"remove"]("e-handle-start"),this.isMaterialTooltip&&(this.materialHandle.classList[0===this.handlePos1?"add":"remove"]("e-handle-start"),this.tooltipElement&&this.tooltipElement.classList[0===this.handlePos1?"add":"remove"]("e-material-tooltip-start")))}transitionEnd(e){"transform"!==e.propertyName&&(this.handleStart(),this.getHandle().style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),this.isMaterial&&this.tooltip.isVisible&&"Default"===this.type&&(this.tooltipElement.style.transition=this.transition.handle),this.tooltipToggle(this.getHandle()),this.closeTooltip())}handleFocusOut(){this.firstHandle.classList.contains("e-handle-focused")&&this.firstHandle.classList.remove("e-handle-focused"),"Range"===this.type&&this.secondHandle.classList.contains("e-handle-focused")&&this.secondHandle.classList.remove("e-handle-focused")}handleFocus(e){e.currentTarget===this.firstHandle?this.firstHandle.classList.add("e-handle-focused"):this.secondHandle.classList.add("e-handle-focused")}handleOver(e){this.tooltip.isVisible&&"Hover"===this.tooltip.showOn&&this.tooltipToggle(e.currentTarget)}handleLeave(e){!this.tooltip.isVisible||"Hover"!==this.tooltip.showOn||e.currentTarget.classList.contains("e-handle-focused")||e.currentTarget.classList.contains("e-tab-handle")||this.closeTooltip()}setHandler(){this.min>this.max&&(this.min=this.max),this.createFirstHandle(),"Range"===this.type&&this.createSecondHandle()}setEnableRTL(){this.enableRtl&&"Vertical"!==this.orientation?addClass([this.sliderContainer],"e-rtl"):removeClass([this.sliderContainer],"e-rtl");let preDir="Vertical"!==this.orientation?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom"),preDir!==("Vertical"!==this.orientation?this.horDir:this.verDir)&&"Horizontal"===this.orientation&&(setStyleAttribute(this.firstHandle,{right:"",left:"auto"}),"Range"===this.type&&setStyleAttribute(this.secondHandle,{top:"",left:"auto"}))}tooltipValue(){let text,args={value:this.value,text:""};this.setTooltipContent(),args.text=text=this.tooltipObj.content,this.trigger("tooltipChange",args,observedArgs=>{this.addTooltipClass(observedArgs.text),text!==observedArgs.text&&(this.customAriaText=observedArgs.text,this.tooltipObj.content=observedArgs.text,this.setAriaAttrValue(this.firstHandle),"Range"===this.type&&this.setAriaAttrValue(this.secondHandle))})}setTooltipContent(){let content;content=this.formatContent(this.tooltipFormatInfo,!1),this.tooltipObj.content=content}formatContent(formatInfo,ariaContent){let content="",handle1=this.handleVal1,handle2=this.handleVal2;return!isNullOrUndefined(this.customValues)&&this.customValues.length>0&&(handle1=this.customValues[this.handleVal1],handle2=this.customValues[this.handleVal2]),ariaContent?("Range"===this.type?content=this.enableRtl&&"Vertical"!==this.orientation?isNullOrUndefined(this.tooltip)||isNullOrUndefined(this.tooltip.format)?handle2.toString()+" - "+handle1.toString():this.formatString(handle2,formatInfo).elementVal+" - "+this.formatString(handle1,formatInfo).elementVal:isNullOrUndefined(this.tooltip)||isNullOrUndefined(this.tooltip.format)?handle1.toString()+" - "+handle2.toString():this.formatString(handle1,formatInfo).elementVal+" - "+this.formatString(handle2,formatInfo).elementVal:isNullOrUndefined(handle1)||(content=isNullOrUndefined(this.tooltip)||isNullOrUndefined(this.tooltip.format)?handle1.toString():this.formatString(handle1,formatInfo).elementVal),content):("Range"===this.type?content=this.enableRtl&&"Vertical"!==this.orientation?isNullOrUndefined(formatInfo.format)?handle2.toString()+" - "+handle1.toString():this.formatString(handle2,formatInfo).formatString+" - "+this.formatString(handle1,formatInfo).formatString:isNullOrUndefined(formatInfo.format)?handle1.toString()+" - "+handle2.toString():this.formatString(handle1,formatInfo).formatString+" - "+this.formatString(handle2,formatInfo).formatString:isNullOrUndefined(handle1)||(content=isNullOrUndefined(formatInfo.format)?handle1.toString():this.formatString(handle1,formatInfo).formatString),content)}addTooltipClass(content){if(this.isMaterialTooltip){let count=content.toString().length;if(this.tooltipElement){let cssClass=count>4?{oldCss:"e-material-default",newCss:"e-material-range"}:{oldCss:"e-material-range",newCss:"e-material-default"};this.tooltipElement.classList.remove(cssClass.oldCss),this.tooltipElement.classList.contains(cssClass.newCss)||(this.tooltipElement.classList.add(cssClass.newCss),this.tooltipElement.style.transform=count>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}else this.tooltipObj.cssClass="e-slider-tooltip "+(count>4?"e-material-range":"e-material-default")}}tooltipPlacement(){return"Horizontal"===this.orientation?"Before"===this.tooltip.placement?"TopCenter":"BottomCenter":"Before"===this.tooltip.placement?"LeftCenter":"RightCenter"}tooltipBeforeOpen(args){this.tooltipElement=args.element,this.tooltip.cssClass&&addClass([this.tooltipElement],this.tooltip.cssClass.split(" ").filter(css=>css)),args.target.removeAttribute("aria-describedby"),this.isMaterialTooltip&&(this.tooltipElement.firstElementChild.classList.add("e-material-tooltip-hide"),this.handleStart(),this.setTooltipTransform())}tooltipCollision(position){if(this.isBootstrap||this.isBootstrap4||this.isMaterial&&!this.isMaterialTooltip){const tooltipOffsetValue=this.isBootstrap4?3:6;switch(position){case"TopCenter":this.tooltipObj.setProperties({offsetY:-tooltipOffsetValue},!1);break;case"BottomCenter":this.tooltipObj.setProperties({offsetY:tooltipOffsetValue},!1);break;case"LeftCenter":this.tooltipObj.setProperties({offsetX:-tooltipOffsetValue},!1);break;case"RightCenter":this.tooltipObj.setProperties({offsetX:tooltipOffsetValue},!1)}}}wireMaterialTooltipEvent(destroy){this.isMaterialTooltip&&(destroy?EventHandler.remove(this.tooltipElement,"mousedown touchstart",this.sliderDown):EventHandler.add(this.tooltipElement,"mousedown touchstart",this.sliderDown,this))}tooltipPositionCalculation(position){let cssClass;switch(position){case"TopCenter":cssClass="e-slider-horizontal-before";break;case"BottomCenter":cssClass="e-slider-horizontal-after";break;case"LeftCenter":cssClass="e-slider-vertical-before";break;case"RightCenter":cssClass="e-slider-vertical-after"}return cssClass}getTooltipTransformProperties(className){let transformProperties;if(this.tooltipElement){let position="Horizontal"===this.orientation?this.tooltipElement.clientHeight+14-this.tooltipElement.clientHeight/2:this.tooltipElement.clientWidth+14-this.tooltipElement.clientWidth/2;transformProperties="Horizontal"===this.orientation?"e-slider-horizontal-before"===className?{rotate:"rotate(45deg)",translate:`translateY(${position}px)`}:{rotate:"rotate(225deg)",translate:`translateY(${-position}px)`}:"e-slider-vertical-before"===className?{rotate:"rotate(-45deg)",translate:`translateX(${position}px)`}:{rotate:"rotate(-225deg)",translate:`translateX(${-position}px)`}}return transformProperties}openMaterialTooltip(){if(this.isMaterialTooltip){this.refreshTooltip(this.firstHandle);let tooltipContentElement=this.tooltipElement.firstElementChild;tooltipContentElement.classList.remove("e-material-tooltip-hide"),tooltipContentElement.classList.add("e-material-tooltip-show"),this.firstHandle.style.cursor="default",this.tooltipElement.style.transition=this.scaleTransform,this.tooltipElement.classList.add("e-material-tooltip-open"),this.materialHandle.style.transform="scale(0)",this.tooltipElement.style.transform=tooltipContentElement.innerText.length>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate,"Default"===this.type?setTimeout(()=>{this.tooltipElement.style.transition=this.transition.handle},2500):setTimeout(()=>{this.tooltipElement.style.transition="none"},2500)}}closeMaterialTooltip(){if(this.isMaterialTooltip){let tooltipContentElement=this.tooltipElement.firstElementChild;this.tooltipElement.style.transition=this.scaleTransform,tooltipContentElement.classList.remove("e-material-tooltip-show"),tooltipContentElement.classList.add("e-material-tooltip-hide"),this.firstHandle.style.cursor="-webkit-grab",this.firstHandle.style.cursor="grab",this.materialHandle.style.transform="scale(1)",this.tooltipElement.classList.remove("e-material-tooltip-open"),this.setTooltipTransform(),this.tooltipTarget=void 0,setTimeout(()=>{this.tooltipElement.style.transition="none"},2500)}}checkTooltipPosition(args){if(void 0===this.tooltipCollidedPosition||this.tooltipCollidedPosition!==args.collidedPosition){if(this.isMaterialTooltip){let tooltipClass=this.tooltipPositionCalculation(args.collidedPosition);args.element.classList.remove(this.previousTooltipClass),args.element.classList.add(tooltipClass),this.previousTooltipClass=tooltipClass,args.element.style.transform&&args.element.classList.contains("e-material-tooltip-open")&&args.element.firstElementChild.innerText.length<=4&&(args.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}this.tooltipCollidedPosition=args.collidedPosition}this.isMaterialTooltip&&this.tooltipElement&&-1!==this.tooltipElement.style.transform.indexOf("translate")&&this.setTooltipTransform()}setTooltipTransform(){let transformProperties=this.getTooltipTransformProperties(this.previousTooltipClass);this.tooltipElement.style.transform=this.tooltipElement.firstElementChild.innerText.length>4?`${transformProperties.translate} scale(0.01)`:`${transformProperties.translate} ${transformProperties.rotate} scale(0.01)`}renderTooltip(){this.tooltipObj=new ej2_popups_es2015_Tooltip({showTipPointer:this.isBootstrap||this.isMaterial||this.isBootstrap4,cssClass:"e-slider-tooltip",height:this.isMaterial?30:"auto",animation:{open:{effect:"None"},close:{effect:"FadeOut",duration:500}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),beforeClose:this.tooltipBeforeClose.bind(this)}),this.tooltipObj.appendTo(this.firstHandle),this.initializeTooltipProps()}initializeTooltipProps(){this.setProperties({tooltip:{showOn:this.isMaterialTooltip?"Always":"Auto"===this.tooltip.showOn?"Hover":this.tooltip.showOn}},!0),this.tooltipObj.position=this.tooltipPlacement(),this.tooltipCollision(this.tooltipObj.position),[this.firstHandle,this.rangeBar,this.secondHandle].forEach(handle=>{isNullOrUndefined(handle)||(handle.style.transition="none")}),this.isMaterialTooltip&&(this.sliderContainer.classList.add("e-material-slider"),this.tooltipValue(),this.tooltipObj.animation.close.effect="None",this.tooltipObj.open(this.firstHandle))}tooltipBeforeClose(){this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0}setButtons(){this.firstBtn=this.createElement("div",{className:"e-slider-button e-first-button"}),this.firstBtn.appendChild(this.createElement("span",{className:"e-button-icon"})),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:"e-slider-button e-second-button"}),this.secondBtn.appendChild(this.createElement("span",{className:"e-button-icon"})),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add("e-slider-btn"),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()}buttonTitle(){let enabledRTL=this.enableRtl&&"Vertical"!==this.orientation;this.l10n.setLocale(this.locale);let decrementTitle=this.l10n.getConstant("decrementTitle"),incrementTitle=this.l10n.getConstant("incrementTitle");attributes(enabledRTL?this.secondBtn:this.firstBtn,{"aria-label":decrementTitle,title:decrementTitle}),attributes(enabledRTL?this.firstBtn:this.secondBtn,{"aria-label":incrementTitle,title:incrementTitle})}buttonFocusOut(){this.isMaterial&&this.getHandle().classList.remove("e-large-thumb-size")}repeatButton(args){let value,hVal=this.handleValueUpdate(),enabledRTL=this.enableRtl&&"Vertical"!==this.orientation;args.target.parentElement.classList.contains("e-first-button")||args.target.classList.contains("e-first-button")?value=this.add(hVal,parseFloat(this.step.toString()),!!enabledRTL):(args.target.parentElement.classList.contains("e-second-button")||args.target.classList.contains("e-second-button"))&&(value=this.add(hVal,parseFloat(this.step.toString()),!enabledRTL)),this.limits.enabled&&(value=this.getLimitCorrectedValues(value)),value>=this.min&&value<=this.max&&(this.changeHandleValue(value),this.tooltipToggle(this.getHandle()))}repeatHandlerMouse(args){args.preventDefault(),"mousedown"!==args.type&&"touchstart"!==args.type||(this.buttonClick(args),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,args))}materialChange(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")}repeatHandlerUp(e){this.changeEvent("changed"),this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()}customTickCounter(bigNum){let tickCount=4;return!isNullOrUndefined(this.customValues)&&this.customValues.length>0&&(bigNum>4&&(tickCount=3),bigNum>7&&(tickCount=2),bigNum>14&&(tickCount=1),bigNum>28&&(tickCount=0)),tickCount}renderScale(){let orien="Vertical"===this.orientation?"v":"h";this.noOfDecimals=this.numberOfDecimals(this.step),this.ul=this.createElement("ul",{className:"e-scale e-"+orien+"-scale e-tick-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),this.ul.style.zIndex="-1",Browser.isAndroid&&"h"===orien&&this.ul.classList.add("e-tick-pos");let smallStep=this.ticks.smallStep;this.ticks.showSmallTicks?smallStep<=0&&(smallStep=parseFloat(formatUnit(this.step))):smallStep=this.ticks.largeStep>0?this.ticks.largeStep:parseFloat(formatUnit(this.max))-parseFloat(formatUnit(this.min));let li,min=this.fractionalToInteger(this.min),max=this.fractionalToInteger(this.max),steps=this.fractionalToInteger(smallStep),bigNum=!isNullOrUndefined(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,customStep=this.customTickCounter(bigNum),count=!isNullOrUndefined(this.customValues)&&this.customValues.length>0?bigNum*customStep+bigNum:Math.abs((max-min)/steps);this.element.appendChild(this.ul);let start=parseFloat(this.min.toString());"v"===orien&&(start=parseFloat(this.max.toString()));let islargeTick,left=0,tickWidth=100/count;tickWidth===1/0&&(tickWidth=5);for(let i=0,y=!isNullOrUndefined(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,k=0;i<=count;i++){if(li=this.createElement("li",{attrs:{class:"e-tick",role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),!isNullOrUndefined(this.customValues)&&this.customValues.length>0)(islargeTick=i%(customStep+1)==0)&&("h"===orien?(start=this.customValues[k],k++):(start=this.customValues[y],y--),li.setAttribute("title",start.toString()));else if(li.setAttribute("title",start.toString()),0===this.numberOfDecimals(this.max)&&0===this.numberOfDecimals(this.min)&&0===this.numberOfDecimals(this.step))islargeTick="h"===orien?(start-parseFloat(this.min.toString()))%this.ticks.largeStep==0:Math.abs(start-parseFloat(this.max.toString()))%this.ticks.largeStep==0;else{let largestep=this.fractionalToInteger(this.ticks.largeStep),startValue=this.fractionalToInteger(start);islargeTick="h"===orien?(startValue-min)%largestep==0:Math.abs(startValue-parseFloat(max.toString()))%largestep==0}islargeTick&&li.classList.add("e-large"),"h"===orien?li.style.width=tickWidth+"%":li.style.height=tickWidth+"%";let decimalPoints,repeat=islargeTick?"Both"===this.ticks.placement?2:1:0;if(islargeTick)for(let j=0;j<repeat;j++)this.createTick(li,start,tickWidth);else isNullOrUndefined(this.customValues)&&this.formatTicksValue(li,start);this.ul.appendChild(li),this.tickElementCollection.push(li),isNullOrUndefined(this.customValues)&&(decimalPoints=this.numberOfDecimals(smallStep)>this.numberOfDecimals(start)?this.numberOfDecimals(smallStep):this.numberOfDecimals(start),start=this.makeRoundNumber("h"===orien?start+smallStep:start-smallStep,decimalPoints),left=this.makeRoundNumber(left+smallStep,decimalPoints))}this.ticksAlignment(orien,tickWidth)}ticksAlignment(orien,tickWidth,triggerEvent=!0){this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add("e-first-tick"),this.lastChild.classList.add("e-last-tick"),this.sliderContainer.classList.add("e-scale-"+this.ticks.placement.toLowerCase()),"h"===orien?(this.firstChild.style.width=tickWidth/2+"%",this.lastChild.style.width=tickWidth/2+"%"):(this.firstChild.style.height=tickWidth/2+"%",this.lastChild.style.height=tickWidth/2+"%"),triggerEvent&&this.trigger("renderedTicks",{ticksWrapper:this.ul,tickElements:this.tickElementCollection}),this.scaleAlignment()}createTick(li,start,tickWidth){let span=this.createElement("span",{className:"e-tick-value e-tick-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}});li.appendChild(span),isNullOrUndefined(this.customValues)?this.formatTicksValue(li,start,span,tickWidth):span.innerHTML=start.toString()}formatTicksValue(li,start,spanElement,tickWidth){const tickText=this.formatNumber(start),text=isNullOrUndefined(this.ticks)||isNullOrUndefined(this.ticks.format)?tickText:this.formatString(start,this.ticksFormatInfo).formatString;this.trigger("renderingTicks",{value:start,text:text,tickElement:li},observedArgs=>{li.setAttribute("title",observedArgs.text.toString()),spanElement&&(spanElement.innerHTML=observedArgs.text.toString()),isBlazor()&&this.ticksAlignment("Horizontal"===this.orientation?"h":"v",tickWidth,!1)})}scaleAlignment(){this.tickValuePosition(),"Vertical"===this.orientation?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add("e-small-size"):this.sliderContainer.classList.remove("e-small-size"):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add("e-small-size"):this.sliderContainer.classList.remove("e-small-size")}tickValuePosition(){let firstChild,first=this.firstChild.getBoundingClientRect(),smallStep=this.ticks.smallStep,count=Math.abs(parseFloat(formatUnit(this.max))-parseFloat(formatUnit(this.min)))/smallStep;this.firstChild.children.length>0&&(firstChild=this.firstChild.children[0].getBoundingClientRect());let other,tickElements=[this.sliderContainer.querySelectorAll(".e-tick.e-large .e-tick-value")];other=[].slice.call(tickElements[0],"Both"===this.ticks.placement?2:1);let tickWidth="Vertical"===this.orientation?2*first.height:2*first.width;for(let i=0;i<this.firstChild.children.length;i++)"Vertical"===this.orientation?this.firstChild.children[i].style.top=-firstChild.height/2+"px":this.firstChild.children[i].style.left=this.enableRtl?(tickWidth-this.firstChild.children[i].getBoundingClientRect().width)/2+"px":-firstChild.width/2+"px";for(let i=0;i<other.length;i++){let otherChild=other[i].getBoundingClientRect();setStyleAttribute(other[i],"Vertical"===this.orientation?{top:(tickWidth-otherChild.height)/2+"px"}:{left:(tickWidth-otherChild.width)/2+"px"})}this.enableRtl&&this.lastChild.children.length&&0!==count&&(this.lastChild.children[0].style.left=-this.lastChild.getBoundingClientRect().width/2+"px","Both"===this.ticks.placement&&(this.lastChild.children[1].style.left=-this.lastChild.getBoundingClientRect().width/2+"px")),0===count&&("Horizontal"===this.orientation&&(this.enableRtl?(this.firstChild.classList.remove("e-last-tick"),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px","Both"===this.ticks.placement&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove("e-last-tick"),this.firstChild.style.left=this.firstHandle.style.left)),"Vertical"===this.orientation&&this.firstChild.classList.remove("e-last-tick"))}setAriaAttrValue(element){let ariaValueText,isTickFormatted=!isNullOrUndefined(this.ticks)&&!isNullOrUndefined(this.ticks.format),text=this.formatContent(isTickFormatted?this.tooltipFormatInfo:this.ticksFormatInfo,!1),valuenow=this.formatContent(isTickFormatted?this.ticksFormatInfo:this.tooltipFormatInfo,!0);ariaValueText=2===(text=this.customAriaText?this.customAriaText:text).split(" - ").length?text.split(" - "):[text,text],this.setAriaAttributes(element),attributes(element,"Range"!==this.type?{"aria-valuenow":valuenow,"aria-valuetext":text}:this.enableRtl?element===this.firstHandle?{"aria-valuenow":valuenow.split(" - ")[1],"aria-valuetext":ariaValueText[1]}:{"aria-valuenow":valuenow.split(" - ")[0],"aria-valuetext":ariaValueText[0]}:element===this.firstHandle?{"aria-valuenow":valuenow.split(" - ")[0],"aria-valuetext":ariaValueText[0]}:{"aria-valuenow":valuenow.split(" - ")[1],"aria-valuetext":ariaValueText[1]})}handleValueUpdate(){return"Range"===this.type?1===this.activeHandle?this.handleVal1:this.handleVal2:this.handleVal1}getLimitCorrectedValues(value){return"MinRange"===this.type||"Default"===this.type?this.getLimitValueAndPosition(value,this.limits.minStart,this.limits.minEnd)[0]:1===this.activeHandle?this.getLimitValueAndPosition(value,this.limits.minStart,this.limits.minEnd)[0]:this.getLimitValueAndPosition(value,this.limits.maxStart,this.limits.maxEnd)[0]}focusSliderElement(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)}buttonClick(args){let value;this.focusSliderElement();let enabledRTL=this.enableRtl&&"Vertical"!==this.orientation,hVal=this.handleValueUpdate();40===args.keyCode||37===args.keyCode||args.currentTarget.classList.contains("e-first-button")?value=this.add(hVal,parseFloat(this.step.toString()),!!enabledRTL):38===args.keyCode||39===args.keyCode||args.currentTarget.classList.contains("e-second-button")?value=this.add(hVal,parseFloat(this.step.toString()),!enabledRTL):33===args.keyCode||args.currentTarget.classList.contains("e-first-button")?value=this.add(hVal,parseFloat(this.ticks.largeStep.toString()),!enabledRTL):34===args.keyCode||args.currentTarget.classList.contains("e-second-button")?value=this.add(hVal,parseFloat(this.ticks.largeStep.toString()),!!enabledRTL):36===args.keyCode?value=parseFloat(this.min.toString()):35===args.keyCode&&(value=parseFloat(this.max.toString())),this.limits.enabled&&(value=this.getLimitCorrectedValues(value)),this.changeHandleValue(value),!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains("e-tab-handle")||this.materialChange(),this.tooltipToggle(this.getHandle()),this.getHandle().focus(),args.currentTarget.classList.contains("e-first-button")&&EventHandler.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),args.currentTarget.classList.contains("e-second-button")&&EventHandler.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)}tooltipToggle(target){this.isMaterialTooltip?this.tooltipElement.classList.contains("e-material-tooltip-open")?this.refreshTooltip(this.firstHandle):this.openMaterialTooltip():this.tooltipElement?this.refreshTooltip(target):this.openTooltip(target)}buttonUp(args){args.currentTarget.classList.contains("e-first-button")&&EventHandler.remove(this.firstBtn,"mouseup touchend",this.buttonUp),args.currentTarget.classList.contains("e-second-button")&&EventHandler.remove(this.secondBtn,"mouseup touchend",this.buttonUp)}setRangeBar(){"Horizontal"===this.orientation?"MinRange"===this.type?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",setStyleAttribute(this.rangeBar,{width:isNullOrUndefined(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",setStyleAttribute(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):"MinRange"===this.type?(this.rangeBar.style.bottom="0px",setStyleAttribute(this.rangeBar,{height:isNullOrUndefined(this.handlePos1)?0:this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.handlePos1+"px",setStyleAttribute(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))}checkValidValueAndPos(value){return value=this.checkHandleValue(value),this.checkHandlePosition(value)}setLimitBarPositions(fromMinPostion,fromMaxpostion,toMinPostion,toMaxpostion){"Horizontal"===this.orientation?this.enableRtl?(this.limitBarFirst.style.right=fromMinPostion+"px",this.limitBarFirst.style.width=fromMaxpostion-fromMinPostion+"px"):(this.limitBarFirst.style.left=fromMinPostion+"px",this.limitBarFirst.style.width=fromMaxpostion-fromMinPostion+"px"):(this.limitBarFirst.style.bottom=fromMinPostion+"px",this.limitBarFirst.style.height=fromMaxpostion-fromMinPostion+"px"),"Range"===this.type&&("Horizontal"===this.orientation?this.enableRtl?(this.limitBarSecond.style.right=toMinPostion+"px",this.limitBarSecond.style.width=toMaxpostion-toMinPostion+"px"):(this.limitBarSecond.style.left=toMinPostion+"px",this.limitBarSecond.style.width=toMaxpostion-toMinPostion+"px"):(this.limitBarSecond.style.bottom=toMinPostion+"px",this.limitBarSecond.style.height=toMaxpostion-toMinPostion+"px"))}setLimitBar(){if("Default"===this.type||"MinRange"===this.type){let fromPosition=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];fromPosition=this.checkValidValueAndPos(fromPosition);let toPosition=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];toPosition=this.checkValidValueAndPos(toPosition),this.setLimitBarPositions(fromPosition,toPosition)}else if("Range"===this.type){let fromMinPostion=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];fromMinPostion=this.checkValidValueAndPos(fromMinPostion);let fromMaxpostion=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];fromMaxpostion=this.checkValidValueAndPos(fromMaxpostion);let toMinPostion=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];toMinPostion=this.checkValidValueAndPos(toMinPostion);let toMaxpostion=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];toMaxpostion=this.checkValidValueAndPos(toMaxpostion),this.setLimitBarPositions(fromMinPostion,fromMaxpostion,toMinPostion,toMaxpostion)}}getLimitValueAndPosition(currentValue,minValue,maxValue,limitBar){return isNullOrUndefined(minValue)&&(minValue=this.min,isNullOrUndefined(currentValue)&&limitBar&&(currentValue=minValue)),isNullOrUndefined(maxValue)&&(maxValue=this.max,isNullOrUndefined(currentValue)&&limitBar&&(currentValue=maxValue)),currentValue<minValue&&(currentValue=minValue),currentValue>maxValue&&(currentValue=maxValue),[currentValue,this.checkHandlePosition(currentValue)]}setValue(){if(!isNullOrUndefined(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1),this.setAriaAttributes(this.firstHandle),this.handleVal1=isNullOrUndefined(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,this.activeHandle=isNullOrUndefined(this.activeHandle)?"Range"===this.type?2:1:this.activeHandle,"Default"===this.type||"MinRange"===this.type){if(this.limits.enabled){let values=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=values[0],this.handlePos1=values[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed")}else this.validateRangeValue();"Default"!==this.type&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()}rangeValueUpdate(){null!==this.value&&"object"==typeof this.value||(this.value=[parseFloat(formatUnit(this.min)),parseFloat(formatUnit(this.max))])}validateRangeValue(){this.rangeValueUpdate(),this.setRangeValue()}modifyZindex(){"Range"===this.type?1===this.activeHandle?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+""):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+""):this.isMaterialTooltip&&this.tooltipElement&&(this.tooltipElement.style.zIndex=this.zIndex+4+"")}setHandlePosition(){let handle,pos=1===this.activeHandle?this.handlePos1:this.handlePos2;handle=this.isMaterialTooltip?[this.firstHandle,this.materialHandle]:[this.getHandle()],this.handleStart(),handle.forEach(handle=>{"Horizontal"===this.orientation?this.enableRtl?handle.style.right=`${pos}px`:handle.style.left=`${pos}px`:handle.style.bottom=`${pos}px`}),this.changeEvent("change")}getHandle(){return 1===this.activeHandle?this.firstHandle:this.secondHandle}setRangeValue(){this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(),this.activeHandle=2,this.setHandlePosition(),this.activeHandle=1}changeEvent(eventName){let previous="change"===eventName?this.previousVal:this.previousChanged;if("Range"!==this.type)this.setProperties({value:this.handleVal1},!0),previous!==this.value&&(this.trigger(eventName,this.changeEventArgs(eventName)),this.setPreviousVal(eventName,this.value)),this.setAriaAttrValue(this.firstHandle);else{let value=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:value},!0),(previous.length===this.value.length&&this.value[0]!==previous[0]||this.value[1]!==previous[1])&&(this.trigger(eventName,this.changeEventArgs(eventName)),this.setPreviousVal(eventName,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()}changeEventArgs(eventName){let eventArgs;return this.tooltip.isVisible&&this.tooltipObj?(this.tooltipValue(),eventArgs={value:this.value,previousValue:"change"===eventName?this.previousVal:this.previousChanged,action:eventName,text:this.tooltipObj.content}):eventArgs={value:this.value,previousValue:"change"===eventName?this.previousVal:this.previousChanged,action:eventName,text:isNullOrUndefined(this.ticksFormatInfo.format)?this.value.toString():"Range"!==this.type?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString},eventArgs}setPreviousVal(eventName,value){"change"===eventName?this.previousVal=value:this.previousChanged=value}updateRangeValue(){let values=this.value.toString().split(",").map(Number);if(this.value=this.enableRtl&&"Vertical"!==this.orientation||this.rtl?[values[1],values[0]]:[values[0],values[1]],this.enableRtl&&"Vertical"!==this.orientation?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;let values=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=values[0],this.handlePos1=values[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,values=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=values[0],this.handlePos2=values[1],this.preHandlePos2=this.handlePos2}}checkHandlePosition(value){let pos;return value=100*(value-parseFloat(formatUnit(this.min)))/(parseFloat(formatUnit(this.max))-parseFloat(formatUnit(this.min))),pos="Horizontal"===this.orientation?this.element.getBoundingClientRect().width*(value/100):this.element.getBoundingClientRect().height*(value/100),parseFloat(formatUnit(this.max))===parseFloat(formatUnit(this.min))&&(pos="Horizontal"===this.orientation?this.element.getBoundingClientRect().width:this.element.getBoundingClientRect().height),pos}checkHandleValue(value){if(this.min>this.max&&(this.min=this.max),this.min===this.max)return parseFloat(formatUnit(this.max));let handle=this.tempStartEnd();return value<handle.start?value=handle.start:value>handle.end&&(value=handle.end),value}reposition(){this.firstHandle.style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),"Range"===this.type&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),"Horizontal"===this.orientation?(this.enableRtl?this.firstHandle.style.right=`${this.handlePos1}px`:this.firstHandle.style.left=`${this.handlePos1}px`,this.isMaterialTooltip&&(this.enableRtl?this.materialHandle.style.right=`${this.handlePos1}px`:this.materialHandle.style.left=`${this.handlePos1}px`),"MinRange"===this.type?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",setStyleAttribute(this.rangeBar,{width:isNullOrUndefined(this.handlePos1)?0:this.handlePos1+"px"})):"Range"===this.type&&(this.enableRtl?this.secondHandle.style.right=`${this.handlePos2}px`:this.secondHandle.style.left=`${this.handlePos2}px`,this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",setStyleAttribute(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=`${this.handlePos1}px`,this.isMaterialTooltip&&(this.materialHandle.style.bottom=`${this.handlePos1}px`),"MinRange"===this.type?(this.rangeBar.style.bottom="0px",setStyleAttribute(this.rangeBar,{height:isNullOrUndefined(this.handlePos1)?0:this.handlePos1+"px"})):"Range"===this.type&&(this.secondHandle.style.bottom=`${this.handlePos2}px`,this.rangeBar.style.bottom=this.handlePos1+"px",setStyleAttribute(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),"None"!==this.ticks.placement&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.handleStart(),this.tooltip.isVisible||setTimeout(()=>{this.firstHandle.style.transition=this.scaleTransform,"Range"===this.type&&(this.secondHandle.style.transition=this.scaleTransform)}),this.refreshTooltip(this.tooltipTarget)}changeHandleValue(value){let position=null;1===this.activeHandle?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(value),this.handlePos1=this.checkHandlePosition(this.handleVal1),"Range"===this.type&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(position=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(value),this.handlePos2=this.checkHandlePosition(this.handleVal2),"Range"===this.type&&this.handlePos2<this.handlePos1&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(position=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),null!==position&&("Default"!==this.type&&this.setRangeBar(),this.setHandlePosition())}tempStartEnd(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}}xyToPosition(position){if(this.min===this.max)return 100;if("Horizontal"===this.orientation){let left=position.x-this.element.getBoundingClientRect().left;this.val=left/(this.element.offsetWidth/100)}else{let top=position.y-this.element.getBoundingClientRect().top;this.val=100-top/(this.element.offsetHeight/100)}let val=this.stepValueCalculation(this.val);return val<0?val=0:val>100&&(val=100),this.enableRtl&&"Vertical"!==this.orientation&&(val=100-val),"Horizontal"===this.orientation?this.element.getBoundingClientRect().width*(val/100):this.element.getBoundingClientRect().height*(val/100)}stepValueCalculation(value){0===this.step&&(this.step=1);let percentStep=parseFloat(formatUnit(this.step))/((parseFloat(formatUnit(this.max))-parseFloat(formatUnit(this.min)))/100),remain=value%Math.abs(percentStep);return 0!==remain&&(percentStep/2>remain?value-=remain:value+=Math.abs(percentStep)-remain),value}add(a,b,addition){let x=Math.pow(10,3);return addition?(Math.round(a*x)+Math.round(b*x))/x:(Math.round(a*x)-Math.round(b*x))/x}positionToValue(pos){let val,diff=parseFloat(formatUnit(this.max))-parseFloat(formatUnit(this.min));return val="Horizontal"===this.orientation?pos/this.element.getBoundingClientRect().width*diff:pos/this.element.getBoundingClientRect().height*diff,this.add(val,parseFloat(this.min.toString()),!0)}sliderBarClick(evt){let pos;evt.preventDefault(),"mousedown"===evt.type||"click"===evt.type?pos={x:evt.clientX,y:evt.clientY}:"touchstart"===evt.type&&(pos={x:evt.changedTouches[0].clientX,y:evt.changedTouches[0].clientY});let handlepos=this.xyToPosition(pos),handleVal=this.positionToValue(handlepos);if("Range"===this.type&&this.handlePos2-handlepos<handlepos-this.handlePos1){if(this.activeHandle=2,!this.limits.enabled||!this.limits.endHandleFixed){if(this.limits.enabled){let value=this.getLimitValueAndPosition(handleVal,this.limits.maxStart,this.limits.maxEnd);handleVal=value[0],handlepos=value[1]}this.secondHandle.classList.add("e-handle-active"),this.handlePos2=this.preHandlePos2=handlepos,this.handleVal2=handleVal}this.modifyZindex(),this.secondHandle.focus()}else{if(this.activeHandle=1,!this.limits.enabled||!this.limits.startHandleFixed){if(this.limits.enabled){let value=this.getLimitValueAndPosition(handleVal,this.limits.minStart,this.limits.minEnd);handleVal=value[0],handlepos=value[1]}this.firstHandle.classList.add("e-handle-active"),this.handlePos1=this.preHandlePos1=handlepos,this.handleVal1=handleVal}this.modifyZindex(),this.firstHandle.focus()}this.isMaterialTooltip&&this.tooltipElement.classList.add("e-tooltip-active");let focusedElement=this.element.querySelector(".e-tab-handle");if(focusedElement&&this.getHandle()!==focusedElement&&focusedElement.classList.remove("e-tab-handle"),evt.target===(1===this.activeHandle?this.firstHandle:this.secondHandle))return!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains("e-tab-handle")||this.materialChange(),void this.tooltipToggle(this.getHandle());if(!this.checkRepeatedValue(handleVal))return;let transition=this.isMaterial&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=transition.handle,"Default"!==this.type&&(this.rangeBar.style.transition=transition.rangeBar),this.setHandlePosition(),"Default"!==this.type&&this.setRangeBar()}sliderDown(event){if(event.preventDefault(),this.focusSliderElement(),"Range"===this.type&&this.drag&&event.target===this.rangeBar){let xPostion,yPostion;"mousedown"===event.type?[xPostion,yPostion]=[event.clientX,event.clientY]:"touchstart"===event.type&&([xPostion,yPostion]=[event.changedTouches[0].clientX,event.changedTouches[0].clientY]),"Horizontal"===this.orientation?(this.firstPartRemain=xPostion-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-xPostion):(this.firstPartRemain=yPostion-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-yPostion),this.minDiff=this.handleVal2-this.handleVal1,this.tooltipToggle(this.rangeBar);let focusedElement=this.element.querySelector(".e-tab-handle");focusedElement&&focusedElement.classList.remove("e-tab-handle"),EventHandler.add(document,"mousemove touchmove",this.dragRangeBarMove,this),EventHandler.add(document,"mouseup touchend",this.dragRangeBarUp,this)}else this.sliderBarClick(event),EventHandler.add(document,"mousemove touchmove",this.sliderBarMove,this),EventHandler.add(document,"mouseup touchend",this.sliderBarUp,this)}handleValueAdjust(handleValue,assignValue,handleNumber){1===handleNumber?(this.handleVal1=assignValue,this.handleVal2=this.handleVal1+this.minDiff):2===handleNumber&&(this.handleVal2=assignValue,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)}dragRangeBarMove(event){let pos,xPostion,yPostion;if("touchmove"!==event.type&&event.preventDefault(),this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none",[xPostion,yPostion]="mousemove"===event.type?[event.clientX,event.clientY]:[event.changedTouches[0].clientX,event.changedTouches[0].clientY],!(this.limits.enabled&&this.limits.startHandleFixed||this.limits.enabled&&this.limits.endHandleFixed)){if(this.handlePos1=this.xyToPosition(pos=this.enableRtl?{x:xPostion+this.secondPartRemain,y:yPostion+this.secondPartRemain}:{x:xPostion-this.firstPartRemain,y:yPostion+this.secondPartRemain}),this.handleVal1=this.positionToValue(this.handlePos1),this.handlePos2=this.xyToPosition(pos=this.enableRtl?{x:xPostion-this.firstPartRemain,y:yPostion-this.firstPartRemain}:{x:xPostion+this.secondPartRemain,y:yPostion-this.firstPartRemain}),this.handleVal2=this.positionToValue(this.handlePos2),this.limits.enabled){let value=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=value[0],this.handlePos1=value[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),value=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=value[0],this.handlePos2=value[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===this.max&&this.handleValueAdjust(this.handleVal2,this.max,2),this.handleVal1===this.min&&this.handleValueAdjust(this.handleVal1,this.min,1)}this.activeHandle=1,this.setHandlePosition(),this.activeHandle=2,this.setHandlePosition(),this.tooltipToggle(this.rangeBar),this.setRangeBar()}sliderBarUp(){this.changeEvent("changed"),this.handleFocusOut(),this.firstHandle.classList.remove("e-handle-active"),"Range"===this.type&&this.secondHandle.classList.remove("e-handle-active"),this.closeTooltip(),this.isMaterial&&(this.getHandle().classList.remove("e-large-thumb-size"),this.isMaterialTooltip&&this.tooltipElement.classList.remove("e-tooltip-active")),EventHandler.remove(document,"mousemove touchmove",this.sliderBarMove),EventHandler.remove(document,"mouseup touchend",this.sliderBarUp)}sliderBarMove(evt){let pos;"touchmove"!==evt.type&&evt.preventDefault();let handlepos=this.xyToPosition(pos="mousemove"===evt.type?{x:evt.clientX,y:evt.clientY}:{x:evt.changedTouches[0].clientX,y:evt.changedTouches[0].clientY}),handleVal=this.positionToValue(handlepos);if(handlepos=Math.round(handlepos),"Range"!==this.type&&1===this.activeHandle){if(!this.limits.enabled||!this.limits.startHandleFixed){if(this.limits.enabled){let valueAndPostion=this.getLimitValueAndPosition(handleVal,this.limits.minStart,this.limits.minEnd);handlepos=valueAndPostion[1],handleVal=valueAndPostion[0]}this.handlePos1=handlepos,this.handleVal1=handleVal}this.firstHandle.classList.add("e-handle-active")}if("Range"===this.type)if(1===this.activeHandle){if(this.firstHandle.classList.add("e-handle-active"),!(this.limits.enabled&&this.limits.startHandleFixed||(handlepos>this.handlePos2&&(handlepos=this.handlePos2,handleVal=this.handleVal2),handlepos===this.preHandlePos1))){if(this.limits.enabled){let value=this.getLimitValueAndPosition(handleVal,this.limits.minStart,this.limits.minEnd);handleVal=value[0],handlepos=value[1]}this.handlePos1=this.preHandlePos1=handlepos,this.handleVal1=handleVal,this.activeHandle=1}}else if(2===this.activeHandle&&(this.secondHandle.classList.add("e-handle-active"),!(this.limits.enabled&&this.limits.endHandleFixed||(handlepos<this.handlePos1&&(handlepos=this.handlePos1,handleVal=this.handleVal1),handlepos===this.preHandlePos2)))){if(this.limits.enabled){let value=this.getLimitValueAndPosition(handleVal,this.limits.maxStart,this.limits.maxEnd);handleVal=value[0],handlepos=value[1]}this.handlePos2=this.preHandlePos2=handlepos,this.handleVal2=handleVal,this.activeHandle=2}this.checkRepeatedValue(handleVal)&&(this.getHandle().style.transition=this.scaleTransform,"Default"!==this.type&&(this.rangeBar.style.transition="none"),this.setHandlePosition(),!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains("e-tab-handle")||this.materialChange(),this.tooltipToggle(this.getHandle()),"Default"!==this.type&&this.setRangeBar())}dragRangeBarUp(event){this.changeEvent("changed"),this.closeTooltip(),EventHandler.remove(document,"mousemove touchmove",this.dragRangeBarMove),EventHandler.remove(document,"mouseup touchend",this.dragRangeBarUp)}checkRepeatedValue(currentValue){if("Range"===this.type){if(currentValue===(this.enableRtl&&"Vertical"!==this.orientation?1===this.activeHandle?this.previousVal[1]:this.previousVal[0]:1===this.activeHandle?this.previousVal[0]:this.previousVal[1]))return 0}else if(currentValue===this.previousVal)return 0;return 1}refreshTooltip(target){this.tooltip.isVisible&&this.tooltipObj&&(this.tooltipValue(),target&&(this.tooltipObj.refresh(target),this.tooltipTarget=target))}openTooltip(target){this.tooltip.isVisible&&this.tooltipObj&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.open(target),this.tooltipTarget=target)}closeTooltip(){this.tooltip.isVisible&&this.tooltipObj&&"Always"!==this.tooltip.showOn&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.close(),this.tooltipTarget=void 0)}keyDown(event){switch(event.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:event.preventDefault(),this.buttonClick(event)}}wireButtonEvt(destroy){destroy?(EventHandler.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),EventHandler.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),EventHandler.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),EventHandler.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),EventHandler.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),EventHandler.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),EventHandler.remove(this.firstBtn,"focusout",this.sliderFocusOut),EventHandler.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(EventHandler.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),EventHandler.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),EventHandler.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),EventHandler.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),EventHandler.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),EventHandler.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),EventHandler.add(this.firstBtn,"focusout",this.sliderFocusOut,this),EventHandler.add(this.secondBtn,"focusout",this.sliderFocusOut,this))}wireEvents(){this.onresize=this.reposition.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(EventHandler.add(this.element,"mousedown touchstart",this.sliderDown,this),EventHandler.add(this.sliderContainer,"keydown",this.keyDown,this),EventHandler.add(this.sliderContainer,"keyup",this.keyUp,this),EventHandler.add(this.element,"focusout",this.sliderFocusOut,this),EventHandler.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),"Range"===this.type&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1),this.isForm&&EventHandler.add(this.formElement,"reset",this.formResetHandler,this))}unwireEvents(){EventHandler.remove(this.element,"mousedown touchstart",this.sliderDown),EventHandler.remove(this.sliderContainer,"keydown",this.keyDown),EventHandler.remove(this.sliderContainer,"keyup",this.keyUp),EventHandler.remove(this.element,"focusout",this.sliderFocusOut),EventHandler.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),"Range"===this.type&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0),EventHandler.remove(this.element,"reset",this.formResetHandler)}formResetHandler(){this.setProperties({value:this.formResetValue},!0),this.setValue()}keyUp(event){if(9===event.keyCode&&event.target.classList.contains("e-handle")&&(this.focusSliderElement(),!event.target.classList.contains("e-tab-handle"))){this.element.querySelector(".e-tab-handle")&&this.element.querySelector(".e-tab-handle").classList.remove("e-tab-handle"),event.target.classList.add("e-tab-handle");let parentElement=event.target.parentElement;parentElement===this.element&&(parentElement.querySelector(".e-slider-track").classList.add("e-tab-track"),"Range"!==this.type&&"MinRange"!==this.type||parentElement.querySelector(".e-range").classList.add("e-tab-range")),"Range"===this.type&&(this.activeHandle=event.target.previousSibling.classList.contains("e-handle")?2:1),this.getHandle().focus(),this.tooltipToggle(this.getHandle())}this.closeTooltip(),this.changeEvent("changed")}hover(event){isNullOrUndefined(event)||("mouseover"===event.type||"touchmove"===event.type||"mousemove"===event.type||"pointermove"===event.type||"touchstart"===event.type?this.sliderContainer.classList.add("e-slider-hover"):this.sliderContainer.classList.remove("e-slider-hover"))}sliderFocusOut(event){event.relatedTarget!==this.secondHandle&&event.relatedTarget!==this.firstHandle&&event.relatedTarget!==this.element&&event.relatedTarget!==this.firstBtn&&event.relatedTarget!==this.secondBtn&&(this.closeMaterialTooltip(),this.element.querySelector(".e-tab-handle")&&this.element.querySelector(".e-tab-handle").classList.remove("e-tab-handle"),this.element.querySelector(".e-tab-track")&&(this.element.querySelector(".e-tab-track").classList.remove("e-tab-track"),"Range"!==this.type&&"MinRange"!==this.type||!this.element.querySelector(".e-tab-range")||this.element.querySelector(".e-tab-range").classList.remove("e-tab-range")),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1)}removeElement(element){element.parentNode&&element.parentNode.removeChild(element)}changeSliderType(type){this.isMaterialTooltip&&this.materialHandle&&(this.sliderContainer.classList.remove("e-material-slider"),this.removeElement(this.materialHandle),this.materialHandle=void 0),this.removeElement(this.firstHandle),this.firstHandle=void 0,"Default"!==type&&("Range"===type&&(this.removeElement(this.secondHandle),this.secondHandle=void 0),this.removeElement(this.rangeBar),this.rangeBar=void 0),this.tooltip.isVisible&&!isNullOrUndefined(this.tooltipObj)&&(this.tooltipObj.destroy(),this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0),this.limits.enabled&&("MinRange"===type||"Default"===type?isNullOrUndefined(this.limitBarFirst)||(this.removeElement(this.limitBarFirst),this.limitBarFirst=void 0):isNullOrUndefined(this.limitBarSecond)||(this.removeElement(this.limitBarSecond),this.limitBarSecond=void 0)),this.activeHandle=1,this.getThemeInitialization(),"Range"===this.type&&this.rangeValueUpdate(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!1),"Range"===this.type&&this.wireSecondHandleEvt(!1),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.updateConfig()}changeRtl(){if(this.enableRtl||"Range"!==this.type||(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&this.tooltipObj.refresh(this.firstHandle),this.showButtons){let enabledRTL=this.enableRtl&&"Vertical"!==this.orientation;attributes(enabledRTL?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),attributes(enabledRTL?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}}changeOrientation(){this.changeSliderType(this.type)}updateConfig(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(this.tooltipTarget),"None"!==this.ticks.placement&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.limitsPropertyChange()}limitsPropertyChange(){this.limits.enabled?(isNullOrUndefined(this.limitBarFirst)&&"Range"!==this.type&&this.createLimitBar(),isNullOrUndefined(this.limitBarFirst)&&isNullOrUndefined(this.limitBarSecond)&&"Range"===this.type&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(isNullOrUndefined(this.limitBarFirst)||detach(this.limitBarFirst),isNullOrUndefined(this.limitBarSecond)||detach(this.limitBarSecond))}getPersistData(){return this.addOnPersist(["value"])}destroy(){super.destroy(),this.unwireEvents(),window.removeEventListener("resize",this.onresize),removeClass([this.sliderContainer],["e-disabled"]),this.firstHandle.removeAttribute("aria-orientation"),"Range"===this.type&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),detach(this.sliderContainer),this.tooltip.isVisible&&this.tooltipObj.destroy(),this.element.innerHTML=""}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"cssClass":this.setCSSClass(oldProp.cssClass);break;case"value":if(newProp&&oldProp){let value=isNullOrUndefined(newProp.value)?"Range"===this.type?[this.min,this.max]:this.min:newProp.value;this.setProperties({value:value},!0),isNullOrUndefined(oldProp.value)||oldProp.value.toString()===value.toString()||(this.setValue(),this.refreshTooltip(this.tooltipTarget),"Range"===this.type&&(this.activeHandle=isNullOrUndefined(newProp.value)||oldProp.value[1]===value[1]?1:2))}break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":isNullOrUndefined(newProp.tooltip)||isNullOrUndefined(oldProp.tooltip)||this.setTooltip();break;case"type":isNullOrUndefined(oldProp)||!Object.keys(oldProp).length||isNullOrUndefined(oldProp.type)||(this.changeSliderType(oldProp.type),this.setZindex());break;case"enableRtl":oldProp.enableRtl!==newProp.enableRtl&&"Vertical"!==this.orientation&&(this.rtl=oldProp.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":isNullOrUndefined(this.sliderContainer.querySelector(".e-scale"))||(detach(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,className=>{className.match(/e-scale-/)&&this.sliderContainer.classList.remove(className)})),"None"!==this.ticks.placement&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":newProp.showButtons?(this.setButtons(),this.reposition(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.sliderContainer.classList.remove("e-slider-btn"),this.firstBtn=void 0,this.secondBtn=void 0);break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValues":this.setValue(),this.reposition()}}setReadOnly(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add("e-read-only")):(this.wireEvents(),this.sliderContainer.classList.remove("e-read-only"))}setMinMaxValue(){this.setValue(),this.refreshTooltip(this.tooltipTarget),isNullOrUndefined(this.sliderContainer.querySelector(".e-scale"))||this.ul&&(detach(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,className=>{className.match(/e-scale-/)&&this.sliderContainer.classList.remove(className)})),"None"!==this.ticks.placement&&(this.renderScale(),this.setZindex())}setZindex(){this.zIndex=6,isNullOrUndefined(this.ticks)||"None"===this.ticks.placement||(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),this.isMaterial||isNullOrUndefined(this.ticks)||"Both"!==this.ticks.placement||(this.element.style.zIndex=this.zIndex+2+""),this.firstHandle.style.zIndex=this.zIndex+3+"","Range"===this.type&&(this.secondHandle.style.zIndex=this.zIndex+4+"")}setTooltip(){this.changeSliderType(this.type)}getModuleName(){return"slider"}};return __decorate([Property(null)],Slider.prototype,"value",void 0),__decorate([Property(null)],Slider.prototype,"customValues",void 0),__decorate([Property(1)],Slider.prototype,"step",void 0),__decorate([Property(0)],Slider.prototype,"min",void 0),__decorate([Property(100)],Slider.prototype,"max",void 0),__decorate([Property(!1)],Slider.prototype,"readonly",void 0),__decorate([Property("Default")],Slider.prototype,"type",void 0),__decorate([Complex({},ej2_inputs_es2015_TicksData)],Slider.prototype,"ticks",void 0),__decorate([Complex({},ej2_inputs_es2015_LimitData)],Slider.prototype,"limits",void 0),__decorate([Property(!0)],Slider.prototype,"enabled",void 0),__decorate([Complex({},ej2_inputs_es2015_TooltipData)],Slider.prototype,"tooltip",void 0),__decorate([Property(!1)],Slider.prototype,"showButtons",void 0),__decorate([Property(!0)],Slider.prototype,"enableAnimation",void 0),__decorate([Property("Horizontal")],Slider.prototype,"orientation",void 0),__decorate([Property("")],Slider.prototype,"cssClass",void 0),__decorate([ej2_base_es2015_Event()],Slider.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],Slider.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],Slider.prototype,"changed",void 0),__decorate([ej2_base_es2015_Event()],Slider.prototype,"renderingTicks",void 0),__decorate([ej2_base_es2015_Event()],Slider.prototype,"renderedTicks",void 0),__decorate([ej2_base_es2015_Event()],Slider.prototype,"tooltipChange",void 0),__decorate([NotifyPropertyChanges],Slider)})();var FormValidator_1;let ej2_inputs_es2015_regex={EMAIL:new RegExp("^[A-Za-z0-9._%+-]{1,}@[A-Za-z0-9._%+-]{1,}([.]{1}[a-zA-Z0-9]{2,5}|[.]{1}[a-zA-Z0-9]{2,4}[.]{1}[a-zA-Z0-9]{2,4})$"),URL:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:\/?#[\]@!\$&'\(\)\*\+,;=.]+$/m,DATE_ISO:new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),DIGITS:new RegExp("^[0-9]*$"),PHONE:new RegExp("^[+]?[0-9]{9,13}$"),CREDITCARD:new RegExp("^\\d{13,16}$")};var ErrorOption=function(ErrorOption){return ErrorOption[ErrorOption.Message=0]="Message",ErrorOption[ErrorOption.Label=1]="Label",ErrorOption}({});let ej2_inputs_es2015_FormValidator=(()=>{let FormValidator=FormValidator_1=class extends Base{constructor(element,options){super(options,element),this.validated=[],this.errorRules=[],this.allowSubmit=!1,this.required="required",this.infoElement=null,this.inputElement=null,this.selectQuery="input:not([type=reset]):not([type=button]), select, textarea",this.localyMessage={},this.defaultMessages={required:"This field is required.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateIso:"Please enter a valid date ( ISO ).",creditcard:"Please enter valid card number",number:"Please enter a valid number.",digits:"Please enter only digits.",maxLength:"Please enter no more than {0} characters.",minLength:"Please enter at least {0} characters.",rangeLength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}.",regex:"Please enter a correct value.",tel:"Please enter a valid phone number.",pattern:"Please enter a correct pattern value.",equalTo:"Please enter the valid match text"},void 0===this.rules&&(this.rules={}),this.l10n=new L10n("formValidator",this.defaultMessages,this.locale),this.locale&&this.localeFunc(),onIntlChange.on("notifyExternalChange",this.afterLocalization,this),element="string"==typeof element?ej2_base_es2015_select(element,document):element,null!=this.element&&(this.element.setAttribute("novalidate",""),this.inputElements=ej2_base_es2015_selectAll(this.selectQuery,this.element),this.createHTML5Rules(),this.wireEvents())}addRules(name,rules){name&&(this.rules.hasOwnProperty(name)?extend(this.rules[name],rules,{}):this.rules[name]=rules)}removeRules(name,rules){if(name||rules)if(this.rules[name]&&!rules)delete this.rules[name];else{if(isNullOrUndefined(this.rules[name]&&rules))return;for(let i=0;i<rules.length;i++)delete this.rules[name][rules[i]]}else this.rules={}}validate(selected){let rules=Object.keys(this.rules);if(selected&&rules.length)return this.validateRules(selected),-1!==rules.indexOf(selected)&&0===this.errorRules.filter(data=>data.name===selected).length;this.errorRules=[];for(let name of rules)this.validateRules(name);return 0===this.errorRules.length}reset(){this.element.reset(),this.clearForm()}getInputElement(name){return this.inputElement=ej2_base_es2015_select('[name="'+name+'"]',this.element),this.inputElement}destroy(){this.reset(),this.unwireEvents(),this.rules={};let elements=ej2_base_es2015_selectAll("."+this.errorClass+", ."+this.validClass,this.element);for(let element of elements)element.remove();super.destroy(),onIntlChange.off("notifyExternalChange",this.afterLocalization)}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"locale":this.localeFunc()}}localeFunc(){for(let key of Object.keys(this.defaultMessages)){this.l10n.setLocale(this.locale);let value=this.l10n.getConstant(key);this.localyMessage[key]=value}}getModuleName(){return"formValidator"}afterLocalization(args){this.locale=args.locale,this.localeFunc()}clearForm(){this.errorRules=[],this.validated=[];let elements=ej2_base_es2015_selectAll(this.selectQuery,this.element);for(let element of elements){let input=element;input.removeAttribute("aria-invalid"),input.classList.remove(this.errorClass),input.name.length>0&&(this.getInputElement(input.name),this.getErrorElement(input.name),this.hideMessage(input.name)),input.classList.remove(this.validClass)}}createHTML5Rules(){let defRules=["required","validateHidden","regex","rangeLength","maxLength","minLength","dateIso","digits","pattern","data-val-required","type","data-validation","min","max","range","equalTo","data-val-minlength-min","data-val-equalto-other","data-val-maxlength-max","data-val-range-min","data-val-regex-pattern","data-val-length-max","data-val-creditcard","data-val-phone"],acceptedTypes=["hidden","email","url","date","number","tel"];for(let input of this.inputElements){let allRule={};for(let rule of defRules)if(null!==input.getAttribute(rule))switch(rule){case"required":this.defRule(input,allRule,rule,input.required);break;case"data-validation":rule=input.getAttribute(rule),this.defRule(input,allRule,rule,!0);break;case"type":-1!==acceptedTypes.indexOf(input.type)&&this.defRule(input,allRule,input.type,!0);break;case"rangeLength":case"range":this.defRule(input,allRule,rule,JSON.parse(input.getAttribute(rule)));break;case"equalTo":let id=input.getAttribute(rule);this.defRule(input,allRule,rule,id);break;default:"true"===input.getAttribute("data-val")?this.annotationRule(input,allRule,rule,input.getAttribute(rule)):this.defRule(input,allRule,rule,input.getAttribute(rule))}0!==Object.keys(allRule).length&&this.addRules(input.name,allRule)}}annotationRule(input,ruleCon,ruleName,value){let annotationRule=ruleName.split("-"),rulesList=["required","creditcard","phone","maxlength","minlength","range","regex","equalto"],ruleFirstName=annotationRule[annotationRule.length-1],ruleSecondName=annotationRule[annotationRule.length-2];if(-1!==rulesList.indexOf(ruleFirstName))switch(ruleFirstName){case"required":this.defRule(input,ruleCon,"required",value);break;case"creditcard":this.defRule(input,ruleCon,"creditcard",value);break;case"phone":this.defRule(input,ruleCon,"tel",value)}else if(-1!==rulesList.indexOf(ruleSecondName))switch(ruleSecondName){case"maxlength":this.defRule(input,ruleCon,"maxLength",value);break;case"minlength":this.defRule(input,ruleCon,"minLength",value);break;case"range":let minvalue=input.getAttribute("data-val-range-min"),maxvalue=input.getAttribute("data-val-range-max");this.defRule(input,ruleCon,"range",[minvalue,maxvalue]);break;case"equalto":let id=input.getAttribute(ruleName).split(".");this.defRule(input,ruleCon,"equalTo",id[id.length-1]);break;case"regex":this.defRule(input,ruleCon,"regex",value)}}defRule(input,ruleCon,ruleName,value){let customMessage,message=input.getAttribute("data-"+ruleName+"-message"),annotationMessage=input.getAttribute("data-val-"+ruleName);this.rules[input.name]&&"validateHidden"!==ruleName&&"hidden"!==ruleName&&(this.getInputElement(input.name),customMessage=this.getErrorMessage(this.rules[input.name][ruleName],ruleName)),message?value=[value,message]:annotationMessage?value=[value,annotationMessage]:customMessage&&(value=[value,customMessage]),ruleCon[ruleName]=value}wireEvents(){for(let input of this.inputElements)FormValidator_1.isCheckable(input)?EventHandler.add(input,"click",this.clickHandler,this):"SELECT"===input.tagName?EventHandler.add(input,"change",this.changeHandler,this):(EventHandler.add(input,"focusout",this.focusOutHandler,this),EventHandler.add(input,"keyup",this.keyUpHandler,this));EventHandler.add(this.element,"submit",this.submitHandler,this),EventHandler.add(this.element,"reset",this.resetHandler,this)}unwireEvents(){for(let input of this.inputElements)EventHandler.clearEvents(input);EventHandler.remove(this.element,"submit",this.submitHandler),EventHandler.remove(this.element,"reset",this.resetHandler)}focusOutHandler(e){this.trigger("focusout",e);let element=e.target;this.rules[element.name]&&(this.rules[element.name][this.required]||element.value.length>0?this.validate(element.name):-1===this.validated.indexOf(element.name)&&this.validated.push(element.name))}keyUpHandler(e){this.trigger("keyup",e);let element=e.target;(9!==e.which||this.rules[element.name]&&(!this.rules[element.name]||this.rules[element.name][this.required]))&&-1!==this.validated.indexOf(element.name)&&this.rules[element.name]&&-1===[16,17,18,20,35,36,37,38,39,40,45,144,225].indexOf(e.which)&&this.validate(element.name)}clickHandler(e){this.trigger("click",e);let element=e.target;"submit"!==element.type?this.validate(element.name):null!==element.getAttribute("formnovalidate")&&(this.allowSubmit=!0)}changeHandler(e){this.trigger("change",e),this.validate(e.target.name)}submitHandler(e){this.trigger("submit",e),this.allowSubmit||this.validate()?this.allowSubmit=!1:e.preventDefault()}resetHandler(){this.clearForm()}validateRules(name){if(!this.rules[name])return;let rules=Object.keys(this.rules[name]),hiddenType=!1,validateHiddenType=!1,vhPos=rules.indexOf("validateHidden"),hPos=rules.indexOf("hidden");if(this.getInputElement(name),-1!==hPos&&(hiddenType=!0),-1!==vhPos&&(validateHiddenType=!0),!hiddenType||hiddenType&&validateHiddenType){-1!==vhPos&&rules.splice(vhPos,1),-1!==hPos&&rules.splice(hPos-1,1),this.getErrorElement(name);for(let rule of rules){let errorMessage=this.getErrorMessage(this.rules[name][rule],rule),errorRule={name:name,message:errorMessage},eventArgs={inputName:name,element:this.inputElement,message:errorMessage};if(!this.isValid(name,rule)&&!this.inputElement.classList.contains(this.ignore)){this.removeErrorRules(name),this.errorRules.push(errorRule),this.inputElement.setAttribute("aria-invalid","true"),this.inputElement.setAttribute("aria-describedby",this.inputElement.id+"-info"),this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.infoElement?this.showMessage(errorRule):this.createErrorElement(name,errorRule.message,this.inputElement),eventArgs.errorElement=this.infoElement,eventArgs.status="failure",this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.optionalValidationStatus(name,eventArgs),this.trigger("validationComplete",eventArgs),"required"===rule&&this.inputElement.setAttribute("aria-required","true");break}this.hideMessage(name),eventArgs.status="success",this.trigger("validationComplete",eventArgs)}}}optionalValidationStatus(name,refer){this.rules[name][this.required]||this.inputElement.value.length||isNullOrUndefined(this.infoElement)||(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),refer.status="",this.hideMessage(name))}isValid(name,rule){let params=this.rules[name][rule],param=params instanceof Array&&"string"==typeof params[1]?params[0]:params,currentRule=this.rules[name][rule],args={value:this.inputElement.value,param:param,element:this.inputElement,formElement:this.element};return this.trigger("validationBegin",args),currentRule&&"function"==typeof currentRule[0]?currentRule[0].call(this,{element:this.inputElement,value:this.inputElement.value}):FormValidator_1.isCheckable(this.inputElement)?"required"!==rule||ej2_base_es2015_selectAll("input[name="+name+"]:checked",this.element).length>0:FormValidator_1.checkValidator[rule](args)}getErrorMessage(ruleValue,rule){let message=this.inputElement.getAttribute("data-"+rule+"-message")?this.inputElement.getAttribute("data-"+rule+"-message"):ruleValue instanceof Array&&"string"==typeof ruleValue[1]?ruleValue[1]:0!==Object.keys(this.localyMessage).length?this.localyMessage[rule]:this.defaultMessages[rule],formats=message.match(/{(\d)}/g);if(!isNullOrUndefined(formats))for(let i=0;i<formats.length;i++){let value=ruleValue instanceof Array?ruleValue[i]:ruleValue;message=message.replace(formats[i],value)}return message}createErrorElement(name,message,input){let errorElement=ej2_base_es2015_createElement(this.errorElement,{className:this.errorClass,innerHTML:message,attrs:{for:name}});if(this.errorOption===ErrorOption.Message&&(errorElement.classList.remove(this.errorClass),errorElement.classList.add("e-message"),errorElement=ej2_base_es2015_createElement(this.errorContainer,{className:this.errorClass,innerHTML:errorElement.outerHTML})),errorElement.id=this.inputElement.name+"-info",this.element.querySelector('[data-valmsg-for="'+input.id+'"]'))this.element.querySelector('[data-valmsg-for="'+input.id+'"]').appendChild(errorElement);else if(!0===input.hasAttribute("data-msg-containerid")){let containerId=input.getAttribute("data-msg-containerid");this.element.querySelector("#"+containerId).appendChild(errorElement)}else null!=this.customPlacement?this.customPlacement.call(this,this.inputElement,errorElement):this.inputElement.parentNode.insertBefore(errorElement,this.inputElement.nextSibling);errorElement.style.display="block",this.getErrorElement(name),this.validated.push(name),this.checkRequired(name)}getErrorElement(name){return this.infoElement=ej2_base_es2015_select(this.errorElement+"."+this.errorClass,this.inputElement.parentElement),this.infoElement||(this.infoElement=ej2_base_es2015_select(this.errorElement+"."+this.errorClass+'[for="'+name+'"]',this.element)),this.infoElement}removeErrorRules(name){for(let i=0;i<this.errorRules.length;i++)this.errorRules[i].name===name&&this.errorRules.splice(i,1)}showMessage(errorRule){this.infoElement.style.display="block",this.infoElement.innerHTML=errorRule.message,this.checkRequired(errorRule.name)}hideMessage(name){this.infoElement&&(this.infoElement.style.display="none",this.removeErrorRules(name),this.inputElement.classList.add(this.validClass),this.inputElement.classList.remove(this.errorClass),this.inputElement.setAttribute("aria-invalid","false"))}checkRequired(name){this.rules[name][this.required]||this.inputElement.value.length||isNullOrUndefined(this.infoElement)||(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),this.hideMessage(name))}static isCheckable(input){let inputType=input.getAttribute("type");return inputType&&("checkbox"===inputType||"radio"===inputType||"submit"===inputType)}};return FormValidator.checkValidator={required:option=>option.value.length>0,email:option=>ej2_inputs_es2015_regex.EMAIL.test(option.value),url:option=>ej2_inputs_es2015_regex.URL.test(option.value),dateIso:option=>ej2_inputs_es2015_regex.DATE_ISO.test(option.value),tel:option=>ej2_inputs_es2015_regex.PHONE.test(option.value),creditcard:option=>ej2_inputs_es2015_regex.CREDITCARD.test(option.value),number:option=>!isNaN(Number(option.value))&&-1===option.value.indexOf(" "),digits:option=>ej2_inputs_es2015_regex.DIGITS.test(option.value),maxLength:option=>option.value.length<=option.param,minLength:option=>option.value.length>=option.param,rangeLength:option=>{let param=option.param;return option.value.length>=param[0]&&option.value.length<=param[1]},range:option=>{let param=option.param;return!isNaN(Number(option.value))&&Number(option.value)>=param[0]&&Number(option.value)<=param[1]},date:option=>!isNaN(new Date(option.value).getTime()),max:option=>isNaN(Number(option.value))?new Date(option.value).getTime()<=new Date(JSON.parse(JSON.stringify(option.param))).getTime():+option.value<=option.param,min:option=>{if(isNaN(Number(option.value))){if(-1!==option.value.indexOf(",")){let uNum=option.value.replace(/,/g,"");return parseFloat(uNum)>=option.param}return new Date(option.value).getTime()>=new Date(JSON.parse(JSON.stringify(option.param))).getTime()}return+option.value>=option.param},regex:option=>new RegExp(option.param).test(option.value),equalTo:option=>{let compareTo=option.formElement.querySelector("#"+option.param);return option.param=compareTo.value,option.param===option.value}},__decorate([Property("")],FormValidator.prototype,"locale",void 0),__decorate([Property("e-hidden")],FormValidator.prototype,"ignore",void 0),__decorate([Property()],FormValidator.prototype,"rules",void 0),__decorate([Property("e-error")],FormValidator.prototype,"errorClass",void 0),__decorate([Property("e-valid")],FormValidator.prototype,"validClass",void 0),__decorate([Property("label")],FormValidator.prototype,"errorElement",void 0),__decorate([Property("div")],FormValidator.prototype,"errorContainer",void 0),__decorate([Property(ErrorOption.Label)],FormValidator.prototype,"errorOption",void 0),__decorate([ej2_base_es2015_Event()],FormValidator.prototype,"focusout",void 0),__decorate([ej2_base_es2015_Event()],FormValidator.prototype,"keyup",void 0),__decorate([ej2_base_es2015_Event()],FormValidator.prototype,"click",void 0),__decorate([ej2_base_es2015_Event()],FormValidator.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],FormValidator.prototype,"submit",void 0),__decorate([ej2_base_es2015_Event()],FormValidator.prototype,"validationBegin",void 0),__decorate([ej2_base_es2015_Event()],FormValidator.prototype,"validationComplete",void 0),__decorate([ej2_base_es2015_Event()],FormValidator.prototype,"customPlacement",void 0),FormValidator_1=__decorate([NotifyPropertyChanges],FormValidator)})();const CTRLSWITCH="e-switch-ctrl-btn",HIDEHEX="e-hide-hex-value",HIDERGBA="e-hide-switchable-value",HIDEVALUE="e-hide-value",HSVAREA="e-hsv-color",INPUTWRAPPER="e-selected-value",MODESWITCH="e-mode-switch-btn",NOCOLOR="e-nocolor-item",OPACITY="e-opacity-value",PREVIEW="e-preview-container",SHOWVALUE="e-show-value",SELECT="e-selected",TILE="e-tile",ej2_inputs_es2015_presets_default=["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"];let ej2_inputs_es2015_ColorPicker=(()=>{let ColorPicker=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}preRender(){let ele=this.element;this.formElement=closest(this.element,"form"),this.formElement&&EventHandler.add(this.formElement,"reset",this.formResetHandler,this),this.l10n=new L10n("colorpicker",{Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode"},this.locale),ele.getAttribute("ejs-for")&&!ele.getAttribute("name")&&ele.setAttribute("name",ele.id)}render(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn(),this.enableOpacity||addClass([this.container.parentElement],"e-hide-opacity"),this.renderComplete()}initWrapper(){let wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(wrapper,this.element),wrapper.appendChild(this.element),attributes(this.element,{tabindex:"-1",spellcheck:"false"}),this.container=this.createElement("div",{className:"e-container"}),this.getWrapper().appendChild(this.container);let value=this.value?this.roundValue(this.value).toLowerCase():"#008000ff",slicedValue=value.slice(0,7);isNullOrUndefined(this.initialInputValue)&&(this.initialInputValue=slicedValue),this.element.value=slicedValue,this.setProperties({value:value},!0),this.enableRtl&&wrapper.classList.add("e-rtl"),this.cssClass&&addClass([wrapper],this.cssClass.split(" ")),this.tileRipple=rippleEffect(this.container,{selector:"."+TILE}),this.ctrlBtnRipple=rippleEffect(this.container,{selector:".e-btn"})}getWrapper(){return this.element.parentElement}createWidget(){"Palette"===this.mode?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus()),this.isRgb=!0,this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),Browser.isDevice&&this.refreshPopupPos()}createSplitBtn(){let splitButton=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(splitButton),this.splitBtn=new ej2_splitbuttons_es2015_SplitButton({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,open:this.onOpen.bind(this),beforeOpen:this.beforeOpenFn.bind(this),beforeClose:this.beforePopupClose.bind(this),click:args=>{this.trigger("change",{currentValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},previousValue:{hex:null,rgba:null},value:this.value})}}),this.splitBtn.createElement=this.createElement,this.splitBtn.appendTo(splitButton);let preview=this.createElement("span",{className:"e-split-preview"});ej2_base_es2015_select(".e-selected-color",splitButton).appendChild(preview),preview.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));let popupEle=this.getPopupEle();if(addClass([popupEle],"e-colorpicker-popup"),this.cssClass&&addClass([popupEle],this.cssClass.split(" ")),Browser.isDevice){let popupInst=this.getPopupInst();popupInst.relateTo=document.body,popupInst.position={X:"center",Y:"center"},popupInst.targetType="container",popupInst.collision={X:"fit",Y:"fit"},popupInst.offsetY=4,popupEle.style.zIndex=getZindexPartial(this.splitBtn.element).toString()}}onOpen(args){this.trigger("open",{element:this.container})}getPopupInst(){return getInstance(this.getPopupEle(),ej2_popups_es2015_Popup)}beforeOpenFn(args){this.trigger("beforeOpen",{element:this.container,event:args.event,cancel:!1},observeOpenArgs=>{if(args.cancel=observeOpenArgs.cancel,!observeOpenArgs.cancel){let popupEle=this.getPopupEle();popupEle.style.top=formatUnit(0+pageYOffset),popupEle.style.left=formatUnit(0+pageXOffset),popupEle.style.display="block",this.createWidget(),popupEle.style.display="",Browser.isDevice&&(this.modal=this.createElement("div"),this.modal.className="e-"+this.getModuleName()+" e-modal",this.modal.style.display="none",document.body.insertBefore(this.modal,popupEle),document.body.className+=" e-colorpicker-overflow",this.modal.style.display="block",this.modal.style.zIndex=(Number(popupEle.style.zIndex)-1).toString())}})}beforePopupClose(args){isNullOrUndefined(args.event)||this.trigger("beforeClose",{element:this.container,event:args.event,cancel:!1},observedCloseArgs=>{Browser.isDevice&&args.event.target===this.modal&&(observedCloseArgs.cancel=!0),args.cancel=observedCloseArgs.cancel,observedCloseArgs.cancel||this.onPopupClose()})}onPopupClose(){this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",ej2_base_es2015_select(".e-split-preview",this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",removeClass([this.container],["e-color-picker","e-color-palette"]),Browser.isDevice&&this.modal&&(removeClass([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)}createPalette(){if(ej2_base_es2015_classList(this.container,["e-color-palette"],["e-color-picker"]),this.presetColors){let paletteGroup=this.createElement("div",{className:"e-custom-palette"});this.appendElement(paletteGroup);let keys=Object.keys(this.presetColors);if(1===keys.length)this.appendPalette(this.presetColors[keys[0]],keys[0],paletteGroup);else for(let i=0,len=keys.length;i<len;i++)this.appendPalette(this.presetColors[keys[i]],keys[i],paletteGroup);ej2_base_es2015_selectAll(".e-row",paletteGroup).length>10&&addClass([paletteGroup],"e-palette-group")}else this.appendPalette(ej2_inputs_es2015_presets_default,"default");"Palette"===this.mode&&!this.modeSwitcher&&this.noColor&&this.setNoColor();let width=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=formatUnit(this.container.children[0].offsetWidth+width+width),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)}firstPaletteFocus(){ej2_base_es2015_select("."+SELECT,this.container.children[0])||ej2_base_es2015_selectAll(".e-palette",this.container)[0].focus()}appendPalette(colors,key,refEle){let row,tile,roundedColor,palette=this.createElement("div",{className:"e-palette",attrs:{tabindex:"0"}});refEle?refEle.appendChild(palette):this.appendElement(palette);for(let i=0,len=colors.length;i<len;i++)0!==i&&i%this.columns!=0||(row=this.createElement("div",{className:"e-row",attrs:{role:"row"}}),palette.appendChild(row)),roundedColor=this.roundValue(colors[i]).toLowerCase(),tile=this.createElement("span",{className:TILE,attrs:{role:"gridcell","aria-label":roundedColor,"aria-selected":"false"}}),this.trigger("beforeTileRender",{element:tile,presetName:key,value:colors[i]}),row.appendChild(tile),this.value===roundedColor&&(this.addTileSelection(tile),palette.focus()),tile.style.backgroundColor=this.convertToRgbString(this.hexToRgb(roundedColor))}setNoColor(){let noColorEle=this.container.querySelector(".e-row").children[0];noColorEle.classList.add(NOCOLOR),this.value||(noColorEle.classList.add(SELECT),closest(noColorEle,".e-palette").focus()),["aria-selected","aria-label"].forEach(attr=>{noColorEle.removeAttribute(attr)}),noColorEle.style.backgroundColor=""}appendElement(ele,insertPos=0){let refEle=this.container.children[insertPos];refEle?this.container.insertBefore(ele,refEle):this.container.appendChild(ele)}addTileSelection(ele){ele.classList.add(SELECT),ele.setAttribute("aria-selected","true")}createPicker(){ej2_base_es2015_classList(this.container,["e-color-picker"],["e-color-palette"]);let hsvContainer=this.createElement("div",{className:"e-hsv-container"});this.appendElement(hsvContainer),hsvContainer.appendChild(this.createElement("div",{className:HSVAREA}));let dragHandler=this.createElement("span",{className:"e-handler",attrs:{tabindex:"0"}});hsvContainer.appendChild(dragHandler),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()}setHsvContainerBg(h=this.hsv[0]){this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(h,100,100,1))}getHsvContainer(){return ej2_base_es2015_select(".e-hsv-container",this.container)}setHandlerPosition(){let dragHandler=this.getDragHandler(),hsvArea=ej2_base_es2015_select("."+HSVAREA,this.container);dragHandler.style.left=formatUnit(this.enableRtl?hsvArea.offsetWidth*Math.abs(100-this.hsv[1])/100:hsvArea.offsetWidth*this.hsv[1]/100),dragHandler.style.top=formatUnit(hsvArea.offsetHeight*(100-this.hsv[2])/100)}createSlider(){let sliderPreviewWrapper=this.createElement("div",{className:"e-slider-preview"});this.appendElement(sliderPreviewWrapper,1),this.createPreview(sliderPreviewWrapper);let sliderWrapper=this.createElement("div",{className:"e-colorpicker-slider"});sliderPreviewWrapper.insertBefore(sliderWrapper,sliderPreviewWrapper.children[0]);let slider=this.createElement("div",{className:"e-hue-slider"});sliderWrapper.appendChild(slider),this.hueSlider=new ej2_inputs_es2015_Slider({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)}),this.hueSlider.createElement=this.createElement,this.hueSlider.appendTo(slider),this.enableOpacity&&(slider=this.createElement("div",{className:"e-opacity-slider"}),sliderWrapper.appendChild(slider),this.createOpacitySlider(slider))}createOpacitySlider(slider){this.opacitySlider=new ej2_inputs_es2015_Slider({value:100*this.rgb[3],min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)}),this.opacitySlider.createElement=this.createElement,this.opacitySlider.appendTo(slider);let opacityBgTrack=this.createElement("div",{className:"e-opacity-empty-track"});slider.appendChild(opacityBgTrack),this.updateOpacitySliderBg()}updateOpacitySliderBg(){let direction=this.enableRtl?"to left":"to right";ej2_base_es2015_select(".e-slider-track",this.opacitySlider.element).style.background="linear-gradient("+direction+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)"}hueChange(args){this.hsv[0]=args.value,this.setHsvContainerBg(),this.convertToOtherFormat()}opacityChange(args){let value=args.value,pValue=this.rgbToHex(this.rgb);this.hsv[3]=value/100,this.rgb[3]=value/100;let cValue=this.rgbToHex(this.rgb);this.updateOpacityInput(value);let rgb=this.convertToRgbString(this.rgb);this.updatePreview(rgb),this.triggerEvent(cValue,pValue,rgb)}updateOpacityInput(value){if(!this.getWrapper().classList.contains(HIDEVALUE)){let opacityTextBoxInst=getInstance(ej2_base_es2015_select("."+OPACITY,this.container),ej2_inputs_es2015_NumericTextBox);opacityTextBoxInst.value=value,opacityTextBoxInst.dataBind()}}createPreview(parentEle){let previewContainer=this.createElement("div",{className:PREVIEW});parentEle.appendChild(previewContainer);let preview=this.createElement("span",{className:"e-preview e-current"});previewContainer.appendChild(preview);let colorValue=this.convertToRgbString(this.rgb);preview.style.backgroundColor=colorValue,preview=this.createElement("span",{className:"e-preview e-previous"}),previewContainer.appendChild(preview),preview.style.backgroundColor=colorValue}isPicker(){return!this.container.classList.contains("e-color-palette")}getPopupEle(){return this.container.parentElement}createNumericInput(element,value,label,max){let numericInput=new ej2_inputs_es2015_NumericTextBox({value:value,placeholder:label,min:0,max:max,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:args=>{args.event&&this.inputHandler(args.event)}});numericInput.createElement=this.createElement,numericInput.appendTo(element)}createInput(){let isPicker=this.isPicker(),wrapper=this.getWrapper();if(isPicker&&!wrapper.classList.contains(HIDEVALUE)||!isPicker&&wrapper.classList.contains(SHOWVALUE)){let inputWrap=this.createElement("div",{className:INPUTWRAPPER});this.appendElement(inputWrap,isPicker?2:1);let container=this.createElement("div",{className:"e-input-container"});if(inputWrap.appendChild(container),wrapper.classList.contains("e-hide-valueswitcher")||this.appendValueSwitchBtn(inputWrap),!wrapper.classList.contains(HIDEHEX)){let hexInput=this.createElement("input",{className:"e-hex",attrs:{maxlength:"7",spellcheck:"false"}});container.appendChild(hexInput),ej2_inputs_es2015_Input.createInput({element:hexInput,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker()}},this.createElement),ej2_inputs_es2015_Input.setValue(this.value.slice(0,7),hexInput),hexInput.addEventListener("input",this.inputHandler.bind(this))}if(!wrapper.classList.contains(HIDERGBA)){let label,value;this.isRgb?(label="RGB",value=this.rgb):(label="HSV",value=this.hsv);let clsName=["rh","gs","bv"];for(let i=0;i<3;i++)this.createNumericInput(container.appendChild(this.createElement("input",{className:"e-"+clsName[i]+"-value"})),value[i],label[i],255);this.enableOpacity&&this.appendOpacityValue(container)}}}appendOpacityValue(container){this.createNumericInput(container.appendChild(this.createElement("input",{className:OPACITY})),100*this.rgb[3],"A",100)}appendValueSwitchBtn(targetEle){let valueSwitchBtn=this.createElement("button",{className:"e-icons e-css e-btn e-flat e-icon-btn e-value-switch-btn"});targetEle.appendChild(valueSwitchBtn),this.isPicker()&&!this.getWrapper().classList.contains(HIDERGBA)&&valueSwitchBtn.addEventListener("click",this.formatSwitchHandler.bind(this))}createCtrlBtn(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);let btnWrapper=this.createElement("div",{className:CTRLSWITCH});if(this.container.appendChild(btnWrapper),this.showButtons){let controlBtnWrapper=this.createElement("div",{className:"e-ctrl-btn"});btnWrapper.appendChild(controlBtnWrapper);let apply=this.l10n.getConstant("Apply");controlBtnWrapper.appendChild(this.createElement("button",{innerHTML:apply,className:"e-btn e-css e-flat e-primary e-small e-apply",attrs:{title:apply}}));let cancel=this.l10n.getConstant("Cancel");controlBtnWrapper.appendChild(this.createElement("button",{innerHTML:cancel,className:"e-btn e-css e-flat e-small e-cancel",attrs:{title:cancel}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}}appendModeSwitchBtn(){let modeSwitcher=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+MODESWITCH,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});ej2_base_es2015_select("."+CTRLSWITCH,this.container).insertBefore(modeSwitcher,ej2_base_es2015_select(".e-ctrl-btn",this.container))}createDragTooltip(){let tooltip=new ej2_popups_es2015_Tooltip({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",beforeOpen:args=>{this.tooltipEle=args.element},animation:{open:{effect:"None"},close:{effect:"None"}}});tooltip.createElement=this.createElement,tooltip.appendTo(this.container),tooltip.open(this.container),this.tooltipEle.style.zIndex=getZindexPartial(this.tooltipEle).toString(),ej2_base_es2015_select(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))}getTooltipInst(){return getInstance(this.container,ej2_popups_es2015_Tooltip)}setTooltipOffset(value){this.getTooltipInst().offsetY=value}toggleDisabled(enable){enable?this.getWrapper().classList.add("e-disabled"):this.getWrapper().classList.remove("e-disabled"),this.showButtons&&[].slice.call(ej2_base_es2015_selectAll(".e-btn",this.container)).forEach(ele=>{enable?attributes(ele,{disabled:""}):ele.removeAttribute("disabled")})}convertToRgbString(rgb){return rgb.length?4===rgb.length?"rgba("+rgb.join()+")":"rgb("+rgb.join()+")":""}convertToHsvString(hsv){return 4===hsv.length?"hsva("+hsv.join()+")":"hsv("+hsv.join()+")"}updateHsv(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()}convertToOtherFormat(isKey=!1){let pValue=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);let cValue=this.rgbToHex(this.rgb),rgba=this.convertToRgbString(this.rgb);this.updatePreview(rgba),this.updateInput(cValue),this.triggerEvent(cValue,pValue,rgba,isKey)}updateInput(value){let wrapper=this.getWrapper();wrapper.classList.contains(HIDEVALUE)||(wrapper.classList.contains(HIDEHEX)||ej2_inputs_es2015_Input.setValue(value.substr(0,7),ej2_base_es2015_select(".e-hex",this.container)),wrapper.classList.contains(HIDERGBA)||this.updateValue(this.isRgb?this.rgb:this.hsv,!1))}updatePreview(value){this.enableOpacity&&this.updateOpacitySliderBg(),ej2_base_es2015_select(".e-tip-transparent",this.tooltipEle).style.backgroundColor=value,ej2_base_es2015_select("."+PREVIEW+" .e-current",this.container).style.backgroundColor=value,ej2_base_es2015_select("."+PREVIEW+" .e-previous",this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))}getDragHandler(){return ej2_base_es2015_select(".e-handler",this.container)}removeTileSelection(){[].slice.call(ej2_base_es2015_selectAll("."+SELECT,this.container.children[0])).forEach(ele=>{ele.classList.remove(SELECT),ele.setAttribute("aria-selected","false")})}convertRgbToNumberArray(value){return value.slice(value.indexOf("(")+1,value.indexOf(")")).split(",").map((n,i)=>3!==i?parseInt(n,10):parseFloat(n))}getValue(value,type){if(value||(value=this.value),type=type?type.toLowerCase():"hex","r"===value[0]){let cValue=this.convertRgbToNumberArray(value);if("hex"===type||"hexa"===type){let hex=this.rgbToHex(cValue);return"hex"===type?hex.slice(0,7):hex}return"hsv"===type?this.convertToHsvString(this.rgbToHsv.apply(this,cValue.slice(0,3))):"hsva"===type?this.convertToHsvString(this.rgbToHsv.apply(this,cValue)):"null"}if("h"===value[0]){let cValue=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(value));if("rgba"===type)return this.convertToRgbString(cValue);if("hex"===type||"hexa"===type){let hex=this.rgbToHex(cValue);return"hex"===type?hex.slice(0,7):hex}return"rgb"===type?this.convertToRgbString(cValue.slice(0,3)):"null"}{value=this.roundValue(value);let rgb=this.hexToRgb(value);return"rgb"!==type&&"hsv"!==type||(rgb=rgb.slice(0,3)),"rgba"===type||"rgb"===type?this.convertToRgbString(rgb):"hsva"===type||"hsv"===type?this.convertToHsvString(this.rgbToHsv.apply(this,rgb)):"hex"===type?value.slice(0,7):"a"===type?rgb[3].toString():"null"}}toggle(){this.container.parentElement.classList.contains("e-popup-close")?this.splitBtn.toggle():this.closePopup(null)}getModuleName(){return"colorpicker"}getPersistData(){return this.addOnPersist(["value"])}wireEvents(){if(this.isPicker()){let dragHandler=this.getDragHandler();EventHandler.add(dragHandler,"keydown",this.pickerKeyDown,this),EventHandler.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),EventHandler.add(ej2_base_es2015_select(".e-previous",this.container),"click",this.previewHandler,this)}else EventHandler.add(this.container,"click",this.paletteClickHandler,this),EventHandler.add(this.container,"keydown",this.paletteKeyDown,this)}formResetHandler(){this.value=this.initialInputValue,attributes(this.element,{value:this.initialInputValue})}addCtrlSwitchEvent(){EventHandler.add(ej2_base_es2015_select("."+CTRLSWITCH,this.container),"click",this.btnClickHandler,this)}pickerKeyDown(e){switch(e.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,e);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,e);break;case 38:this.handlerDragPosition(2,1,e);break;case 40:this.handlerDragPosition(2,-1,e);break;case 13:e.preventDefault();let cValue=this.rgbToHex(this.rgb);this.enterKeyHandler(cValue,e)}}enterKeyHandler(value,e){this.triggerChangeEvent(value),this.inline||(this.closePopup(e),this.splitBtn.element.focus())}closePopup(e){this.trigger("beforeClose",{element:this.container,event:e,cancel:!1},observedcloseArgs=>{observedcloseArgs.cancel||(this.splitBtn.toggle(),this.onPopupClose())})}triggerChangeEvent(value){let hex=value.slice(0,7);this.trigger("change",{currentValue:{hex:hex,rgba:this.convertToRgbString(this.rgb)},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:value}),this.setProperties({value:value},!0),this.element.value=hex||"#000000"}handlerDragPosition(prob,value,e){e.preventDefault(),this.hsv[prob]+=value*(e.ctrlKey?1:3),this.hsv[prob]<0&&(this.hsv[prob]=0),this.updateHsv(),this.convertToOtherFormat(!0)}handlerDown(e){e.preventDefault(),"mousedown"===e.type?(this.clientX=Math.abs(e.pageX-pageXOffset),this.clientY=Math.abs(e.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(e.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(e.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(),this.getDragHandler().focus(),EventHandler.add(document,"mousemove touchmove",this.handlerMove,this),EventHandler.add(document,"mouseup touchend",this.handlerEnd,this)}handlerMove(e){let x,y;"touchmove"!==e.type&&e.preventDefault(),"mousemove"===e.type?(x=Math.abs(e.pageX-pageXOffset),y=Math.abs(e.pageY-pageYOffset)):(x=Math.abs(e.changedTouches[0].pageX-pageXOffset),y=Math.abs(e.changedTouches[0].pageY-pageYOffset)),this.setHsv(x,y);let dragHandler=this.getDragHandler();parseInt(dragHandler.style.left,10),parseInt(dragHandler.style.top,10),this.updateHsv(),this.convertToOtherFormat(),this.getTooltipInst().refresh(dragHandler),this.tooltipEle.style.transform||(Math.abs(this.clientX-x)>8||Math.abs(this.clientY-y)>8)&&(ej2_base_es2015_select("."+HSVAREA,this.container).style.cursor="pointer",dragHandler.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",dragHandler.classList.add("e-hide-handler"))}setHsv(clientX,clientY){let ele=ej2_base_es2015_select("."+HSVAREA,this.container),position=ele.getBoundingClientRect();clientX=this.enableRtl?clientX>position.right?0:Math.abs(clientX-position.right):clientX>position.left?Math.abs(clientX-position.left):0,clientY=clientY>position.top?Math.abs(clientY-position.top):0,this.hsv[2]=Math.round(10*Number(100*(ele.offsetHeight-Math.max(0,Math.min(ele.offsetHeight,clientY-ele.offsetTop)))/ele.offsetHeight))/10,this.hsv[1]=Math.round(10*Number(100*Math.max(0,Math.min(ele.offsetWidth,clientX-ele.offsetLeft))/ele.offsetWidth))/10}handlerEnd(e){"touchend"!==e.type&&e.preventDefault(),EventHandler.remove(document,"mousemove touchmove",this.handlerMove),EventHandler.remove(document,"mouseup touchend",this.handlerEnd);let dragHandler=this.getDragHandler();ej2_base_es2015_select("."+HSVAREA,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",dragHandler.classList.remove("e-hide-handler")),this.inline||this.showButtons||this.closePopup(e)}btnClickHandler(e){let target=e.target;closest(target,"."+MODESWITCH)?(e.stopPropagation(),this.switchToPalette()):(target.classList.contains("e-apply")||target.classList.contains("e-cancel"))&&this.ctrlBtnClick(target,e)}switchToPalette(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),detach(ej2_base_es2015_select(".e-slider-preview",this.container)),this.getWrapper().classList.contains(HIDEVALUE)||ej2_base_es2015_remove(ej2_base_es2015_select("."+INPUTWRAPPER,this.container)),detach(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.createInput(),this.refreshPopupPos(),this.wireEvents()}refreshPopupPos(){if(!this.inline){let popupEle=this.getPopupEle();popupEle.style.left=formatUnit(0+pageXOffset),popupEle.style.top=formatUnit(0+pageYOffset),this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}}formatSwitchHandler(e){this.isRgb?(this.updateValue(this.hsv,!0,3,[360,100,100]),this.isRgb=!1):(this.updateValue(this.rgb,!0,2),this.isRgb=!0)}updateValue(value,format,idx,max){let inst,clsName=["e-rh-value","e-gs-value","e-bv-value"];for(let i=0,len=clsName.length;i<len;i++)(inst=getInstance(ej2_base_es2015_select("."+clsName[i],this.container),ej2_inputs_es2015_NumericTextBox)).value=Math.round(value[i]),format&&(inst.placeholder=clsName[i].substr(idx,1).toUpperCase(),inst.max=max?max[i]:255),inst.dataBind()}previewHandler(e){let target=e.target,pValue=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(target.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);let cValue=this.rgbToHex(this.rgb),hsv=this.rgbToHsv.apply(this,this.rgb);hsv[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:hsv[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(hsv[0]),this.enableOpacity&&hsv[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:100*hsv[3]},!0),this.opacitySlider.refresh(),this.updateOpacitySliderBg()),this.hsv=hsv,this.setHandlerPosition(),this.updateInput(cValue),ej2_base_es2015_select("."+PREVIEW+" .e-current",this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(cValue,pValue,this.convertToRgbString(this.rgb))}paletteClickHandler(e){e.preventDefault();let target=e.target;if(target.classList.contains(TILE)){if(this.removeTileSelection(),this.addTileSelection(target),target.classList.contains(NOCOLOR))this.noColorTile();else{let cValue=target.getAttribute("aria-label"),pValue=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(cValue)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(SHOWVALUE)&&this.updateInput(cValue),this.triggerEvent(cValue,pValue,this.convertToRgbString(this.rgb))}this.inline||this.showButtons||this.closePopup(e)}else closest(target,"."+MODESWITCH)?this.switchToPicker():target.classList.contains("e-apply")||target.classList.contains("e-cancel")?this.ctrlBtnClick(target,e):this.getWrapper().classList.contains(SHOWVALUE)&&closest(target,".e-value-switch-btn")&&this.formatSwitchHandler(e)}noColorTile(isKey=!1){let pValue=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",pValue,"",isKey)}switchToPicker(){let wrapper=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(ej2_base_es2015_selectAll(".e-palette",this.container)).forEach(ele=>{detach(ele)}),wrapper.classList.contains(SHOWVALUE)&&detach(ej2_base_es2015_select("."+INPUTWRAPPER,this.container)),this.container.style.width="";let grpEle=ej2_base_es2015_select(".e-custom-palette",this.container);this.presetColors&&ej2_base_es2015_remove(grpEle),this.createPicker(),this.getDragHandler().focus(),this.createInput(),this.refreshPopupPos(),this.wireEvents()}ctrlBtnClick(ele,e){if(ele.classList.contains("e-apply")){let cValue=this.rgbToHex(this.rgb);this.triggerChangeEvent(cValue)}this.inline||(this.closePopup(e),this.splitBtn.element.focus())}paletteKeyDown(e){let selectedEle,idx,target=e.target;if(!target.classList.contains("e-palette"))return;let tiles=[].slice.call(ej2_base_es2015_selectAll("."+TILE,target)),prevSelectedEle=tiles.filter(tile=>tile.classList.contains("e-selected")).pop();switch(!e.altKey&&e.keyCode){case 39:e.preventDefault(),selectedEle=prevSelectedEle?tiles[this.tilePosition(tiles,prevSelectedEle,this.enableRtl?-1:1)]:tiles[this.enableRtl?tiles.length-1:0],this.keySelectionChanges(selectedEle);break;case 37:e.preventDefault(),selectedEle=prevSelectedEle?tiles[this.tilePosition(tiles,prevSelectedEle,this.enableRtl?1:-1)]:tiles[this.enableRtl?0:tiles.length-1],this.keySelectionChanges(selectedEle);break;case 38:e.preventDefault(),idx=prevSelectedEle?this.tilePosition(tiles,prevSelectedEle,-this.columns):0,this.keySelectionChanges(selectedEle=tiles[idx]?tiles[idx]:tiles[idx-this.columns]);break;case 40:e.preventDefault(),tiles[idx=prevSelectedEle?this.tilePosition(tiles,prevSelectedEle,this.columns):tiles.length-1]?selectedEle=tiles[idx]:(idx%=tiles.length,selectedEle=tiles[idx+=tiles[tiles.length-1].parentElement.childElementCount]),this.keySelectionChanges(selectedEle);break;case 13:if(e.preventDefault(),prevSelectedEle){let cValue=prevSelectedEle.getAttribute("aria-label");this.enterKeyHandler(cValue||"",e)}}}keySelectionChanges(newEle){if(this.removeTileSelection(),this.addTileSelection(newEle),newEle.classList.contains(NOCOLOR))this.noColorTile(!0);else{let cValue=newEle.getAttribute("aria-label"),pValue=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(cValue),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(SHOWVALUE)&&this.updateInput(cValue),this.triggerEvent(cValue,pValue,this.convertToRgbString(this.rgb),!0)}}tilePosition(items,element,cIdx){let n=(items=Array.prototype.slice.call(items)).length,emptyCount=this.columns-items[n-1].parentElement.childElementCount,idx=items.indexOf(element);return(idx+=cIdx)<0?idx+=n+emptyCount:idx%=n+emptyCount,idx}inputHandler(e){let hsv,pValue,target=e.target;if(target.value.length)switch(ej2_base_es2015_select(".e-float-text",target.parentElement).textContent){case"HEX":let value="";if(("#"===target.value[0]&&5!==target.value.length||"#"!==target.value[0]&&4!==target.value.length)&&(value=this.roundValue(target.value)),9!==value.length)return;pValue=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(value+value.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),pValue,target.value);break;case"R":this.rgb[0]!==Number(target.value)&&(pValue=this.rgbToHex(this.rgb),this.rgb[0]=Number(target.value),hsv=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(hsv,pValue));break;case"G":this.rgb[1]!==Number(target.value)&&(pValue=this.rgbToHex(this.rgb),this.rgb[1]=Number(target.value),hsv=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(hsv,pValue));break;case"B":this.rgb[2]!==Number(target.value)&&(pValue=this.rgbToHex(this.rgb),this.rgb[2]=Number(target.value),hsv=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(hsv,pValue));break;case"H":this.hueSlider.value=Number(target.value);break;case"S":this.hsv[1]!==Number(target.value)&&(this.hsv[1]=Number(target.value),this.updateHsv(),this.convertToOtherFormat());break;case"V":this.hsv[2]!==Number(target.value)&&(this.hsv[2]=Number(target.value),this.updateHsv(),this.convertToOtherFormat());break;case"A":this.opacitySlider.value=Number(target.value)}}inputValueChange(hsv,pValue,value){hsv[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:hsv[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(hsv[0])),this.hsv=hsv;let cValue=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(value||cValue);let rgba=this.convertToRgbString(this.rgb);this.updatePreview(rgba),this.triggerEvent(cValue,pValue,rgba)}triggerEvent(cValue,pValue,rgba,isKey=!1){let hex=cValue.slice(0,7);this.showButtons||isKey?this.trigger("select",{currentValue:{hex:hex,rgba:rgba},previousValue:{hex:pValue.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(pValue))}}):(this.trigger("change",{currentValue:{hex:hex,rgba:rgba},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:cValue}),this.setProperties({value:cValue},!0),this.element.value=hex||"#000000")}destroy(){let wrapper=this.getWrapper();super.destroy(),["tabindex","spellcheck"].forEach(attr=>{this.element.removeAttribute(attr)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,detach(this.element.nextElementSibling),wrapper.parentElement.insertBefore(this.element,wrapper),detach(wrapper),this.container=null,this.formElement&&EventHandler.remove(this.formElement,"reset",this.formResetHandler)}destroyOtherComp(){if(this.isPicker()){this.hueSlider.destroy(),this.enableOpacity&&(this.opacitySlider.destroy(),this.opacitySlider=null),this.hueSlider=null;let tooltipInst=this.getTooltipInst();tooltipInst.close(),tooltipInst.destroy(),this.tooltipEle=null}}isPopupOpen(){return this.getPopupEle().classList.contains("e-popup-open")}unWireEvents(){if(this.isPicker()){this.getWrapper();let dragHandler=this.getDragHandler();EventHandler.remove(dragHandler,"keydown",this.pickerKeyDown),EventHandler.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&EventHandler.remove(ej2_base_es2015_select("."+CTRLSWITCH,this.container),"click",this.btnClickHandler),EventHandler.remove(ej2_base_es2015_select(".e-previous",this.container),"click",this.previewHandler)}else EventHandler.remove(this.container,"click",this.paletteClickHandler),EventHandler.remove(this.container,"keydown",this.paletteKeyDown)}roundValue(value){if(!value)return"";"#"!==value[0]&&(value="#"+value);let len=value.length;if(4===len&&(value+="f",len=5),5===len){let tempValue="";for(let i=1,len=value.length;i<len;i++)tempValue+=value.charAt(i)+value.charAt(i);value="#"+tempValue,len=9}return 7===len&&(value+="ff"),value}hexToRgb(hex){if(!hex)return[];9!==(hex=hex.trim()).length&&(hex=this.roundValue(hex));let opacity=Number((parseInt(hex.slice(-2),16)/255).toFixed(2));hex=hex.slice(1,7);let bigInt=parseInt(hex,16),h=[];return h.push(bigInt>>16&255),h.push(bigInt>>8&255),h.push(255&bigInt),h.push(opacity),h}rgbToHsv(r,g,b,opacity){if(this.rgb&&!this.rgb.length)return[];r/=255,g/=255,b/=255;let h,s,max=Math.max(r,g,b),min=Math.min(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max===min)h=0;else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}let hsv=[Math.round(360*h),Math.round(1e3*s)/10,Math.round(1e3*v)/10];return isNullOrUndefined(opacity)||hsv.push(opacity),hsv}hsvToRgb(h,s,v,opacity){let r,g,b,i,f,p,q,t;if(v/=100,0==(s/=100))return r=g=b=v,[Math.round(255*r),Math.round(255*g),Math.round(255*b),opacity];switch(p=v*(1-s),q=v*(1-s*(f=(h/=60)-(i=Math.floor(h)))),t=v*(1-s*(1-f)),i){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;default:r=v,g=p,b=q}let rgb=[Math.round(255*r),Math.round(255*g),Math.round(255*b)];return isNullOrUndefined(opacity)||rgb.push(opacity),rgb}rgbToHex(rgb){return rgb.length?"#"+this.hex(rgb[0])+this.hex(rgb[1])+this.hex(rgb[2])+(isNullOrUndefined(rgb[3])?"":0!==rgb[3]?(Math.round(255*rgb[3])+65536).toString(16).substr(-2):"00"):""}hex(x){return("0"+x.toString(16)).slice(-2)}changeModeSwitcherProp(prop){let ctrlSwitchWrapper=ej2_base_es2015_select("."+CTRLSWITCH,this.container);prop?ctrlSwitchWrapper?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):ctrlSwitchWrapper&&(this.showButtons?detach(ej2_base_es2015_select("."+MODESWITCH,ctrlSwitchWrapper)):ej2_base_es2015_remove(ctrlSwitchWrapper))}changeShowBtnProps(prop){let ctrlBtnWrapper=ej2_base_es2015_select("."+CTRLSWITCH,this.container);prop?(ctrlBtnWrapper&&ej2_base_es2015_remove(ctrlBtnWrapper),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?detach(ej2_base_es2015_select(".e-ctrl-btn",ctrlBtnWrapper)):ej2_base_es2015_remove(ctrlBtnWrapper)}changeValueProp(newProp){if(this.isPicker())this.rgb=this.hexToRgb(newProp),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),detach(closest(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateInput(newProp),4===this.rgb.length&&this.updateOpacityInput(100*this.rgb[3]);else{this.removeTileSelection();let ele=ej2_base_es2015_select('span[aria-label="'+this.roundValue(newProp)+'"]',this.container);ele&&this.addTileSelection(ele)}}setInputEleProps(prop){ej2_base_es2015_remove(ej2_base_es2015_select("."+INPUTWRAPPER,this.container)),this.createInput()}changeDisabledProp(newProp){this.isPicker()&&(this.hueSlider.enabled=!newProp,this.opacitySlider.enabled=!newProp,this.setInputEleProps(newProp)),newProp?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())}changeCssClassProps(newProp,oldProp){let wrapper=this.getWrapper(),popupWrapper=this.getPopupEle();oldProp&&removeClass([wrapper,popupWrapper],oldProp.split(" ")),newProp&&addClass([wrapper,popupWrapper],newProp.split(" "))}changeRtlProps(newProp){newProp?addClass([this.getWrapper()],"e-rtl"):removeClass([this.getWrapper()],"e-rtl")}changePaletteProps(){detach(this.container.children[0]),this.container.style.width="",this.createPalette()}changeOpacityProps(newProp){let wrapper=this.getWrapper();newProp?(removeClass([this.container.parentElement],"e-hide-opacity"),this.createOpacitySlider(ej2_base_es2015_select(".e-colorpicker-slider",this.container).appendChild(this.createElement("div",{className:"e-opacity-slider"}))),wrapper.classList.contains(HIDEVALUE)||wrapper.classList.contains(HIDERGBA)||this.appendOpacityValue(ej2_base_es2015_select(".e-input-container",this.container))):(addClass([this.container.parentElement],"e-hide-opacity"),this.opacitySlider.destroy(),ej2_base_es2015_remove(this.opacitySlider.element),this.opacitySlider=null,wrapper.classList.contains(HIDEVALUE)||wrapper.classList.contains(HIDERGBA)||ej2_base_es2015_remove(ej2_base_es2015_select("."+OPACITY,this.container).parentElement))}onPropertyChanged(newProp,oldProp){if(!isNullOrUndefined(newProp.value)){let value=this.roundValue(newProp.value);if(9===value.length){this.element.value=this.roundValue(value).slice(0,7);let preview=this.splitBtn&&ej2_base_es2015_select(".e-split-preview",this.splitBtn.element);preview&&(preview.style.backgroundColor=this.convertToRgbString(this.hexToRgb(newProp.value)))}else this.value=oldProp.value}if(!this.inline&&isNullOrUndefined(newProp.inline)&&(this.splitBtn.setProperties(getModel(newProp,["disabled","enableRtl"])),!this.isPopupOpen()))return this.changeCssClassProps(newProp.cssClass,oldProp.cssClass),void this.changeRtlProps(newProp.enableRtl);for(let prop of Object.keys(newProp))switch(prop){case"inline":newProp.inline?(this.getWrapper().appendChild(this.container),this.splitBtn.destroy(),detach(this.element.nextElementSibling),this.container.children.length||this.createWidget()):(this.destroyOtherComp(),this.unWireEvents(),this.container.innerHTML="",this.createSplitBtn());break;case"cssClass":this.changeCssClassProps(newProp.cssClass,oldProp.cssClass);let props=newProp.cssClass.split(" ").concat(oldProp.cssClass.split(" "));props=props.reduce((a,b)=>(a.indexOf(b)<0&&a.push(b),a),[]);let count=0;props.forEach(cls=>{0!==count||cls!==HIDEVALUE&&"e-hide-valueswitcher"!==cls&&cls!==SHOWVALUE&&cls!==HIDEHEX&&cls!==HIDERGBA||(ej2_base_es2015_select("."+INPUTWRAPPER,this.container)&&ej2_base_es2015_remove(ej2_base_es2015_select("."+INPUTWRAPPER,this.container)),this.createInput(),count++)});break;case"enableRtl":this.isPicker()&&(this.hueSlider.enableRtl=newProp.enableRtl,this.enableOpacity&&(this.opacitySlider.enableRtl=newProp.enableRtl),this.setInputEleProps(newProp.enableRtl)),this.changeRtlProps(newProp.enableRtl);break;case"disabled":this.changeDisabledProp(newProp.disabled);break;case"value":this.value!==oldProp.value&&this.changeValueProp(newProp.value);break;case"showButtons":this.changeShowBtnProps(newProp.showButtons);break;case"mode":"Picker"===newProp.mode?this.switchToPicker():this.switchToPalette();break;case"modeSwitcher":this.changeModeSwitcherProp(newProp.modeSwitcher);break;case"columns":case"presetColors":this.isPicker()||this.changePaletteProps();break;case"noColor":newProp.noColor?"Palette"!==this.mode||this.modeSwitcher||this.setNoColor():this.changePaletteProps();break;case"enableOpacity":this.changeOpacityProps(newProp.enableOpacity)}}focusIn(){this.element.parentElement.focus()}};return __decorate([Property("#008000ff")],ColorPicker.prototype,"value",void 0),__decorate([Property("")],ColorPicker.prototype,"cssClass",void 0),__decorate([Property(!1)],ColorPicker.prototype,"disabled",void 0),__decorate([Property("Picker")],ColorPicker.prototype,"mode",void 0),__decorate([Property(!0)],ColorPicker.prototype,"modeSwitcher",void 0),__decorate([Property(null)],ColorPicker.prototype,"presetColors",void 0),__decorate([Property(!0)],ColorPicker.prototype,"showButtons",void 0),__decorate([Property(10)],ColorPicker.prototype,"columns",void 0),__decorate([Property(!1)],ColorPicker.prototype,"inline",void 0),__decorate([Property(!1)],ColorPicker.prototype,"noColor",void 0),__decorate([Property(!1)],ColorPicker.prototype,"enablePersistence",void 0),__decorate([Property(!0)],ColorPicker.prototype,"enableOpacity",void 0),__decorate([ej2_base_es2015_Event()],ColorPicker.prototype,"select",void 0),__decorate([ej2_base_es2015_Event()],ColorPicker.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],ColorPicker.prototype,"beforeTileRender",void 0),__decorate([ej2_base_es2015_Event()],ColorPicker.prototype,"beforeOpen",void 0),__decorate([ej2_base_es2015_Event()],ColorPicker.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],ColorPicker.prototype,"beforeClose",void 0),__decorate([ej2_base_es2015_Event()],ColorPicker.prototype,"beforeModeSwitch",void 0),__decorate([ej2_base_es2015_Event()],ColorPicker.prototype,"created",void 0),__decorate([NotifyPropertyChanges],ColorPicker)})();const containerAttr=["title","style","class"];let ej2_inputs_es2015_TextBox=(()=>{let TextBox=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.previousValue=null,this.isAngular=!1,this.isHiddenInput=!1,this.isForm=!1,this.inputPreviousValue=null,this.isVue=!1,this.textboxOptions=options}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"floatLabelType":ej2_inputs_es2015_Input.removeFloating(this.textboxWrapper),ej2_inputs_es2015_Input.addFloating(this.respectiveElement,this.floatLabelType,this.placeholder);break;case"enabled":ej2_inputs_es2015_Input.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container);break;case"value":let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.isBlank(this.value)||(this.value=this.value.toString()),this.isProtectedOnChange=prevOnChange,ej2_inputs_es2015_Input.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.inputPreviousValue=this.respectiveElement.value,(this.isAngular||this.isVue)&&!0===this.preventChange?(this.previousValue=this.isAngular?this.value:this.previousValue,this.preventChange=!1):(isNullOrUndefined(this.isAngular)||!this.isAngular||this.isAngular&&!this.preventChange||this.isAngular&&isNullOrUndefined(this.preventChange))&&this.raiseChangeEvent();break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkAttributes(!0);break;case"readonly":ej2_inputs_es2015_Input.setReadonly(this.readonly,this.respectiveElement);break;case"type":"TEXTAREA"!==this.respectiveElement.tagName&&(this.respectiveElement.setAttribute("type",this.type),this.raiseChangeEvent());break;case"showClearButton":"TEXTAREA"!==this.respectiveElement.tagName&&(ej2_inputs_es2015_Input.setClearButton(this.showClearButton,this.respectiveElement,this.textboxWrapper),this.bindClearEvent());break;case"enableRtl":ej2_inputs_es2015_Input.setEnableRtl(this.enableRtl,[this.textboxWrapper.container]);break;case"placeholder":ej2_inputs_es2015_Input.setPlaceholder(this.placeholder,this.respectiveElement);break;case"cssClass":ej2_inputs_es2015_Input.setCssClass(newProp.cssClass,[this.textboxWrapper.container],oldProp.cssClass);break;case"locale":this.globalize=new Internationalization(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),ej2_inputs_es2015_Input.setPlaceholder(this.placeholder,this.respectiveElement)}}getModuleName(){return"textbox"}isBlank(str){return!str||/^\s*$/.test(str)}preRender(){if(this.cloneElement=this.element.cloneNode(!0),this.formElement=closest(this.element,"form"),isNullOrUndefined(this.formElement)||(this.isForm=!0),"EJS-TEXTBOX"===this.element.tagName){let ejInstance=getValue("ej2_instances",this.element),inputElement=this.createElement(this.multiline?"textarea":"input"),index=0;for(;index<this.element.attributes.length;index++){let attributeName=this.element.attributes[index].nodeName;"id"!==attributeName&&(inputElement.setAttribute(attributeName,this.element.attributes[index].nodeValue),inputElement.innerHTML=this.element.innerHTML,"name"===attributeName&&this.element.removeAttribute("name"))}this.element.appendChild(inputElement),this.element=inputElement,setValue("ej2_instances",ejInstance,this.element)}if(this.updateHTMLAttrToElement(),this.checkAttributes(!1),"TEXTAREA"!==this.element.tagName&&this.element.setAttribute("type",this.type),this.element.setAttribute("role","textbox"),this.globalize=new Internationalization(this.locale),this.l10n=new L10n("textbox",{placeholder:this.placeholder},this.locale),""!==this.l10n.getConstant("placeholder")&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",getUniqueID("textbox")),this.element.hasAttribute("name")||this.element.setAttribute("name",this.element.getAttribute("id")),"INPUT"===this.element.tagName&&this.multiline){this.isHiddenInput=!0,this.textarea=this.createElement("textarea"),this.element.parentNode.insertBefore(this.textarea,this.element),this.element.setAttribute("type","hidden"),this.textarea.setAttribute("name",this.element.getAttribute("name")),this.element.removeAttribute("name"),this.textarea.setAttribute("role",this.element.getAttribute("role")),this.element.removeAttribute("role");let attribute=["required","minlength","maxlength"];for(let i=0;i<attribute.length;i++)if(this.element.hasAttribute(attribute[i])){let attr=this.element.getAttribute(attribute[i]);this.textarea.setAttribute(attribute[i],attr),this.element.removeAttribute(attribute[i])}}}checkAttributes(isDynamic){let attrs=isDynamic?isNullOrUndefined(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly","type"];for(let key of attrs)if(!isNullOrUndefined(this.element.getAttribute(key)))switch(key){case"disabled":if(isNullOrUndefined(this.textboxOptions)||void 0===this.textboxOptions.enabled||isDynamic){let enabled="disabled"!==this.element.getAttribute(key)&&""!==this.element.getAttribute(key)&&"true"!==this.element.getAttribute(key);this.setProperties({enabled:enabled},!isDynamic)}break;case"readonly":if(isNullOrUndefined(this.textboxOptions)||void 0===this.textboxOptions.readonly||isDynamic){let readonly="readonly"===this.element.getAttribute(key)||""===this.element.getAttribute(key)||"true"===this.element.getAttribute(key);this.setProperties({readonly:readonly},!isDynamic)}break;case"placeholder":(isNullOrUndefined(this.textboxOptions)||void 0===this.textboxOptions.placeholder||isDynamic)&&this.setProperties({placeholder:this.element.placeholder},!isDynamic);break;case"value":(isNullOrUndefined(this.textboxOptions)||void 0===this.textboxOptions.value||isDynamic)&&this.setProperties({value:this.element.value},!isDynamic);break;case"type":(isNullOrUndefined(this.textboxOptions)||void 0===this.textboxOptions.type||isDynamic)&&this.setProperties({type:this.element.type},!isDynamic)}}render(){this.respectiveElement=this.isHiddenInput?this.textarea:this.element,this.textboxWrapper=ej2_inputs_es2015_Input.createInput({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:{enabled:this.enabled,enableRtl:this.enableRtl,cssClass:this.cssClass,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.updateHTMLAttrToWrapper(),this.isHiddenInput&&this.respectiveElement.parentNode.insertBefore(this.element,this.respectiveElement),this.wireEvents(),isNullOrUndefined(this.value)||(ej2_inputs_es2015_Input.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value)),isNullOrUndefined(this.value)||(this.initialValue=this.value,this.setInitialValue()),this.previousValue=this.value,this.inputPreviousValue=this.value,this.renderComplete()}updateHTMLAttrToWrapper(){if(!isNullOrUndefined(this.htmlAttributes))for(let key of Object.keys(this.htmlAttributes))if(containerAttr.indexOf(key)>-1)if("class"===key)addClass([this.textboxWrapper.container],this.htmlAttributes[key].split(" "));else if("style"===key){let setStyle=this.textboxWrapper.container.getAttribute(key);setStyle=isNullOrUndefined(setStyle)?this.htmlAttributes[key]:setStyle+this.htmlAttributes[key],this.textboxWrapper.container.setAttribute(key,setStyle)}else this.textboxWrapper.container.setAttribute(key,this.htmlAttributes[key])}updateHTMLAttrToElement(){if(!isNullOrUndefined(this.htmlAttributes))for(let key of Object.keys(this.htmlAttributes))containerAttr.indexOf(key)<0&&this.element.setAttribute(key,this.htmlAttributes[key])}setInitialValue(){this.isAngular||this.respectiveElement.setAttribute("value",this.initialValue)}wireEvents(){EventHandler.add(this.respectiveElement,"focus",this.focusHandler,this),EventHandler.add(this.respectiveElement,"blur",this.focusOutHandler,this),EventHandler.add(this.respectiveElement,"input",this.inputHandler,this),EventHandler.add(this.respectiveElement,"change",this.changeHandler,this),this.isForm&&EventHandler.add(this.formElement,"reset",this.resetForm,this),this.enabled&&this.bindClearEvent()}resetValue(value){let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.value=value,this.isProtectedOnChange=prevOnChange}resetForm(){this.resetValue(this.isAngular?"":this.initialValue);let label=this.textboxWrapper.container.querySelector(".e-float-text");isNullOrUndefined(label)||(isNullOrUndefined(this.initialValue)||""===this.initialValue?(label.classList.add("e-label-bottom"),label.classList.remove("e-label-top")):""!==this.initialValue&&(label.classList.add("e-label-top"),label.classList.remove("e-label-bottom")))}focusHandler(args){this.trigger("focus",{container:this.textboxWrapper.container,event:args,value:this.value})}focusOutHandler(args){null===this.previousValue&&null===this.value&&""===this.respectiveElement.value||this.previousValue===this.respectiveElement.value||this.raiseChangeEvent(args,!0),this.trigger("blur",{container:this.textboxWrapper.container,event:args,value:this.value})}inputHandler(args){let eventArgs={event:args,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.inputPreviousValue=this.respectiveElement.value,this.isAngular&&(this.localChange({value:this.respectiveElement.value}),this.preventChange=!0),this.isVue&&(this.preventChange=!0),this.trigger("input",eventArgs),args.stopPropagation()}changeHandler(args){this.setProperties({value:this.respectiveElement.value},!0),this.raiseChangeEvent(args,!0),args.stopPropagation()}raiseChangeEvent(event,interaction){let eventArgs={event:event,value:this.value,previousValue:this.previousValue,container:this.textboxWrapper.container,isInteraction:interaction||!1,isInteracted:interaction||!1};this.preventChange=!1,this.trigger("change",eventArgs),this.previousValue=this.value}bindClearEvent(){this.showClearButton&&"TEXTAREA"!==this.respectiveElement.tagName&&EventHandler.add(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler,this)}resetInputHandler(event){event.preventDefault(),this.textboxWrapper.clearButton.classList.contains("e-clear-icon-hide")||(ej2_inputs_es2015_Input.setValue("",this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.setProperties({value:this.respectiveElement.value},!0),this.trigger("input",{event:event,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container}),this.inputPreviousValue=this.respectiveElement.value,this.raiseChangeEvent(event,!0))}unWireEvents(){EventHandler.remove(this.respectiveElement,"focus",this.focusHandler),EventHandler.remove(this.respectiveElement,"blur",this.focusOutHandler),EventHandler.remove(this.respectiveElement,"input",this.inputHandler),EventHandler.remove(this.respectiveElement,"change",this.changeHandler),this.isForm&&EventHandler.remove(this.formElement,"reset",this.resetForm)}destroy(){this.unWireEvents(),"INPUT"===this.element.tagName&&this.multiline&&(detach(this.textboxWrapper.container.getElementsByTagName("textarea")[0]),this.respectiveElement=this.element,this.element.removeAttribute("type")),this.respectiveElement.classList.remove("e-input"),this.removeAttributes(["aria-placeholder","aria-disabled","aria-readonly","aria-labelledby"]),this.textboxWrapper.container.insertAdjacentElement("afterend",this.respectiveElement),detach(this.textboxWrapper.container),this.textboxWrapper=null,super.destroy()}getPersistData(){return this.addOnPersist(["value"])}addAttributes(attributes$$1){for(let key of Object.keys(attributes$$1))"disabled"===key?(this.setProperties({enabled:!1},!0),ej2_inputs_es2015_Input.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):"readonly"===key?(this.setProperties({readonly:!0},!0),ej2_inputs_es2015_Input.setReadonly(this.readonly,this.respectiveElement)):"class"===key?this.respectiveElement.classList.add(attributes$$1[key]):"placeholder"===key?(this.setProperties({placeholder:attributes$$1[key]},!0),ej2_inputs_es2015_Input.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.setAttribute(key,attributes$$1[key])}removeAttributes(attributes$$1){for(let key of attributes$$1)"disabled"===key?(this.setProperties({enabled:!0},!0),ej2_inputs_es2015_Input.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):"readonly"===key?(this.setProperties({readonly:!1},!0),ej2_inputs_es2015_Input.setReadonly(this.readonly,this.respectiveElement)):"placeholder"===key?(this.setProperties({placeholder:null},!0),ej2_inputs_es2015_Input.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.removeAttribute(key)}focusIn(){document.activeElement!==this.respectiveElement&&this.enabled&&(this.respectiveElement.focus(),addClass([this.textboxWrapper.container],["e-input-focus"]))}focusOut(){document.activeElement===this.respectiveElement&&this.enabled&&(this.respectiveElement.blur(),removeClass([this.textboxWrapper.container],["e-input-focus"]))}};return __decorate([Property("text")],TextBox.prototype,"type",void 0),__decorate([Property(!1)],TextBox.prototype,"readonly",void 0),__decorate([Property(null)],TextBox.prototype,"value",void 0),__decorate([Property("Never")],TextBox.prototype,"floatLabelType",void 0),__decorate([Property("")],TextBox.prototype,"cssClass",void 0),__decorate([Property(null)],TextBox.prototype,"placeholder",void 0),__decorate([Property({})],TextBox.prototype,"htmlAttributes",void 0),__decorate([Property(!1)],TextBox.prototype,"multiline",void 0),__decorate([Property(!0)],TextBox.prototype,"enabled",void 0),__decorate([Property(!1)],TextBox.prototype,"showClearButton",void 0),__decorate([Property(!1)],TextBox.prototype,"enablePersistence",void 0),__decorate([ej2_base_es2015_Event()],TextBox.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],TextBox.prototype,"destroyed",void 0),__decorate([ej2_base_es2015_Event()],TextBox.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],TextBox.prototype,"blur",void 0),__decorate([ej2_base_es2015_Event()],TextBox.prototype,"focus",void 0),__decorate([ej2_base_es2015_Event()],TextBox.prototype,"input",void 0),__decorate([NotifyPropertyChanges],TextBox)})(),ej2_lists_es2015_cssClass={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper"};var ej2_lists_es2015_ListBase;function getFieldValues(dataItem,fields){let fieldData={};if(isNullOrUndefined(dataItem)||"string"==typeof dataItem||"number"==typeof dataItem||!isNullOrUndefined(dataItem.isHeader))return dataItem;for(let field of Object.keys(fields)){let dataField=fields[field],value=isNullOrUndefined(dataField)||"string"!=typeof dataField?void 0:getValue(dataField,dataItem);isNullOrUndefined(value)||(fieldData[dataField]=value)}return fieldData}!function(ListBase){ListBase.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null};let defaultAriaAttributes={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},defaultListBaseOptions={showCheckBox:!1,showIcon:!1,expandCollapse:!1,fields:ListBase.defaultMappedFields,ariaAttributes:defaultAriaAttributes,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right"};function createListFromArray(createElement,dataSource,isSingleLevel,options){return generateUL(createElement,createListItemFromArray(createElement,dataSource,isSingleLevel,options),null,options)}function createListItemFromArray(createElement,dataSource,isSingleLevel,options){let subChild=[],curOpt=extend({},defaultListBaseOptions,options);ej2_lists_es2015_cssClass=getModuleClass(curOpt.moduleName);let id=generateId();for(let i=0;i<dataSource.length;i++){if(isNullOrUndefined(dataSource[i]))continue;let li;curOpt.itemCreating&&"function"==typeof curOpt.itemCreating&&curOpt.itemCreating({dataSource:dataSource,curData:dataSource[i],text:dataSource[i],options:curOpt}),li=isSingleLevel?generateSingleLevelLI(createElement,dataSource[i],void 0,null,null,[],null,id,i,options):generateLI(createElement,dataSource[i],void 0,null,null,options),curOpt.itemCreated&&"function"==typeof curOpt.itemCreated&&curOpt.itemCreated({dataSource:dataSource,curData:dataSource[i],text:dataSource[i],item:li,options:curOpt}),subChild.push(li)}return subChild}function createListItemFromJson(createElement,dataSource,options,level,isSingleLevel){let curOpt=extend({},defaultListBaseOptions,options);ej2_lists_es2015_cssClass=getModuleClass(curOpt.moduleName);let id,fields=extend({},ListBase.defaultMappedFields,curOpt.fields),ariaAttributes=extend({},defaultAriaAttributes,curOpt.ariaAttributes);level&&(ariaAttributes.level=level);let li,child=[];dataSource&&dataSource.length&&!isNullOrUndefined(typeofData(dataSource).item)&&!typeofData(dataSource).item.hasOwnProperty(fields.id)&&(id=generateId());for(let i=0;i<dataSource.length;i++){let fieldData=getFieldValues(dataSource[i],fields);if(isNullOrUndefined(dataSource[i]))continue;curOpt.itemCreating&&"function"==typeof curOpt.itemCreating&&curOpt.itemCreating({dataSource:dataSource,curData:dataSource[i],text:fieldData[fields.text],options:curOpt,fields:fields});let curItem=dataSource[i];curOpt.itemCreating&&"function"==typeof curOpt.itemCreating&&(fieldData=getFieldValues(dataSource[i],fields)),fieldData.hasOwnProperty(fields.id)&&!isNullOrUndefined(fieldData[fields.id])&&(id=fieldData[fields.id]);let innerEle=[];if(curOpt.showCheckBox&&innerEle.push(createElement("input",{className:ej2_lists_es2015_cssClass.check,attrs:{type:"checkbox"}})),!0===isSingleLevel)curOpt.showIcon&&fieldData.hasOwnProperty(fields.iconCss)&&!isNullOrUndefined(fieldData[fields.iconCss])&&innerEle.push(createElement("span",{className:ej2_lists_es2015_cssClass.icon+" "+fieldData[fields.iconCss]})),li=generateSingleLevelLI(createElement,curItem,fieldData,fields,curOpt.itemClass,innerEle,!(!curItem.hasOwnProperty("isHeader")||!curItem.isHeader),id,i,options);else{if((li=generateLI(createElement,curItem,fieldData,fields,curOpt.itemClass,options)).classList.add(ej2_lists_es2015_cssClass.level+"-"+ariaAttributes.level),li.setAttribute("aria-level",ariaAttributes.level.toString()),fieldData.hasOwnProperty(fields.tooltip)&&li.setAttribute("title",fieldData[fields.tooltip]),fieldData.hasOwnProperty(fields.htmlAttributes)&&fieldData[fields.htmlAttributes]&&setAttribute(li,fieldData[fields.htmlAttributes]),fieldData.hasOwnProperty(fields.enabled)&&!1===fieldData[fields.enabled]&&li.classList.add(ej2_lists_es2015_cssClass.disabled),fieldData.hasOwnProperty(fields.isVisible)&&!1===fieldData[fields.isVisible]&&(li.style.display="none"),fieldData.hasOwnProperty(fields.imageUrl)&&!isNullOrUndefined(fieldData[fields.imageUrl])&&!curOpt.template){let attr={src:fieldData[fields.imageUrl]};ej2_base_es2015_merge(attr,fieldData[fields.imageAttributes]),prepend([createElement("img",{className:ej2_lists_es2015_cssClass.image,attrs:attr})],li.firstElementChild)}curOpt.showIcon&&fieldData.hasOwnProperty(fields.iconCss)&&!isNullOrUndefined(fieldData[fields.iconCss])&&!curOpt.template&&prepend([createElement("div",{className:ej2_lists_es2015_cssClass.icon+" "+fieldData[fields.iconCss]})],li.firstElementChild),innerEle.length&&prepend(innerEle,li.firstElementChild),processSubChild(createElement,fieldData,fields,0,curOpt,li,ariaAttributes.level)}curOpt.itemCreated&&"function"==typeof curOpt.itemCreated&&curOpt.itemCreated({dataSource:dataSource,curData:dataSource[i],text:fieldData[fields.text],item:li,options:curOpt,fields:fields}),child.push(li)}return child}function createListFromJson(createElement,dataSource,options,level,isSingleLevel){let curOpt=extend({},defaultListBaseOptions,options);return generateUL(createElement,createListItemFromJson(createElement,dataSource,options,level,isSingleLevel),curOpt.listClass,options)}function indexOf(item,elementArray){if(elementArray&&item){let liCollections=elementArray;return(liCollections=Array.prototype.slice.call(elementArray)).indexOf(item)}}function addSorting(sortOrder,sortBy,query=new ej2_data_es2015_Query){if("Ascending"===sortOrder)query.sortBy(sortBy,"ascending",!0);else if("Descending"===sortOrder)query.sortBy(sortBy,"descending",!0);else for(let i=0;i<query.queries.length;i++)"onSortBy"===query.queries[i].fn&&query.queries.splice(i,1);return query}function getDataSource(dataSource,query){return new ej2_data_es2015_DataManager(dataSource).executeLocal(query)}function typeofData(data){for(let i=0;i<data.length;i++)if(!isNullOrUndefined(data[i]))return{typeof:typeof data[i],item:data[i]};return{typeof:null,item:null}}function setAttribute(element,elementAttributes){let attr={};ej2_base_es2015_merge(attr,elementAttributes),attr.class&&(addClass([element],attr.class.split(" ")),delete attr.class),attributes(element,attr)}function getAllAttributes(element){let attributes$$1={},attr=element.attributes;for(let index=0;index<attr.length;index++)attributes$$1[attr[index].nodeName]=attr[index].nodeValue;return attributes$$1}function generateId(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function processSubChild(createElement,fieldData,fields,ds,options,element,level){let subDS=fieldData[fields.child]||[],hasChildren=fieldData[fields.hasChildren];if(subDS.length&&(hasChildren=!0,element.classList.add(ej2_lists_es2015_cssClass.hasChild),options.processSubChild)){let subLi=createListFromJson(createElement,subDS,options,++level);element.appendChild(subLi)}options.expandCollapse&&hasChildren&&!options.template&&(element.firstElementChild.classList.add(ej2_lists_es2015_cssClass.iconWrapper),("Left"===options.expandIconPosition?prepend:append)([createElement("div",{className:"e-icons "+options.expandIconClass})],element.querySelector("."+ej2_lists_es2015_cssClass.textContent)))}function generateSingleLevelLI(createElement,item,fieldData,fields,className,innerElements,grpLI,id,index,options){let dataSource,elementID,curOpt=extend({},defaultListBaseOptions,options),ariaAttributes=extend({},defaultAriaAttributes,curOpt.ariaAttributes),text=item,value=item;"string"!=typeof item&&"number"!=typeof item&&"boolean"!=typeof item&&(dataSource=item,text="boolean"==typeof fieldData[fields.text]||"number"==typeof fieldData[fields.text]?fieldData[fields.text]:fieldData[fields.text]||"",value=fieldData[fields.value]),elementID=isNullOrUndefined(dataSource)||isNullOrUndefined(fieldData[fields.id])||""===fieldData[fields.id]?id+"-"+index:id;let li=createElement("li",{className:(!0===grpLI?ej2_lists_es2015_cssClass.group:ej2_lists_es2015_cssClass.li)+" "+(isNullOrUndefined(className)?"":className),id:elementID,attrs:""!==ariaAttributes.groupItemRole&&""!==ariaAttributes.itemRole?{role:!0===grpLI?ariaAttributes.groupItemRole:ariaAttributes.itemRole}:{}});return dataSource&&fieldData.hasOwnProperty(fields.enabled)&&"false"===fieldData[fields.enabled].toString()&&li.classList.add(ej2_lists_es2015_cssClass.disabled),grpLI?li.innerText=text:(isNullOrUndefined(value)||li.setAttribute("data-value",value),li.setAttribute("role","option"),dataSource&&fieldData.hasOwnProperty(fields.htmlAttributes)&&fieldData[fields.htmlAttributes]&&setAttribute(li,fieldData[fields.htmlAttributes]),innerElements.length&&append(innerElements,li),li.appendChild(dataSource&&(fieldData[fields.url]||fieldData[fields.urlAttributes]&&fieldData[fields.urlAttributes].href)?anchorTag(createElement,dataSource,fields,text):document.createTextNode(text))),li}function getModuleClass(moduleName){return{li:`e-${moduleName}-item`,ul:`e-${moduleName}-parent e-ul`,group:`e-${moduleName}-group-item`,icon:`e-${moduleName}-icon`,text:`e-${moduleName}-text`,check:`e-${moduleName}-check`,checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:`e-${moduleName}-url`,collapsible:"e-icon-collapsible",disabled:"e-disabled",image:`e-${moduleName}-img`,iconWrapper:"e-icon-wrapper"}}function anchorTag(createElement,dataSource,fields,text){let fieldData=getFieldValues(dataSource,fields),attr={href:fieldData[fields.url]};fieldData.hasOwnProperty(fields.urlAttributes)&&fieldData[fields.urlAttributes]&&(ej2_base_es2015_merge(attr,fieldData[fields.urlAttributes]),attr.href=fieldData[fields.url]?fieldData[fields.url]:fieldData[fields.urlAttributes].href);let anchorTag=createElement("a",{className:ej2_lists_es2015_cssClass.text+" "+ej2_lists_es2015_cssClass.url,innerHTML:text});return setAttribute(anchorTag,attr),anchorTag}function generateLI(createElement,item,fieldData,fields,className,options){let uID,grpLI,dataSource,curOpt=extend({},defaultListBaseOptions,options),ariaAttributes=extend({},defaultAriaAttributes,curOpt.ariaAttributes),text=item;"string"!=typeof item&&"number"!=typeof item&&(dataSource=item,text=fieldData[fields.text]||"",uID=fieldData[fields.id],grpLI=!(!item.hasOwnProperty("isHeader")||!item.isHeader));let li=createElement("li",{className:(!0===grpLI?ej2_lists_es2015_cssClass.group:ej2_lists_es2015_cssClass.li)+" "+(isNullOrUndefined(className)?"":className),attrs:""!==ariaAttributes.groupItemRole&&""!==ariaAttributes.itemRole?{role:!0===grpLI?ariaAttributes.groupItemRole:ariaAttributes.itemRole}:{}});if(isNullOrUndefined(uID)?li.setAttribute("data-uid",generateId()):li.setAttribute("data-uid",uID),grpLI&&options&&options.groupTemplate)append(compile$$1(options.groupTemplate)(item,null,null,curOpt.groupTemplateID,!!curOpt.isStringTemplate),li);else if(!grpLI&&options&&options.template)append(compile$$1(options.template)(item,null,null,curOpt.templateID,!!curOpt.isStringTemplate),li);else{let innerDiv=createElement("div",{className:ej2_lists_es2015_cssClass.textContent,attrs:""!==ariaAttributes.wrapperRole?{role:ariaAttributes.wrapperRole}:{}});innerDiv.appendChild(dataSource&&(fieldData[fields.url]||fieldData[fields.urlAttributes]&&fieldData[fields.urlAttributes].href)?anchorTag(createElement,dataSource,fields,text):createElement("span",{className:ej2_lists_es2015_cssClass.text,innerHTML:text,attrs:""!==ariaAttributes.itemText?{role:ariaAttributes.itemText}:{}})),li.appendChild(innerDiv)}return li}function generateUL(createElement,liElement,className,options){let curOpt=extend({},defaultListBaseOptions,options),ariaAttributes=extend({},defaultAriaAttributes,curOpt.ariaAttributes),ulElement=createElement("ul",{className:(ej2_lists_es2015_cssClass=getModuleClass(curOpt.moduleName)).ul+" "+(isNullOrUndefined(className)?"":className),attrs:""!==ariaAttributes.listRole?{role:ariaAttributes.listRole}:{}});return append(liElement,ulElement),ulElement}ListBase.createList=function(createElement,dataSource,options,isSingleLevel){let curOpt=extend({},defaultListBaseOptions,options),ariaAttributes=extend({},defaultAriaAttributes,curOpt.ariaAttributes),type=typeofData(dataSource).typeof;return"string"===type||"number"===type?createListFromArray(createElement,dataSource,isSingleLevel,options):createListFromJson(createElement,dataSource,options,ariaAttributes.level,isSingleLevel)},ListBase.createListFromArray=createListFromArray,ListBase.createListItemFromArray=createListItemFromArray,ListBase.createListItemFromJson=createListItemFromJson,ListBase.createListFromJson=createListFromJson,ListBase.getSiblingLI=function(elementArray,element,isPrevious){if(ej2_lists_es2015_cssClass=getModuleClass(defaultListBaseOptions.moduleName),!elementArray||!elementArray.length)return;let siblingLI,liIndex,liCollections=Array.prototype.slice.call(elementArray);for(siblingLI=liCollections[(liIndex=element?indexOf(element,liCollections):!0===isPrevious?liCollections.length:-1)+(!0===isPrevious?-1:1)];siblingLI&&(!isVisible(siblingLI)||siblingLI.classList.contains(ej2_lists_es2015_cssClass.disabled));)siblingLI=liCollections[liIndex+=!0===isPrevious?-1:1];return siblingLI},ListBase.indexOf=indexOf,ListBase.groupDataSource=function(dataSource,fields,sortOrder="None"){let curFields=extend({},ListBase.defaultMappedFields,fields),cusQuery=(new ej2_data_es2015_Query).group(curFields.groupBy),ds=getDataSource(dataSource,cusQuery=addSorting(sortOrder,"key",cusQuery));dataSource=[];for(let j=0;j<ds.length;j++){let itemObj=ds[j].items,grpItem={},hdr="isHeader";grpItem[curFields.text]=ds[j].key,grpItem[hdr]=!0,grpItem.id="group-list-item-"+(ds[j].key?ds[j].key.toString().trim():"undefined"),grpItem.items=itemObj,dataSource.push(grpItem);for(let k=0;k<itemObj.length;k++)dataSource.push(itemObj[k])}return dataSource},ListBase.addSorting=addSorting,ListBase.getDataSource=getDataSource,ListBase.createJsonFromElement=function createJsonFromElement(element,options){let curOpt=extend({},defaultListBaseOptions,options),fields=extend({},ListBase.defaultMappedFields,curOpt.fields),curEle=element.cloneNode(!0),jsonAr=[];curEle.classList.add("json-parent");let childs=curEle.querySelectorAll(".json-parent>li");curEle.classList.remove("json-parent");for(let i=0;i<childs.length;i++){let li=childs[i],anchor=li.querySelector("a"),ul=li.querySelector("ul"),json={},childNodes=anchor?anchor.childNodes:li.childNodes,keys=Object.keys(childNodes);for(let i=0;i<childNodes.length;i++)childNodes[Number(keys[i])].hasChildNodes()||(json[fields.text]=childNodes[Number(keys[i])].textContent);let attributes$$1=getAllAttributes(li);attributes$$1.id?(json[fields.id]=attributes$$1.id,delete attributes$$1.id):json[fields.id]=generateId(),Object.keys(attributes$$1).length&&(json[fields.htmlAttributes]=attributes$$1),anchor&&(attributes$$1=getAllAttributes(anchor),Object.keys(attributes$$1).length&&(json[fields.urlAttributes]=attributes$$1)),ul&&(json[fields.child]=createJsonFromElement(ul,options)),jsonAr.push(json)}return jsonAr},ListBase.renderContentTemplate=function(createElement,template,dataSource,fields,options){let ulElement=createElement("ul",{className:(ej2_lists_es2015_cssClass=getModuleClass(defaultListBaseOptions.moduleName)).ul,attrs:{role:"presentation"}}),curOpt=extend({},defaultListBaseOptions,options),curFields=extend({},ListBase.defaultMappedFields,fields),compiledString=compile$$1(template),liCollection=[],id=generateId();for(let i=0;i<dataSource.length;i++){let fieldData=getFieldValues(dataSource[i],curFields),curItem=dataSource[i],isHeader=curItem.isHeader,value=fieldData[curFields.value];curOpt.itemCreating&&"function"==typeof curOpt.itemCreating&&curOpt.itemCreating({dataSource:dataSource,curData:curItem,text:value,options:curOpt,fields:curFields}),curOpt.itemCreating&&"function"==typeof curOpt.itemCreating&&(value=(fieldData=getFieldValues(dataSource[i],curFields))[curFields.value]);let li=createElement("li",{id:id+"-"+i,className:isHeader?ej2_lists_es2015_cssClass.group:ej2_lists_es2015_cssClass.li,attrs:{role:"presentation"}});isHeader?li.innerText=fieldData[curFields.text]:(append(compiledString(curItem,null,null,isHeader?curOpt.groupTemplateID:curOpt.templateID,!!curOpt.isStringTemplate),li),li.setAttribute("data-value",value),li.setAttribute("role","option")),curOpt.itemCreated&&"function"==typeof curOpt.itemCreated&&curOpt.itemCreated({dataSource:dataSource,curData:curItem,text:value,item:li,options:curOpt,fields:curFields}),liCollection.push(li)}return append(liCollection,ulElement),ulElement},ListBase.renderGroupTemplate=function(groupTemplate,groupDataSource,fields,headerItems,options){let compiledString=compile$$1(groupTemplate),curFields=extend({},ListBase.defaultMappedFields,fields),curOpt=extend({},defaultListBaseOptions,options),category=curFields.groupBy;for(let header of headerItems){let headerData={};headerData[category]=header.textContent,header.innerHTML="",append(compiledString(headerData,null,null,curOpt.groupTemplateID,!!curOpt.isStringTemplate),header)}return headerItems},ListBase.generateId=generateId,ListBase.generateUL=generateUL,ListBase.generateIcon=function(createElement,liElement,className,options){let curOpt=extend({},defaultListBaseOptions,options);return ej2_lists_es2015_cssClass=getModuleClass(curOpt.moduleName),("Left"===curOpt.expandIconPosition?prepend:append)([createElement("div",{className:"e-icons "+curOpt.expandIconClass+" "+(isNullOrUndefined(className)?"":className)})],liElement.querySelector("."+ej2_lists_es2015_cssClass.textContent)),liElement}}(ej2_lists_es2015_ListBase||(ej2_lists_es2015_ListBase={}));let ej2_dropdowns_es2015_queryString="",prevString="",ej2_dropdowns_es2015_matches=[];function ej2_dropdowns_es2015_Search(inputVal,items,searchType,ignoreCase){let listItems=items;ignoreCase=null==ignoreCase||ignoreCase;let itemData={item:null,index:null};if(inputVal&&inputVal.length){let strLength=inputVal.length,queryStr=ignoreCase?inputVal.toLocaleLowerCase():inputVal;for(let i=0,itemsData=listItems;i<itemsData.length;i++){let item=itemsData[i],text=(ignoreCase?item.textContent.toLocaleLowerCase():item.textContent).replace(/^\s+|\s+$/g,"");if("Equal"===searchType&&text===queryStr||"StartsWith"===searchType&&text.substr(0,strLength)===queryStr)return itemData.item=item,itemData.index=i,{item:item,index:i}}return itemData}return itemData}function highlightSearch(element,query,ignoreCase,type){if(""!==query){let ignoreRegex=ignoreCase?"gim":"gm";query=/^[a-zA-Z0-9- ]*$/.test(query)?query:query.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),function findTextNode(element,pattern){for(let index=0;element.childNodes&&index<element.childNodes.length;index++){if(3===element.childNodes[index].nodeType){element.innerHTML=element.innerHTML.replace(pattern,'<span class="e-highlight">$1</span>');break}findTextNode(element.childNodes[index],pattern)}}(element,new RegExp("StartsWith"===type?"^("+query+")":"EndsWith"===type?"("+query+")$":"("+query+")",ignoreRegex))}}let ej2_dropdowns_es2015_FieldSettings=(()=>{class FieldSettings extends ChildProperty{}return __decorate([Property()],FieldSettings.prototype,"text",void 0),__decorate([Property()],FieldSettings.prototype,"value",void 0),__decorate([Property()],FieldSettings.prototype,"iconCss",void 0),__decorate([Property()],FieldSettings.prototype,"groupBy",void 0),__decorate([Property()],FieldSettings.prototype,"htmlAttributes",void 0),FieldSettings})();const dropDownBaseClasses={root:"e-dropdownbase",rtl:"e-rtl",content:"e-content",selected:"e-active",hover:"e-hover",noData:"e-nodata",fixedHead:"e-fixed-head",focus:"e-item-focus",li:ej2_lists_es2015_cssClass.li,group:ej2_lists_es2015_cssClass.group,disabled:ej2_lists_es2015_cssClass.disabled,grouping:"e-dd-group"};let ej2_dropdowns_es2015_DropDownBase=(()=>{let DropDownBase=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}getPropObject(prop,newProp,oldProp){let newProperty=new Object,oldProperty=new Object,propName=prop=>prop;newProperty[propName(prop)]=newProp[propName(prop)],oldProperty[propName(prop)]=oldProp[propName(prop)];let data=new Object;return data.newProperty=newProperty,data.oldProperty=oldProperty,data}getValueByText(text,ignoreCase,ignoreAccent){let value=null;return isNullOrUndefined(this.listData)||(value=this.checkValueCase(text,!!ignoreCase,ignoreAccent)),value}checkValueCase(text,ignoreCase,ignoreAccent,isTextByValue){let value=null;isTextByValue&&(value=text);let dataSource=this.listData,fields=this.fields,type=this.typeOfData(dataSource).typeof;if("string"===type||"number"===type||"boolean"===type)for(let item of dataSource)isNullOrUndefined(item)||(ignoreAccent?value=this.checkingAccent(String(item),text,ignoreCase):ignoreCase?this.checkIgnoreCase(String(item),text)&&(value=this.getItemValue(String(item),text,ignoreCase)):this.checkNonIgnoreCase(String(item),text)&&(value=this.getItemValue(String(item),text,ignoreCase,isTextByValue)));else dataSource.filter(ignoreCase?item=>{!isNullOrUndefined(getValue(fields.value,item))&&this.checkIgnoreCase(getValue(fields.text,item).toString(),text)&&(value=getValue(fields.value,item))}:isTextByValue?item=>{let itemValue=getValue(fields.value,item);isNullOrUndefined(itemValue)||isNullOrUndefined(value)||itemValue.toString()!==value.toString()||(value=getValue(fields.text,item))}:item=>{this.checkNonIgnoreCase(getValue(fields.text,item),text)&&(value=getValue(fields.value,item))});return value}checkingAccent(item,text,ignoreCase){let dataItem=ej2_data_es2015_DataUtil.ignoreDiacritics(String(item)),textItem=ej2_data_es2015_DataUtil.ignoreDiacritics(text.toString()),value=null;return ignoreCase?this.checkIgnoreCase(dataItem,textItem)&&(value=this.getItemValue(String(item),text,ignoreCase)):this.checkNonIgnoreCase(String(item),text)&&(value=this.getItemValue(String(item),text,ignoreCase)),value}checkIgnoreCase(item,text){return String(item).toLowerCase()===text.toString().toLowerCase()}checkNonIgnoreCase(item,text){return String(item)===text.toString()}getItemValue(dataItem,typedText,ignoreCase,isTextByValue){let type=this.typeOfData(this.listData).typeof;return isTextByValue?dataItem.toString():ignoreCase?"string"===type?String(dataItem):this.getFormattedValue(String(dataItem)):"string"===type?typedText:this.getFormattedValue(typedText)}l10nUpdate(actionFailure){let ele="listbox"===this.getModuleName()?this.ulElement:this.list;if("No Records Found"!==this.noRecordsTemplate||"The Request Failed"!==this.actionFailureTemplate){this.DropDownBaseresetBlazorTemplates(!1,!1,!0,!0);let compiledString,template=actionFailure?this.actionFailureTemplate:this.noRecordsTemplate,templateId=actionFailure?this.actionFailureTemplateId:this.noRecordsTemplateId;ele.innerHTML="",compiledString=compile$$1(template);for(let item of compiledString({},null,null,templateId,this.isStringTemplate))ele.appendChild(item);this.DropDownBaseupdateBlazorTemplates(!1,!1,!actionFailure,actionFailure)}else{let l10nLocale={noRecordsTemplate:"No Records Found",actionFailureTemplate:"The Request Failed"},componentLocale=new L10n(this.getLocaleName(),{},this.locale);this.l10n=""!==componentLocale.getConstant("actionFailureTemplate")?componentLocale:new L10n("listbox"===this.getModuleName()?"listbox":"dropdowns",l10nLocale,this.locale),ele.innerHTML=this.l10n.getConstant(actionFailure?"actionFailureTemplate":"noRecordsTemplate")}}getLocaleName(){return"drop-down-base"}getTextByValue(value){return this.checkValueCase(value,!1,!1,!0)}getFormattedValue(value){if(this.listData&&this.listData.length){let item=this.typeOfData(this.listData);if("number"==typeof getValue(this.fields.value?this.fields.value:"value",item.item)||"number"===item.typeof)return parseInt(value,10);if("boolean"==typeof getValue(this.fields.value?this.fields.value:"value",item.item)||"boolean"===item.typeof)return"true"===value}return value}setEnableRtl(){this.list&&this.enableRtlElements.push(this.list),this.enableRtl?addClass(this.enableRtlElements,dropDownBaseClasses.rtl):removeClass(this.enableRtlElements,dropDownBaseClasses.rtl)}initialize(){if(this.bindEvent=!0,this.actionFailureTemplateId=`${this.element.id}ActionFailureTemplate`,"UL"===this.element.tagName){let jsonElement=ej2_lists_es2015_ListBase.createJsonFromElement(this.element);this.setProperties({fields:{text:"text",value:"text"}},!0),this.resetList(jsonElement,this.fields)}else"SELECT"===this.element.tagName?(this.dataSource instanceof Array?this.dataSource.length>0:!isNullOrUndefined(this.dataSource))||this.renderItemsBySelect():this.setListData(this.dataSource,this.fields,this.query)}DropDownBaseupdateBlazorTemplates(item,group,noRecord,action,value,header,footer,isEmpty){this.isStringTemplate||(this.itemTemplate&&item&&updateBlazorTemplate(this.itemTemplateId,"ItemTemplate",this),this.groupTemplate&&group&&updateBlazorTemplate(this.groupTemplateId,"GroupTemplate",this),this.noRecordsTemplate&&noRecord&&updateBlazorTemplate(this.noRecordsTemplateId,"NoRecordsTemplate",this),this.actionFailureTemplate&&action&&updateBlazorTemplate(this.actionFailureTemplateId,"ActionFailureTemplate",this),value&&updateBlazorTemplate(this.valueTemplateId,"ValueTemplate",this,isEmpty),header&&updateBlazorTemplate(this.headerTemplateId,"HeaderTemplate",this),footer&&updateBlazorTemplate(this.footerTemplateId,"FooterTemplate",this))}DropDownBaseresetBlazorTemplates(item,group,noRecord,action,value,header,footer){this.isStringTemplate||(this.itemTemplate&&item&&resetBlazorTemplate(this.itemTemplateId),this.groupTemplate&&group&&resetBlazorTemplate(this.groupTemplateId),this.noRecordsTemplate&&noRecord&&resetBlazorTemplate(this.noRecordsTemplateId),this.actionFailureTemplate&&action&&resetBlazorTemplate(this.actionFailureTemplateId),value&&resetBlazorTemplate(this.valueTemplateId),header&&resetBlazorTemplate(this.headerTemplateId),footer&&resetBlazorTemplate(this.footerTemplateId))}getPersistData(){return this.addOnPersist([])}setEnabled(){this.element.setAttribute("aria-disabled",this.enabled?"false":"true")}updateDataAttribute(value){let invalidAttr=["class","style","id","type"],attr={};for(let a=0;a<this.element.attributes.length;a++)-1!==invalidAttr.indexOf(this.element.attributes[a].name)||"dropdownlist"===this.getModuleName()&&"readonly"===this.element.attributes[a].name||(attr[this.element.attributes[a].name]=this.element.getAttribute(this.element.attributes[a].name));extend(attr,value,attr),this.setProperties({htmlAttributes:attr},!0)}renderItemsBySelect(){let element=this.element,fields={value:"value",text:"text"},jsonElement=[],group=element.querySelectorAll("select>optgroup"),option=element.querySelectorAll("select>option");if(this.getJSONfromOption(jsonElement,option,fields),group.length){for(let i=0;i<group.length;i++){let item=group[i],optionGroup={};optionGroup[fields.text]=item.label,optionGroup.isHeader=!0;let child=item.querySelectorAll("option");jsonElement.push(optionGroup),this.getJSONfromOption(jsonElement,child,fields)}element.querySelectorAll("select>option")}this.fields.text=fields.text,this.fields.value=fields.value,this.resetList(jsonElement,fields)}getJSONfromOption(items,options,fields){for(let option of options){let json={};json[fields.text]=option.innerText,json[fields.value]=option.getAttribute(fields.value)?option.getAttribute(fields.value):option.innerText,items.push(json)}}preRender(){this.scrollTimer=-1,this.enableRtlElements=[],this.isRequested=!1,this.isDataFetched=!1,this.itemTemplateId=`${this.element.id}ItemTemplate`,this.valueTemplateId=`${this.element.id}ValueTemplate`,this.groupTemplateId=`${this.element.id}GroupTemplate`,this.headerTemplateId=`${this.element.id}HeaderTemplate`,this.footerTemplateId=`${this.element.id}FooterTemplate`,this.noRecordsTemplateId=`${this.element.id}NoRecordsTemplate`}setListData(dataSource,fields,query){let ulElement;fields=fields||this.fields,this.isActive=!0,this.trigger("actionBegin",{cancel:!1,data:dataSource,query:query},eventArgs=>{if(!eventArgs.cancel)if(this.showSpinner(),dataSource instanceof ej2_data_es2015_DataManager){if(this.isRequested=!0,this.isDataFetched)return void this.emptyDataRequest(fields);eventArgs.data.executeQuery(this.getQuery(eventArgs.query)).then(e=>{this.trigger("actionComplete",e,e=>{if(!e.cancel){let listItems=e.result;0===listItems.length&&(this.isDataFetched=!0),ulElement=this.renderItems(listItems,fields),this.onActionComplete(ulElement,listItems,e),this.groupTemplate&&this.renderGroupTemplate(ulElement),this.isRequested=!1,this.bindChildItems(listItems,ulElement,fields,e)}})}).catch(e=>{this.isRequested=!1,this.onActionFailure(e),this.hideSpinner()})}else{let dataManager=new ej2_data_es2015_DataManager(eventArgs.data),listItems=this.getQuery(eventArgs.query).executeLocal(dataManager);this.trigger("actionComplete",{cancel:!1,result:listItems},localDataArgs=>{localDataArgs.cancel||(ulElement=this.renderItems(localDataArgs.result,fields),this.onActionComplete(ulElement,localDataArgs.result),this.groupTemplate&&this.renderGroupTemplate(ulElement),this.bindChildItems(localDataArgs.result,ulElement,fields))})}})}bindChildItems(listItems,ulElement,fields,e){listItems.length>=100&&"autocomplete"===this.getModuleName()?setTimeout(()=>{append(this.remainingItems(this.sortedData,fields),ulElement),this.DropDownBaseupdateBlazorTemplates(!0,!1,!1,!1),this.liCollections=this.list.querySelectorAll("."+dropDownBaseClasses.li),this.updateListValues(),this.raiseDataBound(listItems,e)},0):this.raiseDataBound(listItems,e)}updateListValues(){}findListElement(list,findNode,attribute,value){let liElement=null,listArr=[].slice.call(list.querySelectorAll(findNode));for(let index=0;index<listArr.length;index++)if(listArr[index].getAttribute(attribute)===value+""){liElement=listArr[index];break}return liElement}raiseDataBound(listItems,e){this.hideSpinner(),this.trigger("dataBound",{items:listItems,e:e})}remainingItems(dataSource,fields){let spliceData=new ej2_data_es2015_DataManager(dataSource).executeLocal((new ej2_data_es2015_Query).skip(100));if(this.itemTemplate){let listElements=this.templateListItem(spliceData,fields);return[].slice.call(listElements.childNodes)}let type=this.typeOfData(spliceData).typeof;return"string"===type||"number"===type||"boolean"===type?ej2_lists_es2015_ListBase.createListItemFromArray(this.createElement,spliceData,!0,this.listOption(spliceData,fields)):ej2_lists_es2015_ListBase.createListItemFromJson(this.createElement,spliceData,this.listOption(spliceData,fields),1,!0)}emptyDataRequest(fields){let listItems=[];this.onActionComplete(this.renderItems(listItems,fields),listItems),this.isRequested=!1,this.hideSpinner()}showSpinner(){}hideSpinner(){}onActionFailure(e){this.liCollections=[],this.trigger("actionFailure",e),this.l10nUpdate(!0),addClass([this.list],dropDownBaseClasses.noData)}onActionComplete(ulElement,list,e){this.listData=list,this.list.innerHTML="",this.list.appendChild(ulElement),this.liCollections=this.list.querySelectorAll("."+dropDownBaseClasses.li),this.ulElement=this.list.querySelector("ul"),this.postRender(this.list,list,this.bindEvent)}postRender(listElement,list,bindEvent){let focusItem=listElement.querySelector("."+dropDownBaseClasses.li),selectedItem=listElement.querySelector("."+dropDownBaseClasses.selected);focusItem&&!selectedItem&&focusItem.classList.add(dropDownBaseClasses.focus),list.length<=0?(this.l10nUpdate(),addClass([listElement],dropDownBaseClasses.noData)):listElement.classList.remove(dropDownBaseClasses.noData)}getQuery(query){return query||(this.query?this.query:new ej2_data_es2015_Query)}renderGroupTemplate(listEle){if(null!==this.fields.groupBy&&this.dataSource||this.element.querySelector("."+dropDownBaseClasses.group)){let dataSource=this.dataSource,option={groupTemplateID:this.groupTemplateId,isStringTemplate:this.isStringTemplate},headerItems=listEle.querySelectorAll("."+dropDownBaseClasses.group);ej2_lists_es2015_ListBase.renderGroupTemplate(this.groupTemplate,dataSource,this.fields.properties,headerItems,option),this.DropDownBaseupdateBlazorTemplates(!1,!0,!1,!1)}}createListItems(dataSource,fields){dataSource&&fields.groupBy||this.element.querySelector("optgroup")?(fields.groupBy&&("None"!==this.sortOrder&&(dataSource=this.getSortedDataSource(dataSource)),dataSource=ej2_lists_es2015_ListBase.groupDataSource(dataSource,fields.properties,this.sortOrder)),addClass([this.list],dropDownBaseClasses.grouping)):dataSource=this.getSortedDataSource(dataSource);let options=this.listOption(dataSource,fields),spliceData=dataSource.length>100?new ej2_data_es2015_DataManager(dataSource).executeLocal((new ej2_data_es2015_Query).take(100)):dataSource;return this.sortedData=dataSource,ej2_lists_es2015_ListBase.createList(this.createElement,"autocomplete"===this.getModuleName()?spliceData:dataSource,options,!0)}listOption(dataSource,fields){let iconCss=!isNullOrUndefined(fields.iconCss),fieldValues=isNullOrUndefined(fields.properties)?fields:fields.properties;return extend({},null!==fields.text||null!==fields.value?{fields:fieldValues,showIcon:iconCss,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}},fields,!0)}setFloatingHeader(e){isNullOrUndefined(this.fixedHeaderElement)&&(this.fixedHeaderElement=this.createElement("div",{className:dropDownBaseClasses.fixedHead}),this.list.querySelector("li").classList.contains(dropDownBaseClasses.group)||(this.fixedHeaderElement.style.display="none"),prepend([this.fixedHeaderElement],this.list),this.setFixedHeader()),isNullOrUndefined(this.fixedHeaderElement)||"0"!==this.fixedHeaderElement.style.zIndex||this.setFixedHeader(),this.scrollStop(e)}scrollStop(e){let target=e.target,liHeight=parseInt(getComputedStyle(this.liCollections[0],null).getPropertyValue("height"),10),topIndex=Math.round(target.scrollTop/liHeight),liCollections=this.ulElement.querySelectorAll("li");for(let i=topIndex;i>-1;i--){if(!isNullOrUndefined(liCollections[i])&&liCollections[i].classList.contains(dropDownBaseClasses.group)){this.fixedHeaderElement.innerHTML=liCollections[i].innerHTML,this.fixedHeaderElement.style.top=e.target.scrollTop+"px",this.fixedHeaderElement.style.display="block";break}this.fixedHeaderElement.style.display="none",this.fixedHeaderElement.style.top="none"}}renderItems(listData,fields){let ulElement;if(this.itemTemplate&&listData){let dataSource=listData;dataSource&&fields.groupBy?("None"!==this.sortOrder&&(dataSource=this.getSortedDataSource(dataSource)),dataSource=ej2_lists_es2015_ListBase.groupDataSource(dataSource,fields.properties,this.sortOrder)):dataSource=this.getSortedDataSource(dataSource),this.sortedData=dataSource;let spliceData=dataSource.length>100?new ej2_data_es2015_DataManager(dataSource).executeLocal((new ej2_data_es2015_Query).take(100)):dataSource;ulElement=this.templateListItem("autocomplete"===this.getModuleName()?spliceData:dataSource,fields),this.DropDownBaseupdateBlazorTemplates(!0,!1,!1,!1)}else ulElement=this.createListItems(listData,fields);return ulElement}templateListItem(dataSource,fields){this.DropDownBaseresetBlazorTemplates(!0,!1,!1,!1);let option=this.listOption(dataSource,fields);return option.templateID=this.itemTemplateId,option.isStringTemplate=this.isStringTemplate,ej2_lists_es2015_ListBase.renderContentTemplate(this.createElement,this.itemTemplate,dataSource,fields.properties,option)}typeOfData(items){for(let i=0;!isNullOrUndefined(items)&&i<items.length;i++)if(!isNullOrUndefined(items[i]))return{typeof:typeof items[i],item:items[i]};return{typeof:null,item:null}}setFixedHeader(){this.list.parentElement.style.display="block",this.fixedHeaderElement.style.width=this.liCollections[0].offsetWidth.toString()+"px",setStyleAttribute(this.fixedHeaderElement,{zIndex:10});let firstLi=this.ulElement.querySelector("."+dropDownBaseClasses.group);this.fixedHeaderElement.innerHTML=firstLi.innerHTML}getSortedDataSource(dataSource){return dataSource&&"None"!==this.sortOrder&&(dataSource=ej2_lists_es2015_ListBase.getDataSource(dataSource,ej2_lists_es2015_ListBase.addSorting(this.sortOrder,this.fields.text?this.fields.text:"text"))),dataSource}getIndexByValue(value){let index,listItems=this.getItems();for(let i=0;i<listItems.length;i++)if(!isNullOrUndefined(value)&&listItems[i].getAttribute("data-value")===value.toString()){index=i;break}return index}dispatchEvent(element,type){let evt=document.createEvent("HTMLEvents");evt.initEvent(type,!1,!0),element.dispatchEvent(evt)}setFields(){this.fields.value&&!this.fields.text?this.fields.text=this.fields.value:!this.fields.value&&this.fields.text?this.fields.value=this.fields.text:this.fields.value||this.fields.text||(this.fields.value=this.fields.text="text")}resetList(dataSource,fields,query){this.list&&this.setListData(dataSource,fields,query)}updateSelection(){}renderList(){this.render()}updateDataSource(props){this.resetList(this.dataSource)}setUpdateInitial(props,newProp){this.isDataFetched=!1;let updateData={};for(let j=0;props.length>j;j++)newProp[props[j]]&&"fields"===props[j]?this.setFields():newProp[props[j]]&&(updateData[props[j]]=newProp[props[j]]);Object.keys(updateData).length>0&&(-1===Object.keys(updateData).indexOf("dataSource")&&(updateData.dataSource=this.dataSource),this.updateDataSource(updateData))}onPropertyChanged(newProp,oldProp){"dropdownbase"===this.getModuleName()&&this.setUpdateInitial(["fields","query","dataSource"],newProp),this.setUpdateInitial(["sortOrder","itemTemplate"],newProp);for(let prop of Object.keys(newProp))switch(prop){case"query":case"sortOrder":case"dataSource":case"itemTemplate":break;case"enableRtl":this.setEnableRtl();break;case"enabled":this.setEnabled();break;case"groupTemplate":if(this.renderGroupTemplate(this.list),this.ulElement&&this.fixedHeaderElement){let firstLi=this.ulElement.querySelector("."+dropDownBaseClasses.group);this.fixedHeaderElement.innerHTML=firstLi.innerHTML}break;case"locale":this.list&&!isNullOrUndefined(this.liCollections)&&0===this.liCollections.length&&this.l10nUpdate();break;case"zIndex":this.setProperties({zIndex:newProp.zIndex},!0),this.setZIndex()}}render(isEmptyData){this.list=this.createElement("div",{className:dropDownBaseClasses.content,attrs:{tabindex:"0"}}),this.list.classList.add(dropDownBaseClasses.root),this.setFields(),this.rippleFun=rippleEffect(this.list,{duration:300,selector:"."+dropDownBaseClasses.li});let group=this.element.querySelector("select>optgroup");if(!this.fields.groupBy&&isNullOrUndefined(group)||this.isGroupChecking||EventHandler.add(this.list,"scroll",this.setFloatingHeader,this),"dropdownbase"===this.getModuleName()){this.element.getAttribute("tabindex")&&this.list.setAttribute("tabindex",this.element.getAttribute("tabindex")),removeClass([this.element],dropDownBaseClasses.root),this.element.style.display="none";let wrapperElement=this.createElement("div");this.element.parentElement.insertBefore(wrapperElement,this.element),wrapperElement.appendChild(this.element),wrapperElement.appendChild(this.list)}this.setEnableRtl(),this.setEnabled(),isEmptyData||this.initialize()}getModuleName(){return"dropdownbase"}getItems(){return this.ulElement.querySelectorAll("."+dropDownBaseClasses.li)}addItem(items,itemIndex){this.list&&this.list.textContent!==this.noRecordsTemplate||this.renderList(),this.DropDownBaseresetBlazorTemplates(!0,!1,!1,!1);let index,itemsCount=this.getItems().length,selectedItemValue=this.list.querySelector("."+dropDownBaseClasses.selected);items=items instanceof Array?items:[items],index=isNullOrUndefined(itemIndex)||itemIndex<0||itemIndex>itemsCount-1?itemsCount:itemIndex;let fields=this.fields;items&&fields.groupBy&&(items=ej2_lists_es2015_ListBase.groupDataSource(items,fields.properties));let liCollections=[];for(let i=0;i<items.length;i++){let item=items[i],isHeader=item.isHeader,li=this.createElement("li",{className:isHeader?dropDownBaseClasses.group:dropDownBaseClasses.li,id:"option-add-"+i}),itemText=item instanceof Object?getValue(fields.text,item):item;isHeader&&(li.innerText=itemText),this.itemTemplate&&!isHeader?(append(compile$$1(this.itemTemplate)(item,null,null,this.itemTemplateId,this.isStringTemplate),li),this.DropDownBaseupdateBlazorTemplates(!0,!1,!1,!1)):isHeader||li.appendChild(document.createTextNode(itemText)),li.setAttribute("data-value",item instanceof Object?getValue(fields.value,item):item),li.setAttribute("role","option"),this.notify("addItem",{module:"CheckBoxSelection",item:li}),liCollections.push(li),this.listData.push(item),this.updateActionCompleteData(li,item)}if(0===itemsCount&&isNullOrUndefined(this.list.querySelector("ul")))this.list.innerHTML="",this.list.classList.remove(dropDownBaseClasses.noData),this.list.appendChild(this.ulElement),append(liCollections,this.ulElement);else for(let i=0;i<items.length;i++){this.liCollections[index]?this.liCollections[index].parentNode.insertBefore(liCollections[i],this.liCollections[index]):this.ulElement.appendChild(liCollections[i]);let tempLi=[].slice.call(this.liCollections);tempLi.splice(index,0,liCollections[i]),this.liCollections=tempLi,index+=1}(selectedItemValue||0===itemIndex)&&this.updateSelection()}validationAttribute(target,hidden){let name=target.getAttribute("name")?target.getAttribute("name"):target.getAttribute("id");hidden.setAttribute("name",name),target.removeAttribute("name");let attributes$$1=["required","aria-required","form"];for(let i=0;i<attributes$$1.length;i++){if(!target.getAttribute(attributes$$1[i]))continue;let attr=target.getAttribute(attributes$$1[i]);hidden.setAttribute(attributes$$1[i],attr),target.removeAttribute(attributes$$1[i])}}setZIndex(){}updateActionCompleteData(li,item){}getDataByValue(value){if(!isNullOrUndefined(this.listData)){let type=this.typeOfData(this.listData).typeof;if("string"===type||"number"===type||"boolean"===type){for(let item of this.listData)if(!isNullOrUndefined(item)&&item===value)return item}else for(let item of this.listData)if(!isNullOrUndefined(item)&&getValue(this.fields.value?this.fields.value:"value",item)===value)return item}return null}destroy(){document.body.contains(this.list)&&(EventHandler.remove(this.list,"scroll",this.setFloatingHeader),isNullOrUndefined(this.rippleFun)||this.rippleFun(),detach(this.list)),super.destroy()}};return __decorate([Complex({text:null,value:null,iconCss:null,groupBy:null},ej2_dropdowns_es2015_FieldSettings)],DropDownBase.prototype,"fields",void 0),__decorate([Property(!1)],DropDownBase.prototype,"enablePersistence",void 0),__decorate([Property(null)],DropDownBase.prototype,"itemTemplate",void 0),__decorate([Property(null)],DropDownBase.prototype,"groupTemplate",void 0),__decorate([Property("No Records Found")],DropDownBase.prototype,"noRecordsTemplate",void 0),__decorate([Property("The Request Failed")],DropDownBase.prototype,"actionFailureTemplate",void 0),__decorate([Property("None")],DropDownBase.prototype,"sortOrder",void 0),__decorate([Property(!0)],DropDownBase.prototype,"enabled",void 0),__decorate([Property([])],DropDownBase.prototype,"dataSource",void 0),__decorate([Property(null)],DropDownBase.prototype,"query",void 0),__decorate([Property("StartsWith")],DropDownBase.prototype,"filterType",void 0),__decorate([Property(!0)],DropDownBase.prototype,"ignoreCase",void 0),__decorate([Property(1e3)],DropDownBase.prototype,"zIndex",void 0),__decorate([Property(!1)],DropDownBase.prototype,"ignoreAccent",void 0),__decorate([Property()],DropDownBase.prototype,"locale",void 0),__decorate([ej2_base_es2015_Event()],DropDownBase.prototype,"actionBegin",void 0),__decorate([ej2_base_es2015_Event()],DropDownBase.prototype,"actionComplete",void 0),__decorate([ej2_base_es2015_Event()],DropDownBase.prototype,"actionFailure",void 0),__decorate([ej2_base_es2015_Event()],DropDownBase.prototype,"select",void 0),__decorate([ej2_base_es2015_Event()],DropDownBase.prototype,"dataBound",void 0),__decorate([ej2_base_es2015_Event()],DropDownBase.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],DropDownBase.prototype,"destroyed",void 0),__decorate([NotifyPropertyChanges],DropDownBase)})();const dropDownListClasses={root:"e-dropdownlist",hover:dropDownBaseClasses.hover,selected:dropDownBaseClasses.selected,rtl:dropDownBaseClasses.rtl,li:dropDownBaseClasses.li,disable:dropDownBaseClasses.disabled,base:dropDownBaseClasses.root,focus:dropDownBaseClasses.focus,input:"e-input-group",inputFocus:"e-input-focus",icon:"e-input-group-icon e-ddl-icon",iconAnimation:"e-icon-anim",value:"e-input-value",device:"e-ddl-device",backIcon:"e-input-group-icon e-back-icon e-icons",filterBarClearIcon:"e-input-group-icon e-clear-icon e-icons",filterInput:"e-input-filter",filterParent:"e-filter-parent",mobileFilter:"e-ddl-device-filter",footer:"e-ddl-footer",header:"e-ddl-header",clearIcon:"e-clear-icon",clearIconHide:"e-clear-icon-hide",popupFullScreen:"e-popup-full-page",disableIcon:"e-ddl-disable-icon",hiddenElement:"e-ddl-hidden"};let ej2_dropdowns_es2015_inputObject={container:null,buttons:[]},ej2_dropdowns_es2015_DropDownList=(()=>{let DropDownList=class extends ej2_dropdowns_es2015_DropDownBase{constructor(options,element){super(options,element),this.previousValue=null}preRender(){this.element.style.opacity="0",this.initializeData(),super.preRender(),this.activeIndex=this.index,this.queryString=""}initializeData(){this.isPopupOpen=!1,this.isDocumentClick=!1,this.isInteracted=!1,this.isFilterFocus=!1,this.beforePopupOpen=!1,this.initial=!0,this.initRemoteRender=!1,this.isNotSearchList=!1,this.isTyped=!1,this.isSelected=!1,this.preventFocus=!1,this.preventAutoFill=!1,this.isValidKey=!1,this.typedString="",this.isEscapeKey=!1,this.isPreventBlur=!1,this.isTabKey=!1,this.actionCompleteData={isUpdated:!1},this.prevSelectPoints={},this.isSelectCustom=!1,this.isDropDownClick=!1,this.preventAltUp=!1,this.isCustomFilter=!1,this.isSecondClick=!1,this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"}}setZIndex(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})}renderList(isEmptyData){super.render(isEmptyData),this.wireListEvents()}floatLabelChange(){if("dropdownlist"===this.getModuleName()&&"Auto"===this.floatLabelType){let floatElement=this.inputWrapper.container.querySelector(".e-float-text");""!==this.inputElement.value||this.isInteracted?ej2_base_es2015_classList(floatElement,["e-label-top"],["e-label-bottom"]):ej2_base_es2015_classList(floatElement,["e-label-bottom"],["e-label-top"])}}resetHandler(e){e.preventDefault(),this.clear(e)}resetFocusElement(){if(this.removeHover(),this.removeSelection(),this.removeFocus(),this.list.scrollTop=0,"autocomplete"!==this.getModuleName()){let li=this.ulElement.querySelector("."+dropDownListClasses.li);li&&li.classList.add(dropDownListClasses.focus)}}clear(e,properties){!isNullOrUndefined(properties)&&(isNullOrUndefined(properties)||!isNullOrUndefined(properties.dataSource)&&(properties.dataSource instanceof ej2_data_es2015_DataManager||0!==properties.dataSource.length))||(this.isActive=!0,this.resetSelection(properties));let dataItem=this.getItemData();this.previousValue!==dataItem.value&&this.onChangeEvent(e)}resetSelection(properties){this.list&&(isNullOrUndefined(properties)||!isNullOrUndefined(properties.dataSource)&&(properties.dataSource instanceof ej2_data_es2015_DataManager||0!==properties.dataSource.length)?(!this.allowFiltering||"autocomplete"===this.getModuleName()||isNullOrUndefined(this.actionCompleteData.ulElement)||isNullOrUndefined(this.actionCompleteData.list)||this.onActionComplete(this.actionCompleteData.ulElement.cloneNode(!0),this.actionCompleteData.list),this.resetFocusElement()):(this.selectedLI=null,this.actionCompleteData.isUpdated=!1,this.actionCompleteData.ulElement=null,this.actionCompleteData.list=null,this.resetList(properties.dataSource))),this.hiddenElement.innerHTML="",this.inputElement.value="",this.value=null,this.itemData=null,this.text=null,this.index=null,this.activeIndex=null,this.item=null,this.queryString="",this.valueTempElement&&(detach(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null),this.setSelection(null,null),this.isSelectCustom=!1,this.updateIconState(),this.cloneElements()}setHTMLAttributes(){if(Object.keys(this.htmlAttributes).length)for(let htmlAttr of Object.keys(this.htmlAttributes))if("class"===htmlAttr)this.inputWrapper.container.classList.add(this.htmlAttributes[htmlAttr]);else if("disabled"===htmlAttr&&"disabled"===this.htmlAttributes[htmlAttr])this.enabled=!1,this.setEnable();else if("readonly"!==htmlAttr||isNullOrUndefined(this.htmlAttributes[htmlAttr]))if("style"===htmlAttr)this.inputWrapper.container.setAttribute("style",this.htmlAttributes[htmlAttr]);else{let defaultAttr=["title","id","placeholder","aria-placeholder","role","autocorrect","autocomplete","autocapitalize","spellcheck","minlength","maxlength"],validateAttr=["name","required"];0===htmlAttr.indexOf("data")||validateAttr.indexOf(htmlAttr)>-1?this.hiddenElement.setAttribute(htmlAttr,this.htmlAttributes[htmlAttr]):defaultAttr.indexOf(htmlAttr)>-1?"placeholder"===htmlAttr?ej2_inputs_es2015_Input.setPlaceholder(this.htmlAttributes[htmlAttr],this.inputElement):this.inputElement.setAttribute(htmlAttr,this.htmlAttributes[htmlAttr]):this.inputWrapper.container.setAttribute(htmlAttr,this.htmlAttributes[htmlAttr])}else this.readonly=!0,this.dataBind();"autocomplete"!==this.getModuleName()&&"combobox"!==this.getModuleName()||this.inputWrapper.container.removeAttribute("tabindex")}getAriaAttributes(){return{"aria-disabled":"false","aria-owns":this.element.id+"_options",role:"listbox","aria-haspopup":"true","aria-expanded":"false","aria-activedescendant":"null","aria-labelledby":this.hiddenElement.id}}setEnableRtl(){ej2_inputs_es2015_Input.setEnableRtl(this.enableRtl,[this.inputElement.parentElement]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())}setEnable(){ej2_inputs_es2015_Input.setEnabled(this.enabled,this.inputElement),this.enabled?(removeClass([this.inputWrapper.container],dropDownListClasses.disable),this.inputElement.setAttribute("aria-disabled","false"),this.targetElement().setAttribute("tabindex",this.tabIndex)):(this.hidePopup(),addClass([this.inputWrapper.container],dropDownListClasses.disable),this.inputElement.setAttribute("aria-disabled","true"),this.targetElement().tabIndex=-1)}getPersistData(){return this.addOnPersist(["value"])}getLocaleName(){return"drop-down-list"}preventTabIndex(element){"dropdownlist"===this.getModuleName()&&(element.tabIndex=-1)}targetElement(){return this.inputWrapper.container}getNgDirective(){return"EJS-DROPDOWNLIST"}getElementByText(text){return this.getElementByValue(this.getValueByText(text))}getElementByValue(value){let item,listItems=this.getItems();for(let liItem of listItems)if(this.getFormattedValue(liItem.getAttribute("data-value"))===value){item=liItem;break}return item}initValue(){this.renderList(),this.dataSource instanceof ej2_data_es2015_DataManager?this.initRemoteRender=!0:this.updateValues()}updateValues(){if(isNullOrUndefined(this.value))if(this.text&&isNullOrUndefined(this.value)){let element=this.getElementByText(this.text);if(isNullOrUndefined(element))return void this.setProperties({text:null});this.setSelection(element,null)}else this.setSelection(this.liCollections[this.activeIndex],null);else this.setSelection(this.getElementByValue(this.value),null);this.setHiddenValue(),ej2_inputs_es2015_Input.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)}onBlur(e){if(!this.enabled)return;let target=e.relatedTarget,currentTarget=e.target,isPreventBlur=this.isPreventBlur;this.isPreventBlur=!1,!isPreventBlur||this.isDocumentClick||!this.isPopupOpen||isNullOrUndefined(currentTarget)&&(this.isFilterLayout()||!isNullOrUndefined(target))?this.isDocumentClick||!isNullOrUndefined(this.popupObj)&&document.body.contains(this.popupObj.element)&&this.popupObj.element.classList.contains(dropDownListClasses.mobileFilter)?this.beforePopupOpen||(this.isDocumentClick=!1):(("dropdownlist"===this.getModuleName()&&!this.isFilterFocus&&target!==this.inputElement&&(document.activeElement!==target||document.activeElement===target&&currentTarget.classList.contains(dropDownListClasses.inputFocus))||isNullOrUndefined(target)&&"dropdownlist"===this.getModuleName()&&this.allowFiltering&&currentTarget!==this.inputWrapper.container||"dropdownlist"!==this.getModuleName()&&!this.inputWrapper.container.contains(target)||this.isTabKey)&&(this.isDocumentClick=!!this.isPopupOpen,this.focusOutAction(),this.isTabKey=!1),!this.isRequested||this.isPopupOpen||this.isPreventBlur||(this.isActive=!1,this.beforePopupOpen=!1)):"dropdownlist"===this.getModuleName()&&this.allowFiltering&&this.isPopupOpen?this.filterInput.focus():this.targetElement().focus()}focusOutAction(){this.isInteracted=!1,this.focusOut(),this.onFocusOut()}onFocusOut(){this.enabled&&(this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(null)),this.floatLabelChange(),this.dispatchEvent(this.hiddenElement,"change"),"dropdownlist"===this.getModuleName()&&"INPUT"!==this.element.tagName&&this.dispatchEvent(this.inputElement,"blur"),this.inputWrapper.clearButton&&addClass([this.inputWrapper.clearButton],dropDownListClasses.clearIconHide),this.trigger("blur"))}onFocus(e){this.isInteracted||(this.isInteracted=!0,this.trigger("focus",{isInteracted:!!e,event:e})),this.updateIconState()}resetValueHandler(e){let formElement=closest(this.inputElement,"form");if(formElement&&e.target===formElement){let val=this.element.tagName===this.getNgDirective()?null:this.inputElement.getAttribute("value");this.text=val}}wireEvent(){EventHandler.add(this.inputWrapper.container,"mousedown",this.dropDownClick,this),EventHandler.add(this.inputWrapper.container,"focus",this.focusIn,this),EventHandler.add(this.inputWrapper.container,"keypress",this.onSearch,this),this.bindCommonEvent()}bindCommonEvent(){EventHandler.add(this.targetElement(),"blur",this.onBlur,this);let formElement=closest(this.inputElement,"form");formElement&&EventHandler.add(formElement,"reset",this.resetValueHandler,this),Browser.isDevice||(this.keyboardModule=new ej2_base_es2015_KeyboardEvents(this.targetElement(),{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"})),this.bindClearEvent()}bindClearEvent(){this.showClearButton&&EventHandler.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this)}unBindCommonEvent(){EventHandler.remove(this.targetElement(),"blur",this.onBlur);let formElement=closest(this.inputElement,"form");formElement&&EventHandler.remove(formElement,"reset",this.resetValueHandler),Browser.isDevice||this.keyboardModule.destroy(),this.showClearButton&&EventHandler.remove(this.inputWrapper.clearButton,"mousedown",this.resetHandler)}updateIconState(){this.showClearButton&&(""===this.inputElement.value||this.readonly?addClass([this.inputWrapper.clearButton],dropDownListClasses.clearIconHide):removeClass([this.inputWrapper.clearButton],dropDownListClasses.clearIconHide))}wireListEvents(){EventHandler.add(this.list,"click",this.onMouseClick,this),EventHandler.add(this.list,"mouseover",this.onMouseOver,this),EventHandler.add(this.list,"mouseout",this.onMouseLeave,this)}onSearch(e){32!==e.charCode&&13!==e.charCode&&(void 0===this.list&&this.renderList(),this.searchKeyEvent=e,this.isRequested||isNullOrUndefined(this.list.querySelector("li"))||!this.enabled||this.incrementalSearch(e))}onMouseClick(e){let li=closest(e.target,"."+dropDownBaseClasses.li);this.isValidLI(li)&&(this.setSelection(li,e),Browser.isDevice&&this.isFilterLayout()?history.back():this.closePopup(100))}onMouseOver(e){let currentLi=closest(e.target,"."+dropDownBaseClasses.li);this.setHover(currentLi)}setHover(li){this.enabled&&this.isValidLI(li)&&!li.classList.contains(dropDownBaseClasses.hover)&&(this.removeHover(),addClass([li],dropDownBaseClasses.hover))}onMouseLeave(e){this.removeHover()}removeHover(){let hoveredItem=this.list.querySelectorAll("."+dropDownBaseClasses.hover);hoveredItem&&hoveredItem.length&&removeClass(hoveredItem,dropDownBaseClasses.hover)}isValidLI(li){return li&&li.hasAttribute("role")&&"option"===li.getAttribute("role")}incrementalSearch(e){if(this.liCollections.length>0){let li=function(keyCode,items,selectedIndex,ignoreCase){let index;if(ej2_dropdowns_es2015_queryString+=String.fromCharCode(e.charCode),setTimeout(()=>{ej2_dropdowns_es2015_queryString=""},1e3),ej2_dropdowns_es2015_queryString=ej2_dropdowns_es2015_queryString.toLowerCase(),prevString===ej2_dropdowns_es2015_queryString){for(let i=0;i<ej2_dropdowns_es2015_matches.length;i++)if(ej2_dropdowns_es2015_matches[i].classList.contains("e-active")){index=i;break}return ej2_dropdowns_es2015_matches[index+=1]}{let text,item,listItems=items,strLength=ej2_dropdowns_es2015_queryString.length,i=selectedIndex=selectedIndex?selectedIndex+1:0;ej2_dropdowns_es2015_matches=[];do{i===listItems.length&&(i=-1),(text=(item=listItems[index=-1===i?0:i]).innerText.toLowerCase()).substr(0,strLength)===ej2_dropdowns_es2015_queryString&&ej2_dropdowns_es2015_matches.push(listItems[index]),i++}while(i!==selectedIndex);return prevString=ej2_dropdowns_es2015_queryString,ej2_dropdowns_es2015_matches[0]}}(0,this.liCollections,this.activeIndex);isNullOrUndefined(li)||(this.setSelection(li,e),this.setScrollPosition())}}hideSpinner(){isNullOrUndefined(this.spinnerElement)||(hideSpinner(this.spinnerElement),removeClass([this.spinnerElement],dropDownListClasses.disableIcon),this.spinnerElement.innerHTML="",this.spinnerElement=null)}showSpinner(){isNullOrUndefined(this.spinnerElement)&&(this.spinnerElement=Browser.isDevice&&!isNullOrUndefined(this.filterInputObj)&&this.filterInputObj.buttons[1]||!isNullOrUndefined(this.filterInputObj)&&this.filterInputObj.buttons[0]||this.inputWrapper.buttons[0],addClass([this.spinnerElement],dropDownListClasses.disableIcon),createSpinner({target:this.spinnerElement,width:Browser.isDevice?"16px":"14px"},this.createElement),showSpinner(this.spinnerElement))}keyActionHandler(e){if(!this.enabled)return;let preventAction="pageUp"===e.action||"pageDown"===e.action,preventHomeEnd="dropdownlist"!==this.getModuleName()&&("home"===e.action||"end"===e.action);this.isEscapeKey="escape"===e.action,this.isTabKey=!this.isPopupOpen&&"tab"===e.action;let isNavigation="down"===e.action||"up"===e.action||"pageUp"===e.action||"pageDown"===e.action||"home"===e.action||"end"===e.action;if((!(this.isEditTextBox()||preventAction||preventHomeEnd)||this.isPopupOpen)&&!this.readonly){let isTabAction="tab"===e.action||"close"===e.action;if(void 0!==this.list||this.isRequested||isTabAction||"escape"===e.action||(this.searchKeyEvent=e,this.renderList()),isNullOrUndefined(this.list)||!isNullOrUndefined(this.liCollections)&&isNavigation&&0===this.liCollections.length||this.isRequested)return;switch((isTabAction&&this.isPopupOpen||"escape"===e.action)&&e.preventDefault(),this.isSelected="escape"!==e.action&&this.isSelected,this.isTyped=!isNavigation&&"escape"!==e.action&&this.isTyped,e.action){case"down":case"up":let focusEle=this.list.querySelector("."+dropDownListClasses.focus);if(this.isSelectFocusItem(focusEle))this.setSelection(focusEle,e);else{let nextItem,index="down"===e.action?this.activeIndex+1:this.activeIndex-1,startIndex=0;"autocomplete"===this.getModuleName()&&(startIndex="down"===e.action&&isNullOrUndefined(this.activeIndex)?0:this.liCollections.length-1,index=index<0?this.liCollections.length-1:index===this.liCollections.length?0:index),nextItem=isNullOrUndefined(this.activeIndex)?this.liCollections[startIndex]:this.liCollections[index],this.setSelection(nextItem,e)}e.preventDefault();break;case"pageUp":this.pageUpSelection(this.activeIndex-this.getPageCount(),e),e.preventDefault();break;case"pageDown":this.pageDownSelection(this.activeIndex+this.getPageCount(),e),e.preventDefault();break;case"home":if("dropdownlist"===this.getModuleName()){if(e.preventDefault(),0===this.activeIndex)return;this.setSelection(this.liCollections[0],e)}break;case"end":if("dropdownlist"===this.getModuleName()){e.preventDefault();let lastLi=this.getItems().length-1;if(this.activeIndex===lastLi)return;this.setSelection(this.liCollections[lastLi],e)}break;case"space":"dropdownlist"===this.getModuleName()&&(this.beforePopupOpen||this.showPopup());break;case"open":this.showPopup();break;case"hide":this.preventAltUp=this.isPopupOpen,this.hidePopup(),this.focusDropDown(e);break;case"enter":this.selectCurrentItem(e);break;case"escape":case"tab":case"close":this.isPopupOpen&&(this.hidePopup(),this.focusDropDown(e))}}}selectCurrentItem(e){if(this.isPopupOpen){let li=this.list.querySelector("."+dropDownListClasses.focus);li&&(this.setSelection(li,e),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e)),this.hidePopup(),this.focusDropDown(e)}else this.showPopup()}isSelectFocusItem(element){return!isNullOrUndefined(element)}getPageCount(){let liHeight=this.list.classList.contains(dropDownBaseClasses.noData)?null:getComputedStyle(this.getItems()[0],null).getPropertyValue("height");return Math.round(this.list.getBoundingClientRect().height/parseInt(liHeight,10))}pageUpSelection(steps,event){this.setSelection(steps>=0?this.liCollections[steps+1]:this.liCollections[0],event)}pageDownSelection(steps,event){let list=this.getItems();this.setSelection(steps<=list.length?this.liCollections[steps-1]:this.liCollections[list.length-1],event)}unWireEvent(){EventHandler.remove(this.inputWrapper.container,"mousedown",this.dropDownClick),EventHandler.remove(this.inputWrapper.container,"keypress",this.onSearch),EventHandler.remove(this.inputWrapper.container,"focus",this.focusIn),this.unBindCommonEvent()}unWireListEvents(){EventHandler.remove(this.list,"click",this.onMouseClick),EventHandler.remove(this.list,"mouseover",this.onMouseOver),EventHandler.remove(this.list,"mouseout",this.onMouseLeave)}onDocumentClick(e){let target=e.target;if(!isNullOrUndefined(this.popupObj)&&closest(target,"#"+this.popupObj.element.id)||this.inputWrapper.container.contains(e.target))target===this.inputElement||this.allowFiltering&&target===this.filterInput||"combobox"===this.getModuleName()&&!this.allowFiltering&&Browser.isDevice&&target===this.inputWrapper.buttons[0]||(this.isPreventBlur=(Browser.isIE||"edge"===Browser.info.name)&&(document.activeElement===this.targetElement()||document.activeElement===this.filterInput),e.preventDefault());else if(this.inputWrapper.container.classList.contains(dropDownListClasses.inputFocus)||this.isPopupOpen){this.isDocumentClick=!0;let isActive=this.isRequested;this.isInteracted=!1,this.hidePopup(),isActive||(this.onFocusOut(),this.inputWrapper.container.classList.remove(dropDownListClasses.inputFocus))}}activeStateChange(){this.isDocumentClick&&(this.hidePopup(),this.onFocusOut(),this.inputWrapper.container.classList.remove(dropDownListClasses.inputFocus))}focusDropDown(e){!this.initial&&this.isFilterLayout()&&this.focusIn(e)}dropDownClick(e){if(3===e.which||2===e.button)return;if(this.targetElement().classList.contains(dropDownListClasses.disable)||this.inputWrapper.clearButton===e.target)return;let target=e.target;if(target===this.inputElement||this.allowFiltering&&target===this.filterInput||"combobox"===this.getModuleName()||e.preventDefault(),this.readonly)this.focusIn(e);else{this.isPopupOpen?(this.hidePopup(),this.isFilterLayout()&&this.focusDropDown(e)):(this.focusIn(e),this.floatLabelChange(),this.queryString=""===this.inputElement.value.trim()?null:this.inputElement.value,this.isDropDownClick=!0,this.showPopup());let proxy=this,duration=isBlazor()?1e3:100;this.isSecondClick||setTimeout(()=>{proxy.cloneElements(),proxy.isSecondClick=!0},duration)}}cloneElements(){if(this.list){let ulElement=this.list.querySelector("ul");ulElement&&(ulElement=ulElement.cloneNode?ulElement.cloneNode(!0):ulElement,this.actionCompleteData.ulElement=ulElement)}}updateSelectedItem(li,e,preventSelect,isSelection){this.removeSelection(),li.classList.add(dropDownBaseClasses.selected),this.removeHover();let value=this.getFormattedValue(li.getAttribute("data-value")),selectedData=this.getDataByValue(value);if(this.initial||preventSelect||isNullOrUndefined(e))this.selectEventCallback(li,e,preventSelect,selectedData,value),isSelection&&this.setSelectOptions(li,e);else{let items=this.detachChanges(selectedData);this.isSelected=!0,this.trigger("select",{e:e,item:li,itemData:items,isInteracted:!!e,cancel:!1},eventArgs=>{eventArgs.cancel?li.classList.remove(dropDownBaseClasses.selected):(this.selectEventCallback(li,e,preventSelect,selectedData,value),isSelection&&this.setSelectOptions(li,e))})}}selectEventCallback(li,e,preventSelect,selectedData,value){this.previousItemData=isNullOrUndefined(this.itemData)?null:this.itemData,this.item=li,this.itemData=selectedData;let focusedItem=this.list.querySelector("."+dropDownBaseClasses.focus);focusedItem&&removeClass([focusedItem],dropDownBaseClasses.focus),li.setAttribute("aria-selected","true"),this.activeIndex=this.getIndexByValue(value)}activeItem(li){this.isValidLI(li)&&!li.classList.contains(dropDownBaseClasses.selected)&&(this.removeSelection(),li.classList.add(dropDownBaseClasses.selected),this.removeHover(),li.setAttribute("aria-selected","true"))}setValue(e){let dataItem=this.getItemData();return ej2_inputs_es2015_Input.setValue(null===dataItem.value?null:dataItem.text,this.inputElement,this.floatLabelType,this.showClearButton),this.valueTemplate&&null!==this.itemData?(this.DropDownBaseresetBlazorTemplates(!1,!1,!1,!1,!0),this.setValueTemplate()):this.inputElement.previousSibling===this.valueTempElement&&(detach(this.valueTempElement),this.inputElement.style.display="block"),this.previousValue===dataItem.value?(this.isSelected=!1,!0):(this.isSelected=!this.initial,this.isSelectCustom=!1,"dropdownlist"===this.getModuleName()&&this.updateIconState(),!1)}setSelection(li,e){this.isValidLI(li)&&!li.classList.contains(dropDownBaseClasses.selected)?this.updateSelectedItem(li,e,!1,!0):this.setSelectOptions(li,e)}setSelectOptions(li,e){this.list&&this.removeHover(),this.previousSelectedLI=isNullOrUndefined(this.selectedLI)?null:this.selectedLI,this.selectedLI=li,this.setValue(e)||(this.isPopupOpen&&(attributes(this.targetElement(),{"aria-activedescendant":this.selectedLI?this.selectedLI.id:null}),this.isFilterLayout()&&attributes(this.filterInput,{"aria-activedescendant":this.selectedLI?this.selectedLI.id:null})),(!this.isPopupOpen&&!isNullOrUndefined(li)||this.isPopupOpen&&!isNullOrUndefined(e)&&("keydown"!==e.type||"keydown"===e.type&&"enter"===e.action))&&(this.isSelectCustom=!1,this.onChangeEvent(e)),!this.isPopupOpen||isNullOrUndefined(this.selectedLI)||null===this.itemData||e&&"click"===e.type||this.setScrollPosition(e))}setValueTemplate(){let compiledString;this.valueTempElement||(this.valueTempElement=this.createElement("span",{className:dropDownListClasses.value}),this.inputElement.parentElement.insertBefore(this.valueTempElement,this.inputElement),this.inputElement.style.display="none"),this.valueTempElement.innerHTML="";let templateData=isBlazor()?JSON.parse(JSON.stringify(this.itemData)):this.itemData;compiledString=compile$$1(this.valueTemplate);for(let item of compiledString(templateData,null,null,this.valueTemplateId,this.isStringTemplate))this.valueTempElement.appendChild(item);this.DropDownBaseupdateBlazorTemplates(!1,!1,!1,!1,!0,!0,!0)}removeSelection(){let selectedItems=this.list.querySelectorAll("."+dropDownBaseClasses.selected);selectedItems.length&&(removeClass(selectedItems,dropDownBaseClasses.selected),selectedItems[0].removeAttribute("aria-selected"))}getItemData(){let dataValue,dataText,fields=this.fields,dataItem=null;return isNullOrUndefined(dataItem=this.itemData)||(dataValue=getValue(fields.value,dataItem),dataText=getValue(fields.text,dataItem)),{value:isNullOrUndefined(dataItem)||isUndefined(dataValue)?dataItem:dataValue,text:isNullOrUndefined(dataItem)||isUndefined(dataValue)?dataItem:dataText}}onChangeEvent(eve){let dataItem=this.getItemData();this.setProperties({index:this.isSelectCustom?null:this.activeIndex,text:dataItem.text,value:dataItem.value},!0),this.detachChangeEvent(eve)}detachChanges(value){return"string"==typeof value||"boolean"==typeof value||"number"==typeof value?Object.defineProperties({},{value:{value:value,enumerable:!0},text:{value:value,enumerable:!0}}):value}detachChangeEvent(eve){if(this.isSelected=!1,this.previousValue=this.value,this.activeIndex=this.index,this.typedString=isNullOrUndefined(this.text)?"":this.text,!this.initial){let preItems,items=this.detachChanges(this.itemData);preItems="string"==typeof this.previousItemData||"boolean"==typeof this.previousItemData||"number"==typeof this.previousItemData?Object.defineProperties({},{value:{value:this.previousItemData,enumerable:!0},text:{value:this.previousItemData,enumerable:!0}}):this.previousItemData,this.setHiddenValue(),this.trigger("change",{e:eve,item:this.item,itemData:items,previousItem:this.previousSelectedLI,previousItemData:preItems,isInteracted:!!eve,value:this.value,element:this.element})}}setHiddenValue(){isNullOrUndefined(this.value)?this.hiddenElement.innerHTML="":(this.hiddenElement.innerHTML="<option selected>"+this.text+"</option>",this.hiddenElement.querySelector("option").setAttribute("value",this.value.toString()))}onFilterUp(e){if(this.isValidKey||40===e.keyCode||38===e.keyCode)switch(this.isValidKey=!1,e.keyCode){case 38:case 40:"autocomplete"!==this.getModuleName()||this.isPopupOpen||this.preventAltUp||this.isRequested?this.preventAutoFill=!1:(this.preventAutoFill=!0,this.searchLists(e)),this.preventAltUp=!1,e.preventDefault();break;case 46:case 8:this.typedString=this.filterInput.value,!this.isPopupOpen&&""!==this.typedString||this.isPopupOpen&&this.queryString.length>0?(this.preventAutoFill=!0,this.searchLists(e)):""===this.typedString&&(this.resetFocusElement(),this.activeIndex=null,"autocomplete"===this.getModuleName()&&this.hidePopup()),e.preventDefault();break;default:this.typedString=this.filterInput.value,this.preventAutoFill=!1,this.searchLists(e)}else this.isValidKey=!1}onFilterDown(e){switch(e.keyCode){case 13:break;case 40:case 38:this.queryString=this.filterInput.value,e.preventDefault();break;case 9:this.isPopupOpen&&e.preventDefault();break;default:this.prevSelectPoints=this.getSelectionPoints(),this.queryString=this.filterInput.value}}removeFillSelection(){if(this.isInteracted){let selection=this.getSelectionPoints();this.inputElement.setSelectionRange(selection.end,selection.end)}}getQuery(query){let filterQuery;if(!this.isCustomFilter&&this.allowFiltering){filterQuery=query?query.clone():this.query?this.query.clone():new ej2_data_es2015_Query;let filterType=""===this.typedString?"contains":this.filterType,dataType=this.typeOfData(this.dataSource).typeof;filterQuery.where((this.dataSource instanceof ej2_data_es2015_DataManager||"string"!==dataType)&&"number"!==dataType&&this.fields.text?this.fields.text:"",filterType,this.typedString,this.ignoreCase,this.ignoreAccent)}else filterQuery=query||(this.query?this.query:new ej2_data_es2015_Query);return filterQuery}getSelectionPoints(){let input=this.inputElement;return{start:Math.abs(input.selectionStart),end:Math.abs(input.selectionEnd)}}searchLists(e){if(this.isTyped=!0,this.activeIndex=null,this.filterInput.parentElement.querySelector("."+dropDownListClasses.clearIcon)&&(this.filterInput.parentElement.querySelector("."+dropDownListClasses.clearIcon).style.visibility=""===this.filterInput.value?"hidden":"visible"),this.isDataFetched=!1,this.isFiltering()){let eventArgs={preventDefaultAction:!1,text:this.filterInput.value,updateData:(dataSource,query,fields)=>{eventArgs.cancel||(this.isCustomFilter=!0,this.filteringAction(dataSource,query,fields))},baseEventArgs:e,cancel:!1};this.trigger("filtering",eventArgs,eventArgs=>{eventArgs.cancel||this.isCustomFilter||eventArgs.preventDefaultAction||this.filteringAction(this.dataSource,null,this.fields)})}}filteringAction(dataSource,query,fields){isNullOrUndefined(this.filterInput)||(this.beforePopupOpen=!0,""!==this.filterInput.value.trim()||this.itemTemplate?(this.isNotSearchList=!1,("SELECT"===this.element.tagName&&this.element.options.length>0||"UL"===this.element.tagName&&this.element.childNodes.length>0)&&!(dataSource instanceof Array?dataSource.length>0:!isNullOrUndefined(dataSource))&&this.listData.length>0&&(dataSource=this.listData),query=""===this.filterInput.value.trim()?null:query,this.resetList(dataSource,fields,query)):(this.actionCompleteData.isUpdated=!1,this.isTyped=!1,isNullOrUndefined(this.actionCompleteData.ulElement)||isNullOrUndefined(this.actionCompleteData.list)||this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list),this.isTyped=!0,isNullOrUndefined(this.itemData)||"dropdownlist"!==this.getModuleName()||(this.focusIndexItem(),this.setScrollPosition()),this.isNotSearchList=!0))}setSearchBox(popupElement){if(this.isFiltering()){let parentElement=this.createElement("span",{className:dropDownListClasses.filterParent});this.filterInput=this.createElement("input",{attrs:{type:"text"},className:dropDownListClasses.filterInput}),this.element.parentNode.insertBefore(this.filterInput,this.element);let backIcon=!1;return Browser.isDevice&&(backIcon=!0),this.filterInputObj=ej2_inputs_es2015_Input.createInput({element:this.filterInput,buttons:backIcon?[dropDownListClasses.backIcon,dropDownListClasses.filterBarClearIcon]:[dropDownListClasses.filterBarClearIcon],properties:{placeholder:this.filterBarPlaceholder}},this.createElement),append([this.filterInputObj.container],parentElement),prepend([parentElement],popupElement),attributes(this.filterInput,{"aria-disabled":"false","aria-owns":this.element.id+"_options",role:"listbox","aria-activedescendant":this.selectedLI?this.selectedLI.id:null,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+dropDownListClasses.clearIcon),!Browser.isDevice&&this.clearIconElement&&(EventHandler.add(this.clearIconElement,"click",this.clearText,this),this.clearIconElement.style.visibility="hidden"),Browser.isDevice||(this.searchKeyModule=new ej2_base_es2015_KeyboardEvents(this.filterInput,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"})),EventHandler.add(this.filterInput,"input",this.onInput,this),EventHandler.add(this.filterInput,"keyup",this.onFilterUp,this),EventHandler.add(this.filterInput,"keydown",this.onFilterDown,this),EventHandler.add(this.filterInput,"blur",this.onBlur,this),this.filterInputObj}return ej2_dropdowns_es2015_inputObject}onInput(){this.isValidKey=!0}onActionFailure(e){super.onActionFailure(e),this.beforePopupOpen&&this.renderPopup()}onActionComplete(ulElement,list,e,isUpdated){if(this.isNotSearchList)this.isNotSearchList=!1;else if(this.isActive){let selectedItem=this.selectedLI?this.selectedLI.cloneNode(!0):null;if(super.onActionComplete(ulElement,list,e),this.isRequested&&!isNullOrUndefined(this.searchKeyEvent)&&"keydown"===this.searchKeyEvent.type&&(this.isRequested=!1,this.keyActionHandler(this.searchKeyEvent),this.searchKeyEvent=null),this.isRequested&&!isNullOrUndefined(this.searchKeyEvent)&&(this.incrementalSearch(this.searchKeyEvent),this.searchKeyEvent=null),this.list.scrollTop=0,isNullOrUndefined(ulElement)||attributes(ulElement,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false"}),this.initRemoteRender&&(this.initial=!0,this.activeIndex=this.index,this.updateValues(),this.initRemoteRender=!1,this.initial=!1,this.value&&this.dataSource instanceof ej2_data_es2015_DataManager)){let checkField=isNullOrUndefined(this.fields.value)?this.fields.text:this.fields.value;list.some(x=>x[checkField]===this.value)||this.dataSource.executeQuery(this.getQuery(this.query).where(new ej2_data_es2015_Predicate(checkField,"equal",this.value))).then(e=>{e.result.length>0&&(this.addItem(e.result,list.length),this.updateValues())})}"autocomplete"!==this.getModuleName()&&this.isFiltering()&&!this.isTyped&&(this.actionCompleteData.isUpdated&&(this.isCustomFilter||this.isFilterFocus||!(this.dataSource instanceof ej2_data_es2015_DataManager||!isNullOrUndefined(this.dataSource)&&!isNullOrUndefined(this.dataSource.length)&&0!==this.dataSource.length))||(this.actionCompleteData={ulElement:ulElement.cloneNode(!0),list:list,isUpdated:!0}),this.addNewItem(list,selectedItem),isNullOrUndefined(this.itemData)||this.focusIndexItem()),this.beforePopupOpen&&this.renderPopup()}}addNewItem(listData,newElement){if(!isNullOrUndefined(this.itemData)&&!isNullOrUndefined(newElement)){let value=this.getItemData().value;listData.some(data=>("string"==typeof data||"number"==typeof data)&&data===value||getValue(this.fields.value,data)===value)||this.addItem(this.itemData)}}updateActionCompleteData(li,item){"autocomplete"!==this.getModuleName()&&this.actionCompleteData.ulElement&&(this.actionCompleteData.ulElement.appendChild(li.cloneNode(!0)),this.isFiltering()&&this.actionCompleteData.list.indexOf(item)>0&&this.actionCompleteData.list.push(item))}focusIndexItem(){let value=this.getItemData().value;this.activeIndex=this.getIndexByValue(value);let element=this.findListElement(this.list,"li","data-value",value);this.selectedLI=element,this.activeItem(element),this.removeFocus()}updateSelection(){let selectedItem=this.list.querySelector("."+dropDownBaseClasses.selected);selectedItem?(this.setProperties({index:this.getIndexByValue(selectedItem.getAttribute("data-value"))}),this.activeIndex=this.index):(this.removeFocus(),this.list.querySelector("."+dropDownBaseClasses.li).classList.add(dropDownListClasses.focus))}removeFocus(){let highlightedItem=this.list.querySelectorAll("."+dropDownListClasses.focus);highlightedItem&&highlightedItem.length&&removeClass(highlightedItem,dropDownListClasses.focus)}renderPopup(){this.popupObj&&document.body.contains(this.popupObj.element)?this.refreshPopup():this.trigger("beforeOpen",{cancel:!1},args=>{if(!args.cancel){let popupEle=this.createElement("div",{id:this.element.id+"_popup",className:"e-ddl e-popup "+(null!=this.cssClass?this.cssClass:"")}),searchBox=this.setSearchBox(popupEle);if(this.listHeight=formatUnit(this.popupHeight),this.headerTemplate&&this.setHeaderTemplate(popupEle),append([this.list],popupEle),this.footerTemplate&&this.setFooterTemplate(popupEle),document.body.appendChild(popupEle),popupEle.style.visibility="hidden","auto"!==this.popupHeight){if(this.searchBoxHeight=0,isNullOrUndefined(searchBox.container)||(this.searchBoxHeight=searchBox.container.parentElement.getBoundingClientRect().height,this.listHeight=(parseInt(this.listHeight,10)-this.searchBoxHeight).toString()+"px"),this.headerTemplate){let height=Math.round(this.header.getBoundingClientRect().height);this.listHeight=(parseInt(this.listHeight,10)-(height+this.searchBoxHeight)).toString()+"px"}if(this.footerTemplate){let height=Math.round(this.footer.getBoundingClientRect().height);this.listHeight=(parseInt(this.listHeight,10)-(height+this.searchBoxHeight)).toString()+"px"}this.list.style.maxHeight=(parseInt(this.listHeight,10)-2).toString()+"px",popupEle.style.maxHeight=formatUnit(this.popupHeight)}else popupEle.style.height="auto";let left,offsetValue=0;if(!isNullOrUndefined(this.selectedLI)&&!isNullOrUndefined(this.activeIndex)&&this.activeIndex>=0?this.setScrollPosition():this.list.scrollTop=0,Browser.isDevice&&!this.allowFiltering&&("dropdownlist"===this.getModuleName()||this.isDropDownClick&&"combobox"===this.getModuleName())){offsetValue=this.getOffsetValue(popupEle);let firstItem=this.isEmptyList()?this.list:this.liCollections[0];left=-(parseInt(getComputedStyle(firstItem).textIndent,10)-parseInt(getComputedStyle(this.inputElement).paddingLeft,10)+parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth,10))}this.getFocusElement(),this.createPopup(popupEle,offsetValue,left),this.checkCollision(popupEle),Browser.isDevice&&(this.popupObj.element.classList.add(dropDownListClasses.device),("dropdownlist"===this.getModuleName()||"combobox"===this.getModuleName()&&!this.allowFiltering&&this.isDropDownClick)&&(this.popupObj.collision={X:"fit",Y:"fit"}),this.isFilterLayout()&&(this.popupObj.element.classList.add(dropDownListClasses.mobileFilter),this.popupObj.position={X:0,Y:0},this.popupObj.dataBind(),attributes(this.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),addClass([document.body,this.popupObj.element],dropDownListClasses.popupFullScreen),this.setSearchBoxPosition(),this.backIconElement=searchBox.container.querySelector(".e-back-icon"),this.clearIconElement=searchBox.container.querySelector("."+dropDownListClasses.clearIcon),EventHandler.add(this.backIconElement,"click",this.clickOnBackIcon,this),EventHandler.add(this.clearIconElement,"click",this.clearText,this))),popupEle.style.visibility="visible",addClass([popupEle],"e-popup-close");let scrollParentElements=this.popupObj.getScrollableParent(this.inputWrapper.container);for(let element of scrollParentElements)EventHandler.add(element,"scroll",this.scrollHandler,this);Browser.isDevice&&this.isFilterLayout()&&EventHandler.add(this.list,"scroll",this.listScroll,this),attributes(this.targetElement(),{"aria-expanded":"true"}),addClass([this.isFiltering()?this.filterInput.parentElement:this.inputWrapper.container],[dropDownListClasses.inputFocus]);let animModel={name:"FadeIn",duration:100};this.beforePopupOpen=!0,this.trigger("open",{popup:this.popupObj,cancel:!1,animation:animModel},eventArgs=>{eventArgs.cancel||(addClass([this.inputWrapper.container],[dropDownListClasses.iconAnimation]),this.popupObj.show(new ej2_base_es2015_Animation(eventArgs.animation),1e3===this.zIndex?this.element:null))})}})}checkCollision(popupEle){(!Browser.isDevice||Browser.isDevice&&"dropdownlist"!==this.getModuleName()&&!this.isDropDownClick)&&isCollide(popupEle).length>0&&(popupEle.style.marginTop=-parseInt(getComputedStyle(popupEle).marginTop,10)+"px")}getOffsetValue(popupEle){let popupStyles=getComputedStyle(popupEle),borderTop=parseInt(popupStyles.borderTop,10),borderBottom=parseInt(popupStyles.borderBottom,10);return this.setPopupPosition(borderTop+borderBottom)}createPopup(element,offsetValue,left){this.popupObj=new ej2_popups_es2015_Popup(element,{width:this.setWidth(),targetType:"relative",relateTo:this.inputWrapper.container,collision:{X:"flip",Y:"flip"},offsetY:offsetValue,enableRtl:this.enableRtl,offsetX:left,position:{X:"left",Y:"bottom"},zIndex:this.zIndex,close:()=>{this.isDocumentClick||this.focusDropDown();let isResetItem="autocomplete"===this.getModuleName();this.DropDownBaseresetBlazorTemplates(isResetItem,isResetItem,!0,!0,!1,!0,!0),this.isNotSearchList=!1,this.isDocumentClick=!1,this.destroyPopup();let formElement=closest(this.inputElement,"form");this.isFiltering()&&formElement&&this.actionCompleteData.list&&this.actionCompleteData.list[0]&&(this.isActive=!0,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0))},open:()=>{EventHandler.add(document,"mousedown",this.onDocumentClick,this),this.isPopupOpen=!0,this.isFilterLayout()&&(removeClass([this.inputWrapper.container],[dropDownListClasses.inputFocus]),this.isFilterFocus=!0,this.filterInput.focus(),this.inputWrapper.clearButton&&addClass([this.inputWrapper.clearButton],dropDownListClasses.clearIconHide)),this.activeStateChange()}})}isEmptyList(){return!isNullOrUndefined(this.liCollections)&&0===this.liCollections.length}getFocusElement(){}isFilterLayout(){return"dropdownlist"===this.getModuleName()&&this.allowFiltering}scrollHandler(){Browser.isDevice&&("dropdownlist"===this.getModuleName()&&!this.isFilterLayout()||"combobox"===this.getModuleName()&&!this.allowFiltering&&this.isDropDownClick)&&this.hidePopup()}setSearchBoxPosition(){let searchBoxHeight=this.filterInput.parentElement.getBoundingClientRect().height;this.popupObj.element.style.maxHeight="100%",this.popupObj.element.style.width="100%",this.list.style.maxHeight=window.innerHeight-searchBoxHeight+"px",this.list.style.height=window.innerHeight-searchBoxHeight+"px";let clearElement=this.filterInput.parentElement.querySelector("."+dropDownListClasses.clearIcon);detach(this.filterInput),clearElement.parentElement.insertBefore(this.filterInput,clearElement)}setPopupPosition(border){let offsetValue,popupOffset=border,selectedLI=this.list.querySelector("."+dropDownListClasses.focus)||this.selectedLI,firstItem=this.isEmptyList()?this.list:this.liCollections[0],lastItem=this.isEmptyList()?this.list:this.liCollections[this.getItems().length-1],liHeight=firstItem.getBoundingClientRect().height,listHeight=this.list.offsetHeight/2,height=isNullOrUndefined(selectedLI)?firstItem.offsetTop:selectedLI.offsetTop;if(lastItem.offsetTop-listHeight<height&&!isNullOrUndefined(this.liCollections)&&this.liCollections.length>0&&!isNullOrUndefined(selectedLI)){let count=this.list.offsetHeight/liHeight,paddingBottom=parseInt(getComputedStyle(this.list).paddingBottom,10);offsetValue=(count-(this.liCollections.length-this.activeIndex))*liHeight-popupOffset+paddingBottom,this.list.scrollTop=selectedLI.offsetTop}else height>listHeight?(offsetValue=listHeight-liHeight/2,this.list.scrollTop=height-listHeight+liHeight/2):offsetValue=height;return-(offsetValue=offsetValue+liHeight+popupOffset-(liHeight-this.inputWrapper.container.offsetHeight)/2)}setWidth(){let width=formatUnit(this.popupWidth);if(width.indexOf("%")>-1&&(width=(this.inputWrapper.container.offsetWidth*parseFloat(width)/100).toString()+"px"),Browser.isDevice&&!this.allowFiltering&&("dropdownlist"===this.getModuleName()||this.isDropDownClick&&"combobox"===this.getModuleName())){let firstItem=this.isEmptyList()?this.list:this.liCollections[0];width=parseInt(width,10)+2*(parseInt(getComputedStyle(firstItem).textIndent,10)-parseInt(getComputedStyle(this.inputElement).paddingLeft,10)+parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth,10))+"px"}return width}scrollBottom(isInitial){if(!isNullOrUndefined(this.selectedLI)){let currentOffset=this.list.offsetHeight,nextBottom=this.selectedLI.offsetTop+this.selectedLI.offsetHeight-this.list.scrollTop,nextOffset=this.list.scrollTop+nextBottom-currentOffset;nextOffset=isInitial?nextOffset+2*parseInt(getComputedStyle(this.list).paddingTop,10):nextOffset;let boxRange=this.selectedLI.offsetTop+this.selectedLI.offsetHeight-this.list.scrollTop;boxRange=this.fields.groupBy&&!isNullOrUndefined(this.fixedHeaderElement)?boxRange-this.fixedHeaderElement.offsetHeight:boxRange,0===this.activeIndex?this.list.scrollTop=0:(nextBottom>currentOffset||!(boxRange>0&&this.list.offsetHeight>boxRange))&&(this.list.scrollTop=nextOffset)}}scrollTop(){if(!isNullOrUndefined(this.selectedLI)){let nextOffset=this.selectedLI.offsetTop-this.list.scrollTop;nextOffset=this.fields.groupBy&&!isNullOrUndefined(this.fixedHeaderElement)?nextOffset-this.fixedHeaderElement.offsetHeight:nextOffset;let boxRange=this.selectedLI.offsetTop+this.selectedLI.offsetHeight-this.list.scrollTop;0===this.activeIndex?this.list.scrollTop=0:nextOffset<0?this.list.scrollTop=this.list.scrollTop+nextOffset:boxRange>0&&this.list.offsetHeight>boxRange||(this.list.scrollTop=this.selectedLI.offsetTop-(this.fields.groupBy&&!isNullOrUndefined(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}}isEditTextBox(){return!1}isFiltering(){return this.allowFiltering}isPopupButton(){return!0}setScrollPosition(e){if(isNullOrUndefined(e))this.scrollBottom(!0);else switch(e.action){case"pageDown":case"down":case"end":this.scrollBottom();break;default:this.scrollTop()}}clearText(){this.filterInput.value="",this.searchLists(null)}listScroll(){this.filterInput.blur()}closePopup(delay){if(this.isTyped=!1,!(this.popupObj&&document.body.contains(this.popupObj.element)&&this.beforePopupOpen))return;EventHandler.remove(document,"mousedown",this.onDocumentClick),this.isActive=!1,this.filterInputObj=null,this.isDropDownClick=!1,this.preventAutoFill=!1;let scrollableParentElements=this.popupObj.getScrollableParent(this.inputWrapper.container);for(let element of scrollableParentElements)EventHandler.remove(element,"scroll",this.scrollHandler);Browser.isDevice&&this.isFilterLayout()&&(removeClass([document.body,this.popupObj.element],dropDownListClasses.popupFullScreen),EventHandler.remove(this.list,"scroll",this.listScroll)),this.isFilterLayout()&&(Browser.isDevice||(this.searchKeyModule.destroy(),this.clearIconElement&&EventHandler.remove(this.clearIconElement,"click",this.clearText)),this.backIconElement&&(EventHandler.remove(this.backIconElement,"click",this.clickOnBackIcon),EventHandler.remove(this.clearIconElement,"click",this.clearText)),EventHandler.remove(this.filterInput,"input",this.onInput),EventHandler.remove(this.filterInput,"keyup",this.onFilterUp),EventHandler.remove(this.filterInput,"keydown",this.onFilterDown),EventHandler.remove(this.filterInput,"blur",this.onBlur),this.filterInput=null),attributes(this.targetElement(),{"aria-expanded":"false","aria-activedescendant":null}),this.inputWrapper.container.classList.remove(dropDownListClasses.iconAnimation),this.isFiltering()&&(this.actionCompleteData.isUpdated=!1),this.beforePopupOpen=!1,this.trigger("close",{popup:this.popupObj,cancel:!1,animation:{name:"FadeOut",duration:100,delay:delay||0}},eventArgs=>{eventArgs.cancel||("autocomplete"===this.getModuleName()&&this.rippleFun(),this.isPopupOpen?this.popupObj.hide(new ej2_base_es2015_Animation(eventArgs.animation)):this.destroyPopup())})}destroyPopup(){this.isPopupOpen=!1,this.isFilterFocus=!1,this.popupObj.destroy(),detach(this.popupObj.element)}clickOnBackIcon(){this.hidePopup(),this.focusIn()}render(){"INPUT"===this.element.tagName?(this.inputElement=this.element,isNullOrUndefined(this.inputElement.getAttribute("role"))&&this.inputElement.setAttribute("role","textbox"),isNullOrUndefined(this.inputElement.getAttribute("type"))&&this.inputElement.setAttribute("type","text")):(this.inputElement=this.createElement("input",{attrs:{role:"textbox",type:"text"}}),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.parentElement.insertBefore(this.inputElement,this.element),this.preventTabIndex(this.inputElement)),this.inputWrapper=ej2_inputs_es2015_Input.createInput({element:this.inputElement,buttons:this.isPopupButton()?[dropDownListClasses.icon]:null,floatLabelType:this.floatLabelType,properties:{readonly:"dropdownlist"===this.getModuleName()||this.readonly,placeholder:this.placeholder,cssClass:this.cssClass,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton}},this.createElement),this.element.tagName===this.getNgDirective()?this.element.appendChild(this.inputWrapper.container):this.inputElement.parentElement.insertBefore(this.element,this.inputElement),this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",tabindex:"-1",class:dropDownListClasses.hiddenElement}}),prepend([this.hiddenElement],this.inputWrapper.container),this.validationAttribute(this.element,this.hiddenElement),this.setFields(),this.inputWrapper.container.style.width=formatUnit(this.width),this.inputWrapper.container.classList.add("e-ddl"),this.wireEvent(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex");let id=this.element.getAttribute("id")?this.element.getAttribute("id"):getUniqueID("ej2_dropdownlist");if(this.element.id=id,this.hiddenElement.id=id+"_hidden",this.targetElement().setAttribute("tabindex",this.tabIndex),attributes(this.targetElement(),this.getAriaAttributes()),this.updateDataAttribute(this.htmlAttributes),this.setHTMLAttributes(),null!==this.value||null!==this.activeIndex||null!==this.text)this.initValue();else if("SELECT"===this.element.tagName&&this.element.options[0]){let selectElement=this.element;this.value=selectElement.options[selectElement.selectedIndex].value,this.text=isNullOrUndefined(this.value)?null:selectElement.options[selectElement.selectedIndex].textContent,this.initValue()}this.preventTabIndex(this.element),this.enabled||(this.targetElement().tabIndex=-1),this.initial=!1,this.element.style.opacity="",this.inputElement.onselect=e=>{e.stopImmediatePropagation()},this.inputElement.onchange=e=>{e.stopImmediatePropagation()},this.element.hasAttribute("autofocus")&&this.focusIn(),isNullOrUndefined(this.text)||this.inputElement.setAttribute("value",this.text),this.renderComplete()}setFooterTemplate(popupEle){let compiledString;this.footer?this.footer.innerHTML="":(this.footer=this.createElement("div"),addClass([this.footer],dropDownListClasses.footer)),compiledString=compile$$1(this.footerTemplate);for(let item of compiledString({},null,null,this.footerTemplateId,this.isStringTemplate))this.footer.appendChild(item);this.DropDownBaseupdateBlazorTemplates(!1,!1,!1,!1,!1,!1,!0),append([this.footer],popupEle)}setHeaderTemplate(popupEle){let compiledString;this.header?this.header.innerHTML="":(this.header=this.createElement("div"),addClass([this.header],dropDownListClasses.header)),compiledString=compile$$1(this.headerTemplate);for(let item of compiledString({},null,null,this.headerTemplateId,this.isStringTemplate))this.header.appendChild(item);this.DropDownBaseupdateBlazorTemplates(!1,!1,!1,!1,!1,!0,!1);let contentEle=popupEle.querySelector("div.e-content");popupEle.insertBefore(this.header,contentEle)}setOldText(text){this.text=text}setOldValue(value){this.value=value}refreshPopup(){isNullOrUndefined(this.popupObj)||!document.body.contains(this.popupObj.element)||(!this.allowFiltering||Browser.isDevice&&this.isFilterLayout())&&"autocomplete"!==this.getModuleName()||(removeClass([this.popupObj.element],"e-popup-close"),this.popupObj.refreshPosition(this.inputWrapper.container))}checkDatasource(newProp){newProp.dataSource&&!isNullOrUndefined(Object.keys(newProp.dataSource))&&this.itemTemplate&&this.allowFiltering&&(this.list=null,this.actionCompleteData={ulElement:null,list:null,isUpdated:!1})}updateDataSource(props){""===this.inputElement.value&&(isNullOrUndefined(props)||!isNullOrUndefined(props.dataSource)&&(props.dataSource instanceof ej2_data_es2015_DataManager||0!==props.dataSource.length))||this.clear(null,props),(isNullOrUndefined(props)||!isNullOrUndefined(props.dataSource)&&(props.dataSource instanceof ej2_data_es2015_DataManager||0!==props.dataSource.length))&&this.resetList(this.dataSource),this.isCustomFilter||this.isFilterFocus||document.activeElement===this.filterInput||this.checkCustomValue()}checkCustomValue(){this.itemData=this.getDataByValue(this.value);let dataItem=this.getItemData();this.setProperties({value:dataItem.value,text:dataItem.text})}updateInputFields(){"dropdownlist"===this.getModuleName()&&ej2_inputs_es2015_Input.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)}onPropertyChanged(newProp,oldProp){"dropdownlist"===this.getModuleName()&&(this.checkDatasource(newProp),this.setUpdateInitial(["fields","query","dataSource"],newProp));for(let prop of Object.keys(newProp))switch(prop){case"query":case"dataSource":break;case"htmlAttributes":this.setHTMLAttributes();break;case"width":setStyleAttribute(this.inputWrapper.container,{width:formatUnit(newProp.width)});break;case"placeholder":ej2_inputs_es2015_Input.setPlaceholder(newProp.placeholder,this.inputElement);break;case"filterBarPlaceholder":this.filterInput&&ej2_inputs_es2015_Input.setPlaceholder(newProp.filterBarPlaceholder,this.filterInput);break;case"readonly":"dropdownlist"!==this.getModuleName()&&ej2_inputs_es2015_Input.setReadonly(newProp.readonly,this.inputElement);break;case"cssClass":this.setCssClass(newProp,oldProp);break;case"enableRtl":this.setEnableRtl();break;case"enabled":this.setEnable();break;case"text":if(null===newProp.text){this.clear();break}if(this.list||(this.dataSource instanceof ej2_data_es2015_DataManager&&(this.initRemoteRender=!0),this.renderList()),!this.initRemoteRender){let li=this.getElementByText(newProp.text);this.checkValidLi(li)||(this.liCollections&&100===this.liCollections.length&&"autocomplete"===this.getModuleName()&&this.listData.length>100?this.setSelectionData(newProp.text,oldProp.text,"text"):this.setOldText(oldProp.text)),this.updateInputFields()}break;case"value":if(null===newProp.value){this.clear();break}if(this.notify("beforeValueChange",{newProp:newProp}),this.list||(this.dataSource instanceof ej2_data_es2015_DataManager&&(this.initRemoteRender=!0),this.renderList()),!this.initRemoteRender){let item=this.getElementByValue(newProp.value);this.checkValidLi(item)||(this.liCollections&&100===this.liCollections.length&&"autocomplete"===this.getModuleName()&&this.listData.length>100?this.setSelectionData(newProp.value,oldProp.value,"value"):this.setOldValue(oldProp.value)),this.updateInputFields()}break;case"index":if(null===newProp.index){this.clear();break}this.list||(this.dataSource instanceof ej2_data_es2015_DataManager&&(this.initRemoteRender=!0),this.renderList()),this.initRemoteRender||(this.checkValidLi(this.liCollections[newProp.index])||(this.liCollections&&100===this.liCollections.length&&"autocomplete"===this.getModuleName()&&this.listData.length>100?this.setSelectionData(newProp.index,oldProp.index,"index"):this.index=oldProp.index),this.updateInputFields());break;case"footerTemplate":this.popupObj&&this.setFooterTemplate(this.popupObj.element);break;case"headerTemplate":this.popupObj&&this.setHeaderTemplate(this.popupObj.element);break;case"valueTemplate":isNullOrUndefined(this.itemData)||null==this.valueTemplate||this.setValueTemplate();break;case"allowFiltering":this.allowFiltering&&(this.actionCompleteData={ulElement:this.ulElement,list:this.listData,isUpdated:!0});break;case"floatLabelType":ej2_inputs_es2015_Input.removeFloating(this.inputWrapper),ej2_inputs_es2015_Input.addFloating(this.inputElement,newProp.floatLabelType,this.placeholder,this.createElement);break;case"showClearButton":ej2_inputs_es2015_Input.setClearButton(newProp.showClearButton,this.inputElement,this.inputWrapper,null,this.createElement),this.bindClearEvent();break;default:let ddlProps;ddlProps=this.getPropObject(prop,newProp,oldProp),super.onPropertyChanged(ddlProps.newProperty,ddlProps.oldProperty)}}checkValidLi(element){return!!this.isValidLI(element)&&(this.setSelection(element,null),!0)}setSelectionData(newProp,oldProp,prop){let li;this.updateListValues=()=>{"text"===prop?(li=this.getElementByText(newProp),this.checkValidLi(li)||this.setOldText(oldProp)):"value"===prop?(li=this.getElementByValue(newProp),this.checkValidLi(li)||this.setOldValue(oldProp)):"index"===prop&&(this.checkValidLi(li=this.liCollections[newProp])||(this.index=oldProp))}}setCssClass(newProp,oldProp){this.inputWrapper.container.classList.remove(oldProp.cssClass),ej2_inputs_es2015_Input.setCssClass(newProp.cssClass,[this.inputWrapper.container]),this.popupObj&&(this.popupObj.element.classList.remove(oldProp.cssClass),this.popupObj.element.classList.add(newProp.cssClass))}getModuleName(){return"dropdownlist"}showPopup(){if(this.enabled)if(this.beforePopupOpen)this.refreshPopup();else{if(this.beforePopupOpen=!0,this.isFiltering()&&!this.isActive&&this.actionCompleteData.list&&this.actionCompleteData.list[0]?(this.isActive=!0,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)):(isNullOrUndefined(this.list)||!isUndefined(this.list)&&this.list.classList.contains(dropDownBaseClasses.noData))&&this.renderList(),Browser.isDevice&&this.isFilterLayout()){let proxy=this;window.onpopstate=()=>{proxy.hidePopup()},history.pushState({},"")}isNullOrUndefined(this.list.children[0])&&!this.list.classList.contains(dropDownBaseClasses.noData)||this.renderPopup(),attributes(this.targetElement(),{"aria-activedescendant":this.selectedLI?this.selectedLI.id:null})}}hidePopup(){this.DropDownBaseresetBlazorTemplates(!1,!1,!1,!1,!1,!!this.headerTemplate,!!this.headerTemplate),this.isEscapeKey&&"dropdownlist"===this.getModuleName()&&(ej2_inputs_es2015_Input.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1,isNullOrUndefined(this.index)?this.resetSelection():(this.selectedLI=this.liCollections[this.index],this.updateSelectedItem(this.selectedLI,null,!0),this.valueTemplate&&null!==this.itemData&&this.setValueTemplate())),this.closePopup();let dataItem=this.getItemData();""!==this.inputElement.value.trim()||this.isInteracted||!this.isSelectCustom&&(isNullOrUndefined(this.selectedLI)||this.inputElement.value===dataItem.text)||(this.isSelectCustom=!1,this.clear())}focusIn(e){if(!this.enabled)return;if(this.targetElement().classList.contains(dropDownListClasses.disable))return;let isFocused=!1;this.preventFocus&&Browser.isDevice&&(this.inputWrapper.container.tabIndex=1,this.inputWrapper.container.focus(),this.preventFocus=!1,isFocused=!0),isFocused||this.targetElement().focus(),addClass([this.inputWrapper.container],[dropDownListClasses.inputFocus]),this.onFocus(e)}focusOut(){this.enabled&&(this.isTyped=!0,this.hidePopup(),this.targetElement().blur(),removeClass([this.inputWrapper.container],[dropDownListClasses.inputFocus]))}destroy(){this.isActive=!1,this.hidePopup(),this.unWireEvent(),this.list&&this.unWireListEvents(),(!this.element||this.element.classList.contains("e-"+this.getModuleName()))&&(["readonly","aria-disabled","aria-placeholder","placeholder","aria-owns","aria-labelledby","aria-haspopup","aria-expanded","aria-activedescendant","autocomplete","aria-readonly","autocorrect","autocapitalize","spellcheck","aria-autocomplete"].forEach(value=>{this.inputElement.removeAttribute(value)}),this.inputElement.setAttribute("tabindex",this.tabIndex),this.inputElement.classList.remove("e-input"),ej2_inputs_es2015_Input.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.element.style.display="block",this.inputWrapper.container.parentElement.tagName===this.getNgDirective()?detach(this.inputWrapper.container):(this.inputWrapper.container.parentElement.insertBefore(this.element,this.inputWrapper.container),detach(this.inputWrapper.container)),super.destroy())}getItems(){return this.list||(this.dataSource instanceof ej2_data_es2015_DataManager&&(this.initRemoteRender=!0),this.renderList()),this.ulElement?super.getItems():[]}};return __decorate([Property(null)],DropDownList.prototype,"cssClass",void 0),__decorate([Property("100%")],DropDownList.prototype,"width",void 0),__decorate([Property("300px")],DropDownList.prototype,"popupHeight",void 0),__decorate([Property("100%")],DropDownList.prototype,"popupWidth",void 0),__decorate([Property(null)],DropDownList.prototype,"placeholder",void 0),__decorate([Property(null)],DropDownList.prototype,"filterBarPlaceholder",void 0),__decorate([Property({})],DropDownList.prototype,"htmlAttributes",void 0),__decorate([Property(null)],DropDownList.prototype,"query",void 0),__decorate([Property(null)],DropDownList.prototype,"valueTemplate",void 0),__decorate([Property(null)],DropDownList.prototype,"headerTemplate",void 0),__decorate([Property(null)],DropDownList.prototype,"footerTemplate",void 0),__decorate([Property(!1)],DropDownList.prototype,"allowFiltering",void 0),__decorate([Property(!1)],DropDownList.prototype,"readonly",void 0),__decorate([Property(null)],DropDownList.prototype,"text",void 0),__decorate([Property(null)],DropDownList.prototype,"value",void 0),__decorate([Property(null)],DropDownList.prototype,"index",void 0),__decorate([Property("Never")],DropDownList.prototype,"floatLabelType",void 0),__decorate([Property(!1)],DropDownList.prototype,"showClearButton",void 0),__decorate([ej2_base_es2015_Event()],DropDownList.prototype,"filtering",void 0),__decorate([ej2_base_es2015_Event()],DropDownList.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],DropDownList.prototype,"beforeOpen",void 0),__decorate([ej2_base_es2015_Event()],DropDownList.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],DropDownList.prototype,"close",void 0),__decorate([ej2_base_es2015_Event()],DropDownList.prototype,"blur",void 0),__decorate([ej2_base_es2015_Event()],DropDownList.prototype,"focus",void 0),__decorate([NotifyPropertyChanges],DropDownList)})();dropDownListClasses.root="e-combobox";let inputObject$1={container:null,buttons:[]},ej2_dropdowns_es2015_ComboBox=(()=>{let ComboBox=class extends ej2_dropdowns_es2015_DropDownList{constructor(options,element){super(options,element)}preRender(){super.preRender()}getLocaleName(){return"combo-box"}wireEvent(){"combobox"===this.getModuleName()&&(EventHandler.add(this.inputWrapper.buttons[0],"mousedown",this.preventBlur,this),EventHandler.add(this.inputWrapper.container,"blur",this.onBlur,this)),isNullOrUndefined(this.inputWrapper.buttons[0])||EventHandler.add(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick,this),EventHandler.add(this.inputElement,"focus",this.targetFocus,this),this.readonly||(EventHandler.add(this.inputElement,"input",this.onInput,this),EventHandler.add(this.inputElement,"keyup",this.onFilterUp,this),EventHandler.add(this.inputElement,"keydown",this.onFilterDown,this)),this.bindCommonEvent()}preventBlur(e){(this.allowFiltering||document.activeElement===this.inputElement||document.activeElement.classList.contains(dropDownListClasses.input)||!Browser.isDevice)&&Browser.isDevice||e.preventDefault()}onBlur(e){let inputValue=""===this.inputElement.value?null:this.inputElement.value;isNullOrUndefined(this.listData)||isNullOrUndefined(inputValue)||inputValue===this.text||this.customValue(),super.onBlur(e)}targetElement(){return this.inputElement}setOldText(text){ej2_inputs_es2015_Input.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue(),this.removeSelection()}setOldValue(value){this.valueMuteChange(this.allowCustom?this.value:null),this.removeSelection(),this.setHiddenValue()}valueMuteChange(value){let inputValue=isNullOrUndefined(value)?null:value.toString();ej2_inputs_es2015_Input.setValue(inputValue,this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:value,text:value,index:null},!0),this.activeIndex=this.index;let fields=this.fields,dataItem={};dataItem[fields.text]=isNullOrUndefined(value)?null:value.toString(),dataItem[fields.value]=isNullOrUndefined(value)?null:value.toString(),this.itemData=dataItem,this.item=null,this.previousValue!==this.value&&this.detachChangeEvent(null)}updateValues(){if(isNullOrUndefined(this.value))if(this.text&&isNullOrUndefined(this.value)){let li=this.getElementByText(this.text);li?this.setSelection(li,null):(ej2_inputs_es2015_Input.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue())}else this.setSelection(this.liCollections[this.activeIndex],null);else{let li=this.getElementByValue(this.value);li?this.setSelection(li,null):this.valueMuteChange(this.allowCustom?this.value:null)}this.setHiddenValue(),ej2_inputs_es2015_Input.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)}updateIconState(){this.showClearButton&&(""===this.inputElement.value||this.readonly?addClass([this.inputWrapper.clearButton],dropDownListClasses.clearIconHide):removeClass([this.inputWrapper.clearButton],dropDownListClasses.clearIconHide))}getAriaAttributes(){return{"aria-owns":this.element.id+"_options",role:"combobox","aria-autocomplete":"both","aria-labelledby":this.hiddenElement.id,"aria-hasPopup":"true","aria-expanded":"false","aria-readonly":this.readonly.toString(),autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}}searchLists(e){this.isTyped=!0,this.isFiltering()?(super.searchLists(e),""===this.filterInput.value.trim()&&this.setHoverList(this.ulElement.querySelector("."+dropDownListClasses.li))):(this.ulElement&&""===this.inputElement.value&&this.preventAutoFill&&this.setHoverList(this.ulElement.querySelector("."+dropDownListClasses.li)),this.incrementalSearch(e))}getNgDirective(){return"EJS-COMBOBOX"}setSearchBox(){return this.filterInput=this.inputElement,this.isFiltering()?this.inputWrapper:inputObject$1}onActionComplete(ulElement,list,e,isUpdated){super.onActionComplete(ulElement,list,e),this.isSelectCustom&&this.removeSelection(),!this.preventAutoFill&&"combobox"===this.getModuleName()&&this.isTyped&&this.inlineSearch()}getFocusElement(){let dataItem=this.isSelectCustom?{text:""}:this.getItemData(),selected=this.list.querySelector("."+dropDownListClasses.selected);if(dataItem.text===this.inputElement.value&&!isNullOrUndefined(selected))return selected;if((Browser.isDevice&&!this.isDropDownClick||!Browser.isDevice)&&!isNullOrUndefined(this.liCollections)&&this.liCollections.length>0){let activeElement=ej2_dropdowns_es2015_Search(this.inputElement.value,this.liCollections,"StartsWith",!0).item;if(isNullOrUndefined(activeElement))this.isSelectCustom&&""!==this.inputElement.value.trim()&&(this.removeFocus(),this.list.scrollTop=0);else{let count=this.getIndexByValue(activeElement.getAttribute("data-value"))-1,height=parseInt(getComputedStyle(this.liCollections[0],null).getPropertyValue("height"),10);isNaN(height)||"autocomplete"===this.getModuleName()||(this.removeFocus(),this.list.scrollTop=count*height+(this.fields.groupBy?this.liCollections[0].offsetHeight:0),addClass([activeElement],dropDownListClasses.focus))}return activeElement}return null}setValue(e){return e&&"keydown"===e.type&&"enter"===e.action&&this.removeFillSelection(),this.autofill&&"combobox"===this.getModuleName()&&e&&"keydown"===e.type&&"enter"!==e.action?(this.preventAutoFill=!1,this.inlineSearch(e),!1):super.setValue(e)}checkCustomValue(){this.itemData=this.getDataByValue(this.value);let dataItem=this.getItemData();this.allowCustom&&isNullOrUndefined(dataItem.value)&&isNullOrUndefined(dataItem.text)||this.setProperties({value:dataItem.value,text:dataItem.text})}showSpinner(){isNullOrUndefined(this.spinnerElement)&&(this.spinnerElement="autocomplete"===this.getModuleName()?this.inputWrapper.buttons[0]||this.inputWrapper.clearButton||ej2_inputs_es2015_Input.appendSpan("e-input-group-icon e-atc-spinner-icon",this.inputWrapper.container,this.createElement):this.inputWrapper.buttons[0]||this.inputWrapper.clearButton,addClass([this.spinnerElement],dropDownListClasses.disableIcon),createSpinner({target:this.spinnerElement,width:Browser.isDevice?"16px":"14px"},this.createElement),showSpinner(this.spinnerElement))}hideSpinner(){isNullOrUndefined(this.spinnerElement)||(hideSpinner(this.spinnerElement),removeClass([this.spinnerElement],dropDownListClasses.disableIcon),this.spinnerElement.classList.contains("e-atc-spinner-icon")?detach(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)}setAutoFill(activeElement,isHover){if(isHover||this.setHoverList(activeElement),this.autofill&&!this.preventAutoFill){let currentValue=this.getTextByValue(activeElement.getAttribute("data-value")).toString(),currentFillValue=this.getFormattedValue(activeElement.getAttribute("data-value"));"combobox"===this.getModuleName()&&(this.isSelected||this.previousValue===currentFillValue?this.updateSelectedItem(activeElement,null,!0):(this.updateSelectedItem(activeElement,null),this.isSelected=!0,this.previousValue=this.getFormattedValue(activeElement.getAttribute("data-value")))),this.isAndroidAutoFill(currentValue)||this.setAutoFillSelection(currentValue)}}isAndroidAutoFill(value){if(Browser.isAndroid){let currentPoints=this.getSelectionPoints(),prevEnd=this.prevSelectPoints.end,curEnd=currentPoints.end,prevStart=this.prevSelectPoints.start,curStart=currentPoints.start;return 0!==prevEnd&&(prevEnd===value.length&&prevStart===value.length||prevStart>curStart&&prevEnd>curEnd||prevEnd===curEnd&&prevStart===curStart)}return!1}clear(e,property){(isNullOrUndefined(property)||!isNullOrUndefined(property)&&isNullOrUndefined(property.dataSource))&&super.clear(e)}isSelectFocusItem(element){return!isNullOrUndefined(element)}inlineSearch(e){let isKeyNavigate=e&&("down"===e.action||"up"===e.action||"home"===e.action||"end"===e.action||"pageUp"===e.action||"pageDown"===e.action),activeElement=isKeyNavigate?this.liCollections[this.activeIndex]:this.getFocusElement();if(isNullOrUndefined(activeElement))if(""===this.inputElement.value){this.activeIndex=null,this.list.scrollTop=0;let focusItem=this.list.querySelector("."+dropDownListClasses.li);this.setHoverList(focusItem)}else this.activeIndex=null,this.removeSelection(),this.removeFocus();else{if(!isKeyNavigate){let value=this.getFormattedValue(activeElement.getAttribute("data-value"));this.activeIndex=this.getIndexByValue(value),this.activeIndex=isNullOrUndefined(this.activeIndex)?null:this.activeIndex}this.preventAutoFill=""!==this.inputElement.value&&this.preventAutoFill,this.setAutoFill(activeElement,isKeyNavigate)}}incrementalSearch(e){this.showPopup(),isNullOrUndefined(this.listData)||(this.inlineSearch(e),e.preventDefault())}setAutoFillSelection(currentValue){let selection=this.getSelectionPoints(),value=this.inputElement.value.substr(0,selection.start);if(value&&value.toLowerCase()===currentValue.substr(0,selection.start).toLowerCase()){let inputValue=value+currentValue.substr(value.length,currentValue.length);ej2_inputs_es2015_Input.setValue(inputValue,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(selection.start,this.inputElement.value.length)}else ej2_inputs_es2015_Input.setValue(currentValue,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(0,this.inputElement.value.length)}getValueByText(text){return super.getValueByText(text,!0,this.ignoreAccent)}unWireEvent(){"combobox"===this.getModuleName()&&(EventHandler.remove(this.inputWrapper.buttons[0],"mousedown",this.preventBlur),EventHandler.remove(this.inputWrapper.container,"blur",this.onBlur)),isNullOrUndefined(this.inputWrapper.buttons[0])||EventHandler.remove(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick),EventHandler.remove(this.inputElement,"focus",this.targetFocus),this.readonly||(EventHandler.remove(this.inputElement,"input",this.onInput),EventHandler.remove(this.inputElement,"keyup",this.onFilterUp),EventHandler.remove(this.inputElement,"keydown",this.onFilterDown)),this.unBindCommonEvent()}setSelection(li,e){super.setSelection(li,e),isNullOrUndefined(li)||this.autofill||this.isDropDownClick||this.removeFocus()}selectCurrentItem(e){let li;this.isPopupOpen&&((li=this.list.querySelector("."+dropDownListClasses.focus))&&(this.setSelection(li,e),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e))),"enter"===e.action&&""===this.inputElement.value.trim()?this.clear(e):this.isTyped&&!this.isSelected&&isNullOrUndefined(li)&&this.customValue(),this.hidePopup()}setHoverList(li){this.removeSelection(),this.isValidLI(li)&&!li.classList.contains(dropDownListClasses.selected)&&(this.removeFocus(),li.classList.add(dropDownListClasses.focus))}targetFocus(e){Browser.isDevice&&!this.allowFiltering&&(this.preventFocus=!1),this.onFocus()}dropDownClick(e){e.preventDefault(),Browser.isDevice&&!this.allowFiltering&&(this.preventFocus=!0),super.dropDownClick(e)}customValue(){let value=this.getValueByText(this.inputElement.value);if(this.allowCustom||""===this.inputElement.value)if(""!==this.inputElement.value.trim()){let previousValue=this.value;if(isNullOrUndefined(value)){let eventArgs,value=""===this.inputElement.value?null:this.inputElement.value;eventArgs={text:value,item:{}},this.initial?this.updateCustomValueCallback(value,eventArgs,previousValue):this.trigger("customValueSpecifier",eventArgs,eventArgs=>{this.updateCustomValueCallback(value,eventArgs,previousValue)})}else this.isSelectCustom=!1,this.setProperties({value:value}),previousValue!==this.value&&this.onChangeEvent(null)}else this.allowCustom&&(this.isSelectCustom=!0);else{let previousValue=this.previousValue,currentValue=this.value;this.setProperties({value:value}),isNullOrUndefined(this.value)&&ej2_inputs_es2015_Input.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.autofill&&previousValue===this.value&&currentValue!==this.value&&this.onChangeEvent(null)}}updateCustomValueCallback(value,eventArgs,previousValue){let fields=this.fields,item=eventArgs.item,dataItem={};item&&getValue(fields.text,item)&&getValue(fields.value,item)?dataItem=item:(setValue(fields.text,value,dataItem),setValue(fields.value,value,dataItem)),this.itemData=dataItem;let changeData={text:getValue(fields.text,this.itemData),value:getValue(fields.value,this.itemData),index:null};this.setProperties(changeData,!0),this.setSelection(null,null),this.isSelectCustom=!0,previousValue!==this.value&&this.onChangeEvent(null)}onPropertyChanged(newProp,oldProp){"combobox"===this.getModuleName()&&this.setUpdateInitial(["fields","query","dataSource"],newProp);for(let prop of Object.keys(newProp))switch(prop){case"readonly":ej2_inputs_es2015_Input.setReadonly(this.readonly,this.inputElement),this.readonly?(EventHandler.remove(this.inputElement,"input",this.onInput),EventHandler.remove(this.inputElement,"keyup",this.onFilterUp),EventHandler.remove(this.inputElement,"keydown",this.onFilterDown)):(EventHandler.add(this.inputElement,"input",this.onInput,this),EventHandler.add(this.inputElement,"keyup",this.onFilterUp,this),EventHandler.add(this.inputElement,"keydown",this.onFilterDown,this));break;case"allowFiltering":this.setSearchBox(),this.isFiltering()&&"combobox"===this.getModuleName()&&isNullOrUndefined(this.list)&&super.renderList();break;case"allowCustom":break;default:let comboProps;comboProps=this.getPropObject(prop,newProp,oldProp),super.onPropertyChanged(comboProps.newProperty,comboProps.oldProperty)}}render(){super.render(),this.setSearchBox(),this.isFiltering()&&"combobox"===this.getModuleName()&&isNullOrUndefined(this.list)&&super.renderList(),this.renderComplete()}getModuleName(){return"combobox"}hidePopup(){let inputValue=""===this.inputElement.value?null:this.inputElement.value;if(!isNullOrUndefined(this.listData)){let isEscape=this.isEscapeKey;this.isEscapeKey&&(ej2_inputs_es2015_Input.setValue(this.typedString,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1),this.autofill&&this.removeFillSelection();let dataItem=this.isSelectCustom?{text:""}:this.getItemData(),selected=this.list.querySelector("."+dropDownListClasses.selected);if(dataItem.text===this.inputElement.value&&!isNullOrUndefined(selected))return this.isSelected&&(this.onChangeEvent(null),this.isSelectCustom=!1),void super.hidePopup();if("combobox"===this.getModuleName()&&""!==this.inputElement.value.trim()){let searchItem=ej2_dropdowns_es2015_Search(this.inputElement.value,this.liCollections,"Equal",!0);this.selectedLI=searchItem.item,isNullOrUndefined(searchItem.index)&&(searchItem.index=ej2_dropdowns_es2015_Search(this.inputElement.value,this.liCollections,"StartsWith",!0).index),this.activeIndex=searchItem.index,isNullOrUndefined(this.selectedLI)?isEscape&&(this.isSelectCustom=!0,this.removeSelection()):this.updateSelectedItem(this.selectedLI,null,!0)}this.isEscapeKey||!this.isTyped||this.isInteracted||this.customValue()}isNullOrUndefined(this.listData)&&this.allowCustom&&!isNullOrUndefined(inputValue)&&inputValue!==this.value&&this.customValue(),super.hidePopup()}focusIn(){this.enabled&&(Browser.isDevice&&!this.allowFiltering&&(this.preventFocus=!0),super.focusIn())}};return __decorate([Property(!1)],ComboBox.prototype,"autofill",void 0),__decorate([Property(!0)],ComboBox.prototype,"allowCustom",void 0),__decorate([Property({})],ComboBox.prototype,"htmlAttributes",void 0),__decorate([Property(!1)],ComboBox.prototype,"allowFiltering",void 0),__decorate([Property(null)],ComboBox.prototype,"query",void 0),__decorate([Property(null)],ComboBox.prototype,"index",void 0),__decorate([Property(!0)],ComboBox.prototype,"showClearButton",void 0),__decorate([ej2_base_es2015_Event()],ComboBox.prototype,"customValueSpecifier",void 0),__decorate([ej2_base_es2015_Event()],ComboBox.prototype,"filtering",void 0),__decorate([Property(null)],ComboBox.prototype,"valueTemplate",void 0),__decorate([Property("Never")],ComboBox.prototype,"floatLabelType",void 0),__decorate([Property(null)],ComboBox.prototype,"filterBarPlaceholder",void 0),__decorate([NotifyPropertyChanges],ComboBox)})();dropDownListClasses.root="e-autocomplete",dropDownListClasses.icon="e-input-group-icon e-ddl-icon e-search-icon";let ej2_dropdowns_es2015_AutoComplete=(()=>{let AutoComplete=class extends ej2_dropdowns_es2015_ComboBox{constructor(options,element){super(options,element),this.isFiltered=!1}preRender(){super.preRender()}getLocaleName(){return"auto-complete"}getNgDirective(){return"EJS-AUTOCOMPLETE"}getQuery(query){let filterQuery=query?query.clone():this.query?this.query.clone():new ej2_data_es2015_Query,filterType=""!==this.queryString||isNullOrUndefined(this.value)?this.filterType:"equal",queryString=""!==this.queryString||isNullOrUndefined(this.value)?this.queryString:this.value;if(this.isFiltered)return filterQuery;if(null!==this.queryString){let dataType=this.typeOfData(this.dataSource).typeof;if((this.dataSource instanceof ej2_data_es2015_DataManager||"string"!==dataType)&&"number"!==dataType){let mapping=isNullOrUndefined(this.fields.value)?"":this.fields.value;filterQuery.where(mapping,filterType,queryString,this.ignoreCase,this.ignoreAccent)}else filterQuery.where("",filterType,queryString,this.ignoreCase,this.ignoreAccent)}return isNullOrUndefined(this.suggestionCount)||filterQuery.take(this.suggestionCount),filterQuery}searchLists(e){if(this.isTyped=!0,this.isDataFetched=this.isSelectCustom=!1,isNullOrUndefined(this.list)&&super.renderList(!0),this.queryString=this.filterInput.value,40===e.keyCode||38===e.keyCode)return this.queryString=""===this.queryString?null:this.queryString,this.beforePopupOpen=!0,void this.resetList(this.dataSource,this.fields);this.isSelected=!1,this.activeIndex=null;let eventArgs={preventDefaultAction:!1,text:this.filterInput.value,updateData:(dataSource,query,fields)=>{eventArgs.cancel||(this.isFiltered=!0,this.filterAction(dataSource,query,fields))},cancel:!1};this.trigger("filtering",eventArgs,eventArgs=>{eventArgs.cancel||this.isFiltered||eventArgs.preventDefaultAction||this.filterAction(this.dataSource,null,this.fields)})}filterAction(dataSource,query,fields){this.beforePopupOpen=!0,""!==this.queryString&&this.queryString.length>=this.minLength?this.resetList(dataSource,fields,query):this.hidePopup()}clear(e,property){(isNullOrUndefined(property)||!isNullOrUndefined(property)&&isNullOrUndefined(property.dataSource))&&super.clear(e),this.beforePopupOpen&&this.hidePopup()}onActionComplete(ulElement,list,e,isUpdated){this.fixedHeaderElement=null,super.onActionComplete(ulElement,list,e);let item=this.list.querySelector("."+dropDownListClasses.li);isNullOrUndefined(item)||removeClass([item],dropDownListClasses.focus),this.postBackAction()}postBackAction(){this.autofill&&!isNullOrUndefined(this.liCollections[0])&&(isNullOrUndefined(ej2_dropdowns_es2015_Search(this.inputElement.value,[this.liCollections[0]],"StartsWith",this.ignoreCase).item)||super.setAutoFill(this.liCollections[0],!0))}setSelection(li,e){if(this.isValidLI(li))if(!isNullOrUndefined(e)&&"keydown"===e.type&&"enter"!==e.action&&this.isValidLI(li)){let value=this.getFormattedValue(li.getAttribute("data-value"));this.activeIndex=this.getIndexByValue(value),this.setHoverList(li),this.selectedLI=li,this.setScrollPosition(e),this.autofill&&(this.preventAutoFill=!1,super.setAutoFill(li)),attributes(this.inputElement,{"aria-activedescendant":this.selectedLI?this.selectedLI.id:null})}else super.setSelection(li,e)}listOption(dataSource,fieldsSettings){let fields=super.listOption(dataSource,fieldsSettings);if(isNullOrUndefined(fields.itemCreated))fields.itemCreated=e=>{this.highlight&&highlightSearch(e.item,this.queryString,this.ignoreCase,this.filterType)};else{let itemCreated=fields.itemCreated;fields.itemCreated=e=>{this.highlight&&highlightSearch(e.item,this.queryString,this.ignoreCase,this.filterType),itemCreated.apply(this,[e])}}return fields}isFiltering(){return!0}renderPopup(){this.list.scrollTop=0,super.renderPopup()}isEditTextBox(){return""!==this.inputElement.value.trim()}isPopupButton(){return this.showPopupButton}isSelectFocusItem(element){return!1}showPopup(){this.enabled&&(this.beforePopupOpen?this.refreshPopup():(this.beforePopupOpen=!0,this.preventAutoFill=!0,isNullOrUndefined(this.list)?this.renderList():this.resetList(this.dataSource,this.fields)))}hidePopup(){this.DropDownBaseresetBlazorTemplates(!0,!1,!1,!1),super.hidePopup(),this.activeIndex=-1}onPropertyChanged(newProp,oldProp){"autocomplete"===this.getModuleName()&&this.setUpdateInitial(["fields","query","dataSource"],newProp);for(let prop of Object.keys(newProp))switch(prop){case"showPopupButton":if(this.showPopupButton){let button=ej2_inputs_es2015_Input.appendSpan(dropDownListClasses.icon,this.inputWrapper.container,this.createElement);this.inputWrapper.buttons[0]=button,EventHandler.add(this.inputWrapper.buttons[0],"click",this.dropDownClick,this)}else detach(this.inputWrapper.buttons[0]),this.inputWrapper.buttons[0]=null;break;default:let atcProps;atcProps=this.getPropObject(prop,newProp,oldProp),super.onPropertyChanged(atcProps.newProperty,atcProps.oldProperty)}}getModuleName(){return"autocomplete"}render(){super.render()}};return __decorate([Complex({value:null,iconCss:null,groupBy:null},ej2_dropdowns_es2015_FieldSettings)],AutoComplete.prototype,"fields",void 0),__decorate([Property(!0)],AutoComplete.prototype,"ignoreCase",void 0),__decorate([Property(!1)],AutoComplete.prototype,"showPopupButton",void 0),__decorate([Property(!1)],AutoComplete.prototype,"highlight",void 0),__decorate([Property(20)],AutoComplete.prototype,"suggestionCount",void 0),__decorate([Property({})],AutoComplete.prototype,"htmlAttributes",void 0),__decorate([Property(null)],AutoComplete.prototype,"query",void 0),__decorate([Property(1)],AutoComplete.prototype,"minLength",void 0),__decorate([Property("Contains")],AutoComplete.prototype,"filterType",void 0),__decorate([ej2_base_es2015_Event()],AutoComplete.prototype,"filtering",void 0),__decorate([Property(null)],AutoComplete.prototype,"index",void 0),__decorate([Property("Never")],AutoComplete.prototype,"floatLabelType",void 0),__decorate([Property(null)],AutoComplete.prototype,"valueTemplate",void 0),__decorate([Property(null)],AutoComplete.prototype,"filterBarPlaceholder",void 0),__decorate([Property(!1)],AutoComplete.prototype,"allowFiltering",void 0),__decorate([Property(null)],AutoComplete.prototype,"text",void 0),__decorate([NotifyPropertyChanges],AutoComplete)})();const FLOATLINE="e-float-line",FLOATTEXT="e-float-text",LABELTOP="e-label-top",LABELBOTTOM="e-label-bottom";function createFloatLabel(overAllWrapper,searchWrapper,element,inputElement,value,floatLabelType,placeholder){let floatLinelement,floatLabelElement;floatLinelement=ej2_base_es2015_createElement("span",{className:FLOATLINE}),floatLabelElement=ej2_base_es2015_createElement("label",{className:FLOATTEXT}),isNullOrUndefined(element.id)||""===element.id||(floatLabelElement.id="label_"+element.id.replace(/ /g,"_"),attributes(element,{"aria-labelledby":floatLabelElement.id})),isNullOrUndefined(inputElement.placeholder)||""===inputElement.placeholder||(floatLabelElement.innerHTML=inputElement.placeholder,inputElement.removeAttribute("placeholder")),floatLabelElement.innerHTML=placeholder,searchWrapper.appendChild(floatLinelement),searchWrapper.appendChild(floatLabelElement),overAllWrapper.classList.add("e-float-input"),function(value,label){value&&value.length>0?(addClass([label],LABELTOP),removeClass([label],LABELBOTTOM)):(removeClass([label],LABELTOP),addClass([label],LABELBOTTOM))}(value,floatLabelElement),"Always"===floatLabelType&&(floatLabelElement.classList.contains(LABELBOTTOM)&&removeClass([floatLabelElement],LABELBOTTOM),addClass([floatLabelElement],LABELTOP))}function setPlaceHolder(value,inputElement,placeholder){inputElement.placeholder=value&&value.length?"":placeholder}const FOCUS="e-input-focus",HIDE_LIST="e-hide-listitem",CHIP="e-chips";let ej2_dropdowns_es2015_MultiSelect=(()=>{let MultiSelect=class extends ej2_dropdowns_es2015_DropDownBase{constructor(option,element){super(option,element),this.isValidKey=!1,this.selectAllEventData=[],this.selectAllEventEle=[],this.scrollFocusStatus=!1,this.keyDownStatus=!1}enableRTL(state){state?this.overAllWrapper.classList.add("e-rtl"):this.overAllWrapper.classList.remove("e-rtl"),this.popupObj&&(this.popupObj.enableRtl=state,this.popupObj.dataBind())}requiredModules(){let modules=[];if("CheckBox"===this.mode){if(this.isGroupChecking=this.enableGroupCheckBox,this.enableGroupCheckBox){let prevOnChange=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.enableSelectionOrder=!1,this.isProtectedOnChange=prevOnChange}this.allowCustomValue=!1,this.hideSelectedItem=!1,this.closePopupOnSelect=!1,modules.push({member:"CheckBoxSelection",args:[this]})}return modules}updateHTMLAttribute(){if(Object.keys(this.htmlAttributes).length)for(let htmlAttr of Object.keys(this.htmlAttributes))switch(htmlAttr){case"class":this.overAllWrapper.classList.add(this.htmlAttributes[htmlAttr]),this.popupWrapper.classList.add(this.htmlAttributes[htmlAttr]);break;case"disabled":this.enable(!1);break;case"placeholder":this.placeholder||(this.inputElement.setAttribute(htmlAttr,this.htmlAttributes[htmlAttr]),this.setProperties({placeholder:this.inputElement.placeholder},!0),this.refreshPlaceHolder());break;default:let validateAttr=["name","required","aria-required","form"],containerAttr=["title","role","style","class"];["id"].indexOf(htmlAttr)>-1?this.element.setAttribute(htmlAttr,this.htmlAttributes[htmlAttr]):0===htmlAttr.indexOf("data")||validateAttr.indexOf(htmlAttr)>-1?this.hiddenElement.setAttribute(htmlAttr,this.htmlAttributes[htmlAttr]):containerAttr.indexOf(htmlAttr)>-1?this.overAllWrapper.setAttribute(htmlAttr,this.htmlAttributes[htmlAttr]):this.inputElement.setAttribute(htmlAttr,this.htmlAttributes[htmlAttr])}}updateReadonly(state){state||"CheckBox"===this.mode?this.inputElement.setAttribute("readonly","true"):this.inputElement.removeAttribute("readonly")}updateClearButton(state){state?(this.overAllClear.parentNode?this.overAllClear.style.display="":this.componentWrapper.appendChild(this.overAllClear),this.componentWrapper.classList.remove("e-close-icon-hide")):(this.overAllClear.style.display="none",this.componentWrapper.classList.add("e-close-icon-hide"))}updateCssClass(){this.cssClass&&(this.popupWrapper.classList.add(this.cssClass),this.overAllWrapper.classList.add(this.cssClass))}onPopupShown(){if(Browser.isDevice&&"CheckBox"===this.mode&&this.allowFiltering){let proxy=this;window.onpopstate=()=>{proxy.hidePopup(),proxy.inputElement.focus()},history.pushState({},"")}this.trigger("open",{popup:this.popupObj,cancel:!1,animation:{name:"FadeIn",duration:100}},eventArgs=>{eventArgs.cancel||(this.focusAtFirstListItem(),document.body.appendChild(this.popupObj.element),("CheckBox"===this.mode||this.showDropDownIcon)&&addClass([this.overAllWrapper],["e-icon-anim"]),this.refreshPopup(),this.popupObj.show(eventArgs.animation,1e3===this.zIndex?this.element:null),attributes(this.inputElement,{"aria-expanded":"true"}),this.isFirstClick&&this.loadTemplate())})}updateListItems(listItems,mainListItems){for(let i=0;i<listItems.length;i++)this.findGroupStart(listItems[i]),this.findGroupStart(mainListItems[i])}loadTemplate(){this.refreshListItems(null),"CheckBox"===this.mode&&this.removeFocus(),this.notify("reOrder",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,e:this})}setScrollPosition(){if((!this.hideSelectedItem&&"CheckBox"!==this.mode||"CheckBox"===this.mode&&!this.enableSelectionOrder)&&!isNullOrUndefined(this.value)&&this.value.length>0){let valueEle=this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",this.value[this.value.length-1]);isNullOrUndefined(valueEle)||this.scrollBottom(valueEle)}}focusAtFirstListItem(){if(this.ulElement&&this.ulElement.querySelector("li."+dropDownBaseClasses.li)){let element;if("CheckBox"===this.mode)return void this.removeFocus();null!==(element=this.ulElement.querySelector("li."+dropDownBaseClasses.li+":not(."+HIDE_LIST+")"))&&(this.removeFocus(),this.addListFocus(element))}}focusAtLastListItem(data){let activeElement;data?activeElement=ej2_dropdowns_es2015_Search(data,this.liCollections,"StartsWith",this.ignoreCase):this.value&&this.value.length?ej2_dropdowns_es2015_Search(this.value[this.value.length-1],this.liCollections,"StartsWith",this.ignoreCase):activeElement=null,activeElement&&null!==activeElement.item&&(this.addListFocus(activeElement.item),this.scrollBottom(activeElement.item,activeElement.index))}getAriaAttributes(){return{"aria-disabled":"false","aria-owns":this.element.id+"_options",role:"textbox","aria-multiselectable":"true","aria-activedescendant":"null","aria-haspopup":"true","aria-expanded":"false"}}updateListARIA(){attributes(this.ulElement,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false"});let disableStatus=!!this.inputElement.disabled;attributes(this.inputElement,this.getAriaAttributes()),disableStatus&&attributes(this.inputElement,{"aria-disabled":"true"}),this.ensureAriaDisabled(disableStatus?"true":"false")}ensureAriaDisabled(status){if(this.htmlAttributes&&this.htmlAttributes["aria-disabled"]){let attr=this.htmlAttributes;extend(attr,{"aria-disabled":status},attr),this.setProperties({htmlAttributes:attr},!0)}}removelastSelection(e){let elements,value=(elements=this.chipCollectionWrapper.querySelectorAll("span."+CHIP))[elements.length-1].getAttribute("data-value");isNullOrUndefined(this.value)||(this.tempValues=this.value.slice()),this.removeValue(value,e),this.removeChipSelection(),this.updateDelimeter(this.delimiterChar),this.makeTextBoxEmpty(),this.mainList&&this.listData&&this.refreshSelection(),this.checkPlaceholderSize()}onActionFailure(e){super.onActionFailure(e),this.renderPopup(),this.onPopupShown()}targetElement(){return this.targetInputElement=this.inputElement,"CheckBox"===this.mode&&this.allowFiltering&&this.notify("targetElement",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode}),this.targetInputElement.value}getForQuery(valuecheck){let predicate,field=isNullOrUndefined(this.fields.value)?this.fields.text:this.fields.value;for(let i=0;i<valuecheck.length;i++)predicate=0===i?new ej2_data_es2015_Predicate(field,"equal",valuecheck[i]):predicate.or(field,"equal",valuecheck[i]);return this.getQuery(this.query).where(predicate)}onActionComplete(ulElement,list,e,isUpdated){super.onActionComplete(ulElement,list,e);let proxy=this,valuecheck=[];if(!isNullOrUndefined(this.value)&&!this.allowCustomValue)for(let i=0;i<this.value.length;i++)this.findListElement(this.allowFiltering&&!isNullOrUndefined(this.mainList)?this.mainList:ulElement,"li","data-value",proxy.value[i])||valuecheck.push(proxy.value[i]);valuecheck.length>0&&this.dataSource instanceof ej2_data_es2015_DataManager&&!isNullOrUndefined(this.value)?this.dataSource.executeQuery(this.getForQuery(valuecheck)).then(e=>{proxy.addItem(e.result,list.length),proxy.updateActionList(ulElement,list,e)}):this.updateActionList(ulElement,list,e)}updateActionList(ulElement,list,e,isUpdated){"CheckBox"===this.mode&&this.showSelectAll&&this.notify("selectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode}),this.mainList||this.mainData?isNullOrUndefined(this.mainData)||0!==this.mainData.length||(this.mainData=list):(this.mainList=ulElement.cloneNode?ulElement.cloneNode(!0):ulElement,this.mainData=list,this.mainListCollection=this.liCollections),(this.remoteCustomValue||list.length<=0)&&this.allowCustomValue&&this.inputFocus&&this.allowFiltering?this.checkForCustomValue(this.tempQuery,this.fields):(this.value&&this.value.length&&("CheckBox"!==this.mode&&""!==this.inputElement.value||"CheckBox"===this.mode)&&this.refreshSelection(),this.updateListARIA(),this.unwireListEvents(),this.wireListEvents(),isNullOrUndefined(this.setInitialValue)||this.setInitialValue(),isNullOrUndefined(this.selectAllAction)||this.selectAllAction(),this.setDynValue&&(isNullOrUndefined(this.text)||!isNullOrUndefined(this.value)&&0!==this.value.length||this.initialTextUpdate(),this.initialValueUpdate(),this.initialUpdate(),this.refreshPlaceHolder(),this.updateValueState(null,this.value,null)),this.renderPopup(),this.beforePopupOpen&&(this.beforePopupOpen=!1,this.onPopupShown()))}refreshSelection(){let value,element,className=this.hideSelectedItem?HIDE_LIST:dropDownBaseClasses.selected;if(!isNullOrUndefined(this.value))for(let index=0;!isNullOrUndefined(this.value[index]);index++)if(element=this.findListElement(this.list,"li","data-value",value=this.value[index])){if(addClass([element],className),this.hideSelectedItem&&element.previousSibling&&element.previousElementSibling.classList.contains(dropDownBaseClasses.group)&&(!element.nextElementSibling||element.nextElementSibling.classList.contains(dropDownBaseClasses.group))&&addClass([element.previousElementSibling],className),this.hideSelectedItem&&this.fields.groupBy&&!element.previousElementSibling.classList.contains(HIDE_LIST)&&this.hideGroupItem(value),this.hideSelectedItem&&element.classList.contains(dropDownBaseClasses.focus)){removeClass([element],dropDownBaseClasses.focus);let listEle=element.parentElement.querySelectorAll("."+dropDownBaseClasses.li+":not(."+HIDE_LIST+")");listEle.length>0?addClass([listEle[0]],dropDownBaseClasses.focus):(this.ulElement=this.ulElement.cloneNode?this.ulElement.cloneNode(!0):this.ulElement,this.l10nUpdate(),addClass([this.list],dropDownBaseClasses.noData))}if(element.setAttribute("aria-selected","true"),"CheckBox"===this.mode&&element.classList.contains("e-active")){let ariaValue=element.firstElementChild.getAttribute("aria-checked");(isNullOrUndefined(ariaValue)||"false"===ariaValue)&&this.notify("updatelist",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,li:element,e:null})}}this.checkSelectAll(),this.checkMaxSelection()}hideGroupItem(value){let element,element1,className=this.hideSelectedItem?HIDE_LIST:dropDownBaseClasses.selected;element1=element=this.findListElement(this.ulElement,"li","data-value",value);let i=0,j=0,temp=!0,temp1=!0;do{element&&element.previousElementSibling&&!element.previousElementSibling.classList.contains(HIDE_LIST)&&element.previousElementSibling.classList.contains(dropDownBaseClasses.li)&&(temp=!1),!temp||!element||element.previousElementSibling&&element.previousElementSibling.classList.contains(dropDownBaseClasses.group)?i=10:element=element.previousElementSibling,element1&&element1.nextElementSibling&&!element1.nextElementSibling.classList.contains(HIDE_LIST)&&element1.nextElementSibling.classList.contains(dropDownBaseClasses.li)&&(temp1=!1),!temp1||!element1||element1.nextElementSibling&&element1.nextElementSibling.classList.contains(dropDownBaseClasses.group)?j=10:element1=element1.nextElementSibling}while(i<10||j<10);temp&&temp1&&!element.previousElementSibling.classList.contains(HIDE_LIST)?addClass([element.previousElementSibling],className):temp&&temp1&&element.previousElementSibling.classList.contains(HIDE_LIST)&&removeClass([element.previousElementSibling],className)}checkSelectAll(){let groupItemLength=this.list.querySelectorAll("li.e-list-group-item.e-active").length,listItem=this.list.querySelectorAll("li.e-list-item"),searchCount=this.list.querySelectorAll("li."+dropDownBaseClasses.li).length,searchActiveCount=this.list.querySelectorAll("li."+dropDownBaseClasses.selected).length;if(this.enableGroupCheckBox&&!isNullOrUndefined(this.fields.groupBy)&&(searchActiveCount-=groupItemLength),searchCount===searchActiveCount&&"CheckBox"===this.mode&&this.showSelectAll&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,value:"check"}),searchCount!==searchActiveCount&&"CheckBox"===this.mode&&this.showSelectAll&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,value:"uncheck"}),this.enableGroupCheckBox&&this.fields.groupBy&&!this.enableSelectionOrder)for(let i=0;i<listItem.length;i++)this.findGroupStart(listItem[i])}openClick(e){this.openOnClick||"CheckBox"===this.mode?this.openOnClick||"CheckBox"!==this.mode||this.isPopupOpen()||this.showPopup():""!==this.targetElement()?this.showPopup():this.hidePopup()}KeyUp(e){if("CheckBox"!==this.mode||this.openOnClick||isNullOrUndefined(String.fromCharCode(e.keyCode).match(/\w/))||(this.isValidKey=!0),this.isValidKey=this.isPopupOpen()&&8===e.keyCode||this.isValidKey,this.isValidKey)switch(this.isValidKey=!1,this.expandTextbox(),this.showOverAllClear(),e.keyCode){default:if(!this.isPopupOpen()&&this.openOnClick&&this.showPopup(),this.openClick(e),this.checkTextLength()&&!this.allowFiltering&&8!==e.keyCode)this.focusAtFirstListItem();else{let text=this.targetElement();if(this.keyCode=e.keyCode,this.allowFiltering){let eventArgs={preventDefaultAction:!1,text:this.targetElement(),updateData:(dataSource,query,fields)=>{eventArgs.cancel||(this.isFiltered=!0,this.remoteFilterAction=!0,this.dataUpdater(dataSource,query,fields))},event:e,cancel:!1};this.trigger("filtering",eventArgs,eventArgs=>{eventArgs.cancel||this.isFiltered||eventArgs.preventDefaultAction||(this.filterAction=!0,this.dataUpdater(this.dataSource,null,this.fields))})}else{if(this.allowCustomValue){let query=new ej2_data_es2015_Query;query=""!==text?query.where(this.fields.text,"startswith",text,this.ignoreCase,this.ignoreAccent):query,this.dataUpdater(this.mainData,query,this.fields);break}{let liCollections;liCollections=this.list.querySelectorAll("li."+dropDownBaseClasses.li+":not(.e-hide-listitem)");let activeElement=ej2_dropdowns_es2015_Search(this.targetElement(),liCollections,"StartsWith",this.ignoreCase);activeElement&&null!==activeElement.item?(this.addListFocus(activeElement.item),this.list.scrollTop=activeElement.item.offsetHeight*activeElement.index):""!==this.targetElement()?this.removeFocus():this.focusAtFirstListItem()}}}}}getQuery(query){let filterQuery=query?query.clone():this.query?this.query.clone():new ej2_data_es2015_Query;if(this.filterAction){if(null!==this.targetElement()){let dataType=this.typeOfData(this.dataSource).typeof;if((this.dataSource instanceof ej2_data_es2015_DataManager||"string"!==dataType)&&"number"!==dataType){let fields=this.fields;filterQuery.where(isNullOrUndefined(fields.text)?"":fields.text,this.filterType,this.targetElement(),this.ignoreCase,this.ignoreAccent)}else filterQuery.where("",this.filterType,this.targetElement(),this.ignoreCase,this.ignoreAccent)}return filterQuery}return query||(this.query?this.query:new ej2_data_es2015_Query)}dataUpdater(dataSource,query,fields){if(this.isDataFetched=!1,""===this.targetElement().trim()){let list=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.backCommand&&(this.remoteCustomValue=!1,this.onActionComplete(list,this.mainData),this.value&&this.value.length&&this.refreshSelection(),8!==this.keyCode&&this.focusAtFirstListItem(),this.notify("reOrder",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,e:this}))}else this.resetList(dataSource,fields,query),this.allowCustomValue&&(dataSource instanceof ej2_data_es2015_DataManager?(this.remoteCustomValue=!0,this.tempQuery=query):this.checkForCustomValue(query,fields));this.refreshPopup(),"CheckBox"===this.mode&&this.removeFocus()}checkForCustomValue(query,fields){let dataChecks=!this.getValueByText(this.inputElement.value,this.ignoreCase);if(this.allowCustomValue&&dataChecks){let value=this.inputElement.value,field=fields||this.fields;if("string"!=typeof(!isNullOrUndefined(this.mainData)&&this.mainData.length>0?this.mainData[0]:this.mainData)){let dataItem={};setValue(field.text,value,dataItem),setValue(field.value,value,dataItem);let tempData=JSON.parse(JSON.stringify(this.listData));tempData.splice(0,0,dataItem),this.resetList(tempData,field,query)}else this.resetList([this.inputElement.value],field)}this.value&&this.value.length&&this.refreshSelection()}getNgDirective(){return"EJS-MULTISELECT"}wrapperClick(e){if(this.setDynValue=!1,this.enabled)if(e.target!==this.overAllClear){if(this.inputFocus||this.inputElement.focus(),!this.readonly){if(e.target&&-1!==e.target.classList.toString().indexOf("e-chips-close"))return void(this.isPopupOpen()&&this.refreshPopup());!this.isPopupOpen()&&(this.openOnClick||this.showDropDownIcon&&e.target&&"e-input-group-icon e-ddl-icon"===e.target.className)?this.showPopup():(this.hidePopup(),"CheckBox"===this.mode&&(this.showOverAllClear(),this.inputFocus=!0,this.overAllWrapper.classList.contains(FOCUS)||this.overAllWrapper.classList.add(FOCUS)))}e.preventDefault()}else e.preventDefault()}enable(state){state?(this.overAllWrapper.classList.remove("e-disabled"),this.inputElement.removeAttribute("disabled"),attributes(this.inputElement,{"aria-disabled":"false"}),this.ensureAriaDisabled("false")):(this.overAllWrapper.classList.add("e-disabled"),this.inputElement.setAttribute("disabled","true"),attributes(this.inputElement,{"aria-disabled":"true"}),this.ensureAriaDisabled("true")),this.enabled!==state&&(this.enabled=state),this.hidePopup()}onBlur(eve){let target;if(isNullOrUndefined(eve)||(target=eve.relatedTarget),this.popupObj&&document.body.contains(this.popupObj.element)&&this.popupObj.element.contains(target))"CheckBox"!==this.mode&&this.inputElement.focus();else{if("CheckBox"===this.mode&&Browser.isIE&&!isNullOrUndefined(eve))return this.inputFocus=!1,void this.overAllWrapper.classList.remove(FOCUS);if(this.scrollFocusStatus)return isNullOrUndefined(eve)||eve.preventDefault(),this.inputElement.focus(),void(this.scrollFocusStatus=!1);this.inputFocus=!1,this.overAllWrapper.classList.remove(FOCUS),"Box"!==this.mode&&"CheckBox"!==this.mode&&(this.refreshListItems(null),this.updateDelimView()),this.updateValueState(eve,this.value,this.tempValues),this.dispatchEvent(this.hiddenElement,"change"),this.overAllClear.style.display="none",this.isPopupOpen()&&(this.DropDownBaseresetBlazorTemplates(!1,!1,!0,!0,!1,!0,!0),this.hidePopup()),this.makeTextBoxEmpty(),this.trigger("blur"),this.focused=!0,Browser.isDevice&&"Delimiter"!==this.mode&&"CheckBox"!==this.mode&&this.removeChipFocus(),this.removeChipSelection(),this.refreshInputHight(),function(overAllWrapper,componentWrapper,value,floatLabelType,placeholder){overAllWrapper.classList.remove("e-input-focus");let label=componentWrapper.querySelector("."+FLOATTEXT);value&&value.length<=0&&"Auto"===floatLabelType&&!isNullOrUndefined(label)&&(label.classList.contains(LABELTOP)&&removeClass([label],LABELTOP),addClass([label],LABELBOTTOM))}(this.overAllWrapper,this.componentWrapper,this.value,this.floatLabelType),this.refreshPlaceHolder(),(this.allowFiltering||!0===this.enableSelectionOrder&&"CheckBox"===this.mode)&&!isNullOrUndefined(this.mainList)&&(this.ulElement=this.mainList),this.checkPlaceholderSize()}}checkPlaceholderSize(){if(this.showDropDownIcon){let downIconWidth=this.dropIcon.offsetWidth+parseInt(window.getComputedStyle(this.dropIcon).marginRight,10);this.setPlaceholderSize(downIconWidth)}}setPlaceholderSize(downIconWidth){isNullOrUndefined(this.value)||0===this.value.length?this.searchWrapper.style.width="calc(100% - "+(downIconWidth+10)+"px":isNullOrUndefined(this.value)||this.searchWrapper.removeAttribute("style")}refreshInputHight(){this.value&&this.value.length||!isNullOrUndefined(this.text)&&""!==this.text?this.searchWrapper.classList.add("e-zero-size"):this.searchWrapper.classList.remove("e-zero-size")}validateValues(newValue,oldValue){return JSON.stringify(newValue.slice().sort())!==JSON.stringify(oldValue.slice().sort())}updateValueState(event,newVal,oldVal){this.initStatus&&this.validateValues(newVal||[],oldVal||[])&&(this.trigger("change",{e:event,oldValue:oldVal,value:newVal,isInteracted:!!event,element:this.element}),this.updateTempValue())}updateTempValue(){this.tempValues=this.value?this.value.slice():this.value}getPagingCount(){let height=this.list.classList.contains(dropDownBaseClasses.noData)?null:getComputedStyle(this.getItems()[0],null).getPropertyValue("height");return Math.round(this.list.offsetHeight/parseInt(height,10))}pageUpSelection(steps){let previousItem,collection=this.list.querySelectorAll("li."+dropDownBaseClasses.li+":not(."+HIDE_LIST+"):not(.e-reorder-hide)");this.addListFocus(previousItem=steps>=0?collection[steps+1]:collection[0]),this.scrollBottom(previousItem,this.getIndexByValue(previousItem.getAttribute("data-value")))}pageDownSelection(steps){this.getItems();let previousItem,collection=this.list.querySelectorAll("li."+dropDownBaseClasses.li+":not(."+HIDE_LIST+"):not(.e-reorder-hide)");this.addListFocus(previousItem=steps<=collection.length?collection[steps-1]:collection[collection.length-1]),this.scrollBottom(previousItem,this.getIndexByValue(previousItem.getAttribute("data-value")))}getItems(){return this.list||super.render(),this.ulElement?this.ulElement.querySelectorAll("."+dropDownBaseClasses.li).length>0&&this.ulElement.querySelectorAll("."+dropDownBaseClasses.li+":not(."+HIDE_LIST+")"):null}focusInHandler(e){return!!this.enabled&&(this.showOverAllClear(),this.inputFocus=!0,this.value&&this.value.length&&("Delimiter"!==this.mode&&"CheckBox"!==this.mode?this.chipCollectionWrapper.style.display="":this.showDelimWrapper(),"CheckBox"!==this.mode&&(this.viewWrapper.style.display="none")),"CheckBox"!==this.mode&&this.searchWrapper.classList.remove("e-zero-size"),this.checkPlaceholderSize(),this.focused&&(this.trigger("focus",{isInteracted:!!e,event:e}),this.focused=!1),this.overAllWrapper.classList.contains(FOCUS)||this.overAllWrapper.classList.add(FOCUS),function(overAllWrapper,componentWrapper){overAllWrapper.classList.add("e-input-focus");let label=componentWrapper.querySelector("."+FLOATTEXT);isNullOrUndefined(label)||(addClass([label],LABELTOP),label.classList.contains(LABELBOTTOM)&&removeClass([label],LABELBOTTOM))}(this.overAllWrapper,this.componentWrapper),this.isPopupOpen()&&this.refreshPopup(),!0)}showDelimWrapper(){"CheckBox"===this.mode?this.viewWrapper.style.display="":this.delimiterWrapper.style.display="",this.componentWrapper.classList.add("e-delimiter")}hideDelimWrapper(){this.delimiterWrapper.style.display="none",this.componentWrapper.classList.remove("e-delimiter")}expandTextbox(){let size=5;this.placeholder&&(size=size>this.inputElement.placeholder.length?size:this.inputElement.placeholder.length),this.inputElement.size=this.inputElement.value.length>size?this.inputElement.value.length:size}isPopupOpen(){return null!==this.popupWrapper&&null!==this.popupWrapper.parentElement}refreshPopup(){this.popupObj&&this.mobFilter&&(this.popupObj.setProperties({width:this.calcPopupWidth()}),this.popupObj.refreshPosition(this.overAllWrapper))}checkTextLength(){return this.targetElement().length<1}popupKeyActions(e){switch(e.keyCode){case 38:this.hidePopup(),"CheckBox"===this.mode&&this.inputElement.focus(),e.preventDefault();break;case 40:this.isPopupOpen()||(this.showPopup(),e.preventDefault())}}updateAriaAttribute(){let focusedItem=this.list.querySelector("."+dropDownBaseClasses.focus);isNullOrUndefined(focusedItem)||this.inputElement.setAttribute("aria-activedescendant",focusedItem.id)}homeNavigation(isHome){this.removeFocus();let scrollEle=this.ulElement.querySelectorAll("li."+dropDownBaseClasses.li+":not(."+HIDE_LIST+"):not(.e-reorder-hide)");if(scrollEle.length>0){let element=scrollEle[isHome?0:scrollEle.length-1];element.classList.add(dropDownBaseClasses.focus),this.scrollBottom(element)}}onKeyDown(e){if(!this.readonly&&(this.enabled||"CheckBox"===this.mode)&&(this.keyDownStatus=!0,!(e.keyCode>111&&e.keyCode<124)))if(e.altKey)this.popupKeyActions(e);else{if(this.isPopupOpen()){let activeIndex,focusedItem=this.list.querySelector("."+dropDownBaseClasses.focus);switch(e.keyCode){case 36:case 35:this.homeNavigation(36===e.keyCode);break;case 33:return e.preventDefault(),void(focusedItem&&(this.getIndexByValue(focusedItem.getAttribute("data-value")),this.pageUpSelection(activeIndex-this.getPagingCount()),this.updateAriaAttribute()));case 34:return e.preventDefault(),void(focusedItem&&(this.getIndexByValue(focusedItem.getAttribute("data-value")),this.pageDownSelection(activeIndex+this.getPagingCount()),this.updateAriaAttribute()));case 38:this.arrowUp(e);break;case 40:this.arrowDown(e);break;case 27:return e.preventDefault(),this.hidePopup(),void("CheckBox"===this.mode&&this.inputElement.focus());case 13:return e.preventDefault(),"CheckBox"!==this.mode&&this.selectByKey(e),void this.checkPlaceholderSize();case 32:return void this.spaceKeySelection(e);case 9:e.preventDefault(),this.hidePopup(),this.inputElement.focus(),this.overAllWrapper.classList.add(FOCUS)}}else switch(e.keyCode){case 13:case 9:case 16:case 17:case 20:return;case 40:this.openOnClick&&this.showPopup();break;case 27:return e.preventDefault(),void this.escapeAction()}this.checkTextLength()&&this.keyNavigation(e),"CheckBox"===this.mode&&this.enableSelectionOrder&&this.checkBackCommand(e),this.expandTextbox(),this.refreshPopup()}}arrowDown(e){e.preventDefault(),this.moveByList(1),this.keyAction=!0,(document.activeElement.classList.contains("e-input-filter")||"CheckBox"===this.mode&&!this.allowFiltering&&document.activeElement!==this.list)&&(this.list.focus(),EventHandler.add(this.list,"keydown",this.onKeyDown,this)),this.updateAriaAttribute()}arrowUp(e){e.preventDefault(),this.keyAction=!0;let list=this.list.querySelectorAll("li."+dropDownBaseClasses.li+":not(."+HIDE_LIST+"):not(.e-reorder-hide)");this.enableGroupCheckBox&&"CheckBox"===this.mode&&!isNullOrUndefined(this.fields.groupBy)&&(list=this.list.querySelectorAll("li."+dropDownBaseClasses.li+",li."+dropDownBaseClasses.group+":not(."+HIDE_LIST+"):not(.e-reorder-hide)"));let focuseElem=this.list.querySelector("li."+dropDownBaseClasses.focus);Array.prototype.slice.call(list).indexOf(focuseElem)<=0&&"CheckBox"===this.mode&&this.allowFiltering?(this.keyAction=!1,this.notify("inputFocus",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,value:"focus"})):this.list.focus(),this.moveByList(-1),this.updateAriaAttribute()}spaceKeySelection(e){"CheckBox"===this.mode&&(document.activeElement.classList.contains("e-input-filter")||(e.preventDefault(),this.keyAction=!0,this.list.focus()),this.selectByKey(e)),this.checkPlaceholderSize()}checkBackCommand(e){this.backCommand=8!==e.keyCode||""!==this.targetElement()}keyNavigation(e){if("Delimiter"!==this.mode&&"CheckBox"!==this.mode&&this.value&&this.value.length)switch(e.keyCode){case 37:e.preventDefault(),this.moveBy(-1,e);break;case 39:e.preventDefault(),this.moveBy(1,e);break;case 8:this.removelastSelection(e);break;case 46:this.removeSelectedChip(e)}else if(8===e.keyCode&&"Delimiter"===this.mode&&this.value&&this.value.length){e.preventDefault();let temp=this.value[this.value.length-1];this.removeValue(temp,e),this.updateDelimeter(this.delimiterChar),this.focusAtLastListItem(temp)}}selectByKey(e){this.removeChipSelection(),this.selectListByKey(e),this.hideSelectedItem&&this.focusAtFirstListItem()}escapeAction(){let temp=this.tempValues?this.tempValues.slice():[];this.value&&this.validateValues(this.value,temp)&&("CheckBox"!==this.mode&&(this.value=temp,this.initialValueUpdate()),"Delimiter"!==this.mode&&"CheckBox"!==this.mode?this.chipCollectionWrapper.style.display="":this.showDelimWrapper(),this.refreshPlaceHolder(),this.value.length?this.showOverAllClear():this.hideOverAllClear()),this.makeTextBoxEmpty()}scrollBottom(selectedLI,activeIndex){let currentOffset=this.list.offsetHeight,nextBottom=selectedLI.offsetTop+selectedLI.offsetHeight-this.list.scrollTop,nextOffset=this.list.scrollTop+nextBottom-currentOffset,boxRange=selectedLI.offsetTop+selectedLI.offsetHeight-this.list.scrollTop;boxRange=this.fields.groupBy&&!isUndefined(this.fixedHeaderElement)?boxRange-this.fixedHeaderElement.offsetHeight:boxRange,0===activeIndex?this.list.scrollTop=0:nextBottom>currentOffset?this.list.scrollTop=nextOffset:boxRange>0&&this.list.offsetHeight>boxRange||(this.list.scrollTop=nextOffset)}scrollTop(selectedLI,activeIndex){let nextOffset=selectedLI.offsetTop-this.list.scrollTop;nextOffset=this.fields.groupBy&&!isUndefined(this.fixedHeaderElement)?nextOffset-this.fixedHeaderElement.offsetHeight:nextOffset;let boxRange=selectedLI.offsetTop+selectedLI.offsetHeight-this.list.scrollTop;0===activeIndex?this.list.scrollTop=0:nextOffset<0?this.list.scrollTop=this.list.scrollTop+nextOffset:boxRange>0&&this.list.offsetHeight>boxRange||(this.list.scrollTop=selectedLI.offsetTop-(this.fields.groupBy&&!isUndefined(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}selectListByKey(e){let target,li=this.list.querySelector("li."+dropDownBaseClasses.focus),limit=this.value&&this.value.length?this.value.length:0;null!==li&&(li.classList.contains("e-active")&&(limit-=1),this.isValidLI(li)&&limit<this.maximumSelectionLength?(this.updateListSelection(li,e),this.addListFocus(li),"CheckBox"===this.mode?(this.updateDelimView(),this.updateDelimeter(this.delimiterChar),this.refreshInputHight(),this.enableGroupCheckBox&&!isNullOrUndefined(this.fields.groupBy)&&this.findGroupStart(target=li.firstElementChild.lastElementChild)):this.updateDelimeter(this.delimiterChar),this.makeTextBoxEmpty(),"CheckBox"!==this.mode&&this.refreshListItems(li.textContent),this.refreshPopup()):!this.isValidLI(li)&&limit<this.maximumSelectionLength&&((target=li.firstElementChild.lastElementChild).classList.contains("e-check")?this.selectAllItem(!1,e,li):this.selectAllItem(!0,e,li)),this.refreshSelection(),this.closePopupOnSelect&&this.hidePopup()),this.refreshPlaceHolder()}refreshListItems(data){if((this.allowFiltering||"CheckBox"===this.mode&&!0===this.enableSelectionOrder||this.allowCustomValue)&&this.mainList&&this.listData){let list;list="Descending"===this.sortOrder||"Ascending"===this.sortOrder?this.ulElement.cloneNode?this.ulElement.cloneNode(!0):this.ulElement:this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList,this.onActionComplete(list,this.mainData),this.focusAtLastListItem(data),this.value&&this.value.length&&this.refreshSelection()}}removeSelectedChip(e){let temp,selectedElem=this.chipCollectionWrapper.querySelector("span.e-chip-selected");null!==selectedElem&&(isNullOrUndefined(this.value)||(this.tempValues=this.value.slice()),null!==(temp=selectedElem.nextElementSibling)&&(this.removeChipSelection(),this.addChipSelection(temp,e)),this.removeValue(selectedElem.getAttribute("data-value"),e),this.makeTextBoxEmpty()),this.closePopupOnSelect&&this.hidePopup(),this.checkPlaceholderSize()}moveByTop(state){let index,elements=this.list.querySelectorAll("li."+dropDownBaseClasses.li);elements.length>1&&(this.removeFocus(),this.addListFocus(elements[index=state?0:elements.length-1]),this.scrollBottom(elements[index],index)),this.updateAriaAttribute()}moveByList(position){if(this.list){let elements=this.list.querySelectorAll("li."+dropDownBaseClasses.li+":not(."+HIDE_LIST+"):not(.e-reorder-hide)");"CheckBox"===this.mode&&this.enableGroupCheckBox&&!isNullOrUndefined(this.fields.groupBy)&&(elements=this.list.querySelectorAll("li."+dropDownBaseClasses.li+",li."+dropDownBaseClasses.group+":not(."+HIDE_LIST+"):not(.e-reorder-hide)"));let selectedElem=this.list.querySelector("li."+dropDownBaseClasses.focus),temp=-1;if(elements.length){for(let index=0;index<elements.length;index++)if(elements[index]===selectedElem){temp=index;break}position>0?temp<elements.length-1&&(this.removeFocus(),this.addListFocus(elements[++temp]),this.updateCheck(elements[temp]),this.scrollBottom(elements[temp],temp)):temp>0&&(this.removeFocus(),this.addListFocus(elements[--temp]),this.updateCheck(elements[temp]),this.scrollTop(elements[temp],temp))}}}updateCheck(element){"CheckBox"===this.mode&&this.enableGroupCheckBox&&!isNullOrUndefined(this.fields.groupBy)&&(element.firstElementChild.lastElementChild.classList.contains("e-check")?element.classList.add("e-active"):element.classList.remove("e-active"))}moveBy(position,e){let elements,selectedElem,temp;elements=this.chipCollectionWrapper.querySelectorAll("span."+CHIP),null===(selectedElem=this.chipCollectionWrapper.querySelector("span.e-chip-selected"))?position<0&&this.addChipSelection(elements[elements.length-1],e):position<0?null!==(temp=selectedElem.previousElementSibling)&&(this.removeChipSelection(),this.addChipSelection(temp,e)):(temp=selectedElem.nextElementSibling,this.removeChipSelection(),null!==temp&&this.addChipSelection(temp,e))}chipClick(e){if(this.enabled){let elem=closest(e.target,"."+CHIP);this.removeChipSelection(),this.addChipSelection(elem,e)}}removeChipSelection(){this.chipCollectionWrapper&&this.removeChipFocus()}addChipSelection(element,e){addClass([element],"e-chip-selected"),this.trigger("chipSelection",e)}onChipRemove(e){if(3!==e.which&&2!==e.button&&this.enabled&&!this.readonly){let customVal=e.target.parentElement.getAttribute("data-value"),value=this.getFormattedValue(customVal);if(this.allowCustomValue&&("false"!==customVal&&!1===value||!isNullOrUndefined(value)&&"NaN"===value.toString())&&(value=customVal),this.isPopupOpen()&&"CheckBox"!==this.mode&&this.hidePopup(),this.inputFocus||this.inputElement.focus(),this.removeValue(value,e),isNullOrUndefined(this.findListElement(this.list,"li","data-value",value))&&this.mainList&&this.listData){let list=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(list,this.mainData)}this.updateDelimeter(this.delimiterChar),this.placeholder&&"Never"===this.floatLabelType?(this.makeTextBoxEmpty(),this.checkPlaceholderSize()):this.inputElement.value="",e.preventDefault()}}makeTextBoxEmpty(){this.inputElement.value="",this.refreshPlaceHolder()}refreshPlaceHolder(){this.placeholder&&"Never"===this.floatLabelType?this.inputElement.placeholder=this.value&&this.value.length||!isNullOrUndefined(this.text)&&""!==this.text?"":this.placeholder:this.setFloatLabelType(),this.expandTextbox()}removeValue(value,eve,length,isClearAll){let index=this.value.indexOf(this.getFormattedValue(value));-1===index&&this.allowCustomValue&&!isNullOrUndefined(value)&&(index=this.value.indexOf(value.toString()));let className=this.hideSelectedItem?HIDE_LIST:dropDownBaseClasses.selected;if(-1!==index){let element=this.findListElement(this.list,"li","data-value",value),val=this.getDataByValue(value);this.trigger("removing",{e:eve,item:element,itemData:val,isInteracted:!!eve,cancel:!1},eventArgs=>{if(eventArgs.cancel)this.removeIndex++;else{let removeVal=this.value.slice(0);if(removeVal.splice(index,1),this.setProperties({value:[].concat([],removeVal)},!0),null!==element){let hideElement=this.findListElement(this.mainList,"li","data-value",value);element.setAttribute("aria-selected","false"),removeClass([element],className),hideElement&&(hideElement.setAttribute("aria-selected","false"),removeClass([element,hideElement],className)),this.notify("activeList",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,li:element,e:this,index:index}),this.notify("updatelist",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,li:element,e:eve}),attributes(this.inputElement,{"aria-activedescendant":element.id}),this.value.length!==this.mainData.length&&"CheckBox"===this.mode&&this.showSelectAll&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,value:"uncheck"})}this.hideSelectedItem&&this.fields.groupBy&&this.hideGroupItem(value),this.updateMainList(!0,value),this.removeChip(value),this.updateChipStatus(),(this.value&&this.value.length?this.value.length:0)<this.maximumSelectionLength&&removeClass(this.list.querySelectorAll("li."+dropDownBaseClasses.li+":not(.e-active)"),"e-disable"),this.trigger("removed",eventArgs),length&&(this.selectAllEventData.push(val),this.selectAllEventEle.push(element)),1===length&&(this.trigger("selectedAll",{event:eve,items:this.selectAllEventEle,itemData:this.selectAllEventData,isInteracted:!!eve,isChecked:!1}),this.selectAllEventData=[],this.selectAllEventEle=[]),isClearAll&&this.clearAllCallback(eve)}})}}updateMainList(state,value){if(this.allowFiltering||"CheckBox"===this.mode){let element2=this.findListElement(this.mainList,"li","data-value",value);element2&&(state?(element2.setAttribute("aria-selected","false"),removeClass([element2],this.hideSelectedItem?HIDE_LIST:dropDownBaseClasses.selected),"CheckBox"===this.mode&&(element2.firstElementChild.setAttribute("aria-checked","false"),removeClass([element2.firstElementChild.lastElementChild],"e-check"))):(element2.setAttribute("aria-selected","true"),addClass([element2],this.hideSelectedItem?HIDE_LIST:dropDownBaseClasses.selected),"CheckBox"===this.mode&&(element2.firstElementChild.setAttribute("aria-checked","true"),addClass([element2.firstElementChild.lastElementChild],"e-check"))))}}removeChip(value){if(this.chipCollectionWrapper){let element=this.findListElement(this.chipCollectionWrapper,"span","data-value",value);element&&ej2_base_es2015_remove(element)}}updateChipStatus(){this.value.length?(isNullOrUndefined(this.chipCollectionWrapper)||(this.chipCollectionWrapper.style.display=""),"Delimiter"!==this.mode&&"CheckBox"!==this.mode||this.showDelimWrapper(),this.showOverAllClear()):(isNullOrUndefined(this.chipCollectionWrapper)||(this.chipCollectionWrapper.style.display="none"),isNullOrUndefined(this.delimiterWrapper)||(this.delimiterWrapper.style.display="none"),this.hideOverAllClear())}addValue(value,text,eve){this.value||(this.value=[]),this.setProperties({value:[].concat([],this.value,[value])},!0);let element=this.findListElement(this.list,"li","data-value",value);this.removeFocus(),element&&(this.addListFocus(element),this.addListSelection(element)),"Delimiter"!==this.mode&&"CheckBox"!==this.mode&&this.addChip(text,value,eve),this.hideSelectedItem&&this.fields.groupBy&&this.hideGroupItem(value),this.updateChipStatus(),this.checkMaxSelection()}checkMaxSelection(){(this.value&&this.value.length?this.value.length:0)===this.maximumSelectionLength&&addClass(this.list.querySelectorAll("li."+dropDownBaseClasses.li+":not(.e-active)"),"e-disable")}dispatchSelect(value,eve,element,isNotTrigger,length){if(this.initStatus&&!isNotTrigger){let val=this.getDataByValue(value);this.trigger("select",{e:eve,item:element,itemData:val,isInteracted:!!eve,cancel:!1},eventArgs=>{eventArgs.cancel||(length&&(this.selectAllEventData.push(val),this.selectAllEventEle.push(element)),1===length&&(this.trigger("selectedAll",{event:eve,items:this.selectAllEventEle,itemData:this.selectAllEventData,isInteracted:!!eve,isChecked:!0}),this.selectAllEventData=[]),this.updateListSelectEventCallback(value,element,eve))})}}addChip(text,value,e){this.chipCollectionWrapper&&this.getChip(text,value,e)}removeChipFocus(){let elements,closeElements;if(elements=this.chipCollectionWrapper.querySelectorAll("span."+CHIP),closeElements=this.chipCollectionWrapper.querySelectorAll("span."+"e-chips-close".split(" ")[0]),removeClass(elements,"e-chip-selected"),Browser.isDevice)for(let index=0;index<closeElements.length;index++)closeElements[index].style.display="none"}onMobileChipInteraction(e){let chipElem=closest(e.target,"."+CHIP),chipClose=chipElem.querySelector("span."+"e-chips-close".split(" ")[0]);this.enabled&&!this.readonly&&(chipElem.classList.contains("e-chip-selected")||(this.removeChipFocus(),chipClose.style.display="",chipElem.classList.add("e-chip-selected")),this.refreshPopup(),e.preventDefault())}getChip(data,value,e){let itemData={text:value,value:value},chip=this.createElement("span",{className:CHIP,attrs:{"data-value":value,title:data}}),chipContent=this.createElement("span",{className:"e-chipcontent"}),chipClose=this.createElement("span",{className:"e-chips-close"});if(this.mainData&&(itemData=this.getDataByValue(value)),this.valueTemplate&&!isNullOrUndefined(itemData)){let compiledString=compile$$1(this.valueTemplate);for(let item of compiledString(itemData,null,null,this.valueTemplateId,this.isStringTemplate))chipContent.appendChild(item);this.DropDownBaseupdateBlazorTemplates(!1,!1,!1,!1,!0,!1,!1,!1)}else chipContent.innerHTML=data;chip.appendChild(chipContent),this.trigger("tagging",{isInteracted:!!e,itemData:itemData,e:e,setClass:classes=>{addClass([chip],classes)},cancel:!1},eventArgs=>{eventArgs.cancel||(Browser.isDevice?(chip.classList.add("e-mob-chip"),append([chipClose],chip),chipClose.style.display="none",EventHandler.add(chip,"click",this.onMobileChipInteraction,this)):(EventHandler.add(chip,"mousedown",this.chipClick,this),this.showClearButton&&chip.appendChild(chipClose)),EventHandler.add(chipClose,"mousedown",this.onChipRemove,this),this.chipCollectionWrapper.appendChild(chip))})}calcPopupWidth(){let width=formatUnit(this.popupWidth);return width.indexOf("%")>-1&&(width=(this.componentWrapper.offsetWidth*parseFloat(width)/100).toString()+"px"),width}mouseIn(){this.enabled&&!this.readonly&&this.showOverAllClear()}mouseOut(){this.inputFocus||(this.overAllClear.style.display="none")}listOption(dataSource,fields){let iconCss=!isNullOrUndefined(fields.iconCss),fieldProperty=isNullOrUndefined(fields.properties)?fields:fields.properties;return this.listCurrentOptions=null!==fields.text||null!==fields.value?{fields:fieldProperty,showIcon:iconCss,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}},extend(this.listCurrentOptions,this.listCurrentOptions,fields,!0),"CheckBox"===this.mode&&this.notify("listoption",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,dataSource:dataSource,fieldProperty:fieldProperty}),this.listCurrentOptions}renderPopup(){this.list||super.render(),this.popupObj||this.trigger("beforeOpen",{cancel:!1},args=>{if(!args.cancel){document.body.appendChild(this.popupWrapper);let checkboxFilter=this.popupWrapper.querySelector(".e-filter-parent");"CheckBox"===this.mode&&!this.allowFiltering&&checkboxFilter&&this.filterParent&&(checkboxFilter.remove(),this.filterParent=null);let overAllHeight=parseInt(this.popupHeight,10);if(this.popupWrapper.style.visibility="hidden",this.headerTemplate&&(this.setHeaderTemplate(),overAllHeight-=this.header.offsetHeight),append([this.list],this.popupWrapper),this.footerTemplate&&(this.setFooterTemplate(),overAllHeight-=this.footer.offsetHeight),"CheckBox"===this.mode&&this.showSelectAll?(this.notify("selectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode}),overAllHeight-=this.selectAllHeight):"CheckBox"!==this.mode||this.showSelectAll||this.headerTemplate&&this.footerTemplate?"CheckBox"!==this.mode||this.showSelectAll||(this.notify("selectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode}),overAllHeight=parseInt(this.popupHeight,10),this.headerTemplate&&this.header&&(overAllHeight-=this.header.offsetHeight),this.footerTemplate&&this.footer&&(overAllHeight-=this.footer.offsetHeight)):(this.notify("selectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode}),overAllHeight=parseInt(this.popupHeight,10)),"CheckBox"===this.mode){let args={module:"CheckBoxSelection",enable:"CheckBox"===this.mode,popupElement:this.popupWrapper};this.allowFiltering&&(this.notify("searchBox",args),overAllHeight-=this.searchBoxHeight),addClass([this.popupWrapper],"e-checkbox")}"auto"!==this.popupHeight?(this.list.style.maxHeight=formatUnit(overAllHeight),this.popupWrapper.style.maxHeight=formatUnit(this.popupHeight)):this.list.style.maxHeight=formatUnit(this.popupHeight),this.popupObj=new ej2_popups_es2015_Popup(this.popupWrapper,{width:this.calcPopupWidth(),targetType:"relative",position:{X:"left",Y:"bottom"},relateTo:this.overAllWrapper,collision:{X:"flip",Y:"flip"},offsetY:1,enableRtl:this.enableRtl,zIndex:this.zIndex,close:()=>{this.popupObj.element.parentElement&&(this.popupObj.unwireScrollEvents(),detach(this.popupObj.element))},open:()=>{if(!this.isFirstClick){let ulElement=this.list.querySelector("ul");if(ulElement){let isBlazor$$1=Object.keys(window).indexOf("Blazor")>=0;this.itemTemplate&&"CheckBox"===this.mode&&isBlazor$$1?setTimeout(()=>{this.mainList=this.ulElement},0):this.mainList=ulElement.cloneNode?ulElement.cloneNode(!0):ulElement}this.isFirstClick=!0}this.popupObj.wireScrollEvents(),this.loadTemplate(),this.setScrollPosition(),this.allowFiltering&&this.notify("inputFocus",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,value:"focus"})}}),this.popupObj.close(),this.popupWrapper.style.visibility="","CheckBox"===this.mode&&Browser.isDevice&&this.allowFiltering&&this.notify("deviceSearchBox",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode})}})}setHeaderTemplate(){let compiledString;this.header&&this.header.remove(),this.header=this.createElement("div"),addClass([this.header],"e-ddl-header");let elements=(compiledString=compile$$1(this.headerTemplate))({},null,null,this.headerTemplateId,this.isStringTemplate);for(let temp=0;temp<elements.length;temp++)this.header.appendChild(elements[temp]);this.DropDownBaseupdateBlazorTemplates(!1,!1,!1,!1,!1,!0,!1),"CheckBox"===this.mode&&this.showSelectAll?prepend([this.header],this.popupWrapper):append([this.header],this.popupWrapper),EventHandler.add(this.header,"mousedown",this.onListMouseDown,this)}setFooterTemplate(){let compiledString;this.footer&&this.footer.remove(),this.footer=this.createElement("div"),addClass([this.footer],"e-ddl-footer");let elements=(compiledString=compile$$1(this.footerTemplate))({},null,null,this.footerTemplateId,this.isStringTemplate);for(let temp=0;temp<elements.length;temp++)this.footer.appendChild(elements[temp]);this.DropDownBaseupdateBlazorTemplates(!1,!1,!1,!1,!1,!1,!0),append([this.footer],this.popupWrapper),EventHandler.add(this.footer,"mousedown",this.onListMouseDown,this)}ClearAll(e){if(this.enabled&&!this.readonly){let temp;if(this.value)for(this.removeIndex=0,temp=this.value[this.removeIndex];this.removeIndex<this.value.length;temp=this.value[this.removeIndex])this.removeValue(temp,e,null,!0);else this.clearAllCallback(e)}}clearAllCallback(e){let tempValues=this.value?this.value.slice():[];if(this.mainList&&this.listData&&this.allowFiltering){let list=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(list,this.mainData)}this.focusAtFirstListItem(),this.updateDelimeter(this.delimiterChar),"Box"===this.mode||this.inputFocus&&"CheckBox"!==this.mode||this.updateDelimView(),this.makeTextBoxEmpty(),this.checkPlaceholderSize(),this.isPopupOpen()&&this.refreshPopup(),this.inputFocus||(this.updateValueState(e,this.value,tempValues),"CheckBox"!==this.mode&&this.inputElement.focus()),"CheckBox"===this.mode&&(this.refreshPlaceHolder(),this.refreshInputHight()),"CheckBox"===this.mode&&this.enableGroupCheckBox&&!isNullOrUndefined(this.fields.groupBy)&&this.updateListItems(this.list.querySelectorAll("li.e-list-item"),this.mainList.querySelectorAll("li.e-list-item")),e.preventDefault()}windowResize(){this.refreshPopup(),this.inputFocus&&"CheckBox"!==this.mode||!this.viewWrapper||!this.viewWrapper.parentElement||this.updateDelimView()}resetValueHandler(e){let formElement=closest(this.inputElement,"form");if(formElement&&e.target===formElement){let textVal=this.element.tagName===this.getNgDirective()?null:this.element.getAttribute("data-initial-value");this.text=textVal}}wireEvent(){EventHandler.add(this.componentWrapper,"mousedown",this.wrapperClick,this),EventHandler.add(window,"resize",this.windowResize,this),EventHandler.add(this.inputElement,"focus",this.focusInHandler,this),EventHandler.add(this.inputElement,"keydown",this.onKeyDown,this),EventHandler.add(this.inputElement,"keyup",this.KeyUp,this),"CheckBox"!==this.mode&&EventHandler.add(this.inputElement,"input",this.onInput,this),EventHandler.add(this.inputElement,"blur",this.onBlur,this),EventHandler.add(this.componentWrapper,"mousemove",this.mouseIn,this);let formElement=closest(this.inputElement,"form");formElement&&EventHandler.add(formElement,"reset",this.resetValueHandler,this),EventHandler.add(this.componentWrapper,"mouseout",this.mouseOut,this),EventHandler.add(this.overAllClear,"mouseup",this.ClearAll,this)}onInput(){this.isValidKey=!!this.keyDownStatus,this.keyDownStatus=!1}preRender(){null===this.allowFiltering&&(this.allowFiltering="CheckBox"===this.mode),this.initializeData(),this.updateDataAttribute(this.htmlAttributes),super.preRender()}getLocaleName(){return"multi-select"}initializeData(){this.mainListCollection=[],this.beforePopupOpen=!1,this.filterAction=!1,this.remoteFilterAction=!1,this.isFirstClick=!1,this.mobFilter=!0,this.isFiltered=!1,this.focused=!0,this.initial=!0,this.backCommand=!0}updateData(delimiterChar){let temp,data="",delim="Delimiter"===this.mode||"CheckBox"===this.mode,text=[],tempData=this.listData;if(this.listData=this.mainData,this.hiddenElement.innerHTML="",!isNullOrUndefined(this.value))for(let index=0;!isNullOrUndefined(this.value[index]);index++)data+=(temp=this.listData?this.getTextByValue(this.value[index]):this.value[index])+delimiterChar+" ",text.push(temp),this.hiddenElement.innerHTML+='<option selected value ="'+this.value[index]+'">'+index+"</option>";this.setProperties({text:text.toString()},!0),delim&&(this.delimiterWrapper.innerHTML=data),this.listData=tempData}initialTextUpdate(){if(isNullOrUndefined(this.text))this.setProperties({value:null},!0);else{let textArr=this.text.split(this.delimiterChar),textVal=[];for(let index=0;textArr.length>index;index++){let val=this.getValueByText(textArr[index]);isNullOrUndefined(val)?this.allowCustomValue&&textVal.push(textArr[index]):textVal.push(val)}textVal&&textVal.length&&this.setProperties({value:textVal},!0)}}renderList(isEmptyData){super.render(isEmptyData),this.wireListEvents()}initialValueUpdate(){if(this.list){let text,element,value;if(this.chipCollectionWrapper&&(this.chipCollectionWrapper.innerHTML=""),this.removeListSelection(),!isNullOrUndefined(this.value))for(let index=0;!isNullOrUndefined(this.value[index]);index++)if(element=this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",value=this.value[index]),text=this.getTextByValue(value),element&&"true"!==element.getAttribute("aria-selected")||element&&"true"===element.getAttribute("aria-selected")&&this.hideSelectedItem&&("Box"===this.mode||"Default"===this.mode))this.addChip(text,value),this.addListSelection(element);else if(value&&this.allowCustomValue){let indexItem=this.listData.length,newValue={};setValue(this.fields.text,value,newValue),setValue(this.fields.value,value,newValue);let noDataEle=this.popupWrapper.querySelector("."+dropDownBaseClasses.noData);this.addItem(newValue,indexItem),this.popupWrapper.contains(noDataEle)&&(this.list.setAttribute("style",noDataEle.getAttribute("style")),this.popupWrapper.replaceChild(this.list,noDataEle),this.wireListEvents()),this.addChip(text,value),this.addListSelection(element)}"CheckBox"===this.mode?(this.updateDelimView(),this.updateValueState(null,this.value,this.tempValues),this.updateDelimeter(this.delimiterChar),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar),"CheckBox"!==this.mode||!this.showSelectAll||!isNullOrUndefined(this.value)&&this.value.length||this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,value:"uncheck"}),this.inputFocus||("Box"===this.mode?this.chipCollectionWrapper.style.display="":"Delimiter"!==this.mode&&"CheckBox"!==this.mode||this.showDelimWrapper())}}updateActionCompleteData(li,item){this.value&&this.value.indexOf(li.getAttribute("data-value"))>-1&&(this.mainList=this.ulElement,addClass([li],HIDE_LIST))}isValidLI(li){return li&&!li.classList.contains(dropDownBaseClasses.disabled)&&!li.classList.contains(dropDownBaseClasses.group)&&li.classList.contains(dropDownBaseClasses.li)}updateListSelection(li,e,length){let customVal=li.getAttribute("data-value"),value=this.getFormattedValue(customVal);this.allowCustomValue&&("false"!==customVal&&!1===value||!isNullOrUndefined(value)&&"NaN"===value.toString())&&(value=customVal),this.getTextByValue(value),this.removeHover(),this.value&&-1!==this.value.indexOf(value)?this.removeValue(value,e,length):this.dispatchSelect(value,e,li,"true"===li.getAttribute("aria-selected"),length)}updateListSelectEventCallback(value,li,e){let text=this.getTextByValue(value);if(!this.allowCustomValue&&!this.allowFiltering||this.findListElement(this.mainList,"li","data-value",value))this.remoteCustomValue=!1,this.addValue(value,text,e);else{let temp=li.cloneNode(!0),data=this.getDataByValue(value);this.trigger("customValueSelection",{newData:data,cancel:!1},eventArgs=>{eventArgs.cancel||(append([temp],this.mainList),this.mainData.push(data),this.remoteCustomValue=!1,this.addValue(value,text,e))})}}removeListSelection(){let className=this.hideSelectedItem?HIDE_LIST:dropDownBaseClasses.selected,selectedItems=this.list.querySelectorAll("."+className),temp=selectedItems.length;if(selectedItems&&selectedItems.length)for(removeClass(selectedItems,className);temp>0;)selectedItems[temp-1].setAttribute("aria-selected","false"),temp--;if(!isNullOrUndefined(this.mainList)){let selectItems=this.mainList.querySelectorAll("."+className),temp1=selectItems.length;if(selectItems&&selectItems.length)for(removeClass(selectItems,className);temp1>0;)selectItems[temp1-1].setAttribute("aria-selected","false"),"CheckBox"===this.mode&&(selectedItems&&selectedItems.length>temp1-1&&(selectedItems[temp1-1].firstElementChild.setAttribute("aria-checked","false"),removeClass([selectedItems[temp1-1].firstElementChild.lastElementChild],"e-check")),selectItems[temp1-1].firstElementChild.setAttribute("aria-checked","false"),removeClass([selectItems[temp1-1].firstElementChild.lastElementChild],"e-check")),temp1--}}removeHover(){let hoveredItem=this.list.querySelectorAll("."+dropDownBaseClasses.hover);hoveredItem&&hoveredItem.length&&removeClass(hoveredItem,dropDownBaseClasses.hover)}removeFocus(){if(this.list){let hoveredItem=this.list.querySelectorAll("."+dropDownBaseClasses.focus),mainlist=this.mainList.querySelectorAll("."+dropDownBaseClasses.focus);hoveredItem&&hoveredItem.length&&(removeClass(hoveredItem,dropDownBaseClasses.focus),removeClass(mainlist,dropDownBaseClasses.focus))}}addListHover(li){this.enabled&&this.isValidLI(li)?(this.removeHover(),addClass([li],dropDownBaseClasses.hover)):null!==li&&li.classList.contains("e-list-group-item")&&this.enableGroupCheckBox&&"CheckBox"===this.mode&&!isNullOrUndefined(this.fields.groupBy)&&(this.removeHover(),addClass([li],dropDownBaseClasses.hover))}addListFocus(element){this.enabled&&this.isValidLI(element)?(this.removeFocus(),addClass([element],dropDownBaseClasses.focus)):this.enableGroupCheckBox&&"CheckBox"===this.mode&&!isNullOrUndefined(this.fields.groupBy)&&addClass([element],dropDownBaseClasses.focus)}addListSelection(element){let className=this.hideSelectedItem?HIDE_LIST:dropDownBaseClasses.selected;if(this.isValidLI(element)&&!element.classList.contains(dropDownBaseClasses.hover)){if(addClass([element],className),this.updateMainList(!1,element.getAttribute("data-value")),element.setAttribute("aria-selected","true"),"CheckBox"===this.mode){let ariaCheck=element.firstElementChild.getAttribute("aria-checked");("false"===ariaCheck||isNullOrUndefined(ariaCheck))&&this.notify("updatelist",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,li:element,e:this})}this.notify("activeList",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,li:element,e:this}),null!==this.chipCollectionWrapper&&this.removeChipSelection(),attributes(this.inputElement,{"aria-activedescendant":element.id})}}updateDelimeter(delimChar){this.updateData(delimChar)}onMouseClick(e){this.scrollFocusStatus=!1;let target=e.target,li=closest(target,"."+dropDownBaseClasses.li);if(!li&&this.enableGroupCheckBox&&"CheckBox"===this.mode&&this.fields.groupBy)(target=target.classList.contains("e-list-group-item")?target.firstElementChild.lastElementChild:e.target).classList.contains("e-check")?(this.selectAllItem(!1,e),target.classList.remove("e-check"),target.classList.remove("e-stop"),target.setAttribute("aria-selected","false")):(this.selectAllItem(!0,e),target.classList.remove("e-stop"),target.classList.add("e-check"),target.setAttribute("aria-selected","true")),this.refreshSelection();else{if(this.isValidLI(li)){let limit=this.value&&this.value.length?this.value.length:0;li.classList.contains("e-active")&&(limit-=1),limit<this.maximumSelectionLength&&(this.updateListSelection(li,e),this.checkPlaceholderSize(),this.addListFocus(li),(this.allowCustomValue||this.allowFiltering)&&this.mainList&&this.listData?("CheckBox"!==this.mode&&this.focusAtLastListItem(li.getAttribute("data-value")),this.refreshSelection()):this.makeTextBoxEmpty()),"CheckBox"===this.mode?(this.updateDelimView(),this.updateDelimeter(this.delimiterChar),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar),this.checkSelectAll(),this.refreshPopup(),this.hideSelectedItem&&this.focusAtFirstListItem(),this.closePopupOnSelect?this.hidePopup():e.preventDefault(),this.makeTextBoxEmpty()}else e.preventDefault();"CheckBox"!==this.mode&&this.refreshListItems(isNullOrUndefined(li)?null:li.textContent),this.refreshPlaceHolder(),this.findGroupStart(target)}}findGroupStart(target){if(this.enableGroupCheckBox&&"CheckBox"===this.mode&&!isNullOrUndefined(this.fields.groupBy)){let groupValues,count=0,liChecked=0,liUnchecked=0;if(this.itemTemplate&&!target.getElementsByClassName("e-frame").length)for(;!target.getElementsByClassName("e-frame").length;)target=target.parentElement;for(target.classList.contains("e-frame")&&(target=target.parentElement.parentElement),groupValues=this.findGroupAttrtibutes(target,liChecked,liUnchecked,count,0),groupValues=this.findGroupAttrtibutes(target,groupValues[0],groupValues[1],groupValues[2],1);!target.classList.contains("e-list-group-item")&&(target.classList.contains("e-list-icon")&&(target=target.parentElement),null!=(target=target.previousElementSibling)););this.updateCheckBox(target,groupValues[0],groupValues[1],groupValues[2])}}findGroupAttrtibutes(listElement,checked,unChecked,count,position){for(;!listElement.classList.contains("e-list-group-item")&&(listElement.classList.contains("e-list-icon")&&(listElement=listElement.parentElement),listElement.getElementsByClassName("e-frame")[0].classList.contains("e-check")&&listElement.classList.contains("e-list-item")?checked++:listElement.classList.contains("e-list-item")&&unChecked++,count++,null!=(listElement=position?listElement.nextElementSibling:listElement.previousElementSibling)););return[checked,unChecked,count]}updateCheckBox(groupHeader,checked,unChecked,count){if(null===groupHeader)return;let checkBoxElement=groupHeader.getElementsByClassName("e-frame")[0];count===checked?(checkBoxElement.classList.remove("e-stop"),checkBoxElement.classList.add("e-check"),groupHeader.setAttribute("aria-selected","true")):count===unChecked?(checkBoxElement.classList.remove("e-check"),checkBoxElement.classList.remove("e-stop"),groupHeader.setAttribute("aria-selected","false")):(checkBoxElement.classList.remove("e-check"),checkBoxElement.classList.add("e-stop"),groupHeader.setAttribute("aria-selected","false"))}onMouseOver(e){let currentLi=closest(e.target,"."+dropDownBaseClasses.li);null===currentLi&&"CheckBox"===this.mode&&!isNullOrUndefined(this.fields.groupBy)&&this.enableGroupCheckBox&&(currentLi=closest(e.target,"."+dropDownBaseClasses.group)),this.addListHover(currentLi)}onMouseLeave(e){this.removeHover()}onListMouseDown(e){e.preventDefault(),this.scrollFocusStatus=!0}onDocumentClick(e){if("CheckBox"!==this.mode){let target=e.target;this.scrollFocusStatus=!!(!isNullOrUndefined(this.popupObj)&&closest(target,"#"+this.popupObj.element.id)||this.overAllWrapper.contains(e.target))&&(Browser.isIE||"edge"===Browser.info.name)&&document.activeElement===this.inputElement}}wireListEvents(){EventHandler.add(document,"mousedown",this.onDocumentClick,this),EventHandler.add(this.list,"mousedown",this.onListMouseDown,this),EventHandler.add(this.list,"mouseup",this.onMouseClick,this),EventHandler.add(this.list,"mouseover",this.onMouseOver,this),EventHandler.add(this.list,"mouseout",this.onMouseLeave,this)}unwireListEvents(){EventHandler.remove(document,"mousedown",this.onDocumentClick),this.list&&(EventHandler.remove(this.list,"mousedown",this.onListMouseDown),EventHandler.remove(this.list,"mouseup",this.onMouseClick),EventHandler.remove(this.list,"mouseover",this.onMouseOver),EventHandler.remove(this.list,"mouseout",this.onMouseLeave))}hideOverAllClear(){this.value&&this.value.length&&""!==this.inputElement.value||(this.overAllClear.style.display="none")}showOverAllClear(){this.overAllClear.style.display=(this.value&&this.value.length||""!==this.inputElement.value)&&this.showClearButton&&!0!==this.readonly?"":"none"}focusIn(){document.activeElement!==this.inputElement&&this.enabled&&this.inputElement.focus()}focusOut(){document.activeElement===this.inputElement&&this.enabled&&this.inputElement.blur()}showSpinner(){isNullOrUndefined(this.spinnerElement)&&("none"!==this.overAllClear.style.display?this.spinnerElement=this.overAllClear:(this.spinnerElement=this.createElement("span",{className:"e-chips-close e-close-hooker e-ms-spinner-icon"}),this.componentWrapper.appendChild(this.spinnerElement)),createSpinner({target:this.spinnerElement,width:Browser.isDevice?"16px":"14px"},this.createElement),addClass([this.spinnerElement],"e-ddl-disable-icon"),showSpinner(this.spinnerElement))}hideSpinner(){isNullOrUndefined(this.spinnerElement)||(hideSpinner(this.spinnerElement),removeClass([this.spinnerElement],"e-ddl-disable-icon"),this.spinnerElement.classList.contains("e-ms-spinner-icon")?detach(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)}updateDelimView(){if(this.delimiterWrapper&&this.hideDelimWrapper(),this.chipCollectionWrapper&&(this.chipCollectionWrapper.style.display="none"),this.viewWrapper.style.display="",this.viewWrapper.style.width="",this.viewWrapper.classList.remove("e-delim-total"),this.value&&this.value.length){let temp,tempData,wrapperleng,remaining,overAllContainer,data="",tempIndex=1,downIconWidth=0;this.viewWrapper.innerHTML="";let l10nLocale={noRecordsTemplate:"No Records Found",actionFailureTemplate:"The Request Failed",overflowCountTemplate:"+${count} more..",totalCountTemplate:"${count} selected"},l10n=new L10n(this.getLocaleName(),{},this.locale);""===l10n.getConstant("actionFailureTemplate")&&(l10n=new L10n("dropdowns",l10nLocale,this.locale));let remainContent=l10n.getConstant("overflowCountTemplate"),raminElement=this.createElement("span",{className:"e-remain"}),compiledString=compile$$1(remainContent),totalCompiledString=compile$$1(l10n.getConstant("totalCountTemplate"));raminElement.appendChild(compiledString({count:this.value.length})[0]),this.viewWrapper.appendChild(raminElement);let remainSize=raminElement.offsetWidth;if(ej2_base_es2015_remove(raminElement),this.showDropDownIcon&&(downIconWidth=this.dropIcon.offsetWidth+parseInt(window.getComputedStyle(this.dropIcon).marginRight,10)),!isNullOrUndefined(this.value))for(let index=0;!isNullOrUndefined(this.value[index]);index++){if(data+=0===index?"":this.delimiterChar+" ",data+=temp=this.getOverflowVal(index),temp=this.viewWrapper.innerHTML,this.viewWrapper.innerHTML=data,(wrapperleng=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10))+downIconWidth>(overAllContainer=this.componentWrapper.offsetWidth-parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft,10)-parseInt(window.getComputedStyle(this.componentWrapper).paddingRight,10))){for(void 0!==tempData&&""!==tempData&&(temp=tempData,index=tempIndex+1),this.viewWrapper.innerHTML=temp,remaining=this.value.length-index,wrapperleng=this.viewWrapper.offsetWidth;wrapperleng+remainSize+downIconWidth>overAllContainer&&0!==wrapperleng&&""!==this.viewWrapper.innerHTML;){let textArr=this.viewWrapper.innerHTML.split(this.delimiterChar);textArr.pop(),this.viewWrapper.innerHTML=textArr.join(this.delimiterChar),remaining++,wrapperleng=this.viewWrapper.offsetWidth}break}wrapperleng+remainSize+downIconWidth<=overAllContainer?(tempData=data,tempIndex=index):0===index&&(tempData="",tempIndex=-1)}if(remaining>0){let totalWidth=overAllContainer-downIconWidth;this.viewWrapper.appendChild(this.updateRemainTemplate(raminElement,this.viewWrapper,remaining,compiledString,totalCompiledString,totalWidth)),this.updateRemainWidth(this.viewWrapper,totalWidth),this.updateRemainingText(raminElement,downIconWidth,remaining,compiledString,totalCompiledString)}}else this.viewWrapper.innerHTML="",this.viewWrapper.style.display="none"}updateRemainWidth(viewWrapper,totalWidth){viewWrapper.classList.contains("e-delim-total")&&totalWidth<viewWrapper.offsetWidth+parseInt(window.getComputedStyle(viewWrapper).paddingLeft,10)+parseInt(window.getComputedStyle(viewWrapper).paddingLeft,10)&&(viewWrapper.style.width=totalWidth+"px")}updateRemainTemplate(raminElement,viewWrapper,remaining,compiledString,totalCompiledString,totalWidth){return viewWrapper.firstChild&&3===viewWrapper.firstChild.nodeType&&""===viewWrapper.firstChild.nodeValue&&viewWrapper.removeChild(viewWrapper.firstChild),raminElement.innerHTML="",raminElement.appendChild(viewWrapper.firstChild&&3===viewWrapper.firstChild.nodeType?compiledString({count:remaining})[0]:totalCompiledString({count:remaining})[0]),viewWrapper.firstChild&&3===viewWrapper.firstChild.nodeType?viewWrapper.classList.remove("e-delim-total"):(viewWrapper.classList.add("e-delim-total"),this.updateRemainWidth(viewWrapper,totalWidth)),raminElement}updateRemainingText(raminElement,downIconWidth,remaining,compiledString,totalCompiledString){let overAllContainer=this.componentWrapper.offsetWidth-parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft,10)-parseInt(window.getComputedStyle(this.componentWrapper).paddingRight,10),wrapperleng=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10);if(wrapperleng+downIconWidth>=overAllContainer&&0!==wrapperleng&&this.viewWrapper.firstChild&&3===this.viewWrapper.firstChild.nodeType){for(;wrapperleng+downIconWidth>overAllContainer&&0!==wrapperleng&&this.viewWrapper.firstChild&&3===this.viewWrapper.firstChild.nodeType;){let textArr=this.viewWrapper.firstChild.nodeValue.split(this.delimiterChar);textArr.pop(),this.viewWrapper.firstChild.nodeValue=textArr.join(this.delimiterChar),""===this.viewWrapper.firstChild.nodeValue&&this.viewWrapper.removeChild(this.viewWrapper.firstChild),remaining++,wrapperleng=this.viewWrapper.offsetWidth}this.updateRemainTemplate(raminElement,this.viewWrapper,remaining,compiledString,totalCompiledString,overAllContainer-downIconWidth)}}getOverflowVal(index){let temp;if(this.mainData&&this.mainData.length)if("CheckBox"===this.mode){let newTemp=this.listData;this.listData=this.mainData,temp=this.getTextByValue(this.value[index]),this.listData=newTemp}else temp=this.getTextByValue(this.value[index]);else temp=this.value[index];return temp}unWireEvent(){EventHandler.remove(this.componentWrapper,"mousedown",this.wrapperClick),EventHandler.remove(window,"resize",this.windowResize),EventHandler.remove(this.inputElement,"focus",this.focusInHandler),EventHandler.remove(this.inputElement,"keydown",this.onKeyDown),"CheckBox"!==this.mode&&EventHandler.remove(this.inputElement,"input",this.onInput),EventHandler.remove(this.inputElement,"keyup",this.KeyUp);let formElement=closest(this.inputElement,"form");formElement&&EventHandler.remove(formElement,"reset",this.resetValueHandler),EventHandler.remove(this.inputElement,"blur",this.onBlur),EventHandler.remove(this.componentWrapper,"mousemove",this.mouseIn),EventHandler.remove(this.componentWrapper,"mouseout",this.mouseOut),EventHandler.remove(this.overAllClear,"mousedown",this.ClearAll)}selectAllItem(state,event,list){let li;if(li=this.list.querySelectorAll(state?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide)'),this.enableGroupCheckBox&&"CheckBox"===this.mode&&!isNullOrUndefined(this.fields.groupBy)){let target=event.target;if((target=(target=32===event.keyCode?list:target).classList.contains("e-frame")?target.parentElement.parentElement:target).classList.contains("e-list-group-item")){let listElement=target.nextElementSibling;if(isNullOrUndefined(listElement))return;for(;listElement.classList.contains("e-list-item")&&(state?listElement.firstElementChild.lastElementChild.classList.contains("e-check")||this.updateListSelection(listElement,event):listElement.firstElementChild.lastElementChild.classList.contains("e-check")&&this.updateListSelection(listElement,event),null!=(listElement=listElement.nextElementSibling)););if(target.classList.contains("e-list-group-item")){let focusedElement=this.list.getElementsByClassName("e-item-focus")[0];focusedElement&&focusedElement.classList.remove("e-item-focus"),state?target.classList.add("e-active"):target.classList.remove("e-active"),target.classList.add("e-item-focus")}this.textboxValueUpdate(),this.checkPlaceholderSize()}else(target.classList.contains("e-selectall-parent")||target.parentElement.classList.contains("e-selectall-parent"))&&this.updateValue(event,li)}else this.updateValue(event,li)}updateValue(event,li){let length=li.length;if(li&&li.length){let index=0;for(;index<length&&index<=50;)this.updateListSelection(li[index],event,length-index),this.findGroupStart(li[index]),index++;length>50&&setTimeout(()=>{for(;index<length;)this.updateListSelection(li[index],event,length-index),this.findGroupStart(li[index]),index++;this.textboxValueUpdate()},0)}this.textboxValueUpdate(),this.checkPlaceholderSize()}textboxValueUpdate(){"Box"===this.mode||this.isPopupOpen()?this.searchWrapper.classList.remove("e-zero-size"):this.updateDelimView(),"CheckBox"===this.mode?(this.updateDelimView(),this.updateDelimeter(this.delimiterChar),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar),this.refreshPlaceHolder()}setZIndex(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})}updateDataSource(prop){isNullOrUndefined(this.list)?this.renderPopup():this.resetList(this.dataSource),this.value&&this.value.length&&(this.setProperties({value:this.value}),this.refreshSelection())}onLoadSelect(){this.setDynValue=!0,this.renderPopup()}selectAllItems(state,event){isNullOrUndefined(this.list)?(this.selectAllAction=()=>{"CheckBox"===this.mode&&this.showSelectAll&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,value:state?"check":"uncheck"}),this.selectAllItem(state,event),this.selectAllAction=null},super.render()):(this.selectAllAction=null,"CheckBox"===this.mode&&this.showSelectAll&&this.notify("checkSelectAll",{value:state?"check":"uncheck",enable:"CheckBox"===this.mode,module:"CheckBoxSelection"}),this.selectAllItem(state,event))}getPersistData(){return this.addOnPersist(["value"])}onPropertyChanged(newProp,oldProp){newProp.dataSource&&!isNullOrUndefined(Object.keys(newProp.dataSource))&&(this.mainList=null,this.mainData=null,this.isFirstClick=!1),"multiselect"===this.getModuleName()&&this.setUpdateInitial(["fields","query","dataSource"],newProp);for(let prop of Object.keys(newProp))switch(prop){case"query":case"dataSource":"CheckBox"===this.mode&&this.showSelectAll&&(isNullOrUndefined(this.popupObj)||(this.popupObj.destroy(),this.popupObj=null),this.renderPopup());break;case"htmlAttributes":this.updateHTMLAttribute();break;case"showClearButton":this.updateClearButton(newProp.showClearButton);break;case"text":this.updateVal(this.value,this.value,"text");break;case"value":this.updateVal(this.value,oldProp.value,"value");break;case"width":setStyleAttribute(this.overAllWrapper,{width:formatUnit(newProp.width)}),this.popupObj.setProperties({width:this.calcPopupWidth()});break;case"placeholder":this.refreshPlaceHolder();break;case"filterBarPlaceholder":this.allowFiltering&&this.notify("filterBarPlaceholder",{filterBarPlaceholder:newProp.filterBarPlaceholder});break;case"delimiterChar":"Box"!==this.mode&&this.updateDelimView(),this.updateData(newProp.delimiterChar);break;case"cssClass":this.popupWrapper.classList.remove(oldProp.cssClass),this.overAllWrapper.classList.remove(oldProp.cssClass),this.updateCssClass();break;case"enableRtl":this.enableRTL(newProp.enableRtl),super.onPropertyChanged(newProp,oldProp);break;case"readonly":this.updateReadonly(newProp.readonly),this.hidePopup();break;case"enabled":this.hidePopup(),this.enable(newProp.enabled);break;case"showSelectAll":this.popupObj&&(this.popupObj.destroy(),this.popupObj=null),this.renderPopup();break;case"showDropDownIcon":this.dropDownIcon();break;case"floatLabelType":this.setFloatLabelType();break;case"enableSelectionOrder":break;case"selectAllText":this.notify("selectAllText",!1);break;case"popupHeight":case"headerTemplate":case"footerTemplate":this.reInitializePoup();break;case"allowFiltering":"CheckBox"===this.mode&&this.popupObj&&this.reInitializePoup();break;default:let msProps;msProps=this.getPropObject(prop,newProp,oldProp),super.onPropertyChanged(msProps.newProperty,msProps.oldProperty)}}reInitializePoup(){this.popupObj&&(this.popupObj.destroy(),this.popupObj=null),this.renderPopup()}updateVal(newProp,oldProp,prop){this.list?this.inputFocus||("text"===prop&&(this.initialTextUpdate(),newProp=this.value),this.initialValueUpdate(),"Box"!==this.mode&&this.updateDelimView(),this.refreshInputHight(),this.refreshPlaceHolder(),this.updateValueState(null,newProp,oldProp),this.checkPlaceholderSize()):this.onLoadSelect()}hidePopup(){this.isPopupOpen()&&this.trigger("close",{popup:this.popupObj,cancel:!1,animation:{name:"FadeOut",duration:100,delay:100}},eventArgs=>{eventArgs.cancel||(this.beforePopupOpen=!1,this.overAllWrapper.classList.remove("e-icon-anim"),this.popupObj.hide(new ej2_base_es2015_Animation(eventArgs.animation)),attributes(this.inputElement,{"aria-expanded":"false"}),this.allowFiltering&&this.notify("inputFocus",{module:"CheckBoxSelection",enable:"CheckBox"===this.mode,value:"clear"}),this.popupObj.hide(),removeClass([document.body,this.popupObj.element],"e-popup-full-page"),EventHandler.remove(this.list,"keydown",this.onKeyDown))})}showPopup(){if(!this.enabled)return;if(!this.ulElement)return this.beforePopupOpen=!0,void super.render();let mainLiLength=this.ulElement.querySelectorAll("li.e-list-item").length,liLength=this.ulElement.querySelectorAll("li."+dropDownBaseClasses.li+"."+HIDE_LIST).length;mainLiLength>0&&mainLiLength===liLength&&liLength===this.mainData.length?this.beforePopupOpen=!1:this.onPopupShown()}selectAll(state){this.selectAllItems(state)}getModuleName(){return"multiselect"}render(){this.setDynValue=this.initStatus=!1,this.searchWrapper=this.createElement("span",{className:"e-searcher "+("Box"===this.mode?"e-multiselect-box":"")}),this.viewWrapper=this.createElement("span",{className:"e-delim-view e-delim-values",styles:"display:none;"}),this.overAllClear=this.createElement("span",{className:"e-chips-close e-close-hooker",styles:"display:none;"}),this.componentWrapper=this.createElement("div",{className:"e-multi-select-wrapper"}),this.overAllWrapper=this.createElement("div",{className:"e-multiselect e-input-group"}),"CheckBox"===this.mode&&addClass([this.overAllWrapper],"e-checkbox"),Browser.isDevice&&this.componentWrapper.classList.add("e-mob-wrapper"),this.overAllWrapper.style.width=formatUnit(this.width),this.overAllWrapper.appendChild(this.componentWrapper),this.popupWrapper=this.createElement("div",{id:this.element.id+"_popup",className:"e-ddl e-popup e-multi-select-list-wrapper"}),"Delimiter"===this.mode||"CheckBox"===this.mode?(this.delimiterWrapper=this.createElement("span",{className:"e-delim-values",styles:"display:none"}),this.componentWrapper.appendChild(this.delimiterWrapper)):(this.chipCollectionWrapper=this.createElement("span",{className:"e-chips-collection",styles:"display:none"}),this.componentWrapper.appendChild(this.chipCollectionWrapper)),"Box"!==this.mode&&this.componentWrapper.appendChild(this.viewWrapper),this.componentWrapper.appendChild(this.searchWrapper),this.showClearButton&&!Browser.isDevice?this.componentWrapper.appendChild(this.overAllClear):this.componentWrapper.classList.add("e-close-icon-hide"),this.dropDownIcon(),this.inputElement=this.createElement("input",{className:"e-dropdownbase",attrs:{spellcheck:"false",type:"text",autocomplete:"off",tabindex:"0"}}),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.tagName===this.getNgDirective()?(this.element.appendChild(this.overAllWrapper),this.searchWrapper.appendChild(this.inputElement)):(this.element.parentElement.insertBefore(this.overAllWrapper,this.element),this.searchWrapper.appendChild(this.inputElement),this.searchWrapper.appendChild(this.element),this.element.removeAttribute("tabindex")),"Never"!==this.floatLabelType?createFloatLabel(this.overAllWrapper,this.searchWrapper,this.element,this.inputElement,this.value,this.floatLabelType,this.placeholder):"Never"===this.floatLabelType&&this.refreshPlaceHolder(),this.element.style.opacity="";let id=this.element.getAttribute("id")?this.element.getAttribute("id"):getUniqueID("ej2_dropdownlist");this.element.id=id,this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",class:"e-multi-hidden",tabindex:"-1",multiple:""}}),this.componentWrapper.appendChild(this.hiddenElement),this.validationAttribute(this.element,this.hiddenElement),"CheckBox"!==this.mode&&this.hideOverAllClear(),this.wireEvent(),this.enable(this.enabled),this.enableRTL(this.enableRtl),this.checkInitialValue(),this.renderComplete()}checkInitialValue(){let isData=this.dataSource instanceof Array?this.dataSource.length>0:!isNullOrUndefined(this.dataSource);if((!this.value||!this.value.length)&&isNullOrUndefined(this.text)&&!isData&&"SELECT"===this.element.tagName&&this.element.options.length>0){let optionsElement=this.element.options,valueCol=[],textCol="";for(let index=0,optionsLen=optionsElement.length;index<optionsLen;index++){let opt=optionsElement[index];isNullOrUndefined(opt.getAttribute("selected"))||(opt.getAttribute("value")?valueCol.push(opt.getAttribute("value")):textCol+=opt.text+this.delimiterChar)}valueCol.length>0?this.setProperties({value:valueCol},!0):""!==textCol&&this.setProperties({text:textCol},!0),(valueCol.length>0||""!==textCol)&&(this.refreshInputHight(),this.refreshPlaceHolder())}(this.value&&this.value.length||!isNullOrUndefined(this.text))&&this.renderPopup(),isNullOrUndefined(this.text)||!isNullOrUndefined(this.value)&&0!==this.value.length||this.initialTextUpdate(),this.value&&this.value.length?this.dataSource instanceof ej2_data_es2015_DataManager?this.setInitialValue=()=>{this.initStatus=!1,this.initialValueUpdate(),this.initialUpdate(),this.setInitialValue=null,this.initStatus=!0}:(this.initialValueUpdate(),this.initialUpdate()):this.initialUpdate(),this.initStatus=!0,this.checkAutoFocus(),isNullOrUndefined(this.text)||this.element.setAttribute("data-initial-value",this.text)}checkAutoFocus(){this.element.hasAttribute("autofocus")&&this.inputElement.focus()}setFloatLabelType(){!function(overAllWrapper,componentWrapper,searchWrapper,inputElement,value,floatLabelType,placeholder){let placeholderText,placeholderElement=componentWrapper.querySelector("."+FLOATTEXT),floatLine=componentWrapper.querySelector("."+FLOATLINE);isNullOrUndefined(placeholderElement)?setPlaceHolder(value,inputElement,placeholderText=null!==placeholder?placeholder:""):(placeholderText=placeholderElement.innerText,detach(searchWrapper.querySelector("."+FLOATTEXT)),setPlaceHolder(value,inputElement,placeholderText),isNullOrUndefined(floatLine)||detach(searchWrapper.querySelector("."+FLOATLINE))),overAllWrapper.classList.remove("e-float-input")}(this.overAllWrapper,this.componentWrapper,this.searchWrapper,this.inputElement,this.value,0,this.placeholder),"Never"!==this.floatLabelType&&createFloatLabel(this.overAllWrapper,this.searchWrapper,this.element,this.inputElement,this.value,this.floatLabelType,this.placeholder)}dropDownIcon(){this.showDropDownIcon?(this.dropIcon=this.createElement("span",{className:"e-input-group-icon e-ddl-icon"}),this.componentWrapper.appendChild(this.dropIcon),addClass([this.componentWrapper],["e-down-icon"])):isNullOrUndefined(this.dropIcon)||(this.dropIcon.parentElement.removeChild(this.dropIcon),removeClass([this.componentWrapper],["e-down-icon"]))}initialUpdate(){"Box"!==this.mode&&this.updateDelimView(),this.updateCssClass(),this.updateHTMLAttribute(),this.updateReadonly(this.readonly),this.refreshInputHight(),this.checkPlaceholderSize()}destroy(){this.popupObj&&this.popupObj.hide(),this.notify("destroy",{}),this.unwireListEvents(),this.unWireEvent(),this.list=null,this.popupObj=null,this.mainList=null,this.mainData=null,super.destroy();let temp=["readonly","aria-disabled","aria-placeholder","placeholder"],length=temp.length;for(;length>0;)this.inputElement.removeAttribute(temp[length-1]),length--;this.element.removeAttribute("data-initial-value"),this.element.style.display="block",this.overAllWrapper.parentElement&&(this.overAllWrapper.parentElement.tagName===this.getNgDirective()?ej2_base_es2015_remove(this.overAllWrapper):(this.overAllWrapper.parentElement.insertBefore(this.element,this.overAllWrapper),ej2_base_es2015_remove(this.overAllWrapper)))}};return __decorate([Property(!1)],MultiSelect.prototype,"enableGroupCheckBox",void 0),__decorate([Property(null)],MultiSelect.prototype,"cssClass",void 0),__decorate([Property("100%")],MultiSelect.prototype,"width",void 0),__decorate([Property("300px")],MultiSelect.prototype,"popupHeight",void 0),__decorate([Property("100%")],MultiSelect.prototype,"popupWidth",void 0),__decorate([Property(null)],MultiSelect.prototype,"placeholder",void 0),__decorate([Property(null)],MultiSelect.prototype,"filterBarPlaceholder",void 0),__decorate([Property({})],MultiSelect.prototype,"htmlAttributes",void 0),__decorate([Property(null)],MultiSelect.prototype,"valueTemplate",void 0),__decorate([Property(null)],MultiSelect.prototype,"headerTemplate",void 0),__decorate([Property(null)],MultiSelect.prototype,"footerTemplate",void 0),__decorate([Property(null)],MultiSelect.prototype,"itemTemplate",void 0),__decorate([Property(null)],MultiSelect.prototype,"allowFiltering",void 0),__decorate([Property(!1)],MultiSelect.prototype,"allowCustomValue",void 0),__decorate([Property(!0)],MultiSelect.prototype,"showClearButton",void 0),__decorate([Property(1e3)],MultiSelect.prototype,"maximumSelectionLength",void 0),__decorate([Property(!1)],MultiSelect.prototype,"readonly",void 0),__decorate([Property(null)],MultiSelect.prototype,"text",void 0),__decorate([Property(null)],MultiSelect.prototype,"value",void 0),__decorate([Property(!0)],MultiSelect.prototype,"hideSelectedItem",void 0),__decorate([Property(!0)],MultiSelect.prototype,"closePopupOnSelect",void 0),__decorate([Property("Default")],MultiSelect.prototype,"mode",void 0),__decorate([Property(",")],MultiSelect.prototype,"delimiterChar",void 0),__decorate([Property(!0)],MultiSelect.prototype,"ignoreCase",void 0),__decorate([Property(!1)],MultiSelect.prototype,"showDropDownIcon",void 0),__decorate([Property("Never")],MultiSelect.prototype,"floatLabelType",void 0),__decorate([Property(!1)],MultiSelect.prototype,"showSelectAll",void 0),__decorate([Property("Select All")],MultiSelect.prototype,"selectAllText",void 0),__decorate([Property("Unselect All")],MultiSelect.prototype,"unSelectAllText",void 0),__decorate([Property(!0)],MultiSelect.prototype,"enableSelectionOrder",void 0),__decorate([Property(!0)],MultiSelect.prototype,"openOnClick",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"removing",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"removed",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"selectedAll",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"beforeOpen",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"close",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"blur",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"focus",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"chipSelection",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"filtering",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"tagging",void 0),__decorate([ej2_base_es2015_Event()],MultiSelect.prototype,"customValueSelection",void 0),__decorate([NotifyPropertyChanges],MultiSelect)})();const ej2_dropdowns_es2015_ICON="e-icons",CHECKBOXFRAME="e-frame",ej2_dropdowns_es2015_CHECK="e-check",CHECKBOXWRAP="e-checkbox-wrapper",ej2_dropdowns_es2015_INDETERMINATE="e-stop",checkAllParent="e-selectall-parent",searchBackIcon="e-input-group-icon e-back-icon e-icons",filterBarClearIcon="e-input-group-icon e-clear-icon e-icons",ej2_dropdowns_es2015_filterInput="e-input-filter",filterParent="e-filter-parent",mobileFilter="e-ddl-device-filter",ej2_dropdowns_es2015_clearIcon="e-clear-icon",popupFullScreen="e-popup-full-page",device="e-ddl-device",FOCUS$1="e-input-focus";class ej2_dropdowns_es2015_CheckBoxSelection{constructor(parent){this.activeLi=[],this.activeEle=[],this.parent=parent,this.addEventListener()}getModuleName(){return"CheckBoxSelection"}addEventListener(){this.parent.isDestroyed||(this.parent.on("updatelist",this.listSelection,this),this.parent.on("listoption",this.listOption,this),this.parent.on("selectAll",this.setSelectAll,this),this.parent.on("checkSelectAll",this.checkSelectAll,this),this.parent.on("searchBox",this.setSearchBox,this),this.parent.on("blur",this.onBlur,this),this.parent.on("targetElement",this.targetElement,this),this.parent.on("deviceSearchBox",this.setDeviceSearchBox,this),this.parent.on("inputFocus",this.getFocus,this),this.parent.on("reOrder",this.setReorder,this),this.parent.on("activeList",this.getActiveList,this),this.parent.on("selectAllText",this.setLocale,this),this.parent.on("filterBarPlaceholder",this.setPlaceholder,this),EventHandler.add(document,"mousedown",this.onDocumentClick,this),this.parent.on("addItem",this.checboxCreate,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off("updatelist",this.listSelection),this.parent.off("listoption",this.listOption),this.parent.off("selectAll",this.setSelectAll),this.parent.off("checkSelectAll",this.checkSelectAll),this.parent.off("searchBox",this.setSearchBox),this.parent.off("blur",this.onBlur),this.parent.off("targetElement",this.targetElement),this.parent.off("deviceSearchBox",this.setDeviceSearchBox),this.parent.off("inputFocus",this.getFocus),this.parent.off("reOrder",this.setReorder),this.parent.off("activeList",this.getActiveList),this.parent.off("selectAllText",this.setLocale),this.parent.off("filterBarPlaceholder",this.setPlaceholder),this.parent.off("addItem",this.checboxCreate),EventHandler.remove(document,"mousedown",this.onDocumentClick))}listOption(args){if(isNullOrUndefined(this.parent.listCurrentOptions.itemCreated))this.parent.listCurrentOptions.itemCreated=e=>{this.checboxCreate(e)};else{let itemCreated=this.parent.listCurrentOptions.itemCreated;this.parent.listCurrentOptions.itemCreated=e=>{this.checboxCreate(e),itemCreated.apply(this,[e])}}}setPlaceholder(props){ej2_inputs_es2015_Input.setPlaceholder(props.filterBarPlaceholder,this.filterInput)}checboxCreate(e){let item;if(item=isNullOrUndefined(e.item)?e:e.item,this.parent.enableGroupCheckBox||"e-list-group-item "!==item.className&&"e-list-group-item"!==item.className){let checkboxEle=createCheckBox(this.parent.createElement,!0),icon=ej2_base_es2015_select("div."+ej2_dropdowns_es2015_ICON,item);return item.getAttribute("data-uid"),item.insertBefore(checkboxEle,item.childNodes[isNullOrUndefined(icon)?0:1]),ej2_base_es2015_select("."+CHECKBOXFRAME,checkboxEle),ej2_base_es2015_select("."+CHECKBOXFRAME,checkboxEle),this.parent.enableGroupCheckBox&&this.parent.popupWrapper.classList.add("e-multiselect-group"),item}return item}setSelectAll(){this.parent.showSelectAll?(isNullOrUndefined(this.checkAllParent)&&(this.checkAllParent=this.parent.createElement("div",{className:checkAllParent}),this.selectAllSpan=this.parent.createElement("span",{className:"e-all-text"}),this.selectAllSpan.textContent="",this.checkAllParent.appendChild(this.selectAllSpan),this.setLocale(),this.checboxCreate(this.checkAllParent),this.parent.headerTemplate&&(isNullOrUndefined(this.parent.filterParent)?append([this.checkAllParent],this.parent.popupWrapper):append([this.checkAllParent],this.parent.filterParent)),this.parent.headerTemplate||(isNullOrUndefined(this.parent.filterParent)?prepend([this.checkAllParent],this.parent.popupWrapper):this.parent.filterParent.parentNode.insertBefore(this.checkAllParent,this.parent.filterParent.nextSibling)),EventHandler.add(this.checkAllParent,"mousedown",this.clickHandler,this)),this.checkAllParent.style.display=this.parent.list.classList.contains("e-nodata")||this.parent.listData&&this.parent.listData.length<=1?"none":"block",this.parent.selectAllHeight=this.checkAllParent.getBoundingClientRect().height):isNullOrUndefined(this.checkAllParent)||(this.checkAllParent.parentElement.removeChild(this.checkAllParent),this.checkAllParent=null)}destroy(){this.removeEventListener()}listSelection(args){let target;if(target=isNullOrUndefined(args.e)?args.li.lastElementChild.childNodes[1]:isNullOrUndefined(args.e.target)?args.li.querySelector(".e-checkbox-wrapper").childNodes[1]:args.e.target.classList.contains("e-frame")&&(!this.parent.showSelectAll||this.checkAllParent&&!this.checkAllParent.contains(args.e.target))?args.e.target:args.li.querySelector(".e-checkbox-wrapper").childNodes[1],(this.parent.itemTemplate||this.parent.enableGroupCheckBox)&&(target=args.li.firstElementChild.childNodes[1]),isNullOrUndefined(target)||(this.checkWrapper=closest(target,"."+CHECKBOXWRAP)),!isNullOrUndefined(this.checkWrapper)){let checkElement=ej2_base_es2015_select("."+CHECKBOXFRAME,this.checkWrapper),selectAll=!1;this.validateCheckNode(this.checkWrapper,checkElement.classList.contains(ej2_dropdowns_es2015_CHECK),args.li,args.e,selectAll)}}validateCheckNode(checkWrap,isCheck,li,e,selectAll){this.changeState(checkWrap,isCheck?"uncheck":"check",e,!0,selectAll)}clickHandler(e){let target;if(target=e.currentTarget.classList.contains(this.checkAllParent.className)?e.currentTarget.firstElementChild.lastElementChild:e.currentTarget,this.checkWrapper=closest(target,"."+CHECKBOXWRAP),!isNullOrUndefined(this.checkWrapper)){let checkElement=ej2_base_es2015_select("."+CHECKBOXFRAME,this.checkWrapper);this.validateCheckNode(this.checkWrapper,checkElement.classList.contains(ej2_dropdowns_es2015_CHECK),null,e,!0)}e.preventDefault()}changeState(wrapper,state,e,isPrevent,selectAll){let ariaState,frameSpan=wrapper.getElementsByClassName(CHECKBOXFRAME)[0];"check"!==state||frameSpan.classList.contains(ej2_dropdowns_es2015_CHECK)?"uncheck"===state&&(frameSpan.classList.contains(ej2_dropdowns_es2015_CHECK)||frameSpan.classList.contains(ej2_dropdowns_es2015_INDETERMINATE))&&(removeClass([frameSpan],[ej2_dropdowns_es2015_CHECK,ej2_dropdowns_es2015_INDETERMINATE]),ariaState="false",selectAll&&(this.parent.selectAllItems(!1,e),this.setLocale())):(frameSpan.classList.remove(ej2_dropdowns_es2015_INDETERMINATE),frameSpan.classList.add(ej2_dropdowns_es2015_CHECK),ariaState="true",selectAll&&(this.parent.selectAllItems(!0,e),this.setLocale(!0))),isNullOrUndefined(ariaState="check"===state?"true":"uncheck"===state?"false":ariaState)||wrapper.setAttribute("aria-checked",ariaState)}setSearchBox(args){if(isNullOrUndefined(this.parent.filterParent)){this.parent.filterParent=this.parent.createElement("span",{className:filterParent}),this.filterInput=this.parent.createElement("input",{attrs:{type:"text"},className:ej2_dropdowns_es2015_filterInput}),this.parent.element.parentNode.insertBefore(this.filterInput,this.parent.element);let backIcon=!1;return Browser.isDevice&&(backIcon=!0,this.parent.mobFilter=!1),this.filterInputObj=ej2_inputs_es2015_Input.createInput({element:this.filterInput,buttons:backIcon?[searchBackIcon,filterBarClearIcon]:[filterBarClearIcon],properties:{placeholder:this.parent.filterBarPlaceholder}},this.parent.createElement),append([this.filterInputObj.container],this.parent.filterParent),prepend([this.parent.filterParent],args.popupElement),attributes(this.filterInput,{"aria-disabled":"false","aria-owns":this.parent.element.id+"_options",role:"listbox","aria-activedescendant":null,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+ej2_dropdowns_es2015_clearIcon),!Browser.isDevice&&this.clearIconElement&&(EventHandler.add(this.clearIconElement,"mousedown",this.clearText,this),this.clearIconElement.style.visibility="hidden"),EventHandler.add(this.filterInput,"input",this.parent.onInput,this.parent),EventHandler.add(this.filterInput,"keyup",this.parent.KeyUp,this.parent),EventHandler.add(this.filterInput,"keydown",this.parent.onKeyDown,this.parent),EventHandler.add(this.filterInput,"blur",this.onBlur,this),this.parent.searchBoxHeight=this.filterInputObj.container.parentElement.getBoundingClientRect().height,this.filterInputObj}}clickOnBackIcon(e){this.parent.hidePopup(),removeClass([document.body,this.parent.popupObj.element],popupFullScreen),this.parent.inputElement.focus()}clearText(e){this.parent.targetInputElement.value="",this.parent.refreshPopup(),this.parent.refreshListItems(null),this.clearIconElement.style.visibility="hidden",this.filterInput.focus(),this.setReorder(e),e.preventDefault()}setDeviceSearchBox(){this.parent.popupObj.element.classList.add(device),this.parent.popupObj.element.classList.add(mobileFilter),this.parent.popupObj.position={X:0,Y:0},this.parent.popupObj.dataBind(),attributes(this.parent.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),addClass([document.body,this.parent.popupObj.element],popupFullScreen),this.setSearchBoxPosition(),this.backIconElement=this.filterInputObj.container.querySelector(".e-back-icon"),this.clearIconElement=this.filterInputObj.container.querySelector("."+ej2_dropdowns_es2015_clearIcon),this.clearIconElement.style.visibility="hidden",EventHandler.add(this.backIconElement,"click",this.clickOnBackIcon,this),EventHandler.add(this.clearIconElement,"click",this.clearText,this)}setSearchBoxPosition(){let searchBoxHeight=this.filterInput.parentElement.getBoundingClientRect().height;this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%",this.parent.list.style.maxHeight=window.innerHeight-searchBoxHeight+"px",this.parent.list.style.height=window.innerHeight-searchBoxHeight+"px";let clearElement=this.filterInput.parentElement.querySelector("."+ej2_dropdowns_es2015_clearIcon);detach(this.filterInput),clearElement.parentElement.insertBefore(this.filterInput,clearElement)}targetElement(){return this.parent.targetInputElement=this.filterInput,this.clearIconElement.style.visibility=""===this.parent.targetInputElement.value?"hidden":"visible",this.parent.targetInputElement.value}onBlur(e){if(!this.parent.element.classList.contains("e-listbox")){let target;if(this.parent.keyAction)return;if(Browser.isIE&&(target=!isNullOrUndefined(e)&&e.target),Browser.isIE||(target=!isNullOrUndefined(e)&&e.relatedTarget),document.body.contains(this.parent.popupObj.element)&&this.parent.popupObj.element.contains(target)&&!Browser.isIE&&this.filterInput)return void this.filterInput.focus();if(this.parent.scrollFocusStatus&&this.filterInput)return e.preventDefault(),this.filterInput.focus(),void(this.parent.scrollFocusStatus=!1);document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.updateValueState(e,this.parent.value,this.parent.tempValues),this.parent.dispatchEvent(this.parent.hiddenElement,"change")),document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.overAllWrapper.classList.remove(FOCUS$1),this.parent.trigger("blur"),this.parent.focused=!0),!document.body.contains(this.parent.popupObj.element)||this.parent.popupObj.element.classList.contains("e-popup-close")||Browser.isDevice||this.parent.hidePopup()}}onDocumentClick(e){if(!this.parent.element.classList.contains("e-listbox")){let target=e.target;!isNullOrUndefined(this.parent.popupObj)&&closest(target,"#"+this.parent.popupObj.element.id)&&e.preventDefault(),!isNullOrUndefined(this.parent.popupObj)&&closest(target,"#"+this.parent.popupObj.element.id)||this.parent.overAllWrapper.contains(e.target)?this.parent.scrollFocusStatus=(Browser.isIE||"edge"===Browser.info.name)&&document.activeElement===this.filterInput:(this.parent.overAllWrapper.classList.contains(dropDownBaseClasses.focus)||this.parent.isPopupOpen())&&(this.parent.inputFocus=!1,this.parent.scrollFocusStatus=!1,this.parent.hidePopup(),this.parent.onBlur(),this.parent.focused=!0),this.parent.overAllWrapper.contains(e.target)||!this.parent.overAllWrapper.classList.contains("e-input-focus")||this.parent.isPopupOpen()||(Browser.isIE?this.parent.onBlur():this.parent.onBlur(e)),this.filterInput===target&&this.filterInput.focus()}}getFocus(e){this.parent.overAllWrapper.classList.remove(FOCUS$1),this.parent.keyAction&&"clear"!==e.value?this.parent.keyAction=!1:("focus"===e.value&&(this.filterInput.focus(),this.parent.removeFocus(),EventHandler.remove(this.parent.list,"keydown",this.parent.onKeyDown)),"clear"===e.value&&(this.filterInput.value="",this.clearIconElement.style.visibility="hidden"))}checkSelectAll(e){"check"===e.value&&"true"!==this.checkAllParent.getAttribute("aria-checked")&&(this.changeState(this.checkAllParent,e.value,null,null,!1),this.setLocale(!0)),"uncheck"===e.value&&(this.changeState(this.checkAllParent,e.value,null,null,!1),this.setLocale())}setLocale(unSelect){if("Select All"!==this.parent.selectAllText||"Unselect All"!==this.parent.unSelectAllText){let compiledString,template=unSelect?this.parent.unSelectAllText:this.parent.selectAllText;this.selectAllSpan.textContent="",compiledString=compile$$1(template);for(let item of compiledString({}))this.selectAllSpan.textContent=item.textContent}else{let l10nLocale={selectAllText:"Select All",unSelectAllText:"Unselect All"},l10n=new L10n(this.parent.getLocaleName(),{},this.parent.locale);""===l10n.getConstant("selectAllText")&&(l10n=new L10n("dropdowns",l10nLocale,this.parent.locale)),this.selectAllSpan.textContent=l10n.getConstant(unSelect?"unSelectAllText":"selectAllText")}}getActiveList(args){args.li.classList.contains("e-active")?this.activeLi.push(args.li.cloneNode(!0)):this.activeLi.splice(args.index,1)}setReorder(args){if(this.parent.enableSelectionOrder&&!isNullOrUndefined(this.parent.value)){let remLi,activeLiCount=this.parent.ulElement.querySelectorAll("li.e-active").length,ulEle=this.parent.createElement("ul",{className:"e-list-parent e-ul e-reorder"});this.parent.createElement("div"),activeLiCount>0&&(append(this.parent.ulElement.querySelectorAll("li.e-active"),ulEle),addClass(remLi=this.parent.ulElement.querySelectorAll("li.e-active"),"e-reorder-hide"),prepend([ulEle],this.parent.list)),this.parent.focusAtFirstListItem()}}}const OTHERMONTH="e-other-month",OVERLAY="e-overlay",SELECTED="e-selected",FOCUSEDDATE="e-focused-date";let ej2_calendars_es2015_CalendarBase=(()=>{let CalendarBase=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.effect="",this.isPopupClicked=!1,this.isDateSelected=!0,this.defaultKeyConfigs={controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",altUpArrow:"alt+uparrow",spacebar:"space",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"}}render(){this.rangeValidation(this.min,this.max),this.calendarEleCopy=this.element.cloneNode(!0),"Islamic"===this.calendarMode&&(+this.min.setSeconds(0)==+new Date(1900,0,1,0,0,0)&&(this.min=new Date(1944,2,18)),+this.max==+new Date(2099,11,31)&&(this.max=new Date(2069,10,16))),this.globalize=new Internationalization(this.locale),(isNullOrUndefined(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.todayDisabled=!1,this.todayDate=new Date((new Date).setHours(0,0,0,0)),"calendar"===this.getModuleName()?(this.element.classList.add("e-calendar"),this.enableRtl&&this.element.classList.add("e-rtl"),Browser.isDevice&&this.element.classList.add("e-device"),attributes(this.element,{"data-role":"calendar"}),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.setAttribute("tabindex",this.tabIndex)):(this.calendarElement=this.createElement("div"),this.calendarElement.classList.add("e-calendar"),this.enableRtl&&this.calendarElement.classList.add("e-rtl"),Browser.isDevice&&this.calendarElement.classList.add("e-device"),attributes(this.calendarElement,{role:"calendar"})),this.createHeader(),this.createContent(),this.wireEvents()}rangeValidation(min,max){isNullOrUndefined(min)&&this.setProperties({min:new Date(1900,0,1)},!0),isNullOrUndefined(max)&&this.setProperties({max:new Date(2099,11,31)},!0)}validateDate(value){this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.currentDate=this.currentDate?this.currentDate:new Date((new Date).setHours(0,0,0,0)),!isNullOrUndefined(value)&&this.min<=this.max&&value>=this.min&&value<=this.max&&(this.currentDate=new Date(this.checkValue(value)))}setOverlayIndex(popupWrapper,popupElement,modal,isDevice){if(isDevice&&!isNullOrUndefined(popupElement)&&!isNullOrUndefined(modal)&&!isNullOrUndefined(popupWrapper)){let index=parseInt(popupElement.style.zIndex,10)?parseInt(popupElement.style.zIndex,10):1e3;modal.style.zIndex=(index-1).toString(),popupWrapper.style.zIndex=index.toString()}}minMaxUpdate(value){+this.min<=+this.max?removeClass([this.element],OVERLAY):(this.setProperties({min:this.min},!0),addClass([this.element],OVERLAY)),this.min=isNullOrUndefined(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=isNullOrUndefined(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,+this.min<=+this.max&&value&&+value<=+this.max&&+value>=+this.min?this.currentDate=new Date(this.checkValue(value)):+this.min<=+this.max&&!value&&+this.currentDate>+this.max?this.currentDate=new Date(this.checkValue(this.max)):+this.currentDate<+this.min&&(this.currentDate=new Date(this.checkValue(this.min)))}createHeader(){this.headerElement=this.createElement("div",{className:"e-header"});let iconContainer=this.createElement("div",{className:"e-icon-container"});this.previousIcon=this.createElement("button",{className:"e-prev",attrs:{type:"button"}}),rippleEffect(this.previousIcon,{duration:400,selector:".e-prev",isCenterRipple:!0}),attributes(this.previousIcon,{"aria-disabled":"false","aria-label":"previous month"}),this.nextIcon=this.createElement("button",{className:"e-next",attrs:{type:"button"}}),rippleEffect(this.nextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),attributes(this.nextIcon,{"aria-disabled":"false","aria-label":"next month"}),this.headerTitleElement=this.createElement("div",{className:"e-day e-title"}),attributes(this.headerTitleElement,{"aria-atomic":"true","aria-live":"assertive","aria-label":"title"}),this.headerElement.appendChild(this.headerTitleElement),this.previousIcon.appendChild(this.createElement("span",{className:"e-date-icon-prev e-icons"})),this.nextIcon.appendChild(this.createElement("span",{className:"e-date-icon-next  e-icons"})),iconContainer.appendChild(this.previousIcon),iconContainer.appendChild(this.nextIcon),this.headerElement.appendChild(iconContainer),"calendar"===this.getModuleName()?this.element.appendChild(this.headerElement):this.calendarElement.appendChild(this.headerElement),this.adjustLongHeaderSize()}createContent(){this.contentElement=this.createElement("div",{className:"e-content"}),this.table=this.createElement("table",{attrs:{tabIndex:"0",role:"grid","aria-activedescendant":""}}),"calendar"===this.getModuleName()?this.element.appendChild(this.contentElement):this.calendarElement.appendChild(this.contentElement),this.contentElement.appendChild(this.table),this.createContentHeader(),this.createContentBody(),this.showTodayButton&&this.createContentFooter()}getCultureValues(){let cldrObj,culShortNames=[],dayFormat="days.stand-alone."+this.dayHeaderFormat.toLowerCase();cldrObj="en"===this.locale||"en-US"===this.locale?getValue(dayFormat,getDefaultDateObject()):this.getCultureObjects(cldrData,""+this.locale);for(let obj of Object.keys(cldrObj))culShortNames.push(getValue(obj,cldrObj));return culShortNames}createContentHeader(){"calendar"===this.getModuleName()?isNullOrUndefined(this.element.querySelectorAll(".e-content .e-week-header")[0])||detach(this.element.querySelectorAll(".e-content .e-week-header")[0]):isNullOrUndefined(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0])||detach(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0]);let shortNames,html="";(this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:0},!0),this.tableHeadElement=this.createElement("thead",{className:"e-week-header"}),this.weekNumber&&(html+='<th class="e-week-number"></th>',"calendar"===this.getModuleName()?addClass([this.element],"e-week-number"):addClass([this.calendarElement],"e-week-number")),shortNames=this.shiftArray(this.getCultureValues().length>0&&this.getCultureValues(),this.firstDayOfWeek);for(let days=0;days<=6;days++)html+='<th  class="">'+shortNames[days]+"</th>";this.tableHeadElement.innerHTML=html="<tr>"+html+"</tr>",this.table.appendChild(this.tableHeadElement)}createContentBody(){switch("calendar"===this.getModuleName()?isNullOrUndefined(this.element.querySelectorAll(".e-content tbody")[0])||detach(this.element.querySelectorAll(".e-content tbody")[0]):isNullOrUndefined(this.calendarElement.querySelectorAll(".e-content tbody")[0])||detach(this.calendarElement.querySelectorAll(".e-content tbody")[0]),this.start){case"Year":this.renderYears();break;case"Decade":this.renderDecades();break;default:this.renderMonths()}}updateFooter(){this.todayElement.textContent=this.l10.getConstant("today"),this.todayElement.setAttribute("aria-label",this.l10.getConstant("today"))}createContentFooter(){if(this.showTodayButton){let minimum=new Date(+this.min),maximum=new Date(+this.max),l10nLocale={today:"Today"};this.globalize=new Internationalization(this.locale),this.l10=new L10n(this.getModuleName(),l10nLocale,this.locale),this.todayElement=this.createElement("button",{attrs:{role:"button"}}),rippleEffect(this.todayElement),this.updateFooter(),addClass([this.todayElement],["e-btn","e-today","e-flat","e-primary","e-css"]),+new Date(minimum.setHours(0,0,0,0))<=+this.todayDate&&+this.todayDate<=+new Date(maximum.setHours(0,0,0,0))&&!this.todayDisabled||addClass([this.todayElement],"e-disabled"),this.footer=this.createElement("div",{className:"e-footer-container"}),this.footer.appendChild(this.todayElement),"calendar"===this.getModuleName()&&this.element.appendChild(this.footer),"datepicker"===this.getModuleName()&&this.calendarElement.appendChild(this.footer),"datetimepicker"===this.getModuleName()&&this.calendarElement.appendChild(this.footer),this.todayElement.classList.contains("e-disabled")||EventHandler.add(this.todayElement,"click",this.todayButtonClick,this)}}wireEvents(){EventHandler.add(this.headerTitleElement,"click",this.navigateTitle,this),this.defaultKeyConfigs=extend(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModule="calendar"===this.getModuleName()?new ej2_base_es2015_KeyboardEvents(this.element,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}):new ej2_base_es2015_KeyboardEvents(this.calendarElement,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})}todayButtonClick(value){this.showTodayButton&&(this.effect=this.currentView()===this.depth?"":"e-zoomin",this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.navigateTo(this.depth,new Date(this.checkValue(value))):this.navigateTo("Month",new Date(this.checkValue(value))))}keyActionHandle(e,value,multiSelection){let selectedDate,view=this.getViewNumber(this.currentView()),focusedDate=this.tableBodyElement.querySelector("tr td.e-focused-date");selectedDate=multiSelection?isNullOrUndefined(focusedDate)||+value!==parseInt(focusedDate.getAttribute("id").split("_")[0],10)?this.tableBodyElement.querySelector("tr td.e-selected"):focusedDate:this.tableBodyElement.querySelector("tr td.e-selected");let depthValue=this.getViewNumber(this.depth),levelRestrict=view===depthValue&&this.getViewNumber(this.start)>=depthValue;switch(this.effect="",e.action){case"moveLeft":this.KeyboardNavigate(-1,view,e,this.max,this.min),e.preventDefault();break;case"moveRight":this.KeyboardNavigate(1,view,e,this.max,this.min),e.preventDefault();break;case"moveUp":this.KeyboardNavigate(0===view?-7:-4,view,e,this.max,this.min),e.preventDefault();break;case"moveDown":this.KeyboardNavigate(0===view?7:4,view,e,this.max,this.min),e.preventDefault();break;case"select":if(e.target===this.todayElement)this.todayButtonClick(value);else{let element=isNullOrUndefined(focusedDate)?selectedDate:focusedDate;if(!isNullOrUndefined(element)&&!element.classList.contains("e-disabled"))if(levelRestrict){let d=new Date(parseInt(""+element.id,0));this.selectDate(e,d,element)}else this.contentClick(null,--view,element,value)}break;case"controlUp":this.title(),e.preventDefault();break;case"controlDown":isNullOrUndefined(focusedDate)&&(isNullOrUndefined(selectedDate)||levelRestrict)||this.contentClick(null,--view,focusedDate||selectedDate,value),e.preventDefault();break;case"home":this.currentDate=this.firstDay(this.currentDate),detach(this.tableBodyElement),0===view?this.renderMonths(e):1===view?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"end":this.currentDate=this.lastDay(this.currentDate,view),detach(this.tableBodyElement),0===view?this.renderMonths(e):1===view?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"pageUp":this.addMonths(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"pageDown":this.addMonths(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageUp":this.addYears(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageDown":this.addYears(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"controlHome":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),0,1)),e.preventDefault();break;case"controlEnd":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),11,31)),e.preventDefault()}"calendar"===this.getModuleName()&&this.table.focus()}KeyboardNavigate(number,currentView,e,max,min){let date=new Date(this.checkValue(this.currentDate));switch(currentView){case 2:this.addYears(this.currentDate,number),this.isMonthYearRange(this.currentDate)?(detach(this.tableBodyElement),this.renderDecades(e)):this.currentDate=date;break;case 1:this.addMonths(this.currentDate,number),this.isMonthYearRange(this.currentDate)?(detach(this.tableBodyElement),this.renderYears(e)):this.currentDate=date;break;case 0:this.addDay(this.currentDate,number,e,max,min),this.isMinMaxRange(this.currentDate)?(detach(this.tableBodyElement),this.renderMonths(e)):this.currentDate=date}}preRender(value){this.navigatePreviousHandler=this.navigatePrevious.bind(this),this.navigateNextHandler=this.navigateNext.bind(this),this.navigateHandler=e=>{this.triggerNavigate(e)}}minMaxDate(localDate){let currentDate=new Date(new Date(+localDate).setHours(0,0,0,0)),minDate=new Date(new Date(+this.min).setHours(0,0,0,0)),maxDate=new Date(new Date(+this.max).setHours(0,0,0,0));return+currentDate!=+minDate&&+currentDate!=+maxDate||(+localDate<+this.min&&(localDate=new Date(+this.min)),+localDate>+this.max&&(localDate=new Date(+this.max))),localDate}renderMonths(e,value){let tdEles,numCells=this.weekNumber?8:7;tdEles="Gregorian"===this.calendarMode?this.renderDays(this.currentDate,e,value):this.islamicModule.islamicRenderDays(this.currentDate,value),this.createContentHeader(),"Gregorian"===this.calendarMode?this.renderTemplate(tdEles,numCells,"e-month",e,value):this.islamicModule.islamicRenderTemplate(tdEles,numCells,"e-month",e,value)}renderDays(currentDate,e,value,multiSelection,values){let minMaxDate,tdEles=[],localDate=new Date(this.checkValue(currentDate)),currentMonth=localDate.getMonth();this.titleUpdate(currentDate,"days");let d=localDate;for(localDate=new Date(d.getFullYear(),d.getMonth(),0,d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds());localDate.getDay()!==this.firstDayOfWeek;)this.setStartDate(localDate,-864e5);for(let day=0;day<42;++day){let weekEle=this.createElement("td",{className:"e-cell"}),weekAnchor=this.createElement("span");day%7==0&&this.weekNumber&&(weekAnchor.textContent=""+this.getWeek(localDate),weekEle.appendChild(weekAnchor),addClass([weekEle],"e-week-number"),tdEles.push(weekEle)),minMaxDate=new Date(+localDate),localDate=this.minMaxDate(localDate);let dateFormatOptions={type:"dateTime",skeleton:"full"},date=this.globalize.parseDate(this.globalize.formatDate(localDate,dateFormatOptions),dateFormatOptions),tdEle=this.dayCell(localDate),title=this.globalize.formatDate(localDate,{type:"date",skeleton:"full"}),dayLink=this.createElement("span");dayLink.textContent=this.globalize.formatDate(localDate,{format:"d",type:"date",skeleton:"yMd"});let disabled=this.min>localDate||this.max<localDate;disabled?(addClass([tdEle],"e-disabled"),addClass([tdEle],OVERLAY)):dayLink.setAttribute("title",""+title),currentMonth!==localDate.getMonth()&&addClass([tdEle],OTHERMONTH),0!==localDate.getDay()&&6!==localDate.getDay()||addClass([tdEle],"e-weekend"),tdEle.appendChild(dayLink),this.renderDayCellArgs={date:localDate,isDisabled:!1,element:tdEle,isOutOfRange:disabled};let argument=this.renderDayCellArgs;if(this.renderDayCellEvent(argument),argument.isDisabled)if(multiSelection){if(!isNullOrUndefined(values)&&values.length>0)for(let index=0;index<values.length;index++)+new Date(this.globalize.formatDate(argument.date,{type:"date",skeleton:"yMd"}))==+new Date(this.globalize.formatDate(values[index],{type:"date",skeleton:"yMd"}))&&(values.splice(index,1),index=-1)}else value&&+value==+argument.date&&this.setProperties({value:null},!0);this.renderDayCellArgs.isDisabled&&!tdEle.classList.contains(SELECTED)&&(addClass([tdEle],"e-disabled"),addClass([tdEle],OVERLAY),+this.renderDayCellArgs.date==+this.todayDate&&(this.todayDisabled=!0));let otherMnthBool=tdEle.classList.contains(OTHERMONTH),disabledCls=tdEle.classList.contains("e-disabled");if(disabledCls||EventHandler.add(tdEle,"click",this.clickHandler,this),!multiSelection||isNullOrUndefined(values)||otherMnthBool||disabledCls)otherMnthBool||disabledCls||!this.getDateVal(localDate,value)?this.updateFocus(otherMnthBool,disabledCls,localDate,tdEle,currentDate):addClass([tdEle],SELECTED);else{for(let tempValue=0;tempValue<values.length;tempValue++){let formatOptions={type:"date",skeleton:"short",calendar:"Gregorian"===this.calendarMode?"gregorian":"islamic"};this.globalize.formatDate(localDate,formatOptions)===this.globalize.formatDate(values[tempValue],formatOptions)&&this.getDateVal(localDate,values[tempValue])||this.getDateVal(localDate,value)?addClass([tdEle],SELECTED):this.updateFocus(otherMnthBool,disabledCls,localDate,tdEle,currentDate)}values.length<=0&&this.updateFocus(otherMnthBool,disabledCls,localDate,tdEle,currentDate)}date.getMonth()===(new Date).getMonth()&&date.getDate()===(new Date).getDate()&&date.getFullYear()===(new Date).getFullYear()&&addClass([tdEle],"e-today"),tdEles.push(this.renderDayCellArgs.element),localDate=new Date(+minMaxDate),this.addDay(localDate,1,null,this.max,this.min)}return tdEles}updateFocus(otherMonth,disabled,localDate,tableElement,currentDate){currentDate.getDate()!==localDate.getDate()||otherMonth||disabled?(currentDate>=this.max&&parseInt(tableElement.id,0)===+this.max&&!otherMonth&&!disabled&&addClass([tableElement],FOCUSEDDATE),currentDate<=this.min&&parseInt(tableElement.id,0)===+this.min&&!otherMonth&&!disabled&&addClass([tableElement],FOCUSEDDATE)):addClass([tableElement],FOCUSEDDATE)}renderYears(e,value){this.removeTableHeadElement();let tdEles=[],valueUtil=isNullOrUndefined(value),curDate=new Date(this.checkValue(this.currentDate)),mon=curDate.getMonth(),yr=curDate.getFullYear(),localDate=curDate,curYrs=localDate.getFullYear(),minYr=new Date(this.checkValue(this.min)).getFullYear(),minMonth=new Date(this.checkValue(this.min)).getMonth(),maxYr=new Date(this.checkValue(this.max)).getFullYear(),maxMonth=new Date(this.checkValue(this.max)).getMonth();localDate.setMonth(0),this.titleUpdate(this.currentDate,"months"),localDate.setDate(1);for(let month=0;month<12;++month){let tdEle=this.dayCell(localDate),dayLink=this.createElement("span"),localMonth=value&&value.getMonth()===localDate.getMonth(),select$$1=value&&value.getFullYear()===yr&&localMonth;dayLink.textContent=this.globalize.formatDate(localDate,{type:"dateTime",skeleton:"MMM"}),this.min&&(curYrs<minYr||month<minMonth&&curYrs===minYr)||this.max&&(curYrs>maxYr||month>maxMonth&&curYrs>=maxYr)?addClass([tdEle],"e-disabled"):!valueUtil&&select$$1?addClass([tdEle],SELECTED):localDate.getMonth()===mon&&this.currentDate.getMonth()===mon&&addClass([tdEle],FOCUSEDDATE),localDate.setDate(1),localDate.setMonth(localDate.getMonth()+1),tdEle.classList.contains("e-disabled")||EventHandler.add(tdEle,"click",this.clickHandler,this),tdEle.appendChild(dayLink),tdEles.push(tdEle)}this.renderTemplate(tdEles,4,"e-year",e,value)}renderDecades(e,value){this.removeTableHeadElement();let tdEles=[],localDate=new Date(this.checkValue(this.currentDate));localDate.setMonth(0),localDate.setDate(1);let localYr=localDate.getFullYear(),startYr=new Date(localDate.setFullYear(localYr-localYr%10)),endYr=new Date(localDate.setFullYear(localYr-localYr%10+9)),startFullYr=startYr.getFullYear(),endFullYr=endYr.getFullYear(),startHdrYr=this.globalize.formatDate(startYr,{type:"dateTime",skeleton:"y"}),endHdrYr=this.globalize.formatDate(endYr,{type:"dateTime",skeleton:"y"});this.headerTitleElement.textContent=startHdrYr+" - "+endHdrYr;let startYear=new Date(localYr-localYr%10-1,0,1).getFullYear();for(let rowIterator=0;rowIterator<12;++rowIterator){let year=startYear+rowIterator;localDate.setFullYear(year);let tdEle=this.dayCell(localDate);attributes(tdEle,{role:"gridcell"});let dayLink=this.createElement("span");dayLink.textContent=this.globalize.formatDate(localDate,{type:"dateTime",skeleton:"y"}),year<startFullYr||year>endFullYr?(addClass([tdEle],"e-other-year"),(year<new Date(this.checkValue(this.min)).getFullYear()||year>new Date(this.checkValue(this.max)).getFullYear())&&addClass([tdEle],"e-disabled")):year<new Date(this.checkValue(this.min)).getFullYear()||year>new Date(this.checkValue(this.max)).getFullYear()?addClass([tdEle],"e-disabled"):isNullOrUndefined(value)||localDate.getFullYear()!==value.getFullYear()?localDate.getFullYear()!==this.currentDate.getFullYear()||tdEle.classList.contains("e-disabled")||addClass([tdEle],FOCUSEDDATE):addClass([tdEle],SELECTED),tdEle.classList.contains("e-disabled")||EventHandler.add(tdEle,"click",this.clickHandler,this),tdEle.appendChild(dayLink),tdEles.push(tdEle)}this.renderTemplate(tdEles,4,"e-decade",e,value)}dayCell(localDate){let dateFormatOptions={skeleton:"full",type:"dateTime",calendar:"Gregorian"===this.calendarMode?"gregorian":"islamic"},attrs={className:"e-cell",attrs:{id:""+getUniqueID(""+this.globalize.parseDate(this.globalize.formatDate(localDate,dateFormatOptions),dateFormatOptions).valueOf()),"aria-selected":"false",role:"gridcell"}};return this.createElement("td",attrs)}firstDay(date){let collection="Decade"!==this.currentView()?this.tableBodyElement.querySelectorAll("td:not(."+OTHERMONTH):this.tableBodyElement.querySelectorAll("td:not(.e-other-year");if(collection.length)for(let i=0;i<collection.length;i++)if(!collection[i].classList.contains("e-disabled")){date=new Date(parseInt(collection[i].id,0));break}return date}lastDay(date,view){let lastDate=new Date(date.getFullYear(),date.getMonth()+1,0);if(2!==view){let timeOffset=Math.abs(lastDate.getTimezoneOffset()-this.firstDay(date).getTimezoneOffset());return timeOffset&&lastDate.setHours(this.firstDay(date).getHours()+timeOffset/60),this.findLastDay(lastDate)}return this.findLastDay(this.firstDay(lastDate))}checkDateValue(value){return!isNullOrUndefined(value)&&value instanceof Date&&!isNaN(+value)?value:null}findLastDay(date){let collection="Decade"===this.currentView()?this.tableBodyElement.querySelectorAll("td:not(.e-other-year"):this.tableBodyElement.querySelectorAll("td:not(."+OTHERMONTH);if(collection.length)for(let i=collection.length-1;i>=0;i--)if(!collection[i].classList.contains("e-disabled")){date=new Date(parseInt(collection[i].id,0));break}return date}removeTableHeadElement(){"calendar"===this.getModuleName()?isNullOrUndefined(this.element.querySelectorAll(".e-content table thead")[0])||detach(this.tableHeadElement):isNullOrUndefined(this.calendarElement.querySelectorAll(".e-content table thead")[0])||detach(this.tableHeadElement)}renderTemplate(elements,count,classNm,e,value){let trEle,view=this.getViewNumber(this.currentView());this.tableBodyElement=this.createElement("tbody"),this.table.appendChild(this.tableBodyElement),removeClass([this.contentElement,this.headerElement],["e-month","e-decade","e-year"]),addClass([this.contentElement,this.headerElement],[classNm]);let row=count,rowIterator=0;for(let dayCell=0;dayCell<elements.length/count;++dayCell){for(trEle=this.createElement("tr",{attrs:{role:"row"}}),rowIterator=0+rowIterator;rowIterator<row;rowIterator++)elements[rowIterator].classList.contains("e-week-number")||isNullOrUndefined(elements[rowIterator].children[0])||(addClass([elements[rowIterator].children[0]],["e-day"]),rippleEffect(elements[rowIterator].children[0],{duration:600,isCenterRipple:!0})),trEle.appendChild(elements[rowIterator]),this.weekNumber&&7===rowIterator&&elements[7].classList.contains(OTHERMONTH)&&addClass([trEle],"e-month-hide"),!this.weekNumber&&6===rowIterator&&elements[6].classList.contains(OTHERMONTH)&&addClass([trEle],"e-month-hide"),this.weekNumber?41===rowIterator&&elements[41].classList.contains(OTHERMONTH)&&addClass([trEle],"e-month-hide"):35===rowIterator&&elements[35].classList.contains(OTHERMONTH)&&addClass([trEle],"e-month-hide");row+=count,rowIterator+=0,this.tableBodyElement.appendChild(trEle)}this.table.querySelector("tbody").className=this.effect,"Gregorian"===this.calendarMode?this.iconHandler():this.islamicModule.islamicIconHandler(),(view!==this.getViewNumber(this.currentView())||0===view&&view!==this.getViewNumber(this.currentView()))&&this.navigateHandler(e),this.setAriaActiveDescendant()}clickHandler(e,value){this.clickEventEmitter(e);let eve=e.currentTarget,view=this.getViewNumber(this.currentView());eve.classList.contains(OTHERMONTH)?this.contentClick(e,0,null,value):view===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.contentClick(e,1,null,value):2===view?this.contentClick(e,1,null,value):eve.classList.contains(OTHERMONTH)||0!==view?this.contentClick(e,0,eve,value):this.selectDate(e,this.getIdValue(e,null),null),"calendar"===this.getModuleName()&&this.table.focus()}clickEventEmitter(e){e.preventDefault()}contentClick(e,view,element,value){let currentView=this.getViewNumber(this.currentView()),d=this.getIdValue(e,element);switch(view){case 0:currentView===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?(detach(this.tableBodyElement),this.currentDate=d,this.effect="e-zoomin",this.renderMonths(e)):("Gregorian"===this.calendarMode?(this.currentDate.setMonth(d.getMonth()),d.getMonth()>0&&this.currentDate.getMonth()!==d.getMonth()&&this.currentDate.setDate(0),this.currentDate.setFullYear(d.getFullYear())):this.currentDate=d,this.effect="e-zoomin",detach(this.tableBodyElement),this.renderMonths(e));break;case 1:if(currentView===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth))this.selectDate(e,d,null);else{if("Gregorian"===this.calendarMode)this.currentDate.setFullYear(d.getFullYear());else{let islamicDate=this.islamicModule.getIslamicDate(d);this.currentDate=this.islamicModule.toGregorian(islamicDate.year,islamicDate.month,1)}this.effect="e-zoomin",detach(this.tableBodyElement),this.renderYears(e)}}}switchView(view,e,multiSelection){switch(view){case 0:detach(this.tableBodyElement),this.renderMonths(e),multiSelection&&!isNullOrUndefined(this.tableBodyElement.querySelectorAll("."+FOCUSEDDATE)[0])&&this.tableBodyElement.querySelectorAll("."+FOCUSEDDATE)[0].classList.remove(FOCUSEDDATE);break;case 1:detach(this.tableBodyElement),this.renderYears(e);break;case 2:detach(this.tableBodyElement),this.renderDecades(e)}}getModuleName(){return"calendar"}requiredModules(){let modules=[];return this&&modules.push({args:[this],member:"islamic"}),modules}getPersistData(){return this.addOnPersist(["value"])}onPropertyChanged(newProp,oldProp,multiSelection,values){this.effect="";for(let prop of Object.keys(newProp))switch(prop){case"enableRtl":newProp.enableRtl?"calendar"===this.getModuleName()?this.element.classList.add("e-rtl"):this.calendarElement.classList.add("e-rtl"):"calendar"===this.getModuleName()?this.element.classList.remove("e-rtl"):this.calendarElement.classList.remove("e-rtl");break;case"dayHeaderFormat":this.getCultureValues(),this.createContentHeader(),this.adjustLongHeaderSize();break;case"min":case"max":this.rangeValidation(this.min,this.max),this.setProperties("min"===prop?{min:this.checkDateValue(new Date(this.checkValue(newProp.min)))}:{max:this.checkDateValue(new Date(this.checkValue(newProp.max)))},!0),this.setProperties({start:this.currentView()},!0),detach(this.tableBodyElement),this.minMaxUpdate(),multiSelection&&this.validateValues(multiSelection,values),this.createContentBody(),(this.todayDate<this.min||this.max<this.todayDate)&&this.footer&&this.todayElement?(detach(this.todayElement),detach(this.footer),this.todayElement=this.footer=null,this.createContentFooter()):this.footer&&this.todayElement&&this.todayElement.classList.contains("e-disabled")&&(removeClass([this.todayElement],"e-disabled"),detach(this.todayElement),detach(this.footer),this.todayElement=this.footer=null,this.createContentFooter());break;case"start":case"depth":case"weekNumber":case"firstDayOfWeek":this.checkView(),this.createContentHeader(),this.createContentBody();break;case"locale":this.globalize=new Internationalization(this.locale),this.createContentHeader(),this.createContentBody(),this.l10.setLocale(this.locale),this.updateFooter();break;case"showTodayButton":newProp.showTodayButton?this.createContentFooter():isNullOrUndefined(this.todayElement)||isNullOrUndefined(this.footer)||(detach(this.todayElement),detach(this.footer),this.todayElement=this.footer=void 0),this.setProperties({showTodayButton:newProp.showTodayButton},!0)}}validateValues(multiSelection,values){if(multiSelection&&!isNullOrUndefined(values)&&values.length>0){let copyValues=this.copyValues(values);for(let skipIndex=0;skipIndex<copyValues.length;skipIndex++){let tempValueString,type="Gregorian"===this.calendarMode?"gregorian":"islamic";tempValueString=this.globalize.formatDate(copyValues[skipIndex],"Gregorian"===this.calendarMode?{type:"date",skeleton:"yMd"}:{type:"dateTime",skeleton:"full",calendar:"islamic"});let minString=this.globalize.formatDate(this.min,{type:"date",skeleton:"yMd",calendar:type}),maxString=this.globalize.formatDate(this.max,{type:"date",skeleton:"yMd",calendar:type});(+new Date(tempValueString)<+new Date(minString)||+new Date(tempValueString)>+new Date(maxString))&&(copyValues.splice(skipIndex,1),skipIndex=-1)}this.setProperties({values:copyValues},!0)}}setValueUpdate(){isNullOrUndefined(this.tableBodyElement)||(detach(this.tableBodyElement),this.setProperties({start:this.currentView()},!0),this.createContentBody())}copyValues(values){let copyValues=[];if(!isNullOrUndefined(values)&&values.length>0)for(let index=0;index<values.length;index++)copyValues.push(new Date(+values[index]));return copyValues}titleUpdate(date,view){let dayFormatOptions,monthFormatOptions,globalize=new Internationalization(this.locale),type="Gregorian"===this.calendarMode?"gregorian":"islamic";switch("Gregorian"===this.calendarMode?(dayFormatOptions=globalize.formatDate(date,{type:"dateTime",skeleton:"yMMMM",calendar:type}),monthFormatOptions=globalize.formatDate(date,{type:"dateTime",skeleton:"y",calendar:type})):(dayFormatOptions=globalize.formatDate(date,{type:"dateTime",format:"MMMM y",calendar:type}),monthFormatOptions=globalize.formatDate(date,{type:"dateTime",format:"y",calendar:type})),view){case"days":this.headerTitleElement.textContent=dayFormatOptions;break;case"months":this.headerTitleElement.textContent=monthFormatOptions}}setActiveDescendant(){let id,title,focusedEle=this.tableBodyElement.querySelector("tr td.e-focused-date"),selectedEle=this.tableBodyElement.querySelector("tr td.e-selected"),type="Gregorian"===this.calendarMode?"gregorian":"islamic",view=this.currentView();return title=this.globalize.formatDate(this.currentDate,"Month"===view?{type:"date",skeleton:"full",calendar:type}:"Year"===view?"islamic"!==type?{type:"date",skeleton:"yMMMM",calendar:type}:{type:"date",skeleton:"GyMMM",calendar:type}:{type:"date",skeleton:"y",calendar:type}),(selectedEle||focusedEle)&&(isNullOrUndefined(selectedEle)||selectedEle.setAttribute("aria-selected","true"),(focusedEle||selectedEle).setAttribute("aria-label",title),id=(focusedEle||selectedEle).getAttribute("id")),id}iconHandler(){switch(new Date(this.checkValue(this.currentDate)).setDate(1),this.currentView()){case"Month":this.previousIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Year":this.previousIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Decade":this.previousIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.max)>-1)}}destroy(){"calendar"===this.getModuleName()?removeClass([this.element],["e-calendar"]):this.calendarElement&&removeClass([this.element],["e-calendar"]),"calendar"===this.getModuleName()&&(EventHandler.remove(this.headerTitleElement,"click",this.navigateTitle),this.todayElement&&EventHandler.remove(this.todayElement,"click",this.todayButtonClick),this.previousIconHandler(!0),this.nextIconHandler(!0),this.keyboardModule.destroy(),this.element.removeAttribute("data-role"),isNullOrUndefined(this.calendarEleCopy.getAttribute("tabindex"))?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex",this.tabIndex)),this.element.innerHTML="",super.destroy()}title(e){let currentView=this.getViewNumber(this.currentView());this.effect="e-zoomin",this.switchView(++currentView,e)}getViewNumber(stringVal){return"Month"===stringVal?0:"Year"===stringVal?1:2}navigateTitle(e){e.preventDefault(),this.title(e),"calendar"===this.getModuleName()&&this.table.focus()}previous(){this.effect="";let currentView=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,-1),this.switchView(currentView);break;case"Year":this.addYears(this.currentDate,-1),this.switchView(currentView);break;case"Decade":this.addYears(this.currentDate,-10),this.switchView(currentView)}}navigatePrevious(e){e.preventDefault(),"Gregorian"===this.calendarMode?this.previous():this.islamicModule.islamicPrevious(),this.triggerNavigate(e),"calendar"===this.getModuleName()&&this.table.focus()}next(){this.effect="";let currentView=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,1),this.switchView(currentView);break;case"Year":this.addYears(this.currentDate,1),this.switchView(currentView);break;case"Decade":this.addYears(this.currentDate,10),this.switchView(currentView)}}navigateNext(eve){eve.preventDefault(),"Gregorian"===this.calendarMode?this.next():this.islamicModule.islamicNext(),this.triggerNavigate(eve),"calendar"===this.getModuleName()&&this.table.focus()}navigateTo(view,date){+date>=+this.min&&+date<=+this.max&&(this.currentDate=date),+date<=+this.min&&(this.currentDate=new Date(this.checkValue(this.min))),+date>=+this.max&&(this.currentDate=new Date(this.checkValue(this.max))),this.getViewNumber(this.depth)>=this.getViewNumber(view)&&(this.getViewNumber(this.depth)<=this.getViewNumber(this.start)||this.getViewNumber(this.depth)===this.getViewNumber(view))&&(view=this.depth),this.switchView(this.getViewNumber(view))}currentView(){return this.contentElement.classList.contains("e-year")?"Year":this.contentElement.classList.contains("e-decade")?"Decade":"Month"}getDateVal(date,value){return!isNullOrUndefined(value)&&date.getDate()===value.getDate()&&date.getMonth()===value.getMonth()&&date.getFullYear()===value.getFullYear()}getCultureObjects(ld,c){let gregorianFormat=".dates.calendars.gregorian.days.format."+this.dayHeaderFormat.toLowerCase(),islamicFormat=".dates.calendars.islamic.days.format."+this.dayHeaderFormat.toLowerCase();return getValue("Gregorian"===this.calendarMode?"main."+this.locale+gregorianFormat:"main."+this.locale+islamicFormat,ld)}getWeek(d){let currentDate=new Date(this.checkValue(d)).valueOf(),date=new Date(d.getFullYear(),0,1).valueOf();return Math.ceil(((currentDate-date)/864e5+new Date(date).getDay()+1)/7)}setStartDate(date,time){let tzOffset=date.getTimezoneOffset(),d=new Date(date.getTime()+time),tzOffsetDiff=d.getTimezoneOffset()-tzOffset;date.setTime(d.getTime()+6e4*tzOffsetDiff)}addMonths(date,i){if("Gregorian"===this.calendarMode){let day=date.getDate();date.setDate(1),date.setMonth(date.getMonth()+i),date.setDate(Math.min(day,this.getMaxDays(date)))}else{let islamicDate=this.islamicModule.getIslamicDate(date);this.currentDate=this.islamicModule.toGregorian(islamicDate.year,islamicDate.month+i,1)}}addYears(date,i){if("Gregorian"===this.calendarMode){let day=date.getDate();date.setDate(1),date.setFullYear(date.getFullYear()+i),date.setDate(Math.min(day,this.getMaxDays(date)))}else{let islamicDate=this.islamicModule.getIslamicDate(date);this.currentDate=this.islamicModule.toGregorian(islamicDate.year+i,islamicDate.month,1)}}getIdValue(e,element){let eve,dateFormatOptions={type:"dateTime",skeleton:"full",calendar:"Gregorian"===this.calendarMode?"gregorian":"islamic"},dateString=this.globalize.formatDate(new Date(parseInt(""+(eve=e?e.currentTarget:element).getAttribute("id"),0)),dateFormatOptions),date=this.globalize.parseDate(dateString,dateFormatOptions),value=date.valueOf()-date.valueOf()%1e3;return new Date(value)}adjustLongHeaderSize(){removeClass([this.element],"e-calendar-day-header-lg"),"Wide"===this.dayHeaderFormat&&addClass(["calendar"===this.getModuleName()?this.element:this.calendarElement],"e-calendar-day-header-lg")}selectDate(e,date,node,multiSelection,values){let element=node||e.currentTarget;if(this.isDateSelected=!1,"Decade"===this.currentView())this.setDateDecade(this.currentDate,date.getFullYear());else if("Year"===this.currentView())this.setDateYear(this.currentDate,date);else{if(multiSelection&&!this.checkPresentDate(date,values)){let copyValues=this.copyValues(values);!isNullOrUndefined(values)&&copyValues.length>0?(copyValues.push(new Date(this.checkValue(date))),this.setProperties({values:copyValues},!0),this.setProperties({value:values[values.length-1]},!0)):this.setProperties({values:[new Date(this.checkValue(date))]},!0)}else this.setProperties({value:new Date(this.checkValue(date))},!0);this.currentDate=new Date(this.checkValue(date))}let tableBodyElement=closest(element,".e-calendar");if(isNullOrUndefined(tableBodyElement)&&(tableBodyElement=this.tableBodyElement),multiSelection||isNullOrUndefined(tableBodyElement.querySelector("."+SELECTED))||removeClass([tableBodyElement.querySelector("."+SELECTED)],SELECTED),multiSelection||isNullOrUndefined(tableBodyElement.querySelector("."+FOCUSEDDATE))||removeClass([tableBodyElement.querySelector("."+FOCUSEDDATE)],FOCUSEDDATE),multiSelection){let copyValues=this.copyValues(values),collection=Array.prototype.slice.call(this.tableBodyElement.querySelectorAll("td"));for(let index=0;index<collection.length;index++){let tempElement=tableBodyElement.querySelectorAll("td."+FOCUSEDDATE)[0],selectedElement=tableBodyElement.querySelectorAll("td."+SELECTED)[0];collection[index]===tempElement&&removeClass([collection[index]],FOCUSEDDATE),collection[index]!==selectedElement||this.checkPresentDate(new Date(parseInt(selectedElement.getAttribute("id").split("_")[0],10)),values)||removeClass([collection[index]],SELECTED)}if(element.classList.contains(SELECTED)){removeClass([element],SELECTED);for(let i=0;i<copyValues.length;i++){let formatOptions={type:"date",skeleton:"short",calendar:"Gregorian"===this.calendarMode?"gregorian":"islamic"};if(this.globalize.formatDate(date,formatOptions)===this.globalize.formatDate(copyValues[i],formatOptions)){let index=copyValues.indexOf(copyValues[i]);copyValues.splice(index,1),addClass([element],FOCUSEDDATE)}}this.setProperties({values:copyValues},!0)}else addClass([element],SELECTED)}else addClass([element],SELECTED);this.isDateSelected=!0}checkPresentDate(dates,values){let previousValue=!1;if(!isNullOrUndefined(values))for(let checkPrevious=0;checkPrevious<values.length;checkPrevious++){let type="Gregorian"===this.calendarMode?"gregorian":"islamic";this.globalize.formatDate(dates,{type:"date",skeleton:"short",calendar:type})===this.globalize.formatDate(values[checkPrevious],{type:"date",skeleton:"short",calendar:type})&&(previousValue=!0)}return previousValue}setAriaActiveDescendant(){attributes(this.table,{"aria-activedescendant":""+this.setActiveDescendant()})}previousIconHandler(disabled){disabled?(EventHandler.remove(this.previousIcon,"click",this.navigatePreviousHandler),addClass([this.previousIcon],"e-disabled"),addClass([this.previousIcon],""+OVERLAY),this.previousIcon.setAttribute("aria-disabled","true")):(EventHandler.add(this.previousIcon,"click",this.navigatePreviousHandler),removeClass([this.previousIcon],"e-disabled"),removeClass([this.previousIcon],""+OVERLAY),this.previousIcon.setAttribute("aria-disabled","false"))}renderDayCellEvent(args){extend(this.renderDayCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",args)}navigatedEvent(eve){extend(this.navigatedArgs,{name:"navigated",event:eve}),this.trigger("navigated",this.navigatedArgs)}triggerNavigate(event){this.navigatedArgs={view:this.currentView(),date:this.currentDate},this.navigatedEvent(event)}nextIconHandler(disabled){disabled?(EventHandler.remove(this.nextIcon,"click",this.navigateNextHandler),addClass([this.nextIcon],"e-disabled"),addClass([this.nextIcon],OVERLAY),this.nextIcon.setAttribute("aria-disabled","true")):(EventHandler.add(this.nextIcon,"click",this.navigateNextHandler),removeClass([this.nextIcon],"e-disabled"),removeClass([this.nextIcon],OVERLAY),this.nextIcon.setAttribute("aria-disabled","false"))}compare(startDate,endDate,modifier){let end,result,start=endDate.getFullYear();return end=start,result=0,modifier&&(end=(start-=start%modifier)-start%modifier+modifier-1),startDate.getFullYear()>end?result=1:startDate.getFullYear()<start&&(result=-1),result}isMinMaxRange(date){return+date>=+this.min&&+date<=+this.max}isMonthYearRange(date){if("Gregorian"===this.calendarMode)return date.getMonth()>=this.min.getMonth()&&date.getFullYear()>=this.min.getFullYear()&&date.getMonth()<=this.max.getMonth()&&date.getFullYear()<=this.max.getFullYear();{let islamicDate=this.islamicModule.getIslamicDate(date);return islamicDate.month>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).month&&islamicDate.year>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).year&&islamicDate.month<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).month&&islamicDate.year<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).year}}compareYear(start,end){return this.compare(start,end,0)}compareDecade(start,end){return this.compare(start,end,10)}shiftArray(array,i){return array.slice(i).concat(array.slice(0,i))}addDay(date,i,e,max,min){let column=i,value=new Date(+date);if(!isNullOrUndefined(this.tableBodyElement)&&!isNullOrUndefined(e)){for(;this.findNextTD(new Date(+date),column,max,min);)column+=i;let rangeValue=new Date(value.setDate(value.getDate()+column));column=+rangeValue>+max||+rangeValue<+min?column===i?i-i:i:column}date.setDate(date.getDate()+column)}findNextTD(date,column,max,min){let value=new Date(date.setDate(date.getDate()+column)),collection=[],isDisabled=!1;if((!isNullOrUndefined(value)&&value.getMonth())===(!isNullOrUndefined(this.currentDate)&&this.currentDate.getMonth())){let tdEles;collection=(tdEles="Gregorian"===this.calendarMode?this.renderDays(value,null):this.islamicModule.islamicRenderDays(this.currentDate,value)).filter(element=>element.classList.contains("e-disabled"))}else collection=this.tableBodyElement.querySelectorAll("td.e-disabled");if(+value<=+max&&+value>=+min&&collection.length)for(let i=0;i<collection.length&&!(isDisabled=+value==+new Date(parseInt(collection[i].id,0)));i++);return isDisabled}getMaxDays(d){let date,month,tmpDate=new Date(this.checkValue(d));for(date=28,month=tmpDate.getMonth();tmpDate.getMonth()===month;)tmpDate.setDate(++date);return date-1}setDateDecade(date,year){date.setFullYear(year),this.setProperties({value:new Date(this.checkValue(date))},!0)}setDateYear(date,value){date.setFullYear(value.getFullYear(),value.getMonth(),date.getDate()),value.getMonth()!==date.getMonth()&&date.setDate(0),this.setProperties({value:new Date(this.checkValue(date))},!0),this.currentDate=new Date(this.checkValue(value))}compareMonth(start,end){return start.getFullYear()>end.getFullYear()?1:start.getFullYear()<end.getFullYear()?-1:start.getMonth()===end.getMonth()?0:start.getMonth()>end.getMonth()?1:-1}checkValue(inValue){return inValue instanceof Date?inValue.toUTCString():""+inValue}checkView(){"Decade"!==this.start&&"Year"!==this.start&&this.setProperties({start:"Month"},!0),"Decade"!==this.depth&&"Year"!==this.depth&&this.setProperties({depth:"Month"},!0),this.getViewNumber(this.depth)>this.getViewNumber(this.start)&&this.setProperties({depth:"Month"},!0)}};return __decorate([Property(new Date(1900,0,1))],CalendarBase.prototype,"min",void 0),__decorate([Property(new Date(2099,11,31))],CalendarBase.prototype,"max",void 0),__decorate([Property(null)],CalendarBase.prototype,"firstDayOfWeek",void 0),__decorate([Property("Gregorian")],CalendarBase.prototype,"calendarMode",void 0),__decorate([Property("Month")],CalendarBase.prototype,"start",void 0),__decorate([Property("Month")],CalendarBase.prototype,"depth",void 0),__decorate([Property(!1)],CalendarBase.prototype,"weekNumber",void 0),__decorate([Property(!0)],CalendarBase.prototype,"showTodayButton",void 0),__decorate([Property("Short")],CalendarBase.prototype,"dayHeaderFormat",void 0),__decorate([Property(!1)],CalendarBase.prototype,"enablePersistence",void 0),__decorate([Property(null)],CalendarBase.prototype,"keyConfigs",void 0),__decorate([ej2_base_es2015_Event()],CalendarBase.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],CalendarBase.prototype,"destroyed",void 0),__decorate([ej2_base_es2015_Event()],CalendarBase.prototype,"navigated",void 0),__decorate([ej2_base_es2015_Event()],CalendarBase.prototype,"renderDayCell",void 0),__decorate([NotifyPropertyChanges],CalendarBase)})(),ej2_calendars_es2015_Calendar=(()=>{let Calendar=class extends ej2_calendars_es2015_CalendarBase{constructor(options,element){super(options,element)}render(){if("Islamic"===this.calendarMode&&void 0===this.islamicModule&&ej2_base_es2015_throwError("Requires the injectable Islamic modules to render Calendar in Islamic mode"),this.isMultiSelection&&"object"==typeof this.values&&!isNullOrUndefined(this.values)&&this.values.length>0){let tempValues=[],copyValues=[];for(let limit=0;limit<this.values.length;limit++)-1===tempValues.indexOf(+this.values[limit])&&(tempValues.push(+this.values[limit]),copyValues.push(this.values[limit]));this.setProperties({values:copyValues},!0);for(let index=0;index<this.values.length;index++)if(!this.checkDateValue(this.values[index]))if("string"==typeof this.values[index]&&this.checkDateValue(new Date(this.checkValue(this.values[index])))){let copyDate=new Date(this.checkValue(this.values[index]));this.values.splice(index,1),this.values.splice(index,0,copyDate)}else this.values.splice(index,1);this.setProperties({value:this.values[this.values.length-1]},!0),this.previousValues=this.values.length}if(this.validateDate(),this.minMaxUpdate(),super.render(),"calendar"===this.getModuleName()){let form=closest(this.element,"form");form&&EventHandler.add(form,"reset",this.formResetHandler.bind(this))}this.renderComplete()}formResetHandler(){this.setProperties({value:null},!0)}validateDate(){"string"==typeof this.value&&this.setProperties({value:this.checkDateValue(new Date(this.checkValue(this.value)))},!0),super.validateDate(this.value),!isNullOrUndefined(this.value)&&this.min<=this.max&&this.value>=this.min&&this.value<=this.max&&(this.currentDate=new Date(this.checkValue(this.value))),isNaN(+this.value)&&this.setProperties({value:null},!0)}minMaxUpdate(){"calendar"===this.getModuleName()&&(!isNullOrUndefined(this.value)&&this.value<=this.min&&this.min<=this.max?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!isNullOrUndefined(this.value)&&this.value>=this.max&&this.min<=this.max&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})),"calendar"===this.getModuleName()||isNullOrUndefined(this.value)?super.minMaxUpdate(this.value):!isNullOrUndefined(this.value)&&this.value<this.min&&this.min<=this.max?super.minMaxUpdate(this.min):!isNullOrUndefined(this.value)&&this.value>this.max&&this.min<=this.max&&super.minMaxUpdate(this.max)}generateTodayVal(value){let tempValue=new Date;return value?(tempValue.setHours(value.getHours()),tempValue.setMinutes(value.getMinutes()),tempValue.setSeconds(value.getSeconds()),tempValue.setMilliseconds(value.getMilliseconds())):tempValue=new Date(tempValue.getFullYear(),tempValue.getMonth(),tempValue.getDate(),0,0,0,0),tempValue}todayButtonClick(){if(this.showTodayButton){let tempValue=this.generateTodayVal(this.value);if(this.setProperties({value:tempValue},!0),this.isMultiSelection){let copyValues=this.copyValues(this.values);super.checkPresentDate(tempValue,this.values)||(copyValues.push(tempValue),this.setProperties({values:copyValues}))}super.todayButtonClick(new Date(+this.value))}}keyActionHandle(e){super.keyActionHandle(e,this.value,this.isMultiSelection)}preRender(){this.changeHandler=e=>{this.triggerChange(e)},this.checkView(),super.preRender(this.value)}createContent(){this.previousDate=this.value,super.createContent()}minMaxDate(localDate){return super.minMaxDate(localDate)}renderMonths(e){super.renderMonths(e,this.value)}renderDays(currentDate,e){let tempDays=super.renderDays(currentDate,e,this.value,this.isMultiSelection,this.values);return this.isMultiSelection&&super.validateValues(this.isMultiSelection,this.values),tempDays}renderYears(e){"Gregorian"===this.calendarMode?super.renderYears(e,this.value):this.islamicModule.islamicRenderYears(e,this.value)}renderDecades(e){"Gregorian"===this.calendarMode?super.renderDecades(e,this.value):this.islamicModule.islamicRenderDecade(e,this.value)}renderTemplate(elements,count,classNm,e){"Gregorian"===this.calendarMode?super.renderTemplate(elements,count,classNm,e,this.value):this.islamicModule.islamicRenderTemplate(elements,count,classNm,e,this.value),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}clickHandler(e){let eve=e.currentTarget;if(this.isPopupClicked=!0,eve.classList.contains(OTHERMONTH))if(this.isMultiSelection){let copyValues=this.copyValues(this.values);copyValues.push(this.getIdValue(e,null)),this.setProperties({values:copyValues},!0),this.setProperties({value:this.values[this.values.length-1]},!0)}else this.setProperties({value:this.getIdValue(e,null)},!0);let storeView=this.currentView();super.clickHandler(e,this.value),this.isMultiSelection&&this.currentDate!==this.value&&!isNullOrUndefined(this.tableBodyElement.querySelectorAll("."+FOCUSEDDATE)[0])&&"Year"===storeView&&this.tableBodyElement.querySelectorAll("."+FOCUSEDDATE)[0].classList.remove(FOCUSEDDATE)}switchView(view,e){super.switchView(view,e,this.isMultiSelection)}getModuleName(){return super.getModuleName(),"calendar"}getPersistData(){return super.getPersistData(),this.addOnPersist(["value","values"])}onPropertyChanged(newProp,oldProp){this.effect="";for(let prop of Object.keys(newProp))switch(prop){case"value":this.isDateSelected&&("string"==typeof newProp.value?this.setProperties({value:new Date(this.checkValue(newProp.value))},!0):newProp.value=new Date(this.checkValue(newProp.value)),isNaN(+this.value)&&this.setProperties({value:oldProp.value},!0),this.update());break;case"values":if(this.isDateSelected){if("string"==typeof newProp.values||"number"==typeof newProp.values)this.setProperties({values:null},!0);else{let copyValues=this.copyValues(this.values);for(let index=0;index<copyValues.length;index++){let tempDate=copyValues[index];this.checkDateValue(tempDate)&&!super.checkPresentDate(tempDate,copyValues)&&copyValues.push(tempDate)}this.setProperties({values:copyValues},!0),this.values.length>0&&this.setProperties({value:newProp.values[newProp.values.length-1]},!0)}this.validateValues(this.isMultiSelection,this.values),this.update()}break;case"isMultiSelection":this.isDateSelected&&(this.setProperties({isMultiSelection:newProp.isMultiSelection},!0),this.update());break;default:super.onPropertyChanged(newProp,oldProp,this.isMultiSelection,this.values)}}destroy(){if(super.destroy(),"calendar"===this.getModuleName()){let form=closest(this.element,"form");form&&EventHandler.remove(form,"reset",this.formResetHandler.bind(this))}}navigateTo(view,date){this.minMaxUpdate(),super.navigateTo(view,date)}currentView(){return super.currentView()}addDate(dates){if("string"!=typeof dates&&"number"!=typeof dates){let copyValues=this.copyValues(this.values);if("object"==typeof dates&&dates.length>0){let tempDates=dates;for(let i=0;i<tempDates.length;i++)this.checkDateValue(tempDates[i])&&!super.checkPresentDate(tempDates[i],copyValues)&&(!isNullOrUndefined(copyValues)&&copyValues.length>0?copyValues.push(tempDates[i]):copyValues=[new Date(+tempDates[i])])}else this.checkDateValue(dates)&&!super.checkPresentDate(dates,copyValues)&&(!isNullOrUndefined(copyValues)&&copyValues.length>0?copyValues.push(dates):copyValues=[new Date(+dates)]);this.setProperties({values:copyValues},!0),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.validateValues(this.isMultiSelection,copyValues),this.update(),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}}removeDate(dates){if("string"!=typeof dates&&"number"!=typeof dates&&!isNullOrUndefined(this.values)&&this.values.length>0){let copyValues=this.copyValues(this.values);if("object"==typeof dates&&dates.length>0){let tempDates=dates;for(let index=0;index<tempDates.length;index++)for(let i=0;i<copyValues.length;i++)+copyValues[i]==+tempDates[index]&&copyValues.splice(i,1)}else for(let i=0;i<copyValues.length;i++)+copyValues[i]==+dates&&copyValues.splice(i,1);this.setProperties({values:copyValues},!1),this.update(),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}}update(){this.validateDate(),this.minMaxUpdate(),super.setValueUpdate()}selectDate(e,date,element){super.selectDate(e,date,element,this.isMultiSelection,this.values),this.isMultiSelection&&!isNullOrUndefined(this.values)&&this.values.length>0&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler(e)}changeEvent(e){this.trigger("change",this.changedArgs),this.previousDate=new Date(+this.value)}triggerChange(e){this.changedArgs.event=e||null,this.changedArgs.isInteracted=!isNullOrUndefined(e),isNullOrUndefined(this.value)||this.setProperties({value:this.value},!0),this.isMultiSelection||+this.value===Number.NaN||+this.value==+this.previousDate?isNullOrUndefined(this.values)||this.previousValues===this.values.length||(this.changeEvent(e),this.previousValues=this.values.length):this.changeEvent(e)}};return __decorate([Property(null)],Calendar.prototype,"value",void 0),__decorate([Property(null)],Calendar.prototype,"values",void 0),__decorate([Property(!1)],Calendar.prototype,"isMultiSelection",void 0),__decorate([ej2_base_es2015_Event()],Calendar.prototype,"change",void 0),__decorate([NotifyPropertyChanges],Calendar)})();const ej2_calendars_es2015_containerAttr=["title","class","style"];let ej2_calendars_es2015_DatePicker=(()=>{let DatePicker=class extends ej2_calendars_es2015_Calendar{constructor(options,element){super(options,element),this.previousElementValue="",this.isDateIconClicked=!1,this.isAltKeyPressed=!1,this.isInteracted=!0,this.invalidValueString=null,this.checkPreviousValue=null,this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",tab:"tab"},this.datepickerOptions=options}render(){this.initialize(),this.bindEvents(),this.renderComplete()}setAllowEdit(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):attributes(this.inputElement,{readonly:""}),this.updateIconState()}updateIconState(){this.allowEdit||!this.inputWrapper||this.readonly?this.inputWrapper&&removeClass([this.inputWrapper.container],["e-non-edit"]):""===this.inputElement.value?removeClass([this.inputWrapper.container],["e-non-edit"]):addClass([this.inputWrapper.container],["e-non-edit"])}initialize(){this.checkInvalidValue(this.value),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setAllowEdit(),this.updateInput(),this.previousElementValue=this.inputElement.value,this.previousDate=new Date(+this.value),this.inputElement.setAttribute("value",this.inputElement.value),this.inputValueCopy=this.value}createInput(){let ariaAttrs={"aria-live":"assertive","aria-atomic":"true","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-invalid":"false"};if("datepicker"===this.getModuleName()){let l10nLocale={placeholder:this.placeholder};this.globalize=new Internationalization(this.locale),this.l10n=new L10n("datepicker",l10nLocale,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0)}this.inputWrapper=ej2_inputs_es2015_Input.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:this.cssClass,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:["e-input-group-icon e-date-icon e-icons"]},this.createElement),this.setWidth(this.width),this.inputElement.setAttribute("name",""!==this.inputElement.name?""+this.inputElement.getAttribute("name"):""+this.element.id),attributes(this.inputElement,ariaAttrs),this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1),ej2_inputs_es2015_Input.addAttributes({"aria-label":"select"},this.inputWrapper.buttons[0]),addClass([this.inputWrapper.container],"e-date-wrapper")}updateInput(){let formatOptions;if(this.value&&!this.isCalendar()&&this.disabledDates(),+new Date(this.checkValue(this.value))||this.setProperties({value:null},!0),this.strictMode&&(super.validateDate(),this.minMaxUpdates(),super.minMaxUpdate()),!isNullOrUndefined(this.value)){let dateString,dateValue=this.value,tempFormat=isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString;if(dateString="datetimepicker"===this.getModuleName()?this.globalize.formatDate(this.value,"Gregorian"===this.calendarMode?{format:tempFormat,type:"dateTime",skeleton:"yMd"}:{format:tempFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):this.globalize.formatDate(this.value,formatOptions="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),+dateValue<=+this.max&&+dateValue>=+this.min)ej2_inputs_es2015_Input.setValue(dateString,this.inputElement,this.floatLabelType,this.showClearButton);else{let value=+dateValue>=+this.max||!+this.value||!+this.value||+dateValue<=+this.min;!this.strictMode&&value&&ej2_inputs_es2015_Input.setValue(dateString,this.inputElement,this.floatLabelType,this.showClearButton)}}isNullOrUndefined(this.value)&&this.strictMode&&ej2_inputs_es2015_Input.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),!this.strictMode&&isNullOrUndefined(this.value)&&this.invalidValueString&&ej2_inputs_es2015_Input.setValue(this.invalidValueString,this.inputElement,this.floatLabelType,this.showClearButton),this.changedArgs={value:this.value},this.errorClass(),this.updateIconState()}minMaxUpdates(){!isNullOrUndefined(this.value)&&this.value<this.min&&this.min<=this.max&&this.strictMode?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!isNullOrUndefined(this.value)&&this.value>this.max&&this.min<=this.max&&this.strictMode&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})}checkStringValue(val){let returnDate=null,formatOptions=null,formatDateTime=null;if("datetimepicker"===this.getModuleName()){let culture=new Internationalization(this.locale);"Gregorian"===this.calendarMode?(formatOptions={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},formatDateTime={format:culture.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(formatOptions={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},formatDateTime={format:culture.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else formatOptions="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};return isNullOrUndefined(returnDate=this.checkDateValue(this.globalize.parseDate(val,formatOptions)))&&"datetimepicker"===this.getModuleName()&&(returnDate=this.checkDateValue(this.globalize.parseDate(val,formatDateTime))),returnDate}checkInvalidValue(value){if(!(value instanceof Date||isNullOrUndefined(value))){let valueDate=null,valueString=value;"number"==typeof value&&(valueString=value.toString());let formatOptions=null,formatDateTime=null;if("datetimepicker"===this.getModuleName()){let culture=new Internationalization(this.locale);"Gregorian"===this.calendarMode?(formatOptions={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},formatDateTime={format:culture.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(formatOptions={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},formatDateTime={format:culture.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else formatOptions="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};let invalid=!1;if("string"!=typeof valueString)valueString=null,invalid=!0;else if("string"==typeof valueString&&(valueString=valueString.trim()),!(valueDate=this.checkStringValue(valueString))){let extISOString=null,basicISOString=null;basicISOString=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!(extISOString=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/).test(valueString)&&!basicISOString.test(valueString)||/^[a-zA-Z0-9- ]*$/.test(valueString)||isNaN(+new Date(this.checkValue(valueString)))?invalid=!0:valueDate=new Date(valueString)}invalid?(this.strictMode||(this.invalidValueString=valueString),this.setProperties({value:null},!0)):this.setProperties({value:valueDate},!0)}}bindInputEvent(){isNullOrUndefined(this.formatString)||(-1===this.formatString.indexOf("y")?EventHandler.add(this.inputElement,"input",this.inputHandler,this):EventHandler.remove(this.inputElement,"input",this.inputHandler))}bindEvents(){this.enabled?(EventHandler.add(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateIconHandler,this),EventHandler.add(this.inputElement,"focus",this.inputFocusHandler,this),EventHandler.add(this.inputElement,"blur",this.inputBlurHandler,this),this.bindInputEvent(),EventHandler.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&EventHandler.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this),this.formElement&&EventHandler.add(this.formElement,"reset",this.resetFormHandler,this)):(EventHandler.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateIconHandler),EventHandler.remove(this.inputElement,"focus",this.inputFocusHandler),EventHandler.remove(this.inputElement,"blur",this.inputBlurHandler),EventHandler.remove(this.inputElement,"change",this.inputChangeHandler),this.showClearButton&&this.inputWrapper.clearButton&&EventHandler.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.formElement&&EventHandler.remove(this.formElement,"reset",this.resetFormHandler)),this.defaultKeyConfigs=extend(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModules=new ej2_base_es2015_KeyboardEvents(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})}resetFormHandler(){if(!this.inputElement.disabled){let value=this.inputElement.getAttribute("value");"EJS-DATEPICKER"!==this.element.tagName&&"EJS-DATETIMEPICKER"!==this.element.tagName||(value="",this.inputValueCopy=null,this.inputElement.setAttribute("value","")),this.setProperties({value:this.inputValueCopy},!0),this.restoreValue(),this.inputElement&&(ej2_inputs_es2015_Input.setValue(value,this.inputElement,this.floatLabelType,this.showClearButton),this.errorClass())}}restoreValue(){this.currentDate=this.value?this.value:new Date,this.previousDate=this.value,this.previousElementValue=isNullOrUndefined(this.inputValueCopy)?"":this.globalize.formatDate(this.inputValueCopy,{format:this.formatString,type:"dateTime",skeleton:"yMd"})}inputChangeHandler(e){e.stopPropagation()}bindClearEvent(){this.showClearButton&&this.inputWrapper.clearButton&&EventHandler.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)}resetHandler(e){e.preventDefault(),this.clear(e)}clear(event){this.setProperties({value:null},!0),ej2_inputs_es2015_Input.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.invalidValueString="",this.updateInput(),this.popupUpdate(),this.changeEvent(event)}dateIconHandler(e){Browser.isDevice&&(this.inputElement.setAttribute("readonly",""),this.inputElement.blur()),e.preventDefault(),this.readonly||(this.isCalendar()?this.hide(e):(this.isDateIconClicked=!0,this.show(null,e),"datetimepicker"===this.getModuleName()&&this.inputElement.focus(),this.inputElement.focus(),addClass([this.inputWrapper.container],["e-input-focus"]),addClass(this.inputWrapper.buttons,"e-active")))}updateHtmlAttributeToWrapper(){if(!isNullOrUndefined(this.htmlAttributes))for(let key of Object.keys(this.htmlAttributes))if(ej2_calendars_es2015_containerAttr.indexOf(key)>-1)if("class"===key)addClass([this.inputWrapper.container],this.htmlAttributes[key].split(" "));else if("style"===key){let setStyle=this.inputWrapper.container.getAttribute(key);setStyle=isNullOrUndefined(setStyle)?this.htmlAttributes[key]:setStyle+this.htmlAttributes[key],this.inputWrapper.container.setAttribute(key,setStyle)}else this.inputWrapper.container.setAttribute(key,this.htmlAttributes[key])}updateHtmlAttributeToElement(){if(!isNullOrUndefined(this.htmlAttributes))for(let key of Object.keys(this.htmlAttributes))ej2_calendars_es2015_containerAttr.indexOf(key)<0&&this.inputElement.setAttribute(key,this.htmlAttributes[key])}CalendarKeyActionHandle(e){switch(e.action){case"escape":this.isCalendar()?this.hide(e):this.inputWrapper.container.children[this.index].blur();break;case"enter":this.isCalendar()?+this.value==+this.currentDate||this.isCalendar()||this.inputWrapper.container.children[this.index].focus():this.show(null,e),"datetimepicker"===this.getModuleName()&&this.inputElement.focus();break;case"tab":this.hide(e)}}inputFocusHandler(){let focusArguments={model:this};this.isDateIconClicked=!1,this.trigger("focus",focusArguments),this.updateIconState()}inputHandler(e){this.isPopupClicked=!1}inputBlurHandler(e){this.strictModeUpdate(),""===this.inputElement.value&&isNullOrUndefined(this.value)&&(this.invalidValueString=null,ej2_inputs_es2015_Input.setValue("",this.inputElement,this.floatLabelType,this.showClearButton)),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass(),this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),"datepicker"===this.getModuleName()&&this.trigger("blur",{model:this}),this.isCalendar()&&(this.defaultKeyConfigs=extend(this.defaultKeyConfigs,this.keyConfigs),this.calendarKeyboardModules=new ej2_base_es2015_KeyboardEvents(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.CalendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})),this.isPopupClicked=!1}documentHandler(e){"touchstart"!==e.type&&e.preventDefault();let target=e.target;closest(target,".e-datepicker.e-popup-wrapper")||closest(target,".e-input-group")===this.inputWrapper.container||target.classList.contains("e-day")?closest(target,".e-datepicker.e-popup-wrapper")&&(target.classList.contains("e-day")&&!isNullOrUndefined(e.target.parentElement)&&e.target.parentElement.classList.contains("e-selected")&&closest(target,".e-content")&&closest(target,".e-content").classList.contains("e-"+this.depth.toLowerCase())?this.hide(e):closest(target,".e-footer-container")&&target.classList.contains("e-today")&&target.classList.contains("e-btn")&&+new Date(+this.value)==+super.generateTodayVal(this.value)&&this.hide(e)):(this.hide(e),this.focusOut())}inputKeyActionHandle(e){let clickedView=this.currentView();switch(e.action){case"altUpArrow":this.isAltKeyPressed=!1,this.hide(e),this.inputElement.focus();break;case"altDownArrow":this.isAltKeyPressed=!0,this.strictModeUpdate(),this.updateInput(),this.changeTrigger(e),"datepicker"===this.getModuleName()&&this.show(null,e);break;case"escape":this.hide(e);break;case"enter":this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass(),this.isCalendar()||document.activeElement!==this.inputElement||this.hide(e),this.isCalendar()&&(e.preventDefault(),e.stopPropagation());break;case"tab":this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass(),this.hide(e);break;default:this.defaultAction(e),"select"===e.action&&clickedView===this.depth&&this.hide(e)}}defaultAction(e){this.previousDate=!isNullOrUndefined(this.value)&&new Date(+this.value)||null,this.isCalendar()&&(super.keyActionHandle(e),attributes(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()}))}popupUpdate(){if((isNullOrUndefined(this.value)&&!isNullOrUndefined(this.previousDate)||+this.value!=+this.previousDate)&&(this.popupObj&&this.popupObj.element.querySelectorAll(".e-selected").length>0&&removeClass(this.popupObj.element.querySelectorAll(".e-selected"),["e-selected"]),!isNullOrUndefined(this.value)&&+this.value>=+this.min&&+this.value<=+this.max)){let targetdate=new Date(this.checkValue(this.value));super.navigateTo("Month",targetdate)}}strictModeUpdate(){let format,formatOptions,dateOptions,date;format="datetimepicker"===this.getModuleName()?isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString:isNullOrUndefined(this.formatString)?this.formatString:this.formatString.replace("dd","d"),isNullOrUndefined(format)||format.split("M").length-1<3&&(format=format.replace("MM","M")),dateOptions="datetimepicker"===this.getModuleName()?"Gregorian"===this.calendarMode?{format:isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:formatOptions="Gregorian"===this.calendarMode?{format:format,type:"dateTime",skeleton:"yMd"}:{format:format,type:"dateTime",skeleton:"yMd",calendar:"islamic"},"string"==typeof this.inputElement.value&&(this.inputElement.value=this.inputElement.value.trim()),"datetimepicker"===this.getModuleName()?date=this.checkDateValue(this.globalize.parseDate(this.inputElement.value,dateOptions))?this.globalize.parseDate(this.inputElement.value,dateOptions):this.globalize.parseDate(this.inputElement.value,formatOptions="Gregorian"===this.calendarMode?{type:"dateTime",skeleton:"yMd"}:{type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(date=this.globalize.parseDate(this.inputElement.value,dateOptions),!isNullOrUndefined(this.formatString)&&""!==this.inputElement.value&&this.strictMode&&(this.isPopupClicked||!this.isPopupClicked&&this.inputElement.value===this.previousElementValue)&&-1===this.formatString.indexOf("y")&&date.setFullYear(this.value.getFullYear())),this.strictMode&&date?(ej2_inputs_es2015_Input.setValue(this.globalize.formatDate(date,dateOptions),this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.value!==this.previousElementValue&&this.setProperties({value:date},!0)):this.strictMode||this.inputElement.value!==this.previousElementValue&&this.setProperties({value:date},!0),this.strictMode&&!date&&""===this.inputElement.value&&this.setProperties({value:null},!0),isNaN(+this.value)&&this.setProperties({value:null},!0),isNullOrUndefined(this.value)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0)))}createCalendar(){this.popupWrapper=this.createElement("div",{className:"e-datepicker e-popup-wrapper"}),isNullOrUndefined(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),Browser.isDevice&&(this.modelHeader(),this.modal=this.createElement("div"),this.modal.className="e-datepicker e-date-modal",document.body.className+=" e-date-overflow",this.modal.style.display="block",document.body.appendChild(this.modal)),this.calendarElement.querySelector("table tbody").className="",this.popupObj=new ej2_popups_es2015_Popup(this.popupWrapper,{content:this.calendarElement,relateTo:Browser.isDevice?document.body:this.inputWrapper.container,position:Browser.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},offsetY:4,targetType:"container",enableRtl:this.enableRtl,zIndex:this.zIndex,collision:Browser.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},open:()=>{"datetimepicker"!==this.getModuleName()&&document.activeElement!==this.inputElement&&(this.defaultKeyConfigs=extend(this.defaultKeyConfigs,this.keyConfigs),this.calendarElement.children[1].firstElementChild.focus(),this.calendarKeyboardModules=new ej2_base_es2015_KeyboardEvents(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.CalendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}),this.calendarKeyboardModules=new ej2_base_es2015_KeyboardEvents(this.inputWrapper.container.children[this.index],{eventName:"keydown",keyAction:this.CalendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}))},close:()=>{this.isDateIconClicked&&this.inputWrapper.container.children[this.index].focus(),this.value&&this.disabledDates(),this.popupObj&&this.popupObj.destroy(),detach(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.setAriaAttributes()}}),this.popupObj.element.className+=" "+this.cssClass,this.setAriaAttributes()}setAriaDisabled(){this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1)}modelHeader(){let dateOptions,modelHeader=this.createElement("div",{className:"e-model-header"}),yearHeading=this.createElement("h1",{className:"e-model-year"}),h2=this.createElement("div"),daySpan=this.createElement("span",{className:"e-model-day"}),monthSpan=this.createElement("span",{className:"e-model-month"});dateOptions="Gregorian"===this.calendarMode?{format:"y",skeleton:"dateTime"}:{format:"y",skeleton:"dateTime",calendar:"islamic"},yearHeading.textContent=""+this.globalize.formatDate(this.value||new Date,dateOptions),dateOptions="Gregorian"===this.calendarMode?{format:"E",skeleton:"dateTime"}:{format:"E",skeleton:"dateTime",calendar:"islamic"},daySpan.textContent=this.globalize.formatDate(this.value||new Date,dateOptions)+", ",dateOptions="Gregorian"===this.calendarMode?{format:"MMM d",skeleton:"dateTime"}:{format:"MMM d",skeleton:"dateTime",calendar:"islamic"},monthSpan.textContent=""+this.globalize.formatDate(this.value||new Date,dateOptions),modelHeader.appendChild(yearHeading),h2.appendChild(daySpan),h2.appendChild(monthSpan),modelHeader.appendChild(h2),this.calendarElement.insertBefore(modelHeader,this.calendarElement.firstElementChild)}changeTrigger(event){this.inputElement.value!==this.previousElementValue&&(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.changedArgs.value=this.value,this.changedArgs.event=event||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=!isNullOrUndefined(event),this.trigger("change",this.changedArgs),this.previousElementValue=this.inputElement.value,this.previousDate=isNaN(+new Date(this.checkValue(this.value)))?null:new Date(this.checkValue(this.value)),this.isInteracted=!0)}navigatedEvent(){this.trigger("navigated",this.navigatedArgs)}changeEvent(event){(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.selectCalendar(event),this.changedArgs.event=event||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=this.isInteracted,this.trigger("change",this.changedArgs),this.previousDate=this.value&&new Date(+this.value),this.hide(event),this.previousElementValue=this.inputElement.value,this.errorClass())}requiredModules(){let modules=[];return this&&modules.push({args:[this],member:"islamic"}),modules}selectCalendar(e){let date,tempFormat,formatOptions;tempFormat="datetimepicker"===this.getModuleName()&&isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString,this.value&&(date="datetimepicker"===this.getModuleName()?this.globalize.formatDate(this.changedArgs.value,formatOptions="Gregorian"===this.calendarMode?{format:tempFormat,type:"dateTime",skeleton:"yMd"}:{format:tempFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):this.globalize.formatDate(this.changedArgs.value,formatOptions="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"})),isNullOrUndefined(date)||ej2_inputs_es2015_Input.setValue(date,this.inputElement,this.floatLabelType,this.showClearButton)}isCalendar(){return!(!this.popupWrapper||!this.popupWrapper.classList.contains("e-popup-wrapper"))}setWidth(width){this.inputWrapper.container.style.width="number"==typeof width?formatUnit(this.width):"string"==typeof width?width.match(/px|%|em/)?this.width:formatUnit(this.width):"100%"}show(type,e){if(!(this.enabled&&this.readonly||!this.enabled||this.popupObj)){let outOfRange,prevent=!0;isNullOrUndefined(this.value)||+this.value>=+this.min&&+this.value<=+this.max?outOfRange=this.value||null:(outOfRange=new Date(this.checkValue(this.value)),this.setProperties({value:null},!0)),this.isCalendar()||(super.render(),this.setProperties({value:outOfRange||null},!0),this.previousDate=outOfRange,this.createCalendar()),Browser.isDevice&&(this.mobilePopupWrapper=this.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupWrapper)),this.preventArgs={preventDefault:()=>{prevent=!1},popup:this.popupObj,event:e||null,cancel:!1,appendTo:Browser.isDevice?this.mobilePopupWrapper:document.body},this.trigger("open",this.preventArgs,eventArgs=>{this.preventArgs=eventArgs,prevent&&!this.preventArgs.cancel?(addClass(this.inputWrapper.buttons,"e-active"),this.preventArgs.appendTo.appendChild(this.popupWrapper),this.popupObj.refreshPosition(this.inputElement),this.popupObj.show(new ej2_base_es2015_Animation({name:"FadeIn",duration:Browser.isDevice?0:300}),1e3===this.zIndex?this.element:null),super.setOverlayIndex(this.mobilePopupWrapper,this.popupObj.element,this.modal,Browser.isDevice),this.setAriaAttributes()):(this.popupObj.destroy(),this.popupWrapper=this.popupObj=null),EventHandler.add(document,"mousedown touchstart",this.documentHandler,this)})}}hide(event){if(isNullOrUndefined(this.popupWrapper))Browser.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit();else{let prevent=!0;this.preventArgs={preventDefault:()=>{prevent=!1},popup:this.popupObj,event:event||null,cancel:!1},removeClass(this.inputWrapper.buttons,"e-active"),removeClass([document.body],"e-date-overflow");let eventArgs=this.preventArgs;this.isCalendar()?this.trigger("close",eventArgs,eventArgs=>{this.closeEventCallback(prevent,eventArgs)}):this.closeEventCallback(prevent,eventArgs)}}closeEventCallback(prevent,eventArgs){this.preventArgs=eventArgs,this.isCalendar()&&prevent&&!this.preventArgs.cancel&&(this.popupObj.hide(),this.isAltKeyPressed=!1,this.keyboardModule.destroy(),removeClass(this.inputWrapper.buttons,"e-active")),this.setAriaAttributes(),Browser.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),Browser.isDevice&&(isNullOrUndefined(this.mobilePopupWrapper)||(this.mobilePopupWrapper.remove(),this.mobilePopupWrapper=null)),EventHandler.remove(document,"mousedown touchstart",this.documentHandler),Browser.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}focusIn(triggerEvent){document.activeElement!==this.inputElement&&this.enabled&&(this.inputElement.focus(),addClass([this.inputWrapper.container],["e-input-focus"]))}focusOut(){document.activeElement===this.inputElement&&(removeClass([this.inputWrapper.container],["e-input-focus"]),this.inputElement.blur())}currentView(){let currentView;return this.calendarElement&&(currentView=super.currentView()),currentView}navigateTo(view,date){this.calendarElement&&super.navigateTo(view,date)}destroy(){super.destroy(),this.keyboardModules.destroy(),this.popupObj&&this.popupObj.element.classList.contains("e-popup")&&super.destroy(),this.inputElement&&(ej2_inputs_es2015_Input.removeAttributes({"aria-live":"assertive","aria-atomic":"true","aria-disabled":"true","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},this.inputElement),isNullOrUndefined(this.inputElementCopy.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),EventHandler.remove(this.inputElement,"blur",this.inputBlurHandler),EventHandler.remove(this.inputElement,"focus",this.inputFocusHandler),this.ensureInputAttribute()),this.isCalendar()&&(this.popupWrapper&&detach(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.keyboardModule.destroy()),null===this.ngTag&&(this.inputElement&&(this.inputWrapper.container.insertAdjacentElement("afterend",this.inputElement),removeClass([this.inputElement],["e-input"])),removeClass([this.element],["e-datepicker"]),detach(this.inputWrapper.container)),this.formElement&&EventHandler.remove(this.formElement,"reset",this.resetFormHandler)}ensureInputAttribute(){let prop=[];for(let i=0;i<this.inputElement.attributes.length;i++)prop[i]=this.inputElement.attributes[i].name;for(let i=0;i<prop.length;i++)isNullOrUndefined(this.inputElementCopy.getAttribute(prop[i]))?("value"===prop[i].toLowerCase()&&(this.inputElement.value=""),this.inputElement.removeAttribute(prop[i])):("value"===prop[i].toLowerCase()&&(this.inputElement.value=this.inputElementCopy.getAttribute(prop[i])),this.inputElement.setAttribute(prop[i],this.inputElementCopy.getAttribute(prop[i])))}preRender(){this.inputElementCopy=this.element.cloneNode(!0),removeClass([this.inputElementCopy],["e-datepicker","e-control","e-lib"]),this.inputElement=this.element,this.formElement=closest(this.inputElement,"form"),this.index=this.showClearButton?2:1,this.ngTag=null,"EJS-DATEPICKER"!==this.element.tagName&&"EJS-DATETIMEPICKER"!==this.element.tagName||(this.ngTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.element.getAttribute("id")?null!==this.ngTag&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):"datetimepicker"===this.getModuleName()?(this.element.id=getUniqueID("ej2-datetimepicker"),null!==this.ngTag&&attributes(this.inputElement,{id:this.element.id+"_input"})):(this.element.id=getUniqueID("ej2-datepicker"),null!==this.ngTag&&attributes(this.inputElement,{id:this.element.id+"_input"})),null!==this.ngTag&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.checkHtmlAttributes(!1),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),super.preRender()}validationAttribute(target,inputElement){let nameAttribute=target.getAttribute("name")?target.getAttribute("name"):target.getAttribute("id");inputElement.setAttribute("name",nameAttribute),target.removeAttribute("name");let attribute=["required","aria-required","form"];for(let i=0;i<attribute.length;i++){if(isNullOrUndefined(target.getAttribute(attribute[i])))continue;let attr=target.getAttribute(attribute[i]);inputElement.setAttribute(attribute[i],attr),target.removeAttribute(attribute[i])}}checkFormat(){let culture=new Internationalization(this.locale);if(this.format)if("string"==typeof this.format)this.formatString=this.format;else if(""===this.format.skeleton||isNullOrUndefined(this.format.skeleton))this.formatString="datetimepicker"===this.getModuleName()?this.dateTimeFormat:null;else{let skeletonString=this.format.skeleton;this.formatString="datetimepicker"===this.getModuleName()?culture.getDatePattern({skeleton:skeletonString,type:"dateTime"}):culture.getDatePattern({skeleton:skeletonString,type:"date"})}else this.formatString=null}checkHtmlAttributes(dynamic){this.globalize=new Internationalization(this.locale),this.checkFormat(),this.checkView();let options,attributes$$1=dynamic?isNullOrUndefined(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","disabled","readonly","style","name","placeholder","type"];options="datetimepicker"===this.getModuleName()?"Gregorian"===this.calendarMode?{format:isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:"Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(let prop of attributes$$1)if(!isNullOrUndefined(this.inputElement.getAttribute(prop)))switch(prop){case"disabled":if(isNullOrUndefined(this.datepickerOptions)||void 0===this.datepickerOptions.enabled||dynamic){let enabled="disabled"!==this.inputElement.getAttribute(prop)&&""!==this.inputElement.getAttribute(prop)&&"true"!==this.inputElement.getAttribute(prop);this.setProperties({enabled:enabled},!dynamic)}break;case"readonly":if(isNullOrUndefined(this.datepickerOptions)||void 0===this.datepickerOptions.readonly||dynamic){let readonly="readonly"===this.inputElement.getAttribute(prop)||""===this.inputElement.getAttribute(prop)||"true"===this.inputElement.getAttribute(prop);this.setProperties({readonly:readonly},!dynamic)}break;case"placeholder":(isNullOrUndefined(this.datepickerOptions)||void 0===this.datepickerOptions.placeholder||dynamic)&&(this.inputElement.getAttribute(prop),this.setProperties({placeholder:this.inputElement.getAttribute(prop)},!dynamic));break;case"style":this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(prop));break;case"name":this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(prop));break;case"value":if(isNullOrUndefined(this.datepickerOptions)||void 0===this.datepickerOptions.value||dynamic){let value=this.inputElement.getAttribute(prop);this.setProperties(setValue(prop,this.globalize.parseDate(value,options),{}),!dynamic)}break;case"min":if(+this.min==+new Date(1900,0,1)||dynamic){let min=this.inputElement.getAttribute(prop);this.setProperties(setValue(prop,this.globalize.parseDate(min),{}),!dynamic)}break;case"max":if(+this.max==+new Date(2099,11,31)||dynamic){let max=this.inputElement.getAttribute(prop);this.setProperties(setValue(prop,this.globalize.parseDate(max),{}),!dynamic)}break;case"type":"text"!==this.inputElement.getAttribute(prop)&&this.inputElement.setAttribute("type","text")}}getModuleName(){return"datepicker"}disabledDates(){let valueCopy,formatOptions,globalize;valueCopy=this.checkDateValue(this.value)?new Date(+this.value):new Date(this.checkValue(this.value));let previousValCopy=this.previousDate;this.minMaxUpdates(),super.render(),this.previousDate=previousValCopy;let inputVal,dateIdString='*[id^="/id"]'.replace("/id",""+(valueCopy&&+valueCopy));this.strictMode||("string"==typeof this.value||"object"==typeof this.value&&+this.value!=+valueCopy)&&this.setProperties({value:valueCopy},!0),isNullOrUndefined(this.calendarElement.querySelectorAll(dateIdString)[0])||this.calendarElement.querySelectorAll(dateIdString)[0].classList.contains("e-disabled")&&(this.strictMode||(this.currentDate=new Date((new Date).setHours(0,0,0,0)))),inputVal="datetimepicker"===this.getModuleName()?globalize=this.globalize.formatDate(valueCopy,"Gregorian"===this.calendarMode?{format:isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:isNullOrUndefined(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):this.globalize.formatDate(valueCopy,formatOptions="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),this.popupObj||ej2_inputs_es2015_Input.setValue(inputVal,this.inputElement,this.floatLabelType,this.showClearButton)}setAriaAttributes(){this.isCalendar()?(ej2_inputs_es2015_Input.addAttributes({"aria-expanded":"true"},this.inputElement),attributes(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()})):(ej2_inputs_es2015_Input.addAttributes({"aria-expanded":"false"},this.inputElement),attributes(this.inputElement,{"aria-activedescendant":"null"}))}errorClass(){let dateIdString='*[id^="/id"]'.replace("/id",""+ +this.value),isDisabledDate=this.calendarElement&&this.calendarElement.querySelectorAll(dateIdString)[0]&&this.calendarElement.querySelectorAll(dateIdString)[0].classList.contains("e-disabled");!isNullOrUndefined(this.value)&&!(+new Date(+this.value).setMilliseconds(0)>=+this.min&&+new Date(+this.value).setMilliseconds(0)<=+this.max)||!this.strictMode&&""!==this.inputElement.value&&isNullOrUndefined(this.value)||isDisabledDate?(addClass([this.inputWrapper.container],"e-error"),attributes(this.inputElement,{"aria-invalid":"true"})):(removeClass([this.inputWrapper.container],"e-error"),attributes(this.inputElement,{"aria-invalid":"false"}))}onPropertyChanged(newProp,oldProp){let options;options="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(let prop of Object.keys(newProp)){switch(prop){case"value":this.isInteracted=!1,this.invalidValueString=null,this.checkInvalidValue(newProp.value),newProp.value=this.value,this.previousElementValue=this.inputElement.value,isNullOrUndefined(this.value)&&(ej2_inputs_es2015_Input.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.currentDate=new Date((new Date).setHours(0,0,0,0))),this.updateInput(),+this.previousDate!=+this.value&&this.changeTrigger(null);break;case"format":this.checkFormat(),this.bindInputEvent(),this.updateInput();break;case"allowEdit":this.setAllowEdit();break;case"placeholder":ej2_inputs_es2015_Input.setPlaceholder(this.placeholder,this.inputElement);break;case"readonly":ej2_inputs_es2015_Input.setReadonly(this.readonly,this.inputElement);break;case"enabled":ej2_inputs_es2015_Input.setEnabled(this.enabled,this.inputElement),this.setAriaDisabled(),this.bindEvents();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkHtmlAttributes(!0);break;case"locale":this.globalize=new Internationalization(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),ej2_inputs_es2015_Input.setPlaceholder(this.placeholder,this.inputElement),this.updateInput();break;case"enableRtl":ej2_inputs_es2015_Input.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"start":case"depth":this.checkView(),this.calendarElement&&super.onPropertyChanged(newProp,oldProp);break;case"zIndex":this.setProperties({zIndex:newProp.zIndex},!0);break;case"cssClass":ej2_inputs_es2015_Input.setCssClass(newProp.cssClass,[this.inputWrapper.container],oldProp.cssClass),this.popupWrapper&&ej2_inputs_es2015_Input.setCssClass(newProp.cssClass,[this.popupWrapper],oldProp.cssClass);break;case"showClearButton":ej2_inputs_es2015_Input.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent();break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(newProp.width);break;case"floatLabelType":this.floatLabelType=newProp.floatLabelType,ej2_inputs_es2015_Input.removeFloating(this.inputWrapper),ej2_inputs_es2015_Input.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;default:this.calendarElement&&super.onPropertyChanged(newProp,oldProp)}this.hide(null)}}};return __decorate([Property(null)],DatePicker.prototype,"width",void 0),__decorate([Property(null)],DatePicker.prototype,"cssClass",void 0),__decorate([Property(!1)],DatePicker.prototype,"strictMode",void 0),__decorate([Property(null)],DatePicker.prototype,"format",void 0),__decorate([Property(!0)],DatePicker.prototype,"enabled",void 0),__decorate([Property({})],DatePicker.prototype,"htmlAttributes",void 0),__decorate([Property(null)],DatePicker.prototype,"values",void 0),__decorate([Property(!1)],DatePicker.prototype,"isMultiSelection",void 0),__decorate([Property(!0)],DatePicker.prototype,"showClearButton",void 0),__decorate([Property(!0)],DatePicker.prototype,"allowEdit",void 0),__decorate([Property(null)],DatePicker.prototype,"keyConfigs",void 0),__decorate([Property(!1)],DatePicker.prototype,"enablePersistence",void 0),__decorate([Property(1e3)],DatePicker.prototype,"zIndex",void 0),__decorate([Property(!1)],DatePicker.prototype,"readonly",void 0),__decorate([Property(null)],DatePicker.prototype,"placeholder",void 0),__decorate([Property("Never")],DatePicker.prototype,"floatLabelType",void 0),__decorate([ej2_base_es2015_Event()],DatePicker.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],DatePicker.prototype,"close",void 0),__decorate([ej2_base_es2015_Event()],DatePicker.prototype,"blur",void 0),__decorate([ej2_base_es2015_Event()],DatePicker.prototype,"focus",void 0),__decorate([ej2_base_es2015_Event()],DatePicker.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],DatePicker.prototype,"destroyed",void 0),__decorate([NotifyPropertyChanges],DatePicker)})();var ej2_calendars_es2015_TimePickerBase;(ej2_calendars_es2015_TimePickerBase||(ej2_calendars_es2015_TimePickerBase={})).createListItems=function(createdEl,min,max,globalize,timeFormat,step){let start,end,interval=6e4*step,listItems=[],timeCollections=[];for(start=+min.setMilliseconds(0),end=+max.setMilliseconds(0);end>=start;)timeCollections.push(start),listItems.push(globalize.formatDate(new Date(start),{format:timeFormat,type:"time"})),start+=interval;return{collection:timeCollections,list:ej2_lists_es2015_ListBase.createList(createdEl,listItems,null,!0)}};const DAY$1=(new Date).getDate(),MONTH$3=(new Date).getMonth(),YEAR$3=(new Date).getFullYear(),HOUR=(new Date).getHours(),MINUTE=(new Date).getMinutes(),SECOND=(new Date).getSeconds(),MILLISECOND=(new Date).getMilliseconds(),ROOT$4="e-datetimepicker",LISTCLASS$2=ej2_lists_es2015_cssClass.li;let ej2_calendars_es2015_DateTimePicker=(()=>{let DateTimePicker=class extends ej2_calendars_es2015_DatePicker{constructor(options,element){super(options,element),this.valueWithMinutes=null,this.previousDateTime=null,this.dateTimeOptions=options}focusHandler(){addClass([this.inputWrapper.container],"e-input-focus")}focusIn(){super.focusIn()}focusOut(){document.activeElement===this.inputElement&&(this.inputElement.blur(),removeClass([this.inputWrapper.container],["e-input-focus"]))}blurHandler(e){if(this.isTimePopupOpen()&&this.isPreventBlur)return void this.inputElement.focus();removeClass([this.inputWrapper.container],"e-input-focus");let blurArguments={model:this};this.isTimePopupOpen()&&this.hide(e),this.trigger("blur",blurArguments)}destroy(){this.popupObject&&this.popupObject.element.classList.contains("e-popup")&&(this.dateTimeWrapper=void 0,this.liCollections=this.timeCollections=[],isNullOrUndefined(this.rippleFn)||this.rippleFn()),this.inputElement&&(ej2_inputs_es2015_Input.removeAttributes({"aria-live":"assertive","aria-atomic":"true","aria-invalid":"false","aria-haspopup":"true","aria-activedescendant":"null",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off"},this.inputElement),this.inputElement.removeAttribute("aria-placeholder")),this.isCalendar()&&(this.popupWrapper&&detach(this.popupWrapper),this.popupObject=this.popupWrapper=null,this.keyboardHandler.destroy()),this.unBindInputEvents(),super.destroy()}render(){this.timekeyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.valueWithMinutes=null,this.previousDateTime=null,this.isPreventBlur=!1,this.cloneElement=this.element.cloneNode(!0),this.dateTimeFormat=this.cldrDateTimeFormat(),this.initValue=this.value,super.updateHtmlAttributeToElement(),this.checkAttributes(!1),this.l10n=new L10n("datetimepicker",{placeholder:this.placeholder},this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),super.render(),this.createInputElement(),super.updateHtmlAttributeToWrapper(),this.bindInputEvents(),this.setValue(),this.previousDateTime=this.value&&new Date(+this.value),"EJS-DATETIMEPICKER"===this.element.tagName&&(this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.enabled||(this.inputElement.tabIndex=-1)),this.renderComplete()}setValue(){if(this.initValue=this.validateMinMaxRange(this.value),!this.strictMode&&this.isDateObject(this.initValue)){let value=this.validateMinMaxRange(this.initValue);ej2_inputs_es2015_Input.setValue(this.getFormattedValue(value),this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:value},!0)}else isNullOrUndefined(this.value)&&(this.initValue=null,this.setProperties({value:null},!0));this.valueWithMinutes=this.value,super.updateInput()}validateMinMaxRange(value){let result=value;return this.isDateObject(value)?result=this.validateValue(value):+this.min>+this.max&&this.disablePopupButton(!0),this.checkValidState(result),result}checkValidState(value){this.isValidState=!0,this.strictMode||(+value>+this.max||+value<+this.min)&&(this.isValidState=!1),this.checkErrorState()}checkErrorState(){this.isValidState?removeClass([this.inputWrapper.container],"e-error"):addClass([this.inputWrapper.container],"e-error"),attributes(this.inputElement,{"aria-invalid":this.isValidState?"false":"true"})}validateValue(value){let dateVal=value;return this.strictMode?+this.min>+this.max?(this.disablePopupButton(!0),dateVal=this.max):+value<+this.min?dateVal=this.min:+value>+this.max&&(dateVal=this.max):+this.min>+this.max&&(this.disablePopupButton(!0),dateVal=value),dateVal}disablePopupButton(isDisable){isDisable?(addClass([this.inputWrapper.buttons[0],this.timeIcon],"e-disabled"),this.hide()):removeClass([this.inputWrapper.buttons[0],this.timeIcon],"e-disabled")}getFormattedValue(value){let dateOptions;return isNullOrUndefined(value)?null:(dateOptions="Gregorian"===this.calendarMode?{format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd"}:{format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd",calendar:"islamic"},this.globalize.formatDate(value,dateOptions))}isDateObject(value){return!isNullOrUndefined(value)&&!isNaN(+value)}createInputElement(){removeClass([this.inputElement],"e-datepicker"),removeClass([this.inputWrapper.container],"e-date-wrapper"),addClass([this.inputWrapper.container],"e-datetime-wrapper"),addClass([this.inputElement],ROOT$4),this.renderTimeIcon()}renderTimeIcon(){this.timeIcon=ej2_inputs_es2015_Input.appendSpan("e-input-group-icon e-time-icon e-icons",this.inputWrapper.container)}bindInputEvents(){EventHandler.add(this.timeIcon,"mousedown",this.timeHandler,this),EventHandler.add(this.inputWrapper.buttons[0],"mousedown",this.dateHandler,this),EventHandler.add(this.inputElement,"blur",this.blurHandler,this),EventHandler.add(this.inputElement,"focus",this.focusHandler,this),this.defaultKeyConfigs=extend(this.defaultKeyConfigs,this.keyConfigs),this.keyboardHandler=new ej2_base_es2015_KeyboardEvents(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyAction.bind(this),keyConfigs:this.defaultKeyConfigs})}unBindInputEvents(){EventHandler.remove(this.timeIcon,"mousedown touchstart",this.timeHandler),EventHandler.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateHandler),this.inputElement&&(EventHandler.remove(this.inputElement,"blur",this.blurHandler),EventHandler.remove(this.inputElement,"focus",this.focusHandler)),this.keyboardHandler&&this.keyboardHandler.destroy()}cldrTimeFormat(){return this.isNullOrEmpty(this.timeFormat)?"en"===this.locale||"en-US"===this.locale?getValue("timeFormats.short",getDefaultDateObject()):this.getCultureTimeObject(cldrData,""+this.locale):this.timeFormat}cldrDateTimeFormat(){let dateFormat=new Internationalization(this.locale).getDatePattern({skeleton:"yMd"});return this.isNullOrEmpty(this.formatString)?dateFormat+" "+this.getCldrFormat("time"):this.formatString}getCldrFormat(type){return"en"===this.locale||"en-US"===this.locale?getValue("timeFormats.short",getDefaultDateObject()):this.getCultureTimeObject(cldrData,""+this.locale)}isNullOrEmpty(value){return!!(isNullOrUndefined(value)||"string"==typeof value&&""===value.trim())}getCultureTimeObject(ld,c){return getValue("Gregorian"===this.calendarMode?"main."+this.locale+".dates.calendars.gregorian.timeFormats.short":"main."+this.locale+".dates.calendars.islamic.timeFormats.short",ld)}timeHandler(e){Browser.isDevice&&this.inputElement.setAttribute("readonly",""),e.currentTarget===this.timeIcon&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isDatePopupOpen()&&super.hide(e),this.isTimePopupOpen()?this.closePopup(e):(this.inputElement.focus(),this.popupCreation("time",e),addClass([this.inputWrapper.container],["e-input-focus"])))}dateHandler(e){e.currentTarget===this.inputWrapper.buttons[0]&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isTimePopupOpen()&&this.closePopup(e),isNullOrUndefined(this.popupWrapper)||this.popupCreation("date",e))}show(type,e){this.enabled&&this.readonly||!this.enabled||("time"!==type||this.dateTimeWrapper?this.popupObj||(this.isTimePopupOpen()&&this.hide(e),super.show(),this.popupCreation("date",e)):(this.isDatePopupOpen()&&this.hide(e),this.popupCreation("time",e)))}toggle(e){this.isDatePopupOpen()?(super.hide(e),this.show("time",null)):this.isTimePopupOpen()?(this.hide(e),super.show(null,e),this.popupCreation("date",null)):this.show(null,e)}listCreation(){let dateObject;dateObject=this.globalize.parseDate(this.inputElement.value,"Gregorian"===this.calendarMode?{format:this.cldrDateTimeFormat(),type:"datetime"}:{format:this.cldrDateTimeFormat(),type:"datetime",calendar:"islamic"});let value=isNullOrUndefined(this.value)?""!==this.inputElement.value?dateObject:new Date:this.value;this.valueWithMinutes=value,this.listWrapper=ej2_base_es2015_createElement("div",{className:"e-content",attrs:{tabindex:"0"}});let min=this.startTime(value),max=this.endTime(value),listDetails=ej2_calendars_es2015_TimePickerBase.createListItems(this.createElement,min,max,this.globalize,this.cldrTimeFormat(),this.step);this.timeCollections=listDetails.collection,this.listTag=listDetails.list,attributes(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),append([listDetails.list],this.listWrapper),this.wireTimeListEvents(),this.rippleFn=rippleEffect(this.listWrapper,{duration:300,selector:"."+LISTCLASS$2}),this.liCollections=this.listWrapper.querySelectorAll("."+LISTCLASS$2)}popupCreation(type,e){Browser.isDevice&&this.element.setAttribute("readonly","readonly"),"date"===type?!this.readonly&&this.popupWrapper&&(addClass([this.popupWrapper],"e-datetimepopup-wrapper"),attributes(this.popupWrapper,{id:this.element.id+"_datepopup"})):this.readonly||(this.dateTimeWrapper=ej2_base_es2015_createElement("div",{className:ROOT$4+" e-popup",attrs:{id:this.element.id+"_timepopup",style:"visibility:hidden ; display:block"}}),isNullOrUndefined(this.cssClass)||(this.dateTimeWrapper.className+=" "+this.cssClass),!isNullOrUndefined(this.step)&&this.step>0&&(this.listCreation(),append([this.listWrapper],this.dateTimeWrapper)),document.body.appendChild(this.dateTimeWrapper),this.addTimeSelection(),this.renderPopup(),this.setTimeScrollPosition(),this.openPopup(e),this.popupObject.refreshPosition(this.inputElement))}openPopup(e){this.preventArgs={cancel:!1,popup:this.popupObject,event:e||null},this.trigger("open",this.preventArgs,eventArgs=>{this.preventArgs=eventArgs,this.preventArgs.cancel||this.readonly||(this.popupObject.show(new ej2_base_es2015_Animation({name:"FadeIn",duration:100}),1e3===this.zIndex?this.element:null),addClass([this.inputWrapper.container],["e-icon-anim"]),attributes(this.inputElement,{"aria-expanded":"true"}),EventHandler.add(document,"mousedown touchstart",this.documentClickHandler,this))})}documentClickHandler(event){"touchstart"!==event.type&&event.preventDefault();let target=event.target;closest(target,"#"+(this.popupObject&&this.popupObject.element.id))||target===this.inputElement||target===this.timeIcon||target===this.inputWrapper.container?target!==this.inputElement&&(Browser.isDevice||(this.isPreventBlur=document.activeElement===this.inputElement&&(Browser.isIE||"edge"===Browser.info.name)&&target===this.popupObject.element,event.preventDefault())):this.isTimePopupOpen()&&(this.hide(event),this.focusOut())}isTimePopupOpen(){return!(!this.dateTimeWrapper||!this.dateTimeWrapper.classList.contains(""+ROOT$4))}isDatePopupOpen(){return!(!this.popupWrapper||!this.popupWrapper.classList.contains("e-datetimepopup-wrapper"))}renderPopup(){this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),Browser.isDevice&&(this.timeModal=ej2_base_es2015_createElement("div"),this.timeModal.className=ROOT$4+" e-time-modal",document.body.className+=" e-time-overflow",this.timeModal.style.display="block",document.body.appendChild(this.timeModal)),this.popupObject=new ej2_popups_es2015_Popup(this.dateTimeWrapper,{width:this.setPopupWidth(),zIndex:this.zIndex,targetType:"container",collision:Browser.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},relateTo:Browser.isDevice?document.body:this.inputWrapper.container,position:Browser.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},enableRtl:this.enableRtl,offsetY:4,open:()=>{this.dateTimeWrapper.style.visibility="visible",addClass([this.timeIcon],"e-active"),Browser.isDevice||(this.timekeyConfigure=extend(this.timekeyConfigure,this.keyConfigs),this.inputEvent=new ej2_base_es2015_KeyboardEvents(this.inputWrapper.container,{keyAction:this.TimeKeyActionHandle.bind(this),keyConfigs:this.timekeyConfigure,eventName:"keydown"}))},close:()=>{removeClass([this.timeIcon],"e-active"),this.unWireTimeListEvents(),this.inputElement.setAttribute("aria-activedescendant","null"),ej2_base_es2015_remove(this.popupObject.element),this.popupObject.destroy(),this.dateTimeWrapper.innerHTML="",this.listWrapper=this.dateTimeWrapper=void 0,this.inputEvent&&this.inputEvent.destroy()}}),this.popupObject.element.style.maxHeight="250px"}setDimension(width){return"number"==typeof width?formatUnit(width):"string"==typeof width?width:"100%"}setPopupWidth(){let width=this.setDimension(this.width);return width.indexOf("%")>-1&&(width=(this.containerStyle.width*parseFloat(width)/100).toString()+"px"),width}wireTimeListEvents(){EventHandler.add(this.listWrapper,"click",this.onMouseClick,this),Browser.isDevice||(EventHandler.add(this.listWrapper,"mouseover",this.onMouseOver,this),EventHandler.add(this.listWrapper,"mouseout",this.onMouseLeave,this))}unWireTimeListEvents(){this.listWrapper&&(EventHandler.remove(this.listWrapper,"click",this.onMouseClick),EventHandler.remove(document,"mousedown touchstart",this.documentClickHandler),Browser.isDevice||(EventHandler.add(this.listWrapper,"mouseover",this.onMouseOver,this),EventHandler.add(this.listWrapper,"mouseout",this.onMouseLeave,this)))}onMouseOver(event){let currentLi=closest(event.target,"."+LISTCLASS$2);this.setTimeHover(currentLi,"e-hover")}onMouseLeave(){this.removeTimeHover("e-hover")}setTimeHover(li,className){this.enabled&&this.isValidLI(li)&&!li.classList.contains(className)&&(this.removeTimeHover(className),addClass([li],className))}getPopupHeight(){let height=parseInt("250px",10),popupHeight=this.dateTimeWrapper.getBoundingClientRect().height;return popupHeight>height?height:popupHeight}changeEvent(e){+this.previousDateTime!=+this.value&&(super.changeEvent(e),this.inputElement.focus(),this.valueWithMinutes=this.value,this.setInputValue("date"),this.previousDateTime=this.value&&new Date(+this.value))}updateValue(e){this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs={value:this.value,event:e||null,isInteracted:!isNullOrUndefined(e),element:this.element},this.addTimeSelection(),this.trigger("change",this.changedArgs),this.previousDateTime=this.value)}setTimeScrollPosition(){let popupElement;isNullOrUndefined(popupElement=this.selectedElement)?this.dateTimeWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(popupElement)}findScrollTop(element){let listHeight=this.getPopupHeight(),nextElement=element.nextElementSibling,height=nextElement?nextElement.offsetTop:element.offsetTop,lineHeight=element.getBoundingClientRect().height;this.dateTimeWrapper.scrollTop=height+element.offsetTop>listHeight?nextElement?height-(listHeight/2+lineHeight/2):height:0}setScrollTo(){let element,items=this.dateTimeWrapper.querySelectorAll("."+LISTCLASS$2);if(items.length>=0){let initialTime=this.timeCollections[0],scrollTime=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();element=items[Math.round((scrollTime-initialTime)/(6e4*this.step))]}else this.dateTimeWrapper.scrollTop=0;isNullOrUndefined(element)?this.dateTimeWrapper.scrollTop=0:this.findScrollTop(element)}setInputValue(type){if("date"===type)this.inputElement.value=this.previousElementValue=this.getFormattedValue(this.getFullDateTime()),this.setProperties({value:this.getFullDateTime()},!0);else{let tempVal=this.getFormattedValue(new Date(this.timeCollections[this.activeIndex]));ej2_inputs_es2015_Input.setValue(tempVal,this.inputElement,this.floatLabelType,this.showClearButton),this.previousElementValue=this.inputElement.value,this.setProperties({value:new Date(this.timeCollections[this.activeIndex])},!0)}this.updateIconState()}getFullDateTime(){let value=null;return value=this.isDateObject(this.valueWithMinutes)?this.combineDateTime(this.valueWithMinutes):this.previousDate,this.validateMinMaxRange(value)}combineDateTime(value){if(this.isDateObject(value)){let day=this.previousDate.getDate(),month=this.previousDate.getMonth(),year=this.previousDate.getFullYear(),hour=value.getHours(),minutes=value.getMinutes(),seconds=value.getSeconds();return new Date(year,month,day,hour,minutes,seconds)}return this.previousDate}onMouseClick(event){let li=this.selectedElement=closest(event.target,"."+LISTCLASS$2);li&&li.classList.contains(LISTCLASS$2)&&(this.timeValue=li.getAttribute("data-value"),this.hide(event)),this.setSelection(li,event)}setSelection(li,event){if(this.isValidLI(li)&&!li.classList.contains("e-active")){li.getAttribute("data-value"),this.selectedElement=li;let index=Array.prototype.slice.call(this.liCollections).indexOf(li);this.activeIndex=index,this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),addClass([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"),this.updateValue(event)}}setTimeActiveClass(){let collections=isNullOrUndefined(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;if(!isNullOrUndefined(collections)){let items=collections.querySelectorAll("."+LISTCLASS$2);if(items.length)for(let i=0;i<items.length;i++)if(this.timeCollections[i]===+this.valueWithMinutes){items[i].setAttribute("aria-selected","true"),this.selectedElement=items[i],this.activeIndex=i,this.setTimeActiveDescendant();break}}}setTimeActiveDescendant(){isNullOrUndefined(this.selectedElement)?attributes(this.inputElement,{"aria-activedescendant":"null"}):attributes(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")})}addTimeSelection(){this.selectedElement=null,this.removeTimeSelection(),this.setTimeActiveClass(),isNullOrUndefined(this.selectedElement)||(addClass([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"))}removeTimeSelection(){if(this.removeTimeHover("e-hover"),!isNullOrUndefined(this.dateTimeWrapper)){let items=this.dateTimeWrapper.querySelectorAll(".e-active");items.length&&(removeClass(items,"e-active"),items[0].removeAttribute("aria-selected"))}}removeTimeHover(className){let hoveredItem=this.getTimeHoverItem(className);hoveredItem&&hoveredItem.length&&removeClass(hoveredItem,className)}getTimeHoverItem(className){let hoveredItem,collections=isNullOrUndefined(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;return isNullOrUndefined(collections)||(hoveredItem=collections.querySelectorAll("."+className)),hoveredItem}isValidLI(li){return li&&li.classList.contains(LISTCLASS$2)&&!li.classList.contains("e-disabled")}calculateStartEnd(value,range,method){let day=value.getDate(),month=value.getMonth(),year=value.getFullYear(),hours=value.getHours(),minutes=value.getMinutes(),seconds=value.getSeconds(),milliseconds=value.getMilliseconds();return range?"starttime"===method?new Date(year,month,day,0,0,0):new Date(year,month,day,23,59,59):new Date(year,month,day,hours,minutes,seconds,milliseconds)}startTime(date){let tempStartValue,start,value,tempMin=this.min;return+(value=null===date?new Date:date).getDate()==+tempMin.getDate()&&+value.getMonth()==+tempMin.getMonth()&&+value.getFullYear()==+tempMin.getFullYear()||+new Date(value.getFullYear(),value.getMonth(),value.getDate())<=+new Date(tempMin.getFullYear(),tempMin.getMonth(),tempMin.getDate())?(start=!1,tempStartValue=this.min):+value<+this.max&&+value>+this.min?(start=!0,tempStartValue=value):+value>=+this.max&&(start=!0,tempStartValue=this.max),this.calculateStartEnd(tempStartValue,start,"starttime")}endTime(date){let tempEndValue,end,value,tempMax=this.max;return+(value=null===date?new Date:date).getDate()==+tempMax.getDate()&&+value.getMonth()==+tempMax.getMonth()&&+value.getFullYear()==+tempMax.getFullYear()||+new Date(value.getUTCFullYear(),value.getMonth(),value.getDate())>=+new Date(tempMax.getFullYear(),tempMax.getMonth(),tempMax.getDate())?(end=!1,tempEndValue=this.max):+value<+this.max&&+value>+this.min?(end=!0,tempEndValue=value):+value<=+this.min&&(end=!0,tempEndValue=this.min),this.calculateStartEnd(tempEndValue,end,"endtime")}hide(e){if(this.popupObj||this.dateTimeWrapper){this.preventArgs={cancel:!1,popup:this.popupObj||this.popupObject,event:e||null};let eventArgs=this.preventArgs;isNullOrUndefined(this.popupObj)?this.trigger("close",eventArgs,eventArgs=>{this.dateTimeCloseEventCallback(e,eventArgs)}):this.dateTimeCloseEventCallback(e,eventArgs)}else Browser.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}dateTimeCloseEventCallback(e,eventArgs){this.preventArgs=eventArgs,this.preventArgs.cancel||(this.isDatePopupOpen()?super.hide(e):this.isTimePopupOpen()&&(this.closePopup(e),removeClass([document.body],"e-time-overflow"),Browser.isDevice&&this.timeModal&&(this.timeModal.style.display="none",this.timeModal.outerHTML="",this.timeModal=null),this.setTimeActiveDescendant())),Browser.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}closePopup(e){this.isTimePopupOpen()&&this.popupObject&&(this.popupObject.hide(new ej2_base_es2015_Animation({name:"FadeOut",duration:100,delay:0})),this.inputWrapper.container.classList.remove("e-icon-anim"),attributes(this.inputElement,{"aria-expanded":"false"}),EventHandler.remove(document,"mousedown touchstart",this.documentClickHandler))}preRender(){this.checkFormat(),this.dateTimeFormat=this.cldrDateTimeFormat(),super.preRender(),removeClass([this.inputElementCopy],[ROOT$4])}getProperty(date,val){this.setProperties("min"===val?{min:this.validateValue(date.min)}:{max:this.validateValue(date.max)},!0)}checkAttributes(isDynamic){let value,attributes$$1=isDynamic?isNullOrUndefined(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["style","name","step","disabled","readonly","value","min","max","placeholder","type"];for(let prop of attributes$$1)if(!isNullOrUndefined(this.inputElement.getAttribute(prop)))switch(prop){case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(prop));break;case"step":this.step=parseInt(this.inputElement.getAttribute(prop),10);break;case"readonly":if(isNullOrUndefined(this.dateTimeOptions)||void 0===this.dateTimeOptions.readonly||isDynamic){let readonly="disabled"===this.inputElement.getAttribute(prop)||""===this.inputElement.getAttribute(prop)||"true"===this.inputElement.getAttribute(prop);this.setProperties({readonly:readonly},!isDynamic)}break;case"placeholder":(isNullOrUndefined(this.dateTimeOptions)||void 0===this.dateTimeOptions.placeholder||isDynamic)&&this.setProperties({placeholder:this.inputElement.getAttribute(prop)},!isDynamic);break;case"min":(isNullOrUndefined(this.dateTimeOptions)||void 0===this.dateTimeOptions.min||isDynamic)&&(value=new Date(this.inputElement.getAttribute(prop)),this.isNullOrEmpty(value)||isNaN(+value)||this.setProperties({min:value},!isDynamic));break;case"disabled":if(isNullOrUndefined(this.dateTimeOptions)||void 0===this.dateTimeOptions.enabled||isDynamic){let enabled="disabled"!==this.inputElement.getAttribute(prop)&&"true"!==this.inputElement.getAttribute(prop)&&""!==this.inputElement.getAttribute(prop);this.setProperties({enabled:enabled},!isDynamic)}break;case"value":(isNullOrUndefined(this.dateTimeOptions)||void 0===this.dateTimeOptions.value||isDynamic)&&(value=new Date(this.inputElement.getAttribute(prop)),this.isNullOrEmpty(value)||isNaN(+value)||this.setProperties({value:value},!isDynamic));break;case"max":(isNullOrUndefined(this.dateTimeOptions)||void 0===this.dateTimeOptions.max||isDynamic)&&(value=new Date(this.inputElement.getAttribute(prop)),this.isNullOrEmpty(value)||isNaN(+value)||this.setProperties({max:value},!isDynamic))}}requiredModules(){let modules=[];return this&&modules.push({args:[this],member:"islamic"}),modules}getTimeActiveElement(){return isNullOrUndefined(this.dateTimeWrapper)?null:this.dateTimeWrapper.querySelectorAll(".e-active")}createDateObj(val){return val instanceof Date?val:null}getDateObject(text){if(!this.isNullOrEmpty(text)){let dateValue=this.createDateObj(text),value=this.valueWithMinutes,status=!isNullOrUndefined(value);if(this.checkDateValue(dateValue)){let date=status?value.getDate():DAY$1,month=status?value.getMonth():MONTH$3,year=status?value.getFullYear():YEAR$3,hour=status?value.getHours():HOUR,minute=status?value.getMinutes():MINUTE,second=status?value.getSeconds():SECOND,millisecond=status?value.getMilliseconds():MILLISECOND;return new Date(year,month,date,hour,minute,second,millisecond)}}return null}findNextTimeElement(event){let textVal=this.inputElement.value,value=isNullOrUndefined(this.valueWithMinutes)?this.createDateObj(textVal):this.getDateObject(this.valueWithMinutes),dateTimeVal=null,listCount=this.liCollections.length;if(!isNullOrUndefined(this.activeIndex)||!isNullOrUndefined(this.checkDateValue(value))){if("home"===event.action)dateTimeVal=+this.createDateObj(new Date(this.timeCollections[0])),this.activeIndex=0;else if("end"===event.action)dateTimeVal=+this.createDateObj(new Date(this.timeCollections[this.timeCollections.length-1])),this.activeIndex=this.timeCollections.length-1;else if("down"===event.action){for(let i=0;i<listCount;i++)if(+value<this.timeCollections[i]){dateTimeVal=+this.createDateObj(new Date(this.timeCollections[i])),this.activeIndex=i;break}}else for(let i=listCount-1;i>=0;i--)if(+value>this.timeCollections[i]){dateTimeVal=+this.createDateObj(new Date(this.timeCollections[i])),this.activeIndex=i;break}this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(isNullOrUndefined(dateTimeVal)?null:new Date(dateTimeVal))}}setTimeValue(date,value){let dateString,time,val=this.validateMinMaxRange(value),newval=this.createDateObj(val);return this.getFormattedValue(newval)!==(isNullOrUndefined(this.value)?null:this.getFormattedValue(this.value))?(this.valueWithMinutes=isNullOrUndefined(newval)?null:newval,time=new Date(+this.valueWithMinutes)):(this.strictMode&&(date=newval),this.valueWithMinutes=this.checkDateValue(date),time=new Date(+this.valueWithMinutes)),dateString=this.globalize.formatDate(time,"Gregorian"===this.calendarMode?{format:isNullOrUndefined(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd"}:{format:isNullOrUndefined(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),!this.strictMode&&isNullOrUndefined(time),ej2_inputs_es2015_Input.setValue(dateString,this.inputElement,this.floatLabelType,this.showClearButton),time}timeElementValue(value){if(!isNullOrUndefined(this.checkDateValue(value))&&!this.isNullOrEmpty(value)){let date=value instanceof Date?value:this.getDateObject(value);return this.setTimeValue(date,value)}return null}timeKeyHandler(event){if(isNullOrUndefined(this.step)||this.step<=0)return;let listCount=this.timeCollections.length;if(isNullOrUndefined(this.getTimeActiveElement())||0===this.getTimeActiveElement().length)this.liCollections.length>0&&(isNullOrUndefined(this.value)&&isNullOrUndefined(this.activeIndex)?(this.activeIndex=0,this.selectedElement=this.liCollections[0],this.timeElementValue(new Date(this.timeCollections[0]))):this.findNextTimeElement(event));else{let nextItemValue;if(event.keyCode>=37&&event.keyCode<=40){let index=40===event.keyCode||39===event.keyCode?++this.activeIndex:--this.activeIndex;this.activeIndex=index=this.activeIndex===listCount?0:this.activeIndex,this.activeIndex=index=this.activeIndex<0?listCount-1:this.activeIndex,nextItemValue=isNullOrUndefined(this.timeCollections[index])?this.timeCollections[0]:this.timeCollections[index]}else"home"===event.action?(this.activeIndex=0,nextItemValue=this.timeCollections[0]):"end"===event.action&&(this.activeIndex=listCount-1,nextItemValue=this.timeCollections[listCount-1]);this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(new Date(nextItemValue))}this.isNavigate=!0,this.setTimeHover(this.selectedElement,"e-navigation"),this.setTimeActiveDescendant(),!this.isTimePopupOpen()||null===this.selectedElement||event&&"click"===event.type||this.setTimeScrollPosition()}TimeKeyActionHandle(event){if(this.enabled)switch("right"!==event.action&&"left"!==event.action&&"tab"!==event.action&&event.preventDefault(),event.action){case"up":case"down":case"home":case"end":this.timeKeyHandler(event);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs.value=this.value,this.addTimeSelection(),this.previousDateTime=this.value)):this.updateValue(event),this.hide(event),addClass([this.inputWrapper.container],"e-input-focus"),this.isNavigate=!1,event.stopPropagation();break;case"escape":this.hide(event);break;default:this.isNavigate=!1}}inputKeyAction(event){switch(event.action){case"altDownArrow":this.strictModeUpdate(),this.updateInput(),this.toggle(event)}}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp)){switch(prop){case"value":this.cldrDateTimeFormat(),this.invalidValueString=null,this.checkInvalidValue(newProp.value),newProp.value=this.value,newProp.value=this.validateValue(newProp.value),ej2_inputs_es2015_Input.setValue(this.getFormattedValue(newProp.value),this.inputElement,this.floatLabelType,this.showClearButton),this.valueWithMinutes=newProp.value,this.setProperties({value:newProp.value},!0),this.previousDateTime=new Date(this.inputElement.value),this.updateInput(),this.changeTrigger(null);break;case"min":case"max":this.getProperty(newProp,prop),this.updateInput();break;case"enableRtl":ej2_inputs_es2015_Input.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"cssClass":ej2_inputs_es2015_Input.setCssClass(newProp.cssClass,[this.inputWrapper.container],oldProp.cssClass),this.dateTimeWrapper&&ej2_inputs_es2015_Input.setCssClass(newProp.cssClass,[this.dateTimeWrapper],oldProp.cssClass);break;case"locale":this.globalize=new Internationalization(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),ej2_inputs_es2015_Input.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement),this.dateTimeFormat=this.cldrDateTimeFormat(),super.updateInput();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"format":this.setProperties({format:newProp.format},!0),this.checkFormat(),this.dateTimeFormat=this.formatString,this.setValue();break;case"placeholder":ej2_inputs_es2015_Input.setPlaceholder(newProp.placeholder,this.inputElement),this.inputElement.setAttribute("aria-placeholder",newProp.placeholder);break;case"enabled":ej2_inputs_es2015_Input.setEnabled(this.enabled,this.inputElement),this.enabled||(this.inputElement.tabIndex=-1),this.bindEvents();break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(newProp.width);break;case"readonly":ej2_inputs_es2015_Input.setReadonly(this.readonly,this.inputElement);break;case"floatLabelType":this.floatLabelType=newProp.floatLabelType,ej2_inputs_es2015_Input.removeFloating(this.inputWrapper),ej2_inputs_es2015_Input.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"scrollTo":this.checkDateValue(new Date(this.checkValue(newProp.scrollTo)))?(this.dateTimeWrapper&&this.setScrollTo(),this.setProperties({scrollTo:newProp.scrollTo},!0)):this.setProperties({scrollTo:null},!0);break;default:super.onPropertyChanged(newProp,oldProp)}this.hide(null)}}getModuleName(){return"datetimepicker"}restoreValue(){this.previousDateTime=this.previousDate,this.currentDate=this.value?this.value:new Date,this.valueWithMinutes=this.value,this.previousDate=this.value,this.previousElementValue=this.previousElementValue=isNullOrUndefined(this.inputValueCopy)?"":this.getFormattedValue(this.inputValueCopy)}};return __decorate([Property(null)],DateTimePicker.prototype,"timeFormat",void 0),__decorate([Property(30)],DateTimePicker.prototype,"step",void 0),__decorate([Property(null)],DateTimePicker.prototype,"scrollTo",void 0),__decorate([Property(1e3)],DateTimePicker.prototype,"zIndex",void 0),__decorate([Property(null)],DateTimePicker.prototype,"keyConfigs",void 0),__decorate([Property({})],DateTimePicker.prototype,"htmlAttributes",void 0),__decorate([Property(!1)],DateTimePicker.prototype,"enablePersistence",void 0),__decorate([Property(!0)],DateTimePicker.prototype,"allowEdit",void 0),__decorate([Property(!1)],DateTimePicker.prototype,"isMultiSelection",void 0),__decorate([Property(null)],DateTimePicker.prototype,"values",void 0),__decorate([Property(!0)],DateTimePicker.prototype,"showClearButton",void 0),__decorate([Property(null)],DateTimePicker.prototype,"placeholder",void 0),__decorate([Property(!1)],DateTimePicker.prototype,"strictMode",void 0),__decorate([ej2_base_es2015_Event()],DateTimePicker.prototype,"open",void 0),__decorate([ej2_base_es2015_Event()],DateTimePicker.prototype,"close",void 0),__decorate([ej2_base_es2015_Event()],DateTimePicker.prototype,"blur",void 0),__decorate([ej2_base_es2015_Event()],DateTimePicker.prototype,"focus",void 0),__decorate([ej2_base_es2015_Event()],DateTimePicker.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],DateTimePicker.prototype,"destroyed",void 0),__decorate([NotifyPropertyChanges],DateTimePicker)})(),ej2_navigations_es2015_HScroll=(()=>{let HScroll=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}preRender(){this.browser=Browser.info.name,this.browserCheck="mozilla"===this.browser,this.isDevice=Browser.isDevice,this.customStep=!0;let element=this.element;this.ieCheck="edge"===this.browser||"msie"===this.browser,this.initialize(),""===element.id&&(element.id=getUniqueID("hscroll"),this.uniqueId=!0),element.style.display="block",this.enableRtl&&element.classList.add("e-rtl")}render(){this.touchModule=new ej2_base_es2015_Touch(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),EventHandler.add(this.scrollEle,"scroll",this.scrollHandler,this),this.isDevice?(this.element.classList.add("e-scroll-device"),this.createOverlay(this.element)):this.createNavIcon(this.element),this.setScrollState()}setScrollState(){isNullOrUndefined(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetWidth,this.customStep=!1):this.customStep=!0}initialize(){let scrollEle=this.createElement("div",{className:"e-hscroll-content"}),scrollDiv=this.createElement("div",{className:"e-hscroll-bar"});scrollDiv.setAttribute("tabindex","-1");let ele=this.element,innerEle=[].slice.call(ele.children);for(let ele of innerEle)scrollEle.appendChild(ele);scrollDiv.appendChild(scrollEle),ele.appendChild(scrollDiv),scrollDiv.style.overflowX="hidden",this.scrollEle=scrollDiv,this.scrollItems=scrollEle}getPersistData(){return this.addOnPersist(["scrollStep"])}getModuleName(){return"hScroll"}destroy(){let ele=this.element;ele.style.display="",ele.classList.remove("e-hscroll"),ele.classList.remove("e-scroll-device");let nav=ej2_base_es2015_selectAll(".e-"+ele.id+"_nav.e-scroll-nav",ele),overlay=ej2_base_es2015_selectAll(".e-scroll-overlay",ele);[].slice.call(overlay).forEach(ele=>{detach(ele)});for(let elem of[].slice.call(this.scrollItems.children))ele.appendChild(elem);this.uniqueId&&this.element.removeAttribute("id"),detach(this.scrollEle),nav.length>0&&(detach(nav[0]),isNullOrUndefined(nav[1])||detach(nav[1])),EventHandler.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,super.destroy()}disable(value){let navEles=ej2_base_es2015_selectAll(".e-scroll-nav:not(.e-overlay)",this.element);value?this.element.classList.add("e-overlay"):this.element.classList.remove("e-overlay"),[].slice.call(navEles).forEach(el=>{el.setAttribute("tabindex",value?"-1":"0")})}createOverlay(element){let id=element.id.concat("_nav"),rightOverlayEle=this.createElement("div",{className:"e-scroll-overlay e-scroll-right-overlay"}),clsRight="e-"+element.id.concat("_nav e-scroll-nav e-scroll-right-nav"),rightEle=this.createElement("div",{id:id.concat("_right"),className:clsRight}),navItem=this.createElement("div",{className:"e-nav-right-arrow e-nav-arrow e-icons"});rightEle.appendChild(navItem);let leftEle=this.createElement("div",{className:"e-scroll-overlay e-scroll-left-overlay"});this.ieCheck&&rightEle.classList.add("e-ie-align"),element.appendChild(rightOverlayEle),element.appendChild(rightEle),element.insertBefore(leftEle,element.firstChild),this.eventBinding([rightEle])}createNavIcon(element){let id=element.id.concat("_nav"),clsRight="e-"+element.id.concat("_nav e-scroll-nav e-scroll-right-nav"),nav=this.createElement("div",{id:id.concat("_right"),className:clsRight});nav.setAttribute("aria-disabled","false");let navItem=this.createElement("div",{className:"e-nav-right-arrow e-nav-arrow e-icons"}),clsLeft="e-"+element.id.concat("_nav e-scroll-nav e-scroll-left-nav"),navEle=this.createElement("div",{id:id.concat("_left"),className:clsLeft+" e-overlay"});navEle.setAttribute("aria-disabled","true");let navLeftItem=this.createElement("div",{className:"e-nav-left-arrow e-nav-arrow e-icons"});navEle.appendChild(navLeftItem),nav.appendChild(navItem),nav.setAttribute("tabindex","0"),element.appendChild(nav),element.insertBefore(navEle,element.firstChild),this.ieCheck&&(nav.classList.add("e-ie-align"),navEle.classList.add("e-ie-align")),this.eventBinding([nav,navEle])}onKeyPress(e){if("Enter"===e.key){let timeoutFun=()=>{this.keyTimeout=!0,this.eleScrolling(10,e.target,!0)};this.keyTimer=window.setTimeout(()=>{timeoutFun()},100)}}onKeyUp(e){"Enter"===e.key&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))}eventBinding(ele){[].slice.call(ele).forEach(el=>{new ej2_base_es2015_Touch(el,{tapHold:this.tabHoldHandler.bind(this),tapHoldThreshold:500}),el.addEventListener("keydown",this.onKeyPress.bind(this)),el.addEventListener("keyup",this.onKeyUp.bind(this)),el.addEventListener("mouseup",this.repeatScroll.bind(this)),el.addEventListener("touchend",this.repeatScroll.bind(this)),el.addEventListener("contextmenu",e=>{e.preventDefault()}),EventHandler.add(el,"click",this.clickEventHandler,this)})}repeatScroll(){clearInterval(this.timeout)}tabHoldHandler(e){let trgt=e.originalEvent.target;trgt=this.contains(trgt,"e-scroll-nav")?trgt.firstElementChild:trgt;let timeoutFun=()=>{this.eleScrolling(10,trgt,!0)};this.timeout=window.setInterval(()=>{timeoutFun()},50)}contains(ele,className){return ele.classList.contains(className)}eleScrolling(scrollDis,trgt,isContinuous){let rootEle=this.element,classList$$1=trgt.classList;classList$$1.contains("e-scroll-nav")&&(classList$$1=trgt.querySelector(".e-nav-arrow").classList),this.contains(rootEle,"e-rtl")&&this.browserCheck&&(scrollDis=-scrollDis),!this.contains(rootEle,"e-rtl")||this.browserCheck||this.ieCheck?classList$$1.contains("e-nav-right-arrow")?this.frameScrollRequest(scrollDis,"add",isContinuous):this.frameScrollRequest(scrollDis,"",isContinuous):classList$$1.contains("e-nav-left-arrow")?this.frameScrollRequest(scrollDis,"add",isContinuous):this.frameScrollRequest(scrollDis,"",isContinuous)}clickEventHandler(e){this.eleScrolling(this.scrollStep,e.target,!1)}swipeHandler(e){let distance,swipeEle=this.scrollEle;distance=e.velocity<=1?e.distanceX/(10*e.velocity):e.distanceX/e.velocity;let start=.5,animate=()=>{let step=Math.sin(start);step<=0?window.cancelAnimationFrame(step):("Left"===e.swipeDirection?swipeEle.scrollLeft+=distance*step:"Right"===e.swipeDirection&&(swipeEle.scrollLeft-=distance*step),start-=.02,window.requestAnimationFrame(animate))};animate()}scrollUpdating(scrollVal,action){"add"===action?this.scrollEle.scrollLeft+=scrollVal:this.scrollEle.scrollLeft-=scrollVal}frameScrollRequest(scrollVal,action,isContinuous){if(isContinuous)return void this.scrollUpdating(scrollVal,action);this.customStep||[].slice.call(ej2_base_es2015_selectAll(".e-scroll-overlay",this.element)).forEach(el=>{scrollVal-=el.offsetWidth});let animate=()=>{let scrollValue,scrollStep;this.contains(this.element,"e-rtl")&&this.browserCheck?(scrollValue=-scrollVal,scrollStep=-10):(scrollValue=scrollVal,scrollStep=10),scrollValue<10?window.cancelAnimationFrame(scrollStep):(this.scrollUpdating(scrollStep,action),scrollVal-=scrollStep,window.requestAnimationFrame(animate))};animate()}touchHandler(e){let distance,ele=this.scrollEle;distance=e.distanceX,this.ieCheck&&this.contains(this.element,"e-rtl")&&(distance=-distance),"Left"===e.scrollDirection?ele.scrollLeft=ele.scrollLeft+distance:"Right"===e.scrollDirection&&(ele.scrollLeft=ele.scrollLeft-distance)}arrowDisabling(addDisable,removeDisable){if(this.isDevice){let arrowIcon=(isNullOrUndefined(addDisable)?removeDisable:addDisable).querySelector(".e-nav-arrow");isNullOrUndefined(addDisable)?ej2_base_es2015_classList(arrowIcon,["e-nav-right-arrow"],["e-nav-left-arrow"]):ej2_base_es2015_classList(arrowIcon,["e-nav-left-arrow"],["e-nav-right-arrow"])}else addDisable.classList.add("e-overlay"),addDisable.setAttribute("aria-disabled","true"),addDisable.removeAttribute("tabindex"),removeDisable.classList.remove("e-overlay"),removeDisable.setAttribute("aria-disabled","false"),removeDisable.setAttribute("tabindex","0");this.repeatScroll()}scrollHandler(e){let target=e.target,width=target.offsetWidth,rootEle=this.element,navLeftEle=this.element.querySelector(".e-scroll-left-nav"),navRightEle=this.element.querySelector(".e-scroll-right-nav"),leftOverlay=this.element.querySelector(".e-scroll-left-overlay"),rightOverlay=this.element.querySelector(".e-scroll-right-overlay"),scrollLeft=target.scrollLeft;if(scrollLeft<=0&&(scrollLeft=-scrollLeft),this.isDevice&&(!this.enableRtl||this.browserCheck||this.ieCheck||(leftOverlay=this.element.querySelector(".e-scroll-right-overlay"),rightOverlay=this.element.querySelector(".e-scroll-left-overlay")),leftOverlay.style.width=scrollLeft<40?scrollLeft+"px":"40px",rightOverlay.style.width=target.scrollWidth-Math.ceil(width+scrollLeft)<40?target.scrollWidth-Math.ceil(width+scrollLeft)+"px":"40px"),0===scrollLeft)!this.contains(rootEle,"e-rtl")||this.browserCheck||this.ieCheck?this.arrowDisabling(navLeftEle,navRightEle):this.arrowDisabling(navRightEle,navLeftEle);else if(Math.ceil(width+scrollLeft+.1)>=target.scrollWidth)!this.contains(rootEle,"e-rtl")||this.browserCheck||this.ieCheck?this.arrowDisabling(navRightEle,navLeftEle):this.arrowDisabling(navLeftEle,navRightEle);else{let disEle=this.element.querySelector(".e-scroll-nav.e-overlay");disEle&&(disEle.classList.remove("e-overlay"),disEle.setAttribute("aria-disabled","false"),disEle.setAttribute("tabindex","0"))}}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"scrollStep":this.setScrollState();break;case"enableRtl":newProp.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}}};return __decorate([Property(null)],HScroll.prototype,"scrollStep",void 0),__decorate([NotifyPropertyChanges],HScroll)})(),ej2_navigations_es2015_VScroll=(()=>{let VScroll=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}preRender(){this.browser=Browser.info.name,this.browserCheck="mozilla"===this.browser,this.isDevice=Browser.isDevice,this.customStep=!0;let ele=this.element;this.ieCheck="edge"===this.browser||"msie"===this.browser,this.initialize(),""===ele.id&&(ele.id=getUniqueID("vscroll"),this.uniqueId=!0),ele.style.display="block",this.enableRtl&&ele.classList.add("e-rtl")}render(){this.touchModule=new ej2_base_es2015_Touch(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),EventHandler.add(this.scrollEle,"scroll",this.scrollEventHandler,this),this.isDevice?(this.element.classList.add("e-scroll-device"),this.createOverlayElement(this.element)):this.createNavIcon(this.element),this.setScrollState(),EventHandler.add(this.element,"wheel",this.wheelEventHandler,this)}setScrollState(){isNullOrUndefined(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetHeight,this.customStep=!1):this.customStep=!0}initialize(){let scrollCnt=ej2_base_es2015_createElement("div",{className:"e-vscroll-content"}),scrollBar=ej2_base_es2015_createElement("div",{className:"e-vscroll-bar"});scrollBar.setAttribute("tabindex","-1");let ele=this.element,innerEle=[].slice.call(ele.children);for(let ele of innerEle)scrollCnt.appendChild(ele);scrollBar.appendChild(scrollCnt),ele.appendChild(scrollBar),scrollBar.style.overflowY="hidden",this.scrollEle=scrollBar,this.scrollItems=scrollCnt}getPersistData(){return this.addOnPersist(["scrollStep"])}getModuleName(){return"vScroll"}destroy(){let el=this.element;el.style.display="",removeClass([this.element],["e-vscroll","e-scroll-device"]);let navs=ej2_base_es2015_selectAll(".e-"+el.id+"_nav.e-scroll-nav",el),overlays=ej2_base_es2015_selectAll(".e-scroll-overlay",el);[].slice.call(overlays).forEach(ele=>{detach(ele)});for(let elem of[].slice.call(this.scrollItems.children))el.appendChild(elem);this.uniqueId&&this.element.removeAttribute("id"),detach(this.scrollEle),navs.length>0&&(detach(navs[0]),isNullOrUndefined(navs[1])||detach(navs[1])),EventHandler.remove(this.scrollEle,"scroll",this.scrollEventHandler),this.touchModule.destroy(),this.touchModule=null,super.destroy()}disable(value){let navEle=ej2_base_es2015_selectAll(".e-scroll-nav:not(.e-overlay)",this.element);value?this.element.classList.add("e-overlay"):this.element.classList.remove("e-overlay"),[].slice.call(navEle).forEach(el=>{el.setAttribute("tabindex",value?"-1":"0")})}createOverlayElement(element){let id=element.id.concat("_nav"),downOverlayEle=ej2_base_es2015_createElement("div",{className:"e-scroll-overlay e-scroll-down-overlay"}),clsDown="e-"+element.id.concat("_nav e-scroll-nav e-scroll-down-nav"),downEle=ej2_base_es2015_createElement("div",{id:id.concat("down"),className:clsDown}),navItem=ej2_base_es2015_createElement("div",{className:"e-nav-down-arrow e-nav-arrow e-icons"});downEle.appendChild(navItem);let upEle=ej2_base_es2015_createElement("div",{className:"e-scroll-overlay e-scroll-up-overlay"});this.ieCheck&&downEle.classList.add("e-ie-align"),element.appendChild(downOverlayEle),element.appendChild(downEle),element.insertBefore(upEle,element.firstChild),this.eventBinding([downEle])}createNavIcon(element){let id=element.id.concat("_nav"),clsDown="e-"+element.id.concat("_nav e-scroll-nav e-scroll-down-nav"),nav=ej2_base_es2015_createElement("div",{id:id.concat("_down"),className:clsDown});nav.setAttribute("aria-disabled","false");let navItem=ej2_base_es2015_createElement("div",{className:"e-nav-down-arrow e-nav-arrow e-icons"}),clsUp="e-"+element.id.concat("_nav e-scroll-nav e-scroll-up-nav"),navElement=ej2_base_es2015_createElement("div",{id:id.concat("_up"),className:clsUp+" e-overlay"});navElement.setAttribute("aria-disabled","true");let navUpItem=ej2_base_es2015_createElement("div",{className:"e-nav-up-arrow e-nav-arrow e-icons"});navElement.appendChild(navUpItem),nav.appendChild(navItem),nav.setAttribute("tabindex","0"),element.appendChild(nav),element.insertBefore(navElement,element.firstChild),this.ieCheck&&(nav.classList.add("e-ie-align"),navElement.classList.add("e-ie-align")),this.eventBinding([nav,navElement])}onKeyPress(ev){if("Enter"===ev.key){let timeoutFun=()=>{this.keyTimeout=!0,this.eleScrolling(10,ev.target,!0)};this.keyTimer=window.setTimeout(()=>{timeoutFun()},100)}}onKeyUp(ev){"Enter"===ev.key&&(this.keyTimeout?this.keyTimeout=!1:ev.target.click(),clearTimeout(this.keyTimer))}eventBinding(element){[].slice.call(element).forEach(ele=>{new ej2_base_es2015_Touch(ele,{tapHold:this.tabHoldHandler.bind(this),tapHoldThreshold:500}),ele.addEventListener("keydown",this.onKeyPress.bind(this)),ele.addEventListener("keyup",this.onKeyUp.bind(this)),ele.addEventListener("mouseup",this.repeatScroll.bind(this)),ele.addEventListener("touchend",this.repeatScroll.bind(this)),ele.addEventListener("contextmenu",e=>{e.preventDefault()}),EventHandler.add(ele,"click",this.clickEventHandler,this)})}repeatScroll(){clearInterval(this.timeout)}tabHoldHandler(ev){let trgt=ev.originalEvent.target;trgt=this.contains(trgt,"e-scroll-nav")?trgt.firstElementChild:trgt;let timeoutFun=()=>{this.eleScrolling(10,trgt,!0)};this.timeout=window.setInterval(()=>{timeoutFun()},50)}contains(element,className){return element.classList.contains(className)}eleScrolling(scrollDis,trgt,isContinuous){let classList$$1=trgt.classList;classList$$1.contains("e-scroll-nav")&&(classList$$1=trgt.querySelector(".e-nav-arrow").classList),classList$$1.contains("e-nav-down-arrow")?this.frameScrollRequest(scrollDis,"add",isContinuous):classList$$1.contains("e-nav-up-arrow")&&this.frameScrollRequest(scrollDis,"",isContinuous)}clickEventHandler(event){this.eleScrolling(this.scrollStep,event.target,!1)}wheelEventHandler(e){e.preventDefault(),this.frameScrollRequest(this.scrollStep,e.deltaY>0?"add":"",!1)}swipeHandler(e){let distance,swipeElement=this.scrollEle;distance=e.velocity<=1?e.distanceY/(10*e.velocity):e.distanceY/e.velocity;let start=.5,animate=()=>{let step=Math.sin(start);step<=0?window.cancelAnimationFrame(step):("Up"===e.swipeDirection?swipeElement.scrollTop+=distance*step:"Down"===e.swipeDirection&&(swipeElement.scrollTop-=distance*step),start-=.02,window.requestAnimationFrame(animate))};animate()}scrollUpdating(scrollVal,action){"add"===action?this.scrollEle.scrollTop+=scrollVal:this.scrollEle.scrollTop-=scrollVal}frameScrollRequest(scrollValue,action,isContinuous){if(isContinuous)return void this.scrollUpdating(scrollValue,action);this.customStep||[].slice.call(ej2_base_es2015_selectAll(".e-scroll-overlay",this.element)).forEach(el=>{scrollValue-=el.offsetHeight});let animate=()=>{scrollValue<10?window.cancelAnimationFrame(10):(this.scrollUpdating(10,action),scrollValue-=10,window.requestAnimationFrame(animate))};animate()}touchHandler(e){let distance,el=this.scrollEle;distance=e.distanceY,"Up"===e.scrollDirection?el.scrollTop=el.scrollTop+distance:"Down"===e.scrollDirection&&(el.scrollTop=el.scrollTop-distance)}arrowDisabling(addDisableCls,removeDisableCls){if(this.isDevice){let arrowIcon=(isNullOrUndefined(addDisableCls)?removeDisableCls:addDisableCls).querySelector(".e-nav-arrow");isNullOrUndefined(addDisableCls)?ej2_base_es2015_classList(arrowIcon,["e-nav-down-arrow"],["e-nav-up-arrow"]):ej2_base_es2015_classList(arrowIcon,["e-nav-up-arrow"],["e-nav-down-arrow"])}else addDisableCls.classList.add("e-overlay"),addDisableCls.setAttribute("aria-disabled","true"),addDisableCls.removeAttribute("tabindex"),removeDisableCls.classList.remove("e-overlay"),removeDisableCls.setAttribute("aria-disabled","false"),removeDisableCls.setAttribute("tabindex","0");this.repeatScroll()}scrollEventHandler(e){let target=e.target,height=target.offsetHeight,navUpEle=this.element.querySelector(".e-scroll-up-nav"),navDownEle=this.element.querySelector(".e-scroll-down-nav"),upOverlay=this.element.querySelector(".e-scroll-up-overlay"),downOverlay=this.element.querySelector(".e-scroll-down-overlay"),scrollTop=target.scrollTop;if(scrollTop<=0&&(scrollTop=-scrollTop),this.isDevice&&(upOverlay.style.height=scrollTop<40?scrollTop+"px":"40px",downOverlay.style.height=target.scrollHeight-Math.ceil(height+scrollTop)<40?target.scrollHeight-Math.ceil(height+scrollTop)+"px":"40px"),0===scrollTop)this.arrowDisabling(navUpEle,navDownEle);else if(Math.ceil(height+scrollTop+.1)>=target.scrollHeight)this.arrowDisabling(navDownEle,navUpEle);else{let disEle=this.element.querySelector(".e-scroll-nav.e-overlay");disEle&&(disEle.classList.remove("e-overlay"),disEle.setAttribute("aria-disabled","false"),disEle.setAttribute("tabindex","0"))}}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"scrollStep":this.setScrollState();break;case"enableRtl":newProp.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}}};return __decorate([Property(null)],VScroll.prototype,"scrollStep",void 0),__decorate([NotifyPropertyChanges],VScroll)})();const FOCUSED="e-focused",ITEM="e-menu-item",HIDE="e-menu-hide";let ej2_navigations_es2015_FieldSettings=(()=>{class FieldSettings extends ChildProperty{}return __decorate([Property("id")],FieldSettings.prototype,"itemId",void 0),__decorate([Property("parentId")],FieldSettings.prototype,"parentId",void 0),__decorate([Property("text")],FieldSettings.prototype,"text",void 0),__decorate([Property("iconCss")],FieldSettings.prototype,"iconCss",void 0),__decorate([Property("url")],FieldSettings.prototype,"url",void 0),__decorate([Property("separator")],FieldSettings.prototype,"separator",void 0),__decorate([Property("items")],FieldSettings.prototype,"children",void 0),FieldSettings})(),ej2_navigations_es2015_MenuItem=(()=>{class MenuItem extends ChildProperty{}return __decorate([Property(null)],MenuItem.prototype,"iconCss",void 0),__decorate([Property("")],MenuItem.prototype,"id",void 0),__decorate([Property(!1)],MenuItem.prototype,"separator",void 0),__decorate([Collection([],MenuItem)],MenuItem.prototype,"items",void 0),__decorate([Property("")],MenuItem.prototype,"text",void 0),__decorate([Property("")],MenuItem.prototype,"url",void 0),MenuItem})(),ej2_navigations_es2015_MenuAnimationSettings=(()=>{class MenuAnimationSettings extends ChildProperty{}return __decorate([Property("SlideDown")],MenuAnimationSettings.prototype,"effect",void 0),__decorate([Property(400)],MenuAnimationSettings.prototype,"duration",void 0),__decorate([Property("ease")],MenuAnimationSettings.prototype,"easing",void 0),MenuAnimationSettings})(),ej2_navigations_es2015_MenuBase=(()=>{let MenuBase=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.navIdx=[],this.animation=new ej2_base_es2015_Animation({}),this.isTapHold=!1,this.tempItem=[]}preRender(){if(!this.isMenu){let ul;if("EJS-CONTEXTMENU"===this.element.tagName){ul=this.createElement("ul",{id:getUniqueID(this.getModuleName()),className:"e-control e-lib e-"+this.getModuleName()});let ejInst=getValue("ej2_instances",this.element);removeClass([this.element],["e-control","e-lib","e-"+this.getModuleName()]),this.clonedElement=this.element,this.element=ul,setValue("ej2_instances",ejInst,this.element)}else{ul=this.createElement("ul",{id:getUniqueID(this.getModuleName())}),append([].slice.call(this.element.cloneNode(!0).children),ul);let refEle=this.element.nextElementSibling;refEle?this.element.parentElement.insertBefore(ul,refEle):this.element.parentElement.appendChild(ul),this.clonedElement=ul}this.clonedElement.style.display="none"}if("EJS-MENU"===this.element.tagName){let ele=this.element,ejInstance=getValue("ej2_instances",ele),ul=this.createElement("ul"),wrapper=this.createElement("EJS-MENU",{className:"e-"+this.getModuleName()+"-wrapper"});for(let idx=0,len=ele.attributes.length;idx<len;idx++)ul.setAttribute(ele.attributes[idx].nodeName,ele.attributes[idx].nodeValue);ele.parentNode.insertBefore(wrapper,ele),detach(ele),wrapper.appendChild(ele=ul),setValue("ej2_instances",ejInstance,ele),this.clonedElement=wrapper,this.element=ele,this.element.id||(this.element.id=getUniqueID(this.getModuleName()))}}render(){if(this.initialize(),this.renderItems(),this.isMenu&&this.template&&this.isBlazor()){let menuTemplateId=this.element.id+"Template";resetBlazorTemplate(menuTemplateId),Object.keys(blazorTemplates).length&&extend(this.tempItem,blazorTemplates[menuTemplateId],[],!0),updateBlazorTemplate(menuTemplateId,"Template",this)}this.wireEvents(),this.renderComplete()}initialize(){let wrapper=this.getWrapper();wrapper||(wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.isMenu?this.element.parentElement.insertBefore(wrapper,this.element):document.body.appendChild(wrapper)),this.cssClass&&addClass([wrapper],this.cssClass.split(" ")),this.enableRtl&&wrapper.classList.add("e-rtl"),wrapper.appendChild(this.element),this.isMenu&&this.hamburgerMode&&(this.target||this.createHeaderContainer(wrapper))}renderItems(){if(!this.items.length){let items=ej2_lists_es2015_ListBase.createJsonFromElement(this.element,{fields:{child:"items"}});this.setProperties({items:items},!0),this.isBlazor()?this.element=this.removeChildElement(this.element):this.element.innerHTML=""}let ul=this.createItems(this.items);append(Array.prototype.slice.call(ul.children),this.element),this.element.classList.add("e-menu-parent");let wrapper=this.getWrapper();this.element.classList.contains("e-vertical")?this.addScrolling(wrapper,this.element,"vscroll",wrapper.offsetHeight,this.element.offsetHeight):this.addScrolling(wrapper,this.element,"hscroll",wrapper.offsetWidth,this.element.offsetWidth)}wireEvents(){let wrapper=this.getWrapper();if(this.target){let target,targetElems=ej2_base_es2015_selectAll(this.target);for(let i=0,len=targetElems.length;i<len;i++)target=targetElems[i],this.isMenu?EventHandler.add(target,"click",this.menuHeaderClickHandler,this):Browser.isIos?new ej2_base_es2015_Touch(target,{tapHold:this.touchHandler.bind(this)}):EventHandler.add(target,"contextmenu",this.cmenuHandler,this);if(this.targetElement=target,!this.isMenu)for(let parent of getScrollableParent(this.targetElement))EventHandler.add(parent,"scroll",this.scrollHandler,this)}Browser.isDevice||(this.delegateMoverHandler=this.moverHandler.bind(this),this.delegateMouseDownHandler=this.mouseDownHandler.bind(this),EventHandler.add(this.isMenu?document:wrapper,"mouseover",this.delegateMoverHandler,this),EventHandler.add(document,"mousedown",this.delegateMouseDownHandler,this)),this.delegateClickHandler=this.clickHandler.bind(this),EventHandler.add(document,"click",this.delegateClickHandler,this),this.wireKeyboardEvent(wrapper),this.rippleFn=rippleEffect(wrapper,{selector:"."+ITEM})}wireKeyboardEvent(element){let keyConfigs={downarrow:"downarrow",uparrow:"uparrow",enter:"enter",leftarrow:"leftarrow",rightarrow:"rightarrow",escape:"escape"};this.isMenu&&(keyConfigs.home="home",keyConfigs.end="end"),new ej2_base_es2015_KeyboardEvents(element,{keyAction:this.keyBoardHandler.bind(this),keyConfigs:keyConfigs})}mouseDownHandler(e){closest(e.target,".e-"+this.getModuleName()+"-wrapper")===this.getWrapper()||closest(e.target,".e-"+this.getModuleName()+"-popup")||this.closeMenu(this.isMenu?null:this.navIdx.length,e)}keyBoardHandler(e){let actionName="",trgt=e.target,actionNeeded=this.isMenu&&!this.hamburgerMode&&!this.element.classList.contains("e-vertical")&&this.navIdx.length<1;if(e.preventDefault(),this.enableScrolling&&13===e.keyCode&&trgt.classList.contains("e-scroll-nav")&&this.removeLIStateByClass([FOCUSED,"e-selected"],[closest(trgt,".e-"+this.getModuleName()+"-wrapper")]),actionNeeded)switch(e.action){case"rightarrow":actionName="rightarrow",e.action="downarrow";break;case"leftarrow":actionName="leftarrow",e.action="uparrow";break;case"downarrow":actionName="downarrow",e.action="rightarrow";break;case"uparrow":actionName="uparrow",e.action=""}else if(this.enableRtl)switch(e.action){case"leftarrow":actionNeeded=!0,actionName="leftarrow",e.action="rightarrow";break;case"rightarrow":actionNeeded=!0,actionName="rightarrow",e.action="leftarrow"}switch(e.action){case"downarrow":case"uparrow":case"end":case"home":this.upDownKeyHandler(e);break;case"rightarrow":this.rightEnterKeyHandler(e);break;case"leftarrow":this.leftEscKeyHandler(e);break;case"enter":this.hamburgerMode&&"SPAN"===trgt.tagName&&trgt.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(e):this.rightEnterKeyHandler(e);break;case"escape":this.leftEscKeyHandler(e)}actionNeeded&&(e.action=actionName)}upDownKeyHandler(e){let cul=this.getUlByNavIdx(),defaultIdx="downarrow"===e.action||"home"===e.action?0:cul.childElementCount-1,fliIdx=defaultIdx,fli=this.getLIByClass(cul,FOCUSED);fli&&("end"!==e.action&&"home"!==e.action&&(fliIdx=this.getIdx(cul,fli)),fli.classList.remove(FOCUSED),"end"!==e.action&&"home"!==e.action&&("downarrow"===e.action?fliIdx++:fliIdx--,fliIdx===("downarrow"===e.action?cul.childElementCount:-1)&&(fliIdx=defaultIdx))),fliIdx=this.isValidLI(cul.children[fliIdx],fliIdx,e.action),cul.children[fliIdx].classList.add(FOCUSED),cul.children[fliIdx].focus()}isValidLI(cli,index,action){this.getWrapper();let cul=this.getUlByNavIdx();return(cli.classList.contains("e-separator")||cli.classList.contains("e-disabled")||cli.classList.contains(HIDE))&&("downarrow"===action||"rightarrow"===action?index++:index--),((cli=cul.children[index]).classList.contains("e-separator")||cli.classList.contains("e-disabled")||cli.classList.contains(HIDE))&&(index=this.isValidLI(cli,index,action)),index}getUlByNavIdx(navIdxLen=this.navIdx.length){if(this.isMenu){let popup=[this.getWrapper()].concat([].slice.call(ej2_base_es2015_selectAll(".e-menu-popup")))[navIdxLen];return isNullOrUndefined(popup)?null:ej2_base_es2015_select(".e-menu-parent",popup)}return this.getWrapper().children[navIdxLen]}rightEnterKeyHandler(e){let eventArgs,cul=this.getUlByNavIdx(),fli=this.getLIByClass(cul,FOCUSED);if(fli){let fliIdx=this.getIdx(cul,fli),navIdx=this.navIdx.concat(fliIdx),item=this.getItem(navIdx);item.items.length?(this.navIdx.push(fliIdx),this.keyType="right",this.action=e.action,this.openMenu(fli,item,null,null,e)):"enter"===e.action&&(this.isMenu&&0===this.navIdx.length?this.removeLIStateByClass(["e-selected"],[this.getWrapper()]):fli.classList.remove(FOCUSED),fli.classList.add("e-selected"),this.trigger("select",eventArgs={element:fli,item:item,event:e}),this.closeMenu(null,e))}}leftEscKeyHandler(e){this.navIdx.length?(this.keyType="left",this.closeMenu(this.navIdx.length,e)):"escape"===e.action&&this.closeMenu(null,e)}scrollHandler(e){this.closeMenu(null,e)}touchHandler(e){this.isTapHold=!0,this.cmenuHandler(e.originalEvent)}cmenuHandler(e){e.preventDefault(),this.isCMenu=!0,this.pageX=e.changedTouches?e.changedTouches[0].pageX+1:e.pageX+1,this.pageY=e.changedTouches?e.changedTouches[0].pageY+1:e.pageY+1,this.closeMenu(null,e),this.isCMenu&&(this.canOpen(e.target)&&this.openMenu(null,null,this.pageY,this.pageX,e),this.isCMenu=!1)}closeMenu(ulIndex=0,e=null){if(this.isMenuVisible()){let sli,ul,item,items,beforeCloseArgs,wrapper=this.getWrapper(),popups=this.getPopups(),isClose=!1,cnt=this.isMenu?popups.length+1:wrapper.childElementCount;ul=this.isMenu&&1!==cnt?ej2_base_es2015_select(".e-ul",popups[cnt-2]):ej2_base_es2015_selectAll(".e-menu-parent",wrapper)[cnt-1],this.isMenu&&ul.classList.contains("e-menu")&&((sli=this.getLIByClass(ul,"e-selected"))&&sli.classList.remove("e-selected"),isClose=!0),isClose||(item=this.navIdx.length?this.getItem(this.navIdx):null,this.trigger("beforeClose",beforeCloseArgs={element:ul,parentItem:item,items:items=item?item.items:this.items,event:e,cancel:!1},observedCloseArgs=>{let popupEle,closeArgs,popupObj,isOpen=!observedCloseArgs.cancel;if((isOpen||this.isCMenu)&&(this.isMenu?(popupEle=closest(ul,".e-menu-popup"),this.hamburgerMode&&(popupEle.parentElement.style.minHeight=""),this.unWireKeyboardEvent(popupEle),this.destroyScrollObj(getInstance(popupEle.children[0],ej2_navigations_es2015_VScroll),popupEle.children[0]),(popupObj=getInstance(popupEle,ej2_popups_es2015_Popup)).hide(),popupObj.destroy(),detach(popupEle)):this.toggleAnimation(ul,!1),this.trigger("onClose",closeArgs={element:ul,parentItem:item,items:items}),this.navIdx.pop()),this.isCMenu)this.canOpen(e.target)&&this.openMenu(null,null,this.pageY,this.pageX,e),this.isCMenu=!1;else if(isOpen&&this.hamburgerMode&&null!==ulIndex)this.afterCloseMenu(e);else if(isOpen&&!ulIndex&&this.navIdx.length)this.closeMenu(null,e);else if(!isOpen||this.isMenu||ulIndex||0!==this.navIdx.length||this.isMenusClosed)if(isOpen&&this.isMenu&&e&&e.target&&0!==this.navIdx.length&&closest(e.target,".e-menu-parent.e-control"))this.closeMenu(0,e);else if(!isOpen||"right"!==this.keyType&&"click"!==this.keyType){let cul=this.getUlByNavIdx(),sli=this.getLIByClass(cul,"e-selected");sli&&(sli.setAttribute("aria-expanded","false"),sli.classList.remove("e-selected"),sli.classList.add(FOCUSED),sli.focus())}else this.afterCloseMenu(e);else this.isMenusClosed=!0,this.closeMenu(0,e);this.removeStateWrapper()}))}}destroyScrollObj(scrollObj,scrollEle){scrollObj&&(scrollObj.destroy(),scrollEle.parentElement.appendChild(ej2_base_es2015_select(".e-menu-parent",scrollEle)),detach(scrollEle))}getPopups(){let popups=[];return[].slice.call(document.querySelectorAll(".e-menu-popup")).forEach(elem=>{this.getIndex(elem.querySelector("."+ITEM).id,!0).length&&popups.push(elem)}),popups}isMenuVisible(){return this.navIdx.length>0||this.element.classList.contains("e-contextmenu")&&isVisible(this.element).valueOf()}canOpen(target){let canOpen=!0;if(this.filter){canOpen=!1;let filter=this.filter.split(" ");for(let i=0,len=filter.length;i<len;i++)if(closest(target,"."+filter[i])){canOpen=!0;break}}return canOpen}openMenu(li,item,top=0,left=0,e=null,target=this.targetElement){let wrapper=this.getWrapper();this.lItem=li;let elemId=""!==this.element.id?this.element.id:"menu";if(this.isMenusClosed=!1,li){if(this.uList=this.createItems(item[this.getField("children",this.navIdx.length-1)]),!this.isMenu&&Browser.isDevice){wrapper.lastChild.style.display="none";let data={text:item[this.getField("text")].toString(),iconCss:"e-icons e-previous"},hdata=new ej2_navigations_es2015_MenuItem(this.items[0],"items",data,!0),hli=this.createItems([hdata]).children[0];hli.classList.add("e-menu-header"),this.uList.insertBefore(hli,this.uList.children[0])}this.isMenu?(this.popupWrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper e-menu-popup",id:li.id+"-ej2menu-"+elemId+"-popup"}),this.hamburgerMode?(top=li.offsetHeight,li.appendChild(this.popupWrapper)):document.body.appendChild(this.popupWrapper),this.isNestedOrVertical=this.element.classList.contains("e-vertical")||1!==this.navIdx.length,this.popupObj=this.generatePopup(this.popupWrapper,this.uList,li,this.isNestedOrVertical),this.hamburgerMode?this.calculateIndentSize(this.uList,li):(this.cssClass&&addClass([this.popupWrapper],this.cssClass.split(" ")),this.popupObj.hide()),this.triggerBeforeOpen(li,this.uList,item,e,0,0,"menu")):(this.uList.style.zIndex=this.element.style.zIndex,wrapper.appendChild(this.uList),this.triggerBeforeOpen(li,this.uList,item,e,top,left,"none"))}else this.uList=this.element,this.uList.style.zIndex=getZindexPartial(target||this.element).toString(),this.triggerBeforeOpen(li,this.uList,item,e,top,left,"none");if(this.isMenu&&this.template&&this.isBlazor()){let menuTemplateId=this.element.id+"Template";Object.keys(blazorTemplates).length&&(this.tempItem=this.tempItem.concat(blazorTemplates[menuTemplateId]),blazorTemplates[menuTemplateId]=this.tempItem),updateBlazorTemplate(menuTemplateId,"Template",this)}}calculateIndentSize(ul,li){let liStyle=getComputedStyle(li),liIndent=parseInt(liStyle.textIndent,10);this.navIdx.length<2&&!li.classList.contains("e-blankicon")?liIndent*=2:liIndent+=liIndent/4,ul.style.textIndent=liIndent+"px";let blankIconElem=ul.querySelectorAll(".e-blankicon");if(blankIconElem&&blankIconElem.length){let menuIconElem=ul.querySelector(".e-menu-icon"),menuIconElemStyle=getComputedStyle(menuIconElem),blankIconIndent=parseInt(menuIconElemStyle.marginRight,10)+menuIconElem.offsetWidth+liIndent;blankIconElem.forEach(element=>element.style.textIndent=blankIconIndent+"px")}}generatePopup(popupWrapper,ul,li,isNestedOrVertical){let popupObj=new ej2_popups_es2015_Popup(popupWrapper,{actionOnScroll:this.hamburgerMode?"none":"reposition",relateTo:li,collision:this.hamburgerMode?{X:"none",Y:"none"}:{X:isNestedOrVertical||this.enableRtl?"none":"flip",Y:"fit"},position:isNestedOrVertical&&!this.hamburgerMode?{X:"right",Y:"top"}:{X:"left",Y:"bottom"},targetType:"relative",enableRtl:this.enableRtl,content:ul,open:()=>{let scrollEle=ej2_base_es2015_select(".e-menu-vscroll",popupObj.element);scrollEle&&(scrollEle.style.height="inherit",scrollEle.style.maxHeight="");let ul=ej2_base_es2015_select(".e-ul",popupObj.element);popupObj.element.style.maxHeight="",ul.focus(),this.triggerOpen(ul)}});return popupObj}createHeaderContainer(wrapper){wrapper=wrapper||this.getWrapper();let spanElem=this.createElement("span",{className:"e-"+this.getModuleName()+"-header"}),spanTitle=this.createElement("span",{className:"e-"+this.getModuleName()+"-title",innerHTML:this.title}),spanIcon=this.createElement("span",{className:"e-icons e-"+this.getModuleName()+"-icon",attrs:{tabindex:"0"}});spanElem.appendChild(spanTitle),spanElem.appendChild(spanIcon),wrapper.insertBefore(spanElem,this.element)}openHamburgerMenu(e){this.hamburgerMode&&this.triggerBeforeOpen(null,this.element,null,e,0,0,"hamburger")}closeHamburgerMenu(e){if(this.hamburgerMode){let beforeCloseArgs;this.trigger("beforeClose",beforeCloseArgs={element:this.element,parentItem:null,event:e,items:this.items,cancel:!1},observedHamburgerCloseArgs=>{observedHamburgerCloseArgs.cancel||(this.closeMenu(null,e),this.element.classList.add("e-hide-menu"),this.trigger("onClose",{element:this.element,parentItem:null,items:this.items}))})}}callFit(element,x,y,top,left){return fit(element,null,{X:x,Y:y},{top:top,left:left})}triggerBeforeOpen(li,ul,item,e,top,left,type){this.getIndex(li?li.id:null,!0);let items=li?item[this.getField("children",this.navIdx.length-1)]:this.items,menuType=type;this.trigger("beforeOpen",{element:ul,items:items,parentItem:item,event:e,cancel:!1,top:top,left:left},observedOpenArgs=>{switch(menuType){case"menu":let collide;if(this.hamburgerMode||(this.top=observedOpenArgs.top,this.left=observedOpenArgs.left),this.popupWrapper.style.display="block",this.hamburgerMode||(this.popupWrapper.style.maxHeight=this.popupWrapper.getBoundingClientRect().height+"px",this.addScrolling(this.popupWrapper,this.uList,"vscroll",this.popupWrapper.offsetHeight,this.uList.offsetHeight),this.checkScrollOffset(e)),this.hamburgerMode||this.left||this.top)this.popupObj.collision={X:"none",Y:"none"};else{if(this.popupObj.refreshPosition(this.lItem,!0),this.left=parseInt(this.popupWrapper.style.left,10),this.top=parseInt(this.popupWrapper.style.top,10),this.enableRtl&&(this.left=this.isNestedOrVertical?this.left-this.popupWrapper.offsetWidth-this.lItem.parentElement.offsetWidth:this.left-this.popupWrapper.offsetWidth+this.lItem.offsetWidth),collide=isCollide(this.popupWrapper,null,this.left,this.top),(this.isNestedOrVertical||this.enableRtl)&&(collide.indexOf("right")>-1||collide.indexOf("left")>-1)){this.popupObj.collision.X="none";let offWidth=closest(this.lItem,".e-"+this.getModuleName()+"-wrapper").offsetWidth;this.left=this.enableRtl?calculatePosition(this.lItem,this.isNestedOrVertical?"right":"left","top").left:this.left-this.popupWrapper.offsetWidth-offWidth}((collide=isCollide(this.popupWrapper,null,this.left,this.top)).indexOf("left")>-1||collide.indexOf("right")>-1)&&(this.left=this.callFit(this.popupWrapper,!0,!1,this.top,this.left).left),this.popupWrapper.style.left=this.left+"px"}this.popupWrapper.style.display="";break;case"none":this.top=observedOpenArgs.top,this.left=observedOpenArgs.left;break;case"hamburger":observedOpenArgs.cancel||(this.element.classList.remove("e-hide-menu"),this.triggerOpen(this.element))}if("hamburger"!==menuType&&(observedOpenArgs.cancel?(this.isMenu&&(this.popupObj.destroy(),detach(this.popupWrapper)),this.navIdx.pop()):this.isMenu?this.hamburgerMode?(this.popupWrapper.style.top=this.top+"px",this.popupWrapper.style.left="0px",this.toggleAnimation(this.popupWrapper)):(this.wireKeyboardEvent(this.popupWrapper),rippleEffect(this.popupWrapper,{selector:"."+ITEM}),this.popupWrapper.style.left=this.left+"px",this.popupWrapper.style.top=this.top+"px",this.popupObj.show("None"!==this.animationSettings.effect?{name:this.animationSettings.effect,duration:this.animationSettings.duration,timingFunction:this.animationSettings.easing}:null,this.lItem)):(this.setPosition(this.lItem,this.uList,this.top,this.left),this.toggleAnimation(this.uList))),"right"===this.keyType){let cul=this.getUlByNavIdx();li.classList.remove(FOCUSED),this.isMenu&&1===this.navIdx.length&&this.removeLIStateByClass(["e-selected"],[this.getWrapper()]),li.classList.add("e-selected"),"enter"===this.action&&this.trigger("select",{element:li,item:item,event:e}),li.focus(),cul=this.getUlByNavIdx();let index=this.isValidLI(cul.children[0],0,this.action);cul.children[index].classList.add(FOCUSED),cul.children[index].focus()}})}checkScrollOffset(e){let wrapper=this.getWrapper();if(wrapper.children[0].classList.contains("e-menu-hscroll")&&1===this.navIdx.length){let offsetLeft,offsetRight,trgt=isNullOrUndefined(e)?this.element:closest(e.target,"."+ITEM),offsetEle=ej2_base_es2015_select(".e-hscroll-bar",wrapper);offsetEle.scrollLeft>trgt.offsetLeft&&(offsetEle.scrollLeft-=offsetEle.scrollLeft-trgt.offsetLeft),(offsetLeft=offsetEle.scrollLeft+offsetEle.offsetWidth)<(offsetRight=trgt.offsetLeft+trgt.offsetWidth)&&(offsetEle.scrollLeft+=offsetRight-offsetLeft)}}addScrolling(wrapper,ul,scrollType,wrapperOffset,contentOffset){if(this.enableScrolling&&wrapperOffset<contentOffset){let scrollObj,scrollEle=this.createElement("div",{className:"e-menu-"+scrollType});wrapper.appendChild(scrollEle),scrollEle.appendChild(ul),scrollEle.style.maxHeight=wrapper.style.maxHeight,wrapper.style.overflow="hidden","vscroll"===scrollType?(scrollObj=new ej2_navigations_es2015_VScroll({enableRtl:this.enableRtl},scrollEle)).scrollStep=ej2_base_es2015_select(".e-"+scrollType+"-bar",wrapper).offsetHeight/2:(scrollObj=new ej2_navigations_es2015_HScroll({enableRtl:this.enableRtl},scrollEle)).scrollStep=ej2_base_es2015_select(".e-"+scrollType+"-bar",wrapper).offsetWidth}}setPosition(li,ul,top,left){if(this.toggleVisiblity(ul),ul===this.element||!isNullOrUndefined(left)&&!isNullOrUndefined(top)){let collide=isCollide(ul,null,left,top);collide.indexOf("right")>-1&&(left-=ul.offsetWidth),collide.indexOf("bottom")>-1&&(top=this.callFit(ul,!1,!0,top,left).top-20),(collide=isCollide(ul,null,left,top)).indexOf("left")>-1&&(left=this.callFit(ul,!0,!1,top,left).left)}else if(Browser.isDevice)top=Number(this.element.style.top.replace("px","")),left=Number(this.element.style.left.replace("px",""));else{let offset=calculatePosition(li,this.enableRtl?"left":"right","top");left=offset.left;let collide=isCollide(ul,null,this.enableRtl?left-ul.offsetWidth:left,top=offset.top),xCollision=collide.indexOf("left")>-1||collide.indexOf("right")>-1;xCollision&&(left=(offset=calculatePosition(li,this.enableRtl?"right":"left","top")).left),(this.enableRtl||xCollision)&&(left=this.enableRtl&&xCollision?left:left-ul.offsetWidth),collide.indexOf("bottom")>-1&&(top=(offset=this.callFit(ul,!1,!0,top,left)).top)}this.toggleVisiblity(ul,!1),ul.style.top=top+"px",ul.style.left=left+"px"}toggleVisiblity(ul,isVisible$$1=!0){ul.style.visibility=isVisible$$1?"hidden":"",ul.style.display=isVisible$$1?"block":"none"}createItems(items){let level=this.navIdx?this.navIdx.length:0,showIcon=this.hasField(items,this.getField("iconCss",level)),listBaseOptions={showIcon:showIcon,moduleName:"menu",fields:this.getFields(level),template:this.template,itemCreating:args=>{args.curData[args.fields.id]||(args.curData[args.fields.id]=getUniqueID("menuitem")),args.curData.htmlAttributes={role:"menuitem",tabindex:"-1"},this.isMenu&&!args.curData[this.getField("separator",level)]&&(args.curData.htmlAttributes["aria-label"]=args.curData[args.fields.text]),""===args.curData[args.fields.iconCss]&&(args.curData[args.fields.iconCss]=null)},itemCreated:args=>{if(args.curData[this.getField("separator",level)]&&(args.item.classList.add("e-separator"),args.item.removeAttribute("role")),!showIcon||args.curData[args.fields.iconCss]||args.curData[this.getField("separator",level)]||args.item.classList.add("e-blankicon"),args.curData[args.fields.child]&&args.curData[args.fields.child].length){let span=this.createElement("span",{className:"e-icons e-caret"});args.item.appendChild(span),args.item.setAttribute("aria-haspopup","true"),args.item.setAttribute("aria-expanded","false"),this.isMenu||args.item.removeAttribute("role"),args.item.classList.add("e-menu-caret-icon")}this.isMenu&&this.template&&(args.item.setAttribute("id",args.curData[args.fields.id].toString()),args.item.removeAttribute("data-uid")),this.trigger("beforeItemRender",{item:args.curData,element:args.item})}};this.setProperties({items:this.items},!0),this.isMenu&&(listBaseOptions.templateID=this.element.id+"Template");let ul=ej2_lists_es2015_ListBase.createList(this.createElement,items,listBaseOptions,!this.template);return ul.setAttribute("tabindex","0"),this.isMenu&&ul.setAttribute("role","menu"),ul}moverHandler(e){let trgt=e.target;this.liTrgt=trgt;let ulId,cli=this.getLI(trgt),wrapper=cli?closest(cli,".e-"+this.getModuleName()+"-wrapper"):this.getWrapper(),hdrWrapper=this.getWrapper(),regex=new RegExp("-ej2menu-(.*)-popup"),isDifferentElem=!1;if(wrapper){if((ulId=""!==wrapper.id?regex.exec(wrapper.id)[1]:wrapper.querySelector("ul").id)!==this.element.id){if(this.removeLIStateByClass([FOCUSED,"e-selected"],[this.getWrapper()]),!this.navIdx.length)return;isDifferentElem=!0}cli&&closest(cli,".e-"+this.getModuleName()+"-wrapper")&&!isDifferentElem&&(this.removeLIStateByClass([FOCUSED],this.isMenu?[wrapper].concat(this.getPopups()):[wrapper]),this.removeLIStateByClass([FOCUSED],this.isMenu?[hdrWrapper].concat(this.getPopups()):[hdrWrapper]),cli.classList.add(FOCUSED),this.showItemOnClick||this.clickHandler(e)),this.isMenu&&(this.showItemOnClick||trgt.parentElement===wrapper||closest(trgt,".e-"+this.getModuleName()+"-popup")||cli&&(!cli||this.getIndex(cli.id,!0).length)?isDifferentElem&&this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,e)):(this.removeLIStateByClass([FOCUSED,"e-selected"],[wrapper]),this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,e))),this.isClosed||this.removeStateWrapper(),this.isClosed=!1)}}removeStateWrapper(){if(this.liTrgt){let wrapper=closest(this.liTrgt,".e-menu-vscroll");"DIV"===this.liTrgt.tagName&&wrapper&&this.removeLIStateByClass([FOCUSED,"e-selected"],[wrapper])}}removeLIStateByClass(classList$$1,element){let li;for(let i=0;i<element.length;i++)classList$$1.forEach(className=>{(li=ej2_base_es2015_select("."+className,element[i]))&&li.classList.remove(className)})}getField(propName,level=0){let fieldName=this.fields[propName];return"string"==typeof fieldName?fieldName:fieldName[level]?fieldName[level].toString():fieldName[fieldName.length-1].toString()}getFields(level=0){return{id:this.getField("itemId",level),iconCss:this.getField("iconCss",level),text:this.getField("text",level),url:this.getField("url",level),child:this.getField("children",level),separator:this.getField("separator",level)}}hasField(items,field){for(let i=0,len=items.length;i<len;i++)if(items[i][field])return!0;return!1}menuHeaderClickHandler(e){this.element.classList.contains("e-hide-menu")?this.openHamburgerMenu(e):this.closeHamburgerMenu(e)}clickHandler(e){if(this.isTapHold)this.isTapHold=!1;else{let wrapper=this.getWrapper(),trgt=e.target,cli=this.cli=this.getLI(trgt),cliWrapper=cli?closest(cli,".e-"+this.getModuleName()+"-wrapper"):null,isInstLI=cli&&cliWrapper&&(this.isMenu?this.getIndex(cli.id,!0).length>0:wrapper.firstElementChild.id===cliWrapper.firstElementChild.id);if(isInstLI&&"click"===e.type&&!cli.classList.contains("e-menu-header")){this.setLISelected(cli);let navIdx=this.getIndex(cli.id,!0),item=this.getItem(navIdx);this.trigger("select",{element:cli,item:item,event:e})}if(isInstLI&&("mouseover"===e.type||Browser.isDevice||this.showItemOnClick)){let ul;if(cli.classList.contains("e-menu-header")){this.toggleAnimation(ul=wrapper.children[this.navIdx.length-1]);let sli=this.getLIByClass(ul,"e-selected");sli&&sli.classList.remove("e-selected"),detach(cli.parentNode),this.navIdx.pop()}else if(!cli.classList.contains("e-separator")){this.showSubMenu=!0;let cul=cli.parentNode;if(this.cliIdx=this.getIdx(cul,cli),this.isMenu||!Browser.isDevice){let culIdx=this.isMenu?Array.prototype.indexOf.call([wrapper].concat(this.getPopups()),closest(cul,".e-"+this.getModuleName()+"-wrapper")):this.getIdx(wrapper,cul);if(this.navIdx[culIdx]===this.cliIdx&&(this.showSubMenu=!1),culIdx!==this.navIdx.length&&("mouseover"!==e.type||this.showSubMenu)){let sli=this.getLIByClass(cul,"e-selected");sli&&sli.classList.remove("e-selected"),this.isClosed=!0,this.keyType="click",this.closeMenu(culIdx+1,e)}}this.isClosed||this.afterCloseMenu(e),this.isClosed=!1}}else if(this.isMenu&&"DIV"===trgt.tagName&&this.navIdx.length&&closest(trgt,".e-menu-vscroll")){let popupEle=closest(trgt,".e-menu-popup"),cIdx=Array.prototype.indexOf.call(this.getPopups(),popupEle)+1;cIdx<this.navIdx.length&&(this.closeMenu(cIdx+1,e),this.removeLIStateByClass([FOCUSED,"e-selected"],[popupEle]))}else this.isMenu&&this.hamburgerMode&&"SPAN"===trgt.tagName&&trgt.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(e):"UL"===trgt.tagName&&trgt.parentElement===wrapper||cli&&cli.querySelector(".e-caret")||this.closeMenu(null,e)}}afterCloseMenu(e){if(this.showSubMenu){let idx=this.navIdx.concat(this.cliIdx),item=this.getItem(idx);item[this.getField("children",idx.length-1)]&&item[this.getField("children",idx.length-1)].length?(("mouseover"===e.type||Browser.isDevice&&this.isMenu)&&this.setLISelected(this.cli),this.cli.setAttribute("aria-expanded","true"),this.navIdx.push(this.cliIdx),this.openMenu(this.cli,item,null,null,e)):"mouseover"!==e.type&&this.closeMenu(null,e)}this.keyType=""}setLISelected(li){let sli=this.getLIByClass(li.parentElement,"e-selected");sli&&sli.classList.remove("e-selected"),this.isMenu||li.classList.remove(FOCUSED),li.classList.add("e-selected")}getLIByClass(ul,classname){for(let i=0,len=ul.children.length;i<len;i++)if(ul.children[i].classList.contains(classname))return ul.children[i];return null}getItem(navIdx){let idx=(navIdx=navIdx.slice()).pop();return this.getItems(navIdx)[idx]}getItems(navIdx){let items=this.items;for(let i=0;i<navIdx.length;i++)items=items[navIdx[i]][this.getField("children",i)];return items}getIdx(ul,li,skipHdr=!0){let idx=Array.prototype.indexOf.call(ul.querySelectorAll("li"),li);return idx=this.isMenu&&this.template&&this.isBlazor()?Array.prototype.indexOf.call(ul.querySelectorAll(li.tagName),li):Array.prototype.indexOf.call(ul.children,li),skipHdr&&ul.children[0].classList.contains("e-menu-header")&&idx--,idx}getLI(elem){return"LI"===elem.tagName&&elem.classList.contains("e-menu-item")?elem:closest(elem,"li.e-menu-item")}isBlazor(){return-1!==Object.keys(window).indexOf("ejsInterop")}removeChildElement(elem){for(;elem.firstElementChild;)elem.removeChild(elem.firstElementChild);return elem}onPropertyChanged(newProp,oldProp){let wrapper=this.getWrapper();for(let prop of Object.keys(newProp))switch(prop){case"cssClass":oldProp.cssClass&&removeClass([wrapper],oldProp.cssClass.split(" ")),newProp.cssClass&&addClass([wrapper],newProp.cssClass.split(" "));break;case"enableRtl":wrapper.classList.toggle("e-rtl");break;case"showItemOnClick":this.unWireEvents(),this.showItemOnClick=newProp.showItemOnClick,this.wireEvents();break;case"enableScrolling":if(newProp.enableScrolling){let ul;this.element.classList.contains("e-vertical")?this.addScrolling(wrapper,this.element,"vscroll",wrapper.offsetHeight,this.element.offsetHeight):this.addScrolling(wrapper,this.element,"hscroll",wrapper.offsetWidth,this.element.offsetWidth),this.getPopups().forEach(wrapper=>{ul=ej2_base_es2015_select(".e-ul",wrapper),this.addScrolling(wrapper,ul,"vscroll",wrapper.offsetHeight,ul.offsetHeight)})}else{let ul=wrapper.children[0];this.element.classList.contains("e-vertical")?this.destroyScrollObj(getInstance(ul,ej2_navigations_es2015_VScroll),ul):this.destroyScrollObj(getInstance(ul,ej2_navigations_es2015_HScroll),ul),wrapper.style.overflow="",wrapper.appendChild(this.element),this.getPopups().forEach(wrapper=>{this.destroyScrollObj(getInstance(ul=wrapper.children[0],ej2_navigations_es2015_VScroll),ul),wrapper.style.overflow=""})}break;case"items":let idx,navIdx,item;if(Object.keys(oldProp.items).length){let keys=Object.keys(newProp.items);for(let i=0;i<keys.length;i++)(navIdx=this.getChangedItemIndex(newProp,[],Number(keys[i]))).length<=this.getWrapper().children.length&&(idx=navIdx.pop(),item=this.getItems(navIdx),this.insertAfter([item[idx]],item[idx].text),item=this.getItems(navIdx),this.removeItem(item,navIdx,idx)),navIdx.length=0}else{let ul=this.element;this.isBlazor()?ul=this.removeChildElement(this.element):ul.innerHTML="",[].slice.call(this.createItems(this.items).children).forEach(li=>{ul.appendChild(li)});for(let i=1,count=wrapper.childElementCount;i<count;i++)detach(wrapper.lastElementChild);this.navIdx=[]}}}getChangedItemIndex(newProp,index,idx){index.push(idx);let key=Object.keys(newProp.items[idx]).pop();if("items"===key){let item=newProp.items[idx];this.getChangedItemIndex(item,index,Number(Object.keys(item.items).pop()))}else"isParentArray"===key&&index.length>1&&index.pop();return index}removeItem(item,navIdx,idx){item.splice(idx,1);let uls=this.getWrapper().children;navIdx.length<uls.length&&detach(uls[navIdx.length].children[idx])}unWireEvents(targetSelctor=this.target){let wrapper=this.getWrapper();if(targetSelctor){let target,touchModule,targetElems=ej2_base_es2015_selectAll(targetSelctor);for(let i=0,len=targetElems.length;i<len;i++)target=targetElems[i],this.isMenu?EventHandler.remove(target,"click",this.menuHeaderClickHandler):Browser.isIos?(touchModule=getInstance(target,ej2_base_es2015_Touch))&&touchModule.destroy():EventHandler.remove(target,"contextmenu",this.cmenuHandler);if(!this.isMenu)for(let parent of getScrollableParent(this.targetElement))EventHandler.remove(parent,"scroll",this.scrollHandler)}Browser.isDevice||(EventHandler.remove(this.isMenu?document:wrapper,"mouseover",this.delegateMoverHandler),EventHandler.remove(document,"mousedown",this.delegateMouseDownHandler)),EventHandler.remove(document,"click",this.delegateClickHandler),this.unWireKeyboardEvent(wrapper),this.rippleFn()}unWireKeyboardEvent(element){let keyboardModule=getInstance(element,ej2_base_es2015_KeyboardEvents);keyboardModule&&keyboardModule.destroy()}toggleAnimation(ul,isMenuOpen=!0){let pUlHeight,pElement;"None"!==this.animationSettings.effect&&isMenuOpen?this.animation.animate(ul,{name:this.animationSettings.effect,duration:this.animationSettings.duration,timingFunction:this.animationSettings.easing,begin:options=>{this.hamburgerMode?(pElement=options.element.parentElement,options.element.style.position="absolute",pUlHeight=pElement.offsetHeight,options.element.style.maxHeight=options.element.offsetHeight+"px",pElement.style.maxHeight=""):(options.element.style.display="block",options.element.style.maxHeight=options.element.getBoundingClientRect().height+"px")},progress:options=>{this.hamburgerMode&&(pElement.style.minHeight=pUlHeight+options.element.offsetHeight+"px")},end:options=>{this.hamburgerMode?(options.element.style.position="",options.element.style.maxHeight="",pElement.style.minHeight="",options.element.style.top="0px",options.element.children[0].focus(),this.triggerOpen(options.element.children[0])):this.end(options.element,isMenuOpen)}}):this.end(ul,isMenuOpen)}triggerOpen(ul){let item=this.navIdx.length?this.getItem(this.navIdx):null;this.trigger("onOpen",{element:ul,parentItem:item,items:item?item.items:this.items})}end(ul,isMenuOpen){if(isMenuOpen)if(ul.style.display="block",ul.style.maxHeight="",this.triggerOpen(ul),ul.querySelector("."+FOCUSED))ul.querySelector("."+FOCUSED).focus();else{let ele;(ele=this.getWrapper().children[this.getIdx(this.getWrapper(),ul)-1])?ele.querySelector(".e-selected").focus():this.element.focus()}else if(ul===this.element){let fli=this.getLIByClass(this.element,FOCUSED);fli&&fli.classList.remove(FOCUSED);let sli=this.getLIByClass(this.element,"e-selected");sli&&sli.classList.remove("e-selected"),ul.style.display="none"}else detach(ul)}getPersistData(){return""}getWrapper(){return closest(this.element,".e-"+this.getModuleName()+"-wrapper")}getIndex(data,isUniqueId,items=this.items,nIndex=[],isCallBack=!1,level=0){let item;level=isCallBack?level+1:0;for(let i=0,len=items.length;i<len;i++){if(item=items[i],(isUniqueId?item[this.getField("itemId",level)]:item[this.getField("text",level)])===data){nIndex.push(i);break}if(item[this.getField("children",level)]&&item[this.getField("children",level)].length){if(-1!==(nIndex=this.getIndex(data,isUniqueId,item[this.getField("children",level)],nIndex,!0,level))[nIndex.length-1]){nIndex.unshift(i);break}i!==len-1&&nIndex.pop()}else i===len-1&&nIndex.push(-1)}return isCallBack||-1!==nIndex[0]?nIndex:[]}enableItems(items,enable=!0,isUniqueId){let ul,idx,navIdx,disabled="e-disabled";for(let i=0;i<items.length;i++)idx=(navIdx=this.getIndex(items[i],isUniqueId)).pop(),(ul=this.getUlByNavIdx(navIdx.length))&&(enable?this.isMenu?(ul.children[idx].classList.remove(disabled),ul.children[idx].removeAttribute("aria-disabled")):Browser.isDevice&&!ul.classList.contains("e-contextmenu")?ul.children[idx+1].classList.remove(disabled):ul.children[idx].classList.remove(disabled):this.isMenu?(ul.children[idx].classList.add(disabled),ul.children[idx].setAttribute("aria-disabled","true")):Browser.isDevice&&!ul.classList.contains("e-contextmenu")?ul.children[idx+1].classList.add(disabled):ul.children[idx].classList.add(disabled))}showItems(items,isUniqueId){this.showHideItems(items,!1,isUniqueId)}hideItems(items,isUniqueId){this.showHideItems(items,!0,isUniqueId)}showHideItems(items,ishide,isUniqueId){let ul,index,navIdx;for(let i=0;i<items.length;i++)index=(navIdx=this.getIndex(items[i],isUniqueId)).pop(),(ul=this.getUlByNavIdx(navIdx.length))&&(ishide?Browser.isDevice&&!ul.classList.contains("e-contextmenu")?ul.children[index+1].classList.add(HIDE):ul.children[index].classList.add(HIDE):Browser.isDevice&&!ul.classList.contains("e-contextmenu")?ul.children[index+1].classList.remove(HIDE):ul.children[index].classList.remove(HIDE))}removeItems(items,isUniqueId){let idx,navIdx,iitems;for(let i=0;i<items.length;i++)idx=(navIdx=this.getIndex(items[i],isUniqueId)).pop(),iitems=this.getItems(navIdx),this.removeItem(iitems,navIdx,idx)}insertAfter(items,text,isUniqueId){this.insertItems(items,text,isUniqueId)}insertBefore(items,text,isUniqueId){this.insertItems(items,text,isUniqueId,!1)}insertItems(items,text,isUniqueId,isAfter=!0){let li,idx,navIdx,iitems,menuitem,showIcon;for(let i=0;i<items.length;i++){idx=(navIdx=this.getIndex(text,isUniqueId)).pop(),iitems=this.getItems(navIdx),menuitem=new ej2_navigations_es2015_MenuItem(iitems[0],"items",items[i],!0),iitems.splice(isAfter?idx+1:idx,0,menuitem);let uls=this.isMenu?[this.getWrapper()].concat(this.getPopups()):[].slice.call(this.getWrapper().children);if(navIdx.length<uls.length){idx=isAfter?idx+1:idx,showIcon=this.hasField(iitems,this.getField("iconCss",navIdx.length-1)),li=this.createItems(iitems).children[idx];let ul=this.isMenu?ej2_base_es2015_select(".e-menu-parent",uls[navIdx.length]):uls[navIdx.length];ul.insertBefore(li,ul.children[idx])}}}removeAttributes(){["top","left","display","z-index"].forEach(key=>{this.element.style.removeProperty(key)}),["role","tabindex","class","style"].forEach(key=>{"class"===key&&this.element.classList.contains("e-menu-parent")&&this.element.classList.remove("e-menu-parent"),-1!==["class","style"].indexOf(key)&&this.element.getAttribute(key)||this.element.removeAttribute(key),this.isMenu&&"class"===key&&this.element.classList.contains("e-vertical")&&this.element.classList.remove("e-vertical")})}destroy(){let wrapper=this.getWrapper();if(wrapper){if(this.unWireEvents(),this.isMenu)this.closeMenu(),this.isBlazor()?this.element=this.removeChildElement(this.element):this.element.innerHTML="",this.removeAttributes(),wrapper.parentNode.insertBefore(this.element,wrapper);else{if(this.clonedElement.style.display="","EJS-CONTEXTMENU"===this.clonedElement.tagName)addClass([this.clonedElement],["e-control","e-lib","e-"+this.getModuleName()]),this.element=this.clonedElement;else if(this.refreshing&&this.clonedElement.childElementCount&&"LI"===this.clonedElement.children[0].tagName&&this.setProperties({items:[]},!0),document.getElementById(this.clonedElement.id)){let refEle=this.clonedElement.nextElementSibling;refEle&&refEle!==wrapper?this.clonedElement.parentElement.insertBefore(this.element,refEle):this.clonedElement.parentElement.appendChild(this.element),this.isBlazor()?this.element=this.removeChildElement(this.element):this.element.innerHTML="",append([].slice.call(this.clonedElement.children),this.element),detach(this.clonedElement),this.removeAttributes()}this.clonedElement=null}this.isMenu&&this.clonedElement?(detach(this.element),wrapper.style.display="",wrapper.classList.remove("e-"+this.getModuleName()+"-wrapper"),wrapper.removeAttribute("data-ripple")):detach(wrapper),super.destroy()}}};return __decorate([ej2_base_es2015_Event()],MenuBase.prototype,"beforeItemRender",void 0),__decorate([ej2_base_es2015_Event()],MenuBase.prototype,"beforeOpen",void 0),__decorate([ej2_base_es2015_Event()],MenuBase.prototype,"onOpen",void 0),__decorate([ej2_base_es2015_Event()],MenuBase.prototype,"beforeClose",void 0),__decorate([ej2_base_es2015_Event()],MenuBase.prototype,"onClose",void 0),__decorate([ej2_base_es2015_Event()],MenuBase.prototype,"select",void 0),__decorate([ej2_base_es2015_Event()],MenuBase.prototype,"created",void 0),__decorate([Property("")],MenuBase.prototype,"cssClass",void 0),__decorate([Property(!1)],MenuBase.prototype,"showItemOnClick",void 0),__decorate([Property("")],MenuBase.prototype,"target",void 0),__decorate([Property("")],MenuBase.prototype,"filter",void 0),__decorate([Property(null)],MenuBase.prototype,"template",void 0),__decorate([Property(!1)],MenuBase.prototype,"enableScrolling",void 0),__decorate([Complex({},ej2_navigations_es2015_FieldSettings)],MenuBase.prototype,"fields",void 0),__decorate([Collection([],ej2_navigations_es2015_MenuItem)],MenuBase.prototype,"items",void 0),__decorate([Complex({},ej2_navigations_es2015_MenuAnimationSettings)],MenuBase.prototype,"animationSettings",void 0),__decorate([NotifyPropertyChanges],MenuBase)})();const CLS_ITEMS="e-toolbar-items",CLS_ITEM="e-toolbar-item",CLS_POPUP="e-toolbar-popup";let ej2_navigations_es2015_Item=(()=>{class Item extends ChildProperty{}return __decorate([Property("")],Item.prototype,"id",void 0),__decorate([Property("")],Item.prototype,"text",void 0),__decorate([Property("auto")],Item.prototype,"width",void 0),__decorate([Property("")],Item.prototype,"cssClass",void 0),__decorate([Property(!1)],Item.prototype,"showAlwaysInPopup",void 0),__decorate([Property("")],Item.prototype,"prefixIcon",void 0),__decorate([Property("")],Item.prototype,"suffixIcon",void 0),__decorate([Property("None")],Item.prototype,"overflow",void 0),__decorate([Property("")],Item.prototype,"template",void 0),__decorate([Property("Button")],Item.prototype,"type",void 0),__decorate([Property("Both")],Item.prototype,"showTextOn",void 0),__decorate([Property(null)],Item.prototype,"htmlAttributes",void 0),__decorate([Property("")],Item.prototype,"tooltipText",void 0),__decorate([Property("Left")],Item.prototype,"align",void 0),__decorate([ej2_base_es2015_Event()],Item.prototype,"click",void 0),Item})(),ej2_navigations_es2015_Toolbar=(()=>{let Toolbar=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.resizeContext=this.resize.bind(this),this.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"}}destroy(){let ele=this.element;for(super.destroy(),this.unwireEvents(),this.tempId.forEach(ele=>{isNullOrUndefined(this.element.querySelector(ele))||(document.body.appendChild(this.element.querySelector(ele)).style.display="none")});ele.firstElementChild;)ele.removeChild(ele.firstElementChild);this.trgtEle&&ele.appendChild(this.ctrlTem),this.clearProperty(),this.popObj=null,this.tbarAlign=null,this.remove(this.element,"e-toolpop"),ele.removeAttribute("style"),["aria-disabled","aria-orientation","aria-haspopup","role"].forEach(attrb=>{this.element.removeAttribute(attrb)})}preRender(){let eventArgs={enableCollision:this.enableCollision,scrollStep:this.scrollStep};this.trigger("beforeCreate",eventArgs),this.enableCollision=eventArgs.enableCollision,this.scrollStep=eventArgs.scrollStep,this.scrollModule=null,this.popObj=null,this.tempId=[],this.tbarItemsCol=this.items,this.isVertical=!!this.element.classList.contains("e-vertical"),this.isExtendedOpen=!1,this.popupPriCount=0,this.enableRtl&&this.add(this.element,"e-rtl")}wireEvents(){EventHandler.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resizeContext),this.keyModule=new ej2_base_es2015_KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),EventHandler.add(this.element,"keydown",this.docKeyDown,this),this.element.setAttribute("tabIndex","0")}docKeyDown(e){if("INPUT"===e.target.tagName)return;let popCheck=!isNullOrUndefined(this.popObj)&&isVisible(this.popObj.element)&&"Extended"!==this.overflowMode;9===e.keyCode&&!0===e.target.classList.contains("e-hor-nav")&&popCheck&&this.popObj.hide({name:"FadeOut",duration:100}),(40===e.keyCode||38===e.keyCode||35===e.keyCode||36===e.keyCode)&&e.preventDefault()}unwireEvents(){EventHandler.remove(this.element,"click",this.clickHandler),this.destroyScroll(),this.keyModule.destroy(),window.removeEventListener("resize",this.resizeContext),EventHandler.remove(document,"scroll",this.docEvent),EventHandler.remove(this.element,"keydown",this.docKeyDown),EventHandler.remove(document,"click",this.docEvent)}clearProperty(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}}docEvent(e){let popEle=closest(e.target,".e-popup");this.popObj&&isVisible(this.popObj.element)&&!popEle&&"Popup"===this.overflowMode&&this.popObj.hide({name:"FadeOut",duration:100})}destroyScroll(){this.scrollModule&&(this.tbarAlign&&this.add(this.scrollModule.element,"e-tbar-pos"),this.scrollModule.destroy(),this.scrollModule=null)}destroyItems(){[].slice.call(this.element.querySelectorAll("."+CLS_ITEM)).forEach(el=>{detach(el)});let tbarItems=this.element.querySelector("."+CLS_ITEMS);this.tbarAlign&&([].slice.call(tbarItems.children).forEach(el=>{detach(el)}),this.tbarAlign=!1,this.remove(tbarItems,"e-tbar-pos")),this.clearProperty()}destroyMode(){this.scrollModule&&(this.remove(this.scrollModule.element,"e-rtl"),this.destroyScroll()),this.remove(this.element,"e-tbar-extended"),this.remove(this.element,"e-extended-toolbar");let tempEle=this.element.querySelector(".e-toolbar-multirow");tempEle&&this.remove(tempEle,"e-toolbar-multirow"),this.popObj&&this.popupRefresh(this.popObj.element,!0)}add(ele,val){ele.classList.add(val)}remove(ele,val){ele.classList.remove(val)}elementFocus(ele){let fChild=ele.firstElementChild;fChild?(fChild.focus(),this.activeEleSwitch(ele)):ele.focus()}clstElement(tbrNavChk,trgt){return tbrNavChk&&this.popObj&&isVisible(this.popObj.element)?this.popObj.element.querySelector("."+CLS_ITEM):this.element===trgt||tbrNavChk?this.element.querySelector("."+CLS_ITEM+":not(.e-overlay ):not(.e-separator ):not(.e-hidden )"):closest(trgt,"."+CLS_ITEM)}keyHandling(clst,e,trgt,navChk,scrollChk){let popObj=this.popObj,rootEle=this.element,popAnimate={name:"FadeOut",duration:100};switch(e.action){case"moveRight":if(this.isVertical)return;rootEle===trgt?this.elementFocus(clst):navChk||this.eleFocus(clst,"next");break;case"moveLeft":if(this.isVertical)return;navChk||this.eleFocus(clst,"previous");break;case"home":case"end":let ele,nodes;if(clst){let popupCheck=closest(clst,".e-popup");popupCheck?isVisible(this.popObj.element)&&(nodes=[].slice.call(popupCheck.children),ele="home"===e.action?nodes[0]:nodes[nodes.length-1]):(nodes=this.element.querySelectorAll("."+CLS_ITEMS+" ."+CLS_ITEM),ele="home"===e.action?nodes[0]:nodes[nodes.length-1]),ele&&this.elementFocus(ele)}break;case"moveUp":case"moveDown":let value="moveUp"===e.action?"previous":"next";if(this.isVertical)this.eleFocus(clst,"moveUp"===e.action?"previous":"next");else if(popObj&&closest(trgt,".e-popup")){let popEle=popObj.element,popFrstEle=popEle.firstElementChild;if("previous"===value&&popFrstEle===clst||"next"===value&&popEle.lastElementChild===clst)return;this.eleFocus(clst,value)}else"moveDown"===e.action&&popObj&&isVisible(popObj.element)&&this.elementFocus(clst);break;case"tab":if(!scrollChk&&!navChk){let ele=clst.firstElementChild;rootEle===trgt&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(ele),ele.focus()),this.element.removeAttribute("tabindex"))}break;case"popupClose":popObj&&"Extended"!==this.overflowMode&&popObj.hide(popAnimate);break;case"popupOpen":if(!navChk)return;popObj&&!isVisible(popObj.element)?(popObj.element.style.top=rootEle.offsetHeight+"px",popObj.show({name:"FadeIn",duration:100})):popObj.hide(popAnimate)}}keyActionHandler(e){let clst,trgt=e.target;if("INPUT"===trgt.tagName||"TEXTAREA"===trgt.tagName||this.element.classList.contains("e-overlay"))return;e.preventDefault();let tbrNavChk=trgt.classList.contains("e-hor-nav"),tbarScrollChk=trgt.classList.contains("e-scroll-nav");((clst=this.clstElement(tbrNavChk,trgt))||tbarScrollChk)&&this.keyHandling(clst,e,trgt,tbrNavChk,tbarScrollChk)}disable(value){let rootEle=this.element;value?rootEle.classList.add("e-overlay"):rootEle.classList.remove("e-overlay"),rootEle.setAttribute("tabindex",value?"-1":"0"),this.activeEle&&this.activeEle.setAttribute("tabindex",value?"-1":"0"),this.scrollModule&&this.scrollModule.disable(value),this.popObj&&(isVisible(this.popObj.element)&&"Extended"!==this.overflowMode&&this.popObj.hide(),rootEle.querySelector("#"+rootEle.id+"_nav").setAttribute("tabindex",value?"-1":"0"))}eleContains(el){return el.classList.contains("e-separator")||el.classList.contains("e-overlay")||el.getAttribute("disabled")||el.classList.contains("e-hidden")||!isVisible(el)}eleFocus(closest$$1,pos){let sib=Object(closest$$1)[pos+"ElementSibling"];if(sib){if(this.eleContains(sib))return void this.eleFocus(sib,pos);this.elementFocus(sib)}else if(this.tbarAlign){let elem=Object(closest$$1.parentElement)[pos+"ElementSibling"];if(isNullOrUndefined(elem)||0!==elem.children.length||(elem=Object(elem)[pos+"ElementSibling"]),!isNullOrUndefined(elem)&&elem.children.length>0)if("next"===pos){let el=elem.querySelector("."+CLS_ITEM);this.eleContains(el)?this.eleFocus(el,pos):(el.firstElementChild.focus(),this.activeEleSwitch(el))}else{let el=elem.lastElementChild;this.eleContains(el)?this.eleFocus(el,pos):this.elementFocus(el)}}}clickHandler(e){let itemObj,trgt=e.target,clsList=trgt.classList,ele=this.element,isPopupElement=!isNullOrUndefined(closest(trgt,".e-toolbar-pop")),popupNav=closest(trgt,".e-hor-nav");popupNav||(popupNav=trgt),ele.children[0].classList.contains("e-hscroll")||ele.children[0].classList.contains("e-vscroll")||!clsList.contains("e-hor-nav")||(clsList=trgt.querySelector(".e-icons").classList),(clsList.contains("e-popup-up-icon")||clsList.contains("e-popup-down-icon"))&&this.popupClickHandler(ele,popupNav,"e-rtl");let clst=closest(e.target,"."+CLS_ITEM);if((isNullOrUndefined(clst)||clst.classList.contains("e-overlay"))&&!popupNav.classList.contains("e-hor-nav"))return;clst&&(itemObj=this.items[this.tbarEle.indexOf(clst)]);let eventArgs={originalEvent:e,item:itemObj};itemObj&&!isNullOrUndefined(itemObj.click)&&this.trigger("items["+this.tbarEle.indexOf(clst)+"].click",eventArgs),eventArgs.cancel||this.trigger("clicked",eventArgs,clickedArgs=>{isNullOrUndefined(this.popObj)||!isPopupElement||clickedArgs.cancel||"Popup"!==this.overflowMode||this.popObj.hide({name:"FadeOut",duration:100})})}popupClickHandler(ele,popupNav,CLS_RTL){let popObj=this.popObj;isVisible(popObj.element)?(popupNav.classList.remove("e-nav-active"),popObj.hide({name:"FadeOut",duration:100})):(ele.classList.contains(CLS_RTL)&&(popObj.enableRtl=!0,popObj.position={X:"left",Y:"top"}),0!==popObj.offsetX||ele.classList.contains(CLS_RTL)||(popObj.enableRtl=!1,popObj.position={X:"right",Y:"top"}),popObj.dataBind(),popObj.refreshPosition(),popObj.element.style.top=this.getElementOffsetY()+"px","Extended"===this.overflowMode&&(popObj.element.style.minHeight="0px"),popupNav.classList.add("e-nav-active"),popObj.show({name:"FadeIn",duration:100}))}render(){this.initialize(),this.renderControl(),this.separator(),this.refreshToolbarTemplate(),this.wireEvents(),isBlazor()&&this.renderComplete()}initialize(){let width=formatUnit(this.width),height=formatUnit(this.height);"msie"===Browser.info.name&&"auto"===this.height&&"MultiRow"!==this.overflowMode||setStyleAttribute(this.element,{height:height}),setStyleAttribute(this.element,{width:width}),attributes(this.element,{role:"toolbar","aria-disabled":"false","aria-haspopup":"false","aria-orientation":this.isVertical?"vertical":"horizontal"})}renderControl(){this.trgtEle=this.element.children.length>0?this.element.querySelector("div"):null,this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1)}changeOrientation(){let ele=this.element;this.isVertical?(ele.classList.remove("e-vertical"),this.isVertical=!1,"auto"!==this.height&&"100%"!==this.height||(ele.style.height=this.height),ele.setAttribute("aria-orientation","horizontal")):(ele.classList.add("e-vertical"),this.isVertical=!0,ele.setAttribute("aria-orientation","vertical"),setStyleAttribute(this.element,{height:formatUnit(this.height),width:formatUnit(this.width)})),this.destroyMode(),this.refreshOverflow()}initScroll(element,innerItems){!this.scrollModule&&this.checkOverflow(element,innerItems[0])&&(this.tbarAlign&&this.element.querySelector("."+CLS_ITEMS+" .e-toolbar-center").removeAttribute("style"),this.scrollModule=this.isVertical?new ej2_navigations_es2015_VScroll({scrollStep:this.scrollStep,enableRtl:this.enableRtl},innerItems[0]):new ej2_navigations_es2015_HScroll({scrollStep:this.scrollStep,enableRtl:this.enableRtl},innerItems[0]),this.remove(this.scrollModule.element,"e-tbar-pos"),setStyleAttribute(this.element,{overflow:"hidden"}))}itemWidthCal(items){let style,width=0;return[].slice.call(ej2_base_es2015_selectAll("."+CLS_ITEM,items)).forEach(el=>{isVisible(el)&&(style=window.getComputedStyle(el),width+=this.isVertical?el.offsetHeight:el.offsetWidth,width+=parseFloat(this.isVertical?style.marginTop:style.marginRight),width+=parseFloat(this.isVertical?style.marginBottom:style.marginLeft))}),width}getScrollCntEle(innerItem){return innerItem.querySelector(this.isVertical?".e-vscroll-content":".e-hscroll-content")}checkOverflow(element,innerItem){if(isNullOrUndefined(element)||isNullOrUndefined(innerItem)||!isVisible(element))return!1;let eleWidth=this.isVertical?element.offsetHeight:element.offsetWidth,itemWidth=this.isVertical?innerItem.offsetHeight:innerItem.offsetWidth;(this.tbarAlign||this.scrollModule||eleWidth===itemWidth)&&(itemWidth=this.itemWidthCal(this.scrollModule?this.getScrollCntEle(innerItem):innerItem));let popNav=element.querySelector(".e-hor-nav"),scrollNav=element.querySelector(".e-scroll-nav"),navEleWidth=0;return popNav?navEleWidth=this.isVertical?popNav.offsetHeight:popNav.offsetWidth:scrollNav&&(navEleWidth=this.isVertical?2*scrollNav.offsetHeight:2*scrollNav.offsetWidth),itemWidth>eleWidth-navEleWidth}refreshOverflow(){this.resize()}toolbarAlign(innerItems){this.tbarAlign&&(this.add(innerItems,"e-tbar-pos"),this.itemPositioning())}renderOverflowMode(){let ele=this.element,innerItems=ele.querySelector("."+CLS_ITEMS),priorityCheck=this.popupPriCount>0;if(ele&&ele.children.length>0)switch(this.offsetWid=ele.offsetWidth,this.remove(this.element,"e-toolpop"),"msie"===Browser.info.name&&"auto"===this.height&&(ele.style.height=""),this.overflowMode){case"Scrollable":isNullOrUndefined(this.scrollModule)&&this.initScroll(ele,[].slice.call(ele.getElementsByClassName(CLS_ITEMS)));break;case"Popup":this.add(this.element,"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(ele,innerItems)||priorityCheck)&&(this.createPopupEle(ele,[].slice.call(ej2_base_es2015_selectAll("."+CLS_ITEMS+" ."+CLS_ITEM,ele))),this.element.querySelector(".e-hor-nav").setAttribute("tabIndex","0")),this.toolbarAlign(innerItems);break;case"MultiRow":this.add(innerItems,"e-toolbar-multirow"),this.checkOverflow(ele,innerItems)&&this.tbarAlign&&(this.removePositioning(),this.add(innerItems,"e-multirow-pos")),"hidden"===ele.style.overflow&&(ele.style.overflow=""),"msie"!==Browser.info.name&&"auto"===ele.style.height||(ele.style.height="auto");break;case"Extended":this.add(this.element,"e-extended-toolbar"),(this.checkOverflow(ele,innerItems)||priorityCheck)&&(this.tbarAlign&&this.removePositioning(),this.createPopupEle(ele,[].slice.call(ej2_base_es2015_selectAll("."+CLS_ITEMS+" ."+CLS_ITEM,ele))),this.element.querySelector(".e-hor-nav").setAttribute("tabIndex","0")),this.toolbarAlign(innerItems)}}separator(){let eleInlineItem,element=this.element,eleItem=[].slice.call(element.querySelectorAll(".e-separator")),multiVar=element.querySelector(".e-multirow-separator"),extendVar=element.querySelector(".e-extended-separator");null!==(eleInlineItem="MultiRow"===this.overflowMode?multiVar:extendVar)&&("MultiRow"===this.overflowMode?eleInlineItem.classList.remove("e-multirow-separator"):"Extended"===this.overflowMode&&eleInlineItem.classList.remove("e-extended-separator"));for(let i=0;i<=eleItem.length-1;i++)eleItem[i].offsetLeft<30&&0!==eleItem[i].offsetLeft&&("MultiRow"===this.overflowMode?eleItem[i].classList.add("e-multirow-separator"):"Extended"===this.overflowMode&&eleItem[i].classList.add("e-extended-separator"))}createPopupEle(ele,innerEle){let innerNav=ele.querySelector(".e-hor-nav"),vertical=this.isVertical;innerNav||this.createPopupIcon(ele),innerNav=ele.querySelector(".e-hor-nav");let eleWidth=(vertical?ele.offsetHeight:ele.offsetWidth)-(vertical?innerNav.offsetHeight:innerNav.offsetWidth);this.element.classList.remove("e-rtl"),setStyleAttribute(this.element,{direction:"initial"}),this.checkPriority(ele,innerEle,eleWidth,!0),this.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()}pushingPoppedEle(tbarObj,popupPri,ele,eleHeight,sepHeight){let element=tbarObj.element,nodes=ej2_base_es2015_selectAll(".e-overflow-show",ele),nodeIndex=0,poppedEle=[].slice.call(ej2_base_es2015_selectAll("."+CLS_POPUP,element.querySelector("."+CLS_ITEMS))),nodePri=0;poppedEle.forEach((el,index)=>{nodes=ej2_base_es2015_selectAll(".e-overflow-show",ele),el.classList.contains("e-overflow-show")&&nodes.length>0?tbarObj.tbResize&&nodes.length>index?(ele.insertBefore(el,nodes[index]),++nodePri):(ele.insertBefore(el,ele.children[nodes.length]),++nodePri):el.classList.contains("e-overflow-show")?(ele.insertBefore(el,ele.firstChild),++nodePri):tbarObj.tbResize&&el.classList.contains("e-overflow-hide")&&ele.children.length>0&&0===nodes.length?(ele.insertBefore(el,ele.firstChild),++nodePri):el.classList.contains("e-overflow-hide")?popupPri.push(el):tbarObj.tbResize?(ele.insertBefore(el,ele.childNodes[nodeIndex+nodePri]),++nodeIndex):ele.appendChild(el),el.classList.contains("e-separator")?setStyleAttribute(el,{display:"",height:sepHeight+"px"}):setStyleAttribute(el,{display:"",height:eleHeight+"px"})}),popupPri.forEach(el=>{ele.appendChild(el)});let tbarEle=ej2_base_es2015_selectAll("."+CLS_ITEM,element.querySelector("."+CLS_ITEMS));for(let i=tbarEle.length-1;i>=0;i--){let tbarElement=tbarEle[i];if(!tbarElement.classList.contains("e-separator")||"Extended"===this.overflowMode)break;setStyleAttribute(tbarElement,{display:"none"})}}createPopup(){let eleHeight,eleItem,sepHeight,sepItem,ele,element=this.element;if("Extended"===this.overflowMode&&(sepItem=element.querySelector(".e-separator:not(."+CLS_POPUP+")"),sepHeight="auto"===element.style.height||""===element.style.height?null:sepItem.offsetHeight),eleItem=element.querySelector("."+CLS_ITEM+":not(.e-separator):not(."+CLS_POPUP+")"),eleHeight="auto"===element.style.height||""===element.style.height?null:eleItem&&eleItem.offsetHeight,element.querySelector("#"+element.id+"_popup.e-toolbar-pop"))ele=element.querySelector("#"+element.id+"_popup.e-toolbar-pop");else{let extendEle=this.createElement("div",{id:element.id+"_popup",className:"e-toolbar-pop e-toolbar-extended"}),popupEle=this.createElement("div",{id:element.id+"_popup",className:"e-toolbar-pop"});ele="Extended"===this.overflowMode?extendEle:popupEle}this.pushingPoppedEle(this,[],ele,eleHeight,sepHeight),this.popupInit(element,ele)}getElementOffsetY(){return"Extended"===this.overflowMode&&"border-box"===window.getComputedStyle(this.element).getPropertyValue("box-sizing")?this.element.clientHeight:this.element.offsetHeight}popupInit(element,ele){if(this.popObj){let popupEle=this.popObj.element;setStyleAttribute(popupEle,{maxHeight:"",display:"block"}),setStyleAttribute(popupEle,{maxHeight:popupEle.offsetHeight+"px",display:""})}else{element.appendChild(ele),setStyleAttribute(this.element,{overflow:""});let eleStyles=window.getComputedStyle(this.element),popup=new ej2_popups_es2015_Popup(null,{relateTo:this.element,offsetY:this.isVertical?0:this.getElementOffsetY(),enableRtl:this.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.enableCollision?"flip":"none"},position:this.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});if(popup.appendTo(ele),"Extended"===this.overflowMode&&(popup.width=parseFloat(eleStyles.width)+2*parseFloat(eleStyles.borderRightWidth),popup.offsetX=0),EventHandler.add(document,"scroll",this.docEvent.bind(this)),EventHandler.add(document,"click ",this.docEvent.bind(this)),popup.element.style.maxHeight=popup.element.offsetHeight+"px",this.isVertical&&(popup.element.style.visibility="hidden"),this.isExtendedOpen){let popupNav=this.element.querySelector(".e-hor-nav");popupNav.classList.add("e-nav-active"),ej2_base_es2015_classList(popupNav.firstElementChild,["e-popup-up-icon"],["e-popup-down-icon"]),this.element.querySelector(".e-toolbar-extended").classList.add("e-popup-open")}else popup.hide();this.popObj=popup,this.element.setAttribute("aria-haspopup","true")}}tbarPopupHandler(isOpen){"Extended"===this.overflowMode&&(isOpen?this.add(this.element,"e-tbar-extended"):this.remove(this.element,"e-tbar-extended"))}popupOpen(e){let popObj=this.popObj;this.isVertical||(popObj.offsetY=this.getElementOffsetY(),popObj.dataBind());let popupEle=this.popObj.element,toolEle=this.popObj.element.parentElement,popupNav=toolEle.querySelector(".e-hor-nav");setStyleAttribute(popObj.element,{height:"auto",maxHeight:""}),popObj.element.style.maxHeight=popObj.element.offsetHeight+"px","Extended"===this.overflowMode&&(popObj.element.style.minHeight="");let popupElePos=popupEle.offsetTop+popupEle.offsetHeight+calculatePosition(toolEle).top,popIcon=popupNav.firstElementChild;popupNav.classList.add("e-nav-active"),ej2_base_es2015_classList(popIcon,["e-popup-up-icon"],["e-popup-down-icon"]),this.tbarPopupHandler(!0);let scrollVal=isNullOrUndefined(window.scrollY)?0:window.scrollY;if(!this.isVertical&&window.innerHeight+scrollVal<popupElePos&&this.element.offsetTop<popupEle.offsetHeight){let overflowHeight=popupEle.offsetHeight-(popupElePos-window.innerHeight-scrollVal+5);popObj.height=overflowHeight+"px";for(let i=0;i<=popupEle.childElementCount;i++){let ele=popupEle.children[i];if(ele.offsetTop+ele.offsetHeight>overflowHeight){overflowHeight=ele.offsetTop;break}}setStyleAttribute(popObj.element,{maxHeight:overflowHeight+"px"})}else if(this.isVertical){let tbEleData=this.element.getBoundingClientRect();setStyleAttribute(popObj.element,{maxHeight:tbEleData.top+this.element.offsetHeight+"px",bottom:0,visibility:""})}}popupClose(e){let popupNav=this.element.querySelector(".e-hor-nav"),popIcon=popupNav.firstElementChild;popupNav.classList.remove("e-nav-active"),ej2_base_es2015_classList(popIcon,["e-popup-down-icon"],["e-popup-up-icon"]),this.tbarPopupHandler(!1)}checkPriority(ele,inEle,eleWidth,pre){let eleOffset,checkoffset,popPriority=this.popupPriCount>0,eleWid=eleWidth,sepCheck=0,itemCount=0,itemPopCount=0,checkClass=(ele,val)=>{let rVal=!1;return val.forEach(cls=>{ele.classList.contains(cls)&&(rVal=!0)}),rVal};for(let i=inEle.length-1;i>=0;i--){let mrgn,compuStyle=window.getComputedStyle(inEle[i]);this.isVertical?(mrgn=parseFloat(compuStyle.marginTop),mrgn+=parseFloat(compuStyle.marginBottom)):(mrgn=parseFloat(compuStyle.marginRight),mrgn+=parseFloat(compuStyle.marginLeft));let fstEleCheck=inEle[i]===this.tbarEle[0];fstEleCheck&&(this.tbarEleMrgn=mrgn),eleOffset=this.isVertical?inEle[i].offsetHeight:inEle[i].offsetWidth;let eleWid=fstEleCheck?eleOffset+mrgn:eleOffset;if(checkClass(inEle[i],["e-popup-alone"])&&popPriority&&(inEle[i].classList.add(CLS_POPUP),setStyleAttribute(inEle[i],this.isVertical?{display:"none",minHeight:eleWid+"px"}:{display:"none",minWidth:eleWid+"px"}),itemPopCount++),checkoffset=this.isVertical?inEle[i].offsetTop+inEle[i].offsetHeight+mrgn>eleWidth:inEle[i].offsetLeft+inEle[i].offsetWidth+mrgn>eleWidth){if(inEle[i].classList.contains("e-separator")){if("Extended"===this.overflowMode)itemCount===itemPopCount&&checkClass(inEle[i],["e-separator","e-ignore"])&&(inEle[i].classList.add(CLS_POPUP),itemPopCount++),itemCount++;else if("Popup"===this.overflowMode){if(sepCheck>0&&itemCount===itemPopCount){let sepEle=inEle[i+itemCount+(sepCheck-1)];checkClass(sepEle,["e-separator","e-ignore"])&&setStyleAttribute(sepEle,{display:"none"})}sepCheck++,itemCount=0,itemPopCount=0}}else itemCount++;inEle[i].classList.contains("e-overflow-show")&&pre?eleWidth-=(this.isVertical?inEle[i].offsetHeight:inEle[i].offsetWidth)+mrgn:checkClass(inEle[i],["e-separator","e-ignore"])?eleWidth-=(this.isVertical?inEle[i].offsetHeight:inEle[i].offsetWidth)+mrgn:(inEle[i].classList.add(CLS_POPUP),setStyleAttribute(inEle[i],this.isVertical?{display:"none",minHeight:eleWid+"px"}:{display:"none",minWidth:eleWid+"px"}),itemPopCount++)}}if(pre){let popedEle=ej2_base_es2015_selectAll("."+CLS_ITEM+":not(."+CLS_POPUP+")",this.element);this.checkPriority(ele,popedEle,eleWid,!1)}}createPopupIcon(element){let id=element.id.concat("_nav"),className="e-"+element.id.concat("_nav e-hor-nav"),nav=this.createElement("div",{id:id,className:className="Extended"===this.overflowMode?className+" e-expended-nav":className});"msie"!==Browser.info.name&&"edge"!==Browser.info.name||nav.classList.add("e-ie-align");let navItem=this.createElement("div",{className:"e-popup-down-icon e-icons"});nav.appendChild(navItem),nav.setAttribute("tabindex","0"),element.appendChild(nav)}tbarPriRef(inEle,indx,sepPri,el,des,elWid,wid,ig){let ignoreCount=ig,priEleCnt=ej2_base_es2015_selectAll("."+CLS_POPUP+":not(.e-overflow-show)",this.popObj.element).length,checkClass=(ele,val)=>ele.classList.contains(val);if(0===ej2_base_es2015_selectAll(".e-toolbar-item:not(.e-separator):not(.e-overflow-show)",inEle).length){let eleSep=inEle.children[indx-(indx-sepPri)-1],ignoreCheck=!isNullOrUndefined(eleSep)&&checkClass(eleSep,"e-ignore");if(!isNullOrUndefined(eleSep)&&checkClass(eleSep,"e-separator")&&!isVisible(eleSep)||ignoreCheck){let sepDisplay="none";eleSep.style.display="inherit";let eleSepWidth=eleSep.offsetWidth+2*parseFloat(window.getComputedStyle(eleSep).marginRight),prevSep=eleSep.previousElementSibling;elWid+eleSepWidth<wid||des?(inEle.insertBefore(el,inEle.children[indx+ignoreCount-(indx-sepPri)]),isNullOrUndefined(prevSep)||(prevSep.style.display="")):prevSep.classList.contains("e-separator")&&(prevSep.style.display=sepDisplay),eleSep.style.display=""}else inEle.insertBefore(el,inEle.children[indx+ignoreCount-(indx-sepPri)])}else inEle.insertBefore(el,inEle.children[indx+ignoreCount-priEleCnt])}popupRefresh(popupEle,destroy){let dimension,ele=this.element,isVer=this.isVertical,popNav=ele.querySelector(".e-hor-nav"),innerEle=ele.querySelector("."+CLS_ITEMS);if(isNullOrUndefined(popNav))return;innerEle.removeAttribute("style"),popupEle.style.display="block",dimension=isVer?ele.offsetHeight-(popNav.offsetHeight+innerEle.offsetHeight):ele.offsetWidth-(popNav.offsetWidth+innerEle.offsetWidth);let popupEleWidth=0;[].slice.call(popupEle.children).forEach(el=>{popupEleWidth+=this.popupEleWidth(el),setStyleAttribute(el,{position:""})}),dimension+(isVer?popNav.offsetHeight:popNav.offsetWidth)>popupEleWidth&&0===this.popupPriCount&&(destroy=!0),this.popupEleRefresh(dimension,popupEle,destroy),popupEle.style.display="",0===popupEle.children.length&&popNav&&this.popObj&&(detach(popNav),popNav=null,this.popObj.destroy(),detach(this.popObj.element),this.popObj=null,ele.setAttribute("aria-haspopup","false"))}ignoreEleFetch(index,innerEle){let ignoreEle=[].slice.call(innerEle.querySelectorAll(".e-ignore")),ignoreInx=[],count=0;return ignoreEle.length>0?(ignoreEle.forEach(ele=>{ignoreInx.push([].slice.call(innerEle.children).indexOf(ele))}),ignoreInx.forEach(val=>{val<=index&&count++}),count):0}checkPopupRefresh(root,popEle){popEle.style.display="block";let elWid=this.popupEleWidth(popEle.firstElementChild);popEle.firstElementChild.style.removeProperty("Position");let tbarWidth=root.offsetWidth-root.querySelector(".e-hor-nav").offsetWidth,tbarItemsWid=root.querySelector("."+CLS_ITEMS).offsetWidth;return popEle.style.removeProperty("display"),tbarWidth>elWid+tbarItemsWid}popupEleWidth(el){el.style.position="absolute";let elWidth=this.isVertical?el.offsetHeight:el.offsetWidth,btnText=el.querySelector(".e-tbar-btn-text");if(el.classList.contains("e-tbtn-align")||el.classList.contains("e-popup-text")){let btn=el.children[0];!isNullOrUndefined(btnText)&&el.classList.contains("e-popup-text")?btnText.style.display="none":!isNullOrUndefined(btnText)&&el.classList.contains("e-toolbar-text")&&(btnText.style.display="block"),btn.style.minWidth="0%",elWidth=parseFloat(this.isVertical?el.style.minHeight:el.style.minWidth),btn.style.minWidth="",btn.style.minHeight="",isNullOrUndefined(btnText)||(btnText.style.display="")}return elWidth}popupEleRefresh(width,popupEle,destroy){let priEleCnt,index,checkOverflow,popPriority=this.popupPriCount>0,eleSplice=this.tbarEle,innerEle=this.element.querySelector("."+CLS_ITEMS),ignoreCount=0;for(let el of[].slice.call(popupEle.children)){if(el.classList.contains("e-popup-alone")&&popPriority&&!destroy)continue;let elWidth=this.popupEleWidth(el);if(el===this.tbarEle[0]&&(elWidth+=this.tbarEleMrgn),el.style.position="",!(elWidth<width||destroy))break;{if(setStyleAttribute(el,{minWidth:"",height:"",minHeight:""}),el.classList.contains("e-overflow-hide")||el.classList.remove(CLS_POPUP),index=this.tbarEle.indexOf(el),this.tbarAlign){let pos=this.items[index].align;index=this.tbarAlgEle[(pos+"s").toLowerCase()].indexOf(el),eleSplice=this.tbarAlgEle[(pos+"s").toLowerCase()],innerEle=this.element.querySelector("."+CLS_ITEMS+" .e-toolbar-"+pos.toLowerCase())}let sepBeforePri=0;"Extended"!==this.overflowMode&&eleSplice.slice(0,index).forEach(el=>{(el.classList.contains("e-overflow-show")||el.classList.contains("e-separator"))&&(el.classList.contains("e-separator")&&(el.style.display="",width-=el.offsetWidth),sepBeforePri++)}),ignoreCount=this.ignoreEleFetch(index,innerEle),el.classList.contains("e-overflow-show")?(this.tbarPriRef(innerEle,index,sepBeforePri,el,destroy,elWidth,width,ignoreCount),width-=el.offsetWidth):0===index?(innerEle.insertBefore(el,innerEle.firstChild),width-=el.offsetWidth):(priEleCnt=ej2_base_es2015_selectAll(".e-overflow-show",this.popObj.element).length,innerEle.insertBefore(el,innerEle.children[index+ignoreCount-priEleCnt]),width-=el.offsetWidth),el.style.height=""}}(checkOverflow=this.checkOverflow(this.element,this.element.getElementsByClassName(CLS_ITEMS)[0]))&&!destroy&&this.renderOverflowMode()}removePositioning(){let item=this.element.querySelector("."+CLS_ITEMS);if(isNullOrUndefined(item)||!item.classList.contains("e-tbar-pos"))return;this.remove(item,"e-tbar-pos");let innerItem=[].slice.call(item.childNodes);innerItem[1].removeAttribute("style"),innerItem[2].removeAttribute("style")}refreshPositioning(){let item=this.element.querySelector("."+CLS_ITEMS);this.add(item,"e-tbar-pos"),this.itemPositioning()}itemPositioning(){let margin,item=this.element.querySelector("."+CLS_ITEMS);if(isNullOrUndefined(item)||!item.classList.contains("e-tbar-pos"))return;let innerItem,popupNav=this.element.querySelector(".e-hor-nav");innerItem=[].slice.call(this.scrollModule?item.querySelector("."+(this.isVertical?"e-vscroll-content":"e-hscroll-content")).children:item.childNodes),margin=this.isVertical?innerItem[0].offsetHeight+innerItem[2].offsetHeight:innerItem[0].offsetWidth+innerItem[2].offsetWidth;let tbarWid=this.isVertical?this.element.offsetHeight:this.element.offsetWidth;if(popupNav){tbarWid-=this.isVertical?popupNav.offsetHeight:popupNav.offsetWidth;let popWid=(this.isVertical?popupNav.offsetHeight:popupNav.offsetWidth)+"px";innerItem[2].removeAttribute("style"),this.isVertical?this.enableRtl?innerItem[2].style.top=popWid:innerItem[2].style.bottom=popWid:this.enableRtl?innerItem[2].style.left=popWid:innerItem[2].style.right=popWid}if(tbarWid<=margin)return;let value=(tbarWid-margin-(this.isVertical?innerItem[1].offsetHeight:innerItem[1].offsetWidth))/2;innerItem[1].removeAttribute("style");let mrgn=(this.isVertical?innerItem[0].offsetHeight:innerItem[0].offsetWidth)+value+"px";this.isVertical?this.enableRtl?innerItem[1].style.marginBottom=mrgn:innerItem[1].style.marginTop=mrgn:this.enableRtl?innerItem[1].style.marginRight=mrgn:innerItem[1].style.marginLeft=mrgn}tbarItemAlign(item,itemEle,pos){if(item.showAlwaysInPopup&&"Show"!==item.overflow)return;let alignDiv=[];if(alignDiv.push(this.createElement("div",{className:"e-toolbar-left"})),alignDiv.push(this.createElement("div",{className:"e-toolbar-center"})),alignDiv.push(this.createElement("div",{className:"e-toolbar-right"})),0===pos&&"Left"!==item.align)alignDiv.forEach(ele=>{itemEle.appendChild(ele)}),this.tbarAlign=!0,this.add(itemEle,"e-tbar-pos");else if("Left"!==item.align){let leftAlign=alignDiv[0];[].slice.call(itemEle.childNodes).forEach(el=>{this.tbarAlgEle.lefts.push(el),leftAlign.appendChild(el)}),itemEle.appendChild(leftAlign),itemEle.appendChild(alignDiv[1]),itemEle.appendChild(alignDiv[2]),this.tbarAlign=!0,this.add(itemEle,"e-tbar-pos")}}ctrlTemplate(){this.ctrlTem=this.trgtEle.cloneNode(!0),this.add(this.trgtEle,CLS_ITEMS),this.tbarEle=[],[].slice.call(this.trgtEle.children).forEach(ele=>{"DIV"===ele.tagName&&(this.tbarEle.push(ele),ele.setAttribute("aria-disabled","false"),this.add(ele,CLS_ITEM))})}renderItems(){let itemEleDom,innerItem,innerPos,ele=this.element,items=this.items;if(ele&&ele.children.length>0&&(itemEleDom=ele.querySelector("."+CLS_ITEMS)),null!=this.trgtEle)this.ctrlTemplate();else if(ele&&items.length>0){itemEleDom||(itemEleDom=this.createElement("div",{className:CLS_ITEMS}));for(let i=0;i<items.length;i++)innerItem=this.renderSubComponent(items[i],i),-1===this.tbarEle.indexOf(innerItem)&&this.tbarEle.push(innerItem),this.tbarAlign||this.tbarItemAlign(items[i],itemEleDom,i),(innerPos=itemEleDom.querySelector(".e-toolbar-"+items[i].align.toLowerCase()))?(items[i].showAlwaysInPopup&&"Show"!==items[i].overflow||this.tbarAlgEle[(items[i].align+"s").toLowerCase()].push(innerItem),innerPos.appendChild(innerItem)):itemEleDom.appendChild(innerItem);ele.appendChild(itemEleDom)}}setAttr(attr,element){let keyVal,key=Object.keys(attr);for(let i=0;i<key.length;i++)"class"===(keyVal=key[i])?this.add(element,attr[keyVal]):element.setAttribute(keyVal,attr[keyVal])}enableItems(items,isEnable){let ele,elements=items,len=elements.length;isNullOrUndefined(isEnable)&&(isEnable=!0);let enable=(isEnable,ele)=>{isEnable?(ele.classList.remove("e-overlay"),ele.setAttribute("aria-disabled","false")):(ele.classList.add("e-overlay"),ele.setAttribute("aria-disabled","true"))};if(!isNullOrUndefined(len)&&len>=1){for(let a=0,element=[].slice.call(elements);a<len;a++){let itemElement=element[a];if("number"==typeof itemElement){if(isNullOrUndefined(ele=this.getElementByIndex(itemElement)))return;elements[a]=ele}else ele=itemElement;enable(isEnable,ele)}isEnable?removeClass(elements,"e-overlay"):addClass(elements,"e-overlay")}else{if("number"==typeof elements){if(isNullOrUndefined(ele=this.getElementByIndex(elements)))return}else ele=items;enable(isEnable,ele)}}getElementByIndex(index){return this.tbarEle[index]?this.tbarEle[index]:null}addItems(items,index){let innerItems;this.extendedOpen();let innerEle,itemsDiv=this.element.querySelector("."+CLS_ITEMS);if(isNullOrUndefined(itemsDiv))return void this.itemsRerender(items);let itemAgn="Left";isNullOrUndefined(index)&&(index=0),items.forEach(e=>{isNullOrUndefined(e.align)||"Left"===e.align||"Left"!==itemAgn||(itemAgn=e.align)});for(let item of items)if(isNullOrUndefined(item.type)&&(item.type="Button"),innerItems=ej2_base_es2015_selectAll("."+CLS_ITEM,this.element),item.align=itemAgn,innerEle=this.renderSubComponent(item,index),this.tbarEle.length>=index&&innerItems.length>=0){isNullOrUndefined(this.scrollModule)&&this.destroyMode();let ele,algIndex="L"===item.align[0]?0:"C"===item.align[0]?1:2;this.tbarAlign||"Left"===itemAgn?this.tbarAlign?((ele=closest(innerItems[0],"."+CLS_ITEMS).children[algIndex]).insertBefore(innerEle,ele.children[index]),this.tbarAlgEle[(item.align+"s").toLowerCase()].splice(index,0,innerEle),this.refreshPositioning()):0===innerItems.length?(innerItems=ej2_base_es2015_selectAll("."+CLS_ITEMS,this.element))[0].appendChild(innerEle):innerItems[0].parentNode.insertBefore(innerEle,innerItems[index]):(this.tbarItemAlign(item,itemsDiv,1),this.tbarAlign=!0,(ele=closest(innerItems[0],"."+CLS_ITEMS).children[algIndex]).appendChild(innerEle),this.tbarAlgEle[(item.align+"s").toLowerCase()].push(innerEle),this.refreshPositioning()),this.items.splice(index,0,item),this.tbarEle.splice(index,0,innerEle),index++,this.offsetWid=itemsDiv.offsetWidth}itemsDiv.style.width="",this.renderOverflowMode()}removeItems(args){let index,elements=args,innerItems=[].slice.call(ej2_base_es2015_selectAll("."+CLS_ITEM,this.element));if("number"==typeof elements)index=parseInt(args.toString(),10),this.removeItemByIndex(index,innerItems);else if(elements&&elements.length>1)for(let ele of[].slice.call(elements))index=this.tbarEle.indexOf(ele),this.removeItemByIndex(index,innerItems),innerItems=ej2_base_es2015_selectAll("."+CLS_ITEM,this.element);else index=innerItems.indexOf(elements&&elements.length&&1===elements.length?elements[0]:args),this.removeItemByIndex(index,innerItems);this.resize()}removeItemByIndex(index,innerItems){if(this.tbarEle[index]&&innerItems[index]){let eleIdx=this.tbarEle.indexOf(innerItems[index]);if(this.tbarAlign){let indexAgn;indexAgn=this.tbarAlgEle[(this.items[eleIdx].align+"s").toLowerCase()].indexOf(this.tbarEle[eleIdx]),this.tbarAlgEle[(this.items[eleIdx].align+"s").toLowerCase()].splice(indexAgn,1)}detach(innerItems[index]),this.items.splice(eleIdx,1),this.tbarEle.splice(eleIdx,1)}}templateRender(templateProp,innerEle,item,index){let isComponent,eleObj=templateProp;if("object"==typeof templateProp&&(isComponent="function"==typeof eleObj.appendTo),"string"!=typeof templateProp&&isComponent){if("Input"===item.type){let ele=this.createElement("input");ele.id=item.id?item.id:getUniqueID("tbr-ipt"),innerEle.appendChild(ele),eleObj.appendTo(ele)}}else{let templateFn,tempArray,val=templateProp;val="string"==typeof templateProp?templateProp.trim():templateProp;try{if("object"!=typeof templateProp||isNullOrUndefined(templateProp.tagName)){if(document.querySelectorAll(val).length){let ele=document.querySelector(val),tempStr=ele.outerHTML.trim();innerEle.appendChild(ele),ele.style.display="",isNullOrUndefined(tempStr)||this.tempId.push(val)}}else innerEle.appendChild(templateProp)}catch(e){templateFn=compile$$1(val)}isNullOrUndefined(templateFn)||(tempArray=templateFn({},this,"template",this.element.id+index+"_template",this.isStringTemplate)),!isNullOrUndefined(tempArray)&&tempArray.length>0&&[].slice.call(tempArray).forEach(ele=>{isNullOrUndefined(ele.tagName)||(ele.style.display=""),innerEle.appendChild(ele)})}this.add(innerEle,"e-template"),this.tbarEle.push(innerEle)}buttonRendering(item,innerEle){let dom=this.createElement("button",{className:"e-tbar-btn"});dom.setAttribute("type","button");let iconCss,iconPos,textStr=item.text;dom.id=item.id?item.id:getUniqueID("e-tbr-btn");let btnTxt=this.createElement("span",{className:"e-tbar-btn-text"});textStr?(btnTxt.innerHTML=textStr,dom.appendChild(btnTxt),dom.classList.add("e-tbtn-txt")):this.add(innerEle,"e-tbtn-align"),(item.prefixIcon||item.suffixIcon)&&(item.prefixIcon&&item.suffixIcon||item.prefixIcon?(iconCss=item.prefixIcon+" e-icons",iconPos="Left"):(iconCss=item.suffixIcon+" e-icons",iconPos="Right"));let btnObj=new ej2_buttons_es2015_Button({iconCss:iconCss,iconPosition:iconPos});return btnObj.createElement=this.createElement,btnObj.appendTo(dom),item.width&&setStyleAttribute(dom,{width:formatUnit(item.width)}),dom}renderSubComponent(item,index){let innerEle,dom;if((innerEle=this.createElement("div",{className:CLS_ITEM})).setAttribute("aria-disabled","false"),this.tbarEle||(this.tbarEle=[]),item.htmlAttributes&&this.setAttr(item.htmlAttributes,innerEle),item.tooltipText){let tempDom=this.createElement("div",{innerHTML:item.tooltipText});innerEle.setAttribute("title",tempDom.textContent)}if(item.cssClass&&(innerEle.className=innerEle.className+" "+item.cssClass),item.template)this.templateRender(item.template,innerEle,item,index);else switch(item.type){case"Button":(dom=this.buttonRendering(item,innerEle)).setAttribute("tabindex","-1"),innerEle.appendChild(dom),innerEle.addEventListener("click",this.itemClick.bind(this));break;case"Separator":this.add(innerEle,"e-separator")}if(item.showTextOn){let sTxt=item.showTextOn;"Toolbar"===sTxt?(this.add(innerEle,"e-toolbar-text"),this.add(innerEle,"e-tbtn-align")):"Overflow"===sTxt&&this.add(innerEle,"e-popup-text")}if(item.overflow){let overflow=item.overflow;"Show"===overflow?this.add(innerEle,"e-overflow-show"):"Hide"===overflow&&(innerEle.classList.contains("e-separator")||this.add(innerEle,"e-overflow-hide"))}return"Show"!==item.overflow&&item.showAlwaysInPopup&&!innerEle.classList.contains("e-separator")&&(this.add(innerEle,"e-popup-alone"),this.popupPriCount++),innerEle}refreshToolbarTemplate(){let blazorContain=Object.keys(window);for(let a=0,length=this.items.length;a<length;a++){let item=this.items[a];item.template&&blazorContain.indexOf("Blazor")>-1&&!this.isStringTemplate&&0===item.template.indexOf("<div>Blazor")&&(resetBlazorTemplate(this.element.id+a+"_template"),updateBlazorTemplate(this.element.id+a+"_template","Template",item))}}itemClick(e){this.activeEleSwitch(e.currentTarget)}activeEleSwitch(ele){this.activeEleRemove(ele.firstElementChild),this.activeEle.focus()}activeEleRemove(curEle){isNullOrUndefined(this.activeEle)||this.activeEle.setAttribute("tabindex","-1"),this.activeEle=curEle,isNullOrUndefined(this.trgtEle)&&!curEle.parentElement.classList.contains("e-template")?curEle.removeAttribute("tabindex"):this.activeEle.setAttribute("tabindex","0")}getPersistData(){return this.addOnPersist([])}getModuleName(){return"toolbar"}itemsRerender(newProp){this.items=this.tbarItemsCol,this.destroyMode(),this.destroyItems(),this.items=newProp,this.tbarItemsCol=this.items,this.renderItems(),this.renderOverflowMode()}resize(){let ele=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&"Popup"===this.overflowMode&&this.popObj.hide();let checkOverflow=this.checkOverflow(ele,ele.getElementsByClassName(CLS_ITEMS)[0]);if(!checkOverflow){this.destroyScroll();let multirowele=ele.querySelector("."+CLS_ITEMS);isNullOrUndefined(multirowele)||(this.remove(multirowele,"e-multirow-pos"),this.tbarAlign&&this.add(multirowele,"e-tbar-pos"))}if(!checkOverflow||!this.scrollModule||this.offsetWid!==ele.offsetWidth){if((this.offsetWid>ele.offsetWidth||checkOverflow)&&this.renderOverflowMode(),this.popObj){if("Extended"===this.overflowMode){let eleStyles=window.getComputedStyle(this.element);this.popObj.width=parseFloat(eleStyles.width)+2*parseFloat(eleStyles.borderRightWidth)}this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()}this.offsetWid=ele.offsetWidth,this.tbResize=!1,this.separator()}}extendedOpen(){let sib=this.element.querySelector(".e-toolbar-extended");"Extended"===this.overflowMode&&sib&&(this.isExtendedOpen=sib.classList.contains("e-popup-open"))}onPropertyChanged(newProp,oldProp){let tEle=this.element;this.extendedOpen();for(let prop of Object.keys(newProp))switch(prop){case"items":if(newProp.items instanceof Array&&oldProp.items instanceof Array)this.itemsRerender(newProp.items);else{let changedProb=Object.keys(newProp.items);for(let i=0;i<changedProb.length;i++){let index=parseInt(Object.keys(newProp.items)[i],10),property=Object.keys(newProp.items[index])[0],newProperty=(Object(oldProp.items[index]),Object(newProp.items[index])[property]);if(this.tbarAlign||"align"===property){this.refresh(),this.trigger("created");break}let booleanCheck="overflow"===property&&0!==this.popupPriCount;("showAlwaysInPopup"===property&&!newProperty||this.items[index].showAlwaysInPopup&&booleanCheck)&&--this.popupPriCount,isNullOrUndefined(this.scrollModule)&&this.destroyMode(),detach([].slice.call(ej2_base_es2015_selectAll("."+CLS_ITEMS+" ."+CLS_ITEM,tEle))[index]),this.tbarEle.splice(index,1),this.addItems([this.items[index]],index),this.items.splice(index,1),this.items[index].template&&this.tbarEle.splice(this.items.length,1)}}break;case"width":let wid=tEle.offsetWidth;setStyleAttribute(tEle,{width:formatUnit(newProp.width)}),this.renderOverflowMode(),this.popObj&&wid<tEle.offsetWidth&&this.popupRefresh(this.popObj.element,!1);break;case"height":setStyleAttribute(this.element,{height:formatUnit(newProp.height)});break;case"overflowMode":this.destroyMode(),this.renderOverflowMode(),this.enableRtl&&this.add(tEle,"e-rtl"),this.refreshOverflow();break;case"enableRtl":newProp.enableRtl?this.add(tEle,"e-rtl"):this.remove(tEle,"e-rtl"),isNullOrUndefined(this.scrollModule)||(newProp.enableRtl?this.add(this.scrollModule.element,"e-rtl"):this.remove(this.scrollModule.element,"e-rtl")),isNullOrUndefined(this.popObj)||(newProp.enableRtl?this.add(this.popObj.element,"e-rtl"):this.remove(this.popObj.element,"e-rtl")),this.tbarAlign&&this.itemPositioning();break;case"scrollStep":this.scrollModule&&(this.scrollModule.scrollStep=this.scrollStep);break;case"enableCollision":this.popObj&&(this.popObj.collision={Y:this.enableCollision?"flip":"none"})}}hideItem(index,value){let initIndex,ele,isElement="object"==typeof index,eleIndex=index,innerItems=[].slice.call(ej2_base_es2015_selectAll("."+CLS_ITEM,this.element));if(isElement?ele=index:this.tbarEle[eleIndex]&&(ele=[].slice.call(ej2_base_es2015_selectAll("."+CLS_ITEM,this.element))[eleIndex]),ele){if(value?ele.classList.add("e-hidden"):ele.classList.remove("e-hidden"),value&&isNullOrUndefined(this.element.getAttribute("tabindex"))&&!ele.classList.contains("e-separator")){if(isNullOrUndefined(ele.firstElementChild.getAttribute("tabindex"))){ele.firstElementChild.setAttribute("tabindex","-1");let innerItems=[].slice.call(ej2_base_es2015_selectAll("."+CLS_ITEM,this.element));isElement&&(eleIndex=innerItems.indexOf(ele));let nextEle=innerItems[++eleIndex];for(;nextEle;){if(!this.eleContains(nextEle)){nextEle.firstElementChild.removeAttribute("tabindex");break}nextEle=innerItems[++eleIndex]}}}else if(isNullOrUndefined(this.element.getAttribute("tabindex"))&&!ele.classList.contains("e-separator")){let setFlag=!1,removeFlag=!1,initELe=innerItems[initIndex=0];for(;initELe;)if(initELe.classList.contains("e-separator"))initELe=innerItems[++initIndex];else if(isNullOrUndefined(initELe.firstElementChild.getAttribute("tabindex")))initELe.firstElementChild.setAttribute("tabindex","-1"),setFlag=!0;else{if(setFlag&&removeFlag)break;this.eleContains(initELe)||(initELe.firstElementChild.removeAttribute("tabindex"),removeFlag=!0),initELe=innerItems[++initIndex]}}this.refreshOverflow()}}};return __decorate([Collection([],ej2_navigations_es2015_Item)],Toolbar.prototype,"items",void 0),__decorate([Property("auto")],Toolbar.prototype,"width",void 0),__decorate([Property("auto")],Toolbar.prototype,"height",void 0),__decorate([Property("Scrollable")],Toolbar.prototype,"overflowMode",void 0),__decorate([Property()],Toolbar.prototype,"scrollStep",void 0),__decorate([Property(!0)],Toolbar.prototype,"enableCollision",void 0),__decorate([ej2_base_es2015_Event()],Toolbar.prototype,"clicked",void 0),__decorate([ej2_base_es2015_Event()],Toolbar.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],Toolbar.prototype,"destroyed",void 0),__decorate([ej2_base_es2015_Event()],Toolbar.prototype,"beforeCreate",void 0),__decorate([NotifyPropertyChanges],Toolbar)})(),ej2_navigations_es2015_ContextMenu=(()=>{let ContextMenu=class extends ej2_navigations_es2015_MenuBase{constructor(options,element){super(options,element)}preRender(){this.isMenu=!1,this.element.id=this.element.id||getUniqueID("ej2-contextmenu"),super.preRender()}initialize(){super.initialize(),attributes(this.element,{role:"menu",tabindex:"0"}),this.element.style.zIndex=getZindexPartial(this.element).toString()}open(top,left,target){super.openMenu(null,null,top,left,null,target)}close(){super.closeMenu()}onPropertyChanged(newProp,oldProp){super.onPropertyChanged(newProp,oldProp);for(let prop of Object.keys(newProp))switch(prop){case"filter":this.close(),this.filter=newProp.filter;break;case"target":this.unWireEvents(oldProp.target),this.wireEvents()}}getModuleName(){return"contextmenu"}};return __decorate([Property("")],ContextMenu.prototype,"target",void 0),__decorate([Property("")],ContextMenu.prototype,"filter",void 0),__decorate([Collection([],ej2_navigations_es2015_MenuItem)],ContextMenu.prototype,"items",void 0),__decorate([NotifyPropertyChanges],ContextMenu)})();const CLS_TB_ITEMS="e-toolbar-items",CLS_TB_ITEM="e-toolbar-item";let ej2_navigations_es2015_TabActionSettings=(()=>{class TabActionSettings extends ChildProperty{}return __decorate([Property("SlideLeftIn")],TabActionSettings.prototype,"effect",void 0),__decorate([Property(600)],TabActionSettings.prototype,"duration",void 0),__decorate([Property("ease")],TabActionSettings.prototype,"easing",void 0),TabActionSettings})(),ej2_navigations_es2015_TabAnimationSettings=(()=>{class TabAnimationSettings extends ChildProperty{}return __decorate([Complex({effect:"SlideLeftIn",duration:600,easing:"ease"},ej2_navigations_es2015_TabActionSettings)],TabAnimationSettings.prototype,"previous",void 0),__decorate([Complex({effect:"SlideRightIn",duration:600,easing:"ease"},ej2_navigations_es2015_TabActionSettings)],TabAnimationSettings.prototype,"next",void 0),TabAnimationSettings})(),ej2_navigations_es2015_Header=(()=>{class Header extends ChildProperty{}return __decorate([Property("")],Header.prototype,"text",void 0),__decorate([Property("")],Header.prototype,"iconCss",void 0),__decorate([Property("left")],Header.prototype,"iconPosition",void 0),Header})(),ej2_navigations_es2015_TabItem=(()=>{class TabItem extends ChildProperty{}return __decorate([Complex({},ej2_navigations_es2015_Header)],TabItem.prototype,"header",void 0),__decorate([Property(null)],TabItem.prototype,"headerTemplate",void 0),__decorate([Property("")],TabItem.prototype,"content",void 0),__decorate([Property("")],TabItem.prototype,"cssClass",void 0),__decorate([Property(!1)],TabItem.prototype,"disabled",void 0),TabItem})(),ej2_navigations_es2015_Tab=(()=>{let Tab=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.show={},this.hide={},this.animateOptions={},this.animObj=new ej2_base_es2015_Animation(this.animateOptions),this.maxHeight=0,this.title="Close",this.lastIndex=0,this.isAdd=!1,this.isIconAlone=!1,this.resizeContext=this.refreshActElePosition.bind(this),this.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"}}destroy(){if(isNullOrUndefined(this.tbObj)||this.tbObj.destroy(),this.unWireEvents(),["role","aria-disabled","aria-activedescendant","tabindex","aria-orientation"].forEach(val=>{this.element.removeAttribute(val)}),this.expTemplateContent(),this.isTemplate){let cntEle=ej2_base_es2015_select(".e-tab > .e-content",this.element);this.element.classList.remove("e-template"),isNullOrUndefined(cntEle)||(cntEle.innerHTML=this.cnt)}else for(;this.element.firstElementChild;)ej2_base_es2015_remove(this.element.firstElementChild);super.destroy(),this.trigger("destroyed")}preRender(){let nested=closest(this.element,".e-content");this.prevIndex=0,this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwipeed=!1,this.itemIndexArray=[],this.templateEle=[],isNullOrUndefined(nested)||(nested.parentElement.classList.add("e-nested"),this.isNested=!0);let name=Browser.info.name,css="msie"===name?"e-ie":"edge"===name?"e-edge":"safari"===name?"e-safari":"";setStyleAttribute(this.element,{width:formatUnit(this.width),height:formatUnit(this.height)}),this.setCssClass(this.element,this.cssClass,!0),attributes(this.element,{role:"tablist","aria-disabled":"false","aria-activedescendant":""}),this.setCssClass(this.element,css,!0),this.updatePopAnimationConfig()}render(){this.btnCls=this.createElement("span",{className:"e-icons e-close-icon",attrs:{title:this.title}}),this.renderContainer(),this.wireEvents(),this.initRender=!1,isBlazor()&&this.renderComplete()}renderContainer(){let ele=this.element;if(this.items.length>0&&0===ele.children.length)ele.appendChild(this.createElement("div",{className:"e-content"})),this.setOrientation(this.headerPlacement,this.createElement("div",{className:"e-tab-header"})),this.isTemplate=!1;else if(this.element.children.length>0){this.isTemplate=!0,ele.classList.add("e-template");let header=ele.querySelector(".e-tab-header");header&&"Bottom"===this.headerPlacement&&this.setOrientation(this.headerPlacement,header)}if(!isNullOrUndefined(ej2_base_es2015_select(".e-tab-header",this.element))&&!isNullOrUndefined(ej2_base_es2015_select(".e-content",this.element))){if(this.renderHeader(),this.tbItems=ej2_base_es2015_select(".e-tab-header ."+CLS_TB_ITEMS,this.element),isNullOrUndefined(this.tbItems)||rippleEffect(this.tbItems,{selector:".e-tab-wrap"}),this.renderContent(),ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element).length>0){let scrCnt;this.tbItems=ej2_base_es2015_select(".e-tab-header ."+CLS_TB_ITEMS,this.element),this.bdrLine=this.createElement("div",{className:"e-indicator e-hidden e-ignore"}),isNullOrUndefined(scrCnt=ej2_base_es2015_select("."+this.scrCntClass,this.tbItems))?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstChild):scrCnt.insertBefore(this.bdrLine,scrCnt.firstChild),this.setContentHeight(!0),this.select(this.selectedItem)}this.setRTL(this.enableRtl)}}renderHeader(){let hdrPlace=this.headerPlacement,tabItems=[];if(this.hdrEle=ej2_base_es2015_select(".e-tab-header",this.element),this.addVerticalClass(),this.isTemplate){this.element.children.length>1&&this.element.children[1].classList.contains("e-tab-header")&&this.setProperties({headerPlacement:"Bottom"},!0);let count=this.hdrEle.children.length,hdrItems=[];for(let i=0;i<count;i++)hdrItems.push(this.hdrEle.children.item(i).innerHTML);if(count>0){for(;this.hdrEle.firstElementChild;)detach(this.hdrEle.firstElementChild);this.hdrEle.appendChild(this.createElement("div",{className:"e-items"})),hdrItems.forEach((item,index)=>{this.lastIndex=index;let attr={className:"e-item",id:"e-item_"+index,attrs:{role:"tab","aria-controls":"e-content_"+index,"aria-selected":"false"}},txt=this.createElement("span",{className:"e-tab-text",innerHTML:item,attrs:{role:"presentation"}}).outerHTML,cont=this.createElement("div",{className:"e-text-wrap",innerHTML:txt+this.btnCls.outerHTML}).outerHTML,wrap=this.createElement("div",{className:"e-tab-wrap",innerHTML:cont,attrs:{tabIndex:"-1"}});ej2_base_es2015_select(".e-items",this.element).appendChild(this.createElement("div",attr)),ej2_base_es2015_selectAll(".e-item",this.element)[index].appendChild(wrap)})}}else tabItems=this.parseObject(this.items,0);this.tbObj=new ej2_navigations_es2015_Toolbar({width:"Left"===hdrPlace||"Right"===hdrPlace?"auto":"100%",height:"Left"===hdrPlace||"Right"===hdrPlace?"100%":"auto",overflowMode:this.overflowMode,items:0!==tabItems.length?tabItems:[],clicked:this.clickHandler.bind(this),scrollStep:this.scrollStep}),this.tbObj.isStringTemplate=!0,this.tbObj.createElement=this.createElement,this.tbObj.appendTo(this.hdrEle);for(let i=0;i<this.items.length;i++){let item=this.items[i];item.headerTemplate&&isBlazor()&&!this.isStringTemplate&&0===item.headerTemplate.indexOf("<div>Blazor")&&updateBlazorTemplate(this.element.id+i+"_headerTemplate","HeaderTemplate",item)}this.updateOrientationAttribute(),this.setCloseButton(this.showCloseButton)}renderContent(){this.cntEle=ej2_base_es2015_select(".e-content",this.element);let hdrItem=ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element);if(this.isTemplate){this.cnt=this.cntEle.children.length>0?this.cntEle.innerHTML:"";let contents=this.cntEle.children;for(let i=0;i<hdrItem.length;i++)contents.length-1>=i&&(contents.item(i).className+="e-item",attributes(contents.item(i),{role:"tabpanel","aria-labelledby":"e-item_"+i}),contents.item(i).id="e-content_"+i)}}reRenderItems(){this.renderContainer(),isNullOrUndefined(this.cntEle)||(this.touchModule=new ej2_base_es2015_Touch(this.cntEle,{swipe:this.swipeHandler.bind(this)}))}parseObject(items,index){let txtWrapEle,tbCount=ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element).length,tItems=[],spliceArray=[];return items.forEach((item,i)=>{let pos=isNullOrUndefined(item.header)||isNullOrUndefined(item.header.iconPosition)?"":item.header.iconPosition,css=isNullOrUndefined(item.header)||isNullOrUndefined(item.header.iconCss)?"":item.header.iconCss;if(isNullOrUndefined(item.headerTemplate)&&(isNullOrUndefined(item.header)||isNullOrUndefined(item.header.text)||0===item.header.text.length&&""===css))return void spliceArray.push(i);let txt=item.headerTemplate||item.header.text;this.lastIndex=0===tbCount?i:this.isReplace?index+i:this.lastIndex+1;let disabled=item.disabled?" e-disable e-overlay":"";txtWrapEle=this.createElement("div",{className:"e-tab-text",attrs:{role:"presentation"}});let tEle,tHtml=txt instanceof Object?txt.outerHTML:txt,txtEmpty=!isNullOrUndefined(tHtml)&&""!==tHtml;isNullOrUndefined(txt.tagName)?this.headerTextCompile(txtWrapEle,txt,i):txtWrapEle.appendChild(txt);let icon=this.createElement("span",{className:"e-icons e-tab-icon e-icon-"+pos+" "+css}),tCont=this.createElement("div",{className:"e-text-wrap"});tCont.appendChild(txtWrapEle),""!==txt&&void 0!==txt&&""!==css?("left"===pos||"top"===pos?tCont.insertBefore(icon,tCont.firstElementChild):tCont.appendChild(icon),tEle=txtWrapEle,this.isIconAlone=!1):(tEle=""===css?txtWrapEle:icon)===icon&&(detach(txtWrapEle),tCont.appendChild(icon),this.isIconAlone=!0);let wrapAttrs=item.disabled?{}:{tabIndex:"-1"};tCont.appendChild(this.btnCls.cloneNode(!0));let wrap=this.createElement("div",{className:"e-tab-wrap",attrs:wrapAttrs});wrap.appendChild(tCont),this.itemIndexArray===[]?this.itemIndexArray.push("e-item_"+this.lastIndex):this.itemIndexArray.splice(index+i,0,"e-item_"+this.lastIndex);let tItem={htmlAttributes:{id:"e-item_"+this.lastIndex,role:"tab","aria-selected":"false"},template:wrap};tItem.cssClass=item.cssClass+" "+disabled+" "+(""!==css?"e-i"+pos:"")+" "+(txtEmpty?"":"e-icon"),"top"!==pos&&"bottom"!==pos||this.element.classList.add("e-vertical-icon"),tItems.push(tItem),i++}),this.isAdd||spliceArray.forEach(spliceItemIndex=>{this.items.splice(spliceItemIndex,1)}),this.isIconAlone?this.element.classList.add("e-icon-tab"):this.element.classList.remove("e-icon-tab"),tItems}removeActiveClass(id){let hdrActEle=ej2_base_es2015_selectAll(":root .e-tab-header .e-toolbar-item.e-active",this.element)[0],selectEle=ej2_base_es2015_select(".e-tab-header",this.element);"Bottom"===this.headerPlacement&&(hdrActEle=ej2_base_es2015_selectAll(":root .e-tab-header .e-toolbar-item.e-active",selectEle)[0]),isNullOrUndefined(hdrActEle)||hdrActEle.classList.remove("e-active")}checkPopupOverflow(ele){this.tbPop=ej2_base_es2015_select(".e-toolbar-pop",this.element);let popIcon=ej2_base_es2015_select(".e-hor-nav",this.element),tbrItems=ej2_base_es2015_select("."+CLS_TB_ITEMS,this.element),lastChild=tbrItems.lastChild,isOverflow=!1;return!this.isVertical()&&(this.enableRtl&&popIcon.offsetLeft+popIcon.offsetWidth>tbrItems.offsetLeft||!this.enableRtl&&popIcon.offsetLeft<tbrItems.offsetWidth)?isOverflow=!0:this.isVertical()&&popIcon.offsetTop<lastChild.offsetTop+lastChild.offsetHeight&&(isOverflow=!0),isOverflow&&(ele.classList.add("e-toolbar-popup"),this.tbPop.insertBefore(ele.cloneNode(!0),ej2_base_es2015_selectAll(".e-toolbar-popup",this.tbPop)[0]),ele.outerHTML=""),!0}popupHandler(target){let ripEle=target.querySelector(".e-ripple-element");isNullOrUndefined(ripEle)||(ripEle.outerHTML="",target.querySelector(".e-tab-wrap").classList.remove("e-ripple")),this.tbItem=ej2_base_es2015_selectAll(".e-toolbar-items ."+CLS_TB_ITEM,this.hdrEle);let lastChild=this.tbItem[this.tbItem.length-1];return 0!==this.tbItem.length&&(target.classList.remove("e-toolbar-popup"),target.removeAttribute("style"),this.tbItems.appendChild(target.cloneNode(!0)),this.actEleId=target.id,target.outerHTML="",this.checkPopupOverflow(lastChild)&&this.checkPopupOverflow(this.tbItems.lastChild.previousElementSibling),this.isPopup=!0),ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.tbItems).length-1}updateOrientationAttribute(){attributes(this.element,{"aria-orientation":this.isVertical()?"vertical":"horizontal"})}setCloseButton(val){let trg=ej2_base_es2015_select(".e-tab-header",this.element);!0===val?trg.classList.add("e-close-show"):trg.classList.remove("e-close-show"),this.tbObj.refreshOverflow(),this.refreshActElePosition()}prevCtnAnimation(prev,current){return this.enableRtl||this.element.classList.contains("e-rtl"),this.isPopup||prev<=current?"SlideLeftIn"===this.animation.previous.effect?{name:"SlideLeftOut",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}:null:"SlideRightIn"===this.animation.next.effect?{name:"SlideRightOut",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}:null}triggerPrevAnimation(oldCnt,prevIndex){let animateObj=this.prevCtnAnimation(prevIndex,this.selectedItem);isNullOrUndefined(animateObj)?oldCnt.classList.remove("e-active"):(animateObj.begin=()=>{setStyleAttribute(oldCnt,{position:"absolute"}),oldCnt.classList.add("e-progress"),oldCnt.classList.add("e-view")},animateObj.end=()=>{oldCnt.style.display="none",oldCnt.classList.remove("e-active"),oldCnt.classList.remove("e-progress"),oldCnt.classList.remove("e-view"),setStyleAttribute(oldCnt,{display:"",position:""}),0!==oldCnt.childNodes.length||this.isTemplate||detach(oldCnt)},new ej2_base_es2015_Animation(animateObj).animate(oldCnt))}triggerAnimation(id,value){let oldCnt,prevIndex=this.prevIndex;[].slice.call(this.element.querySelector(".e-content").children).forEach(item=>{item.id===this.prevActiveEle&&(oldCnt=item)});let prevEle=this.tbItem[prevIndex],no=this.extIndex(this.tbItem[this.selectedItem].id),newCnt=this.getTrgContent(this.cntEle,no);if(isNullOrUndefined(oldCnt)&&!isNullOrUndefined(prevEle)){let idNo=this.extIndex(prevEle.id);oldCnt=this.getTrgContent(this.cntEle,idNo)}if(this.prevActiveEle=newCnt.id,this.initRender||!1===value||this.animation==={}||isNullOrUndefined(this.animation))return void(oldCnt&&oldCnt!==newCnt&&oldCnt.classList.remove("e-active"));let animateObj,cnt=ej2_base_es2015_select(".e-content",this.element);if(this.prevIndex>this.selectedItem&&!this.isPopup){let openEff=this.animation.previous.effect;animateObj={name:"None"===openEff?"":"SlideLeftIn"!==openEff?openEff:"SlideLeftIn",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.selectedItem||this.prevIndex===this.selectedItem){let clsEff=this.animation.next.effect;animateObj={name:"None"===clsEff?"":"SlideRightIn"!==clsEff?clsEff:"SlideRightIn",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}}animateObj.progress=()=>{cnt.classList.add("e-progress"),this.setActiveBorder()},animateObj.end=()=>{cnt.classList.remove("e-progress"),newCnt.classList.add("e-active")},this.initRender||isNullOrUndefined(oldCnt)||this.triggerPrevAnimation(oldCnt,prevIndex),this.isPopup=!1,""===animateObj.name?newCnt.classList.add("e-active"):new ej2_base_es2015_Animation(animateObj).animate(newCnt)}keyPressed(trg){let trgParent=closest(trg,".e-tab-header ."+CLS_TB_ITEM),trgIndex=this.getEleIndex(trgParent);!isNullOrUndefined(this.popEle)&&trg.classList.contains("e-hor-nav")?this.popEle.classList.contains("e-popup-open")?this.popObj.hide(this.hide):this.popObj.show(this.show):trg.classList.contains("e-scroll-nav")?trg.click():isNullOrUndefined(trgParent)||!1!==trgParent.classList.contains("e-active")||(this.select(trgIndex),isNullOrUndefined(this.popEle)||this.popObj.hide(this.hide))}getEleIndex(item){return Array.prototype.indexOf.call(ej2_base_es2015_selectAll(".e-tab-header ."+CLS_TB_ITEM,this.element),item)}extIndex(id){return id.replace("e-item_","")}expTemplateContent(){this.templateEle.forEach(eleStr=>{isNullOrUndefined(this.element.querySelector(eleStr))||(document.body.appendChild(this.element.querySelector(eleStr)).style.display="none")})}templateCompile(ele,cnt,index){let tempEle=this.createElement("div");if(this.compileElement(tempEle,cnt,"content",index),0!==tempEle.childNodes.length){ele.appendChild(tempEle);let item=this.items[index];isNullOrUndefined(item)||item.content&&isBlazor()&&!this.isStringTemplate&&0===item.content.indexOf("<div>Blazor")&&updateBlazorTemplate(this.element.id+index+"_content","ContentTemplate",item)}}compileElement(ele,val,prop,index){let templateFn,templateFUN;"string"==typeof val&&isBlazor()&&0!==val.indexOf("<div>Blazor")?(val=val.trim(),ele.innerHTML=val):templateFn=compile$$1(val),isNullOrUndefined(templateFn)||(templateFUN=isBlazor()&&!this.isStringTemplate&&0===val.indexOf("<div>Blazor")?templateFn({},this,prop,this.element.id+index+"_"+prop,this.isStringTemplate):templateFn({},this,prop)),!isNullOrUndefined(templateFn)&&templateFUN.length>0&&[].slice.call(templateFUN).forEach(el=>{ele.appendChild(el)})}headerTextCompile(element,text,index){this.compileElement(element,text,"headerTemplate",index)}getContent(ele,cnt,callType,index){let eleStr;if("string"==typeof cnt||isNullOrUndefined(cnt.innerHTML))if("."===cnt[0]||"#"===cnt[0])if(document.querySelectorAll(cnt).length){let eleVal=document.querySelector(cnt);eleStr=eleVal.outerHTML.trim(),"clone"===callType?ele.appendChild(eleVal.cloneNode(!0)):(ele.appendChild(eleVal),eleVal.style.display="")}else this.templateCompile(ele,cnt,index);else this.templateCompile(ele,cnt,index);else ele.appendChild(cnt);isNullOrUndefined(eleStr)||-1===this.templateEle.indexOf(cnt.toString())&&this.templateEle.push(cnt.toString())}getTrgContent(cntEle,no){return this.element.classList.contains("e-nested")?ej2_base_es2015_select(".e-nested> .e-content > #e-content_"+no,this.element):this.findEle(cntEle.children,"e-content_"+no)}findEle(items,key){let ele;for(let i=0;i<items.length;i++)if(items[i].id===key){ele=items[i];break}return ele}isVertical(){let isVertical="Left"===this.headerPlacement||"Right"===this.headerPlacement;return this.scrCntClass=isVertical?"e-vscroll-content":"e-hscroll-content",isVertical}addVerticalClass(){this.isVertical()&&(addClass([this.hdrEle],["e-vertical","Left"===this.headerPlacement?"e-vertical-left":"e-vertical-right"]),this.element.classList.add("e-vertical-tab")),"Bottom"===this.headerPlacement&&this.hdrEle.classList.add("e-horizontal-bottom")}updatePopAnimationConfig(){this.show={name:this.isVertical()?"FadeIn":"SlideDown",duration:100},this.hide={name:this.isVertical()?"FadeOut":"SlideUp",duration:100}}changeOrientation(place){this.setOrientation(place,this.hdrEle);let isVertical=!!this.hdrEle.classList.contains("e-vertical");removeClass([this.element],["e-vertical-tab"]),removeClass([this.hdrEle],["e-vertical","e-vertical-left","e-vertical-right"]),isVertical!==this.isVertical()&&(this.tbObj.setProperties({height:this.isVertical()?"100%":"auto",width:this.isVertical()?"auto":"100%"},!0),this.tbObj.changeOrientation(),this.updatePopAnimationConfig()),this.addVerticalClass(),this.updateOrientationAttribute(),this.select(this.selectedItem)}setOrientation(place,ele){"Bottom"===place&&1!==Array.prototype.indexOf.call(this.element.children,ele)?this.element.appendChild(ele):this.element.insertBefore(ele,ej2_base_es2015_select(".e-content",this.element))}setCssClass(ele,cls,val){if(""===cls)return;let list=cls.split(" ");for(let i=0;i<list.length;i++)val?ele.classList.add(list[i]):ele.classList.remove(list[i])}setContentHeight(val){if(isNullOrUndefined(this.cntEle))return;let hdrEle=ej2_base_es2015_select(".e-tab-header",this.element);if("None"===this.heightAdjustMode){if("auto"===this.height)return;this.isVertical()||setStyleAttribute(this.cntEle,{height:this.element.offsetHeight-hdrEle.offsetHeight+"px"})}else if("Fill"===this.heightAdjustMode)setStyleAttribute(this.element,{height:"100%"}),setStyleAttribute(this.cntEle,{height:"auto"});else if("Auto"===this.heightAdjustMode){let cnt=ej2_base_es2015_selectAll(".e-content > .e-item",this.element);if(!0===this.isTemplate)for(let i=0;i<cnt.length;i++)cnt[i].setAttribute("style","display:block; visibility: visible"),this.maxHeight=Math.max(this.maxHeight,this.getHeight(cnt[i])),cnt[i].style.removeProperty("display"),cnt[i].style.removeProperty("visibility");else{this.cntEle=ej2_base_es2015_select(".e-content",this.element),!0===val&&this.cntEle.appendChild(this.createElement("div",{id:"e-content_0",className:"e-item e-active",attrs:{role:"tabpanel","aria-labelledby":"e-item_0"}}));let ele=this.cntEle.children.item(0);for(let i=0;i<this.items.length;i++)for(this.getContent(ele,this.items[i].content,"clone",i),this.maxHeight=Math.max(this.maxHeight,this.getHeight(ele));ele.firstChild;)ele.removeChild(ele.firstChild);this.clearTemplate(["content"]),this.templateEle=[],this.getContent(ele,this.items[0].content,"render",0),ele.classList.remove("e-active")}setStyleAttribute(this.cntEle,{height:this.maxHeight+"px"})}else setStyleAttribute(this.cntEle,{height:"auto"})}getHeight(ele){let cs=window.getComputedStyle(ele);return ele.offsetHeight+parseFloat(cs.getPropertyValue("padding-top"))+parseFloat(cs.getPropertyValue("padding-bottom"))+parseFloat(cs.getPropertyValue("margin-top"))+parseFloat(cs.getPropertyValue("margin-bottom"))}setActiveBorder(){let trg,bar,scrollCnt,trgHdrEle;if("Bottom"===this.headerPlacement?(trgHdrEle=ej2_base_es2015_select(".e-tab-header",this.element),trg=ej2_base_es2015_select(".e-toolbar-item.e-active",trgHdrEle)):(trgHdrEle=ej2_base_es2015_select(".e-tab-header",this.element),trg=ej2_base_es2015_select(".e-toolbar-item.e-active",this.element)),null===trg)return;let root=closest(trg,".e-tab");if(this.element===root){if(this.tbItems=ej2_base_es2015_select("."+CLS_TB_ITEMS,trgHdrEle),bar=ej2_base_es2015_select(".e-indicator",trgHdrEle),scrollCnt=ej2_base_es2015_select(".e-toolbar-items ."+this.scrCntClass,trgHdrEle),this.isVertical())setStyleAttribute(bar,{left:"",right:""}),setStyleAttribute(bar,0!==(isNullOrUndefined(scrollCnt)?this.tbItems.offsetHeight:scrollCnt.offsetHeight)?{top:trg.offsetTop+"px",height:trg.offsetHeight+"px"}:{top:0,height:0});else{setStyleAttribute(bar,{top:"",height:""});let tbWidth=isNullOrUndefined(scrollCnt)?this.tbItems.offsetWidth:scrollCnt.offsetWidth;setStyleAttribute(bar,0!==tbWidth?{left:trg.offsetLeft+"px",right:tbWidth-(trg.offsetLeft+trg.offsetWidth)+"px"}:{left:"auto",right:"auto"})}isNullOrUndefined(this.bdrLine)||this.bdrLine.classList.remove("e-hidden")}}setActive(value){this.tbItem=ej2_base_es2015_selectAll(".e-tab-header ."+CLS_TB_ITEM,this.element);let trg=this.tbItem[value];if(value>=0&&this.setProperties({selectedItem:value},!0),value<0||isNaN(value)||0===this.tbItem.length)return;if(trg.classList.contains("e-active"))return void this.setActiveBorder();if(!this.isTemplate){let prev=this.tbItem[this.prevIndex];isNullOrUndefined(prev)||prev.removeAttribute("aria-controls"),attributes(trg,{"aria-controls":"e-content_"+value})}let id=trg.id;this.removeActiveClass(id),trg.classList.add("e-active"),trg.setAttribute("aria-selected","true");let no=Number(this.extIndex(id));if(isNullOrUndefined(this.prevActiveEle)&&(this.prevActiveEle="e-content_"+no),attributes(this.element,{"aria-activedescendant":id}),this.isTemplate){if(ej2_base_es2015_select(".e-content",this.element).children.length>0){let trg=this.findEle(ej2_base_es2015_select(".e-content",this.element).children,"e-content_"+no);isNullOrUndefined(trg)||trg.classList.add("e-active"),this.triggerAnimation(id,this.enableAnimation)}}else{this.cntEle=ej2_base_es2015_select(".e-tab > .e-content",this.element);let item=this.getTrgContent(this.cntEle,this.extIndex(id));if(isNullOrUndefined(item)){this.cntEle.appendChild(this.createElement("div",{id:"e-content_"+this.extIndex(id),className:"e-item e-active",attrs:{role:"tabpanel","aria-labelledby":"e-item_"+this.extIndex(id)}}));let eleTrg=this.getTrgContent(this.cntEle,this.extIndex(id)),itemIndex=Array.prototype.indexOf.call(this.itemIndexArray,trg.id);this.getContent(eleTrg,this.items[itemIndex].content,"render",itemIndex)}else item.classList.add("e-active");this.triggerAnimation(id,this.enableAnimation)}this.setActiveBorder();let curActItem=ej2_base_es2015_select(".e-tab-header #"+id,this.element);this.refreshItemVisibility(curActItem),this.initRender||curActItem.firstChild.focus();let eventArg={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:trg,selectedIndex:value,selectedContent:ej2_base_es2015_select("#e-content_"+this.selectingID,this.content),isSwiped:this.isSwipeed};this.initRender&&0===this.selectedItem||this.trigger("selected",eventArg)}setItems(items){this.isReplace=!0,this.tbItems=ej2_base_es2015_select(".e-tab-header ."+CLS_TB_ITEMS,this.element),this.tbObj.items=this.parseObject(items,0),this.tbObj.dataBind(),this.isReplace=!1}setRTL(value){this.tbObj.enableRtl=value,this.tbObj.dataBind(),this.setCssClass(this.element,"e-rtl",value),this.refreshActiveBorder()}refreshActiveBorder(){isNullOrUndefined(this.bdrLine)||this.bdrLine.classList.add("e-hidden"),this.setActiveBorder()}showPopup(config){let tbPop=ej2_base_es2015_select(".e-popup.e-toolbar-pop",this.hdrEle);if(tbPop.classList.contains("e-popup-close")){let tbPopObj=tbPop&&tbPop.ej2_instances[0];tbPopObj.position.X="Left"===this.headerPlacement?"left":"right",tbPopObj.dataBind(),tbPopObj.show(config)}}wireEvents(){window.addEventListener("resize",this.resizeContext),EventHandler.add(this.element,"mouseover",this.hoverHandler,this),EventHandler.add(this.element,"keydown",this.spaceKeyDown,this),isNullOrUndefined(this.cntEle)||(this.touchModule=new ej2_base_es2015_Touch(this.cntEle,{swipe:this.swipeHandler.bind(this)})),this.keyModule=new ej2_base_es2015_KeyboardEvents(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new ej2_base_es2015_KeyboardEvents(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})}unWireEvents(){this.keyModule.destroy(),this.tabKeyModule.destroy(),isNullOrUndefined(this.cntEle)||this.touchModule.destroy(),window.removeEventListener("resize",this.resizeContext),EventHandler.remove(this.element,"mouseover",this.hoverHandler),EventHandler.remove(this.element,"keydown",this.spaceKeyDown),this.element.classList.remove("e-rtl"),this.element.classList.remove("e-focused")}clickHandler(args){this.element.classList.remove("e-focused");let trg=args.originalEvent.target,trgParent=closest(trg,"."+CLS_TB_ITEM),trgIndex=this.getEleIndex(trgParent);trg.classList.contains("e-close-icon")?this.removeTab(trgIndex):this.isVertical()&&closest(trg,".e-hor-nav")?this.showPopup(this.show):(this.isPopup=!1,isNullOrUndefined(trgParent)||trgIndex===this.selectedItem||this.select(trgIndex))}swipeHandler(e){if(!(e.velocity<3&&isNullOrUndefined(e.originalEvent.changedTouches))){if(this.isSwipeed=!0,"Right"===e.swipeDirection&&0!==this.selectedItem){for(let k=this.selectedItem-1;k>=0;k--)if(!this.tbItem[k].classList.contains("e-hidden")){this.select(k);break}}else if("Left"===e.swipeDirection&&this.selectedItem!==ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element).length-1)for(let i=this.selectedItem+1;i<this.tbItem.length;i++)if(!this.tbItem[i].classList.contains("e-hidden")){this.select(i);break}this.isSwipeed=!1}}spaceKeyDown(e){(32===e.keyCode&&32===e.which||35===e.keyCode&&35===e.which)&&(isNullOrUndefined(closest(e.target,".e-tab-header"))||e.preventDefault())}keyHandler(e){if(this.element.classList.contains("e-disable"))return;this.element.classList.add("e-focused");let trg=e.target,actEle=ej2_base_es2015_select(".e-tab-header .e-active",this.element);switch(ej2_base_es2015_selectAll(".e-toolbar-item:not(.e-toolbar-popup)",this.element),this.popEle=ej2_base_es2015_select(".e-tab-header .e-toolbar-pop",this.element),isNullOrUndefined(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]),e.action){case"space":case"enter":if(trg.parentElement.classList.contains("e-disable"))return;if("enter"===e.action&&trg.classList.contains("e-hor-nav")){this.showPopup(this.show);break}this.keyPressed(trg);break;case"tab":case"shiftTab":trg.classList.contains("e-tab-wrap")&&!1===closest(trg,"."+CLS_TB_ITEM).classList.contains("e-active")&&trg.setAttribute("tabindex","-1"),this.popObj&&isVisible(this.popObj.element)&&this.popObj.hide(this.hide),actEle.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":let item=closest(document.activeElement,"."+CLS_TB_ITEM);isNullOrUndefined(item)||this.refreshItemVisibility(item);break;case"openPopup":e.preventDefault(),!isNullOrUndefined(this.popEle)&&this.popEle.classList.contains("e-popup-close")&&this.popObj.show(this.show);break;case"delete":let trgParent=closest(trg,"."+CLS_TB_ITEM);if(!0===this.showCloseButton&&!isNullOrUndefined(trgParent)){let nxtSib=trgParent.nextSibling;!isNullOrUndefined(nxtSib)&&nxtSib.classList.contains(CLS_TB_ITEM)&&nxtSib.firstChild.focus(),this.removeTab(this.getEleIndex(trgParent))}this.setActiveBorder()}}refreshActElePosition(){let activeEle=ej2_base_es2015_select(".e-toolbar-item.e-toolbar-popup.e-active",this.element);isNullOrUndefined(activeEle)||this.select(this.getEleIndex(activeEle)),this.refreshActiveBorder()}refreshItemVisibility(target){let scrCnt=ej2_base_es2015_select("."+this.scrCntClass,this.tbItems);if(!this.isVertical()&&!isNullOrUndefined(scrCnt)){let scrBar=ej2_base_es2015_select(".e-hscroll-bar",this.tbItems),scrStart=scrBar.scrollLeft,scrEnd=scrStart+scrBar.offsetWidth,eleStart=target.offsetLeft,eleWidth=target.offsetWidth,eleEnd=target.offsetLeft+target.offsetWidth;scrStart<eleStart&&scrEnd<eleEnd?scrBar.scrollLeft=scrStart+(eleWidth-(scrEnd-eleStart)):scrStart>eleStart&&scrEnd>eleEnd&&(scrBar.scrollLeft=scrStart-(eleWidth-(eleEnd-scrStart)))}}hoverHandler(e){let trg=e.target;!isNullOrUndefined(trg.classList)&&trg.classList.contains("e-close-icon")&&trg.setAttribute("title",new L10n("tab",{closeButtonTitle:this.title},this.locale).getConstant("closeButtonTitle"))}evalOnPropertyChangeItems(newProp,oldProp){if(newProp.items instanceof Array&&oldProp.items instanceof Array)if(this.lastIndex=0,isNullOrUndefined(this.tbObj))this.reRenderItems();else{this.setItems(newProp.items),this.templateEle.length>0&&this.expTemplateContent(),this.templateEle=[];let selectElement=ej2_base_es2015_select(".e-tab > .e-content",this.element);for(;selectElement.firstElementChild;)detach(selectElement.firstElementChild);this.select(this.selectedItem)}else{let changedProp=Object.keys(newProp.items);for(let i=0;i<changedProp.length;i++){let index=parseInt(Object.keys(newProp.items)[i],10),property=Object.keys(newProp.items[index])[0],oldVal=Object(oldProp.items[index])[property],newVal=Object(newProp.items[index])[property],hdrItem=ej2_base_es2015_select(".e-toolbar-items #e-item_"+index,this.element),cntItem=ej2_base_es2015_select(".e-content #e-content_"+index,this.element);if("header"===property||"headerTemplate"===property){let icon=isNullOrUndefined(this.items[index].header)||isNullOrUndefined(this.items[index].header.iconCss)?"":this.items[index].header.iconCss;if(""===(this.items[index].headerTemplate||this.items[index].header.text)&&""===icon)this.removeTab(index);else{let arr=[];arr.push(this.items[index]),this.items.splice(index,1),this.itemIndexArray.splice(index,1),this.tbObj.items.splice(index,1);let isHiddenEle=hdrItem.classList.contains("e-hidden");detach(hdrItem),this.isReplace=!0,this.addTab(arr,index),isHiddenEle&&this.hideTab(index),this.isReplace=!1}}if("content"===property&&!isNullOrUndefined(cntItem))if("string"!=typeof newVal&&!isNullOrUndefined(newVal.innerHTML)||"."!==newVal[0]&&"#"!==newVal[0]||!newVal.length)""===newVal&&"#"===oldVal[0]?(document.body.appendChild(this.element.querySelector(oldVal)).style.display="none",cntItem.innerHTML=newVal):cntItem.innerHTML=newVal;else{let eleVal=document.querySelector(newVal);cntItem.appendChild(eleVal),eleVal.style.display=""}"cssClass"===property&&(isNullOrUndefined(hdrItem)||(hdrItem.classList.remove(oldVal),hdrItem.classList.add(newVal)),isNullOrUndefined(cntItem)||(cntItem.classList.remove(oldVal),cntItem.classList.add(newVal))),"disabled"===property&&this.enableTab(index,!0!==newVal)}}}enableTab(index,value){let tbItems=ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element)[index];isNullOrUndefined(tbItems)||(!0===value?(tbItems.classList.remove("e-disable","e-overlay"),tbItems.firstChild.setAttribute("tabindex","-1")):(tbItems.classList.add("e-disable","e-overlay"),tbItems.firstChild.removeAttribute("tabindex"),tbItems.classList.contains("e-active")&&this.select(index+1)),isNullOrUndefined(this.items[index])||(this.items[index].disabled=!value,this.dataBind()),tbItems.setAttribute("aria-disabled",!0===value?"false":"true"))}addTab(items,index){let addArgs={addedItems:items,cancel:!1};this.isReplace?this.addingTabContent(items,index):this.trigger("adding",addArgs,tabAddingArgs=>{tabAddingArgs.cancel||this.addingTabContent(items,index)})}addingTabContent(items,index){let lastEleIndex=0;if(this.hdrEle=ej2_base_es2015_select(".e-tab-header",this.element),isNullOrUndefined(this.hdrEle))this.items=items,this.reRenderItems();else{let itemsCount=ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element).length;if(0!==itemsCount&&(lastEleIndex=this.lastIndex+1),isNullOrUndefined(index)&&(index=itemsCount-1),itemsCount<index||index<0||isNaN(index))return;0!==itemsCount||isNullOrUndefined(this.hdrEle)||(this.hdrEle.style.display=""),isNullOrUndefined(this.bdrLine)||this.bdrLine.classList.add("e-hidden"),this.tbItems=ej2_base_es2015_select(".e-tab-header ."+CLS_TB_ITEMS,this.element),this.isAdd=!0;let tabItems=this.parseObject(items,index);this.isAdd=!1;let textValue,i=0;items.forEach((item,place)=>{if(textValue=item.headerTemplate||item.header.text,isNullOrUndefined(item.headerTemplate||item.header)||isNullOrUndefined(textValue)||0===textValue.length&&isNullOrUndefined(item.header.iconCss)||(this.items.splice(index+i,0,item),i++),this.isTemplate&&!isNullOrUndefined(item.header)&&!isNullOrUndefined(item.header.text)){let no=lastEleIndex+place,ele=this.createElement("div",{id:"e-content_"+no,className:"e-item",attrs:{role:"tabpanel","aria-labelledby":"e-item_"+no}});this.cntEle.insertBefore(ele,this.cntEle.children[index+place]);let eleTrg=this.getTrgContent(this.cntEle,no.toString());this.getContent(eleTrg,item.content,"render",index)}}),this.tbObj.addItems(tabItems,index),this.isReplace||this.trigger("added",{addedItems:items}),this.selectedItem===index?this.select(index):this.setActiveBorder()}}removeTab(index){let trg=ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element)[index];isNullOrUndefined(trg)||this.trigger("removing",{removedItem:trg,removedIndex:index,cancel:!1},tabRemovingArgs=>{if(!tabRemovingArgs.cancel){this.tbObj.removeItems(index),this.items.splice(index,1),this.itemIndexArray.splice(index,1),this.refreshActiveBorder();let cntTrg=ej2_base_es2015_select("#e-content_"+this.extIndex(trg.id),ej2_base_es2015_select(".e-content",this.element));isNullOrUndefined(cntTrg)||detach(cntTrg),this.trigger("removed",tabRemovingArgs),trg.classList.contains("e-active")&&(index=index>ej2_base_es2015_selectAll(".e-toolbar-item:not(.e-toolbar-popup)",this.element).length-1?index-1:index,this.enableAnimation=!1,this.selectedItem=index,this.select(index)),0===ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element).length&&(this.hdrEle.style.display="none"),this.enableAnimation=!0}})}hideTab(index,value){let items,item=ej2_base_es2015_selectAll("."+CLS_TB_ITEM,this.element)[index];if(!isNullOrUndefined(item)){if(isNullOrUndefined(value)&&(value=!0),this.bdrLine.classList.add("e-hidden"),!0===value)if(item.classList.add("e-hidden"),0!==(items=ej2_base_es2015_selectAll(".e-toolbar-item:not(.e-hidden)",this.tbItems)).length&&item.classList.contains("e-active")){if(0!==index)for(let i=index-1;i>=0;i--){if(!this.tbItem[i].classList.contains("e-hidden")){this.select(i);break}if(0===i)for(let k=index+1;k<this.tbItem.length;k++)if(!this.tbItem[k].classList.contains("e-hidden")){this.select(k);break}}else for(let k=index+1;k<this.tbItem.length;k++)if(!this.tbItem[k].classList.contains("e-hidden")){this.select(k);break}}else 0===items.length&&this.element.classList.add("e-hidden");else this.element.classList.remove("e-hidden"),0===(items=ej2_base_es2015_selectAll(".e-toolbar-item:not(.e-hidden)",this.tbItems)).length&&this.select(index),item.classList.remove("e-hidden");this.setActiveBorder(),item.setAttribute("aria-hidden",""+value)}}select(args){this.tbItems=ej2_base_es2015_select(".e-tab-header ."+CLS_TB_ITEMS,this.element),this.tbItem=ej2_base_es2015_selectAll(".e-tab-header ."+CLS_TB_ITEM,this.element),this.content=ej2_base_es2015_select(".e-content",this.element),this.prevItem=this.tbItem[this.prevIndex],isNullOrUndefined(this.selectedItem)||this.selectedItem<0||this.tbItem.length<=this.selectedItem||isNaN(this.selectedItem)?this.selectedItem=0:this.selectedID=this.extIndex(this.tbItem[this.selectedItem].id);let trg=this.tbItem[args];isNullOrUndefined(trg)?this.selectedID="0":this.selectingID=this.extIndex(trg.id),isNullOrUndefined(this.prevItem)||this.prevItem.classList.contains("e-disable")||this.prevItem.children.item(0).setAttribute("tabindex","-1");let eventArg={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:this.tbItem[this.selectedItem],selectedIndex:this.selectedItem,selectedContent:isNullOrUndefined(this.content)?null:ej2_base_es2015_select("#e-content_"+this.selectedID,this.content),selectingItem:trg,selectingIndex:args,selectingContent:isNullOrUndefined(this.content)?null:ej2_base_es2015_select("#e-content_"+this.selectingID,this.content),isSwiped:this.isSwipeed,cancel:!1};this.initRender&&0===this.selectedItem?this.selectingContent(args):this.trigger("selecting",eventArg,selectArgs=>{selectArgs.cancel||this.selectingContent(args)})}selectingContent(args){if("number"==typeof args){if(!isNullOrUndefined(this.tbItem[args])&&this.tbItem[args].classList.contains("e-disable"))for(let i=args+1;i<this.items.length;i++){if(!1===this.items[i].disabled){args=i;break}args=0}this.tbItem.length>args&&args>=0&&!isNaN(args)?(this.prevIndex=this.selectedItem,this.tbItem[args].classList.contains("e-toolbar-popup")?this.setActive(this.popupHandler(this.tbItem[args])):this.setActive(args)):this.setActive(0)}else args instanceof HTMLElement&&this.setActive(this.getEleIndex(args))}disable(value){this.setCssClass(this.element,"e-disable",value),this.element.setAttribute("aria-disabled",""+value)}getPersistData(){return this.addOnPersist(["selectedItem","actEleId"])}getModuleName(){return"tab"}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"width":setStyleAttribute(this.element,{width:formatUnit(newProp.width)});break;case"height":setStyleAttribute(this.element,{height:formatUnit(newProp.height)}),this.setContentHeight(!1);break;case"cssClass":""!==oldProp.cssClass?(this.setCssClass(this.element,oldProp.cssClass,!1),this.setCssClass(this.element,newProp.cssClass,!0)):this.setCssClass(this.element,newProp.cssClass,!0);break;case"items":this.evalOnPropertyChangeItems(newProp,oldProp);break;case"showCloseButton":this.setCloseButton(newProp.showCloseButton);break;case"selectedItem":this.selectedItem=oldProp.selectedItem,this.select(newProp.selectedItem);break;case"headerPlacement":this.changeOrientation(newProp.headerPlacement);break;case"enableRtl":this.setRTL(newProp.enableRtl);break;case"overflowMode":this.tbObj.overflowMode=newProp.overflowMode,this.tbObj.dataBind(),this.refreshActElePosition();break;case"heightAdjustMode":this.setContentHeight(!1),this.select(this.selectedItem);break;case"scrollStep":this.tbObj&&(this.tbObj.scrollStep=this.scrollStep)}}};return __decorate([Collection([],ej2_navigations_es2015_TabItem)],Tab.prototype,"items",void 0),__decorate([Property("100%")],Tab.prototype,"width",void 0),__decorate([Property("auto")],Tab.prototype,"height",void 0),__decorate([Property("")],Tab.prototype,"cssClass",void 0),__decorate([Property(0)],Tab.prototype,"selectedItem",void 0),__decorate([Property("Top")],Tab.prototype,"headerPlacement",void 0),__decorate([Property("Content")],Tab.prototype,"heightAdjustMode",void 0),__decorate([Property("Scrollable")],Tab.prototype,"overflowMode",void 0),__decorate([Property(!1)],Tab.prototype,"enablePersistence",void 0),__decorate([Property(!1)],Tab.prototype,"showCloseButton",void 0),__decorate([Property()],Tab.prototype,"scrollStep",void 0),__decorate([Complex({},ej2_navigations_es2015_TabAnimationSettings)],Tab.prototype,"animation",void 0),__decorate([ej2_base_es2015_Event()],Tab.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],Tab.prototype,"adding",void 0),__decorate([ej2_base_es2015_Event()],Tab.prototype,"added",void 0),__decorate([ej2_base_es2015_Event()],Tab.prototype,"selecting",void 0),__decorate([ej2_base_es2015_Event()],Tab.prototype,"selected",void 0),__decorate([ej2_base_es2015_Event()],Tab.prototype,"removing",void 0),__decorate([ej2_base_es2015_Event()],Tab.prototype,"removed",void 0),__decorate([ej2_base_es2015_Event()],Tab.prototype,"destroyed",void 0),__decorate([NotifyPropertyChanges],Tab)})();class Save{constructor(){}static save(fileName,buffer){if(null==fileName||""===fileName)throw new Error("ArgumentException: fileName cannot be undefined, null or empty");let extension=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length),mimeType=this.getMimeType(extension);if(""!==mimeType&&(buffer=new Blob([buffer],{type:mimeType})),this.isMicrosoftBrowser)navigator.msSaveBlob(buffer,fileName);else{let downloadLink=document.createElementNS("http://www.w3.org/1999/xhtml","a");this.saveInternal(fileName,extension,buffer,downloadLink,"download"in downloadLink)}}static saveInternal(fileName,extension,buffer,downloadLink,hasDownloadAttribute){if(hasDownloadAttribute){downloadLink.download=fileName;let dataUrl=window.URL.createObjectURL(buffer);downloadLink.href=dataUrl;let event=document.createEvent("MouseEvent");event.initEvent("click",!0,!0),downloadLink.dispatchEvent(event),setTimeout(()=>{window.URL.revokeObjectURL(dataUrl),dataUrl=void 0})}else if("docx"!==extension&&"xlsx"!==extension){let url=window.URL.createObjectURL(buffer);window.open(url,"_blank")||(window.location.href=url)}else{let reader=new FileReader;reader.onloadend=()=>{window.open(reader.result,"_blank")||(window.location.href=reader.result)},reader.readAsDataURL(buffer)}}static getMimeType(extension){let mimeType="";switch(extension){case"html":mimeType="text/html";break;case"pdf":mimeType="application/pdf";break;case"docx":mimeType="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"xlsx":mimeType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;case"txt":mimeType="text/plain"}return mimeType}}class Encoding{constructor(includeBom){this.emitBOM=!0,this.encodingType="Ansi",this.initBOM(includeBom)}get includeBom(){return this.emitBOM}get type(){return this.encodingType}set type(value){this.encodingType=value}initBOM(includeBom){this.emitBOM=null==includeBom||includeBom}getByteCount(chars){return validateNullOrUndefined(chars,"string"),""===chars?this.utf8Len(chars.charCodeAt(0)):(null==this.type&&(this.type="Ansi"),this.getByteCountInternal(chars,0,chars.length))}utf8Len(codePoint){return codePoint<=127?1:codePoint<=2047?2:codePoint<=65535?3:codePoint<=2097151?4:0}isHighSurrogate(codeUnit){return codeUnit>=55296&&codeUnit<=56319}toCodepoint(highCodeUnit,lowCodeUnit){return 65536+((highCodeUnit=(1023&highCodeUnit)<<10)|1023&lowCodeUnit)}getByteCountInternal(chars,charIndex,charCount){let byteCount=0;if("Utf8"===this.encodingType||"Unicode"===this.encodingType){let isUtf8="Utf8"===this.encodingType;for(let i=0;i<charCount;i++){let charCode=chars.charCodeAt(isUtf8?charIndex:charIndex++);if(this.isHighSurrogate(charCode))if(isUtf8){let high=charCode,low=chars.charCodeAt(++charIndex);byteCount+=this.utf8Len(this.toCodepoint(high,low))}else byteCount+=4,++i;else byteCount+=isUtf8?this.utf8Len(charCode):2;isUtf8&&charIndex++}return byteCount}return charCount}getBytes(s,charIndex,charCount){if(validateNullOrUndefined(s,"string"),validateNullOrUndefined(charIndex,"charIndex"),validateNullOrUndefined(charCount,"charCount"),charIndex<0||charCount<0)throw new RangeError("Argument Out Of Range Exception: charIndex or charCount is less than zero");if(s.length-charIndex<charCount)throw new RangeError("Argument Out Of Range Exception: charIndex and charCount do not denote a valid range in string");if(""===s)return new ArrayBuffer(0);null==this.type&&(this.type="Ansi");let byteCount=this.getByteCountInternal(s,charIndex,charCount);switch(this.type){case"Utf8":return this.getBytesOfUtf8Encoding(byteCount,s,charIndex,charCount);case"Unicode":return this.getBytesOfUnicodeEncoding(byteCount,s,charIndex,charCount);default:return this.getBytesOfAnsiEncoding(byteCount,s,charIndex,charCount)}}getString(bytes,index,count){if(validateNullOrUndefined(bytes,"bytes"),validateNullOrUndefined(index,"index"),validateNullOrUndefined(count,"count"),index<0||count<0)throw new RangeError("Argument Out Of Range Exception: index or count is less than zero");if(bytes.byteLength-index<count)throw new RangeError("Argument Out Of Range Exception: index and count do not denote a valid range in bytes");if(0===bytes.byteLength||0===count)return"";null==this.type&&(this.type="Ansi");let out="",byteCal=new Uint8Array(bytes);switch(this.type){case"Utf8":return this.getStringOfUtf8Encoding(byteCal,index,count);case"Unicode":let byteUnicode=new Uint16Array(bytes);return this.getStringofUnicodeEncoding(byteUnicode,index,count);default:let j=index;for(let i=0;i<count;i++)out+=String.fromCharCode(byteCal[j]),j++;return out}}getBytesOfAnsiEncoding(byteCount,s,charIndex,charCount){let bytes=new ArrayBuffer(byteCount),bufview=new Uint8Array(bytes),k=0;for(let i=0;i<charCount;i++){let charcode=s.charCodeAt(charIndex++);bufview[k]=charcode<2048?charcode:63,k++}return bytes}getBytesOfUtf8Encoding(byteCount,s,charIndex,charCount){let bytes=new ArrayBuffer(byteCount),uint=new Uint8Array(bytes),index=charIndex,j=0;for(let i=0;i<charCount;i++){let charcode=s.charCodeAt(index);charcode<=127?uint[j]=charcode:charcode<2048?(uint[j]=192|charcode>>6,uint[++j]=128|63&charcode):charcode<55296||charcode>=57344?(uint[j]=224|charcode>>12,uint[++j]=128|charcode>>6&63,uint[++j]=128|63&charcode):(uint[j]=239,uint[++j]=191,uint[++j]=189),++j,++index}return bytes}getBytesOfUnicodeEncoding(byteCount,s,charIndex,charCount){let bytes=new ArrayBuffer(byteCount),uint16=new Uint16Array(bytes);for(let i=0;i<charCount;i++){let charcode=s.charCodeAt(i);uint16[i]=charcode}return bytes}getStringOfUtf8Encoding(byteCal,index,count){let j=0,i=index,s="";for(;j<count;j++){let c=byteCal[i++];for(;i>byteCal.length;)return s;c>127&&(c>191&&c<224&&i<count?c=(31&c)<<6|63&byteCal[i]:c>223&&c<240&&i<byteCal.byteLength?c=(15&c)<<12|(63&byteCal[i])<<6|63&byteCal[++i]:c>239&&c<248&&i<byteCal.byteLength&&(c=(7&c)<<18|(63&byteCal[i])<<12|(63&byteCal[++i])<<6|63&byteCal[++i]),++i),s+=String.fromCharCode(c)}return s}getStringofUnicodeEncoding(byteUni,index,count){if(count>byteUni.length)throw new RangeError("ArgumentOutOfRange_Count");let byte16=new Uint16Array(count);for(let i=0;i<count&&i<byteUni.length;i++)byte16[i]=byteUni[index++];return String.fromCharCode.apply(null,byte16)}destroy(){this.emitBOM=void 0,this.encodingType=void 0}}function validateNullOrUndefined(value,message){if(null==value)throw new Error("ArgumentException: "+message+" cannot be null or undefined")}class StreamWriter{get buffer(){return this.flush(),this.bufferBlob}get encoding(){return this.enc}constructor(encoding){this.bufferBlob=new Blob([""]),this.bufferText="",this.init(encoding),Save.isMicrosoftBrowser=!!navigator.msSaveBlob}init(encoding){null==encoding?(this.enc=new Encoding(!1),this.enc.type="Utf8"):(this.enc=encoding,this.setBomByte())}setBomByte(){if(this.encoding.includeBom)switch(this.encoding.type){case"Unicode":let arrayUnicode=new ArrayBuffer(2),uint8=new Uint8Array(arrayUnicode);uint8[0]=255,uint8[1]=254,this.bufferBlob=new Blob([arrayUnicode]);break;case"Utf8":let arrayUtf8=new ArrayBuffer(3),utf8=new Uint8Array(arrayUtf8);utf8[0]=239,utf8[1]=187,utf8[2]=191,this.bufferBlob=new Blob([arrayUtf8]);break;default:this.bufferBlob=new Blob([""])}}save(fileName){""!==this.bufferText&&this.flush(),Save.save(fileName,this.buffer)}write(value){if(void 0===this.encoding)throw new Error("Object Disposed Exception: current writer is disposed");validateNullOrUndefined(value,"string"),this.bufferText+=value,this.bufferText.length>=10240&&this.flush()}flush(){if(null==this.bufferText||0===this.bufferText.length)return;let bufferArray=this.encoding.getBytes(this.bufferText,0,this.bufferText.length);this.bufferText="",this.bufferBlob=new Blob([this.bufferBlob,bufferArray])}writeLine(value){if(void 0===this.encoding)throw new Error("Object Disposed Exception: current writer is disposed");validateNullOrUndefined(value,"string"),this.bufferText=this.bufferText+value+"\r\n",this.bufferText.length>=10240&&this.flush()}destroy(){this.bufferBlob=void 0,this.bufferText=void 0,this.enc instanceof Encoding&&this.enc.destroy(),this.enc=void 0}}const ARR_LITERAL_CODES=new Int16Array(286),ARR_LITERAL_LENGTHS=new Uint8Array(286),ARR_DISTANCE_CODES=new Int16Array(30),ARR_DISTANCE_LENGTHS=new Uint8Array(30);let ej2_compression_es2015_CompressedStreamWriter=(()=>{class CompressedStreamWriter{constructor(noWrap){this.pendingBuffer=new Uint8Array(65536),this.pendingBufLength=0,this.pendingBufCache=0,this.pendingBufBitsInCache=0,this.bufferPosition=0,this.extraBits=0,this.currentHash=0,this.matchStart=0,this.matchLength=0,this.matchPrevAvail=!1,this.blockStart=0,this.stringStart=0,this.lookAhead=0,this.totalBytesIn=0,this.inputOffset=0,this.inputEnd=0,this.windowSize=32768,this.windowMask=this.windowSize-1,this.hashSize=32768,this.hashMask=this.hashSize-1,this.hashShift=Math.floor(17/3),this.maxDist=this.windowSize-262,this.checkSum=1,this.noWrap=!1,CompressedStreamWriter.isHuffmanTreeInitiated||(CompressedStreamWriter.initHuffmanTree(),CompressedStreamWriter.isHuffmanTreeInitiated=!0),this.treeLiteral=new CompressorHuffmanTree(this,286,257,15),this.treeDistances=new CompressorHuffmanTree(this,30,1,15),this.treeCodeLengths=new CompressorHuffmanTree(this,19,4,7),this.arrDistances=new Uint16Array(16384),this.arrLiterals=new Uint8Array(16384),this.stream=[],this.dataWindow=new Uint8Array(2*this.windowSize),this.hashHead=new Int16Array(this.hashSize),this.hashPrevious=new Int16Array(this.windowSize),this.blockStart=this.stringStart=1,this.noWrap=noWrap,noWrap||this.writeZLibHeader()}get compressedData(){return this.stream}get getCompressedString(){let compressedString="";if(void 0!==this.stream)for(let i=0;i<this.stream.length;i++)compressedString+=String.fromCharCode.apply(null,this.stream[i]);return compressedString}write(data,offset,length){if(null==data)throw new Error("ArgumentException: data cannot null or undefined");let end=offset+length;if(0>offset||offset>end||end>data.length)throw new Error("ArgumentOutOfRangeException: Offset or length is incorrect");if("string"==typeof data){let encode=new Encoding(!1);encode.type="Utf8",end=offset+(data=new Uint8Array(encode.getBytes(data,0,data.length))).length}for(this.inputBuffer=data,this.inputOffset=offset,this.inputEnd=end,this.noWrap||(this.checkSum=ChecksumCalculator.checksumUpdate(this.checkSum,this.inputBuffer,this.inputOffset,end));this.inputEnd!==this.inputOffset||0!==this.pendingBufLength;)this.pendingBufferFlush(),this.compressData(!1)}writeZLibHeader(){let headerDate=30720;headerDate|=64,this.pendingBufferWriteShortBytes(headerDate+=31-headerDate%31)}pendingBufferWriteShortBytes(s){this.pendingBuffer[this.pendingBufLength++]=s>>8,this.pendingBuffer[this.pendingBufLength++]=s}compressData(finish){let success;do{this.fillWindow(),success=this.compressSlow(finish&&this.inputEnd===this.inputOffset,finish)}while(0===this.pendingBufLength&&success);return success}compressSlow(flush,finish){if(this.lookAhead<262&&!flush)return!1;for(;this.lookAhead>=262||flush;){if(0===this.lookAhead)return this.lookAheadCompleted(finish);this.stringStart>=2*this.windowSize-262&&this.slideWindow();let prevMatch=this.matchStart,prevLen=this.matchLength;if(this.lookAhead>=3&&this.discardMatch(),prevLen>=3&&this.matchLength<=prevLen?prevLen=this.matchPreviousBest(prevMatch,prevLen):this.matchPreviousAvailable(),this.bufferPosition>=16384)return this.huffmanIsFull(finish)}return!0}discardMatch(){let hashHead=this.insertString();0!==hashHead&&this.stringStart-hashHead<=this.maxDist&&this.findLongestMatch(hashHead)&&this.matchLength<=5&&3===this.matchLength&&this.stringStart-this.matchStart>4096&&(this.matchLength=2)}matchPreviousAvailable(){this.matchPrevAvail&&this.huffmanTallyLit(255&this.dataWindow[this.stringStart-1]),this.matchPrevAvail=!0,this.stringStart++,this.lookAhead--}matchPreviousBest(prevMatch,prevLen){this.huffmanTallyDist(this.stringStart-1-prevMatch,prevLen),prevLen-=2;do{this.stringStart++,this.lookAhead--,this.lookAhead>=3&&this.insertString()}while(--prevLen>0);return this.stringStart++,this.lookAhead--,this.matchPrevAvail=!1,this.matchLength=2,prevLen}lookAheadCompleted(finish){return this.matchPrevAvail&&this.huffmanTallyLit(255&this.dataWindow[this.stringStart-1]),this.matchPrevAvail=!1,this.huffmanFlushBlock(this.dataWindow,this.blockStart,this.stringStart-this.blockStart,finish),this.blockStart=this.stringStart,!1}huffmanIsFull(finish){let len=this.stringStart-this.blockStart;this.matchPrevAvail&&len--;let lastBlock=finish&&0===this.lookAhead&&!this.matchPrevAvail;return this.huffmanFlushBlock(this.dataWindow,this.blockStart,len,lastBlock),this.blockStart+=len,!lastBlock}fillWindow(){for(this.stringStart>=this.windowSize+this.maxDist&&this.slideWindow();this.lookAhead<262&&this.inputOffset<this.inputEnd;){let more=2*this.windowSize-this.lookAhead-this.stringStart;more>this.inputEnd-this.inputOffset&&(more=this.inputEnd-this.inputOffset),this.dataWindow.set(this.inputBuffer.subarray(this.inputOffset,this.inputOffset+more),this.stringStart+this.lookAhead),this.inputOffset+=more,this.totalBytesIn+=more,this.lookAhead+=more}this.lookAhead>=3&&this.updateHash()}slideWindow(){this.dataWindow.set(this.dataWindow.subarray(this.windowSize,this.windowSize+this.windowSize),0),this.matchStart-=this.windowSize,this.stringStart-=this.windowSize,this.blockStart-=this.windowSize;for(let i=0;i<this.hashSize;++i){let m=65535&this.hashHead[i];this.hashHead[i]=m>=this.windowSize?m-this.windowSize:0}for(let i=0;i<this.windowSize;i++){let m=65535&this.hashPrevious[i];this.hashPrevious[i]=m>=this.windowSize?m-this.windowSize:0}}insertString(){let match,hash=(this.currentHash<<this.hashShift^this.dataWindow[this.stringStart+2])&this.hashMask;return this.hashPrevious[this.stringStart&this.windowMask]=match=this.hashHead[hash],this.hashHead[hash]=this.stringStart,this.currentHash=hash,65535&match}findLongestMatch(curMatch){let match,chainLen=4096,niceLen=258,scan=this.stringStart,bestEnd=this.stringStart+this.matchLength,bestLength=Math.max(this.matchLength,2),limit=Math.max(this.stringStart-this.maxDist,0),stringEnd=this.stringStart+258-1,scanEnd1=this.dataWindow[bestEnd-1],scanEnd=this.dataWindow[bestEnd],data=this.dataWindow;bestLength>=32&&(chainLen>>=2),niceLen>this.lookAhead&&(niceLen=this.lookAhead);do{if(data[curMatch+bestLength]===scanEnd&&data[curMatch+bestLength-1]===scanEnd1&&data[curMatch]===data[scan]&&data[curMatch+1]===data[scan+1]){for(match=curMatch+2,scan+=2;data[++scan]===data[++match]&&data[++scan]===data[++match]&&data[++scan]===data[++match]&&data[++scan]===data[++match]&&data[++scan]===data[++match]&&data[++scan]===data[++match]&&data[++scan]===data[++match]&&data[++scan]===data[++match]&&scan<stringEnd;);if(scan>bestEnd){if(this.matchStart=curMatch,bestEnd=scan,(bestLength=scan-this.stringStart)>=niceLen)break;scanEnd1=data[bestEnd-1],scanEnd=data[bestEnd]}scan=this.stringStart}}while((curMatch=65535&this.hashPrevious[curMatch&this.windowMask])>limit&&0!=--chainLen);return this.matchLength=Math.min(bestLength,this.lookAhead),this.matchLength>=3}updateHash(){this.currentHash=this.dataWindow[this.stringStart]<<this.hashShift^this.dataWindow[this.stringStart+1]}huffmanTallyLit(literal){return this.arrDistances[this.bufferPosition]=0,this.arrLiterals[this.bufferPosition++]=literal,this.treeLiteral.codeFrequencies[literal]++,this.bufferPosition>=16384}huffmanTallyDist(dist,len){this.arrDistances[this.bufferPosition]=dist,this.arrLiterals[this.bufferPosition++]=len-3;let lc=this.huffmanLengthCode(len-3);this.treeLiteral.codeFrequencies[lc]++,lc>=265&&lc<285&&(this.extraBits+=Math.floor((lc-261)/4));let dc=this.huffmanDistanceCode(dist-1);return this.treeDistances.codeFrequencies[dc]++,dc>=4&&(this.extraBits+=Math.floor(dc/2-1)),this.bufferPosition>=16384}huffmanFlushBlock(stored,storedOffset,storedLength,lastBlock){this.treeLiteral.codeFrequencies[256]++,this.treeLiteral.buildTree(),this.treeDistances.buildTree(),this.treeLiteral.calculateBLFreq(this.treeCodeLengths),this.treeDistances.calculateBLFreq(this.treeCodeLengths),this.treeCodeLengths.buildTree();let blTreeCodes=4;for(let i=18;i>blTreeCodes;i--)this.treeCodeLengths.codeLengths[CompressorHuffmanTree.huffCodeLengthOrders[i]]>0&&(blTreeCodes=i+1);let opt_len=14+3*blTreeCodes+this.treeCodeLengths.getEncodedLength()+this.treeLiteral.getEncodedLength()+this.treeDistances.getEncodedLength()+this.extraBits,static_len=this.extraBits;for(let i=0;i<286;i++)static_len+=this.treeLiteral.codeFrequencies[i]*ARR_LITERAL_LENGTHS[i];for(let i=0;i<30;i++)static_len+=this.treeDistances.codeFrequencies[i]*ARR_DISTANCE_LENGTHS[i];opt_len>=static_len&&(opt_len=static_len),storedOffset>=0&&storedLength+4<opt_len>>3?this.huffmanFlushStoredBlock(stored,storedOffset,storedLength,lastBlock):opt_len==static_len?(this.pendingBufferWriteBits(2+(lastBlock?1:0),3),this.treeLiteral.setStaticCodes(ARR_LITERAL_CODES,ARR_LITERAL_LENGTHS),this.treeDistances.setStaticCodes(ARR_DISTANCE_CODES,ARR_DISTANCE_LENGTHS),this.huffmanCompressBlock(),this.huffmanReset()):(this.pendingBufferWriteBits(4+(lastBlock?1:0),3),this.huffmanSendAllTrees(blTreeCodes),this.huffmanCompressBlock(),this.huffmanReset())}huffmanFlushStoredBlock(stored,storedOffset,storedLength,lastBlock){this.pendingBufferWriteBits(0+(lastBlock?1:0),3),this.pendingBufferAlignToByte(),this.pendingBufferWriteShort(storedLength),this.pendingBufferWriteShort(~storedLength),this.pendingBufferWriteByteBlock(stored,storedOffset,storedLength),this.huffmanReset()}huffmanLengthCode(len){if(255===len)return 285;let code=257;for(;len>=8;)code+=4,len>>=1;return code+len}huffmanDistanceCode(distance){let code=0;for(;distance>=4;)code+=2,distance>>=1;return code+distance}huffmanSendAllTrees(blTreeCodes){this.treeCodeLengths.buildCodes(),this.treeLiteral.buildCodes(),this.treeDistances.buildCodes(),this.pendingBufferWriteBits(this.treeLiteral.treeLength-257,5),this.pendingBufferWriteBits(this.treeDistances.treeLength-1,5),this.pendingBufferWriteBits(blTreeCodes-4,4);for(let rank=0;rank<blTreeCodes;rank++)this.pendingBufferWriteBits(this.treeCodeLengths.codeLengths[CompressorHuffmanTree.huffCodeLengthOrders[rank]],3);this.treeLiteral.writeTree(this.treeCodeLengths),this.treeDistances.writeTree(this.treeCodeLengths)}huffmanReset(){this.bufferPosition=0,this.extraBits=0,this.treeLiteral.reset(),this.treeDistances.reset(),this.treeCodeLengths.reset()}huffmanCompressBlock(){for(let i=0;i<this.bufferPosition;i++){let literalLen=255&this.arrLiterals[i],dist=this.arrDistances[i];if(0!=dist--){let lc=this.huffmanLengthCode(literalLen);this.treeLiteral.writeCodeToStream(lc);let bits=Math.floor((lc-261)/4);bits>0&&bits<=5&&this.pendingBufferWriteBits(literalLen&(1<<bits)-1,bits);let dc=this.huffmanDistanceCode(dist);this.treeDistances.writeCodeToStream(dc),(bits=Math.floor(dc/2-1))>0&&this.pendingBufferWriteBits(dist&(1<<bits)-1,bits)}else this.treeLiteral.writeCodeToStream(literalLen)}this.treeLiteral.writeCodeToStream(256)}pendingBufferWriteBits(b,count){let uint=new Uint32Array(1);uint[0]=this.pendingBufCache|b<<this.pendingBufBitsInCache,this.pendingBufCache=uint[0],this.pendingBufBitsInCache+=count,this.pendingBufferFlushBits()}pendingBufferFlush(isClose){if(this.pendingBufferFlushBits(),this.pendingBufLength>0){let array=new Uint8Array(this.pendingBufLength);array.set(this.pendingBuffer.subarray(0,this.pendingBufLength),0),this.stream.push(array)}this.pendingBufLength=0}pendingBufferFlushBits(){let result=0;for(;this.pendingBufBitsInCache>=8&&this.pendingBufLength<65536;)this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache,this.pendingBufCache>>=8,this.pendingBufBitsInCache-=8,result++;return result}pendingBufferWriteByteBlock(data,offset,length){let array=data.subarray(offset,offset+length);this.pendingBuffer.set(array,this.pendingBufLength),this.pendingBufLength+=length}pendingBufferWriteShort(s){this.pendingBuffer[this.pendingBufLength++]=s,this.pendingBuffer[this.pendingBufLength++]=s>>8}pendingBufferAlignToByte(){this.pendingBufBitsInCache>0&&(this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache),this.pendingBufCache=0,this.pendingBufBitsInCache=0}static initHuffmanTree(){let i=0;for(;i<144;)ARR_LITERAL_CODES[i]=CompressorHuffmanTree.bitReverse(48+i<<8),ARR_LITERAL_LENGTHS[i++]=8;for(;i<256;)ARR_LITERAL_CODES[i]=CompressorHuffmanTree.bitReverse(256+i<<7),ARR_LITERAL_LENGTHS[i++]=9;for(;i<280;)ARR_LITERAL_CODES[i]=CompressorHuffmanTree.bitReverse(-256+i<<9),ARR_LITERAL_LENGTHS[i++]=7;for(;i<286;)ARR_LITERAL_CODES[i]=CompressorHuffmanTree.bitReverse(-88+i<<8),ARR_LITERAL_LENGTHS[i++]=8;for(i=0;i<30;i++)ARR_DISTANCE_CODES[i]=CompressorHuffmanTree.bitReverse(i<<11),ARR_DISTANCE_LENGTHS[i]=5}close(){do{this.pendingBufferFlush(!0),this.compressData(!0)||(this.pendingBufferFlush(!0),this.pendingBufferAlignToByte(),this.noWrap||(this.pendingBufferWriteShortBytes(this.checkSum>>16),this.pendingBufferWriteShortBytes(65535&this.checkSum)),this.pendingBufferFlush(!0))}while(this.inputEnd!==this.inputOffset||0!==this.pendingBufLength)}destroy(){this.stream=[],this.stream=void 0,this.pendingBuffer=void 0,this.treeLiteral=void 0,this.treeDistances=void 0,this.treeCodeLengths=void 0,this.arrLiterals=void 0,this.arrDistances=void 0,this.hashHead=void 0,this.hashPrevious=void 0,this.dataWindow=void 0,this.inputBuffer=void 0,this.pendingBufLength=void 0,this.pendingBufCache=void 0,this.pendingBufBitsInCache=void 0,this.bufferPosition=void 0,this.extraBits=void 0,this.currentHash=void 0,this.matchStart=void 0,this.matchLength=void 0,this.matchPrevAvail=void 0,this.blockStart=void 0,this.stringStart=void 0,this.lookAhead=void 0,this.totalBytesIn=void 0,this.inputOffset=void 0,this.inputEnd=void 0,this.windowSize=void 0,this.windowMask=void 0,this.hashSize=void 0,this.hashMask=void 0,this.hashShift=void 0,this.maxDist=void 0,this.checkSum=void 0,this.noWrap=void 0}}return CompressedStreamWriter.isHuffmanTreeInitiated=!1,CompressedStreamWriter})(),CompressorHuffmanTree=(()=>{class CompressorHuffmanTree{constructor(writer,elementCount,minCodes,maxLength){this.writer=writer,this.codeMinCount=minCodes,this.maxLength=maxLength,this.codeFrequency=new Uint16Array(elementCount),this.lengthCount=new Int32Array(maxLength)}get treeLength(){return this.codeCount}get codeLengths(){return this.codeLength}get codeFrequencies(){return this.codeFrequency}setStaticCodes(codes,lengths){let temp=new Int16Array(codes.length);temp.set(codes,0),this.codes=temp;let lengthTemp=new Uint8Array(lengths.length);lengthTemp.set(lengths,0),this.codeLength=lengthTemp}reset(){for(let i=0;i<this.codeFrequency.length;i++)this.codeFrequency[i]=0;this.codes=void 0,this.codeLength=void 0}writeCodeToStream(code){this.writer.pendingBufferWriteBits(65535&this.codes[code],this.codeLength[code])}buildCodes(){let nextCode=new Int32Array(this.maxLength);this.codes=new Int16Array(this.codeCount);let code=0;for(let bitsCount=0;bitsCount<this.maxLength;bitsCount++)nextCode[bitsCount]=code,code+=this.lengthCount[bitsCount]<<15-bitsCount;for(let i=0;i<this.codeCount;i++){let bits=this.codeLength[i];bits>0&&(this.codes[i]=CompressorHuffmanTree.bitReverse(nextCode[bits-1]),nextCode[bits-1]+=1<<16-bits)}}static bitReverse(value){return CompressorHuffmanTree.reverseBits[15&value]<<12|CompressorHuffmanTree.reverseBits[value>>4&15]<<8|CompressorHuffmanTree.reverseBits[value>>8&15]<<4|CompressorHuffmanTree.reverseBits[value>>12]}getEncodedLength(){let len=0;for(let i=0;i<this.codeFrequency.length;i++)len+=this.codeFrequency[i]*this.codeLength[i];return len}calculateBLFreq(blTree){let maxCount,minCount,count,curLen=-1,i=0;for(;i<this.codeCount;){count=1;let nextLen=this.codeLength[i];for(0===nextLen?(maxCount=138,minCount=3):(maxCount=6,minCount=3,curLen!==nextLen&&(blTree.codeFrequency[nextLen]++,count=0)),curLen=nextLen,i++;i<this.codeCount&&curLen===this.codeLength[i]&&(i++,!(++count>=maxCount)););count<minCount?blTree.codeFrequency[curLen]+=count:0!==curLen?blTree.codeFrequency[16]++:count<=10?blTree.codeFrequency[17]++:blTree.codeFrequency[18]++}}writeTree(blTree){let maxRepeatCount,minRepeatCount,currentRepeatCount,currentCodeLength=-1,i=0;for(;i<this.codeCount;){currentRepeatCount=1;let nextLen=this.codeLength[i];for(0===nextLen?(maxRepeatCount=138,minRepeatCount=3):(maxRepeatCount=6,minRepeatCount=3,currentCodeLength!==nextLen&&(blTree.writeCodeToStream(nextLen),currentRepeatCount=0)),currentCodeLength=nextLen,i++;i<this.codeCount&&currentCodeLength===this.codeLength[i]&&(i++,!(++currentRepeatCount>=maxRepeatCount)););if(currentRepeatCount<minRepeatCount)for(;currentRepeatCount-- >0;)blTree.writeCodeToStream(currentCodeLength);else 0!==currentCodeLength?(blTree.writeCodeToStream(16),this.writer.pendingBufferWriteBits(currentRepeatCount-3,2)):currentRepeatCount<=10?(blTree.writeCodeToStream(17),this.writer.pendingBufferWriteBits(currentRepeatCount-3,3)):(blTree.writeCodeToStream(18),this.writer.pendingBufferWriteBits(currentRepeatCount-11,7))}}buildTree(){let codesCount=this.codeFrequency.length,arrTree=new Int32Array(codesCount),treeLength=0,maxCount=0;for(let n=0;n<codesCount;n++){let freq=this.codeFrequency[n];if(0!==freq){let pos=treeLength++,pPos=0;for(;pos>0&&this.codeFrequency[arrTree[pPos=Math.floor((pos-1)/2)]]>freq;)arrTree[pos]=arrTree[pPos],pos=pPos;arrTree[pos]=n,maxCount=n}}for(;treeLength<2;)arrTree[treeLength++]=maxCount<2?++maxCount:0;this.codeCount=Math.max(maxCount+1,this.codeMinCount);let nodesCount=treeLength,child=new Int32Array(4*treeLength-2),values=new Int32Array(2*treeLength-1);for(let i=0;i<treeLength;i++){let node=arrTree[i],iIndex=2*i;child[iIndex]=node,child[iIndex+1]=-1,values[i]=this.codeFrequency[node]<<8,arrTree[i]=i}this.constructHuffmanTree(arrTree,treeLength,values,nodesCount,child),this.buildLength(child)}constructHuffmanTree(arrTree,treeLength,values,nodesCount,child){do{let first=arrTree[0],last=arrTree[--treeLength],lastVal=values[last],pPos=0,path=1;for(;path<treeLength;)path+1<treeLength&&values[arrTree[path]]>values[arrTree[path+1]]&&path++,arrTree[pPos]=arrTree[path],path=2*(pPos=path)+1;for(;(path=pPos)>0&&values[arrTree[pPos=Math.floor((path-1)/2)]]>lastVal;)arrTree[path]=arrTree[pPos];arrTree[path]=last;let second=arrTree[0];child[2*(last=nodesCount++)]=first,child[2*last+1]=second;let minDepth=Math.min(255&values[first],255&values[second]);for(values[last]=lastVal=values[first]+values[second]-minDepth+1,pPos=0,path=1;path<treeLength;)path+1<treeLength&&values[arrTree[path]]>values[arrTree[path+1]]&&path++,arrTree[pPos]=arrTree[path],path=2*(pPos=path)+1;for(;(path=pPos)>0&&values[arrTree[pPos=Math.floor((path-1)/2)]]>lastVal;)arrTree[path]=arrTree[pPos];arrTree[path]=last}while(treeLength>1)}buildLength(child){this.codeLength=new Uint8Array(this.codeFrequency.length);let numNodes=Math.floor(child.length/2),numLeafs=Math.floor((numNodes+1)/2),overflow=0;for(let i=0;i<this.maxLength;i++)this.lengthCount[i]=0;if(0===(overflow=this.calculateOptimalCodeLength(child,overflow,numNodes)))return;let iIncreasableLength=this.maxLength-1;do{for(;0===this.lengthCount[--iIncreasableLength];);do{this.lengthCount[iIncreasableLength]--,this.lengthCount[++iIncreasableLength]++,overflow-=1<<this.maxLength-1-iIncreasableLength}while(overflow>0&&iIncreasableLength<this.maxLength-1)}while(overflow>0);this.recreateTree(child,overflow,numLeafs)}recreateTree(child,overflow,numLeafs){this.lengthCount[this.maxLength-1]+=overflow,this.lengthCount[this.maxLength-2]-=overflow;let nodePtr=2*numLeafs;for(let bits=this.maxLength;0!==bits;bits--){let n=this.lengthCount[bits-1];for(;n>0;){let childPtr=2*child[nodePtr++];-1===child[childPtr+1]&&(this.codeLength[child[childPtr]]=bits,n--)}}}calculateOptimalCodeLength(child,overflow,numNodes){let lengths=new Int32Array(numNodes);lengths[numNodes-1]=0;for(let i=numNodes-1;i>=0;i--){let childIndex=2*i+1;if(-1!==child[childIndex]){let bitLength=lengths[i]+1;bitLength>this.maxLength&&(bitLength=this.maxLength,overflow++),lengths[child[childIndex-1]]=lengths[child[childIndex]]=bitLength}else this.lengthCount[lengths[i]-1]++,this.codeLength[child[childIndex-1]]=lengths[i]}return overflow}}return CompressorHuffmanTree.reverseBits=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15],CompressorHuffmanTree.huffCodeLengthOrders=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],CompressorHuffmanTree})(),ChecksumCalculator=(()=>{class ChecksumCalculator{static checksumUpdate(checksum,buffer,offset,length){let uint=new Uint32Array(1);uint[0]=checksum;let checksum_uint=uint[0],s1=uint[0]=65535&checksum_uint,s2=uint[0]=checksum_uint>>ChecksumCalculator.checkSumBitOffset;for(;length>0;){let steps=Math.min(length,ChecksumCalculator.checksumIterationCount);for(length-=steps;--steps>=0;)s2+=s1+=uint[0]=255&buffer[offset++];s1%=ChecksumCalculator.checksumBase,s2%=ChecksumCalculator.checksumBase}return s2<<ChecksumCalculator.checkSumBitOffset|s1}}return ChecksumCalculator.checkSumBitOffset=16,ChecksumCalculator.checksumBase=65521,ChecksumCalculator.checksumIterationCount=3800,ChecksumCalculator})();const CRC32TABLE=[];class ej2_compression_es2015_ZipArchive{get compressionLevel(){return this.level}set compressionLevel(level){this.level=level}get length(){return void 0===this.files?0:this.files.length}constructor(){0===CRC32TABLE.length&&ej2_compression_es2015_ZipArchive.initCrc32Table(),this.files=[],this.level="Normal",Save.isMicrosoftBrowser=!!navigator.msSaveBlob}addItem(item){if(null==item)throw new Error("ArgumentException: item cannot be null or undefined");for(let i=0;i<this.files.length;i++){let file=this.files[i];if(file instanceof ZipArchiveItem&&file.name===item.name)throw new Error("item with same name already exist")}this.files.push(item)}addDirectory(directoryName){if(null==directoryName)throw new Error("ArgumentException: string cannot be null or undefined");if(0===directoryName.length)throw new Error("ArgumentException: string cannot be empty");if("/"!==directoryName.slice(-1)&&(directoryName+="/"),-1!==this.files.indexOf(directoryName))throw new Error("item with same name already exist");this.files.push(directoryName)}getItem(index){if(index>=0&&index<this.files.length)return this.files[index]}contains(item){return-1!==this.files.indexOf(item)}save(fileName){if(null==fileName||0===fileName.length)throw new Error("ArgumentException: fileName cannot be null or undefined");if(0===this.files.length)throw new Error("InvalidOperation");let zipArchive=this;return new Promise((resolve,reject)=>{zipArchive.saveInternal(fileName,!1).then(()=>{resolve(zipArchive)})})}saveAsBlob(){let zipArchive=this;return new Promise((resolve,reject)=>{zipArchive.saveInternal("",!0).then(blob=>{resolve(blob)})})}saveInternal(fileName,skipFileSave){let zipArchive=this;return new Promise((resolve,reject)=>{let zipData=[],dirLength=0;for(let i=0;i<zipArchive.files.length;i++)this.getCompressedData(this.files[i]).then(data=>{if(dirLength=zipArchive.constructZippedObject(zipData,data,dirLength,data.isDirectory),zipData.length===zipArchive.files.length){let blob=zipArchive.writeZippedContent(fileName,zipData,dirLength,skipFileSave);resolve(blob)}})})}destroy(){if(void 0!==this.files&&this.files.length>0){for(let i=0;i<this.files.length;i++){let file=this.files[i];file instanceof ZipArchiveItem&&file.destroy(),file=void 0}this.files=[]}this.files=void 0,this.level=void 0}getCompressedData(item){let zipArchive=this;return new Promise((resolve,reject)=>{if(item instanceof ZipArchiveItem){let reader=new FileReader;reader.onload=()=>{let input=new Uint8Array(reader.result),data={fileName:item.name,crc32Value:0,compressedData:[],compressedSize:void 0,uncompressedDataSize:input.length,compressionType:void 0,isDirectory:!1};if("Normal"===zipArchive.level){zipArchive.compressData(input,data,CRC32TABLE);let length=0;for(let i=0;i<data.compressedData.length;i++)length+=data.compressedData[i].length;data.compressedSize=length,data.compressionType="\b\0"}else data.compressedSize=input.length,data.crc32Value=zipArchive.calculateCrc32Value(0,input,CRC32TABLE),data.compressionType="\0\0",data.compressedData.push(input);resolve(data)},reader.readAsArrayBuffer(item.data)}else resolve({fileName:item,crc32Value:0,compressedData:"",compressedSize:0,uncompressedDataSize:0,compressionType:"\0\0",isDirectory:!0})})}compressData(input,data,crc32Table){let compressor=new ej2_compression_es2015_CompressedStreamWriter(!0),currentIndex=0,nextIndex=0;do{if(currentIndex>=input.length){compressor.close();break}nextIndex=Math.min(input.length,currentIndex+16384);let subArray=input.subarray(currentIndex,nextIndex);data.crc32Value=this.calculateCrc32Value(data.crc32Value,subArray,crc32Table),compressor.write(subArray,0,nextIndex-currentIndex),currentIndex=nextIndex}while(currentIndex<=input.length);data.compressedData=compressor.compressedData,compressor.destroy()}constructZippedObject(zipParts,data,dirLength,isDirectory){let extFileAttr=0,date=new Date;isDirectory&&(extFileAttr|=16),extFileAttr|=0;let header=this.writeHeader(data,date),localHeader="PK"+header+data.fileName,centralDir=this.writeCentralDirectory(data,header,dirLength,extFileAttr);return zipParts.push({localHeader:localHeader,centralDir:centralDir,compressedData:data}),dirLength+localHeader.length+data.compressedSize}writeHeader(data,date){let zipHeader="";return zipHeader+="\n\0\0\0",zipHeader+=data.compressionType,zipHeader+=this.getBytes(this.getModifiedTime(date),2),zipHeader+=this.getBytes(this.getModifiedDate(date),2),zipHeader+=this.getBytes(data.crc32Value,4),zipHeader+=this.getBytes(data.compressedSize,4),zipHeader+=this.getBytes(data.uncompressedDataSize,4),(zipHeader+=this.getBytes(data.fileName.length,2))+this.getBytes(0,2)}writeZippedContent(fileName,zipData,localDirLen,skipFileSave){let cenDirLen=0,buffer=[];for(let i=0;i<zipData.length;i++){let item=zipData[i];for(cenDirLen+=item.centralDir.length,buffer.push(this.getArrayBuffer(item.localHeader));item.compressedData.compressedData.length;)buffer.push(item.compressedData.compressedData.shift().buffer)}for(let i=0;i<zipData.length;i++)buffer.push(this.getArrayBuffer(zipData[i].centralDir));buffer.push(this.getArrayBuffer(this.writeFooter(zipData,cenDirLen,localDirLen)));let blob=new Blob(buffer,{type:"application/zip"});return skipFileSave||Save.save(fileName,blob),blob}writeCentralDirectory(data,localHeader,offset,externalFileAttribute){return"PK"+this.getBytes(20,2)+localHeader+this.getBytes(0,2)+"\0\0\0\0"+this.getBytes(externalFileAttribute,4)+this.getBytes(offset,4)+data.fileName}writeFooter(zipData,centralLength,localLength){return"PK\0\0\0\0"+this.getBytes(zipData.length,2)+this.getBytes(zipData.length,2)+this.getBytes(centralLength,4)+this.getBytes(localLength,4)+this.getBytes(0,2)}getArrayBuffer(input){let a=new Uint8Array(input.length);for(let j=0;j<input.length;++j)a[j]=255&input.charCodeAt(j);return a.buffer}getBytes(value,offset){let bytes="";for(let i=0;i<offset;i++)bytes+=String.fromCharCode(255&value),value>>>=8;return bytes}getModifiedTime(date){let modTime=date.getHours();return modTime<<=6,modTime|=date.getMinutes(),(modTime<<=5)|date.getSeconds()/2}getModifiedDate(date){let modiDate=date.getFullYear()-1980;return modiDate<<=4,modiDate|=date.getMonth()+1,(modiDate<<=5)|date.getDate()}calculateCrc32Value(crc32Value,input,crc32Table){crc32Value^=-1;for(let i=0;i<input.length;i++)crc32Value=crc32Value>>>8^crc32Table[255&(crc32Value^input[i])];return-1^crc32Value}static initCrc32Table(){let i;for(let j=0;j<256;j++){i=j;for(let k=0;k<8;k++)i=1&i?3988292384^i>>>1:i>>>1;CRC32TABLE[j]=i}}}class ZipArchiveItem{get name(){return this.fileName}set name(value){this.fileName=value}constructor(data,itemName){if(null==data)throw new Error("ArgumentException: data cannot be null or undefined");if(null==itemName)throw new Error("ArgumentException: string cannot be null or undefined");if(0===itemName.length)throw new Error("string cannot be empty");this.data=data,this.name=itemName}destroy(){this.fileName=void 0,this.data=void 0}}class CellStyle{constructor(){this.numFmtId=0,this.backColor="none",this.fontName="Calibri",this.fontSize=14,this.fontColor="#000000",this.italic=!1,this.bold=!1,this.underline=!1,this.wrapText=!1,this.hAlign="general",this.vAlign="bottom",this.indent=0,this.rotation=0,this.numberFormat="GENERAL",this.type="datetime",this.borders=new Borders,this.isGlobalStyle=!1}}class Font{constructor(){this.sz=14,this.name="Calibri",this.u=!1,this.b=!1,this.i=!1,this.color="FF000000"}}class CellXfs{}class Alignment{}class CellStyleXfs{}class CellStyles{constructor(){this.name="Normal",this.xfId=0}}class NumFmt{constructor(id,code){this.numFmtId=id,this.formatCode=code}}class Border{constructor(mLine,mColor){this.lineStyle=mLine,this.color=mColor}}class Borders{constructor(){this.left=new Border("none","#FFFFFF"),this.right=new Border("none","#FFFFFF"),this.top=new Border("none","#FFFFFF"),this.bottom=new Border("none","#FFFFFF"),this.all=new Border("none","#FFFFFF")}}class ej2_excel_export_es2015_Cell{}class Cells extends Array{constructor(){super(...arguments),this.add=cell=>{let inserted=!1,count=0;for(let c of this)c.index===cell.index&&(this[count]=cell,inserted=!0),count++;inserted||this.push(cell)}}}class ej2_excel_export_es2015_Column{}class ej2_excel_export_es2015_Row{}class Rows extends Array{constructor(){super(...arguments),this.add=row=>{let inserted=!1,count=0;for(let r of this)r.index===row.index&&(this[count]=row,inserted=!0),count++;inserted||this.push(row)}}}class Worksheets extends Array{}class Worksheet{constructor(){this.isSummaryRowBelow=!0,this.showGridLines=!0}}class HyperLink{}class Grouping{}class FreezePane{}class MergeCell{}class MergeCells extends Array{constructor(){super(...arguments),this.add=mergeCell=>{let inserted=!1,count=0;for(let mCell of this){if(MergeCells.isIntersecting(mCell,mergeCell)){let intersectingCell=new MergeCell;intersectingCell.x=Math.min(mCell.x,mergeCell.x),intersectingCell.y=Math.min(mCell.Y,mergeCell.y),intersectingCell.width=Math.max(mCell.Width+mCell.X,mergeCell.width+mergeCell.x),intersectingCell.height=Math.max(mCell.Height+mCell.Y,mergeCell.height+mergeCell.y),intersectingCell.ref=this[count].ref.split(":")[0]+":"+mergeCell.ref.split(":")[1],this[count]=intersectingCell,mergeCell=intersectingCell,inserted=!0}count++}return inserted||this.push(mergeCell),mergeCell}}static isIntersecting(base,compare){return base.x<=compare.x+compare.width&&compare.x<=base.x+base.width&&base.y<=compare.y+compare.height&&compare.y<=base.y+base.height}}class ej2_excel_export_es2015_ValueFormatter{constructor(cultureName){this.intl=new Internationalization}getFormatFunction(format){return format.type?this.intl.getDateFormat(format):this.intl.getNumberFormat(format)}toView(value,format){let result=value;return isNullOrUndefined(format)||isNullOrUndefined(value)||(result=format(value)),result}displayText(value,format){return this.toView(value,this.getFormatFunction(format))}}class CsvHelper{constructor(json){if(this.csvStr="",this.formatter=new ej2_excel_export_es2015_ValueFormatter,this.isMicrosoftBrowser=!!navigator.msSaveBlob,null!=json.styles){this.globalStyles=new Map;for(let i=0;i<json.styles.length;i++)void 0!==json.styles[i].name&&void 0!==json.styles[i].numberFormat&&this.globalStyles.set(json.styles[i].name,json.styles[i].numberFormat)}null!=json.worksheets&&this.parseWorksheet(json.worksheets[0])}parseWorksheet(json){null!=json.rows&&this.parseRows(json.rows)}parseRows(rows){let count=1;for(let row of rows){if(null==row.index)throw Error("Row index is missing.");for(;count<row.index;)this.csvStr+="\n",count++;this.parseRow(row)}}parseRow(row){if(null!=row.cells){let count=1;for(let cell of row.cells){if(null==cell.index)throw Error("Cell index is missing.");for(;count<cell.index;)this.csvStr+=",",count++;this.parseCell(cell)}}}parseCell(cell){let csv=this.csvStr;if(void 0!==cell.value)if(cell.value instanceof Date)if(void 0!==cell.style&&void 0!==cell.style.numberFormat)try{csv+=this.parseCellValue(this.formatter.displayText(cell.value,{type:"dateTime",skeleton:cell.style.numberFormat}))}catch(error){csv+=this.parseCellValue(this.formatter.displayText(cell.value,{type:"dateTime",format:cell.style.numberFormat}))}else if(void 0!==cell.style&&void 0!==cell.style.name&&this.globalStyles.has(cell.style.name))try{csv+=this.parseCellValue(this.formatter.displayText(cell.value,{type:"dateTime",skeleton:this.globalStyles.get(cell.style.name)}))}catch(error){csv+=this.parseCellValue(this.formatter.displayText(cell.value,{type:"dateTime",format:this.globalStyles.get(cell.style.name)}))}else csv+=cell.value;else"boolean"==typeof cell.value?csv+=cell.value?"TRUE":"FALSE":"number"==typeof cell.value?void 0!==cell.style&&void 0!==cell.style.numberFormat?csv+=this.parseCellValue(this.formatter.displayText(cell.value,{format:cell.style.numberFormat})):void 0!==cell.style&&void 0!==cell.style.name&&this.globalStyles.has(cell.style.name)?csv+=this.parseCellValue(this.formatter.displayText(cell.value,{format:this.globalStyles.get(cell.style.name)})):csv+=cell.value:csv+=this.parseCellValue(cell.value);this.csvStr=csv}parseCellValue(value){let val="",length=value.length;for(let start=0;start<length;start++)val+='"'===value[start]?value[start].replace('"','""'):value[start];return-1!==(value=val).indexOf(",")||-1!==value.indexOf("\n")?'"'+value+'"':value}save(fileName){if(this.buffer=new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"}),this.isMicrosoftBrowser)navigator.msSaveBlob(this.buffer,fileName);else{let dataUrl=window.URL.createObjectURL(this.buffer),dwlLink=document.createElementNS("http://www.w3.org/1999/xhtml","a");dwlLink.download=fileName,dwlLink.href=dataUrl;let event=document.createEvent("MouseEvent");event.initEvent("click",!0,!0),dwlLink.dispatchEvent(event),setTimeout(()=>{window.URL.revokeObjectURL(dataUrl)})}}saveAsBlob(){return new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"})}}class BlobHelper{constructor(){this.parts=[]}append(part){this.parts.push(part),this.blob=void 0}getBlob(){return new Blob(this.parts,{type:"text/plain"})}}class ej2_excel_export_es2015_Workbook{constructor(json,saveType,culture,currencyString){if(this.sharedStringCount=0,this.unitsProportions=[1.28,.32,96,96/25.4,96/2.54,1,96/72,96/72/12700],this.hyperlinkStyle={fontColor:"#0000FF",underline:!0},this.culture=void 0!==culture?culture:"en-US",this.currency=void 0!==currencyString?currencyString:"USD",this.intl=new Internationalization(this.culture),this.mSaveType=saveType,"xlsx"===saveType){if(this.mArchive=new ej2_compression_es2015_ZipArchive,this.sharedString=[],this.mFonts=[],this.mBorders=[],this.mStyles=[],this.printTitles=new Map,this.cellStyles=new Map,this.mNumFmt=new Map,this.mFills=new Map,this.mStyles.push(new CellStyle),this.mFonts.push(new Font),this.cellStyles.set("Normal",new CellStyles),this.mCellXfs=[],this.mCellStyleXfs=[],null!=json.styles){this.globalStyles=new Map;for(let i=0;i<json.styles.length;i++)if(void 0!==json.styles[i].name){if(this.cellStyles.has(json.styles[i].name))throw Error("Style name "+json.styles[i].name+" is already existed");{let cellStyle=new CellStyle;cellStyle.isGlobalStyle=!0,this.parserCellStyle(json.styles[i],cellStyle,"none");let cellStylesIn=new CellStyles;cellStylesIn.name=cellStyle.name,cellStylesIn.xfId=cellStyle.index-1,this.cellStyles.set(cellStylesIn.name,cellStylesIn);let tFormat={};void 0!==json.styles[i].numberFormat&&(tFormat.format=json.styles[i].numberFormat),tFormat.type=void 0!==json.styles[i].type?json.styles[i].type:"datetime",void 0!==tFormat.format&&this.globalStyles.set(json.styles[i].name,tFormat)}}}if(null==json.worksheets)throw Error("Worksheet is expected.");this.parserWorksheets(json.worksheets),null!=json.builtInProperties&&(this.builtInProperties=new BuiltInProperties,this.parserBuiltInProperties(json.builtInProperties,this.builtInProperties))}else this.csvHelper=new CsvHelper(json)}parserBuiltInProperties(jsonBuiltInProperties,builtInProperties){null!=jsonBuiltInProperties.author&&(builtInProperties.author=jsonBuiltInProperties.author),null!=jsonBuiltInProperties.comments&&(builtInProperties.comments=jsonBuiltInProperties.comments),null!=jsonBuiltInProperties.category&&(builtInProperties.category=jsonBuiltInProperties.category),null!=jsonBuiltInProperties.company&&(builtInProperties.company=jsonBuiltInProperties.company),null!=jsonBuiltInProperties.manager&&(builtInProperties.manager=jsonBuiltInProperties.manager),null!=jsonBuiltInProperties.subject&&(builtInProperties.subject=jsonBuiltInProperties.subject),null!=jsonBuiltInProperties.title&&(builtInProperties.title=jsonBuiltInProperties.title),null!=jsonBuiltInProperties.createdDate&&(builtInProperties.createdDate=jsonBuiltInProperties.createdDate),null!=jsonBuiltInProperties.modifiedDate&&(builtInProperties.modifiedDate=jsonBuiltInProperties.modifiedDate),null!=jsonBuiltInProperties.tags&&(builtInProperties.tags=jsonBuiltInProperties.tags),null!=jsonBuiltInProperties.status&&(builtInProperties.status=jsonBuiltInProperties.status)}parserWorksheets(json){this.worksheets=new Worksheets;let length=json.length;for(let i=0;i<length;i++){let jsonSheet=json[i],sheet=new Worksheet;this.mergeCells=new MergeCells,this.mergedCellsStyle=new Map,this.mHyperLinks=[],sheet.name=null!=jsonSheet.name?jsonSheet.name:"Sheet"+(i+1).toString(),sheet.index=i+1,null!=jsonSheet.columns&&this.parserColumns(jsonSheet.columns,sheet),null!=jsonSheet.rows&&this.parserRows(jsonSheet.rows,sheet),null!=jsonSheet.showGridLines&&(sheet.showGridLines=jsonSheet.showGridLines),null!=jsonSheet.freeze&&this.parserFreezePanes(jsonSheet.freeze,sheet),null!=jsonSheet.printTitle&&this.parserPrintTitle(jsonSheet.printTitle,sheet),void 0!==jsonSheet.pageSetup&&void 0!==jsonSheet.pageSetup.isSummaryRowBelow&&(sheet.isSummaryRowBelow=jsonSheet.pageSetup.isSummaryRowBelow),sheet.index=i+1,sheet.mergeCells=this.mergeCells,sheet.hyperLinks=this.mHyperLinks,this.worksheets.push(sheet)}}mergeOptions(fromJson,toJson){let result={};return this.applyProperties(fromJson,result),this.applyProperties(toJson,result),result}applyProperties(sourceJson,destJson){let keys=Object.keys(sourceJson);for(let index=0;index<keys.length;index++)"name"!==keys[index]&&(destJson[keys[index]]=sourceJson[keys[index]])}getCellName(row,column){return this.getColumnName(column)+row.toString()}getColumnName(col){col--;let strColumnName="";do{let iCurrentDigit=col%26;col=col/26-1,strColumnName=String.fromCharCode(65+iCurrentDigit)+strColumnName}while(col>=0);return strColumnName}parserPrintTitle(json,sheet){let titleRowName,titleColName,printTitleName="";if(null!=json.fromRow){let toRow;titleRowName="$"+json.fromRow+":$"+(toRow=null!=json.toRow?json.toRow:json.fromRow)}if(null!=json.fromColumn){let toColumn;toColumn=null!=json.toColumn?json.toColumn:json.fromColumn,titleColName="$"+this.getColumnName(json.fromColumn)+":$"+this.getColumnName(toColumn)}void 0!==titleRowName&&(printTitleName+=sheet.name+"!"+titleRowName),void 0!==titleColName&&void 0!==titleRowName?printTitleName+=","+sheet.name+"!"+titleColName:void 0!==titleColName&&(printTitleName+=sheet.name+"!"+titleColName),""!==printTitleName&&this.printTitles.set(sheet.index-1,printTitleName)}parserFreezePanes(json,sheet){sheet.freezePanes=new FreezePane,sheet.freezePanes.row=null!=json.row?json.row:0,sheet.freezePanes.column=null!=json.column?json.column:0,sheet.freezePanes.leftCell=this.getCellName(sheet.freezePanes.row+1,sheet.freezePanes.column+1)}parserColumns(json,sheet){let columnsLength=json.length;sheet.columns=[];for(let column=0;column<columnsLength;column++){let col=new ej2_excel_export_es2015_Column;if(null==json[column].index)throw Error("Column index is missing.");col.index=json[column].index,null!=json[column].width&&(col.width=json[column].width),sheet.columns.push(col)}}parserRows(json,sheet){let rowsLength=json.length;sheet.rows=new Rows;let rowId=0;for(let r=0;r<rowsLength;r++){let row=this.parserRow(json[r],rowId);rowId=row.index,sheet.rows.add(row)}this.insertMergedCellsStyle(sheet)}insertMergedCellsStyle(sheet){this.mergeCells.length>0&&this.mergedCellsStyle.forEach((value,key)=>{let row=sheet.rows.filter(item=>item.index===value.y)[0];if(isNullOrUndefined(row)){let rows=sheet.rows.filter(item=>item.index<=value.y),rowToInsert=new ej2_excel_export_es2015_Row;rowToInsert.index=value.y,rowToInsert.cells=new Cells,rowToInsert.cells.add(this.createCell(value,key));let insertIndex=0;rows.length>0&&(insertIndex=sheet.rows.indexOf(rows[rows.length-1])+1),sheet.rows.splice(insertIndex,0,rowToInsert)}else{let cell=row.cells.filter(item=>item.index===value.x)[0];if(isNullOrUndefined(cell)){let cells=row.cells.filter(item=>item.index<=value.x),insertIndex=0;cells.length>0&&(insertIndex=row.cells.indexOf(cells[cells.length-1])+1),row.cells.splice(insertIndex,0,this.createCell(value,key))}else cell.styleIndex=value.styleIndex}})}createCell(value,key){let cellToInsert=new ej2_excel_export_es2015_Cell;return cellToInsert.refName=key,cellToInsert.index=value.x,cellToInsert.cellStyle=new CellStyle,cellToInsert.styleIndex=value.styleIndex,cellToInsert}parserRow(json,rowIndex){let row=new ej2_excel_export_es2015_Row;if(null!=json.height&&(row.height=json.height),null==json.index)throw Error("Row index is missing.");return row.index=json.index,null!=json.grouping&&this.parseGrouping(json.grouping,row),this.parseCells(json.cells,row),row}parseGrouping(json,row){row.grouping=new Grouping,void 0!==json.outlineLevel&&(row.grouping.outlineLevel=json.outlineLevel),void 0!==json.isCollapsed&&(row.grouping.isCollapsed=json.isCollapsed),void 0!==json.isHidden&&(row.grouping.isHidden=json.isHidden)}parseCells(json,row){row.cells=new Cells;let cellsLength=void 0!==json?json.length:0,spanMin=1,spanMax=1;for(let cellId=0;cellId<cellsLength;cellId++){let jsonCell=json[cellId],cell=new ej2_excel_export_es2015_Cell;if(null==jsonCell.index)throw Error("Cell index is missing.");if(cell.index=jsonCell.index,cell.index<spanMin?spanMin=cell.index:cell.index>spanMax&&(spanMax=cell.index),cell.refName=this.getCellName(row.index,cell.index),cell.rowSpan=null!=jsonCell.rowSpan?jsonCell.rowSpan-1:0,cell.colSpan=null!=jsonCell.colSpan?jsonCell.colSpan-1:0,null!=jsonCell.hyperlink){let hyperLink=new HyperLink;void 0!==jsonCell.hyperlink.target&&(hyperLink.target=jsonCell.hyperlink.target,cell.value=void 0!==jsonCell.hyperlink.displayText?jsonCell.hyperlink.displayText:jsonCell.hyperlink.target,cell.type=this.getCellValueType(cell.value),hyperLink.ref=cell.refName,hyperLink.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(hyperLink),cell.cellStyle=new CellStyle,this.parserCellStyle(void 0!==jsonCell.style?this.mergeOptions(jsonCell.style,this.hyperlinkStyle):this.hyperlinkStyle,cell.cellStyle,"string"),cell.styleIndex=cell.cellStyle.index)}null!=jsonCell.formula&&(cell.formula=jsonCell.formula,cell.type="formula"),null!=jsonCell.value&&(void 0!==cell.formula?cell.value=0:(cell.value=jsonCell.value,cell.type=this.getCellValueType(cell.value))),null!=jsonCell.style&&void 0===cell.styleIndex?(cell.cellStyle=new CellStyle,cell.value instanceof Date?this.parserCellStyle(jsonCell.style,cell.cellStyle,cell.type,14):this.parserCellStyle(jsonCell.style,cell.cellStyle,cell.type),cell.styleIndex=cell.cellStyle.index):cell.value instanceof Date&&(cell.cellStyle=new CellStyle,this.parserCellStyle({},cell.cellStyle,cell.type,14),cell.styleIndex=cell.cellStyle.index),this.parseCellType(cell),this.mergeCells=this.processMergeCells(cell,row.index,this.mergeCells),row.cells.add(cell)}row.spans=spanMin+":"+spanMax}GetColors(){let colors;return(colors=new Map).set("WHITE","FFFFFFFF"),colors.set("SILVER","FFC0C0C0"),colors.set("GRAY","FF808080"),colors.set("BLACK","FF000000"),colors.set("RED","FFFF0000"),colors.set("MAROON","FF800000"),colors.set("YELLOW","FFFFFF00"),colors.set("OLIVE","FF808000"),colors.set("LIME","FF00FF00"),colors.set("GREEN","FF008000"),colors.set("AQUA","FF00FFFF"),colors.set("TEAL","FF008080"),colors.set("BLUE","FF0000FF"),colors.set("NAVY","FF000080"),colors.set("FUCHSIA","FFFF00FF"),colors.set("PURPLE","FF800080"),colors}processColor(colorVal){return colorVal.startsWith("#")?colorVal.replace("#","FF"):(colorVal=colorVal.toUpperCase(),this.rgbColors=this.GetColors(),colorVal=this.rgbColors.has(colorVal)?this.rgbColors.get(colorVal):"FF000000")}processCellValue(value,cell){let cellValue=value,processedVal="",startindex=value.indexOf("<",0);if(startindex>=0){0!==startindex&&(processedVal+='<r><t xml:space="preserve">'+value.substring(0,startindex)+"</t></r>");let endIndex=value.indexOf(">",startindex+1);for(;startindex>=0&&endIndex>=0;)if((endIndex=value.indexOf(">",startindex+1))>=0){let subString=value.substring(startindex+1,endIndex);(startindex=value.indexOf("<",endIndex+1))<0&&(startindex=cellValue.length);let text=cellValue.substring(endIndex+1,startindex);if(0!==text.length){let subSplit=subString.split(" ");if(subSplit.length>0&&(processedVal+="<r><rPr>"),subSplit.length>1)for(let element of subSplit)switch(element.trim().substring(0,5)){case"size=":processedVal+='<sz val="'+element.substring(6,element.length-1)+'"/>';break;case"face=":processedVal+='<rFont val="'+element.substring(6,element.length-1)+'"/>';break;case"color":processedVal+='<color rgb="'+this.processColor(element.substring(7,element.length-1))+'"/>';break;case"href=":let hyperLink=new HyperLink;hyperLink.target=element.substring(6,element.length-1).trim(),hyperLink.ref=cell.refName,hyperLink.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(hyperLink),processedVal+='<color rgb="FF0000FF"/><u/><b/>'}else if(1===subSplit.length)switch(subSplit[0].trim()){case"b":processedVal+="<b/>";break;case"i":processedVal+="<i/>";break;case"u":processedVal+="<u/>"}processedVal+='</rPr><t xml:space="preserve">'+text+"</t></r>"}}return""===processedVal?cellValue:processedVal}return cellValue}applyGlobalStyle(json,cellStyle){this.cellStyles.has(json.name)&&(cellStyle.index=this.mStyles.filter(a=>a.name===json.name)[0].index,cellStyle.name=json.name)}parserCellStyle(json,cellStyle,cellType,defStyleIndex){if(null!=json.name){if(!cellStyle.isGlobalStyle)return void this.applyGlobalStyle(json,cellStyle);cellStyle.name=json.name}null!=json.backColor&&(cellStyle.backColor=json.backColor),cellStyle.borders=new Borders,null!=json.borders&&this.parserBorder(json.borders,cellStyle.borders.all),null!=json.leftBorder&&this.parserBorder(json.leftBorder,cellStyle.borders.left),null!=json.rightBorder&&this.parserBorder(json.rightBorder,cellStyle.borders.right),null!=json.topBorder&&this.parserBorder(json.topBorder,cellStyle.borders.top),null!=json.bottomBorder&&this.parserBorder(json.bottomBorder,cellStyle.borders.bottom),null!=json.fontName&&(cellStyle.fontName=json.fontName),null!=json.fontSize&&(cellStyle.fontSize=json.fontSize),null!=json.fontColor&&(cellStyle.fontColor=json.fontColor),null!=json.italic&&(cellStyle.italic=json.italic),null!=json.bold&&(cellStyle.bold=json.bold),null!=json.hAlign&&(cellStyle.hAlign=json.hAlign.toLowerCase()),null!=json.indent&&(cellStyle.indent=json.indent,"left"!==cellStyle.hAlign&&"right"!==cellStyle.hAlign&&(cellStyle.hAlign="left")),null!=json.rotation&&(cellStyle.rotation=json.rotation),null!=json.vAlign&&(cellStyle.vAlign=json.vAlign.toLowerCase()),null!=json.underline&&(cellStyle.underline=json.underline),null!=json.wrapText&&(cellStyle.wrapText=json.wrapText),null!=json.numberFormat?cellStyle.numberFormat=this.getNumberFormat(json.numberFormat,null!=json.type?json.type:cellType):void 0!==defStyleIndex?(cellStyle.numFmtId=14,cellStyle.numberFormat="GENERAL"):cellStyle.numberFormat="GENERAL",cellStyle.index=this.processCellStyle(cellStyle)}switchNumberFormat(numberFormat,type){let format=this.getNumberFormat(numberFormat,type);if(format!==numberFormat){let numFmt=this.mNumFmt.get(numberFormat);if(void 0!==numFmt&&(numFmt.formatCode=format,this.mNumFmt.has(format))){for(let cellStyleXfs of this.mCellStyleXfs)cellStyleXfs.numFmtId===numFmt.numFmtId&&(cellStyleXfs.numFmtId=this.mNumFmt.get(format).numFmtId);for(let cellXfs of this.mCellXfs)cellXfs.numFmtId===numFmt.numFmtId&&(cellXfs.numFmtId=this.mNumFmt.get(format).numFmtId)}}}getNumberFormat(numberFormat,type){let returnFormat;switch(type){case"number":try{returnFormat=this.intl.getNumberPattern({format:numberFormat,currency:this.currency})}catch(error){returnFormat=numberFormat}break;case"datetime":try{returnFormat=this.intl.getDatePattern({skeleton:numberFormat,type:"dateTime"},!0)}catch(error){try{returnFormat=this.intl.getDatePattern({format:numberFormat,type:"dateTime"},!0)}catch(error){returnFormat=numberFormat}}break;case"date":try{returnFormat=this.intl.getDatePattern({skeleton:numberFormat,type:"date"},!0)}catch(error){try{returnFormat=this.intl.getDatePattern({format:numberFormat,type:"date"},!0)}catch(error){returnFormat=numberFormat}}break;case"time":try{returnFormat=this.intl.getDatePattern({skeleton:numberFormat,type:"time"},!0)}catch(error){try{returnFormat=this.intl.getDatePattern({format:numberFormat,type:"time"},!0)}catch(error){returnFormat=numberFormat}}break;default:returnFormat=numberFormat}return returnFormat}parserBorder(json,border){border.color=null!=json.color?json.color:"#000000",border.lineStyle=null!=json.lineStyle?json.lineStyle:"thin"}processCellStyle(style){if(style.isGlobalStyle)return this.processNumFormatId(style),this.mStyles.push(style),this.mStyles.length;{let compareResult=this.compareStyle(style);return compareResult.result?compareResult.index:(this.processNumFormatId(style),this.mStyles.push(style),this.mStyles.length)}}processNumFormatId(style){"GENERAL"===style.numberFormat||this.mNumFmt.has(style.numberFormat)||this.mNumFmt.set(style.numberFormat,new NumFmt(this.mNumFmt.size+164,style.numberFormat))}isNewFont(toCompareStyle){let result=!1,index=0;for(let font of this.mFonts){index++;let fontColor=void 0;if(void 0!==toCompareStyle.fontColor&&(fontColor="FF"+toCompareStyle.fontColor.replace("#","")),result=font.color===fontColor&&font.b===toCompareStyle.bold&&font.i===toCompareStyle.italic&&font.u===toCompareStyle.underline&&font.name===toCompareStyle.fontName&&font.sz===toCompareStyle.fontSize)break}return{index:index-=1,result:result}}isNewBorder(toCompareStyle){let bStyle=new CellStyle;return this.isAllBorder(toCompareStyle.borders)?bStyle.borders.all.color===toCompareStyle.borders.all.color&&bStyle.borders.all.lineStyle===toCompareStyle.borders.all.lineStyle:bStyle.borders.left.color===toCompareStyle.borders.left.color&&bStyle.borders.left.lineStyle===toCompareStyle.borders.left.lineStyle&&bStyle.borders.right.color===toCompareStyle.borders.right.color&&bStyle.borders.right.lineStyle===toCompareStyle.borders.right.lineStyle&&bStyle.borders.top.color===toCompareStyle.borders.top.color&&bStyle.borders.top.lineStyle===toCompareStyle.borders.top.lineStyle&&bStyle.borders.bottom.color===toCompareStyle.borders.bottom.color&&bStyle.borders.bottom.lineStyle===toCompareStyle.borders.bottom.lineStyle}isAllBorder(toCompareBorder){let allBorderStyle=new CellStyle;return allBorderStyle.borders.all.color!==toCompareBorder.all.color&&allBorderStyle.borders.all.lineStyle!==toCompareBorder.all.lineStyle}compareStyle(toCompareStyle){let result=!0,index=0;for(let baseStyle of this.mStyles)if(result=!baseStyle.isGlobalStyle&&baseStyle.backColor===toCompareStyle.backColor&&baseStyle.bold===toCompareStyle.bold&&baseStyle.numFmtId===toCompareStyle.numFmtId&&baseStyle.numberFormat===toCompareStyle.numberFormat&&baseStyle.type===toCompareStyle.type&&baseStyle.fontColor===toCompareStyle.fontColor&&baseStyle.fontName===toCompareStyle.fontName&&baseStyle.fontSize===toCompareStyle.fontSize&&baseStyle.hAlign===toCompareStyle.hAlign&&baseStyle.italic===toCompareStyle.italic&&baseStyle.underline===toCompareStyle.underline&&baseStyle.vAlign===toCompareStyle.vAlign&&baseStyle.indent===toCompareStyle.indent&&baseStyle.rotation===toCompareStyle.rotation&&baseStyle.wrapText===toCompareStyle.wrapText&&baseStyle.borders.all.color===toCompareStyle.borders.all.color&&baseStyle.borders.all.lineStyle===toCompareStyle.borders.all.lineStyle&&baseStyle.borders.left.color===toCompareStyle.borders.left.color&&baseStyle.borders.left.lineStyle===toCompareStyle.borders.left.lineStyle&&baseStyle.borders.right.color===toCompareStyle.borders.right.color&&baseStyle.borders.right.lineStyle===toCompareStyle.borders.right.lineStyle&&baseStyle.borders.top.color===toCompareStyle.borders.top.color&&baseStyle.borders.top.lineStyle===toCompareStyle.borders.top.lineStyle&&baseStyle.borders.bottom.color===toCompareStyle.borders.bottom.color&&baseStyle.borders.bottom.lineStyle===toCompareStyle.borders.bottom.lineStyle){index=baseStyle.index;break}return{index:index,result:result}}contains(array,item){let index=array.indexOf(item);return index>-1&&index<array.length}getCellValueType(value){return value instanceof Date?"datetime":"boolean"==typeof value?"boolean":"number"==typeof value?"number":"string"}parseCellType(cell){let saveType,value=cell.value;switch(cell.type){case"datetime":if(value=this.toOADate(value),void 0!==cell.cellStyle&&void 0!==cell.cellStyle.name&&this.globalStyles.has(cell.cellStyle.name)){let value=this.globalStyles.get(cell.cellStyle.name);this.switchNumberFormat(value.format,value.type)}saveType="n";break;case"boolean":value=value?1:0,saveType="b";break;case"number":saveType="n",void 0!==cell.cellStyle&&void 0!==cell.cellStyle.name&&this.globalStyles.has(cell.cellStyle.name)&&this.switchNumberFormat(this.globalStyles.get(cell.cellStyle.name).format,"number");break;case"string":this.sharedStringCount++,saveType="s";let sstvalue=this.processCellValue(value,cell);this.contains(this.sharedString,sstvalue)||this.sharedString.push(sstvalue),value=this.sharedString.indexOf(sstvalue)}cell.saveType=saveType,cell.value=value}saveAsBlob(blobSaveType){switch(blobSaveType){case"text/csv":return new Promise((resolve,reject)=>{let obj={};obj.blobData=this.csvHelper.saveAsBlob(),resolve(obj)});default:return new Promise((resolve,reject)=>{this.saveInternal(),this.mArchive.saveAsBlob().then(blob=>{let obj={};obj.blobData=new Blob([blob],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),resolve(obj)})})}}save(fileName,proxyUrl){if(null==fileName||""===fileName)throw new Error("Argument Null Exception: fileName cannot be null or empty");let xlsxMatch=fileName.match(".xlsx$"),csvMatch=fileName.match(".csv$");if(null!==xlsxMatch&&xlsxMatch[0]==="."+this.mSaveType)this.saveInternal(),this.mArchive.save(fileName).then(()=>{this.mArchive.destroy()});else{if(null===csvMatch||csvMatch[0]!=="."+this.mSaveType)throw Error("Save type and file extension is different.");this.csvHelper.save(fileName)}}saveInternal(){this.saveWorkbook(),this.saveWorksheets(),this.saveSharedString(),this.saveStyles(),this.saveApp(this.builtInProperties),this.saveCore(this.builtInProperties),this.saveContentType(),this.saveTopLevelRelation(),this.saveWorkbookRelation()}saveWorkbook(){let workbookTemp='<?xml version="1.0" encoding="utf-8"?><workbook xmlns:r = "http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns= "http://schemas.openxmlformats.org/spreadsheetml/2006/main"><workbookPr codeName="ThisWorkbook" defaultThemeVersion= "153222"/><bookViews><workbookView activeTab="0"/></bookViews>',sheets="<sheets>",length=this.worksheets.length;for(let i=0;i<length;i++)sheets+='<sheet name="'+this.worksheets[i].name+'" sheetId="'+(i+1).toString()+'" r:id ="rId'+(i+1).toString()+'" />';if(workbookTemp+=sheets+="</sheets>",this.printTitles.size>0){let printTitle="<definedNames>";this.printTitles.forEach((value,key)=>{printTitle+='<definedName name="_xlnm.Print_Titles" localSheetId="'+key+'">'+value+"</definedName>"}),workbookTemp+=printTitle+="</definedNames>"}this.addToArchive(workbookTemp+"</workbook>","xl/workbook.xml")}saveWorksheets(){let length=this.worksheets.length;for(let i=0;i<length;i++)this.saveWorksheet(this.worksheets[i],i)}saveWorksheet(sheet,index){let sheetBlob=new BlobHelper,sheetString='<?xml version="1.0" encoding="utf-8" standalone="yes"?><worksheet xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';if(sheetString+=sheet.isSummaryRowBelow?"<sheetPr />":'<sheetPr><outlinePr summaryBelow="0" ></outlinePr></sheetPr>',sheetString+=this.saveSheetView(sheet),void 0!==sheet.columns){let colString="<cols>";for(let column of sheet.columns)colString+=void 0!==column.width?'<col min="'+column.index+'" max="'+column.index+'" width="'+this.pixelsToColumnWidth(column.width)+'" customWidth="1" />':'<col min="'+column.index+'" max="'+column.index+'" width="8.43" customWidth="1" />';sheetString+=colString+"</cols>"}if(sheetBlob.append(sheetString+="<sheetData>"),sheetString="",void 0!==sheet.rows)for(let row of sheet.rows){let rowString='<row r="'+row.index+'" ';isNullOrUndefined(row.spans)||(rowString+='spans="'+row.spans+'" '),void 0!==row.height&&(rowString+='ht="'+this.pixelsToRowHeight(row.height)+'" customHeight="1" '),void 0!==row.grouping&&(row.grouping.isHidden&&(rowString+='hidden="1" '),void 0!==row.grouping.outlineLevel&&(rowString+='outlineLevel="'+row.grouping.outlineLevel+'" '),row.grouping.isCollapsed&&(rowString+='collapsed="1" ')),rowString+=">";for(let cell of row.cells)void 0===cell||void 0===cell.value&&void 0===cell.cellStyle||(rowString+='<c r="'+cell.refName+'" ',void 0!==cell.saveType&&(rowString+='t="'+cell.saveType+'" '),void 0!==cell.styleIndex&&(rowString+='s="'+cell.styleIndex+'" '),rowString+=" >",void 0!==cell.formula&&(rowString+="<f>"+cell.formula+"</f>"),rowString+=void 0!==cell.value?"<v>"+cell.value+"</v></c>":"</c>");sheetBlob.append(rowString+="</row>")}if(sheetString+="</sheetData>",sheet.mergeCells.length>0){sheetString+='<mergeCells count="'+sheet.mergeCells.length+'">';for(let mCell of sheet.mergeCells)sheetString+='<mergeCell ref="'+mCell.ref+'" />';sheetString+="</mergeCells>"}if(sheet.hyperLinks.length>0){sheetString+="<hyperlinks>";for(let hLink of sheet.hyperLinks)sheetString+='<hyperlink ref="'+hLink.ref+'" r:id="rId'+hLink.rId+'" />';sheetString+="</hyperlinks>",this.addToArchive(this.saveSheetRelations(sheet),"xl/worksheets/_rels/sheet"+sheet.index+".xml.rels")}sheetBlob.append(sheetString+='<pageMargins left="0.75" right="0.75" top="1" bottom="1" header="0.5" footer="0.5" /><headerFooter scaleWithDoc="1" alignWithMargins="0" differentFirst="0" differentOddEven="0" /></worksheet>'),this.addToArchive(sheetBlob.getBlob(),"xl/worksheets/sheet"+(index+1)+".xml")}pixelsToColumnWidth(pixels){let val=pixels>12?this.trunc((pixels-5)/7*100+.5)/100:pixels/12;return val>1?(7*val+5)/7*256/256:12*val/7*256/256}trunc(x){let n=x-x%1;return 0===n&&(x<0||0===x&&1/x!=1/0)?-0:n}pixelsToRowHeight(pixels){return pixels*this.unitsProportions[5]/this.unitsProportions[6]}saveSheetRelations(sheet){let relStr='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">';for(let hLink of sheet.hyperLinks)relStr+='<Relationship Id="rId'+hLink.rId+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Target="'+hLink.target+'" TargetMode="External" />';return relStr+"</Relationships>"}saveSheetView(sheet){let paneString='<sheetViews><sheetView workbookViewId="0" ';return paneString+=!1===sheet.showGridLines?'showGridLines="0" >':">",void 0!==sheet.freezePanes&&(paneString+='<pane state="frozen" topLeftCell="'+sheet.freezePanes.leftCell+'" ',0!==sheet.freezePanes.row&&(paneString+='ySplit="'+sheet.freezePanes.row+'" '),0!==sheet.freezePanes.column&&(paneString+='xSplit="'+sheet.freezePanes.column+'" '),paneString+="/>"),paneString+"</sheetView></sheetViews > "}saveSharedString(){let length=this.sharedString.length;if(length>0){let sstStart='<?xml version="1.0" encoding="utf-8"?><sst uniqueCount="'+length+'" count="'+this.sharedStringCount+'" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',si="";for(let i=0;i<length;i++)this.sharedString[i].startsWith("<r>")?(si+="<si>",si+=this.sharedString[i],si+="</si>"):(si+="<si><t>",si+=this.processString(this.sharedString[i]),si+="</t></si>");this.addToArchive(sstStart+(si+="</sst>"),"xl/sharedStrings.xml")}}processString(value){return-1!==value.indexOf("&")&&(value=value.replace(/&/g,"&amp;")),-1!==value.indexOf("<")&&(value=value.replace(/</g,"&lt;")),-1!==value.indexOf(">")&&(value=value.replace(/>/g,"&gt;")),value}saveStyles(){this.updateCellXfsStyleXfs();let styleTemp='<?xml version="1.0" encoding="utf-8"?><styleSheet xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';styleTemp+=this.saveNumberFormats(),styleTemp+=this.saveFonts(),styleTemp+=this.saveFills(),styleTemp+=this.saveBorders(),styleTemp+=this.saveCellStyleXfs(),styleTemp+=this.saveCellXfs(),styleTemp+=this.saveCellStyles(),this.addToArchive(styleTemp+"</styleSheet>","xl/styles.xml")}updateCellXfsStyleXfs(){for(let style of this.mStyles){let cellXfs=void 0;style.isGlobalStyle?(cellXfs=new CellStyleXfs).xfId=style.index-1:(cellXfs=new CellXfs).xfId=0;let compareFontResult=this.isNewFont(style);if(compareFontResult.result)cellXfs.fontId=compareFontResult.index;else{let font=new Font;font.b=style.bold,font.i=style.italic,font.name=style.fontName,font.sz=style.fontSize,font.u=style.underline,font.color="FF"+style.fontColor.replace("#",""),this.mFonts.push(font),cellXfs.fontId=this.mFonts.length-1}if("none"!==style.backColor){let backColor="FF"+style.backColor.replace("#","");if(this.mFills.has(backColor)){let fillId=this.mFills.get(backColor);cellXfs.fillId=fillId}else{let fillId=this.mFills.size+2;this.mFills.set(backColor,fillId),cellXfs.fillId=fillId}}else cellXfs.fillId=0;if(this.isNewBorder(style)?cellXfs.borderId=0:(this.mBorders.push(style.borders),cellXfs.borderId=this.mBorders.length),"GENERAL"!==style.numberFormat)if(this.mNumFmt.has(style.numberFormat)){let numFmt=this.mNumFmt.get(style.numberFormat);cellXfs.numFmtId=numFmt.numFmtId}else{let id=this.mNumFmt.size+164;this.mNumFmt.set(style.numberFormat,new NumFmt(id,style.numberFormat)),cellXfs.numFmtId=id}else cellXfs.numFmtId="GENERAL"===style.numberFormat&&14===style.numFmtId?14:0;style.isGlobalStyle||(cellXfs.applyAlignment=1),cellXfs.alignment=new Alignment,cellXfs.alignment.indent=style.indent,cellXfs.alignment.horizontal=style.hAlign,cellXfs.alignment.vertical=style.vAlign,cellXfs.alignment.wrapText=style.wrapText?1:0,cellXfs.alignment.rotation=style.rotation,style.isGlobalStyle?(this.mCellStyleXfs.push(cellXfs),this.mCellXfs.push(cellXfs)):this.mCellXfs.push(cellXfs)}}saveNumberFormats(){if(this.mNumFmt.size>=1){let numFmtStyle='<numFmts count="'+this.mNumFmt.size+'">';return this.mNumFmt.forEach((value,key)=>{numFmtStyle+='<numFmt numFmtId="'+value.numFmtId+'" formatCode="'+value.formatCode.replace(/"/g,"&quot;")+'" />'}),numFmtStyle+="</numFmts>"}return""}saveFonts(){let fontStyle='<fonts count="'+this.mFonts.length+'">';if(this.mFonts.length>=1)for(let font of this.mFonts)fontStyle+="<font>",font.b&&(fontStyle+="<b />"),font.i&&(fontStyle+="<i />"),font.u&&(fontStyle+="<u />"),fontStyle+='<sz val="'+this.pixelsToRowHeight(font.sz)+'" />',fontStyle+='<color rgb="'+font.color+'" />',fontStyle+='<name val="'+font.name+'" /></font>';return fontStyle+"</fonts>"}saveFills(){let fillsStyle='<fills count="'+(this.mFills.size+2)+'"><fill><patternFill patternType="none"></patternFill></fill><fill><patternFill patternType="gray125"></patternFill></fill>';return this.mFills.size>=1&&this.mFills.forEach((value,key)=>{fillsStyle+='<fill><patternFill patternType="solid"><fgColor rgb="'+key+'" /><bgColor rgb="FFFFFFFF" /></patternFill></fill>'}),fillsStyle+"</fills>"}saveBorders(){let bordersStyle='<borders count="'+(this.mBorders.length+1)+'"><border><left /><right /><top /><bottom /><diagonal /></border>';if(this.mBorders.length>=1)for(let borders of this.mBorders)if(this.isAllBorder(borders)){let color=borders.all.color.replace("#",""),lineStyle=borders.all.lineStyle;bordersStyle+='<border><left style="'+lineStyle+'"><color rgb="FF'+color+'" /></left><right style="'+lineStyle+'"><color rgb="FF'+color+'" /></right><top style="'+lineStyle+'"><color rgb="FF'+color+'" /></top><bottom style="'+lineStyle+'"><color rgb="FF'+color+'" /></bottom></border>'}else bordersStyle+='<border><left style="'+borders.left.lineStyle+'"><color rgb="FF'+borders.left.color.replace("#","")+'" /></left><right style="'+borders.right.lineStyle+'"><color rgb="FF'+borders.right.color.replace("#","")+'" /></right><top style="'+borders.top.lineStyle+'"><color rgb="FF'+borders.top.color.replace("#","")+'" /></top><bottom style="'+borders.bottom.lineStyle+'"><color rgb="FF'+borders.bottom.color.replace("#","")+'" /></bottom></border>';return bordersStyle+"</borders>"}saveCellStyles(){let cellStyleString='<cellStyles  count="'+this.cellStyles.size+'">';return this.cellStyles.forEach((value,key)=>{cellStyleString+='<cellStyle name="'+key+'" xfId="'+this.cellStyles.get(key).xfId+'"',"Normal"===key&&(cellStyleString+=' builtinId="0"'),cellStyleString+=" />"}),cellStyleString+="</cellStyles>"}saveCellStyleXfs(){let cellXfsStyle='<cellStyleXfs count="'+(this.mCellStyleXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" />';if(this.mCellStyleXfs.length>=1)for(let cellStyleXf of this.mCellStyleXfs)cellXfsStyle+='<xf numFmtId="'+cellStyleXf.numFmtId+'" fontId="'+cellStyleXf.fontId+'" fillId="'+cellStyleXf.fillId+'" borderId="'+cellStyleXf.borderId+'" ',cellXfsStyle+=void 0!==cellStyleXf.alignment?">"+this.saveAlignment(cellStyleXf)+"</xf>":" />";return cellXfsStyle+"</cellStyleXfs>"}saveCellXfs(){let cellXfsStyle='<cellXfs count="'+(this.mCellXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" />';if(this.mCellXfs.length>=1)for(let cellXf of this.mCellXfs)cellXfsStyle+='<xf numFmtId="'+cellXf.numFmtId+'" fontId="'+cellXf.fontId+'" fillId="'+cellXf.fillId+'" borderId="'+cellXf.borderId+'" xfId="'+cellXf.xfId+'" ',1===cellXf.applyAlignment&&(cellXfsStyle+='applyAlignment="1"'),cellXfsStyle+=">"+this.saveAlignment(cellXf)+"</xf>";return cellXfsStyle+"</cellXfs>"}saveAlignment(cellXf){let alignString="<alignment ";return void 0!==cellXf.alignment.horizontal&&(alignString+='horizontal="'+cellXf.alignment.horizontal+'" '),void 0!==cellXf.alignment.indent&&0!==cellXf.alignment.indent?alignString+='indent="'+cellXf.alignment.indent+'" ':void 0!==cellXf.alignment.rotation&&0!==cellXf.alignment.rotation&&(alignString+='textRotation="'+cellXf.alignment.rotation+'" '),void 0!==cellXf.alignment.vertical&&(alignString+='vertical="'+cellXf.alignment.vertical+'" '),alignString+'wrapText="'+cellXf.alignment.wrapText+'" />'}saveApp(builtInProperties){let appString='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>Essential XlsIO</Application>';void 0!==builtInProperties&&(void 0!==builtInProperties.manager&&(appString+="<Manager>"+builtInProperties.manager+"</Manager>"),void 0!==builtInProperties.company&&(appString+="<Company>"+builtInProperties.company+"</Company>")),this.addToArchive(appString+"</Properties>","docProps/app.xml")}saveCore(builtInProperties){let createdDate=new Date,coreString='<?xml version="1.0" encoding="utf-8" standalone="yes"?><cp:coreProperties xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties">';void 0!==this.builtInProperties?(void 0!==builtInProperties.author&&(coreString+="<dc:creator>"+builtInProperties.author+"</dc:creator>"),void 0!==builtInProperties.subject&&(coreString+="<dc:subject>"+builtInProperties.subject+"</dc:subject>"),void 0!==builtInProperties.category&&(coreString+="<cp:category>"+builtInProperties.category+"</cp:category>"),void 0!==builtInProperties.comments&&(coreString+="<dc:description>"+builtInProperties.comments+"</dc:description>"),void 0!==builtInProperties.title&&(coreString+="<dc:title>"+builtInProperties.title+"</dc:title>"),void 0!==builtInProperties.tags&&(coreString+="<cp:keywords>"+builtInProperties.tags+"</cp:keywords>"),void 0!==builtInProperties.status&&(coreString+="<cp:contentStatus>"+builtInProperties.status+"</cp:contentStatus>"),coreString+=void 0!==builtInProperties.createdDate?'<dcterms:created xsi:type="dcterms:W3CDTF">'+builtInProperties.createdDate.toISOString()+"</dcterms:created>":'<dcterms:created xsi:type="dcterms:W3CDTF">'+createdDate.toISOString()+"</dcterms:created>",coreString+=void 0!==builtInProperties.modifiedDate?'<dcterms:modified xsi:type="dcterms:W3CDTF">'+builtInProperties.modifiedDate.toISOString()+"</dcterms:modified>":'<dcterms:modified xsi:type="dcterms:W3CDTF">'+createdDate.toISOString()+"</dcterms:modified>"):(coreString+='<dcterms:created xsi:type="dcterms:W3CDTF">'+createdDate.toISOString()+"</dcterms:created>",coreString+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+createdDate.toISOString()+"</dcterms:modified>"),this.addToArchive(coreString+="</cp:coreProperties>","docProps/core.xml")}saveTopLevelRelation(){this.addToArchive('<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml" /><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml" /><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml" /></Relationships>',"_rels/.rels")}saveWorkbookRelation(){let wbRelation='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',length=this.worksheets.length,count=0;for(let i=0;i<length;i++,count++)wbRelation+='<Relationship Id="rId'+(i+1).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+(i+1).toString()+'.xml" />';wbRelation+='<Relationship Id="rId'+(++count).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" />',this.sharedStringCount>0&&(wbRelation+='<Relationship Id="rId'+(++count).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" />'),this.addToArchive(wbRelation+"</Relationships>","xl/_rels/workbook.xml.rels")}saveContentType(){let contentTypeString='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" /><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" />',sheetsOverride="",length=this.worksheets.length;for(let i=0;i<length;i++)sheetsOverride+='<Override PartName="/xl/worksheets/sheet'+(i+1).toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />';this.sharedStringCount>0&&(contentTypeString+='<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml" />'),this.addToArchive(contentTypeString+sheetsOverride+"</Types>","[Content_Types].xml")}addToArchive(xmlString,itemName){if("string"==typeof xmlString){let blob=new Blob([xmlString],{type:"text/plain"}),archiveItem=new ZipArchiveItem(blob,itemName);this.mArchive.addItem(archiveItem)}else{let archiveItem=new ZipArchiveItem(xmlString,itemName);this.mArchive.addItem(archiveItem)}}processMergeCells(cell,rowIndex,mergeCells){if(0!==cell.rowSpan||0!==cell.colSpan){let mCell=new MergeCell;mCell.x=cell.index,mCell.width=cell.colSpan,mCell.y=rowIndex,mCell.height=cell.rowSpan;let startCell=this.getCellName(mCell.y,mCell.x),endCell=this.getCellName(rowIndex+mCell.height,cell.index+mCell.width);mCell.ref=startCell+":"+endCell,mergeCells.add(mCell),this.updatedMergedCellStyles({x:mCell.x,y:mCell.y},{x:cell.index+mCell.width,y:rowIndex+mCell.height},cell)}return mergeCells}updatedMergedCellStyles(sCell,eCell,cell){for(let x=sCell.x;x<=eCell.x;x++)for(let y=sCell.y;y<=eCell.y;y++)this.mergedCellsStyle.set(this.getCellName(y,x),{x:x,y:y,styleIndex:cell.styleIndex})}dateToTicks(year,month,day){let daysToMonth365=[0,31,59,90,120,151,181,212,243,273,304,334,365],daysToMonth366=[0,31,60,91,121,152,182,213,244,274,305,335,366];if(year>=1&&year<=9999&&month>=1&&month<=12){let y=year-1;return 864e9*(365*y+(y/4|0)-(y/100|0)+(y/400|0)+(this.isLeapYear(year)?daysToMonth366:daysToMonth365)[month-1]+day-1)}throw new Error("Not a valid date")}timeToTicks(hour,minute,second){if(hour>=0&&hour<24&&minute>=0&&minute<60&&second>=0&&second<60)return 1e4*(3600*hour+60*minute+second)*1e3;throw new Error("Not valid time")}isLeapYear(year){return year%4==0&&(year%100!=0||year%400==0)}toOADate(date){let ticks=0;if(0===(ticks=this.dateToTicks(date.getFullYear(),date.getMonth()+1,date.getDate())+this.timeToTicks(date.getHours(),date.getMinutes(),date.getSeconds())))return 0;if(ticks<31241376e9)throw new Error("Arg_OleAutDateInvalid");return(ticks-599264352e9)/1e4/864e5}}class BuiltInProperties{}function defaultToString(item){return"[object String]"===Object.prototype.toString.call(item)?"$s"+item:"$o"+item.toString()}class Dictionary{constructor(toStringFunction){this.table={},this.nElements=0,this.toStr=toStringFunction||defaultToString}getValue(key){const pair=this.table["$"+this.toStr(key)];if(void 0!==pair)return pair.value}setValue(key,value){let ret;const k="$"+this.toStr(key);this.nElements++,ret=void 0,this.table[k]={key:key,value:value}}remove(key){const k="$"+this.toStr(key),previousElement=this.table[k];return delete this.table[k],this.nElements--,previousElement.value}keys(){const keysArray=[];let namesOfKeys=Object.keys(this.table);for(let index1=0;index1<namesOfKeys.length;index1++)keysArray.push(this.table[namesOfKeys[index1]].key);return keysArray}values(){const valuesArray=[];let namesOfValues=Object.keys(this.table);for(let index2=0;index2<namesOfValues.length;index2++)valuesArray.push(this.table[namesOfValues[index2]].value);return valuesArray}containsKey(key){let retutnValue=!0;return!(retutnValue=void 0===this.getValue(key))}clear(){this.table={},this.nElements=0}size(){return this.nElements}}let PdfName=(()=>{class PdfName{constructor(value){this.stringStartMark="/",this.internalValue="",this.isSaving6=!1,this.position6=-1,this.internalValue=this.normalizeValue(value)}get status(){return this.status6}set status(value){this.status6=value}get isSaving(){return this.isSaving6}set isSaving(value){this.isSaving6=value}get objectCollectionIndex(){return this.index6}set objectCollectionIndex(value){this.index6=value}get position(){return this.position6}set position(value){this.position6=value}get clonedObject(){return null}get value(){return this.internalValue}set value(value){let val=value;this.internalValue=null!==value&&value.length>0?this.normalizeValue(val=value):val}save(writer){writer.write(this.toString())}toString(){return this.stringStartMark+this.escapeString(this.value)}clone(crossTable){let newName=new PdfName;return newName.value=this.internalValue,newName}escapeString(stringValue){let result="";for(let i=0,len=stringValue.length;i<len;i++){let ch=stringValue[i];PdfName.delimiters.indexOf(ch),result+=ch}return result}normalizeValue(value,c){return value}}return PdfName.delimiters="()<>[]{}/%}",PdfName.replacements=[" ","\t","\n","\r"],PdfName})(),Operators=(()=>{class Operators{constructor(){this.forTest="test",this.forTest=Operators.obj}}return Operators.obj="obj",Operators.endObj="endobj",Operators.r="R",Operators.whiteSpace=" ",Operators.slash="/",Operators.newLine="\r\n",Operators.stream="stream",Operators.endStream="endstream",Operators.xref="xref",Operators.f="f",Operators.n="n",Operators.trailer="trailer",Operators.startxref="startxref",Operators.eof="%%EOF",Operators.header="%PDF-1.5",Operators.beginText="BT",Operators.endText="ET",Operators.beginPath="m",Operators.appendLineSegment="l",Operators.stroke="S",Operators.fill="f",Operators.fillEvenOdd="f*",Operators.fillStroke="B",Operators.fillStrokeEvenOdd="B*",Operators.appendbeziercurve="c",Operators.appendRectangle="re",Operators.saveState="q",Operators.restoreState="Q",Operators.paintXObject="Do",Operators.modifyCtm="cm",Operators.modifyTM="Tm",Operators.setLineWidth="w",Operators.setLineCapStyle="J",Operators.setLineJoinStyle="j",Operators.setDashPattern="d",Operators.setFlatnessTolerance="i",Operators.closePath="h",Operators.closeStrokePath="s",Operators.closeFillStrokePath="b",Operators.setCharacterSpace="Tc",Operators.setWordSpace="Tw",Operators.setHorizontalScaling="Tz",Operators.setTextLeading="TL",Operators.setFont="Tf",Operators.setRenderingMode="Tr",Operators.setTextRise="Ts",Operators.setTextScaling="Tz",Operators.setCoords="Td",Operators.goToNextLine="T*",Operators.setText="Tj",Operators.setTextWithFormatting="TJ",Operators.setTextOnNewLine="'",Operators.selectcolorspaceforstroking="CS",Operators.selectcolorspacefornonstroking="cs",Operators.setrbgcolorforstroking="RG",Operators.setrbgcolorfornonstroking="rg",Operators.setcmykcolorforstroking="K",Operators.setcmykcolorfornonstroking="k",Operators.setgraycolorforstroking="G",Operators.setgraycolorfornonstroking="g",Operators.clipPath="W",Operators.clipPathEvenOdd="W*",Operators.endPath="n",Operators.setGraphicsState="gs",Operators.comment="%",Operators.evenOdd="*",Operators.setMiterLimit="M",Operators})();class DictionaryProperties{constructor(){this.pages="Pages",this.kids="Kids",this.count="Count",this.resources="Resources",this.type="Type",this.size="Size",this.mediaBox="MediaBox",this.parent="Parent",this.root="Root",this.decodeParms="DecodeParms",this.filter="Filter",this.font="Font",this.type1="Type1",this.baseFont="BaseFont",this.encoding="Encoding",this.subtype="Subtype",this.contents="Contents",this.procset="ProcSet",this.colorSpace="ColorSpace",this.extGState="ExtGState",this.pattern="Pattern",this.xObject="XObject",this.length="Length",this.width="Width",this.height="Height",this.bitsPerComponent="BitsPerComponent",this.image="Image",this.dctdecode="DCTDecode",this.columns="Columns",this.blackIs1="BlackIs1",this.k="K",this.s="S",this.predictor="Predictor",this.deviceRgb="DeviceRGB",this.next="Next",this.action="Action",this.link="Link",this.a="A",this.annot="Annot",this.p="P",this.c="C",this.rect="Rect",this.uri="URI",this.annots="Annots",this.ca="ca",this.CA="CA",this.xyz="XYZ",this.fit="Fit",this.dest="Dest",this.BM="BM",this.flatedecode="FlateDecode",this.rotate="Rotate",this.bBox="BBox",this.form="Form",this.w="W",this.cIDFontType2="CIDFontType2",this.cIDToGIDMap="CIDToGIDMap",this.identity="Identity",this.dw="DW",this.fontDescriptor="FontDescriptor",this.cIDSystemInfo="CIDSystemInfo",this.fontName="FontName",this.flags="Flags",this.fontBBox="FontBBox",this.missingWidth="MissingWidth",this.stemV="StemV",this.italicAngle="ItalicAngle",this.capHeight="CapHeight",this.ascent="Ascent",this.descent="Descent",this.leading="Leading",this.avgWidth="AvgWidth",this.fontFile2="FontFile2",this.maxWidth="MaxWidth",this.xHeight="XHeight",this.stemH="StemH",this.registry="Registry",this.ordering="Ordering",this.supplement="Supplement",this.type0="Type0",this.identityH="Identity-H",this.toUnicode="ToUnicode",this.descendantFonts="DescendantFonts"}}class PdfDictionary{constructor(dictionary){if(this.position7=-1,this.primitiveItems=new Dictionary,this.prefix="<<",this.suffix=">>",this.resources=[],this.object=null,this.archive=!0,this.isFont=!1,void 0===dictionary)this.primitiveItems=new Dictionary,this.encrypt=!0,this.dictionaryProperties=new DictionaryProperties;else{this.primitiveItems=new Dictionary;let keys=dictionary.items.keys(),values=dictionary.items.values();for(let index=0;index<dictionary.items.size();index++)this.primitiveItems.setValue(keys[index],values[index]);this.status=dictionary.status,this.freezeChanges(this),this.encrypt=!0,this.dictionaryProperties=new DictionaryProperties}}get items(){return this.primitiveItems}get status(){return this.status7}set status(value){this.status7=value}get isSaving(){return this.isSaving7}set isSaving(value){this.isSaving7=value}get objectCollectionIndex(){return this.index7}set objectCollectionIndex(value){this.index7=value}get clonedObject(){return this.object}get position(){return this.position7}set position(value){this.position7=value}get Count(){return this.primitiveItems.size()}get Dictionary(){return this}getArchive(){return this.archive}setArchive(value){this.archive=value}setEncrypt(value){this.encrypt=value,this.modify()}getEncrypt(){return this.encrypt}freezeChanges(freezer){this.bChanged=!1}clone(crossTable){return new PdfDictionary}modify(){this.bChanged=!0}remove(key){"string"!=typeof key?(this.primitiveItems.remove(key.value),this.modify()):this.remove(new PdfName(key))}containsKey(key){return this.primitiveItems.containsKey(key.toString())}onBeginSave(){this.beginSave.sender.beginSave()}onFontDictionaryBeginSave(){this.fontDictionaryBeginSave.sender.fontDictionaryBeginSave()}onDescendantFontBeginSave(){this.descendantFontBeginSave.sender.descendantFontBeginSave()}onTemplateBeginSave(){this.pageBeginDrawTemplate.sender.pageBeginSave()}onBeginAnnotationSave(){this.annotationBeginSave.sender.beginSave()}onSectionBeginSave(writer){let saveEvent=this.sectionBeginSave;saveEvent.sender.beginSave(saveEvent.state,writer)}save(writer,bRaiseEvent){void 0===bRaiseEvent?this.save(writer,!0):(writer.write(this.prefix),void 0!==this.beginSave&&this.onBeginSave(),void 0!==this.descendantFontBeginSave&&this.onDescendantFontBeginSave(),void 0!==this.fontDictionaryBeginSave&&this.onFontDictionaryBeginSave(),void 0!==this.annotationBeginSave&&this.onBeginAnnotationSave(),void 0!==this.sectionBeginSave&&this.onSectionBeginSave(writer),void 0!==this.pageBeginDrawTemplate&&this.onTemplateBeginSave(),this.Count>0&&this.saveItems(writer),writer.write(this.suffix),writer.write(Operators.newLine))}saveItems(writer){writer.write(Operators.newLine);let keys=this.primitiveItems.keys(),values=this.primitiveItems.values();for(let index=0;index<keys.length;index++)new PdfName(keys[index]).save(writer),writer.write(Operators.whiteSpace),values[index].save(writer),writer.write(Operators.newLine)}}class SaveSectionCollectionEventHandler{constructor(sender){this.sender=sender}}class SaveDescendantFontEventHandler{constructor(sender){this.sender=sender}}class SaveFontDictionaryEventHandler{constructor(sender){this.sender=sender}}class SaveAnnotationEventHandler{constructor(sender){this.sender=sender}}class SaveSectionEventHandler{constructor(sender,state){this.sender=sender,this.state=state}}class SaveTemplateEventHandler{constructor(sender){this.sender=sender}}class PdfNumber{constructor(value){this.position5=-1,this.value=value}get intValue(){return this.value}set intValue(value){this.value=value}get isInteger(){return this.integer}set isInteger(value){this.integer=value}get status(){return this.status5}set status(value){this.status5=value}get isSaving(){return this.isSaving5}set isSaving(value){this.isSaving5=value}get objectCollectionIndex(){return this.index5}set objectCollectionIndex(value){this.index5=value}get position(){return this.position5}set position(value){this.position5=value}get clonedObject(){return null}save(writer){writer.write(this.intValue.toString())}clone(crossTable){return new PdfNumber(this.value)}static floatToString(number){let returnString=number.toFixed(2);return"0.00"===returnString&&(returnString=".00"),returnString}static min(x,y,z){let r=Math.min(x,y);return Math.min(z,r)}}class PdfArray{constructor(array){if(this.startMark="[",this.endMark="]",this.position9=-1,this.clonedObject9=null,this.isFont=!1,void 0===array)this.internalElements=[];else if(void 0===array||array instanceof PdfArray){let tempArray=array;this.internalElements=[];for(let index=0;index<tempArray.elements.length;index++)this.internalElements.push(tempArray.elements[index])}else{let tempNumberArray=array;for(let index=0;index<tempNumberArray.length;index++){let pdfNumber=new PdfNumber(tempNumberArray[index]);this.add(pdfNumber)}}}items(index){return this.internalElements[index]}get count(){return this.internalElements.length}get status(){return this.status9}set status(value){this.status9=value}get isSaving(){return this.isSaving9}set isSaving(value){this.isSaving9=value}get clonedObject(){return this.clonedObject9}get position(){return this.position9}set position(value){this.position9=value}get objectCollectionIndex(){return this.index9}set objectCollectionIndex(value){this.index9=value}get CrossTable(){return this.pdfCrossTable}get elements(){return this.internalElements}add(element){void 0===this.internalElements&&(this.internalElements=[]),this.internalElements.push(element),this.markedChange()}markedChange(){this.bChanged=!0}contains(element){for(let index=0;index<this.internalElements.length;index++){let tempElement=this.internalElements[index],inputElement=element;if(null!=tempElement&&void 0!==tempElement&&null!=inputElement&&void 0!==inputElement&&tempElement.value===inputElement.value)return!0}return!1}getItems(index){return this.internalElements[index]}save(writer){writer.write(this.startMark);for(let i=0,len=this.count;i<len;i++)this.getItems(i).save(writer),i+1!==len&&writer.write(Operators.whiteSpace);writer.write(this.endMark)}clone(crossTable){this.clonedObject9=null;let newArray=new PdfArray;for(let index=0;index<this.internalElements.length;index++)newArray.add(this.internalElements[index].clone(crossTable));return newArray.pdfCrossTable=crossTable,this.clonedObject9=newArray,newArray}static fromRectangle(bounds){return new PdfArray([bounds.x,bounds.y,bounds.width,bounds.height])}insert(index,element){if(index<this.internalElements.length&&index>0){let tempElements=[];for(let i=0;i<index;i++)tempElements.push(this.internalElements[i]);tempElements.push(element);for(let i=index;i<this.internalElements.length;i++)tempElements.push(this.internalElements[i]);this.internalElements=tempElements}else this.internalElements.push(element);this.markChanged()}indexOf(element){return this.internalElements.indexOf(element)}remove(element){let index=this.internalElements.indexOf(element);this.internalElements[index]=null,this.markChanged()}removeAt(index){if(this.internalElements.length>index){let tempArray=[];for(let i=0;i<index;i++)tempArray.push(this.internalElements[i]);for(let i=index+1;i<this.internalElements.length;i++)tempArray.push(this.internalElements[i]);this.internalElements=tempArray}this.markChanged()}clear(){this.internalElements=[],this.markChanged()}markChanged(){this.bChanged=!0}}class ej2_pdf_export_es2015_PdfStream extends PdfDictionary{constructor(dictionary,data){super(dictionary),this.dicPrefix="stream",this.dicSuffix="endstream",this.clonedObject2=null,this.bCompress=!0,this.isImageStream=!1,this.isFontStream=!1,void 0!==dictionary||void 0!==data?(this.dataStream2=[],this.dataStream2=data,this.bCompress2=!1):(this.dataStream2=[],this.bCompress2=!0)}get internalStream(){return this.dataStream2}set internalStream(value){this.dataStream2=[],this.dataStream2=value,this.modify()}get isImage(){return this.isImageStream}set isImage(value){this.isImageStream=value}get isFont(){return this.isFontStream}set isFont(value){this.isFontStream=value}get compress(){return this.bCompress}set compress(value){this.bCompress=value,this.modify()}get data(){return this.dataStream2}set data(value){this.dataStream2=[],this.dataStream2=value,this.modify()}clearStream(){this.internalStream=[],this.items.containsKey(this.dictionaryProperties.filter)&&this.remove(this.dictionaryProperties.filter),this.bCompress=!0,this.modify()}write(text){if(null==text)throw new Error("ArgumentNullException:text");if(text.length<=0)throw new Error("ArgumentException: Can not write an empty string, text");this.dataStream2.push(text),this.modify()}writeBytes(data){if(null===data)throw new Error("ArgumentNullException:data");if(data.length<=0)throw new Error("ArgumentException: Can not write an empty bytes, data");let text="";for(let i=0;i<data.length;i++)text+=String.fromCharCode(data[i]);this.dataStream2.push(text),this.modify()}onCmapBeginSave(){this.cmapBeginSave.sender.cmapBeginSave()}onFontProgramBeginSave(){this.fontProgramBeginSave.sender.fontProgramBeginSave()}compressContent(data,writer){if(this.bCompress){let byteArray=[];for(let i=0;i<data.length;i++)byteArray.push(data.charCodeAt(i));let dataArray=new Uint8Array(byteArray),sw=new ej2_compression_es2015_CompressedStreamWriter;sw.write(dataArray,0,dataArray.length),sw.close(),data=sw.getCompressedString,this.addFilter(this.dictionaryProperties.flatedecode)}return data}addFilter(filterName){let obj=this.items.getValue(this.dictionaryProperties.filter);obj instanceof PdfReferenceHolder&&(obj=obj.object);let array=obj,name=obj;null!=name&&((array=new PdfArray).insert(0,name),this.items.setValue(this.dictionaryProperties.filter,array)),name=new PdfName(filterName),null==array?this.items.setValue(this.dictionaryProperties.filter,name):array.insert(0,name)}save(writer){void 0!==this.cmapBeginSave&&this.onCmapBeginSave(),void 0!==this.fontProgramBeginSave&&this.onFontProgramBeginSave();let data="";for(let i=0;i<this.data.length;i++)data+=this.data[i];data.length>1&&!this.isImage&&!this.isFont&&(data="q\r\n"+data+"Q\r\n"),data=this.compressContent(data,writer),this.items.setValue(this.dictionaryProperties.length,new PdfNumber(data.length)),super.save(writer,!1),writer.write(this.dicPrefix),writer.write(Operators.newLine),data.length>0&&writer.write(data),writer.write(Operators.newLine),writer.write(this.dicSuffix),writer.write(Operators.newLine)}static bytesToString(byteArray){let output="";for(let i=0;i<byteArray.length;i++)output+=String.fromCharCode(byteArray[i]);return output}}class SaveCmapEventHandler{constructor(sender){this.sender=sender}}class SaveFontProgramEventHandler{constructor(sender){this.sender=sender}}var InternalEnum;!function(InternalEnum){let ForceEncoding,SourceType;!function(ForceEncoding){ForceEncoding[ForceEncoding.None=0]="None",ForceEncoding[ForceEncoding.Ascii=1]="Ascii",ForceEncoding[ForceEncoding.Unicode=2]="Unicode"}(ForceEncoding=InternalEnum.ForceEncoding||(InternalEnum.ForceEncoding={})),function(SourceType){SourceType[SourceType.StringValue=0]="StringValue",SourceType[SourceType.ByteBuffer=1]="ByteBuffer"}(SourceType||(SourceType={}))}(InternalEnum||(InternalEnum={}));let PdfString=(()=>{class PdfString{constructor(value){if(this.bHex=!1,this.position1=-1,this.clonedObject1=null,this.bDecrypted=!1,this.isParentDecrypted=!1,this.isPacked=!1,this.isFormField=!1,this.isColorSpace=!1,this.isHexString=!0,void 0===value)this.bHex=!1;else if(!(value.length>0&&"0xfeff"===value[0])){this.stringValue=value,this.data=[];for(let i=0;i<value.length;++i)this.data.push(value.charCodeAt(i))}}get hex(){return this.bHex}get value(){return this.stringValue}set value(value){this.stringValue=value,this.data=null}get status(){return this.status1}set status(value){this.status1=value}get isSaving(){return this.isSaving1}set isSaving(value){this.isSaving1=value}get objectCollectionIndex(){return this.index1}set objectCollectionIndex(value){this.index1=value}get clonedObject(){return this.clonedObject1}get position(){return this.position1}set position(value){this.position1=value}get CrossTable(){return this.crossTable}get converted(){return this.bConverted}set converted(value){this.bConverted=value}get encode(){return this.bForceEncoding}set encode(value){this.bForceEncoding=value}static bytesToHex(bytes){return""}save(writer){if(null===writer)throw new Error("ArgumentNullException : writer");writer.write(void 0!==this.encode&&this.encode===InternalEnum.ForceEncoding.Ascii?this.pdfEncode():PdfString.stringMark[0]+this.value+PdfString.stringMark[1])}pdfEncode(){let result="";if(void 0!==this.encode&&this.encode===InternalEnum.ForceEncoding.Ascii){let data=this.escapeSymbols(this.value);for(let i=0;i<data.length;i++)result+=String.fromCharCode(data[i]);result=PdfString.stringMark[0]+result+PdfString.stringMark[1]}else result=this.value;return result}escapeSymbols(value){let data=[];for(let i=0;i<value.length;i++){let currentData=value.charCodeAt(i);switch(currentData){case 40:case 41:data.push(92),data.push(currentData);break;case 13:data.push(92),data.push(114);break;case 92:data.push(92),data.push(currentData);break;default:data.push(currentData)}}return data}clone(crossTable){if(null!==this.clonedObject1&&this.clonedObject1.CrossTable===crossTable)return this.clonedObject1;this.clonedObject1=null;let newString=new PdfString(this.stringValue);return newString.bHex=this.bHex,newString.crossTable=crossTable,newString.isColorSpace=this.isColorSpace,this.clonedObject1=newString,newString}static toUnicodeArray(value,bAddPrefix){if(null==value)throw new Error("Argument Null Exception : value");let output=[];for(let i=0;i<value.length;i++){let code=value.charCodeAt(i);output.push(code/256>>>0),output.push(255&code)}return output}static byteToString(data){if(null==data)throw new Error("Argument Null Exception : stream");let result="";for(let i=0;i<data.length;++i)result+=String.fromCharCode(data[i]);return result}}return PdfString.stringMark="()",PdfString.hexStringMark="<>",PdfString.hexFormatPattern="{0:X2}",PdfString})();class PdfReference{constructor(objNumber,genNumber){this.index3=-1,this.position3=-1,this.objNumber=0,this.genNumber=0,"number"==typeof objNumber&&"number"==typeof genNumber?(this.objNumber=objNumber,this.genNumber=genNumber):(this.objNumber=Number(objNumber),this.genNumber=Number(genNumber))}get status(){return this.status3}set status(value){this.status3=value}get isSaving(){return this.isSaving3}set isSaving(value){this.isSaving3=value}get objectCollectionIndex(){return this.index3}set objectCollectionIndex(value){this.index3=value}get position(){return this.position3}set position(value){this.position3=value}get clonedObject(){return null}save(writer){writer.write(this.toString())}toString(){return this.objNumber.toString()+" "+this.genNumber.toString()+" R"}clone(crossTable){return null}}class PdfReferenceHolder{constructor(obj1,obj2){this.index4=-1,this.position4=-1,this.objectIndex=-1,this.dictionaryProperties=new DictionaryProperties,this.initialize(obj1)}get status(){return this.status4}set status(value){this.status4=value}get isSaving(){return this.isSaving4}set isSaving(value){this.isSaving4=value}get objectCollectionIndex(){return this.index4}set objectCollectionIndex(value){this.index4=value}get position(){return this.position4}set position(value){this.position4=value}get clonedObject(){return null}get object(){return this.primitiveObject}get reference(){return this.pdfReference}get index(){return this.objectIndex}get element(){return this.primitiveObject}initialize(obj1){obj1 instanceof PdfArray||obj1 instanceof PdfDictionary||obj1 instanceof PdfName||obj1 instanceof PdfNumber||obj1 instanceof ej2_pdf_export_es2015_PdfStream||obj1 instanceof PdfReference||obj1 instanceof PdfString?this.primitiveObject=obj1:this.initialize(obj1.element)}save(writer){let cTable=writer.document.crossTable;this.object.isSaving=!0;cTable.getReference(this.object).save(writer)}clone(crossTable){return null}}class PdfAction{constructor(){this.action=null,this.dictionaryProperties=new DictionaryProperties,this.initialize()}get next(){return this.action}set next(value){this.action=value,this.dictionary.items.setValue(this.dictionaryProperties.next,new PdfReferenceHolder(this.action))}get dictionary(){return void 0===this.pdfDictionary&&(this.pdfDictionary=new PdfDictionary),this.pdfDictionary}initialize(){this.dictionary.items.setValue(this.dictionaryProperties.type,new PdfName(this.dictionaryProperties.action))}get element(){return this.dictionary}}class PdfUriAction extends PdfAction{constructor(uri){super(),this.uniformResourceIdentifier=""}get uri(){return this.uniformResourceIdentifier}set uri(value){this.uniformResourceIdentifier=value,this.dictionary.items.setValue(this.dictionaryProperties.uri,new PdfString(this.uniformResourceIdentifier))}initialize(){super.initialize(),this.dictionary.items.setValue(this.dictionaryProperties.s,new PdfName(this.dictionaryProperties.uri))}}var PdfVerticalAlignment=function(PdfVerticalAlignment){return PdfVerticalAlignment[PdfVerticalAlignment.Top=0]="Top",PdfVerticalAlignment[PdfVerticalAlignment.Middle=1]="Middle",PdfVerticalAlignment[PdfVerticalAlignment.Bottom=2]="Bottom",PdfVerticalAlignment}({}),PdfTextAlignment=function(PdfTextAlignment){return PdfTextAlignment[PdfTextAlignment.Left=0]="Left",PdfTextAlignment[PdfTextAlignment.Center=1]="Center",PdfTextAlignment[PdfTextAlignment.Right=2]="Right",PdfTextAlignment[PdfTextAlignment.Justify=3]="Justify",PdfTextAlignment}({}),TextRenderingMode=function(TextRenderingMode){return TextRenderingMode[TextRenderingMode.Fill=0]="Fill",TextRenderingMode[TextRenderingMode.Stroke=1]="Stroke",TextRenderingMode[TextRenderingMode.FillStroke=2]="FillStroke",TextRenderingMode[TextRenderingMode.None=3]="None",TextRenderingMode[TextRenderingMode.ClipFlag=4]="ClipFlag",TextRenderingMode[TextRenderingMode.ClipFill=4]="ClipFill",TextRenderingMode[TextRenderingMode.ClipStroke=5]="ClipStroke",TextRenderingMode[TextRenderingMode.ClipFillStroke=6]="ClipFillStroke",TextRenderingMode[TextRenderingMode.Clip=7]="Clip",TextRenderingMode}({}),PdfLineCap=function(PdfLineCap){return PdfLineCap[PdfLineCap.Flat=0]="Flat",PdfLineCap[PdfLineCap.Round=1]="Round",PdfLineCap[PdfLineCap.Square=2]="Square",PdfLineCap}({}),PdfDashStyle=function(PdfDashStyle){return PdfDashStyle[PdfDashStyle.Solid=0]="Solid",PdfDashStyle[PdfDashStyle.Dash=1]="Dash",PdfDashStyle[PdfDashStyle.Dot=2]="Dot",PdfDashStyle[PdfDashStyle.DashDot=3]="DashDot",PdfDashStyle[PdfDashStyle.DashDotDot=4]="DashDotDot",PdfDashStyle[PdfDashStyle.Custom=5]="Custom",PdfDashStyle}({}),PdfFillMode=function(PdfFillMode){return PdfFillMode[PdfFillMode.Winding=0]="Winding",PdfFillMode[PdfFillMode.Alternate=1]="Alternate",PdfFillMode}({}),PdfColorSpace=function(PdfColorSpace){return PdfColorSpace[PdfColorSpace.Rgb=0]="Rgb",PdfColorSpace[PdfColorSpace.Cmyk=1]="Cmyk",PdfColorSpace[PdfColorSpace.GrayScale=2]="GrayScale",PdfColorSpace[PdfColorSpace.Indexed=3]="Indexed",PdfColorSpace}({}),PdfBlendMode=function(PdfBlendMode){return PdfBlendMode[PdfBlendMode.Normal=0]="Normal",PdfBlendMode[PdfBlendMode.Multiply=1]="Multiply",PdfBlendMode[PdfBlendMode.Screen=2]="Screen",PdfBlendMode[PdfBlendMode.Overlay=3]="Overlay",PdfBlendMode[PdfBlendMode.Darken=4]="Darken",PdfBlendMode[PdfBlendMode.Lighten=5]="Lighten",PdfBlendMode[PdfBlendMode.ColorDodge=6]="ColorDodge",PdfBlendMode[PdfBlendMode.ColorBurn=7]="ColorBurn",PdfBlendMode[PdfBlendMode.HardLight=8]="HardLight",PdfBlendMode[PdfBlendMode.SoftLight=9]="SoftLight",PdfBlendMode[PdfBlendMode.Difference=10]="Difference",PdfBlendMode[PdfBlendMode.Exclusion=11]="Exclusion",PdfBlendMode[PdfBlendMode.Hue=12]="Hue",PdfBlendMode[PdfBlendMode.Saturation=13]="Saturation",PdfBlendMode[PdfBlendMode.Color=14]="Color",PdfBlendMode[PdfBlendMode.Luminosity=15]="Luminosity",PdfBlendMode}({}),PdfGraphicsUnit=function(PdfGraphicsUnit){return PdfGraphicsUnit[PdfGraphicsUnit.Centimeter=0]="Centimeter",PdfGraphicsUnit[PdfGraphicsUnit.Pica=1]="Pica",PdfGraphicsUnit[PdfGraphicsUnit.Pixel=2]="Pixel",PdfGraphicsUnit[PdfGraphicsUnit.Point=3]="Point",PdfGraphicsUnit[PdfGraphicsUnit.Inch=4]="Inch",PdfGraphicsUnit[PdfGraphicsUnit.Document=5]="Document",PdfGraphicsUnit[PdfGraphicsUnit.Millimeter=6]="Millimeter",PdfGraphicsUnit}({}),PdfTextDirection=function(PdfTextDirection){return PdfTextDirection[PdfTextDirection.None=0]="None",PdfTextDirection[PdfTextDirection.LeftToRight=1]="LeftToRight",PdfTextDirection[PdfTextDirection.RightToLeft=2]="RightToLeft",PdfTextDirection}({});let PdfColor=(()=>{class PdfColor{constructor(color1,color2,color3,color4){color1 instanceof PdfColor?(this.redColor=color1.r,this.greenColor=color1.g,this.blueColor=color1.b,this.grayColor=color1.gray,this.alpha=color1.alpha,this.filled=0!==this.alpha):(this.cyanColor=0,this.magentaColor=0,this.yellowColor=0,this.blackColor=0,this.grayColor=0,void 0===color4?(this.redColor=color1,this.greenColor=color2,this.blueColor=color3,this.alpha=PdfColor.maxColourChannelValue,this.filled=!0,this.assignCMYK(color1,color2,color3)):(this.redColor=color2,this.greenColor=color3,this.blueColor=color4,this.alpha=color1,this.filled=!0,this.assignCMYK(color2,color3,color4)))}assignCMYK(r,g,b){let red=r/PdfColor.maxColourChannelValue,green=g/PdfColor.maxColourChannelValue,blue=b/PdfColor.maxColourChannelValue,black=PdfNumber.min(1-red,1-green,1-blue),cyan=1===black?0:(1-red-black)/(1-black),magenta=1===black?0:(1-green-black)/(1-black),yellow=1===black?0:(1-blue-black)/(1-black);this.blackColor=black,this.cyanColor=cyan,this.magentaColor=magenta,this.yellowColor=yellow}get r(){return this.redColor}set r(value){this.redColor=value,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0}get red(){return this.r/PdfColor.maxColourChannelValue}get b(){return this.blueColor}set b(value){this.blueColor=value,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0}get blue(){return this.b/PdfColor.maxColourChannelValue}get g(){return this.greenColor}set g(value){this.greenColor=value,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0}get green(){return this.g/PdfColor.maxColourChannelValue}get gray(){return(this.redColor+this.greenColor+this.blueColor)/(3*PdfColor.maxColourChannelValue)}set gray(value){this.grayColor=value<0?0:value>1?1:value,this.r=this.grayColor*PdfColor.maxColourChannelValue,this.g=this.grayColor*PdfColor.maxColourChannelValue,this.b=this.grayColor*PdfColor.maxColourChannelValue,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0}get isEmpty(){return!this.filled}get a(){return this.alpha}set a(value){this.alpha=value<0?0:value,this.filled=!0}toString(colorSpace,stroke){return this.isEmpty?"":this.rgbToString(stroke)}rgbToString(ifStroking){let r=this.r,g=this.g,b=this.b,key=(r<<16)+(g<<8)+b;ifStroking&&(key+=1<<24);let colour="",obj=null;if(PdfColor.rgbStrings.containsKey(key)&&(obj=PdfColor.rgbStrings.getValue(key)),null==obj){let red=r/PdfColor.maxColourChannelValue,green=g/PdfColor.maxColourChannelValue,blue=b/PdfColor.maxColourChannelValue;colour=ifStroking?red.toString()+" "+green.toString()+" "+blue.toString()+" RG":red.toString()+" "+green.toString()+" "+blue.toString()+" rg",PdfColor.rgbStrings.setValue(key,colour)}else colour=obj.toString();return colour+Operators.newLine}toArray(colorSpace){let array=new PdfArray;switch(colorSpace){case PdfColorSpace.Rgb:array.add(new PdfNumber(this.red)),array.add(new PdfNumber(this.green)),array.add(new PdfNumber(this.blue));break;default:throw new Error("NotSupportedException : Unsupported colour space.")}return array}}return PdfColor.rgbStrings=new Dictionary,PdfColor.grayStringsSroke=new Dictionary,PdfColor.grayStringsFill=new Dictionary,PdfColor.maxColourChannelValue=255,PdfColor})();class PointF{constructor(x,y){void 0===x?(this.x=0,this.y=0):(this.x=null!==x?x:0,this.y=null!==y?y:0)}}class SizeF{constructor(width,height){void 0===height?(this.height=0,this.width=0):(this.height=null!==height?height:0,this.width=null!==width?width:0)}}class RectangleF{constructor(arg1,arg2,arg3,arg4){if(typeof arg1==typeof arg1&&void 0===arg1)this.x=0,this.y=0,this.height=0,this.width=0;else if(arg1 instanceof PointF&&arg2 instanceof SizeF&&void 0===arg3){let pointf=arg1;this.x=pointf.x,this.y=pointf.y;let sizef=arg2;this.height=sizef.height,this.width=sizef.width}else{let y=arg2,width=arg3,height=arg4;this.x=arg1,this.y=y,this.height=height,this.width=width}}}class Rectangle{constructor(left,top,right,bottom){this.left=left,this.top=top,this.right=right,this.bottom=bottom}get width(){return this.right-this.left}get height(){return this.bottom-this.top}get topLeft(){return new PointF(this.left,this.top)}get size(){return new SizeF(this.width,this.height)}toString(){return this.topLeft+"x"+this.size}}class PdfBrush{constructor(){}}class PdfSolidBrush extends PdfBrush{constructor(color){super(),this.pdfColor=color}get color(){return this.pdfColor}set color(value){this.pdfColor=value}monitorChanges(brush,streamWriter,getResources,saveChanges,currentColorSpace){if(null==streamWriter)throw new Error("ArgumentNullException:streamWriter");let diff=!1;return diff=!0,streamWriter.setColorAndSpace(this.pdfColor,currentColorSpace,!1),!0}resetChanges(streamWriter){streamWriter.setColorAndSpace(new PdfColor(0,0,0),PdfColorSpace.Rgb,!1)}}var PdfFontStyle=function(PdfFontStyle){return PdfFontStyle[PdfFontStyle.Regular=0]="Regular",PdfFontStyle[PdfFontStyle.Bold=1]="Bold",PdfFontStyle[PdfFontStyle.Italic=2]="Italic",PdfFontStyle[PdfFontStyle.Underline=4]="Underline",PdfFontStyle[PdfFontStyle.Strikeout=8]="Strikeout",PdfFontStyle}({}),PdfFontFamily=function(PdfFontFamily){return PdfFontFamily[PdfFontFamily.Helvetica=0]="Helvetica",PdfFontFamily[PdfFontFamily.Courier=1]="Courier",PdfFontFamily[PdfFontFamily.TimesRoman=2]="TimesRoman",PdfFontFamily[PdfFontFamily.Symbol=3]="Symbol",PdfFontFamily[PdfFontFamily.ZapfDingbats=4]="ZapfDingbats",PdfFontFamily}({}),PdfWordWrapType=function(PdfWordWrapType){return PdfWordWrapType[PdfWordWrapType.None=0]="None",PdfWordWrapType[PdfWordWrapType.Word=1]="Word",PdfWordWrapType[PdfWordWrapType.WordOnly=2]="WordOnly",PdfWordWrapType[PdfWordWrapType.Character=3]="Character",PdfWordWrapType}({}),PdfSubSuperScript=function(PdfSubSuperScript){return PdfSubSuperScript[PdfSubSuperScript.None=0]="None",PdfSubSuperScript[PdfSubSuperScript.SuperScript=1]="SuperScript",PdfSubSuperScript[PdfSubSuperScript.SubScript=2]="SubScript",PdfSubSuperScript}({}),FontEncoding=function(FontEncoding){return FontEncoding[FontEncoding.Unknown=0]="Unknown",FontEncoding[FontEncoding.StandardEncoding=1]="StandardEncoding",FontEncoding[FontEncoding.MacRomanEncoding=2]="MacRomanEncoding",FontEncoding[FontEncoding.MacExpertEncoding=3]="MacExpertEncoding",FontEncoding[FontEncoding.WinAnsiEncoding=4]="WinAnsiEncoding",FontEncoding[FontEncoding.PdfDocEncoding=5]="PdfDocEncoding",FontEncoding[FontEncoding.IdentityH=6]="IdentityH",FontEncoding}({}),TtfCmapFormat=function(TtfCmapFormat){return TtfCmapFormat[TtfCmapFormat.Apple=0]="Apple",TtfCmapFormat[TtfCmapFormat.Microsoft=4]="Microsoft",TtfCmapFormat[TtfCmapFormat.Trimmed=6]="Trimmed",TtfCmapFormat}({}),TtfCmapEncoding=function(TtfCmapEncoding){return TtfCmapEncoding[TtfCmapEncoding.Unknown=0]="Unknown",TtfCmapEncoding[TtfCmapEncoding.Symbol=1]="Symbol",TtfCmapEncoding[TtfCmapEncoding.Unicode=2]="Unicode",TtfCmapEncoding[TtfCmapEncoding.Macintosh=3]="Macintosh",TtfCmapEncoding}({}),TtfPlatformID=function(TtfPlatformID){return TtfPlatformID[TtfPlatformID.AppleUnicode=0]="AppleUnicode",TtfPlatformID[TtfPlatformID.Macintosh=1]="Macintosh",TtfPlatformID[TtfPlatformID.Iso=2]="Iso",TtfPlatformID[TtfPlatformID.Microsoft=3]="Microsoft",TtfPlatformID}({}),TtfMicrosoftEncodingID=function(TtfMicrosoftEncodingID){return TtfMicrosoftEncodingID[TtfMicrosoftEncodingID.Undefined=0]="Undefined",TtfMicrosoftEncodingID[TtfMicrosoftEncodingID.Unicode=1]="Unicode",TtfMicrosoftEncodingID}({}),TtfMacintoshEncodingID=function(TtfMacintoshEncodingID){return TtfMacintoshEncodingID[TtfMacintoshEncodingID.Roman=0]="Roman",TtfMacintoshEncodingID[TtfMacintoshEncodingID.Japanese=1]="Japanese",TtfMacintoshEncodingID[TtfMacintoshEncodingID.Chinese=2]="Chinese",TtfMacintoshEncodingID}({}),FontDescriptorFlags=function(FontDescriptorFlags){return FontDescriptorFlags[FontDescriptorFlags.FixedPitch=1]="FixedPitch",FontDescriptorFlags[FontDescriptorFlags.Serif=2]="Serif",FontDescriptorFlags[FontDescriptorFlags.Symbolic=4]="Symbolic",FontDescriptorFlags[FontDescriptorFlags.Script=8]="Script",FontDescriptorFlags[FontDescriptorFlags.Nonsymbolic=32]="Nonsymbolic",FontDescriptorFlags[FontDescriptorFlags.Italic=64]="Italic",FontDescriptorFlags[FontDescriptorFlags.ForceBold=262144]="ForceBold",FontDescriptorFlags}({}),TtfCompositeGlyphFlags=function(TtfCompositeGlyphFlags){return TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.Arg1And2AreWords=1]="Arg1And2AreWords",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.ArgsAreXyValues=2]="ArgsAreXyValues",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.RoundXyToGrid=4]="RoundXyToGrid",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.WeHaveScale=8]="WeHaveScale",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.Reserved=16]="Reserved",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.MoreComponents=32]="MoreComponents",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.WeHaveAnXyScale=64]="WeHaveAnXyScale",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.WeHaveTwoByTwo=128]="WeHaveTwoByTwo",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.WeHaveInstructions=256]="WeHaveInstructions",TtfCompositeGlyphFlags[TtfCompositeGlyphFlags.UseMyMetrics=512]="UseMyMetrics",TtfCompositeGlyphFlags}({});class PdfStringFormat{constructor(arg1,arg2){this.scalingFactor=100,this.wordWrapType=PdfWordWrapType.Word,this.internalLineLimit=!0,this.wordWrapType=PdfWordWrapType.Word,void 0!==arg1&&"string"!=typeof arg1&&(this.textAlignment=arg1),void 0!==arg2&&(this.verticalAlignment=arg2)}get alignment(){return this.textAlignment}set alignment(value){this.textAlignment=value}get textDirection(){return this.direction}set textDirection(value){this.direction=value}get lineAlignment(){return void 0===this.verticalAlignment||null==this.verticalAlignment?PdfVerticalAlignment.Top:this.verticalAlignment}set lineAlignment(value){this.verticalAlignment=value}get rightToLeft(){return void 0!==this.isRightToLeft&&null!=this.isRightToLeft&&this.isRightToLeft}set rightToLeft(value){this.isRightToLeft=value}get characterSpacing(){return void 0===this.internalCharacterSpacing||null==this.internalCharacterSpacing?0:this.internalCharacterSpacing}set characterSpacing(value){this.internalCharacterSpacing=value}get wordSpacing(){return void 0===this.internalWordSpacing||null==this.internalWordSpacing?0:this.internalWordSpacing}set wordSpacing(value){this.internalWordSpacing=value}get lineSpacing(){return void 0===this.leading||null==this.leading?0:this.leading}set lineSpacing(value){this.leading=value}get clipPath(){return void 0!==this.clip&&null!=this.clip&&this.clip}set clipPath(value){this.clip=value}get subSuperScript(){return void 0===this.pdfSubSuperScript||null==this.pdfSubSuperScript?PdfSubSuperScript.None:this.pdfSubSuperScript}set subSuperScript(value){this.pdfSubSuperScript=value}get paragraphIndent(){return void 0===this.internalParagraphIndent||null==this.internalParagraphIndent?0:this.internalParagraphIndent}set paragraphIndent(value){this.internalParagraphIndent=value,this.firstLineIndent=value}get lineLimit(){return this.internalLineLimit}set lineLimit(value){this.internalLineLimit=value}get measureTrailingSpaces(){return void 0!==this.trailingSpaces&&null!=this.trailingSpaces&&this.trailingSpaces}set measureTrailingSpaces(value){this.trailingSpaces=value}get noClip(){return void 0!==this.isNoClip&&null!=this.isNoClip&&this.isNoClip}set noClip(value){this.isNoClip=value}get wordWrap(){return this.wordWrapType}set wordWrap(value){this.wordWrapType=value}get horizontalScalingFactor(){return this.scalingFactor}set horizontalScalingFactor(value){if(value<=0)throw new Error("ArgumentOutOfRangeException:The scaling factor cant be less of equal to zero, ScalingFactor");this.scalingFactor=value}get firstLineIndent(){return void 0===this.initialLineIndent||null==this.initialLineIndent?0:this.initialLineIndent}set firstLineIndent(value){this.initialLineIndent=value}clone(){return this}}let StringTokenizer=(()=>{class StringTokenizer{constructor(textValue){if(this.currentPosition=0,null==textValue)throw new Error("ArgumentNullException:text");this.text=textValue}get length(){return this.text.length}get end(){return this.currentPosition===this.text.length}get position(){return this.currentPosition}set position(value){this.currentPosition=value}static getCharsCount(text,symbols){if("string"==typeof symbols){if(null==text)throw new Error("ArgumentNullException:wholeText");let numSymbols=0,curIndex=0;for(;-1!==(curIndex=text.indexOf(symbols,curIndex));)numSymbols++,curIndex++;return numSymbols}{if(null==text)throw new Error("ArgumentNullException:text");if(null==symbols)throw new Error("ArgumentNullException:symbols");let count=0;for(let i=0,len=text.length;i<len;i++)this.contains(symbols,text[i])&&count++;return count}}readLine(){let pos=this.currentPosition;for(;pos<this.length;){switch(this.text[pos]){case"\r":case"\n":{let text=this.text.substring(this.currentPosition,pos-this.currentPosition);return this.currentPosition=pos+1,this.currentPosition++,text}}pos++}if(pos>this.currentPosition){let text2=this.text.substring(this.currentPosition,pos-this.currentPosition);return this.currentPosition=pos,text2}return null}peekLine(){let pos=this.currentPosition,line=this.readLine();return this.currentPosition=pos,line}readWord(){let pos=this.currentPosition;for(;pos<this.length;){let ch=this.text[pos];switch(ch){case"\r":case"\n":let textValue=this.text.substr(this.currentPosition,pos-this.currentPosition);return this.currentPosition=pos+1,"\r"===ch&&this.currentPosition<this.length&&"\n"===this.text[this.currentPosition]&&this.currentPosition++,textValue;case" ":case"\t":{pos===this.currentPosition&&pos++;let text=this.text.substr(this.currentPosition,pos-this.currentPosition);return this.currentPosition=pos,text}}pos++}if(pos>this.currentPosition){let text2=this.text.substr(this.currentPosition,pos-this.currentPosition);return this.currentPosition=pos,text2}return null}peekWord(){let pos=this.currentPosition,word=this.readWord();return this.currentPosition=pos,word}read(count){if(void 0===count){let ch="0";return this.end||(ch=this.text[this.currentPosition],this.currentPosition++),ch}{let num=0,builder="";for(;!this.end&&num<count;)builder+=this.read(),num++;return builder}}peek(){let ch="0";return this.end||(ch=this.text[this.currentPosition]),ch}close(){this.text=null}readToEnd(){let text;return text=0===this.currentPosition?this.text:this.text.substring(this.length,this.currentPosition),this.currentPosition=this.length,text}static contains(array,symbol){let contains=!1;for(let i=0;i<array.length;i++)if(array[i]===symbol){contains=!0;break}return contains}}return StringTokenizer.whiteSpace=" ",StringTokenizer.tab="\t",StringTokenizer.spaces=[StringTokenizer.whiteSpace,StringTokenizer.tab],StringTokenizer.whiteSpacePattern="^[ \t]+$",StringTokenizer})();class PdfStringLayouter{constructor(){this.isOverloadWithPosition=!1}layout(arg1,arg2,arg3,arg4,arg5,arg6,arg7){if(arg4 instanceof RectangleF){this.initialize(arg1,arg2,arg3,arg4,arg5),this.isOverloadWithPosition=arg6,this.clientSize=arg7;let result=this.doLayout();return this.clear(),result}{this.initialize(arg1,arg2,arg3,arg4),this.isOverloadWithPosition=arg5,this.clientSize=arg6;let result=this.doLayout();return this.clear(),result}}initialize(text,font,format,rectSize,pageHeight){if("number"==typeof pageHeight){if(null==text)throw new Error("ArgumentNullException:text");if(null==font)throw new Error("ArgumentNullException:font");this.text=text,this.font=font,this.format=format,this.size=new SizeF(rectSize.width,rectSize.height),this.rectangle=rectSize,this.pageHeight=pageHeight,this.reader=new StringTokenizer(text)}else this.initialize(text,font,format,new RectangleF(new PointF(0,0),rectSize),0)}clear(){this.font=null,this.format=null,this.reader.close(),this.reader=null,this.text=null}doLayout(){let result=new PdfStringLayoutResult,lineResult=new PdfStringLayoutResult,lines=[],line=this.reader.peekLine(),lineIndent=this.getLineIndent(!0);for(;null!=line;){if(null!==(lineResult=this.layoutLine(line,lineIndent))||void 0!==lineResult){let numSymbolsInserted=0,returnedValue=this.copyToResult(result,lineResult,lines,numSymbolsInserted);if(numSymbolsInserted=returnedValue.numInserted,!returnedValue.success){this.reader.read(numSymbolsInserted);break}}this.reader.readLine(),line=this.reader.peekLine(),lineIndent=this.getLineIndent(!1)}return this.finalizeResult(result,lines),result}getLineIndent(firstLine){let lineIndent=0;return null!=this.format&&(lineIndent=firstLine?this.format.firstLineIndent:this.format.paragraphIndent,lineIndent=this.size.width>0?Math.min(this.size.width,lineIndent):lineIndent),lineIndent}getLineHeight(){let height=this.font.height;return null!=this.format&&0!==this.format.lineSpacing&&(height=this.format.lineSpacing+this.font.height),height}getLineWidth(line){return this.font.getLineWidth(line,this.format)}layoutLine(line,lineIndent){let lineResult=new PdfStringLayoutResult;lineResult.layoutLineHeight=this.getLineHeight();let lines=[],maxWidth=this.size.width,lineWidth=this.getLineWidth(line)+lineIndent,lineType=LineType.FirstParagraphLine,readWord=!0;if(maxWidth<=0||Math.round(lineWidth)<=Math.round(maxWidth))this.addToLineResult(lineResult,lines,line,lineWidth,LineType.NewLineBreak|lineType);else{let builder="",curLine="";lineWidth=lineIndent;let curIndent=lineIndent,reader=new StringTokenizer(line),word=reader.peekWord();for(word.length!==reader.length&&" "===word&&(curLine+=word,builder+=word,reader.position+=1,word=reader.peekWord());null!=word;){let curLineWidth=this.getLineWidth((curLine+=word).toString())+curIndent;if(" "===curLine.toString()&&(curLine="",curLineWidth=0),curLineWidth>maxWidth){if(this.getWrapType()===PdfWordWrapType.None)break;if(curLine.length===word.length){if(this.getWrapType()===PdfWordWrapType.WordOnly){lineResult.textRemainder=line.substring(reader.position);break}if(1===curLine.length){builder+=word;break}readWord=!1,curLine="",word=reader.peek().toString();continue}if(this.getLineWidth(word.toString())>maxWidth?this.format.wordWrap=PdfWordWrapType.Character:null!=this.format&&(this.format.wordWrap=PdfWordWrapType.Word),this.getWrapType()===PdfWordWrapType.Character&&readWord)readWord=!1,curLine="",curLine+=builder.toString(),word=reader.peek().toString();else{let ln=builder.toString();" "!==ln&&this.addToLineResult(lineResult,lines,ln,lineWidth,LineType.LayoutBreak|lineType),this.isOverloadWithPosition&&(maxWidth=this.clientSize.width),curLine="",builder="",lineWidth=0,curIndent=0,curLineWidth=0,lineType=LineType.None,word=readWord?word:reader.peekWord(),readWord=!0}}else builder+=word,lineWidth=curLineWidth,readWord?(reader.readWord(),word=reader.peekWord()):(reader.read(),word=reader.peek().toString())}if(builder.length>0){let ln=builder.toString();this.addToLineResult(lineResult,lines,ln,lineWidth,LineType.NewLineBreak|LineType.LastParagraphLine)}reader.close()}lineResult.layoutLines=[];for(let index=0;index<lines.length;index++)lineResult.layoutLines.push(lines[index]);return lines=[],lineResult}addToLineResult(lineResult,lines,line,lineWidth,breakType){let info=new LineInfo;info.text=line,info.width=lineWidth,info.lineType=breakType,lines.push(info);let size=lineResult.actualSize;size.height+=this.getLineHeight(),size.width=Math.max(size.width,lineWidth),lineResult.size=size}copyToResult(result,lineResult,lines,numInserted){let success=!0,allowPartialLines=null!=this.format&&!this.format.lineLimit,height=result.actualSize.height,maxHeight=this.size.height;if(this.pageHeight>0&&maxHeight+this.rectangle.y>this.pageHeight&&(maxHeight=this.rectangle.y-this.pageHeight,maxHeight=Math.max(maxHeight,-maxHeight)),numInserted=0,null!=lineResult.lines)for(let i=0,len=lineResult.lines.length;i<len;i++){let expHeight=height+lineResult.lineHeight;if(!(expHeight<=maxHeight||maxHeight<=0||allowPartialLines)){success=!1;break}{let info=lineResult.lines[i];numInserted+=info.text.length,info=this.trimLine(info,0===lines.length),lines.push(info);let size=result.actualSize;size.width=Math.max(size.width,info.width),result.size=size,height=expHeight}}if(height!=result.size.height){let size1=result.actualSize;size1.height=height,result.size=size1}return{success:success,numInserted:numInserted}}finalizeResult(result,lines){result.layoutLines=[];for(let index=0;index<lines.length;index++)result.layoutLines.push(lines[index]);result.layoutLineHeight=this.getLineHeight(),this.reader.end||(result.textRemainder=this.reader.readToEnd()),lines=[]}trimLine(info,firstLine){let line=info.text,lineWidth=info.width;return(line=line.trim()).length!==info.text.length&&(lineWidth=this.getLineWidth(line),(info.lineType&LineType.FirstParagraphLine)>0&&(lineWidth+=this.getLineIndent(firstLine))),info.text=line,info.width=lineWidth,info}getWrapType(){return null!=this.format?this.format.wordWrap:PdfWordWrapType.Word}}class PdfStringLayoutResult{get remainder(){return this.textRemainder}get actualSize(){return void 0===this.size&&(this.size=new SizeF(0,0)),this.size}get lines(){return this.layoutLines}get lineHeight(){return this.layoutLineHeight}get empty(){return null==this.layoutLines||0===this.layoutLines.length}get lineCount(){return this.empty?0:this.layoutLines.length}}class LineInfo{get lineType(){return this.type}set lineType(value){this.type=value}get text(){return this.content}set text(value){this.content=value}get width(){return this.lineWidth}set width(value){this.lineWidth=value}}var LineType=function(LineType){return LineType[LineType.None=0]="None",LineType[LineType.NewLineBreak=1]="NewLineBreak",LineType[LineType.LayoutBreak=2]="LayoutBreak",LineType[LineType.FirstParagraphLine=4]="FirstParagraphLine",LineType[LineType.LastParagraphLine=8]="LastParagraphLine",LineType}({});let PdfFont=(()=>{class PdfFont{constructor(size,style){this.fontStyle=PdfFontStyle.Regular,"number"==typeof size&&void 0===style?this.fontSize=size:(this.fontSize=size,this.setStyle(style))}get name(){return this.metrics.name}get size(){return this.fontSize}get height(){return this.metrics.getHeight(null)}get style(){return this.fontStyle}set style(value){this.fontStyle=value}get bold(){return(this.style&PdfFontStyle.Bold)>0}get italic(){return(this.style&PdfFontStyle.Italic)>0}get strikeout(){return(this.style&PdfFontStyle.Strikeout)>0}get underline(){return(this.style&PdfFontStyle.Underline)>0}get metrics(){return this.fontMetrics}set metrics(value){this.fontMetrics=value}get element(){return this.pdfFontInternals}measureString(text,arg2,arg3,arg4,arg5){if("string"==typeof text&&void 0===arg2)return this.measureString(text,null);if("string"==typeof text&&(arg2 instanceof PdfStringFormat||null==arg2)&&void 0===arg3&&void 0===arg4)return this.measureString(text,arg2,0,0);if("string"==typeof text&&(arg2 instanceof PdfStringFormat||null==arg2)&&"number"==typeof arg3&&"number"==typeof arg4)return this.measureString(text,0,arg2,arg3,arg4);if("string"==typeof text&&"number"==typeof arg2&&(arg3 instanceof PdfStringFormat||null==arg3)&&"number"==typeof arg4&&"number"==typeof arg5){let layoutArea=new SizeF(arg2,0);return this.measureString(text,layoutArea,arg3,arg4,arg5)}{if(null==text)throw Error('ArgumentNullException("text")');let temparg2=arg2,temparg3=arg3,result=(new PdfStringLayouter).layout(text,this,temparg3,temparg2,!1,new SizeF(0,0));return arg4=text.length,arg5=result.empty?0:result.lines.length,result.actualSize}}equalsTo(obj){return this.equalsToFont(obj)}getInternals(){return this.pdfFontInternals}setInternals(internals){if(null==internals)throw new Error("ArgumentNullException:internals");this.pdfFontInternals=internals}setStyle(style){this.fontStyle=style}applyFormatSettings(line,format,width){let realWidth=width;return null!=format&&width>0&&(0!==format.characterSpacing&&(realWidth+=(line.length-1)*format.characterSpacing),0!==format.wordSpacing)&&(realWidth+=StringTokenizer.getCharsCount(line,StringTokenizer.spaces)*format.wordSpacing),realWidth}}return PdfFont.charSizeMultiplier=.001,PdfFont.syncObject=new Object,PdfFont})();class PdfWriter{constructor(stream){this.streamWriter=stream}get document(){return this.pdfDocument}set document(value){this.pdfDocument=value}get position(){return this.streamWriter.buffer.size}get length(){return this.streamWriter.buffer.size}get stream(){return this.streamWriter}write(overload){this.streamWriter.write(overload)}}var ObjectStatus=function(ObjectStatus){return ObjectStatus[ObjectStatus.None=0]="None",ObjectStatus[ObjectStatus.Registered=1]="Registered",ObjectStatus}({});class PdfMainObjectCollection{constructor(){this.objectCollections=[],this.mainObjectCollection=new Dictionary,this.primitiveObjectCollection=new Dictionary}get count(){return this.objectCollections.length}items(index){return this.objectCollections[index]}get outIsNew(){return this.isNew}add(element){let objInfo=new ObjectInfo(element);this.objectCollections.push(objInfo),this.primitiveObjectCollection.containsKey(element)||this.primitiveObjectCollection.setValue(element,this.objectCollections.length-1),element.position=this.index=this.objectCollections.length-1,element.status=ObjectStatus.Registered}lookFor(obj){let index=-1;if(-1!==obj.position)return obj.position;if(this.primitiveObjectCollection.containsKey(obj)&&this.count===this.primitiveObjectCollection.size())index=this.primitiveObjectCollection.getValue(obj);else for(let i=this.count-1;i>=0;i--)if(this.objectCollections[i].object===obj){index=i;break}return index}getReference(index,isNew){let reference;return this.index=this.lookFor(index),this.isNew=!1,{reference:reference=this.objectCollections[this.index].reference,wasNew:isNew}}trySetReference(obj,reference,found){return this.index=this.lookFor(obj),this.objectCollections[this.index].setReference(reference),!0}destroy(){for(let obj of this.objectCollections)void 0!==obj&&(obj.pdfObject.position=-1,obj.pdfObject.isSaving=void 0,obj.pdfObject.objectCollectionIndex=void 0,obj.pdfObject.position=void 0);this.objectCollections=[],this.mainObjectCollection=new Dictionary,this.primitiveObjectCollection=new Dictionary}}class ObjectInfo{constructor(obj,reference){this.pdfObject=obj,this.pdfReference=reference}get object(){return this.pdfObject}set object(value){this.pdfObject=value}get reference(){return this.pdfReference}setReference(reference){this.pdfReference=reference}}class ej2_pdf_export_es2015_PdfDocumentBase{constructor(document){this.isStreamCopied=!1,document instanceof PdfDocument&&(this.document=document)}get pdfObjects(){return this.objects}get crossTable(){return this.pdfCrossTable}get currentSavingObj(){return this.currentSavingObject}set currentSavingObj(value){this.currentSavingObject=value}get catalog(){return this.pdfCatalog}set catalog(value){this.pdfCatalog=value}setMainObjectCollection(mainObjectCollection){this.objects=mainObjectCollection}setCrossTable(cTable){this.pdfCrossTable=cTable}setCatalog(catalog){this.pdfCatalog=catalog}save(filename){let encoding=new Encoding(!0),SW=new StreamWriter(encoding);if(void 0===filename){let encoding=new Encoding(!0),SW=new StreamWriter(encoding);return new Promise((resolve,reject)=>{let obj={};obj.blobData=new Blob([this.document.docSave(SW,!0)],{type:"application/pdf"}),resolve(obj)})}this.document.docSave(SW,filename,!0)}clone(){return this.document}}var ObjectType=function(ObjectType){return ObjectType[ObjectType.Free=0]="Free",ObjectType[ObjectType.Normal=1]="Normal",ObjectType[ObjectType.Packed=2]="Packed",ObjectType}({});class PdfCatalog extends PdfDictionary{constructor(){super(),this.sections=null,this.tempDictionaryProperties=new DictionaryProperties,this.items.setValue((new DictionaryProperties).type,new PdfName("Catalog"))}get pages(){return this.sections}set pages(value){this.sections=value,this.items.setValue(this.tempDictionaryProperties.pages,new PdfReferenceHolder(value))}}class PdfCrossTable{constructor(){this.objects=new Dictionary,this.maxGenNumIndex=0,this.objectCount=0,this.dictionaryProperties=new DictionaryProperties}get isMerging(){return this.merging}set isMerging(value){this.merging=value}get trailer(){return null==this.internalTrailer&&(this.internalTrailer=new ej2_pdf_export_es2015_PdfStream),this.internalTrailer}get document(){return this.pdfDocument}set document(value){this.pdfDocument=value,this.items=this.pdfDocument.pdfObjects}get pdfObjects(){return this.items}get objectCollection(){return this.pdfDocument.pdfObjects}get count(){return this.objectCount}set count(value){this.objectCount=value}get nextObjNumber(){return this.count=this.count+1,this.count}save(writer,filename){this.saveHead(writer),this.mappedReferences=null,this.objects.clear(),this.markTrailerReferences(),this.saveObjects(writer);let saveCount=this.count,xrefPos=writer.position;this.registerObject(0,new PdfReference(0,-1),!0),writer.write(Operators.xref),writer.write(Operators.newLine),this.saveSections(writer),this.saveTrailer(writer,this.count,0),this.saveTheEndess(writer,xrefPos),this.count=saveCount;for(let i=0;i<this.objectCollection.count;++i)this.objectCollection.items(i).object.isSaving=!1;if(void 0===filename)return writer.stream.buffer;writer.stream.save(filename)}saveTheEndess(writer,xrefPos){writer.write(Operators.newLine+Operators.startxref+Operators.newLine),writer.write(xrefPos.toString()+Operators.newLine),writer.write(Operators.eof+Operators.newLine)}saveTrailer(writer,count,prevXRef){writer.write(Operators.trailer+Operators.newLine);let trailer=this.trailer;trailer.items.setValue(this.dictionaryProperties.size,new PdfNumber(this.objectCount+1)),(trailer=new PdfDictionary(trailer)).setEncrypt(!1),trailer.save(writer)}saveSections(writer){let objectNum=0,count=0;do{count=this.prepareSubsection(objectNum),this.saveSubsection(writer,objectNum,count),objectNum+=count}while(0!==count)}saveSubsection(writer,objectNum,count){if(!(count<=0||objectNum>=this.count)){writer.write(objectNum+" "+(count+1)+Operators.newLine);for(let i=objectNum;i<=objectNum+count;++i){let obj=this.objects.getValue(i),str="";str=obj.type===ObjectType.Free?this.getItem(obj.offset,65535,!0):this.getItem(obj.offset,obj.generation,!1),writer.write(str)}}}getItem(offset,genNumber,isFree){let returnString="",addOffsetLength=10-offset.toString().length;genNumber<=0&&(genNumber=0);let addGenNumberLength=5-genNumber.toString().length<=0?0:5-genNumber.toString().length;for(let index=0;index<addOffsetLength;index++)returnString+="0";returnString=returnString+offset.toString()+" ";for(let index=0;index<addGenNumberLength;index++)returnString+="0";return(returnString=returnString+genNumber.toString()+" ")+(isFree?Operators.f:Operators.n)+Operators.newLine}prepareSubsection(objectNum){let i,count=0,total=this.count;for(let k=0;k<this.document.pdfObjects.count;k++)this.document.pdfObjects.items(k).reference.toString().split(" ");if(objectNum>=total)return count;for(objectNum=i=objectNum;i<total;++i)++count;return count}markTrailerReferences(){this.trailer.items.keys(),this.trailer.items.values()}saveHead(writer){let version=this.generateFileVersion(writer.document);writer.write("%PDF-"+version),writer.write(Operators.newLine)}generateFileVersion(document){return"1."+4..toString()}getReference(obj,bNew){return void 0===bNew?this.getReference(obj,!1):this.getSubReference(obj,bNew)}getSubReference(obj,bNew){let wasNew,isNew=!1,reference=null;if(this.items.count>0&&obj.objectCollectionIndex>0&&this.items.count>obj.objectCollectionIndex-1){let tempObj=this.document.pdfObjects.getReference(obj,wasNew);reference=tempObj.reference,wasNew=tempObj.wasNew}if(wasNew=null==reference&&obj.status!==ObjectStatus.Registered,null==reference){let found;reference=new PdfReference(this.nextObjNumber,0),wasNew?(this.document.pdfObjects.add(obj),this.document.pdfObjects.trySetReference(obj,reference,found),this.document.pdfObjects.mainObjectCollection.setValue(this.document.pdfObjects.objectCollections[this.document.pdfObjects.count-1].reference.objNumber,this.document.pdfObjects.objectCollections[this.document.pdfObjects.count-1]),obj.position=-1):this.document.pdfObjects.trySetReference(obj,reference,found),obj.objectCollectionIndex=reference.objNumber,obj.status=ObjectStatus.None,isNew=!0}return reference}saveObjects(writer){let objectCollection=this.objectCollection;for(let i=0;i<objectCollection.count;++i){let obj=objectCollection.items(i).object;obj.isSaving=!0,this.saveIndirectObject(obj,writer)}}saveIndirectObject(obj,writer){let reference=this.getReference(obj);obj instanceof PdfCatalog&&this.trailer.items.setValue(this.dictionaryProperties.root,reference),this.pdfDocument.currentSavingObj=reference;let tempArchive=!1;tempArchive=obj.getArchive(),this.registerObject(writer.position,reference),this.doSaveObject(obj,reference,writer)}doSaveObject(obj,reference,writer){writer.write(reference.objNumber.toString()),writer.write(Operators.whiteSpace),writer.write(reference.genNumber.toString()),writer.write(Operators.whiteSpace),writer.write(Operators.obj),writer.write(Operators.newLine),obj.save(writer),writer.write(Operators.endObj),writer.write(Operators.newLine)}registerObject(offset,reference,free){"boolean"==typeof free?(this.objects.setValue(reference.objNumber,new RegisteredObject(offset,reference,free)),this.maxGenNumIndex=Math.max(this.maxGenNumIndex,reference.genNumber)):void 0===free&&(this.objects.setValue(reference.objNumber,new RegisteredObject(offset,reference)),this.maxGenNumIndex=Math.max(this.maxGenNumIndex,reference.genNumber))}static dereference(obj){return null!=obj&&(obj=obj.object),obj}}class RegisteredObject{get objectNumber(){return this.object}get offset(){return this.offsetNumber}constructor(offset,reference,free){this.offsetNumber=offset;let tempReference=reference;this.generation=tempReference.genNumber,this.object=tempReference.objNumber,this.type=void 0===free?ObjectType.Normal:ObjectType.Free}}let PdfPageSize=(()=>{class PdfPageSize{constructor(){}}return PdfPageSize.letter=new SizeF(612,792),PdfPageSize.note=new SizeF(540,720),PdfPageSize.legal=new SizeF(612,1008),PdfPageSize.a0=new SizeF(2380,3368),PdfPageSize.a1=new SizeF(1684,2380),PdfPageSize.a2=new SizeF(1190,1684),PdfPageSize.a3=new SizeF(842,1190),PdfPageSize.a4=new SizeF(595,842),PdfPageSize.a5=new SizeF(421,595),PdfPageSize.a6=new SizeF(297,421),PdfPageSize.a7=new SizeF(210,297),PdfPageSize.a8=new SizeF(148,210),PdfPageSize.a9=new SizeF(105,148),PdfPageSize.a10=new SizeF(74,105),PdfPageSize.b0=new SizeF(2836,4008),PdfPageSize.b1=new SizeF(2004,2836),PdfPageSize.b2=new SizeF(1418,2004),PdfPageSize.b3=new SizeF(1002,1418),PdfPageSize.b4=new SizeF(709,1002),PdfPageSize.b5=new SizeF(501,709),PdfPageSize.archE=new SizeF(2592,3456),PdfPageSize.archD=new SizeF(1728,2592),PdfPageSize.archC=new SizeF(1296,1728),PdfPageSize.archB=new SizeF(864,1296),PdfPageSize.archA=new SizeF(648,864),PdfPageSize.flsa=new SizeF(612,936),PdfPageSize.halfLetter=new SizeF(396,612),PdfPageSize.letter11x17=new SizeF(792,1224),PdfPageSize.ledger=new SizeF(1224,792),PdfPageSize})();var PdfPageOrientation=function(PdfPageOrientation){return PdfPageOrientation[PdfPageOrientation.Portrait=0]="Portrait",PdfPageOrientation[PdfPageOrientation.Landscape=1]="Landscape",PdfPageOrientation}({}),PdfPageRotateAngle=function(PdfPageRotateAngle){return PdfPageRotateAngle[PdfPageRotateAngle.RotateAngle0=0]="RotateAngle0",PdfPageRotateAngle[PdfPageRotateAngle.RotateAngle90=1]="RotateAngle90",PdfPageRotateAngle[PdfPageRotateAngle.RotateAngle180=2]="RotateAngle180",PdfPageRotateAngle[PdfPageRotateAngle.RotateAngle270=3]="RotateAngle270",PdfPageRotateAngle}({}),PdfNumberStyle=function(PdfNumberStyle){return PdfNumberStyle[PdfNumberStyle.None=0]="None",PdfNumberStyle[PdfNumberStyle.Numeric=1]="Numeric",PdfNumberStyle[PdfNumberStyle.LowerLatin=2]="LowerLatin",PdfNumberStyle[PdfNumberStyle.LowerRoman=3]="LowerRoman",PdfNumberStyle[PdfNumberStyle.UpperLatin=4]="UpperLatin",PdfNumberStyle[PdfNumberStyle.UpperRoman=5]="UpperRoman",PdfNumberStyle}({}),PdfDockStyle=function(PdfDockStyle){return PdfDockStyle[PdfDockStyle.None=0]="None",PdfDockStyle[PdfDockStyle.Bottom=1]="Bottom",PdfDockStyle[PdfDockStyle.Top=2]="Top",PdfDockStyle[PdfDockStyle.Left=3]="Left",PdfDockStyle[PdfDockStyle.Right=4]="Right",PdfDockStyle[PdfDockStyle.Fill=5]="Fill",PdfDockStyle}({}),PdfAlignmentStyle=function(PdfAlignmentStyle){return PdfAlignmentStyle[PdfAlignmentStyle.None=0]="None",PdfAlignmentStyle[PdfAlignmentStyle.TopLeft=1]="TopLeft",PdfAlignmentStyle[PdfAlignmentStyle.TopCenter=2]="TopCenter",PdfAlignmentStyle[PdfAlignmentStyle.TopRight=3]="TopRight",PdfAlignmentStyle[PdfAlignmentStyle.MiddleLeft=4]="MiddleLeft",PdfAlignmentStyle[PdfAlignmentStyle.MiddleCenter=5]="MiddleCenter",PdfAlignmentStyle[PdfAlignmentStyle.MiddleRight=6]="MiddleRight",PdfAlignmentStyle[PdfAlignmentStyle.BottomLeft=7]="BottomLeft",PdfAlignmentStyle[PdfAlignmentStyle.BottomCenter=8]="BottomCenter",PdfAlignmentStyle[PdfAlignmentStyle.BottomRight=9]="BottomRight",PdfAlignmentStyle}({}),TemplateType=function(TemplateType){return TemplateType[TemplateType.None=0]="None",TemplateType[TemplateType.Top=1]="Top",TemplateType[TemplateType.Bottom=2]="Bottom",TemplateType[TemplateType.Left=3]="Left",TemplateType[TemplateType.Right=4]="Right",TemplateType}({});class PdfMargins{constructor(){this.pdfMargin=40,this.setMargins(this.pdfMargin)}get left(){return this.leftMargin}set left(value){this.leftMargin=value}get top(){return this.topMargin}set top(value){this.topMargin=value}get right(){return this.rightMargin}set right(value){this.rightMargin=value}get bottom(){return this.bottomMargin}set bottom(value){this.bottomMargin=value}set all(value){this.setMargins(value)}setMargins(margin1,margin2,margin3,margin4){void 0===margin2?this.leftMargin=this.topMargin=this.rightMargin=this.bottomMargin=margin1:void 0===margin3?(this.leftMargin=this.rightMargin=margin1,this.bottomMargin=this.topMargin=margin2):(this.leftMargin=margin1,this.topMargin=margin2,this.rightMargin=margin3,this.bottomMargin=margin4)}clone(){return this}}class PdfPageSettings{constructor(margins){this.pageMargins=new PdfMargins,this.pageSize=PdfPageSize.a4,this.rotateAngle=PdfPageRotateAngle.RotateAngle0,this.pageOrientation=PdfPageOrientation.Portrait,this.pageOrigin=new PointF(0,0),this.isRotation=!1,"number"==typeof margins&&this.pageMargins.setMargins(margins)}get size(){return this.pageSize}set size(value){this.setSize(value)}get orientation(){return this.pageOrientation}set orientation(orientation){this.pageOrientation!==orientation&&(this.pageOrientation=orientation,this.updateSize(orientation))}get margins(){return this.pageMargins}set margins(value){this.pageMargins=value}get width(){return this.pageSize.width}set width(value){this.pageSize.width=value}get height(){return this.pageSize.height}set height(value){this.pageSize.height=value}get origin(){return this.pageOrigin}set origin(value){this.pageOrigin=value}get rotate(){return this.rotateAngle}set rotate(value){this.rotateAngle=value,this.isRotation=!0}updateSize(orientation){let min=Math.min(this.pageSize.width,this.pageSize.height),max=Math.max(this.pageSize.width,this.pageSize.height);switch(orientation){case PdfPageOrientation.Portrait:this.pageSize=new SizeF(min,max);break;case PdfPageOrientation.Landscape:this.pageSize=new SizeF(max,min)}}clone(){return this.pageMargins=this.pageMargins.clone(),this}getActualSize(){return new SizeF(this.width-(this.margins.left+this.margins.right),this.height-(this.margins.top+this.margins.bottom))}setSize(size){let min=Math.min(size.width,size.height),max=Math.max(size.width,size.height);this.pageSize=this.orientation===PdfPageOrientation.Portrait?new SizeF(min,max):new SizeF(max,min)}}class PdfStreamWriter{constructor(stream){if(null==stream)throw new Error("ArgumentNullException:stream");this.stream=stream}clear(){this.stream.clearStream()}setGraphicsState(dictionaryName){dictionaryName instanceof PdfName?(this.stream.write(dictionaryName.toString()),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setGraphicsState)):(this.stream.write(Operators.slash),this.stream.write(dictionaryName),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setGraphicsState))}executeObject(name){this.stream.write(name.toString()),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.paintXObject),this.stream.write(Operators.newLine)}closePath(){this.writeOperator(Operators.closePath)}clipPath(useEvenOddRule){this.stream.write(Operators.clipPath),useEvenOddRule&&this.stream.write(Operators.evenOdd),this.stream.write(Operators.whiteSpace),this.stream.write(Operators.endPath),this.stream.write(Operators.newLine)}closeFillStrokePath(useEvenOddRule){this.stream.write(Operators.closeFillStrokePath),useEvenOddRule?(this.stream.write(Operators.evenOdd),this.stream.write(Operators.newLine)):this.stream.write(Operators.newLine)}fillStrokePath(useEvenOddRule){this.stream.write(Operators.fillStroke),useEvenOddRule?(this.stream.write(Operators.evenOdd),this.stream.write(Operators.newLine)):this.stream.write(Operators.newLine)}fillPath(useEvenOddRule){this.stream.write(Operators.fill),useEvenOddRule?(this.stream.write(Operators.evenOdd),this.stream.write(Operators.newLine)):this.stream.write(Operators.newLine)}endPath(){this.writeOperator(Operators.n)}closeFillPath(useEvenOddRule){this.writeOperator(Operators.closePath),this.stream.write(Operators.fill),useEvenOddRule?(this.stream.write(Operators.evenOdd),this.stream.write(Operators.newLine)):this.stream.write(Operators.newLine)}closeStrokePath(){this.writeOperator(Operators.closeStrokePath)}setTextScaling(textScaling){this.stream.write(PdfNumber.floatToString(textScaling)),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setTextScaling)}strokePath(){this.writeOperator(Operators.stroke)}restoreGraphicsState(){this.writeOperator(Operators.restoreState)}saveGraphicsState(){this.writeOperator(Operators.saveState)}startNextLine(arg1,arg2){void 0===arg1?this.writeOperator(Operators.goToNextLine):arg1 instanceof PointF?(this.writePoint(arg1),this.writeOperator(Operators.setCoords)):(this.writePoint(arg1,arg2),this.writeOperator(Operators.setCoords))}showText(text){this.checkTextParam(text),this.writeText(text),this.writeOperator(Operators.setText)}setLeading(leading){this.stream.write(PdfNumber.floatToString(leading)),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setTextLeading)}beginPath(x,y){this.writePoint(x,y),this.writeOperator(Operators.beginPath)}beginText(){this.writeOperator(Operators.beginText)}endText(){this.writeOperator(Operators.endText)}appendRectangle(arg1,arg2,arg3,arg4){arg1 instanceof RectangleF?this.appendRectangle(arg1.x,arg1.y,arg1.width,arg1.height):(this.writePoint(arg1,arg2),this.writePoint(arg3,arg4),this.writeOperator(Operators.appendRectangle))}appendLineSegment(arg1,arg2){arg1 instanceof PointF?this.appendLineSegment(arg1.x,arg1.y):(this.writePoint(arg1,arg2),this.writeOperator(Operators.appendLineSegment))}setTextRenderingMode(renderingMode){this.stream.write(renderingMode.toString()),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setRenderingMode)}setCharacterSpacing(charSpacing){this.stream.write(PdfNumber.floatToString(charSpacing)),this.stream.write(Operators.whiteSpace),this.stream.write(Operators.setCharacterSpace),this.stream.write(Operators.newLine)}setWordSpacing(wordSpacing){this.stream.write(PdfNumber.floatToString(wordSpacing)),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setWordSpace)}showNextLineText(arg1,arg2){arg1 instanceof PdfString?(this.checkTextParam(arg1),this.writeText(arg1),this.writeOperator(Operators.setTextOnNewLine)):(this.checkTextParam(arg1),this.writeText(arg1,arg2),this.writeOperator(Operators.setTextOnNewLine))}setColorSpace(arg1,arg2){if(arg1 instanceof PdfName&&"boolean"==typeof arg2){let op=arg2?Operators.selectcolorspaceforstroking:Operators.selectcolorspacefornonstroking;this.stream.write(arg1.toString()),this.stream.write(Operators.whiteSpace),this.stream.write(op),this.stream.write(Operators.newLine)}else{let temparg2=arg2;this.setColorSpace(new PdfName(arg1),temparg2)}}modifyCtm(matrix){if(null==matrix)throw new Error("ArgumentNullException:matrix");this.stream.write(matrix.toString()),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.modifyCtm)}setFont(font,name,size){if("string"==typeof name)this.setFont(font,new PdfName(name),size);else{if(null==font)throw new Error("ArgumentNullException:font");this.stream.write(name.toString()),this.stream.write(Operators.whiteSpace),this.stream.write(PdfNumber.floatToString(size)),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setFont)}}writeOperator(opcode){this.stream.write(opcode),this.stream.write(Operators.newLine)}checkTextParam(text){if(null==text)throw new Error("ArgumentNullException:text");if("string"==typeof text&&""===text)throw new Error("ArgumentException:The text can not be an empty string, text")}writeText(arg1,arg2){if(arg1 instanceof PdfString&&void 0===arg2)this.stream.write(arg1.pdfEncode());else{let start,end;arg2?(start=PdfString.hexStringMark[0],end=PdfString.hexStringMark[1]):(start=PdfString.stringMark[0],end=PdfString.stringMark[1]),this.stream.write(start),this.stream.write(arg1),this.stream.write(end)}}writePoint(arg1,arg2){arg1 instanceof PointF&&void 0===arg2?this.writePoint(arg1.x,arg1.y):(this.stream.write(PdfNumber.floatToString(arg1)),this.stream.write(Operators.whiteSpace),arg2=this.updateY(arg2),this.stream.write(PdfNumber.floatToString(arg2)),this.stream.write(Operators.whiteSpace))}updateY(arg){return-arg}write(string){let builder="";builder+=string,this.writeOperator(builder+=Operators.newLine)}writeComment(comment){if(!(null!=comment&&comment.length>0))throw new Error("Invalid comment");{let builder="";builder+=Operators.comment,builder+=Operators.whiteSpace,this.writeOperator(builder+=comment)}}setColorAndSpace(color,colorSpace,forStroking){color.isEmpty||(this.stream.write(color.toString(colorSpace,forStroking)),this.stream.write(Operators.newLine))}setLineDashPattern(pattern,patternOffset){this.setLineDashPatternHelper(pattern,patternOffset)}setLineDashPatternHelper(pattern,patternOffset){let tempPattern="[";if(pattern.length>1)for(let index=0;index<pattern.length;index++)tempPattern+=index===pattern.length-1?pattern[index].toString():pattern[index].toString()+" ";tempPattern+="] ",tempPattern+=patternOffset.toString(),this.stream.write(tempPattern+=" "+Operators.setDashPattern),this.stream.write(Operators.newLine)}setMiterLimit(miterLimit){this.stream.write(PdfNumber.floatToString(miterLimit)),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setMiterLimit)}setLineWidth(width){this.stream.write(PdfNumber.floatToString(width)),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setLineWidth)}setLineCap(lineCapStyle){this.stream.write(lineCapStyle.toString()),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setLineCapStyle)}setLineJoin(lineJoinStyle){this.stream.write(lineJoinStyle.toString()),this.stream.write(Operators.whiteSpace),this.writeOperator(Operators.setLineJoinStyle)}get position(){return this.stream.position}get length(){let returnValue=0;if(0!==this.stream.data.length&&-1!==this.stream.data.length)for(let index=0;index<this.stream.data.length;index++)returnValue+=this.stream.data[index].length;return returnValue}get document(){return null}}class PdfPen{constructor(arg1,arg2){this.pdfColor=new PdfColor(0,0,0),this.dashOffsetValue=0,this.penDashPattern=[0],this.pdfDashStyle=PdfDashStyle.Solid,this.pdfLineCap=0,this.pdfLineJoin=0,this.penWidth=1,this.internalMiterLimit=0,this.colorSpace=PdfColorSpace.Rgb,arg1 instanceof PdfBrush?this.setBrush(arg1):arg1 instanceof PdfColor&&(this.color=arg1),"number"==typeof arg2&&(this.width=arg2)}get color(){return this.pdfColor}set color(value){this.pdfColor=value}get dashOffset(){return void 0===this.dashOffsetValue||null==this.dashOffsetValue?0:this.dashOffsetValue}set dashOffset(value){this.dashOffsetValue=value}get dashPattern(){return this.penDashPattern}set dashPattern(value){this.penDashPattern=value}get dashStyle(){return this.pdfDashStyle}set dashStyle(value){if(this.pdfDashStyle!==value)switch(this.pdfDashStyle=value,this.pdfDashStyle){case PdfDashStyle.Custom:break;case PdfDashStyle.Dash:this.penDashPattern=[3,1];break;case PdfDashStyle.Dot:this.penDashPattern=[1,1];break;case PdfDashStyle.DashDot:this.penDashPattern=[3,1,1,1];break;case PdfDashStyle.DashDotDot:this.penDashPattern=[3,1,1,1,1,1];break;case PdfDashStyle.Solid:break;default:this.pdfDashStyle=PdfDashStyle.Solid,this.penDashPattern=[0]}}get lineCap(){return this.pdfLineCap}set lineCap(value){this.pdfLineCap=value}get lineJoin(){return this.pdfLineJoin}set lineJoin(value){this.pdfLineJoin=value}get miterLimit(){return this.internalMiterLimit}set miterLimit(value){this.internalMiterLimit=value}get width(){return this.penWidth}set width(value){this.penWidth=value}clone(){return this}setBrush(brush){let sBrush=brush;this.color=sBrush.color,this.pdfBrush=sBrush}monitorChanges(currentPen,streamWriter,getResources,saveState,currentColorSpace,matrix){let diff=!1;null==currentPen&&(diff=!0),diff=this.dashControl(currentPen,!0,streamWriter),streamWriter.setLineWidth(this.width),streamWriter.setLineJoin(this.lineJoin),streamWriter.setLineCap(this.lineCap);let miterLimit=this.miterLimit;return miterLimit>0&&(streamWriter.setMiterLimit(miterLimit),diff=!0),streamWriter.setColorAndSpace(this.color,currentColorSpace,!0),!0}dashControl(pen,saveState,streamWriter){let lineWidth=this.width,pattern=this.getPattern();return streamWriter.setLineDashPattern(pattern,this.dashOffset*lineWidth),!0}getPattern(){let pattern=this.dashPattern;for(let i=0;i<pattern.length;++i)pattern[i]*=this.width;return pattern}}let PdfTransformationMatrix=(()=>{class PdfTransformationMatrix{constructor(value){this.radDegFactor=180/Math.PI,this.transformationMatrix=new ej2_pdf_export_es2015_Matrix(1,0,0,void 0===value?1:-1,0,0)}get matrix(){return this.transformationMatrix}set matrix(value){this.transformationMatrix=value}translate(offsetX,offsetY){this.transformationMatrix.translate(offsetX,offsetY)}scale(scaleX,scaleY){this.transformationMatrix.elements[0]=scaleX,this.transformationMatrix.elements[3]=scaleY}rotate(angle){angle=angle*Math.PI/180,this.transformationMatrix.elements[0]=Math.cos(angle),this.transformationMatrix.elements[1]=Math.sin(angle),this.transformationMatrix.elements[2]=-Math.sin(angle),this.transformationMatrix.elements[3]=Math.cos(angle)}toString(){let builder="";for(let i=0,len=this.transformationMatrix.elements.length;i<len;i++)builder+=PdfNumber.floatToString(this.transformationMatrix.elements[i]),builder+=" ";return builder}multiply(matrix){this.transformationMatrix.multiply(matrix.matrix)}static degreesToRadians(degreesX){return this.degRadFactor*degreesX}radiansToDegrees(radians){return this.radDegFactor*radians}clone(){return this}}return PdfTransformationMatrix.degRadFactor=Math.PI/180,PdfTransformationMatrix})();class ej2_pdf_export_es2015_Matrix{constructor(arg1,arg2,arg3,arg4,arg5,arg6){void 0===arg1?this.metrixElements=[]:"number"==typeof arg1?(this.metrixElements=[],this.metrixElements.push(arg1),this.metrixElements.push(arg2),this.metrixElements.push(arg3),this.metrixElements.push(arg4),this.metrixElements.push(arg5),this.metrixElements.push(arg6)):this.metrixElements=arg1}get elements(){return this.metrixElements}get offsetX(){return this.metrixElements[4]}get offsetY(){return this.metrixElements[5]}translate(offsetX,offsetY){this.metrixElements[4]=offsetX,this.metrixElements[5]=offsetY}transform(point){let x=point.x,y=point.y;return new PointF(x*this.elements[0]+y*this.elements[2]+this.offsetX,x*this.elements[1]+y*this.elements[3]+this.offsetY)}multiply(matrix){let tempMatrix=[];tempMatrix.push(this.elements[0]*matrix.elements[0]+this.elements[1]*matrix.elements[2]),tempMatrix[1]=this.elements[0]*matrix.elements[1]+this.elements[1]*matrix.elements[3],tempMatrix[2]=this.elements[2]*matrix.elements[0]+this.elements[3]*matrix.elements[2],tempMatrix[3]=this.elements[2]*matrix.elements[1]+this.elements[3]*matrix.elements[3],tempMatrix[4]=this.offsetX*matrix.elements[0]+this.offsetY*matrix.elements[2]+matrix.offsetX,tempMatrix[5]=this.offsetX*matrix.elements[1]+this.offsetY*matrix.elements[3]+matrix.offsetY;for(let i=0;i<tempMatrix.length;i++)this.elements[i]=tempMatrix[i]}dispose(){this.metrixElements=null}clone(){return new ej2_pdf_export_es2015_Matrix(this.metrixElements)}}class ProcedureSets{constructor(){this.pdf="PDF",this.text="Text",this.imageB="ImageB",this.imageC="ImageC",this.imageI="ImageI"}}class TemporaryDictionary{constructor(){this.mKeys=[],this.mValues=[]}size(){return this.mKeys.length}add(key,value){if(null==key||null==value)throw new ReferenceError("Provided key or value is not valid.");if(this.mKeys.indexOf(key)<0)return this.mKeys.push(key),this.mValues.push(value),1;throw new RangeError("An item with the same key has already been added.")}keys(){return this.mKeys}values(){return this.mValues}getValue(key){if(null==key)throw new ReferenceError("Provided key is not valid.");let index=this.mKeys.indexOf(key);if(index<0)throw new RangeError("No item with the specified key has been added.");return this.mValues[index]}setValue(key,value){if(null==key)throw new ReferenceError("Provided key is not valid.");let index=this.mKeys.indexOf(key);index<0?(this.mKeys.push(key),this.mValues.push(value)):this.mValues[index]=value}remove(key){if(null==key)throw new ReferenceError("Provided key is not valid.");let index=this.mKeys.indexOf(key);if(index<0)throw new RangeError("No item with the specified key has been added.");return this.mKeys.splice(index,1),this.mValues.splice(index,1),!0}containsKey(key){if(null==key)throw new ReferenceError("Provided key is not valid.");return!(this.mKeys.indexOf(key)<0)}clear(){this.mKeys=[],this.mValues=[]}}class PdfTransparency{constructor(stroke,fill,mode){this.dictionary=new PdfDictionary,this.dictionaryProperties=new DictionaryProperties,this.dictionary.items.setValue(this.dictionaryProperties.CA,new PdfNumber(stroke)),this.dictionary.items.setValue(this.dictionaryProperties.ca,new PdfNumber(fill)),this.dictionary.items.setValue(this.dictionaryProperties.BM,new PdfName(mode.toString()))}get element(){return this.dictionary}}class PdfAutomaticFieldInfoCollection{constructor(){this.automaticFieldsInformation=[]}get automaticFields(){return this.automaticFieldsInformation}add(fieldInfo){return this.automaticFields.push(fieldInfo)}}class PdfGraphicsElement{constructor(){}drawHelper(graphics,x,y){let bNeedSave=0!==x||0!==y,gState=null;bNeedSave&&(gState=graphics.save(),graphics.translateTransform(x,y)),this.drawInternal(graphics),bNeedSave&&graphics.restore(gState)}}class PdfAutomaticField extends PdfGraphicsElement{constructor(){super(),this.internalBounds=new RectangleF(0,0,0,0),this.internalTemplateSize=new SizeF(0,0)}get bounds(){return this.internalBounds}set bounds(value){this.internalBounds=value}get size(){return new SizeF(this.bounds.width,this.bounds.height)}set size(value){this.bounds.width=value.width,this.bounds.height=value.height}get location(){return new PointF(this.bounds.x,this.bounds.y)}set location(value){this.bounds.x=value.x,this.bounds.y=value.y}get font(){return this.internalFont}set font(value){this.internalFont=value}get brush(){return this.internalBrush}set brush(value){this.internalBrush=value}get pen(){return this.internalPen}set pen(value){this.internalPen=value}get stringFormat(){return this.internalStringFormat}set stringFormat(value){this.internalStringFormat=value}performDrawHelper(graphics,location,scalingX,scalingY){if(0===this.bounds.height||0===this.bounds.width){let text=this.getValue(graphics);this.internalTemplateSize=this.getFont().measureString(text,this.size,this.stringFormat)}}draw(arg1,arg2,arg3){if(void 0===arg2){let location=new PointF(0,0);this.draw(arg1,location)}else if(arg2 instanceof PointF)this.draw(arg1,arg2.x,arg2.y);else{this.drawHelper(arg1,arg2,arg3);let info=new PdfAutomaticFieldInfo(this,new PointF(arg2,arg3));arg1.automaticFields.add(info)}}getSize(){return 0===this.bounds.height||0===this.bounds.width?this.internalTemplateSize:this.size}drawInternal(graphics){}getBrush(){return void 0===this.internalBrush||null==this.internalBrush?new PdfSolidBrush(new PdfColor(0,0,0)):this.internalBrush}getFont(){return void 0===this.internalFont||null==this.internalFont?PdfDocument.defaultFont:this.internalFont}getPageFromGraphics(graphics){return null!=graphics.page?graphics.page:graphics.currentPage}}class PdfAutomaticFieldInfo{constructor(field,location,scaleX,scaleY){this.pageNumberFieldLocation=new PointF,this.pageNumberField=null,this.scaleX=1,this.scaleY=1,void 0===location&&field instanceof PdfAutomaticFieldInfo?(this.pageNumberField=field.field,this.pageNumberFieldLocation=field.location,this.scaleX=field.scalingX,this.scaleY=field.scalingY):void 0===scaleX&&location instanceof PointF&&field instanceof PdfAutomaticField?(this.pageNumberField=field,this.pageNumberFieldLocation=location):(this.pageNumberField=field,this.pageNumberFieldLocation=location,this.scaleX=scaleX,this.scaleY=scaleY)}get location(){return this.pageNumberFieldLocation}set location(value){this.pageNumberFieldLocation=value}get field(){return this.pageNumberField}set field(value){this.pageNumberField=value}get scalingX(){return this.scaleX}set scalingX(value){this.scaleX=value}get scalingY(){return this.scaleY}set scalingY(value){this.scaleY=value}}class ByteArray{constructor(length){this.mPosition=0,this.buffer=new Uint8Array(length),this.dataView=new DataView(this.buffer.buffer)}get position(){return this.mPosition}set position(value){this.mPosition=value}read(buffer,offset,count){for(let index=offset;index<count;index++)buffer.buffer[index]=this.readByte(this.position),this.position++}getBuffer(index){return this.buffer[index]}writeFromBase64String(base64){let arr=this.encodedString(base64);this.buffer=arr}encodedString(input){let chr1,chr2,chr3,enc1,enc2,enc3,enc4,keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,resultIndex=0,totalLength=3*(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;input.charAt(input.length-1)===keyStr.charAt(64)&&totalLength--;let output=new Uint8Array(0|totalLength);for(;i<input.length;)enc1=keyStr.indexOf(input.charAt(i++)),chr2=(15&(enc2=keyStr.indexOf(input.charAt(i++))))<<4|(enc3=keyStr.indexOf(input.charAt(i++)))>>2,chr3=(3&enc3)<<6|(enc4=keyStr.indexOf(input.charAt(i++))),output[resultIndex++]=chr1=enc1<<2|enc2>>4,output[resultIndex++]=chr2,output[resultIndex++]=chr3;return output}readByte(offset){return this.buffer[offset]}get internalBuffer(){return this.buffer}get count(){return this.buffer.byteLength}}class PdfBoolean{constructor(value){this.currentPosition=-1,this.value=value}get status(){return this.objectStatus}set status(value){this.objectStatus=value}get isSaving(){return this.saving}set isSaving(value){this.saving=value}get objectCollectionIndex(){return this.index}set objectCollectionIndex(value){this.index=value}get position(){return this.currentPosition}set position(value){this.currentPosition=value}get clonedObject(){return null}save(writer){writer.write(this.boolToStr(this.value))}clone(crossTable){return new PdfBoolean(this.value)}boolToStr(value){return value?"true":"false"}}var ImageFormat=function(ImageFormat){return ImageFormat[ImageFormat.Unknown=0]="Unknown",ImageFormat[ImageFormat.Bmp=1]="Bmp",ImageFormat[ImageFormat.Emf=2]="Emf",ImageFormat[ImageFormat.Gif=3]="Gif",ImageFormat[ImageFormat.Jpeg=4]="Jpeg",ImageFormat[ImageFormat.Png=5]="Png",ImageFormat[ImageFormat.Wmf=6]="Wmf",ImageFormat[ImageFormat.Icon=7]="Icon",ImageFormat}({});let ImageDecoder=(()=>{class ImageDecoder{constructor(stream){this.mFormat=ImageFormat.Unknown,this.mbitsPerComponent=8,this.dictionaryProperties=new DictionaryProperties,this.mStream=stream,this.initialize()}get height(){return this.mHeight}get width(){return this.mWidth}get bitsPerComponent(){return this.mbitsPerComponent}get size(){return this.mImageData.count}get imageData(){return this.mImageData}get imageDataAsNumberArray(){return this.mImageData.internalBuffer.buffer}initialize(){this.mFormat===ImageFormat.Unknown&&this.checkIfJpeg()&&(this.mFormat=ImageFormat.Jpeg,this.parseJpegImage()),this.reset(),this.mImageData=new ByteArray(this.mStream.count),this.mStream.read(this.mImageData,0,this.mImageData.count)}reset(){this.mStream.position=0}parseJpegImage(){this.reset();let imgData=new ByteArray(this.mStream.count);this.mStream.read(imgData,0,imgData.count);let i=4;if("J"===String.fromCharCode(imgData.getBuffer(i+2))&&"F"===String.fromCharCode(imgData.getBuffer(i+3))&&"I"===String.fromCharCode(imgData.getBuffer(i+4))&&"F"===String.fromCharCode(imgData.getBuffer(i+5))&&0===imgData.getBuffer(i+6)){let length=256*imgData.getBuffer(i)+imgData.getBuffer(i+1);for(;i+length<imgData.count;){if(192===imgData.getBuffer((i+=length)+1))return this.mHeight=256*imgData.getBuffer(i+5)+imgData.getBuffer(i+6),void(this.mWidth=256*imgData.getBuffer(i+7)+imgData.getBuffer(i+8));length=256*imgData.getBuffer(i+=2)+imgData.getBuffer(i+1)}}}get format(){return this.mFormat}checkIfJpeg(){this.reset();for(let i=0;i<ImageDecoder.mJpegHeader.length;i++){if(ImageDecoder.mJpegHeader[i]!==this.mStream.readByte(i))return!1;this.mStream.position++}return!0}getImageDictionary(){if(this.mFormat===ImageFormat.Jpeg){this.imageStream=new ej2_pdf_export_es2015_PdfStream,this.imageStream.isImage=!0;let tempString="",decodedString="";for(let i=0;i<this.imageDataAsNumberArray.byteLength;i++)tempString+=String.fromCharCode(null,this.mStream.readByte(i));for(let i=0;i<tempString.length;i++)i%2!=0&&(decodedString+=tempString[i]);return this.imageStream.data=[decodedString],this.imageStream.compress=!1,this.imageStream.items.setValue(this.dictionaryProperties.type,new PdfName(this.dictionaryProperties.xObject)),this.imageStream.items.setValue(this.dictionaryProperties.subtype,new PdfName(this.dictionaryProperties.image)),this.imageStream.items.setValue(this.dictionaryProperties.width,new PdfNumber(this.width)),this.imageStream.items.setValue(this.dictionaryProperties.height,new PdfNumber(this.height)),this.imageStream.items.setValue(this.dictionaryProperties.bitsPerComponent,new PdfNumber(this.bitsPerComponent)),this.imageStream.items.setValue(this.dictionaryProperties.filter,new PdfName(this.dictionaryProperties.dctdecode)),this.imageStream.items.setValue(this.dictionaryProperties.colorSpace,new PdfName(this.getColorSpace())),this.imageStream.items.setValue(this.dictionaryProperties.decodeParms,this.getDecodeParams()),this.imageStream}return this.imageStream}getColorSpace(){return this.dictionaryProperties.deviceRgb}getDecodeParams(){let decodeParams=new PdfDictionary;return decodeParams.items.setValue(this.dictionaryProperties.columns,new PdfNumber(this.width)),decodeParams.items.setValue(this.dictionaryProperties.blackIs1,new PdfBoolean(!0)),decodeParams.items.setValue(this.dictionaryProperties.k,new PdfNumber(-1)),decodeParams.items.setValue(this.dictionaryProperties.predictor,new PdfNumber(15)),decodeParams.items.setValue(this.dictionaryProperties.bitsPerComponent,new PdfNumber(this.bitsPerComponent)),decodeParams}}return ImageDecoder.mPngHeader=[137,80,78,71,13,10,26,10],ImageDecoder.mJpegHeader=[255,216],ImageDecoder.GIF_HEADER="G,I,F,8",ImageDecoder.BMP_HEADER="B,M",ImageDecoder})(),PdfUnitConverter=(()=>{class PdfUnitConverter{constructor(dpi){this.updateProportionsHelper(dpi)}convertUnits(value,from,to){return this.convertFromPixels(this.convertToPixels(value,from),to)}convertToPixels(value,from){return value*this.proportions[from]}convertFromPixels(value,to){return value/this.proportions[to]}updateProportionsHelper(pixelPerInch){this.proportions=[pixelPerInch/2.54,pixelPerInch/6,1,pixelPerInch/72,pixelPerInch,pixelPerInch/300,pixelPerInch/25.4]}}return PdfUnitConverter.horizontalResolution=96,PdfUnitConverter.verticalResolution=96,PdfUnitConverter})();class PdfImage{get width(){return this.imageWidth}set width(value){this.imageWidth=value}get height(){return this.imageHeight}set height(value){this.imageHeight=value}set size(value){this.width=value.width,this.height=value.height}get physicalDimension(){return this.imagePhysicalDimension=this.getPointSize(this.width,this.height,this.horizontalResolution,this.verticalResolution),new SizeF(this.width,this.height)}get element(){return this.imageStream}getPointSize(width,height,horizontalResolution,verticalResolution){if(void 0===horizontalResolution)return this.getPointSize(width,height,PdfUnitConverter.horizontalResolution,PdfUnitConverter.verticalResolution);{let ucX=new PdfUnitConverter(horizontalResolution),ucY=new PdfUnitConverter(verticalResolution),ptWidth=ucX.convertUnits(width,PdfGraphicsUnit.Pixel,PdfGraphicsUnit.Point),ptHeight=ucY.convertUnits(height,PdfGraphicsUnit.Pixel,PdfGraphicsUnit.Point);return new SizeF(ptWidth,ptHeight)}}}class PdfBitmap extends PdfImage{constructor(encodedString){super(),this.imageStatus=!0,this.dictionaryProperties=new DictionaryProperties,this.loadImage(encodedString)}loadImage(encodedString){this.initializeAsync(encodedString)}initializeAsync(encodedString){let byteArray=new ByteArray(encodedString.length);byteArray.writeFromBase64String(encodedString),this.decoder=new ImageDecoder(byteArray),this.height=this.decoder.height,this.width=this.decoder.width,this.bitsPerComponent=this.decoder.bitsPerComponent}save(){this.imageStatus=!0,this.imageStream=this.decoder.getImageDictionary()}}class TtfTableInfo{get empty(){return this.offset===this.length&&this.length===this.checksum&&0===this.checksum}}class TtfNameTable{}class TtfNameRecord{}class TtfHeadTable{}class TtfMetrics{get isItalic(){return 0!=(2&this.macStyle)}get isBold(){return 0!=(1&this.macStyle)}}class TtfHorizontalHeaderTable{}class TtfOS2Table{}class TtfPostTable{}class TtfLongHorMetric{}class TtfCmapSubTable{}class TtfCmapTable{}class TtfGlyphInfo{get empty(){return this.index===this.width&&this.width===this.charCode&&0===this.charCode}compareTo(obj){return this.index-obj.index}}class TtfLocaTable{}class TtfAppleCmapSubTable{}class TtfMicrosoftCmapSubTable{}class TtfTrimmedCmapSubTable{}class TtfGlyphHeader{}class BigEndianWriter{constructor(capacity){this.int32Size=4,this.int16Size=2,this.int64Size=8,this.bufferLength=capacity,this.buffer=[]}get data(){if(this.buffer.length<this.bufferLength){let length=this.bufferLength-this.buffer.length;for(let i=0;i<length;i++)this.buffer.push(0)}return this.buffer}get position(){return null==this.internalPosition&&(this.internalPosition=0),this.internalPosition}writeShort(value){this.flush([(65280&value)>>8,255&value])}writeInt(value){this.flush([(4278190080&value)>>24,(16711680&value)>>16,(65280&value)>>8,255&value])}writeUInt(value){this.flush([(4278190080&value)>>24,(16711680&value)>>16,(65280&value)>>8,255&value])}writeString(value){if(null==value)throw new Error("Argument Null Exception : value");let bytes=[];for(let i=0;i<value.length;i++)bytes.push(value.charCodeAt(i));this.flush(bytes)}writeBytes(value){this.flush(value)}flush(buff){if(null===buff)throw new Error("Argument Null Exception : buff");let result=[];for(let i=0;i<this.position;i++)result.push(this.buffer[i]);for(let i=0;i<buff.length;i++)result.push(buff[i]);for(let i=this.position;i<this.buffer.length;i++)result.push(this.buffer[i]);this.buffer=result,this.internalPosition+=buff.length}}class TtfReader{constructor(fontData){this.int32Size=4,this.isTtcFont=!1,this.isMacTtf=!1,this.metricsName="",this.isMacTTF=!1,this.missedGlyphs=0,this.tableNames=["cvt ","fpgm","glyf","head","hhea","hmtx","loca","maxp","prep"],this.entrySelectors=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4],this.fontData=fontData,this.initialize()}get macintosh(){return null==this.macintoshDictionary&&(this.macintoshDictionary=new Dictionary),this.macintoshDictionary}get microsoft(){return null==this.microsoftDictionary&&(this.microsoftDictionary=new Dictionary),this.microsoftDictionary}get macintoshGlyphs(){return null==this.internalMacintoshGlyphs&&(this.internalMacintoshGlyphs=new Dictionary),this.internalMacintoshGlyphs}get microsoftGlyphs(){return null==this.internalMicrosoftGlyphs&&(this.internalMicrosoftGlyphs=new Dictionary),this.internalMicrosoftGlyphs}initialize(){void 0===this.metrics&&(this.metrics=new TtfMetrics),this.readFontDictionary();let nameTable=this.readNameTable(),headTable=this.readHeadTable();this.initializeFontName(nameTable),this.metrics.macStyle=headTable.macStyle}readFontDictionary(){this.offset=0,this.checkPreambula();let numTables=this.readInt16(this.offset);this.readInt16(this.offset),this.readInt16(this.offset),this.readInt16(this.offset),void 0===this.tableDirectory&&(this.tableDirectory=new Dictionary);for(let i=0;i<numTables;++i){let table=new TtfTableInfo,tableKey=this.readString(this.int32Size);table.checksum=this.readInt32(this.offset),table.offset=this.readInt32(this.offset),table.length=this.readInt32(this.offset),this.tableDirectory.setValue(tableKey,table)}this.lowestPosition=this.offset,this.isTtcFont||this.fixOffsets()}fixOffsets(){let minOffset=Number.MAX_VALUE,tableKeys=this.tableDirectory.keys();for(let i=0;i<tableKeys.length;i++){let offset=this.tableDirectory.getValue(tableKeys[i]).offset;if(minOffset>offset&&(minOffset=offset)<=this.lowestPosition)break}let shift=minOffset-this.lowestPosition;if(0!==shift){let table=new Dictionary;for(let i=0;i<tableKeys.length;i++){let value=this.tableDirectory.getValue(tableKeys[i]);value.offset-=shift,table.setValue(tableKeys[i],value)}this.tableDirectory=table}}checkPreambula(){let version=this.readInt32(this.offset);if(this.isMacTtf=1953658213===version,65536!==version&&1953658213!==version&&1330926671!==version){if(this.isTtcFont=!0,this.offset=0,"ttcf"!==this.readString(4))throw new Error("Can not read TTF font data");if(this.offset+=4,this.readInt32(this.offset)<0)throw new Error("Can not read TTF font data");this.offset=this.readInt32(this.offset),version=this.readInt32(this.offset)}return version}readNameTable(){let tableInfo=this.getTable("name");this.offset=tableInfo.offset;let table=new TtfNameTable;table.formatSelector=this.readUInt16(this.offset),table.recordsCount=this.readUInt16(this.offset),table.offset=this.readUInt16(this.offset),table.nameRecords=[];let position=this.offset;for(let i=0;i<table.recordsCount;i++){this.offset=position;let record=new TtfNameRecord;record.platformID=this.readUInt16(this.offset),record.encodingID=this.readUInt16(this.offset),record.languageID=this.readUInt16(this.offset),record.nameID=this.readUInt16(this.offset),record.length=this.readUInt16(this.offset),record.offset=this.readUInt16(this.offset),this.offset=tableInfo.offset+table.offset+record.offset,record.name=this.readString(record.length,0===record.platformID||3===record.platformID),table.nameRecords[i]=record,position+=12}return table}readHeadTable(){let tableInfo=this.getTable("head");this.offset=tableInfo.offset;let table=new TtfHeadTable;return table.version=this.readFixed(this.offset),table.fontRevision=this.readFixed(this.offset),table.checkSumAdjustment=this.readUInt32(this.offset),table.magicNumber=this.readUInt32(this.offset),table.flags=this.readUInt16(this.offset),table.unitsPerEm=this.readUInt16(this.offset),table.created=this.readInt64(this.offset),table.modified=this.readInt64(this.offset),table.xMin=this.readInt16(this.offset),table.yMin=this.readInt16(this.offset),table.xMax=this.readInt16(this.offset),table.yMax=this.readInt16(this.offset),table.macStyle=this.readUInt16(this.offset),table.lowestReadableSize=this.readUInt16(this.offset),table.fontDirectionHint=this.readInt16(this.offset),table.indexToLocalFormat=this.readInt16(this.offset),table.glyphDataFormat=this.readInt16(this.offset),table}readHorizontalHeaderTable(){let tableInfo=this.getTable("hhea");this.offset=tableInfo.offset;let table=new TtfHorizontalHeaderTable;return table.version=this.readFixed(this.offset),table.ascender=this.readInt16(this.offset),table.descender=this.readInt16(this.offset),table.lineGap=this.readInt16(this.offset),table.advanceWidthMax=this.readUInt16(this.offset),table.minLeftSideBearing=this.readInt16(this.offset),table.minRightSideBearing=this.readInt16(this.offset),table.xMaxExtent=this.readInt16(this.offset),table.caretSlopeRise=this.readInt16(this.offset),table.caretSlopeRun=this.readInt16(this.offset),this.offset+=10,table.metricDataFormat=this.readInt16(this.offset),table.numberOfHMetrics=this.readUInt16(this.offset),table}readOS2Table(){let tableInfo=this.getTable("OS/2");this.offset=tableInfo.offset;let table=new TtfOS2Table;return table.version=this.readUInt16(this.offset),table.xAvgCharWidth=this.readInt16(this.offset),table.usWeightClass=this.readUInt16(this.offset),table.usWidthClass=this.readUInt16(this.offset),table.fsType=this.readInt16(this.offset),table.ySubscriptXSize=this.readInt16(this.offset),table.ySubscriptYSize=this.readInt16(this.offset),table.ySubscriptXOffset=this.readInt16(this.offset),table.ySubscriptYOffset=this.readInt16(this.offset),table.ySuperscriptXSize=this.readInt16(this.offset),table.ySuperscriptYSize=this.readInt16(this.offset),table.ySuperscriptXOffset=this.readInt16(this.offset),table.ySuperscriptYOffset=this.readInt16(this.offset),table.yStrikeoutSize=this.readInt16(this.offset),table.yStrikeoutPosition=this.readInt16(this.offset),table.sFamilyClass=this.readInt16(this.offset),table.panose=this.readBytes(10),table.ulUnicodeRange1=this.readUInt32(this.offset),table.ulUnicodeRange2=this.readUInt32(this.offset),table.ulUnicodeRange3=this.readUInt32(this.offset),table.ulUnicodeRange4=this.readUInt32(this.offset),table.vendorIdentifier=this.readBytes(4),table.fsSelection=this.readUInt16(this.offset),table.usFirstCharIndex=this.readUInt16(this.offset),table.usLastCharIndex=this.readUInt16(this.offset),table.sTypoAscender=this.readInt16(this.offset),table.sTypoDescender=this.readInt16(this.offset),table.sTypoLineGap=this.readInt16(this.offset),table.usWinAscent=this.readUInt16(this.offset),table.usWinDescent=this.readUInt16(this.offset),table.ulCodePageRange1=this.readUInt32(this.offset),table.ulCodePageRange2=this.readUInt32(this.offset),table.version>1?(table.sxHeight=this.readInt16(this.offset),table.sCapHeight=this.readInt16(this.offset),table.usDefaultChar=this.readUInt16(this.offset),table.usBreakChar=this.readUInt16(this.offset),table.usMaxContext=this.readUInt16(this.offset)):(table.sxHeight=0,table.sCapHeight=0,table.usDefaultChar=0,table.usBreakChar=0,table.usMaxContext=0),table}readPostTable(){let tableInfo=this.getTable("post");this.offset=tableInfo.offset;let table=new TtfPostTable;return table.formatType=this.readFixed(this.offset),table.italicAngle=this.readFixed(this.offset),table.underlinePosition=this.readInt16(this.offset),table.underlineThickness=this.readInt16(this.offset),table.isFixedPitch=this.readUInt32(this.offset),table.minType42=this.readUInt32(this.offset),table.maxType42=this.readUInt32(this.offset),table.minType1=this.readUInt32(this.offset),table.maxType1=this.readUInt32(this.offset),table}readWidthTable(glyphCount,unitsPerEm){let tableInfo=this.getTable("hmtx");this.offset=tableInfo.offset;let width=[];for(let i=0;i<glyphCount;i++){let glyph=new TtfLongHorMetric;glyph.advanceWidth=this.readUInt16(this.offset),glyph.lsb=this.readInt16(this.offset),width.push(Math.floor(1e3*glyph.advanceWidth/unitsPerEm))}return width}readCmapTable(){let tableInfo=this.getTable("cmap");this.offset=tableInfo.offset;let table=new TtfCmapTable;table.version=this.readUInt16(this.offset),table.tablesCount=this.readUInt16(this.offset);let position=this.offset,subTables=[];for(let i=0;i<table.tablesCount;i++){this.offset=position;let subTable=new TtfCmapSubTable;subTable.platformID=this.readUInt16(this.offset),subTable.encodingID=this.readUInt16(this.offset),subTable.offset=this.readUInt32(this.offset),position=this.offset,this.readCmapSubTable(subTable),subTables[i]=subTable}return subTables}readCmapSubTable(subTable){let tableInfo=this.getTable("cmap");this.offset=tableInfo.offset+subTable.offset;let format=this.readUInt16(this.offset),encoding=this.getCmapEncoding(subTable.platformID,subTable.encodingID);if(encoding!==TtfCmapEncoding.Unknown)switch(format){case TtfCmapFormat.Apple:this.readAppleCmapTable(subTable,encoding);break;case TtfCmapFormat.Microsoft:this.readMicrosoftCmapTable(subTable,encoding);break;case TtfCmapFormat.Trimmed:this.readTrimmedCmapTable(subTable,encoding)}}readAppleCmapTable(subTable,encoding){let tableInfo=this.getTable("cmap");this.offset=tableInfo.offset+subTable.offset;let table=new TtfAppleCmapSubTable;table.format=this.readUInt16(this.offset),table.length=this.readUInt16(this.offset),table.version=this.readUInt16(this.offset),null==this.maxMacIndex&&(this.maxMacIndex=0);for(let i=0;i<256;++i){let glyphInfo=new TtfGlyphInfo;glyphInfo.index=this.readByte(this.offset),glyphInfo.width=this.getWidth(glyphInfo.index),glyphInfo.charCode=i,this.macintosh.setValue(i,glyphInfo),this.addGlyph(glyphInfo,encoding),this.maxMacIndex=Math.max(i,this.maxMacIndex)}}readMicrosoftCmapTable(subTable,encoding){let tableInfo=this.getTable("cmap");this.offset=tableInfo.offset+subTable.offset;let collection=encoding===TtfCmapEncoding.Unicode?this.microsoft:this.macintosh,table=new TtfMicrosoftCmapSubTable;table.format=this.readUInt16(this.offset),table.length=this.readUInt16(this.offset),table.version=this.readUInt16(this.offset),table.segCountX2=this.readUInt16(this.offset),table.searchRange=this.readUInt16(this.offset),table.entrySelector=this.readUInt16(this.offset),table.rangeShift=this.readUInt16(this.offset);let segCount=table.segCountX2/2;table.endCount=this.readUshortArray(segCount),table.reservedPad=this.readUInt16(this.offset),table.startCount=this.readUshortArray(segCount),table.idDelta=this.readUshortArray(segCount),table.idRangeOffset=this.readUshortArray(segCount),table.glyphID=this.readUshortArray(table.length/2-8-4*segCount);let codeOffset=0,index=0;for(let j=0;j<segCount;j++)for(let k=table.startCount[j];k<=table.endCount[j]&&65535!==k;k++){if(0===table.idRangeOffset[j])codeOffset=k+table.idDelta[j]&65535;else{if((index=j+table.idRangeOffset[j]/2-segCount+k-table.startCount[j])>=table.glyphID.length)continue;codeOffset=table.glyphID[index]+table.idDelta[j]&65535}let glyph=new TtfGlyphInfo;glyph.index=codeOffset,glyph.width=this.getWidth(glyph.index);let id=encoding===TtfCmapEncoding.Symbol&&61440==(65280&k)?255&k:k;glyph.charCode=id,collection.setValue(id,glyph),this.addGlyph(glyph,encoding)}}readTrimmedCmapTable(subTable,encoding){let tableInfo=this.getTable("cmap");this.offset=tableInfo.offset+subTable.offset;let table=new TtfTrimmedCmapSubTable;table.format=this.readUInt16(this.offset),table.length=this.readUInt16(this.offset),table.version=this.readUInt16(this.offset),table.firstCode=this.readUInt16(this.offset),table.entryCount=this.readUInt16(this.offset);for(let i=0;i<table.entryCount;++i){let glyphInfo=new TtfGlyphInfo;glyphInfo.index=this.readUInt16(this.offset),glyphInfo.width=this.getWidth(glyphInfo.index),glyphInfo.charCode=i+table.firstCode,this.macintosh.setValue(i,glyphInfo),this.addGlyph(glyphInfo,encoding),this.maxMacIndex=Math.max(i,this.maxMacIndex)}}initializeFontName(nameTable){for(let i=0;i<nameTable.recordsCount;i++){let record=nameTable.nameRecords[i];if(1===record.nameID?this.metrics.fontFamily=record.name:6===record.nameID&&(this.metrics.postScriptName=record.name),null!=this.metrics.fontFamily&&null!=this.metrics.postScriptName)break}}getTable(name){let obj,table=new TtfTableInfo;return this.tableDirectory.containsKey(name)&&(obj=this.tableDirectory.getValue(name)),null!=obj&&(table=obj),table}getWidth(glyphCode){return this.width[glyphCode=glyphCode<this.width.length?glyphCode:this.width.length-1]}getCmapEncoding(platformID,encodingID){let format=TtfCmapEncoding.Unknown;return platformID==TtfPlatformID.Microsoft&&encodingID==TtfMicrosoftEncodingID.Undefined?format=TtfCmapEncoding.Symbol:platformID==TtfPlatformID.Microsoft&&encodingID==TtfMicrosoftEncodingID.Unicode?format=TtfCmapEncoding.Unicode:platformID==TtfPlatformID.Macintosh&&encodingID==TtfMacintoshEncodingID.Roman&&(format=TtfCmapEncoding.Macintosh),format}addGlyph(glyph,encoding){let collection=null;switch(encoding){case TtfCmapEncoding.Unicode:collection=this.microsoftGlyphs;break;case TtfCmapEncoding.Macintosh:case TtfCmapEncoding.Symbol:collection=this.macintoshGlyphs}collection.setValue(glyph.index,glyph)}initializeMetrics(nameTable,headTable,horizontalHeadTable,os2Table,postTable,cmapTables){this.initializeFontName(nameTable);let bSymbol=!1;for(let i=0;i<cmapTables.length;i++){let subTable=cmapTables[i];if(this.getCmapEncoding(subTable.platformID,subTable.encodingID)===TtfCmapEncoding.Symbol){bSymbol=!0;break}}this.metrics.isSymbol=bSymbol,this.metrics.macStyle=headTable.macStyle,this.metrics.isFixedPitch=0!==postTable.isFixedPitch,this.metrics.italicAngle=postTable.italicAngle;let factor=1e3/headTable.unitsPerEm;this.metrics.winAscent=os2Table.sTypoAscender*factor,this.metrics.macAscent=horizontalHeadTable.ascender*factor,this.metrics.capHeight=0!==os2Table.sCapHeight?os2Table.sCapHeight:.7*headTable.unitsPerEm*factor,this.metrics.winDescent=os2Table.sTypoDescender*factor,this.metrics.macDescent=horizontalHeadTable.descender*factor,this.metrics.leading=(os2Table.sTypoAscender-os2Table.sTypoDescender+os2Table.sTypoLineGap)*factor,this.metrics.lineGap=Math.ceil(horizontalHeadTable.lineGap*factor);let left=headTable.xMin*factor,top=Math.ceil(this.metrics.macAscent+this.metrics.lineGap);this.metrics.fontBox=new Rectangle(left,top,headTable.xMax*factor,this.metrics.macDescent),this.metrics.stemV=80,this.metrics.widthTable=this.updateWidth(),this.metrics.contains=this.tableDirectory.containsKey("CFF"),this.metrics.subScriptSizeFactor=headTable.unitsPerEm/os2Table.ySubscriptYSize,this.metrics.superscriptSizeFactor=headTable.unitsPerEm/os2Table.ySuperscriptYSize}updateWidth(){let bytes=[];if(this.metrics.isSymbol)for(let i=0;i<256;i++){let glyphInfo=this.getGlyph(String.fromCharCode(i));bytes[i]=glyphInfo.empty?0:glyphInfo.width}else{let byteToProcess=[],unknown="?",space=String.fromCharCode(32);for(let i=0;i<256;i++){byteToProcess[0]=i;let text=this.getString(byteToProcess,0,byteToProcess.length),glyphInfo=this.getGlyph(text.length>0?text[0]:unknown);glyphInfo.empty?(glyphInfo=this.getGlyph(space),bytes[i]=glyphInfo.empty?0:glyphInfo.width):bytes[i]=glyphInfo.width}}return bytes}getDefaultGlyph(){return this.getGlyph(StringTokenizer.whiteSpace)}getString(byteToProcess,start,length){let result="";for(let index=0;index<length;index++)result+=String.fromCharCode(byteToProcess[index+start]);return result}readLocaTable(bShort){let tableInfo=this.getTable("loca");this.offset=tableInfo.offset;let table=new TtfLocaTable,buffer=null;if(bShort){let len=tableInfo.length/2;buffer=[];for(let i=0;i<len;i++)buffer[i]=2*this.readUInt16(this.offset)}else{let len=tableInfo.length/4;buffer=[];for(let i=0;i<len;i++)buffer[i]=this.readUInt32(this.offset)}return table.offsets=buffer,table}updateGlyphChars(glyphChars,locaTable){glyphChars.containsKey(0)||glyphChars.setValue(0,0);let clone=new Dictionary,glyphCharKeys=glyphChars.keys();for(let i=0;i<glyphCharKeys.length;i++)clone.setValue(glyphCharKeys[i],glyphChars.getValue(glyphCharKeys[i]));for(let i=0;i<glyphCharKeys.length;i++)this.processCompositeGlyph(glyphChars,glyphCharKeys[i],locaTable)}processCompositeGlyph(glyphChars,glyph,locaTable){if(glyph<locaTable.offsets.length-1){let glyphOffset=locaTable.offsets[glyph];if(glyphOffset!==locaTable.offsets[glyph+1]){let tableInfo=this.getTable("glyf");this.offset=tableInfo.offset+glyphOffset;let glyphHeader=new TtfGlyphHeader;if(glyphHeader.numberOfContours=this.readInt16(this.offset),glyphHeader.xMin=this.readInt16(this.offset),glyphHeader.yMin=this.readInt16(this.offset),glyphHeader.xMax=this.readInt16(this.offset),glyphHeader.yMax=this.readInt16(this.offset),glyphHeader.numberOfContours<0){let skipBytes=0,entry=!0;for(;entry;){let flags=this.readUInt16(this.offset),glyphIndex=this.readUInt16(this.offset);if(glyphChars.containsKey(glyphIndex)||glyphChars.setValue(glyphIndex,0),0==(flags&TtfCompositeGlyphFlags.MoreComponents))break;skipBytes=0!=(flags&TtfCompositeGlyphFlags.Arg1And2AreWords)?4:2,0!=(flags&TtfCompositeGlyphFlags.WeHaveScale)?skipBytes+=2:0!=(flags&TtfCompositeGlyphFlags.WeHaveAnXyScale)?skipBytes+=4:0!=(flags&TtfCompositeGlyphFlags.WeHaveTwoByTwo)&&(skipBytes+=8),this.offset+=skipBytes}}}}}generateGlyphTable(glyphChars,locaTable,newLocaTable,newGlyphTable){newLocaTable=[];let activeGlyphs=glyphChars.keys();activeGlyphs.sort((a,b)=>a-b);let glyphSize=0;for(let i=0;i<activeGlyphs.length;i++){let glyphIndex=activeGlyphs[i];locaTable.offsets.length>0&&(glyphSize+=locaTable.offsets[glyphIndex+1]-locaTable.offsets[glyphIndex])}let glyphSizeAligned=this.align(glyphSize);newGlyphTable=[];for(let i=0;i<glyphSizeAligned;i++)newGlyphTable.push(0);let nextGlyphOffset=0,nextGlyphIndex=0,table=this.getTable("glyf");for(let i=0;i<locaTable.offsets.length;i++)if(newLocaTable.push(nextGlyphOffset),nextGlyphIndex<activeGlyphs.length&&activeGlyphs[nextGlyphIndex]===i){++nextGlyphIndex,newLocaTable[i]=nextGlyphOffset;let oldGlyphOffset=locaTable.offsets[i],oldNextGlyphOffset=locaTable.offsets[i+1]-oldGlyphOffset;oldNextGlyphOffset>0&&(this.offset=table.offset+oldGlyphOffset,newGlyphTable=this.read(newGlyphTable,nextGlyphOffset,oldNextGlyphOffset).buffer,nextGlyphOffset+=oldNextGlyphOffset)}return{glyphTableSize:glyphSize,newLocaTable:newLocaTable,newGlyphTable:newGlyphTable}}updateLocaTable(newLocaTable,bLocaIsShort,newLocaTableOut){if(null===newLocaTable)throw new Error("Argument Null Exception : newLocaTable");let size=bLocaIsShort?2*newLocaTable.length:4*newLocaTable.length,count=this.align(size),writer=new BigEndianWriter(count);for(let i=0;i<newLocaTable.length;i++){let value=newLocaTable[i];bLocaIsShort?writer.writeShort(value/=2):writer.writeInt(value)}return{newLocaUpdated:writer.data,newLocaSize:size}}align(value){return value+3&-4}getFontProgram(newLocaTableOut,newGlyphTable,glyphTableSize,locaTableSize){if(null===newLocaTableOut)throw new Error("Argument Null Exception : newLocaTableOut");if(null===newGlyphTable)throw new Error("Argument Null Exception : newGlyphTable");let result=this.getFontProgramLength(newLocaTableOut,newGlyphTable,0),numTables=result.numTables,writer=new BigEndianWriter(result.fontProgramLength);writer.writeInt(65536),writer.writeShort(numTables);let entrySelector=this.entrySelectors[numTables];return writer.writeShort(16*(1<<(31&entrySelector))),writer.writeShort(entrySelector),writer.writeShort(16*(numTables-(1<<(31&entrySelector)))),this.writeCheckSums(writer,numTables,newLocaTableOut,newGlyphTable,glyphTableSize,locaTableSize),this.writeGlyphs(writer,newLocaTableOut,newGlyphTable),writer.data}getFontProgramLength(newLocaTableOut,newGlyphTable,numTables){if(null===newLocaTableOut)throw new Error("Argument Null Exception : newLocaTableOut");if(null===newGlyphTable)throw new Error("Argument Null Exception : newGlyphTable");numTables=2;let tableNames=this.tableNames,fontProgramLength=0;for(let i=0;i<tableNames.length;i++){let tableName=tableNames[i];if("glyf"!==tableName&&"loca"!==tableName){let table=this.getTable(tableName);table.empty||(++numTables,fontProgramLength+=this.align(table.length))}}return fontProgramLength+=newLocaTableOut.length,fontProgramLength+=newGlyphTable.length,{fontProgramLength:fontProgramLength+=16*numTables+12,numTables:numTables}}writeCheckSums(writer,numTables,newLocaTableOut,newGlyphTable,glyphTableSize,locaTableSize){if(null===writer)throw new Error("Argument Null Exception : writer");if(null===newLocaTableOut)throw new Error("Argument Null Exception : newLocaTableOut");if(null===newGlyphTable)throw new Error("Argument Null Exception : newGlyphTable");let tableNames=this.tableNames,usedTablesSize=16*numTables+12,nextTableSize=0;for(let i=0;i<tableNames.length;i++){let tableName=tableNames[i],tableInfo=this.getTable(tableName);if(!tableInfo.empty){if(writer.writeString(tableName),"glyf"===tableName){let checksum=this.calculateCheckSum(newGlyphTable);writer.writeInt(checksum),nextTableSize=glyphTableSize}else if("loca"===tableName){let checksum=this.calculateCheckSum(newLocaTableOut);writer.writeInt(checksum),nextTableSize=locaTableSize}else writer.writeInt(tableInfo.checksum),nextTableSize=tableInfo.length;writer.writeUInt(usedTablesSize),writer.writeUInt(nextTableSize),usedTablesSize+=this.align(nextTableSize)}}}calculateCheckSum(bytes){if(null===bytes)throw new Error("Argument Null Exception : bytes");let pos=0,byte1=0,byte2=0,byte3=0,byte4=0;for(let i=0;i<(bytes.length+1)/4;i++)byte4+=255&bytes[pos++],byte3+=255&bytes[pos++],byte2+=255&bytes[pos++],byte1+=255&bytes[pos++];let result=byte1;return result+=byte2<<8,(result+=byte3<<16)+(byte4<<24)}writeGlyphs(writer,newLocaTable,newGlyphTable){if(null===writer)throw new Error("Argument Null Exception : writer");if(null===newLocaTable)throw new Error("Argument Null Exception : newLocaTableOut");if(null===newGlyphTable)throw new Error("Argument Null Exception : newGlyphTable");let tableNames=this.tableNames;for(let i=0;i<tableNames.length;i++){let tableName=tableNames[i],tableInfo=this.getTable(tableName);if(!tableInfo.empty)if("glyf"===tableName)writer.writeBytes(newGlyphTable);else if("loca"===tableName)writer.writeBytes(newLocaTable);else{let count=this.align(tableInfo.length),buff=[];for(let i=0;i<count;i++)buff.push(0);this.offset=tableInfo.offset;let result=this.read(buff,0,tableInfo.length);writer.writeBytes(result.buffer)}}}setOffset(offset){this.offset=offset}createInternals(){this.metrics=new TtfMetrics;let nameTable=this.readNameTable(),headTable=this.readHeadTable();this.bIsLocaShort=0===headTable.indexToLocalFormat;let horizontalHeadTable=this.readHorizontalHeaderTable(),os2Table=this.readOS2Table(),postTable=this.readPostTable();this.width=this.readWidthTable(horizontalHeadTable.numberOfHMetrics,headTable.unitsPerEm);let subTables=this.readCmapTable();this.initializeMetrics(nameTable,headTable,horizontalHeadTable,os2Table,postTable,subTables)}getGlyph(charCode){if("number"==typeof charCode){let obj1=null;return this.metrics.isSymbol||null==this.microsoftGlyphs?this.metrics.isSymbol&&null!=this.macintoshGlyphs&&this.macintoshGlyphs.containsKey(charCode)&&(obj1=this.macintoshGlyphs.getValue(charCode)):this.microsoftGlyphs.containsKey(charCode)&&(obj1=this.microsoftGlyphs.getValue(charCode)),null!=obj1?obj1:this.getDefaultGlyph()}{let obj=null,code=charCode.charCodeAt(0);return this.metrics.isSymbol||null===this.microsoft?(this.metrics.isSymbol&&null!==this.macintosh||this.isMacTTF)&&(0!==this.maxMacIndex?code%=this.maxMacIndex+1:code=61440==(65280&code)?255&code:code,this.macintosh.containsKey(code)&&(obj=this.macintosh.getValue(code),this.isFontPresent=!0)):this.microsoft.containsKey(code)?(obj=this.microsoft.getValue(code),code!==StringTokenizer.whiteSpace.charCodeAt(0)&&(this.isFontPresent=!0)):code!==StringTokenizer.whiteSpace.charCodeAt(0)&&(this.isFontPresent=!1),charCode===StringTokenizer.whiteSpace&&null===obj&&(obj=new TtfGlyphInfo),null!==obj?obj:this.getDefaultGlyph()}}getGlyphChars(chars){if(null==chars)throw new Error("Argument Null Exception : chars");let dictionary=new Dictionary,charKeys=chars.keys();for(let i=0;i<charKeys.length;i++){let ch=charKeys[i],glyph=this.getGlyph(ch);glyph.empty||dictionary.setValue(glyph.index,ch.charCodeAt(0))}return dictionary}getAllGlyphs(){let allGlyphInfo=[],info=new TtfGlyphInfo,index=0;for(let i=0;i<this.width.length;i++){let width=this.width[i];info.index=index,info.width=width,allGlyphInfo.push(info),index++}return allGlyphInfo}readFontProgram(chars){let glyphChars=this.getGlyphChars(chars),locaTable=this.readLocaTable(this.bIsLocaShort);glyphChars.size()<chars.size()&&(this.missedGlyphs=chars.size()-glyphChars.size()),this.updateGlyphChars(glyphChars,locaTable);let result1=this.generateGlyphTable(glyphChars,locaTable,null,null),glyphTableSize=result1.glyphTableSize,newGlyphTable=result1.newGlyphTable,result2=this.updateLocaTable(result1.newLocaTable,this.bIsLocaShort,null);return this.getFontProgram(result2.newLocaUpdated,newGlyphTable,glyphTableSize,result2.newLocaSize)}convertString(text){if(null===text)throw new Error("Argument Null Exception : text");let glyph="";for(let k=0;k<text.length;k++){let glyphInfo=this.getGlyph(text[k]);glyphInfo.empty||(glyph+=String.fromCharCode(glyphInfo.index))}return glyph}getCharWidth(code){let glyphInfo=this.getGlyph(code);return(glyphInfo=glyphInfo.empty?this.getDefaultGlyph():glyphInfo).empty?0:glyphInfo.width}readString(length,isUnicode){if(void 0===isUnicode)return this.readString(length,!1);{let result="";if(isUnicode)for(let i=0;i<length;i++)i%2!=0&&(result+=String.fromCharCode(this.fontData[this.offset])),this.offset+=1;else for(let i=0;i<length;i++)result+=String.fromCharCode(this.fontData[this.offset]),this.offset+=1;return result}}readFixed(offset){return this.readInt16(offset)+this.readInt16(offset+2)/16384}readInt32(offset){let i1=this.fontData[offset+3],i2=this.fontData[offset+2],i3=this.fontData[offset+1],i4=this.fontData[offset];return this.offset+=4,i1+(i2<<8)+(i3<<16)+(i4<<24)}readUInt32(offset){let i1=this.fontData[offset+3],i2=this.fontData[offset+2],i3=this.fontData[offset+1],i4=this.fontData[offset];return this.offset+=4,i1|i2<<8|i3<<16|i4<<24}readInt16(offset){let result=(this.fontData[offset]<<8)+this.fontData[offset+1];return result=32768&result?result-65536:result,this.offset+=2,result}readInt64(offset){let low=this.readInt32(offset+4),n=4294967296*this.readInt32(offset)+low;return low<0&&(n+=4294967296),n}readUInt16(offset){let result=this.fontData[offset]<<8|this.fontData[offset+1];return this.offset+=2,result}readUshortArray(length){let buffer=[];for(let i=0;i<length;i++)buffer[i]=this.readUInt16(this.offset);return buffer}readBytes(length){let result=[];for(let i=0;i<length;i++)result.push(this.fontData[this.offset]),this.offset+=1;return result}readByte(offset){let result=this.fontData[offset];return this.offset+=1,result}read(buffer,index,count){if(null===buffer)throw new Error("Argument Null Exception : buffer");let written=0,read=0;do{for(let i=0;i<count-written&&this.offset+i<this.fontData.length;i++)buffer[index+i]=this.fontData[this.offset+i];this.offset+=read=count-written,written+=read}while(written<count);return{buffer:buffer,written:written}}}class PdfFontMetrics{constructor(){this.lineGap=0}getAscent(format){return this.ascent*PdfFont.charSizeMultiplier*this.getSize(format)}getDescent(format){return this.descent*PdfFont.charSizeMultiplier*this.getSize(format)}getLineGap(format){return this.lineGap*PdfFont.charSizeMultiplier*this.getSize(format)}getHeight(format){let clearTypeFonts=["cambria","candara","constantia","corbel","cariadings"],clearTypeFontCollection=[];for(let index=0;index<clearTypeFonts.length;index++)clearTypeFontCollection.push(clearTypeFonts[index]);return this.getDescent(format)<0?this.getAscent(format)-this.getDescent(format)+this.getLineGap(format):this.getAscent(format)+this.getDescent(format)+this.getLineGap(format)}getSize(format){let size=this.size;if(null!=format)switch(format.subSuperScript){case PdfSubSuperScript.SubScript:size/=this.subScriptSizeFactor;break;case PdfSubSuperScript.SuperScript:size/=this.superscriptSizeFactor}return size}clone(){return this.widthTable=WidthTable.clone(),this}get widthTable(){return this.internalWidthTable}set widthTable(value){this.internalWidthTable=value}}class WidthTable{static clone(){return null}}class StandardWidthTable extends WidthTable{items(index){if(index<0||index>=this.widths.length)throw new Error("ArgumentOutOfRangeException:index, The character is not supported by the font.");return this.widths[index]}get length(){return this.widths.length}constructor(widths){if(super(),null==widths)throw new Error("ArgumentNullException:widths");this.widths=widths}clone(){return this.widths=this.widths,this}toArray(){return new PdfArray(this.widths)}}class UnicodeTrueTypeFont{constructor(base64String,size){if(this.nameString="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.dictionaryProperties=new DictionaryProperties,this.isCompress=!1,this.isEmbedFont=!1,this.cmapPrefix="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap"+Operators.newLine+"/CIDSystemInfo << /Registry (Adobe)/Ordering (UCS)/Supplement 0>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange"+Operators.newLine,this.cmapEndCodespaceRange="endcodespacerange"+Operators.newLine,this.cmapBeginRange="beginbfrange"+Operators.newLine,this.cmapEndRange="endbfrange"+Operators.newLine,this.cmapSuffix="endbfrange\nendcmap\nCMapName currentdict /CMap defineresource pop\nend end"+Operators.newLine,null==base64String)throw new Error("ArgumentNullException:base64String");this.fontSize=size,this.fontString=base64String,this.Initialize()}getCharWidth(charCode){return this.ttfReader.getCharWidth(charCode)}getLineWidth(line){let width=0;for(let i=0,len=line.length;i<len;i++)width+=this.getCharWidth(line[i]);return width}Initialize(){let byteArray=new ByteArray(this.fontString.length);byteArray.writeFromBase64String(this.fontString),this.fontData=byteArray.internalBuffer,this.ttfReader=new TtfReader(this.fontData),this.ttfMetrics=this.ttfReader.metrics}createInternals(){this.fontDictionary=new PdfDictionary,this.fontProgram=new ej2_pdf_export_es2015_PdfStream,this.cmap=new ej2_pdf_export_es2015_PdfStream,this.descendantFont=new PdfDictionary,this.metrics=new PdfFontMetrics,this.ttfReader.createInternals(),this.ttfMetrics=this.ttfReader.metrics,this.initializeMetrics(),this.subsetName=this.getFontName(),this.createDescendantFont(),this.createCmap(),this.createFontDictionary(),this.createFontProgram()}getInternals(){return this.fontDictionary}initializeMetrics(){let ttfMetrics=this.ttfReader.metrics;this.metrics.ascent=ttfMetrics.macAscent,this.metrics.descent=ttfMetrics.macDescent,this.metrics.height=ttfMetrics.macAscent-ttfMetrics.macDescent+ttfMetrics.lineGap,this.metrics.name=ttfMetrics.fontFamily,this.metrics.postScriptName=ttfMetrics.postScriptName,this.metrics.size=this.fontSize,this.metrics.widthTable=new StandardWidthTable(ttfMetrics.widthTable),this.metrics.lineGap=ttfMetrics.lineGap,this.metrics.subScriptSizeFactor=ttfMetrics.subScriptSizeFactor,this.metrics.superscriptSizeFactor=ttfMetrics.superscriptSizeFactor,this.metrics.isBold=ttfMetrics.isBold}getFontName(){let name,builder="";for(let i=0;i<6;i++){let index=Math.floor(26*Math.random())+0;builder+=this.nameString[index]}return builder+="+",name=(builder+=this.ttfReader.metrics.postScriptName).toString(),this.formatName(name)}formatName(fontName){let ret=fontName.replace("(","#28");return(ret=(ret=(ret=(ret=(ret=(ret=(ret=(ret=(ret=ret.replace(")","#29")).replace("[","#5B")).replace("]","#5D")).replace("<","#3C")).replace(">","#3E")).replace("{","#7B")).replace("}","#7D")).replace("/","#2F")).replace("%","#25")).replace(" ","#20")}createDescendantFont(){this.descendantFont.isFont=!0,this.descendantFont.descendantFontBeginSave=new SaveDescendantFontEventHandler(this),this.descendantFont.items.setValue(this.dictionaryProperties.type,new PdfName(this.dictionaryProperties.font)),this.descendantFont.items.setValue(this.dictionaryProperties.subtype,new PdfName(this.dictionaryProperties.cIDFontType2)),this.descendantFont.items.setValue(this.dictionaryProperties.baseFont,new PdfName(this.subsetName)),this.descendantFont.items.setValue(this.dictionaryProperties.cIDToGIDMap,new PdfName(this.dictionaryProperties.identity)),this.descendantFont.items.setValue(this.dictionaryProperties.dw,new PdfNumber(1e3)),this.fontDescriptor=this.createFontDescriptor(),this.descendantFont.items.setValue(this.dictionaryProperties.fontDescriptor,new PdfReferenceHolder(this.fontDescriptor));let systemInfo=this.createSystemInfo();this.descendantFont.items.setValue(this.dictionaryProperties.cIDSystemInfo,systemInfo)}createFontDescriptor(){let descriptor=new PdfDictionary,metrics=this.ttfReader.metrics;return descriptor.isFont=!0,descriptor.items.setValue(this.dictionaryProperties.type,new PdfName(this.dictionaryProperties.fontDescriptor)),descriptor.items.setValue(this.dictionaryProperties.fontName,new PdfName(this.subsetName)),descriptor.items.setValue(this.dictionaryProperties.flags,new PdfNumber(this.getDescriptorFlags())),descriptor.items.setValue(this.dictionaryProperties.fontBBox,PdfArray.fromRectangle(this.getBoundBox())),descriptor.items.setValue(this.dictionaryProperties.missingWidth,new PdfNumber(metrics.widthTable[32])),descriptor.items.setValue(this.dictionaryProperties.stemV,new PdfNumber(metrics.stemV)),descriptor.items.setValue(this.dictionaryProperties.italicAngle,new PdfNumber(metrics.italicAngle)),descriptor.items.setValue(this.dictionaryProperties.capHeight,new PdfNumber(metrics.capHeight)),descriptor.items.setValue(this.dictionaryProperties.ascent,new PdfNumber(metrics.winAscent)),descriptor.items.setValue(this.dictionaryProperties.descent,new PdfNumber(metrics.winDescent)),descriptor.items.setValue(this.dictionaryProperties.leading,new PdfNumber(metrics.leading)),descriptor.items.setValue(this.dictionaryProperties.avgWidth,new PdfNumber(metrics.widthTable[32])),descriptor.items.setValue(this.dictionaryProperties.fontFile2,new PdfReferenceHolder(this.fontProgram)),descriptor.items.setValue(this.dictionaryProperties.maxWidth,new PdfNumber(metrics.widthTable[32])),descriptor.items.setValue(this.dictionaryProperties.xHeight,new PdfNumber(0)),descriptor.items.setValue(this.dictionaryProperties.stemH,new PdfNumber(0)),descriptor}createCmap(){this.cmap.cmapBeginSave=new SaveCmapEventHandler(this)}createFontDictionary(){this.fontDictionary.isFont=!0,this.fontDictionary.fontDictionaryBeginSave=new SaveFontDictionaryEventHandler(this),this.fontDictionary.items.setValue(this.dictionaryProperties.type,new PdfName(this.dictionaryProperties.font)),this.fontDictionary.items.setValue(this.dictionaryProperties.baseFont,new PdfName(this.subsetName)),this.fontDictionary.items.setValue(this.dictionaryProperties.subtype,new PdfName(this.dictionaryProperties.type0)),this.fontDictionary.items.setValue(this.dictionaryProperties.encoding,new PdfName(this.dictionaryProperties.identityH));let descFonts=new PdfArray,reference=new PdfReferenceHolder(this.descendantFont);descFonts.isFont=!0,descFonts.add(reference),this.fontDictionary.items.setValue(this.dictionaryProperties.descendantFonts,descFonts)}createFontProgram(){this.fontProgram.fontProgramBeginSave=new SaveFontProgramEventHandler(this)}createSystemInfo(){let systemInfo=new PdfDictionary;return systemInfo.items.setValue(this.dictionaryProperties.registry,new PdfString("Adobe")),systemInfo.items.setValue(this.dictionaryProperties.ordering,new PdfString(this.dictionaryProperties.identity)),systemInfo.items.setValue(this.dictionaryProperties.supplement,new PdfNumber(0)),systemInfo}descendantFontBeginSave(){if(null!=this.usedChars&&this.usedChars.size()>0){let width=this.getDescendantWidth();null!==width&&this.descendantFont.items.setValue(this.dictionaryProperties.w,width)}}cmapBeginSave(){this.generateCmap()}fontDictionaryBeginSave(){null!=this.usedChars&&this.usedChars.size()>0&&!this.fontDictionary.containsKey(this.dictionaryProperties.toUnicode)&&this.fontDictionary.items.setValue(this.dictionaryProperties.toUnicode,new PdfReferenceHolder(this.cmap))}fontProgramBeginSave(){this.isCompress=!0,this.generateFontProgram()}getDescendantWidth(){let array=new PdfArray;if(null!=this.usedChars&&this.usedChars.size()>0){let glyphInfo=[],keys=this.usedChars.keys();for(let i=0;i<keys.length;i++){let glyph=this.ttfReader.getGlyph(keys[i]);glyph.empty||glyphInfo.push(glyph)}glyphInfo.sort((a,b)=>a.index-b.index);let firstGlyphIndex=0,lastGlyphIndex=0,firstGlyphIndexWasSet=!1,widthDetails=new PdfArray;for(let i=0;i<glyphInfo.length;i++){let glyph=glyphInfo[i];firstGlyphIndexWasSet||(firstGlyphIndexWasSet=!0,firstGlyphIndex=glyph.index,lastGlyphIndex=glyph.index-1),(lastGlyphIndex+1!==glyph.index||i+1===glyphInfo.length)&&glyphInfo.length>1&&(array.add(new PdfNumber(firstGlyphIndex)),0!==i&&array.add(widthDetails),firstGlyphIndex=glyph.index,widthDetails=new PdfArray),widthDetails.add(new PdfNumber(glyph.width)),i+1===glyphInfo.length&&(array.add(new PdfNumber(firstGlyphIndex)),array.add(widthDetails)),lastGlyphIndex=glyph.index}}return array}generateCmap(){if(null!=this.usedChars&&this.usedChars.size()>0){let glyphChars=this.ttfReader.getGlyphChars(this.usedChars);if(glyphChars.size()>0){let keys=glyphChars.keys().sort(),last=keys[keys.length-1],middlePart=this.toHexString(keys[0],!1)+this.toHexString(last,!1)+Operators.newLine,builder="";builder+=this.cmapPrefix,builder+=middlePart,builder+=this.cmapEndCodespaceRange;let nextRange=0;for(let i=0;i<keys.length;i++){0===nextRange&&(0!==i&&(builder+=this.cmapEndRange),builder+=nextRange=Math.min(100,keys.length-i),builder+=Operators.whiteSpace,builder+=this.cmapBeginRange),nextRange-=1;let key=keys[i];builder+=this.toHexString(key,!0)+this.toHexString(key,!0)+this.toHexString(glyphChars.getValue(key),!0)+"\n"}builder+=this.cmapSuffix,this.cmap.clearStream(),this.cmap.isFont=!0,this.cmap.write(builder)}}}generateFontProgram(){let fontProgram=null;this.usedChars=null==this.usedChars?new Dictionary:this.usedChars,this.ttfReader.setOffset(0),fontProgram=this.ttfReader.readFontProgram(this.usedChars),this.fontProgram.clearStream(),this.fontProgram.isFont=!0,this.fontProgram.writeBytes(fontProgram)}getDescriptorFlags(){let flags=0,metrics=this.ttfReader.metrics;return metrics.isFixedPitch&&(flags|=FontDescriptorFlags.FixedPitch),flags|=metrics.isSymbol?FontDescriptorFlags.Symbolic:FontDescriptorFlags.Nonsymbolic,metrics.isItalic&&(flags|=FontDescriptorFlags.Italic),metrics.isBold&&(flags|=FontDescriptorFlags.ForceBold),flags}getBoundBox(){let rect=this.ttfReader.metrics.fontBox,width=Math.abs(rect.right-rect.left),height=Math.abs(rect.top-rect.bottom);return new RectangleF(rect.left,rect.bottom,width,height)}toHexString(n,isCaseChange){let s=n.toString(16);return isCaseChange&&(s=s.toUpperCase()),"<0000".substring(0,5-s.length)+s+">"}setSymbols(text){if(null===text)throw new Error("Argument Null Exception : text");null==this.usedChars&&(this.usedChars=new Dictionary);for(let i=0;i<text.length;i++)this.usedChars.setValue(text[i],String.fromCharCode(0));!1===this.isEmbedFont&&this.getDescendantWidth()}}class ArabicShapeRenderer{constructor(){this.arabicCharTable=[["ء","ﺀ"],["آ","ﺁ","ﺂ"],["أ","ﺃ","ﺄ"],["ؤ","ﺅ","ﺆ"],["إ","ﺇ","ﺈ"],["ئ","ﺉ","ﺊ","ﺋ","ﺌ"],["ا","ﺍ","ﺎ"],["ب","ﺏ","ﺐ","ﺑ","ﺒ"],["ة","ﺓ","ﺔ"],["ت","ﺕ","ﺖ","ﺗ","ﺘ"],["ث","ﺙ","ﺚ","ﺛ","ﺜ"],["ج","ﺝ","ﺞ","ﺟ","ﺠ"],["ح","ﺡ","ﺢ","ﺣ","ﺤ"],["خ","ﺥ","ﺦ","ﺧ","ﺨ"],["د","ﺩ","ﺪ"],["ذ","ﺫ","ﺬ"],["ر","ﺭ","ﺮ"],["ز","ﺯ","ﺰ"],["س","ﺱ","ﺲ","ﺳ","ﺴ"],["ش","ﺵ","ﺶ","ﺷ","ﺸ"],["ص","ﺹ","ﺺ","ﺻ","ﺼ"],["ض","ﺽ","ﺾ","ﺿ","ﻀ"],["ط","ﻁ","ﻂ","ﻃ","ﻄ"],["ظ","ﻅ","ﻆ","ﻇ","ﻈ"],["ع","ﻉ","ﻊ","ﻋ","ﻌ"],["غ","ﻍ","ﻎ","ﻏ","ﻐ"],["ـ","ـ","ـ","ـ","ـ"],["ف","ﻑ","ﻒ","ﻓ","ﻔ"],["ق","ﻕ","ﻖ","ﻗ","ﻘ"],["ك","ﻙ","ﻚ","ﻛ","ﻜ"],["ل","ﻝ","ﻞ","ﻟ","ﻠ"],["م","ﻡ","ﻢ","ﻣ","ﻤ"],["ن","ﻥ","ﻦ","ﻧ","ﻨ"],["ه","ﻩ","ﻪ","ﻫ","ﻬ"],["و","ﻭ","ﻮ"],["ى","ﻯ","ﻰ","ﯨ","ﯩ"],["ي","ﻱ","ﻲ","ﻳ","ﻴ"],["ٱ","ﭐ","ﭑ"],["ٹ","ﭦ","ﭧ","ﭨ","ﭩ"],["ٺ","ﭞ","ﭟ","ﭠ","ﭡ"],["ٻ","ﭒ","ﭓ","ﭔ","ﭕ"],["پ","ﭖ","ﭗ","ﭘ","ﭙ"],["ٿ","ﭢ","ﭣ","ﭤ","ﭥ"],["ڀ","ﭚ","ﭛ","ﭜ","ﭝ"],["ڃ","ﭶ","ﭷ","ﭸ","ﭹ"],["ڄ","ﭲ","ﭳ","ﭴ","ﭵ"],["چ","ﭺ","ﭻ","ﭼ","ﭽ"],["ڇ","ﭾ","ﭿ","ﮀ","ﮁ"],["ڈ","ﮈ","ﮉ"],["ڌ","ﮄ","ﮅ"],["ڍ","ﮂ","ﮃ"],["ڎ","ﮆ","ﮇ"],["ڑ","ﮌ","ﮍ"],["ژ","ﮊ","ﮋ"],["ڤ","ﭪ","ﭫ","ﭬ","ﭭ"],["ڦ","ﭮ","ﭯ","ﭰ","ﭱ"],["ک","ﮎ","ﮏ","ﮐ","ﮑ"],["ڭ","ﯓ","ﯔ","ﯕ","ﯖ"],["گ","ﮒ","ﮓ","ﮔ","ﮕ"],["ڱ","ﮚ","ﮛ","ﮜ","ﮝ"],["ڳ","ﮖ","ﮗ","ﮘ","ﮙ"],["ں","ﮞ","ﮟ"],["ڻ","ﮠ","ﮡ","ﮢ","ﮣ"],["ھ","ﮪ","ﮫ","ﮬ","ﮭ"],["ۀ","ﮤ","ﮥ"],["ہ","ﮦ","ﮧ","ﮨ","ﮩ"],["ۅ","ﯠ","ﯡ"],["ۆ","ﯙ","ﯚ"],["ۇ","ﯗ","ﯘ"],["ۈ","ﯛ","ﯜ"],["ۉ","ﯢ","ﯣ"],["ۋ","ﯞ","ﯟ"],["ی","ﯼ","ﯽ","ﯾ","ﯿ"],["ې","ﯤ","ﯥ","ﯦ","ﯧ"],["ے","ﮮ","ﮯ"],["ۓ","ﮰ","ﮱ"]],this.alef="ا",this.alefHamza="أ",this.alefHamzaBelow="إ",this.alefMadda="آ",this.lam="ل",this.hamza="ء",this.zeroWidthJoiner="‍",this.hamzaAbove="ٔ",this.hamzaBelow="ٕ",this.wawHamza="ؤ",this.yehHamza="ئ",this.waw="و",this.alefMaksura="ى",this.yeh="ي",this.farsiYeh="ی",this.shadda="ّ",this.madda="ٓ",this.lwa="ﻻ",this.lwawh="ﻷ",this.lwawhb="ﻹ",this.lwawm="ﻵ",this.bwhb="ۓ",this.fathatan="ً",this.superScriptalef="ٰ",this.vowel=1,this.arabicMapTable=new Dictionary;for(let i=0;i<this.arabicCharTable.length;i++)this.arabicMapTable.setValue(this.arabicCharTable[i][0],this.arabicCharTable[i])}getCharacterShape(input,index){if(input>=this.hamza&&input<=this.bwhb){let value=[];if(this.arabicMapTable.getValue(input))return(value=this.arabicMapTable.getValue(input))[index+1]}else if(input>=this.lwawm&&input<=this.lwa)return input;return input}shape(text,level){let builder="",str2="";for(let i=0;i<text.length;i++){let c=text[i];c>="؀"&&c<="ۿ"?str2+=c:(str2.length>0&&(builder+=this.doShape(str2.toString(),0),str2=""),builder+=c)}return str2.length>0&&(builder+=this.doShape(str2.toString(),0)),builder.toString()}doShape(input,level){let str="",ligature=0,len=0,i=0,next="",previous=new ArabicShape,present=new ArabicShape;for(;i<input.length;)if(next=input[i++],0===(ligature=this.ligature(next,present))){let shapeCount=this.getShapeCount(next);len=1===shapeCount?0:2,previous.Shapes>2&&(len+=1),present.Value=this.getCharacterShape(present.Value,len%=present.Shapes),str=this.append(str,previous,level),previous=present,(present=new ArabicShape).Value=next,present.Shapes=shapeCount,present.Ligature++}return len=previous.Shapes>2?1:0,present.Value=this.getCharacterShape(present.Value,len%=present.Shapes),str=this.append(str,previous,level),(str=this.append(str,present,level)).toString()}append(builder,shape,level){return""!==shape.Value&&(builder+=shape.Value,shape.Ligature-=1,""!==shape.Type&&(0==(level&this.vowel)?(builder+=shape.Type,shape.Ligature-=1):shape.Ligature-=1),""!==shape.vowel&&(0==(level&this.vowel)?(builder+=shape.vowel,shape.Ligature-=1):shape.Ligature-=1)),builder}ligature(value,shape){if(""!==shape.Value){let result=0;if(value>=this.fathatan&&value<=this.hamzaBelow||value===this.superScriptalef){if(result=1,""!==shape.vowel&&value!==this.shadda&&(result=2),value===this.shadda){if(null!=shape.Type)return 0;shape.Type=this.shadda}else value===this.hamzaBelow?shape.Value===this.alef?(shape.Value=this.alefHamzaBelow,result=2):value===this.lwa?(shape.Value=this.lwawhb,result=2):shape.Type=this.hamzaBelow:value===this.hamzaAbove?shape.Value===this.alef?(shape.Value=this.alefHamza,result=2):shape.Value===this.lwa?(shape.Value=this.lwawh,result=2):shape.Value===this.waw?(shape.Value=this.wawHamza,result=2):shape.Value===this.yeh||shape.Value===this.alefMaksura||shape.Value===this.farsiYeh?(shape.Value=this.yehHamza,result=2):shape.Type=this.hamzaAbove:value===this.madda?shape.Value===this.alef&&(shape.Value=this.alefMadda,result=2):shape.vowel=value;return 1===result&&shape.Ligature++,result}return""!==shape.vowel?0:(shape.Value===this.lam&&(value===this.alef?(shape.Value=this.lwa,shape.Shapes=2,result=3):value===this.alefHamza?(shape.Value=this.lwawh,shape.Shapes=2,result=3):value===this.alefHamzaBelow?(shape.Value=this.lwawhb,shape.Shapes=2,result=3):value===this.alefMadda&&(shape.Value=this.lwawm,shape.Shapes=2,result=3)),result)}return 0}getShapeCount(shape){if(shape>=this.hamza&&shape<=this.bwhb&&!(shape>=this.fathatan&&shape<=this.hamzaBelow||shape===this.superScriptalef)){let c=[];if(this.arabicMapTable.getValue(shape))return(c=this.arabicMapTable.getValue(shape)).length-1}else if(shape===this.zeroWidthJoiner)return 4;return 1}}class ArabicShape{constructor(){this.shapeValue="",this.shapeType="",this.shapeVowel="",this.shapeLigature=0,this.shapeShapes=1}get Value(){return this.shapeValue}set Value(value){this.shapeValue=value}get Type(){return this.shapeType}set Type(value){this.shapeType=value}get vowel(){return this.shapeVowel}set vowel(value){this.shapeVowel=value}get Ligature(){return this.shapeLigature}set Ligature(value){this.shapeLigature=value}get Shapes(){return this.shapeShapes}set Shapes(value){this.shapeShapes=value}}class Bidi{constructor(){this.indexes=[],this.indexLevels=[],this.mirroringShapeCharacters=new Dictionary,this.update()}doMirrorShaping(text){let result=[];for(let i=0;i<text.length;i++)result[i]=1==(1&this.indexLevels[i])&&this.mirroringShapeCharacters.containsKey(text[i].charCodeAt(0))?String.fromCharCode(this.mirroringShapeCharacters.getValue(text[i].charCodeAt(0))):text[i].toString();let res="";for(let j=0;j<result.length;j++)res+=result[j];return res}getLogicalToVisualString(inputText,isRtl){let rtlCharacters=new RtlCharacters;this.indexLevels=rtlCharacters.getVisualOrder(inputText,isRtl),this.setDefaultIndexLevel(),this.doOrder(0,this.indexLevels.length-1);let text=this.doMirrorShaping(inputText),resultBuilder="";for(let i=0;i<this.indexes.length;i++)resultBuilder+=text[this.indexes[i]];return resultBuilder.toString()}setDefaultIndexLevel(){for(let i=0;i<this.indexLevels.length;i++)this.indexes[i]=i}doOrder(sIndex,eIndex){let max=this.indexLevels[sIndex],min=max,odd=max,even=max;for(let i=sIndex+1;i<=eIndex;++i){let data=this.indexLevels[i];data>max?max=data:data<min&&(min=data),odd&=data,even|=data}if(0!=(1&even))if(1!=(1&odd))for(min|=1;max>=min;){let pstart=sIndex;for(;;){for(;pstart<=eIndex&&!(this.indexLevels[pstart]>=max);)pstart+=1;if(pstart>eIndex)break;let pend=pstart+1;for(;pend<=eIndex&&!(this.indexLevels[pend]<max);)pend+=1;this.reArrange(pstart,pend),pstart=pend+1}max-=1}else this.reArrange(sIndex,eIndex+1)}reArrange(i,j){let length=(i+j)/2;for(--j;i<length;++i,--j){let temp=this.indexes[i];this.indexes[i]=this.indexes[j],this.indexes[j]=temp}}update(){this.mirroringShapeCharacters.setValue(40,41),this.mirroringShapeCharacters.setValue(41,40),this.mirroringShapeCharacters.setValue(60,62),this.mirroringShapeCharacters.setValue(62,60),this.mirroringShapeCharacters.setValue(91,93),this.mirroringShapeCharacters.setValue(93,91),this.mirroringShapeCharacters.setValue(123,125),this.mirroringShapeCharacters.setValue(125,123),this.mirroringShapeCharacters.setValue(171,187),this.mirroringShapeCharacters.setValue(187,171),this.mirroringShapeCharacters.setValue(8249,8250),this.mirroringShapeCharacters.setValue(8250,8249),this.mirroringShapeCharacters.setValue(8261,8262),this.mirroringShapeCharacters.setValue(8262,8261),this.mirroringShapeCharacters.setValue(8317,8318),this.mirroringShapeCharacters.setValue(8318,8317),this.mirroringShapeCharacters.setValue(8333,8334),this.mirroringShapeCharacters.setValue(8334,8333),this.mirroringShapeCharacters.setValue(8712,8715),this.mirroringShapeCharacters.setValue(8713,8716),this.mirroringShapeCharacters.setValue(8714,8717),this.mirroringShapeCharacters.setValue(8715,8712),this.mirroringShapeCharacters.setValue(8716,8713),this.mirroringShapeCharacters.setValue(8717,8714),this.mirroringShapeCharacters.setValue(8725,10741),this.mirroringShapeCharacters.setValue(8764,8765),this.mirroringShapeCharacters.setValue(8765,8764),this.mirroringShapeCharacters.setValue(8771,8909),this.mirroringShapeCharacters.setValue(8786,8787),this.mirroringShapeCharacters.setValue(8787,8786),this.mirroringShapeCharacters.setValue(8788,8789),this.mirroringShapeCharacters.setValue(8789,8788),this.mirroringShapeCharacters.setValue(8804,8805),this.mirroringShapeCharacters.setValue(8805,8804),this.mirroringShapeCharacters.setValue(8806,8807),this.mirroringShapeCharacters.setValue(8807,8806),this.mirroringShapeCharacters.setValue(8808,8809),this.mirroringShapeCharacters.setValue(8809,8808),this.mirroringShapeCharacters.setValue(8810,8811),this.mirroringShapeCharacters.setValue(8811,8810),this.mirroringShapeCharacters.setValue(8814,8815),this.mirroringShapeCharacters.setValue(8815,8814),this.mirroringShapeCharacters.setValue(8816,8817),this.mirroringShapeCharacters.setValue(8817,8816),this.mirroringShapeCharacters.setValue(8818,8819),this.mirroringShapeCharacters.setValue(8819,8818),this.mirroringShapeCharacters.setValue(8820,8821),this.mirroringShapeCharacters.setValue(8821,8820),this.mirroringShapeCharacters.setValue(8822,8823),this.mirroringShapeCharacters.setValue(8823,8822),this.mirroringShapeCharacters.setValue(8824,8825),this.mirroringShapeCharacters.setValue(8825,8824),this.mirroringShapeCharacters.setValue(8826,8827),this.mirroringShapeCharacters.setValue(8827,8826),this.mirroringShapeCharacters.setValue(8828,8829),this.mirroringShapeCharacters.setValue(8829,8828),this.mirroringShapeCharacters.setValue(8830,8831),this.mirroringShapeCharacters.setValue(8831,8830),this.mirroringShapeCharacters.setValue(8832,8833),this.mirroringShapeCharacters.setValue(8833,8832),this.mirroringShapeCharacters.setValue(8834,8835),this.mirroringShapeCharacters.setValue(8835,8834),this.mirroringShapeCharacters.setValue(8836,8837),this.mirroringShapeCharacters.setValue(8837,8836),this.mirroringShapeCharacters.setValue(8838,8839),this.mirroringShapeCharacters.setValue(8839,8838),this.mirroringShapeCharacters.setValue(8840,8841),this.mirroringShapeCharacters.setValue(8841,8840),this.mirroringShapeCharacters.setValue(8842,8843),this.mirroringShapeCharacters.setValue(8843,8842),this.mirroringShapeCharacters.setValue(8847,8848),this.mirroringShapeCharacters.setValue(8848,8847),this.mirroringShapeCharacters.setValue(8849,8850),this.mirroringShapeCharacters.setValue(8850,8849),this.mirroringShapeCharacters.setValue(8856,10680),this.mirroringShapeCharacters.setValue(8866,8867),this.mirroringShapeCharacters.setValue(8867,8866),this.mirroringShapeCharacters.setValue(8870,10974),this.mirroringShapeCharacters.setValue(8872,10980),this.mirroringShapeCharacters.setValue(8873,10979),this.mirroringShapeCharacters.setValue(8875,10981),this.mirroringShapeCharacters.setValue(8880,8881),this.mirroringShapeCharacters.setValue(8881,8880),this.mirroringShapeCharacters.setValue(8882,8883),this.mirroringShapeCharacters.setValue(8883,8882),this.mirroringShapeCharacters.setValue(8884,8885),this.mirroringShapeCharacters.setValue(8885,8884),this.mirroringShapeCharacters.setValue(8886,8887),this.mirroringShapeCharacters.setValue(8887,8886),this.mirroringShapeCharacters.setValue(8905,8906),this.mirroringShapeCharacters.setValue(8906,8905),this.mirroringShapeCharacters.setValue(8907,8908),this.mirroringShapeCharacters.setValue(8908,8907),this.mirroringShapeCharacters.setValue(8909,8771),this.mirroringShapeCharacters.setValue(8912,8913),this.mirroringShapeCharacters.setValue(8913,8912),this.mirroringShapeCharacters.setValue(8918,8919),this.mirroringShapeCharacters.setValue(8919,8918),this.mirroringShapeCharacters.setValue(8920,8921),this.mirroringShapeCharacters.setValue(8921,8920),this.mirroringShapeCharacters.setValue(8922,8923),this.mirroringShapeCharacters.setValue(8923,8922),this.mirroringShapeCharacters.setValue(8924,8925),this.mirroringShapeCharacters.setValue(8925,8924),this.mirroringShapeCharacters.setValue(8926,8927),this.mirroringShapeCharacters.setValue(8927,8926),this.mirroringShapeCharacters.setValue(8928,8929),this.mirroringShapeCharacters.setValue(8929,8928),this.mirroringShapeCharacters.setValue(8930,8931),this.mirroringShapeCharacters.setValue(8931,8930),this.mirroringShapeCharacters.setValue(8932,8933),this.mirroringShapeCharacters.setValue(8933,8932),this.mirroringShapeCharacters.setValue(8934,8935),this.mirroringShapeCharacters.setValue(8935,8934),this.mirroringShapeCharacters.setValue(8936,8937),this.mirroringShapeCharacters.setValue(8937,8936),this.mirroringShapeCharacters.setValue(8938,8939),this.mirroringShapeCharacters.setValue(8939,8938),this.mirroringShapeCharacters.setValue(8940,8941),this.mirroringShapeCharacters.setValue(8941,8940),this.mirroringShapeCharacters.setValue(8944,8945),this.mirroringShapeCharacters.setValue(8945,8944),this.mirroringShapeCharacters.setValue(8946,8954),this.mirroringShapeCharacters.setValue(8947,8955),this.mirroringShapeCharacters.setValue(8948,8956),this.mirroringShapeCharacters.setValue(8950,8957),this.mirroringShapeCharacters.setValue(8951,8958),this.mirroringShapeCharacters.setValue(8954,8946),this.mirroringShapeCharacters.setValue(8955,8947),this.mirroringShapeCharacters.setValue(8956,8948),this.mirroringShapeCharacters.setValue(8957,8950),this.mirroringShapeCharacters.setValue(8958,8951),this.mirroringShapeCharacters.setValue(8968,8969),this.mirroringShapeCharacters.setValue(8969,8968),this.mirroringShapeCharacters.setValue(8970,8971),this.mirroringShapeCharacters.setValue(8971,8970),this.mirroringShapeCharacters.setValue(9001,9002),this.mirroringShapeCharacters.setValue(9002,9001),this.mirroringShapeCharacters.setValue(10088,10089),this.mirroringShapeCharacters.setValue(10089,10088),this.mirroringShapeCharacters.setValue(10090,10091),this.mirroringShapeCharacters.setValue(10091,10090),this.mirroringShapeCharacters.setValue(10092,10093),this.mirroringShapeCharacters.setValue(10093,10092),this.mirroringShapeCharacters.setValue(10094,10095),this.mirroringShapeCharacters.setValue(10095,10094),this.mirroringShapeCharacters.setValue(10096,10097),this.mirroringShapeCharacters.setValue(10097,10096),this.mirroringShapeCharacters.setValue(10098,10099),this.mirroringShapeCharacters.setValue(10099,10098),this.mirroringShapeCharacters.setValue(10100,10101),this.mirroringShapeCharacters.setValue(10101,10100),this.mirroringShapeCharacters.setValue(10197,10198),this.mirroringShapeCharacters.setValue(10198,10197),this.mirroringShapeCharacters.setValue(10205,10206),this.mirroringShapeCharacters.setValue(10206,10205),this.mirroringShapeCharacters.setValue(10210,10211),this.mirroringShapeCharacters.setValue(10211,10210),this.mirroringShapeCharacters.setValue(10212,10213),this.mirroringShapeCharacters.setValue(10213,10212),this.mirroringShapeCharacters.setValue(10214,10215),this.mirroringShapeCharacters.setValue(10215,10214),this.mirroringShapeCharacters.setValue(10216,10217),this.mirroringShapeCharacters.setValue(10217,10216),this.mirroringShapeCharacters.setValue(10218,10219),this.mirroringShapeCharacters.setValue(10219,10218),this.mirroringShapeCharacters.setValue(10627,10628),this.mirroringShapeCharacters.setValue(10628,10627),this.mirroringShapeCharacters.setValue(10629,10630),this.mirroringShapeCharacters.setValue(10630,10629),this.mirroringShapeCharacters.setValue(10631,10632),this.mirroringShapeCharacters.setValue(10632,10631),this.mirroringShapeCharacters.setValue(10633,10634),this.mirroringShapeCharacters.setValue(10634,10633),this.mirroringShapeCharacters.setValue(10635,10636),this.mirroringShapeCharacters.setValue(10636,10635),this.mirroringShapeCharacters.setValue(10637,10640),this.mirroringShapeCharacters.setValue(10638,10639),this.mirroringShapeCharacters.setValue(10639,10638),this.mirroringShapeCharacters.setValue(10640,10637),this.mirroringShapeCharacters.setValue(10641,10642),this.mirroringShapeCharacters.setValue(10642,10641),this.mirroringShapeCharacters.setValue(10643,10644),this.mirroringShapeCharacters.setValue(10644,10643),this.mirroringShapeCharacters.setValue(10645,10646),this.mirroringShapeCharacters.setValue(10646,10645),this.mirroringShapeCharacters.setValue(10647,10648),this.mirroringShapeCharacters.setValue(10648,10647),this.mirroringShapeCharacters.setValue(10680,8856),this.mirroringShapeCharacters.setValue(10688,10689),this.mirroringShapeCharacters.setValue(10689,10688),this.mirroringShapeCharacters.setValue(10692,10693),this.mirroringShapeCharacters.setValue(10693,10692),this.mirroringShapeCharacters.setValue(10703,10704),this.mirroringShapeCharacters.setValue(10704,10703),this.mirroringShapeCharacters.setValue(10705,10706),this.mirroringShapeCharacters.setValue(10706,10705),this.mirroringShapeCharacters.setValue(10708,10709),this.mirroringShapeCharacters.setValue(10709,10708),this.mirroringShapeCharacters.setValue(10712,10713),this.mirroringShapeCharacters.setValue(10713,10712),this.mirroringShapeCharacters.setValue(10714,10715),this.mirroringShapeCharacters.setValue(10715,10714),this.mirroringShapeCharacters.setValue(10741,8725),this.mirroringShapeCharacters.setValue(10744,10745),this.mirroringShapeCharacters.setValue(10745,10744),this.mirroringShapeCharacters.setValue(10748,10749),this.mirroringShapeCharacters.setValue(10749,10748),this.mirroringShapeCharacters.setValue(10795,10796),this.mirroringShapeCharacters.setValue(10796,10795),this.mirroringShapeCharacters.setValue(10797,10796),this.mirroringShapeCharacters.setValue(10798,10797),this.mirroringShapeCharacters.setValue(10804,10805),this.mirroringShapeCharacters.setValue(10805,10804),this.mirroringShapeCharacters.setValue(10812,10813),this.mirroringShapeCharacters.setValue(10813,10812),this.mirroringShapeCharacters.setValue(10852,10853),this.mirroringShapeCharacters.setValue(10853,10852),this.mirroringShapeCharacters.setValue(10873,10874),this.mirroringShapeCharacters.setValue(10874,10873),this.mirroringShapeCharacters.setValue(10877,10878),this.mirroringShapeCharacters.setValue(10878,10877),this.mirroringShapeCharacters.setValue(10879,10880),this.mirroringShapeCharacters.setValue(10880,10879),this.mirroringShapeCharacters.setValue(10881,10882),this.mirroringShapeCharacters.setValue(10882,10881),this.mirroringShapeCharacters.setValue(10883,10884),this.mirroringShapeCharacters.setValue(10884,10883),this.mirroringShapeCharacters.setValue(10891,10892),this.mirroringShapeCharacters.setValue(10892,10891),this.mirroringShapeCharacters.setValue(10897,10898),this.mirroringShapeCharacters.setValue(10898,10897),this.mirroringShapeCharacters.setValue(10899,10900),this.mirroringShapeCharacters.setValue(10900,10899),this.mirroringShapeCharacters.setValue(10901,10902),this.mirroringShapeCharacters.setValue(10902,10901),this.mirroringShapeCharacters.setValue(10903,10904),this.mirroringShapeCharacters.setValue(10904,10903),this.mirroringShapeCharacters.setValue(10905,10906),this.mirroringShapeCharacters.setValue(10906,10905),this.mirroringShapeCharacters.setValue(10907,10908),this.mirroringShapeCharacters.setValue(10908,10907),this.mirroringShapeCharacters.setValue(10913,10914),this.mirroringShapeCharacters.setValue(10914,10913),this.mirroringShapeCharacters.setValue(10918,10919),this.mirroringShapeCharacters.setValue(10919,10918),this.mirroringShapeCharacters.setValue(10920,10921),this.mirroringShapeCharacters.setValue(10921,10920),this.mirroringShapeCharacters.setValue(10922,10923),this.mirroringShapeCharacters.setValue(10923,10922),this.mirroringShapeCharacters.setValue(10924,10925),this.mirroringShapeCharacters.setValue(10925,10924),this.mirroringShapeCharacters.setValue(10927,10928),this.mirroringShapeCharacters.setValue(10928,10927),this.mirroringShapeCharacters.setValue(10931,10932),this.mirroringShapeCharacters.setValue(10932,10931),this.mirroringShapeCharacters.setValue(10939,10940),this.mirroringShapeCharacters.setValue(10940,10939),this.mirroringShapeCharacters.setValue(10941,10942),this.mirroringShapeCharacters.setValue(10942,10941),this.mirroringShapeCharacters.setValue(10943,10944),this.mirroringShapeCharacters.setValue(10944,10943),this.mirroringShapeCharacters.setValue(10945,10946),this.mirroringShapeCharacters.setValue(10946,10945),this.mirroringShapeCharacters.setValue(10947,10948),this.mirroringShapeCharacters.setValue(10948,10947),this.mirroringShapeCharacters.setValue(10949,10950),this.mirroringShapeCharacters.setValue(10950,10949),this.mirroringShapeCharacters.setValue(10957,10958),this.mirroringShapeCharacters.setValue(10958,10957),this.mirroringShapeCharacters.setValue(10959,10960),this.mirroringShapeCharacters.setValue(10960,10959),this.mirroringShapeCharacters.setValue(10961,10962),this.mirroringShapeCharacters.setValue(10962,10961),this.mirroringShapeCharacters.setValue(10963,10964),this.mirroringShapeCharacters.setValue(10964,10963),this.mirroringShapeCharacters.setValue(10965,10966),this.mirroringShapeCharacters.setValue(10966,10965),this.mirroringShapeCharacters.setValue(10974,8870),this.mirroringShapeCharacters.setValue(10979,8873),this.mirroringShapeCharacters.setValue(10980,8872),this.mirroringShapeCharacters.setValue(10981,8875),this.mirroringShapeCharacters.setValue(10988,10989),this.mirroringShapeCharacters.setValue(10989,10988),this.mirroringShapeCharacters.setValue(10999,11e3),this.mirroringShapeCharacters.setValue(11e3,10999),this.mirroringShapeCharacters.setValue(11001,11002),this.mirroringShapeCharacters.setValue(11002,11001),this.mirroringShapeCharacters.setValue(12296,12297),this.mirroringShapeCharacters.setValue(12297,12296),this.mirroringShapeCharacters.setValue(12298,12299),this.mirroringShapeCharacters.setValue(12299,12298),this.mirroringShapeCharacters.setValue(12300,12301),this.mirroringShapeCharacters.setValue(12301,12300),this.mirroringShapeCharacters.setValue(12302,12303),this.mirroringShapeCharacters.setValue(12303,12302),this.mirroringShapeCharacters.setValue(12304,12305),this.mirroringShapeCharacters.setValue(12305,12304),this.mirroringShapeCharacters.setValue(12308,12309),this.mirroringShapeCharacters.setValue(12309,12308),this.mirroringShapeCharacters.setValue(12310,12311),this.mirroringShapeCharacters.setValue(12311,12310),this.mirroringShapeCharacters.setValue(12312,12313),this.mirroringShapeCharacters.setValue(12313,12312),this.mirroringShapeCharacters.setValue(12314,12315),this.mirroringShapeCharacters.setValue(12315,12314),this.mirroringShapeCharacters.setValue(65288,65289),this.mirroringShapeCharacters.setValue(65289,65288),this.mirroringShapeCharacters.setValue(65308,65310),this.mirroringShapeCharacters.setValue(65310,65308),this.mirroringShapeCharacters.setValue(65339,65341),this.mirroringShapeCharacters.setValue(65341,65339),this.mirroringShapeCharacters.setValue(65371,65373),this.mirroringShapeCharacters.setValue(65373,65371),this.mirroringShapeCharacters.setValue(65375,65376),this.mirroringShapeCharacters.setValue(65376,65375),this.mirroringShapeCharacters.setValue(65378,65379),this.mirroringShapeCharacters.setValue(65379,65378)}}class RtlCharacters{constructor(){this.types=[],this.textOrder=-1,this.rtlCharacterTypes=new Array(65536),this.L=0,this.LRE=1,this.LRO=2,this.R=3,this.AL=4,this.RLE=5,this.RLO=6,this.PDF=7,this.EN=8,this.ES=9,this.ET=10,this.AN=11,this.CS=12,this.NSM=13,this.BN=14,this.B=15,this.S=16,this.WS=17,this.ON=18,this.charTypes=[this.L,this.EN,this.BN,this.ES,this.ES,this.S,this.ET,this.ET,this.B,this.AN,this.AN,this.S,this.CS,this.CS,this.WS,this.NSM,this.NSM,this.B,this.BN,27,this.BN,28,30,this.B,31,31,this.S,32,32,this.WS,33,34,this.ON,35,37,this.ET,38,42,this.ON,43,43,this.ET,44,44,this.CS,45,45,this.ET,46,46,this.CS,47,47,this.CS,48,57,this.EN,58,58,this.CS,59,64,this.ON,65,90,this.L,91,96,this.ON,97,122,this.L,123,126,this.ON,127,132,this.BN,133,133,this.B,134,159,this.BN,160,160,this.CS,161,161,this.ON,162,165,this.ET,166,169,this.ON,170,170,this.L,171,175,this.ON,176,177,this.ET,178,179,this.EN,180,180,this.ON,181,181,this.L,182,184,this.ON,185,185,this.EN,186,186,this.L,187,191,this.ON,192,214,this.L,215,215,this.ON,216,246,this.L,247,247,this.ON,248,696,this.L,697,698,this.ON,699,705,this.L,706,719,this.ON,720,721,this.L,722,735,this.ON,736,740,this.L,741,749,this.ON,750,750,this.L,751,767,this.ON,768,855,this.NSM,856,860,this.L,861,879,this.NSM,880,883,this.L,884,885,this.ON,886,893,this.L,894,894,this.ON,895,899,this.L,900,901,this.ON,902,902,this.L,903,903,this.ON,904,1013,this.L,1014,1014,this.ON,1015,1154,this.L,1155,1158,this.NSM,1159,1159,this.L,1160,1161,this.NSM,1162,1417,this.L,1418,1418,this.ON,1419,1424,this.L,1425,1441,this.NSM,1442,1442,this.L,1443,1465,this.NSM,1466,1466,this.L,1467,1469,this.NSM,1470,1470,this.R,1471,1471,this.NSM,1472,1472,this.R,1473,1474,this.NSM,1475,1475,this.R,1476,1476,this.NSM,1477,1487,this.L,1488,1514,this.R,1515,1519,this.L,1520,1524,this.R,1525,1535,this.L,1536,1539,this.AL,1540,1547,this.L,1548,1548,this.CS,1549,1549,this.AL,1550,1551,this.ON,1552,1557,this.NSM,1558,1562,this.L,1563,1563,this.AL,1564,1566,this.L,1567,1567,this.AL,1568,1568,this.L,1569,1594,this.AL,1595,1599,this.L,1600,1610,this.AL,1611,1624,this.NSM,1625,1631,this.L,1632,1641,this.AN,1642,1642,this.ET,1643,1644,this.AN,1645,1647,this.AL,1648,1648,this.NSM,1649,1749,this.AL,1750,1756,this.NSM,1757,1757,this.AL,1758,1764,this.NSM,1765,1766,this.AL,1767,1768,this.NSM,1769,1769,this.ON,1770,1773,this.NSM,1774,1775,this.AL,1776,1785,this.EN,1786,1805,this.AL,1806,1806,this.L,1807,1807,this.BN,1808,1808,this.AL,1809,1809,this.NSM,1810,1839,this.AL,1840,1866,this.NSM,1867,1868,this.L,1869,1871,this.AL,1872,1919,this.L,1920,1957,this.AL,1958,1968,this.NSM,1969,1969,this.AL,1970,2304,this.L,2305,2306,this.NSM,2307,2363,this.L,2364,2364,this.NSM,2365,2368,this.L,2369,2376,this.NSM,2377,2380,this.L,2381,2381,this.NSM,2382,2384,this.L,2385,2388,this.NSM,2389,2401,this.L,2402,2403,this.NSM,2404,2432,this.L,2433,2433,this.NSM,2434,2491,this.L,2492,2492,this.NSM,2493,2496,this.L,2497,2500,this.NSM,2501,2508,this.L,2509,2509,this.NSM,2510,2529,this.L,2530,2531,this.NSM,2532,2545,this.L,2546,2547,this.ET,2548,2560,this.L,2561,2562,this.NSM,2563,2619,this.L,2620,2620,this.NSM,2621,2624,this.L,2625,2626,this.NSM,2627,2630,this.L,2631,2632,this.NSM,2633,2634,this.L,2635,2637,this.NSM,2638,2671,this.L,2672,2673,this.NSM,2674,2688,this.L,2689,2690,this.NSM,2691,2747,this.L,2748,2748,this.NSM,2749,2752,this.L,2753,2757,this.NSM,2758,2758,this.L,2759,2760,this.NSM,2761,2764,this.L,2765,2765,this.NSM,2766,2785,this.L,2786,2787,this.NSM,2788,2800,this.L,2801,2801,this.ET,2802,2816,this.L,2817,2817,this.NSM,2818,2875,this.L,2876,2876,this.NSM,2877,2878,this.L,2879,2879,this.NSM,2880,2880,this.L,2881,2883,this.NSM,2884,2892,this.L,2893,2893,this.NSM,2894,2901,this.L,2902,2902,this.NSM,2903,2945,this.L,2946,2946,this.NSM,2947,3007,this.L,3008,3008,this.NSM,3009,3020,this.L,3021,3021,this.NSM,3022,3058,this.L,3059,3064,this.ON,3065,3065,this.ET,3066,3066,this.ON,3067,3133,this.L,3134,3136,this.NSM,3137,3141,this.L,3142,3144,this.NSM,3145,3145,this.L,3146,3149,this.NSM,3150,3156,this.L,3157,3158,this.NSM,3159,3259,this.L,3260,3260,this.NSM,3261,3275,this.L,3276,3277,this.NSM,3278,3392,this.L,3393,3395,this.NSM,3396,3404,this.L,3405,3405,this.NSM,3406,3529,this.L,3530,3530,this.NSM,3531,3537,this.L,3538,3540,this.NSM,3541,3541,this.L,3542,3542,this.NSM,3543,3632,this.L,3633,3633,this.NSM,3634,3635,this.L,3636,3642,this.NSM,3643,3646,this.L,3647,3647,this.ET,3648,3654,this.L,3655,3662,this.NSM,3663,3760,this.L,3761,3761,this.NSM,3762,3763,this.L,3764,3769,this.NSM,3770,3770,this.L,3771,3772,this.NSM,3773,3783,this.L,3784,3789,this.NSM,3790,3863,this.L,3864,3865,this.NSM,3866,3892,this.L,3893,3893,this.NSM,3894,3894,this.L,3895,3895,this.NSM,3896,3896,this.L,3897,3897,this.NSM,3898,3901,this.ON,3902,3952,this.L,3953,3966,this.NSM,3967,3967,this.L,3968,3972,this.NSM,3973,3973,this.L,3974,3975,this.NSM,3976,3983,this.L,3984,3991,this.NSM,3992,3992,this.L,3993,4028,this.NSM,4029,4037,this.L,4038,4038,this.NSM,4039,4140,this.L,4141,4144,this.NSM,4145,4145,this.L,4146,4146,this.NSM,4147,4149,this.L,4150,4151,this.NSM,4152,4152,this.L,4153,4153,this.NSM,4154,4183,this.L,4184,4185,this.NSM,4186,5759,this.L,5760,5760,this.WS,5761,5786,this.L,5787,5788,this.ON,5789,5905,this.L,5906,5908,this.NSM,5909,5937,this.L,5938,5940,this.NSM,5941,5969,this.L,5970,5971,this.NSM,5972,6001,this.L,6002,6003,this.NSM,6004,6070,this.L,6071,6077,this.NSM,6078,6085,this.L,6086,6086,this.NSM,6087,6088,this.L,6089,6099,this.NSM,6100,6106,this.L,6107,6107,this.ET,6108,6108,this.L,6109,6109,this.NSM,6110,6127,this.L,6128,6137,this.ON,6138,6143,this.L,6144,6154,this.ON,6155,6157,this.NSM,6158,6158,this.WS,6159,6312,this.L,6313,6313,this.NSM,6314,6431,this.L,6432,6434,this.NSM,6435,6438,this.L,6439,6443,this.NSM,6444,6449,this.L,6450,6450,this.NSM,6451,6456,this.L,6457,6459,this.NSM,6460,6463,this.L,6464,6464,this.ON,6465,6467,this.L,6468,6469,this.ON,6470,6623,this.L,6624,6655,this.ON,6656,8124,this.L,8125,8125,this.ON,8126,8126,this.L,8127,8129,this.ON,8130,8140,this.L,8141,8143,this.ON,8144,8156,this.L,8157,8159,this.ON,8160,8172,this.L,8173,8175,this.ON,8176,8188,this.L,8189,8190,this.ON,8191,8191,this.L,8192,8202,this.WS,8203,8205,this.BN,8206,8206,this.L,8207,8207,this.R,8208,8231,this.ON,8232,8232,this.WS,8233,8233,this.B,8234,8234,this.LRE,8235,8235,this.RLE,8236,8236,this.PDF,8237,8237,this.LRO,8238,8238,this.RLO,8239,8239,this.WS,8240,8244,this.ET,8245,8276,this.ON,8277,8278,this.L,8279,8279,this.ON,8280,8286,this.L,8287,8287,this.WS,8288,8291,this.BN,8292,8297,this.L,8298,8303,this.BN,8304,8304,this.EN,8305,8307,this.L,8308,8313,this.EN,8314,8315,this.ET,8316,8318,this.ON,8319,8319,this.L,8320,8329,this.EN,8330,8331,this.ET,8332,8334,this.ON,8335,8351,this.L,8352,8369,this.ET,8370,8399,this.L,8400,8426,this.NSM,8427,8447,this.L,8448,8449,this.ON,8450,8450,this.L,8451,8454,this.ON,8455,8455,this.L,8456,8457,this.ON,8458,8467,this.L,8468,8468,this.ON,8469,8469,this.L,8470,8472,this.ON,8473,8477,this.L,8478,8483,this.ON,8484,8484,this.L,8485,8485,this.ON,8486,8486,this.L,8487,8487,this.ON,8488,8488,this.L,8489,8489,this.ON,8490,8493,this.L,8494,8494,this.ET,8495,8497,this.L,8498,8498,this.ON,8499,8505,this.L,8506,8507,this.ON,8508,8511,this.L,8512,8516,this.ON,8517,8521,this.L,8522,8523,this.ON,8524,8530,this.L,8531,8543,this.ON,8544,8591,this.L,8592,8721,this.ON,8722,8723,this.ET,8724,9013,this.ON,9014,9082,this.L,9083,9108,this.ON,9109,9109,this.L,9110,9168,this.ON,9169,9215,this.L,9216,9254,this.ON,9255,9279,this.L,9280,9290,this.ON,9291,9311,this.L,9312,9371,this.EN,9372,9449,this.L,9450,9450,this.EN,9451,9751,this.ON,9752,9752,this.L,9753,9853,this.ON,9854,9855,this.L,9856,9873,this.ON,9874,9887,this.L,9888,9889,this.ON,9890,9984,this.L,9985,9988,this.ON,9989,9989,this.L,9990,9993,this.ON,9994,9995,this.L,9996,10023,this.ON,10024,10024,this.L,10025,10059,this.ON,10060,10060,this.L,10061,10061,this.ON,10062,10062,this.L,10063,10066,this.ON,10067,10069,this.L,10070,10070,this.ON,10071,10071,this.L,10072,10078,this.ON,10079,10080,this.L,10081,10132,this.ON,10133,10135,this.L,10136,10159,this.ON,10160,10160,this.L,10161,10174,this.ON,10175,10191,this.L,10192,10219,this.ON,10220,10223,this.L,10224,11021,this.ON,11022,11903,this.L,11904,11929,this.ON,11930,11930,this.L,11931,12019,this.ON,12020,12031,this.L,12032,12245,this.ON,12246,12271,this.L,12272,12283,this.ON,12284,12287,this.L,12288,12288,this.WS,12289,12292,this.ON,12293,12295,this.L,12296,12320,this.ON,12321,12329,this.L,12330,12335,this.NSM,12336,12336,this.ON,12337,12341,this.L,12342,12343,this.ON,12344,12348,this.L,12349,12351,this.ON,12352,12440,this.L,12441,12442,this.NSM,12443,12444,this.ON,12445,12447,this.L,12448,12448,this.ON,12449,12538,this.L,12539,12539,this.ON,12540,12828,this.L,12829,12830,this.ON,12831,12879,this.L,12880,12895,this.ON,12896,12923,this.L,12924,12925,this.ON,12926,12976,this.L,12977,12991,this.ON,12992,13003,this.L,13004,13007,this.ON,13008,13174,this.L,13175,13178,this.ON,13179,13277,this.L,13278,13279,this.ON,13280,13310,this.L,13311,13311,this.ON,13312,19903,this.L,19904,19967,this.ON,19968,42127,this.L,42128,42182,this.ON,42183,64284,this.L,64285,64285,this.R,64286,64286,this.NSM,64287,64296,this.R,64297,64297,this.ET,64298,64310,this.R,64311,64311,this.L,64312,64316,this.R,64317,64317,this.L,64318,64318,this.R,64319,64319,this.L,64320,64321,this.R,64322,64322,this.L,64323,64324,this.R,64325,64325,this.L,64326,64335,this.R,64336,64433,this.AL,64434,64466,this.L,64467,64829,this.AL,64830,64831,this.ON,64832,64847,this.L,64848,64911,this.AL,64912,64913,this.L,64914,64967,this.AL,64968,65007,this.L,65008,65020,this.AL,65021,65021,this.ON,65022,65023,this.L,65024,65039,this.NSM,65040,65055,this.L,65056,65059,this.NSM,65060,65071,this.L,65072,65103,this.ON,65104,65104,this.CS,65105,65105,this.ON,65106,65106,this.CS,65107,65107,this.L,65108,65108,this.ON,65109,65109,this.CS,65110,65118,this.ON,65119,65119,this.ET,65120,65121,this.ON,65122,65123,this.ET,65124,65126,this.ON,65127,65127,this.L,65128,65128,this.ON,65129,65130,this.ET,65131,65131,this.ON,65132,65135,this.L,65136,65140,this.AL,65141,65141,this.L,65142,65276,this.AL,65277,65278,this.L,65279,65279,this.BN,65280,65280,this.L,65281,65282,this.ON,65283,65285,this.ET,65286,65290,this.ON,65291,65291,this.ET,65292,65292,this.CS,65293,65293,this.ET,65294,65294,this.CS,65295,65295,this.ES,65296,65305,this.EN,65306,65306,this.CS,65307,65312,this.ON,65313,65338,this.L,65339,65344,this.ON,65345,65370,this.L,65371,65381,this.ON,65382,65503,this.L,65504,65505,this.ET,65506,65508,this.ON,65509,65510,this.ET,65511,65511,this.L,65512,65518,this.ON,65519,65528,this.L,65529,65531,this.BN,65532,65533,this.ON,65534,65535,this.L];for(let i=0;i<this.charTypes.length;++i){let start=this.charTypes[i],end=this.charTypes[++i],b=this.charTypes[++i];for(;start<=end;)this.rtlCharacterTypes[start++]=b}}getVisualOrder(inputText,isRtl){this.types=this.getCharacterCode(inputText),this.textOrder=isRtl?this.LRE:this.L,this.doVisualOrder();let result=[];for(let i=0;i<this.levels.length;i++)result[i]=this.levels[i];return result}getCharacterCode(text){let characterCodes=[];for(let i=0;i<text.length;i++)characterCodes[i]=this.rtlCharacterTypes[text[i].charCodeAt(0)];return characterCodes}setDefaultLevels(){for(let i=0;i<this.length;i++)this.levels[i]=this.textOrder}setLevels(){this.setDefaultLevels();for(let n=0;n<this.length;++n){let level=this.levels[n];0!=(128&level)&&(this.result[n]=0==(1&(level&=127))?this.L:this.R),this.levels[n]=level}}updateLevels(index,level,length){if(0==(1&level))for(let i=index;i<length;++i)this.result[i]===this.R?this.levels[i]+=1:this.result[i]!==this.L&&(this.levels[i]+=2);else for(let i=index;i<length;++i)this.result[i]!==this.R&&(this.levels[i]+=1)}doVisualOrder(){this.length=this.types.length,this.result=this.types,this.levels=[],this.setLevels(),this.length=this.getEmbeddedCharactersLength();let preview=this.textOrder,i=0;for(;i<this.length;){let level=this.levels[i],preType=0==(1&Math.max(preview,level))?this.L:this.R,length=i+1;for(;length<this.length&&this.levels[length]===level;)++length;let type=0==(1&Math.max(length<this.length?this.levels[length]:this.textOrder,level))?this.L:this.R;this.checkNSM(i,length,level,preType,type),this.updateLevels(i,level,length),preview=level,i=length}this.checkEmbeddedCharacters(this.length)}getEmbeddedCharactersLength(){let index=0;for(let i=0;i<this.length;++i)this.types[i]!==this.LRE&&this.types[i]!==this.RLE&&this.types[i]!==this.LRO&&this.types[i]!==this.RLO&&this.types[i]!==this.PDF&&this.types[i]!==this.BN&&(this.result[index]=this.result[i],this.levels[index]=this.levels[i],index++);return index}checkEmbeddedCharacters(length){for(let i=this.types.length-1;i>=0;--i)this.types[i]===this.LRE||this.types[i]===this.RLE||this.types[i]===this.LRO||this.types[i]===this.RLO||this.types[i]===this.PDF||this.types[i]===this.BN?(this.result[i]=this.types[i],this.levels[i]=-1):(this.result[i]=this.result[length-=1],this.levels[i]=this.levels[length]);for(let i=0;i<this.types.length;i++)-1===this.levels[i]&&(this.levels[i]=0===i?this.textOrder:this.levels[i-1])}checkNSM(index,length,level,startType,endType){let charType=startType;for(let i=index;i<length;++i)this.result[i]===this.NSM?this.result[i]=charType:charType=this.result[i];this.checkEuropeanDigits(index,length,level,startType,endType)}checkEuropeanDigits(index,length,level,startType,endType){for(let i=index;i<length;++i)if(this.result[i]===this.EN)for(let j=i-1;j>=index;--j)if(this.result[j]===this.L||this.result[j]===this.R||this.result[j]===this.AL){this.result[j]===this.AL&&(this.result[i]=this.AN);break}this.checkArabicCharacters(index,length,level,startType,endType)}checkArabicCharacters(index,length,level,startType,endType){for(let i=index;i<length;++i)this.result[i]===this.AL&&(this.result[i]=this.R);this.checkEuropeanNumberSeparator(index,length,level,startType,endType)}checkEuropeanNumberSeparator(index,length,level,startType,endType){for(let i=index+1;i<length-1;++i)if(this.result[i]===this.ES||this.result[i]===this.CS){let preview=this.result[i-1],success=this.result[i+1];preview===this.EN&&success===this.EN?this.result[i]=this.EN:this.result[i]===this.CS&&preview===this.AN&&success===this.AN&&(this.result[i]=this.AN)}this.checkEuropeanNumberTerminator(index,length,level,startType,endType)}checkEuropeanNumberTerminator(index,length,level,startType,endType){for(let i=index;i<length;++i)if(this.result[i]===this.ET){let s=i,b=[];b.push(this.ET);let l=this.getLength(s,length,b),data=s===index?startType:this.result[s-1];if(data!==this.EN&&(data=l===length?endType:this.result[l]),data===this.EN)for(let j=s;j<l;++j)this.result[j]=this.EN;i=l}this.checkOtherNeutrals(index,length,level,startType,endType)}checkOtherNeutrals(index,length,level,startType,endType){for(let i=index;i<length;++i)this.result[i]!==this.ES&&this.result[i]!==this.ET&&this.result[i]!==this.CS||(this.result[i]=this.ON);this.checkOtherCharacters(index,length,level,startType,endType)}checkOtherCharacters(index,length,level,startType,endType){for(let i=index;i<length;++i)if(this.result[i]===this.EN){let pst=startType;for(let j=i-1;j>=index;--j)if(this.result[j]===this.L||this.result[j]===this.R){pst=this.result[j];break}pst===this.L&&(this.result[i]=this.L)}this.checkCommanCharacters(index,length,level,startType,endType)}getLength(index,length,validSet){for(--index;++index<length;){let t=this.result[index];for(let i=0;i<validSet.length;++i)t===validSet[i]&&(index=this.getLength(++index,length,validSet));return index}return length}checkCommanCharacters(index,length,level,startType,endType){for(let i=index;i<length;++i)if(this.result[i]===this.WS||this.result[i]===this.ON||this.result[i]===this.B||this.result[i]===this.S){let s=i,l=this.getLength(s,length,[this.B,this.S,this.WS,this.ON]),lt=0,tt=0,rt=0;s===index?lt=startType:(lt=this.result[s-1])===this.AN?lt=this.R:lt===this.EN&&(lt=this.R),l===length?tt=endType:(tt=this.result[l])===this.AN?tt=this.R:tt===this.EN&&(tt=this.R),rt=lt===tt?lt:0==(1&level)?this.L:this.R;for(let j=s;j<l;++j)this.result[j]=rt;i=l}}}class RtlRenderer{constructor(){this.openBracket="(",this.closeBracket=")"}layout(line,font,rtl,wordSpace,format){if(null==line)throw new Error("ArgumentNullException : line");if(null==font)throw new Error("ArgumentNullException : font");let result=[];return font.Unicode?result=this.customLayout(line,rtl,format,font,wordSpace):(result=[])[0]=line,result}splitLayout(line,font,rtl,wordSpace,format){if(null==line)throw new Error("ArgumentNullException : line");if(null==font)throw new Error("ArgumentNullException : font");return this.customSplitLayout(line,font,rtl,wordSpace,format)}getGlyphIndex(line,font,rtl,glyphs,custom){if(null==line)throw new Error("ArgumentNullException : line");if(null==font)throw new Error("ArgumentNullException : font");if(glyphs=null,0===line.length)return{success:!1,glyphs:glyphs};let text=(new ArabicShapeRenderer).shape(line,0),ttfReader=font.fontInternal.ttfReader;glyphs=new Uint16Array(text.length);let i=0;for(let k=0,len=text.length;k<len;k++){let glyphInfo=ttfReader.getGlyph(text[k]);null!=glyphInfo&&(glyphs[i++]=glyphInfo.index)}return{success:!0,glyphs:glyphs}}customLayout(line,rtl,format,font,wordSpace){if(null==wordSpace){if(null==line)throw new Error("ArgumentNullException : line");let result=null;return null!==format&&format.textDirection!==PdfTextDirection.None&&(result=(new Bidi).getLogicalToVisualString(line,rtl)),result}{if(null==line)throw new Error("ArgumentNullException : line");if(null==font)throw new Error("ArgumentNullException : font");let layouted=null;if(null!==format&&format.textDirection!==PdfTextDirection.None){let txt=(new ArabicShapeRenderer).shape(line,0);layouted=this.customLayout(txt,rtl,format)}let result=[];if(wordSpace){let words=layouted.split(""),count=words.length;for(let i=0;i<count;i++)words[i]=this.addChars(font,words[i]);result=words}else(result=[])[0]=this.addChars(font,layouted);return result}}addChars(font,glyphs){let line=glyphs;if(null==font)throw new Error("ArgumentNullException : font");if(null==line)throw new Error("ArgumentNullException : line");let text=line,ttfReader=font.fontInternal.ttfReader;font.setSymbols(text),text=ttfReader.convertString(text);let bytes=PdfString.toUnicodeArray(text,!1);return PdfString.byteToString(bytes)}customSplitLayout(line,font,rtl,wordSpace,format){if(null==line)throw new Error("ArgumentNullException : line");if(null==font)throw new Error("ArgumentNullException : font");return this.customLayout(line,rtl,format).split("")}}let PdfGraphics=(()=>{class PdfGraphics{constructor(arg1,arg2,arg3){this.currentColorSpace=PdfColorSpace.Rgb,this.previousTextRenderingMode=TextRenderingMode.Fill,this.previousCharacterSpacing=0,this.previousWordSpacing=0,this.previousTextScaling=100,this.procedureSets=new ProcedureSets,this.isNormalRender=!0,this.isUseFontSize=!1,this.isItalic=!1,this.isEmfTextScaled=!1,this.isEmf=!1,this.isEmfPlus=!1,this.isBaselineFormat=!0,this.emfScalingFactor=new SizeF(0,0),this.colorSpaceChanged=!1,this.dictionaryProperties=new DictionaryProperties,this.isOverloadWithPosition=!1,this.isPointOverload=!1,this.currentColorSpaces=["RGB","CMYK","GrayScale","Indexed"],this.isImageOptimized=!1,this.graphicsState=[],this.istransparencySet=!1,this.internalAutomaticFields=null,this.startCutIndex=-1,this.getResources=arg2,this.canvasSize=arg1,this.pdfStreamWriter=arg3 instanceof PdfStreamWriter?arg3:new PdfStreamWriter(arg3),this.initialize()}get stringLayoutResult(){return this.pdfStringLayoutResult}get size(){return this.canvasSize}get mediaBoxUpperRightBound(){return void 0===this.internalMediaBoxUpperRightBound&&(this.internalMediaBoxUpperRightBound=0),this.internalMediaBoxUpperRightBound}set mediaBoxUpperRightBound(value){this.internalMediaBoxUpperRightBound=value}get clientSize(){return new SizeF(this.clipBounds.width,this.clipBounds.height)}get colorSpace(){return this.currentColorSpace}set colorSpace(value){this.currentColorSpace=value}get streamWriter(){return this.pdfStreamWriter}get matrix(){return null==this.transformationMatrix&&(this.transformationMatrix=new PdfTransformationMatrix),this.transformationMatrix}get layer(){return this.pageLayer}get page(){return this.pageLayer.page}get automaticFields(){return null!=this.internalAutomaticFields&&void 0!==this.internalAutomaticFields||(this.internalAutomaticFields=new PdfAutomaticFieldInfoCollection),this.internalAutomaticFields}initialize(){this.bStateSaved=!1,this.currentPen=null,this.currentBrush=null,this.currentFont=null,this.currentColorSpace=PdfColorSpace.Rgb,this.bCSInitialized=!1,this.transformationMatrix=null,this.previousTextRenderingMode=-1,this.previousCharacterSpacing=-1,this.previousWordSpacing=-1,this.previousTextScaling=-100,this.currentStringFormat=null,this.clipBounds=new RectangleF(new PointF(0,0),this.size),this.getResources.getResources().requireProcedureSet(this.procedureSets.pdf)}drawPdfTemplate(template,location,size){if(void 0===size){if(null==template)throw Error("ArgumentNullException-template");this.drawPdfTemplate(template,location,template.size)}else{if(null==template)throw Error("ArgumentNullException-template");let scaleX=template.width>0?size.width/template.width:1,scaleY=template.height>0?size.height/template.height:1,bNeedScale=!(1===scaleX&&1===scaleY),state=this.save(),matrix=new PdfTransformationMatrix;null!=this.pageLayer&&this.getTranslateTransform(location.x,location.y+size.height,matrix),bNeedScale&&this.getScaleTransform(scaleX,scaleY,matrix),this.pdfStreamWriter.modifyCtm(matrix);let name=this.getResources.getResources().getName(template);this.pdfStreamWriter.executeObject(name),this.restore(state);let g=template.graphics;if(null!=g)for(let index=0;index<g.automaticFields.automaticFields.length;index++){let fieldInfo=g.automaticFields.automaticFields[index],newLocation=new PointF(fieldInfo.location.x+location.x,fieldInfo.location.y+location.y);this.automaticFields.add(new PdfAutomaticFieldInfo(fieldInfo.field,newLocation,0==template.size.width?0:size.width/template.size.width,0==template.size.height?0:size.height/template.size.height)),this.page.dictionary.modify()}this.getResources.getResources().requireProcedureSet(this.procedureSets.imageB),this.getResources.getResources().requireProcedureSet(this.procedureSets.imageC),this.getResources.getResources().requireProcedureSet(this.procedureSets.imageI),this.getResources.getResources().requireProcedureSet(this.procedureSets.text)}}drawString(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9){if("string"==typeof arg1&&arg2 instanceof PdfFont&&(arg3 instanceof PdfPen||null===arg3)&&(arg4 instanceof PdfBrush||null===arg4)&&"number"==typeof arg5&&"number"==typeof arg6&&(arg7 instanceof PdfStringFormat||null===arg7)&&void 0===arg8)this.isOverloadWithPosition=!0,this.drawString(arg1,arg2,arg3,arg4,arg5,arg6,this.clientSize.width-arg5,0,arg7);else{let temparg3=arg3,temparg4=arg4,temparg5=arg5,temparg6=arg6,temparg7=arg7,temparg8=arg8,temparg9=arg9,result=(new PdfStringLayouter).layout(arg1,arg2,temparg9,new SizeF(temparg7,temparg8),this.isOverloadWithPosition,this.clientSize);if(!result.empty){let rect=this.checkCorrectLayoutRectangle(result.actualSize,temparg5,temparg6,temparg9);temparg7<=0&&(temparg5=rect.x,temparg7=rect.width),temparg8<=0&&(temparg6=rect.y,temparg8=rect.height),this.drawStringLayoutResult(result,arg2,temparg3,temparg4,new RectangleF(temparg5,temparg6,temparg7,temparg8),temparg9),this.isEmfTextScaled=!1,this.emfScalingFactor=new SizeF(0,0)}this.getResources.getResources().requireProcedureSet(this.procedureSets.text),this.isNormalRender=!0,this.pdfStringLayoutResult=result,this.isUseFontSize=!1}}drawLine(arg1,arg2,arg3,arg4,arg5){if(arg2 instanceof PointF)this.drawLine(arg1,arg2.x,arg2.y,arg3.x,arg3.y);else{let temparg2=arg2,temparg3=arg3,temparg4=arg4,temparg5=arg5;this.stateControl(arg1,null,null);let sw=this.streamWriter;sw.beginPath(temparg2,temparg3),sw.appendLineSegment(temparg4,temparg5),sw.strokePath(),this.getResources.getResources().requireProcedureSet(this.procedureSets.pdf)}}drawRectangle(arg1,arg2,arg3,arg4,arg5,arg6){if(arg1 instanceof PdfPen&&"number"==typeof arg2)this.drawRectangle(arg1,null,arg2,arg3,arg4,arg5);else if(arg1 instanceof PdfBrush&&"number"==typeof arg2)this.drawRectangle(null,arg1,arg2,arg3,arg4,arg5);else{let temparg3=arg3,temparg4=arg4,temparg5=arg5,temparg6=arg6;arg2 instanceof PdfSolidBrush&&arg2.color.isEmpty&&(arg2=null);let temparg1=arg1,temparg2=arg2;this.stateControl(temparg1,temparg2,null),this.streamWriter.appendRectangle(temparg3,temparg4,temparg5,temparg6),this.drawPath(temparg1,temparg2,!1)}}drawPath(arg1,arg2,arg3,arg4){if("boolean"==typeof arg3)this.drawPath(arg1,arg2,PdfFillMode.Winding,arg3);else{let isPen=null!=arg1,isBrush=null!=arg2,isEvenOdd=arg3===PdfFillMode.Alternate;isPen&&isBrush?this.streamWriter.fillStrokePath(isEvenOdd):isPen||isBrush?isPen?this.streamWriter.strokePath():this.streamWriter.fillPath(isEvenOdd):this.streamWriter.endPath()}}drawImage(arg1,arg2,arg3,arg4,arg5){if("number"==typeof arg2&&"number"==typeof arg3&&void 0===arg4){let size=arg1.physicalDimension;this.drawImage(arg1,arg2,arg3,size.width,size.height)}else{let temparg2=arg2,temparg3=arg3,temparg5=arg5;arg1.save();let matrix=new PdfTransformationMatrix;this.getTranslateTransform(temparg2,temparg3+temparg5,matrix),this.getScaleTransform(arg4,arg5,matrix),this.pdfStreamWriter.write("q"),this.pdfStreamWriter.modifyCtm(matrix);let resources=this.getResources.getResources();void 0!==this.pageLayer&&null!=this.page&&(resources.document=this.page.document);let name=resources.getName(arg1);void 0!==this.pageLayer&&this.page.setResources(resources),this.pdfStreamWriter.executeObject(name),this.pdfStreamWriter.write(Operators.restoreState),this.pdfStreamWriter.write(Operators.newLine);let resource=this.getResources.getResources();resource.requireProcedureSet(this.procedureSets.imageB),resource.requireProcedureSet(this.procedureSets.imageC),resource.requireProcedureSet(this.procedureSets.imageI),resource.requireProcedureSet(this.procedureSets.text)}}getLineBounds(lineIndex,result,font,layoutRectangle,format){let bounds;if(!result.empty&&lineIndex<result.lineCount&&lineIndex>=0){let line=result.lines[lineIndex],y=this.getTextVerticalAlignShift(result.actualSize.height,layoutRectangle.height,format)+layoutRectangle.y+result.lineHeight*lineIndex,lineWidth=line.width,hShift=this.getHorizontalAlignShift(lineWidth,layoutRectangle.width,format),lineIndent=this.getLineIndent(line,format,layoutRectangle,0===lineIndex);hShift+=this.rightToLeft(format)?0:lineIndent;let x=layoutRectangle.x+hShift,width=this.shouldJustify(line,layoutRectangle.width,format)?layoutRectangle.width-lineIndent:lineWidth-lineIndent;bounds=new RectangleF(x,y,width,result.lineHeight)}else bounds=new RectangleF(0,0,0,0);return bounds}checkCorrectLayoutRectangle(textSize,x,y,format){let layoutedRectangle=new RectangleF(x,y,textSize.width,textSize.width);if(null!=format){switch(format.alignment){case PdfTextAlignment.Center:layoutedRectangle.x-=layoutedRectangle.width/2;break;case PdfTextAlignment.Right:layoutedRectangle.x-=layoutedRectangle.width}switch(format.lineAlignment){case PdfVerticalAlignment.Middle:layoutedRectangle.y-=layoutedRectangle.height/2;break;case PdfVerticalAlignment.Bottom:layoutedRectangle.y-=layoutedRectangle.height}}return layoutedRectangle}setLayer(layer){this.pageLayer=layer;let page=layer.page;null!=page&&void 0!==page&&(page.beginSave=this.pageSave)}pageSave(page){if(null!=page.graphics.automaticFields)for(let i=0;i<page.graphics.automaticFields.automaticFields.length;i++){let fieldInfo=page.graphics.automaticFields.automaticFields[i];fieldInfo.field.performDraw(page.graphics,fieldInfo.location,fieldInfo.scalingX,fieldInfo.scalingY)}}drawStringLayoutResult(result,font,pen,brush,layoutRectangle,format){if(result.empty)throw new Error("ArgumentNullException:result");{this.applyStringSettings(font,pen,brush,format,layoutRectangle);let textScaling=null!=format?format.horizontalScalingFactor:100;textScaling===this.previousTextScaling||this.isEmfTextScaled||(this.pdfStreamWriter.setTextScaling(textScaling),this.previousTextScaling=textScaling);let height=null==format||0===format.lineSpacing?font.height:format.lineSpacing+font.height,shift=0;shift=null!=format&&format.subSuperScript===PdfSubSuperScript.SubScript?height-(font.height+font.metrics.getDescent(format)):height-font.metrics.getAscent(format),this.shift=shift,this.pdfStreamWriter.startNextLine(layoutRectangle.x,layoutRectangle.y-shift),this.pdfStreamWriter.setLeading(+height);let resultHeight=0,remainingString="";for(let i=0;i<result.lines.length;i++)if(layoutRectangle.y+(resultHeight+=result.lineHeight)>this.clientSize.height){this.startCutIndex=i;break}for(let j=this.startCutIndex;j<result.lines.length&&j>=0;j++)remainingString+=result.lines[j].text;let bounds=new RectangleF(layoutRectangle.x,layoutRectangle.y,layoutRectangle.width,layoutRectangle.height);this.drawLayoutResult(result,font,format,layoutRectangle),this.underlineStrikeoutText(pen,brush,result,font,bounds,format),this.isEmfPlus=!1,this.isUseFontSize=!1,-1!==this.startCutIndex&&this.getNextPage().graphics.drawString(remainingString,font,pen,brush,layoutRectangle.x,0,layoutRectangle.width,0,format)}}getNextPage(){let section=this.currentPage.section,index=section.indexOf(this.currentPage);return index===section.count-1?section.add():section.getPages()[index+1]}setClip(rectangle,mode){void 0===mode?this.setClip(rectangle,PdfFillMode.Winding):(this.pdfStreamWriter.appendRectangle(rectangle),this.pdfStreamWriter.clipPath(mode===PdfFillMode.Alternate))}applyStringSettings(font,pen,brush,format,bounds){let tm=this.getTextRenderingMode(pen,brush,format);this.stateControl(pen,brush,font,format),this.pdfStreamWriter.beginText(),tm!==this.previousTextRenderingMode&&(this.pdfStreamWriter.setTextRenderingMode(tm),this.previousTextRenderingMode=tm);let cs=null!=format?format.characterSpacing:0;cs===this.previousCharacterSpacing||this.isEmfTextScaled||(this.pdfStreamWriter.setCharacterSpacing(cs),this.previousCharacterSpacing=cs);let ws=null!=format?format.wordSpacing:0;ws!==this.previousWordSpacing&&(this.pdfStreamWriter.setWordSpacing(ws),this.previousWordSpacing=ws)}getTextVerticalAlignShift(textHeight,boundsHeight,format){let shift=0;if(boundsHeight>=0&&null!=format&&format.lineAlignment!==PdfVerticalAlignment.Top)switch(format.lineAlignment){case PdfVerticalAlignment.Middle:shift=(boundsHeight-textHeight)/2;break;case PdfVerticalAlignment.Bottom:shift=boundsHeight-textHeight}return shift}drawLayoutResult(result,font,format,layoutRectangle){let vAlignShift=this.getTextVerticalAlignShift(result.actualSize.height,layoutRectangle.height,format);0!==vAlignShift&&this.pdfStreamWriter.startNextLine(0,vAlignShift);let unicode=null!=font&&font.isUnicode,lines=result.lines;for(let i=0,len=lines.length;i<len&&i!==this.startCutIndex;i++){let lineInfo=lines[i],hAlignShift=this.getHorizontalAlignShift(lineInfo.width,layoutRectangle.width,format),lineIndent=this.getLineIndent(lineInfo,format,layoutRectangle,0===i);0===(hAlignShift+=this.rightToLeft(format)?0:lineIndent)||this.isEmfTextScaled||this.pdfStreamWriter.startNextLine(hAlignShift,0),unicode?this.drawUnicodeLine(lineInfo,layoutRectangle,font,format):this.drawAsciiLine(lineInfo,layoutRectangle,font,format),0===hAlignShift||this.isEmfTextScaled||this.pdfStreamWriter.startNextLine(-hAlignShift,0),this.isOverloadWithPosition&&lines.length>1&&(this.pdfStreamWriter.startNextLine(-layoutRectangle.x,0),layoutRectangle.x=0,layoutRectangle.width=this.clientSize.width,this.isOverloadWithPosition=!1,this.isPointOverload=!0)}this.getResources.getResources().requireProcedureSet(this.procedureSets.text),0!==vAlignShift&&this.pdfStreamWriter.startNextLine(0,-(vAlignShift-result.lineHeight)),this.pdfStreamWriter.endText()}drawAsciiLine(lineInfo,layoutRectangle,font,format){this.justifyLine(lineInfo,layoutRectangle.width,format);let value="";if(-1!==lineInfo.text.indexOf("(")||-1!==lineInfo.text.indexOf(")"))for(let i=0;i<lineInfo.text.length;i++)value+="("===lineInfo.text[i]?"\\(":")"===lineInfo.text[i]?"\\)":lineInfo.text[i];""===value&&(value=lineInfo.text),this.pdfStreamWriter.showNextLineText(new PdfString("("+value+")"))}drawUnicodeLine(lineInfo,layoutRectangle,font,format){let line=lineInfo.text,rtl=null!==format&&format.rightToLeft,useWordSpace=null!==format&&(0!==format.wordSpacing||format.alignment===PdfTextAlignment.Justify),ttfFont=font,wordSpacing=this.justifyLine(lineInfo,layoutRectangle.width,format),rtlRender=new RtlRenderer;if(rtl||null!==format&&format.textDirection!==PdfTextDirection.None){let blocks=null,rightAlign=null!==format&&format.alignment===PdfTextAlignment.Right,words=null;words=(blocks=rtlRender.layout(line,ttfFont,null!==format&&format.textDirection!==PdfTextDirection.None?format.textDirection===PdfTextDirection.RightToLeft:rightAlign,useWordSpace,format)).length>1?rtlRender.splitLayout(line,ttfFont,null!==format&&format.textDirection!==PdfTextDirection.None?format.textDirection===PdfTextDirection.RightToLeft:rightAlign,useWordSpace,format):[line],this.drawUnicodeBlocks(blocks,words,ttfFont,format,wordSpacing)}else if(useWordSpace){let result=this.breakUnicodeLine(line,ttfFont,null);this.drawUnicodeBlocks(result.tokens,result.words,ttfFont,format,wordSpacing)}else{let token=this.convertToUnicode(line,ttfFont),value=this.getUnicodeString(token);this.streamWriter.showNextLineText(value)}}drawUnicodeBlocks(blocks,words,font,format,wordSpacing){if(null==blocks)throw new Error("Argument Null Exception : blocks");if(null==words)throw new Error("Argument Null Exception : words");if(null==font)throw new Error("Argument Null Exception : font");this.streamWriter.startNextLine();let x=0,xShift=0,firstLineIndent=0,paragraphIndent=0;try{null!==format&&(firstLineIndent=format.firstLineIndent,paragraphIndent=format.paragraphIndent,format.firstLineIndent=0,format.paragraphIndent=0);let spaceWidth=font.getCharWidth(StringTokenizer.whiteSpace,format)+wordSpacing,characterSpacing=null!=format?format.characterSpacing:0;spaceWidth+=characterSpacing+(null!==format&&0===wordSpacing?format.wordSpacing:0);for(let i=0;i<blocks.length;i++){let token=blocks[i],word=words[i],tokenWidth=0;if(0!==x&&this.streamWriter.startNextLine(x,0),word.length>0){tokenWidth+=font.measureString(word,format).width,tokenWidth+=characterSpacing;let val=this.getUnicodeString(token);this.streamWriter.showText(val)}i!==blocks.length-1&&(xShift+=x=tokenWidth+spaceWidth)}xShift>0&&this.streamWriter.startNextLine(-xShift,0)}finally{null!==format&&(format.firstLineIndent=firstLineIndent,format.paragraphIndent=paragraphIndent)}}breakUnicodeLine(line,ttfFont,words){if(null===line)throw new Error("Argument Null Exception : line");words=line.split(null);let tokens=[];for(let i=0;i<words.length;i++){let token=this.convertToUnicode(words[i],ttfFont);tokens[i]=token}return{tokens:tokens,words:words}}getUnicodeString(token){if(null===token)throw new Error("Argument Null Exception : token");let val=new PdfString(token);return val.converted=!0,val.encode=InternalEnum.ForceEncoding.Ascii,val}convertToUnicode(text,ttfFont){let token=null;if(null==text)throw new Error("Argument Null Exception : text");if(null==ttfFont)throw new Error("Argument Null Exception : ttfFont");if(ttfFont.fontInternal instanceof UnicodeTrueTypeFont){let ttfReader=ttfFont.fontInternal.ttfReader;ttfFont.setSymbols(text),token=ttfReader.convertString(text);let bytes=PdfString.toUnicodeArray(token,!1);token=PdfString.byteToString(bytes)}return token}justifyLine(lineInfo,boundsWidth,format){let line=lineInfo.text,lineWidth=lineInfo.width,shouldJustify=this.shouldJustify(lineInfo,boundsWidth,format),hasWordSpacing=null!=format&&0!==format.wordSpacing,whitespacesCount=StringTokenizer.getCharsCount(line,StringTokenizer.spaces),wordSpace=0;return shouldJustify?(hasWordSpacing&&(lineWidth-=whitespacesCount*format.wordSpacing),this.pdfStreamWriter.setWordSpacing(wordSpace=(boundsWidth-lineWidth)/whitespacesCount)):this.pdfStreamWriter.setWordSpacing(hasWordSpacing?format.wordSpacing:0),wordSpace}reset(size){this.canvasSize=size,this.streamWriter.clear(),this.initialize(),this.initializeCoordinates()}shouldJustify(lineInfo,boundsWidth,format){let line=lineInfo.text,justifyStyle=null!=format&&format.alignment===PdfTextAlignment.Justify,goodWidth=boundsWidth>=0&&lineInfo.width<boundsWidth,whitespacesCount=StringTokenizer.getCharsCount(line,StringTokenizer.spaces);return justifyStyle&&goodWidth&&whitespacesCount>0&&line[0]!==StringTokenizer.whiteSpace&&((lineInfo.lineType&LineType.LayoutBreak)>0||format.alignment===PdfTextAlignment.Justify)}underlineStrikeoutText(pen,brush,result,font,layoutRectangle,format){if(font.underline||font.strikeout){let linePen=this.createUnderlineStikeoutPen(pen,brush,font,format);if(null!=linePen){let vShift=this.getTextVerticalAlignShift(result.actualSize.height,layoutRectangle.height,format),underlineYOffset=0;underlineYOffset=layoutRectangle.y+vShift+font.metrics.getAscent(format)+1.5*linePen.width;let strikeoutYOffset=layoutRectangle.y+vShift+font.metrics.getHeight(format)/2+1.5*linePen.width,lines=result.lines;for(let i=0,len=result.lineCount;i<len;i++){let lineInfo=lines[i],lineWidth=lineInfo.width,hShift=this.getHorizontalAlignShift(lineWidth,layoutRectangle.width,format),lineIndent=this.getLineIndent(lineInfo,format,layoutRectangle,0===i);hShift+=this.rightToLeft(format)?0:lineIndent;let x1=layoutRectangle.x+hShift,x2=this.shouldJustify(lineInfo,layoutRectangle.width,format)?x1+layoutRectangle.width-lineIndent:x1+lineWidth-lineIndent;font.underline&&(this.drawLine(linePen,x1,underlineYOffset,x2,underlineYOffset),underlineYOffset+=result.lineHeight),font.strikeout&&(this.drawLine(linePen,x1,strikeoutYOffset,x2,strikeoutYOffset),strikeoutYOffset+=result.lineHeight),this.isPointOverload&&lines.length>1&&(layoutRectangle.x=0,layoutRectangle.width=this.clientSize.width)}this.isPointOverload=!1}}}createUnderlineStikeoutPen(pen,brush,font,format){let lineWidth=font.metrics.getSize(format)/20,linePen=null;return null!=pen?linePen=new PdfPen(pen.color,lineWidth):null!=brush&&(linePen=new PdfPen(brush,lineWidth)),linePen}getTextRenderingMode(pen,brush,format){let tm=TextRenderingMode.None;return tm=null!=pen&&null!=brush?TextRenderingMode.FillStroke:null!=pen?TextRenderingMode.Stroke:TextRenderingMode.Fill,null!=format&&format.clipPath&&(tm|=TextRenderingMode.ClipFlag),tm}getLineIndent(lineInfo,format,layoutBounds,firstLine){let lineIndent=0;return null!=format&&(lineInfo.lineType&LineType.FirstParagraphLine)>0&&(lineIndent=firstLine?format.firstLineIndent:format.paragraphIndent,lineIndent=layoutBounds.width>0?Math.min(layoutBounds.width,lineIndent):lineIndent),lineIndent}getHorizontalAlignShift(lineWidth,boundsWidth,format){let shift=0;if(boundsWidth>=0&&null!=format&&format.alignment!==PdfTextAlignment.Left)switch(format.alignment){case PdfTextAlignment.Center:shift=(boundsWidth-lineWidth)/2;break;case PdfTextAlignment.Right:shift=boundsWidth-lineWidth}return shift}rightToLeft(format){let rtl=null!=format&&format.rightToLeft;return null!=format&&format.textDirection!==PdfTextDirection.None&&void 0!==format.textDirection&&(rtl=!0),rtl}stateControl(pen,brush,font,format){if(void 0===format)this.stateControl(pen,brush,font,null);else{let saveState=!1;null!==brush?(void 0!==this.pageLayer&&null!=this.pageLayer&&!1===this.colorSpaceChanged&&(this.lastDocumentCS=this.pageLayer.page.document.colorSpace,this.lastGraphicsCS=this.pageLayer.page.graphics.colorSpace,this.colorSpace=this.pageLayer.page.document.colorSpace,this.currentColorSpace=this.pageLayer.page.document.colorSpace,this.colorSpaceChanged=!0),this.initCurrentColorSpace(this.currentColorSpace)):null!=pen&&(void 0!==this.pageLayer&&null!=this.pageLayer&&(this.colorSpace=this.pageLayer.page.document.colorSpace,this.currentColorSpace=this.pageLayer.page.document.colorSpace),this.initCurrentColorSpace(this.currentColorSpace)),this.penControl(pen,saveState),this.brushControl(brush,saveState),this.fontControl(font,format,saveState)}}initCurrentColorSpace(colorspace){this.getResources.getResources(),this.bCSInitialized||(this.pdfStreamWriter.setColorSpace("Device"+this.currentColorSpaces[this.currentColorSpace],!0),this.pdfStreamWriter.setColorSpace("Device"+this.currentColorSpaces[this.currentColorSpace],!1),this.bCSInitialized=!0)}penControl(pen,saveState){null!=pen&&(this.currentPen=pen,this.colorSpace=PdfColorSpace.Rgb,pen.monitorChanges(this.currentPen,this.pdfStreamWriter,this.getResources,saveState,this.colorSpace,this.matrix.clone()),this.currentPen=pen.clone())}brushControl(brush,saveState){null!=brush&&(this.currentBrush=brush,brush.monitorChanges(this.currentBrush,this.pdfStreamWriter,this.getResources,saveState,this.colorSpace),this.currentBrush=brush,brush=null)}fontControl(font,format,saveState){if(null!=font){let curSubSuper=null!=format?format.subSuperScript:PdfSubSuperScript.None,prevSubSuper=null!=this.currentStringFormat?this.currentStringFormat.subSuperScript:PdfSubSuperScript.None;if(saveState||font!==this.currentFont||curSubSuper!==prevSubSuper){let resources=this.getResources.getResources();this.currentFont=font,this.currentStringFormat=format;let size=font.metrics.getSize(format);this.isEmfTextScaled=!1;let fontName=resources.getName(font);this.pdfStreamWriter.setFont(font,fontName,size)}}}setTransparency(arg1,arg2,arg3){if(void 0===arg2)this.istransparencySet=!0,this.setTransparency(arg1,arg1,PdfBlendMode.Normal);else if("number"==typeof arg2&&void 0===arg3)this.setTransparency(arg1,arg2,PdfBlendMode.Normal);else{null==this.trasparencies&&(this.trasparencies=new TemporaryDictionary);let transp=null,td=new TransparencyData(arg1,arg2,arg3);this.trasparencies.containsKey(td)&&(transp=this.trasparencies.getValue(td)),null==transp&&(transp=new PdfTransparency(arg1,arg2,arg3),this.trasparencies.setValue(td,transp));let name=this.getResources.getResources().getName(transp);this.streamWriter.setGraphicsState(name)}}clipTranslateMargins(x,y,left,top,right,bottom){if(x instanceof RectangleF&&void 0===y)this.clipBounds=x,this.pdfStreamWriter.writeComment("Clip margins."),this.pdfStreamWriter.appendRectangle(x),this.pdfStreamWriter.closePath(),this.pdfStreamWriter.clipPath(!1),this.pdfStreamWriter.writeComment("Translate co-ordinate system."),this.translateTransform(x.x,x.y);else if("number"==typeof x){let clipArea=new RectangleF(left,top,this.size.width-left-right,this.size.height-top-bottom);this.clipBounds=clipArea,this.pdfStreamWriter.writeComment("Clip margins."),this.pdfStreamWriter.appendRectangle(clipArea),this.pdfStreamWriter.closePath(),this.pdfStreamWriter.clipPath(!1),this.pdfStreamWriter.writeComment("Translate co-ordinate system."),this.translateTransform(x,y)}}updateY(y){return-y}translateTransform(offsetX,offsetY){let matrix=new PdfTransformationMatrix;this.getTranslateTransform(offsetX,offsetY,matrix),this.pdfStreamWriter.modifyCtm(matrix),this.matrix.multiply(matrix)}getTranslateTransform(x,y,input){return input.translate(x,this.updateY(y)),input}scaleTransform(scaleX,scaleY){let matrix=new PdfTransformationMatrix;this.getScaleTransform(scaleX,scaleY,matrix),this.pdfStreamWriter.modifyCtm(matrix),this.matrix.multiply(matrix)}getScaleTransform(x,y,input){return null==input&&(input=new PdfTransformationMatrix),input.scale(x,y),input}rotateTransform(angle){let matrix=new PdfTransformationMatrix;this.getRotateTransform(angle,matrix),this.pdfStreamWriter.modifyCtm(matrix),this.matrix.multiply(matrix)}initializeCoordinates(){this.pdfStreamWriter.writeComment("Change co-ordinate system to left/top."),this.mediaBoxUpperRightBound!==-this.size.height&&null==this.cropBox&&this.translateTransform(0,this.updateY(this.mediaBoxUpperRightBound===this.size.height||0===this.mediaBoxUpperRightBound?this.size.height:this.mediaBoxUpperRightBound))}getRotateTransform(angle,input){return null!=input&&void 0!==input||(input=new PdfTransformationMatrix),input.rotate(this.updateY(angle)),input}save(){let state=new PdfGraphicsState(this,this.matrix.clone());return state.brush=this.currentBrush,state.pen=this.currentPen,state.font=this.currentFont,state.colorSpace=this.currentColorSpace,state.characterSpacing=this.previousCharacterSpacing,state.wordSpacing=this.previousWordSpacing,state.textScaling=this.previousTextScaling,state.textRenderingMode=this.previousTextRenderingMode,this.graphicsState.push(state),this.pdfStreamWriter.saveGraphicsState(),state}restore(state){if(void 0===state)this.graphicsState.length>0&&this.doRestoreState();else if(-1!==this.graphicsState.indexOf(state))for(;0!==this.graphicsState.length&&this.doRestoreState()!==state;);}doRestoreState(){let state=this.graphicsState.pop();return this.transformationMatrix=state.matrix,this.currentBrush=state.brush,this.currentPen=state.pen,this.currentFont=state.font,this.currentColorSpace=state.colorSpace,this.previousCharacterSpacing=state.characterSpacing,this.previousWordSpacing=state.wordSpacing,this.previousTextScaling=state.textScaling,this.previousTextRenderingMode=state.textRenderingMode,this.pdfStreamWriter.restoreGraphicsState(),state}}return PdfGraphics.pathTypesValuesMask=15,PdfGraphics.transparencyObject=!1,PdfGraphics})();class GetResourceEventHandler{getResources(){return this.sender.getResources()}constructor(sender){this.sender=sender}}class PdfGraphicsState{constructor(graphics,matrix){this.internalTextRenderingMode=TextRenderingMode.Fill,this.internalCharacterSpacing=0,this.internalWordSpacing=0,this.internalTextScaling=100,this.pdfColorSpace=PdfColorSpace.Rgb,void 0!==graphics&&(this.pdfGraphics=graphics,this.transformationMatrix=matrix)}get graphics(){return this.pdfGraphics}get matrix(){return this.transformationMatrix}get characterSpacing(){return this.internalCharacterSpacing}set characterSpacing(value){this.internalCharacterSpacing=value}get wordSpacing(){return this.internalWordSpacing}set wordSpacing(value){this.internalWordSpacing=value}get textScaling(){return this.internalTextScaling}set textScaling(value){this.internalTextScaling=value}get pen(){return this.pdfPen}set pen(value){this.pdfPen=value}get brush(){return this.pdfBrush}set brush(value){this.pdfBrush=value}get font(){return this.pdfFont}set font(value){this.pdfFont=value}get colorSpace(){return this.pdfColorSpace}set colorSpace(value){this.pdfColorSpace=value}get textRenderingMode(){return this.internalTextRenderingMode}set textRenderingMode(value){this.internalTextRenderingMode=value}}class TransparencyData{constructor(alphaPen,alphaBrush,blendMode){this.alphaPen=alphaPen,this.alphaBrush=alphaBrush,this.blendMode=blendMode}}class PdfPageLayer{constructor(page,streamClipPageTemplates){if(this.pdfColorSpace=PdfColorSpace.Rgb,this.isVisible=!0,this.sublayer=!1,this.contentLength=0,this.dictionaryProperties=new DictionaryProperties,null===page)throw new Error("ArgumentNullException:page");if(this.pdfPage=page,this.clipPageTemplates=!0,void 0===streamClipPageTemplates)this.content=new ej2_pdf_export_es2015_PdfStream;else if(streamClipPageTemplates instanceof ej2_pdf_export_es2015_PdfStream||null===streamClipPageTemplates){if(null===streamClipPageTemplates)throw new Error("ArgumentNullException:stream");this.content=streamClipPageTemplates}else this.content=new ej2_pdf_export_es2015_PdfStream,this.clipPageTemplates=streamClipPageTemplates}get colorSpace(){return this.pdfColorSpace}set colorSpace(value){this.pdfColorSpace=value}get page(){return this.pdfPage}get layerId(){return this.layerid}set layerId(value){this.layerid=value}get name(){return this.layerName}set name(value){this.layerName=value}get visible(){return this.isVisible}set visible(value){this.isVisible=value}get graphics(){return null==this.pdfGraphics&&this.initializeGraphics(this.page),this.pdfGraphics}get layers(){return null==this.layer?(this.layer=new PdfPageLayerCollection(this.page),this.layer.sublayer=!0,this.layer):this.layer}add(){let layer=new PdfPageLayer(this.pdfPage);return layer.name="",layer}sign(number){return 0===number?0:number>0?1:-1}initializeGraphics(page){let oPage=page,gr=new GetResourceEventHandler(this.page);if(this.pdfGraphics=new PdfGraphics(page.size,gr,this.content),this.pdfGraphics.mediaBoxUpperRightBound=0,null!=oPage){let sc=oPage.section.parent;null!=sc&&(this.pdfGraphics.colorSpace=sc.document.colorSpace,this.colorSpace=sc.document.colorSpace)}let isSame=this.sign(page.origin.y)===this.sign(page.origin.x);(page.origin.x>=0&&page.origin.y>=0||!isSame)&&this.pdfGraphics.initializeCoordinates();let clipRect=oPage.section.getActualBounds(oPage,!0),margins=oPage.section.pageSettings.margins;this.clipPageTemplates?page.origin.x>=0&&page.origin.y>=0&&this.pdfGraphics.clipTranslateMargins(clipRect):this.graphics.clipTranslateMargins(clipRect.x,clipRect.y,margins.left,margins.top,margins.right,margins.bottom),this.pdfGraphics.setLayer(this)}get element(){return this.content}}class PdfCollection{constructor(){}get count(){return void 0===this.collection&&(this.collection=[]),this.collection.length}get list(){return void 0===this.collection&&(this.collection=[]),this.collection}}class PdfPageLayerCollection extends PdfCollection{constructor(page){super(),this.parentLayerCount=0,this.sublayer=!1,this.optionalContent=new PdfDictionary,page instanceof PdfPageBase&&(this.page=page,this.parseLayers(page))}items(index,value){if("number"==typeof index&&void 0===value)return this.list[index];if(null==value)throw new Error("ArgumentNullException: layer");if(value.page!==this.page)throw new Error("ArgumentException: The layer belongs to another page")}add(firstArgument,secondArgument){if(void 0===firstArgument){let layer=new PdfPageLayer(this.page);return layer.name="",this.add(layer),layer}if(firstArgument instanceof PdfPageLayer){let index=this.list.push(firstArgument);return this.addLayer(index,firstArgument),index}return 0}addLayer(index,layer){let reference=new PdfReferenceHolder(layer);this.page.contents.add(reference)}insert(index,layer){let list=[],length=this.list.length;for(let i=index;i<length;i++)list.push(this.list.pop());this.list.push(layer);for(let i=0;i<list.length;i++)this.list.push(list[i]);this.insertLayer(index,layer)}insertLayer(index,layer){if(null==layer)throw new Error("ArgumentNullException:layer");let reference=new PdfReferenceHolder(layer);this.page.contents.insert(index,reference)}parseLayers(loadedPage){let contents=this.page.contents,crossTable=(this.page.getResources(),null);crossTable=loadedPage.crossTable;let saveStream=new ej2_pdf_export_es2015_PdfStream,restoreStream=new ej2_pdf_export_es2015_PdfStream,saveData=[];saveData.push("q"),saveStream.data=saveData,contents.insert(0,new PdfReferenceHolder(saveStream)),(saveData=[]).push("Q"),restoreStream.data=saveData,contents.insert(contents.count,new PdfReferenceHolder(restoreStream))}indexOf(layer){if(null==layer)throw new Error("ArgumentNullException: layer");return this.list.indexOf(layer)}}class PdfTemplate{constructor(arg1,arg2){if(this.dictionaryProperties=new DictionaryProperties,this.writeTransformation=!0,void 0===arg1);else if(arg1 instanceof SizeF&&void 0===arg2){this.content=new ej2_pdf_export_es2015_PdfStream;let tempSize=new SizeF(arg1.width,arg1.height);this.setSize(tempSize),this.initialize()}else this.content=new ej2_pdf_export_es2015_PdfStream,this.setSize(new SizeF(arg1,arg2)),this.initialize()}get size(){return this.templateSize}get width(){return this.size.width}get height(){return this.size.height}get graphics(){if(null==this.pdfGraphics||void 0===this.pdfGraphics){let gr=new GetResourceEventHandler(this),g=new PdfGraphics(this.size,gr,this.content);this.pdfGraphics=g,this.pdfGraphics.initializeCoordinates()}return this.pdfGraphics}getResources(){return null==this.resources&&(this.resources=new PdfResources,this.content.items.setValue(this.dictionaryProperties.resources,this.resources)),this.resources}initialize(){this.addType(),this.addSubType()}addType(){let value=new PdfName(this.dictionaryProperties.xObject);this.content.items.setValue(this.dictionaryProperties.type,value)}addSubType(){let value=new PdfName(this.dictionaryProperties.form);this.content.items.setValue(this.dictionaryProperties.subtype,value)}reset(size){void 0===size?(null!=this.resources&&(this.resources=null,this.content.remove(this.dictionaryProperties.resources)),null!=this.graphics&&this.graphics.reset(this.size)):(this.setSize(size),this.reset())}setSize(size){let rect=new RectangleF(new PointF(0,0),size),val=PdfArray.fromRectangle(rect);this.content.items.setValue(this.dictionaryProperties.bBox,val),this.templateSize=size}get element(){return this.content}}class PdfResources extends PdfDictionary{constructor(baseDictionary){super(baseDictionary),this.properties=new PdfDictionary}get names(){return this.getNames()}get document(){return this.pdfDocument}set document(value){this.pdfDocument=value}getName(obj){let primitive=obj.element,name=null;if(this.names.containsKey(primitive)&&(name=this.names.getValue(primitive)),null==name){let sName=this.generateName();name=new PdfName(sName),this.names.setValue(primitive,name),obj instanceof PdfFont?this.add(obj,name):obj instanceof PdfTemplate?this.add(obj,name):obj instanceof PdfTransparency?this.add(obj,name):(obj instanceof PdfImage||obj instanceof PdfBitmap)&&this.add(obj,name)}return name}getNames(){null==this.pdfNames&&(this.pdfNames=new TemporaryDictionary);let fonts=this.items.getValue(this.dictionaryProperties.font);if(null!=fonts){let dictionary=fonts;dictionary=PdfCrossTable.dereference(fonts)}return this.pdfNames}requireProcedureSet(procedureSetName){if(null==procedureSetName)throw new Error("ArgumentNullException:procedureSetName");let procSets=this.items.getValue(this.dictionaryProperties.procset);null==procSets&&(procSets=new PdfArray,this.items.setValue(this.dictionaryProperties.procset,procSets));let name=new PdfName(procedureSetName);procSets.contains(name)||procSets.add(name)}removeFont(name){let key=null,keys=this.pdfNames.keys();for(let index=0;index<this.pdfNames.size();index++)if(this.pdfNames.getValue(keys[index])===new PdfName(name)){key=keys[index];break}null!=key&&this.pdfNames.remove(key)}generateName(){return Guid.getNewGuidString()}add(arg1,arg2){if(arg1 instanceof PdfFont){let dictionary=null,fonts=this.items.getValue(this.dictionaryProperties.font);null!=fonts?(dictionary=fonts,dictionary=fonts):(dictionary=new PdfDictionary,this.items.setValue(this.dictionaryProperties.font,dictionary)),dictionary.items.setValue(arg2.value,new PdfReferenceHolder(arg1.element))}else if(arg1 instanceof PdfTemplate){let xobjects;null==(xobjects=this.items.getValue(this.dictionaryProperties.xObject))&&(xobjects=new PdfDictionary,this.items.setValue(this.dictionaryProperties.xObject,xobjects)),xobjects.items.setValue(arg2.value,new PdfReferenceHolder(arg1.element))}else if(arg1 instanceof PdfBrush);else if(arg1 instanceof PdfTransparency){let savable=arg1.element,transDic=null;null==(transDic=this.items.getValue(this.dictionaryProperties.extGState))&&(transDic=new PdfDictionary,this.items.setValue(this.dictionaryProperties.extGState,transDic)),transDic.items.setValue(arg2.value,new PdfReferenceHolder(savable))}else{let parentXObjects,xobjects=this.Dictionary.items.getValue(this.dictionaryProperties.xObject);void 0!==this.pdfDocument&&(parentXObjects=this.pdfDocument.sections.element.items.getValue(this.dictionaryProperties.resources).items.getValue(this.dictionaryProperties.xObject)),this.Dictionary.items.values();let oldReference,hasSameImageStream=!1;if(void 0===this.pdfDocument||void 0!==typeof parentXObjects&&null!=parentXObjects){if(void 0!==this.pdfDocument){let values=parentXObjects.items.values();for(let i=0;i<values.length;i++)void 0!==values[i]&&void 0!==values[i].element&&values[i].element.data[0]===arg1.element.data[0]&&(oldReference=values[i],hasSameImageStream=!0)}}else parentXObjects=new PdfDictionary,this.pdfDocument.sections.element.items.getValue(this.dictionaryProperties.resources).items.setValue(this.dictionaryProperties.xObject,parentXObjects);if(null==xobjects&&(xobjects=new PdfDictionary,this.Dictionary.items.setValue(this.dictionaryProperties.xObject,xobjects)),hasSameImageStream&&void 0!==oldReference)xobjects.items.setValue(arg2.value,oldReference);else{let reference=new PdfReferenceHolder(arg1.element);xobjects.items.setValue(arg2.value,reference),void 0!==this.pdfDocument&&parentXObjects.items.setValue(arg2.value,reference)}}}}let Guid=(()=>{class Guid{constructor(stringValue){this.stringValue=stringValue||Guid.getNewGuidString()}static get randomNumber(){return Guid.guid=Guid.guid+1,Guid.guid=Guid.guid>999999999999?0:Guid.guid,Guid.guid}toString(){return this.stringValue}static getNewGuidString(){let randomString=Guid.randomNumber.toString();return"abc7def4-ghi9-jkl2-m6n3-"+"opqrstuvwxyz".substr(0,12-randomString.length)+randomString}}return Guid.guid=0,Guid})();class PdfPageBase{constructor(dictionary){this.defLayerIndex=-1,this.modified=!1,this.dictionaryProperties=new DictionaryProperties,this.pageDictionary=dictionary}get section(){return this.pdfSection}set section(value){this.pdfSection=value}get dictionary(){return this.pageDictionary}get element(){return this.pageDictionary}get defaultLayer(){return this.layers.items(this.defaultLayerIndex)}get defaultLayerIndex(){if(0===this.layerCollection.count||-1===this.defLayerIndex){let layer=this.layerCollection.add();this.defLayerIndex=this.layerCollection.indexOf(layer)}return this.defLayerIndex}get layers(){return null!=this.layerCollection&&void 0!==this.layerCollection||(this.layerCollection=new PdfPageLayerCollection(this)),this.layerCollection}getResources(){return null==this.resources&&(this.resources=new PdfResources,this.dictionary.items.setValue(this.dictionaryProperties.resources,this.resources)),this.resources}get contents(){let contents=this.pageDictionary.items.getValue(this.dictionaryProperties.contents);return null==contents&&(contents=new PdfArray,this.pageDictionary.items.setValue(this.dictionaryProperties.contents,contents)),contents}set defaultLayerIndex(value){if(value<0||value>this.layers.count-1)throw new Error("ArgumentOutOfRangeException : value, Index can not be less 0 and greater Layers.Count - 1");this.defLayerIndex=value,this.modified=!0}setResources(res){this.resources=res,this.dictionary.items.setValue(this.dictionaryProperties.resources,this.resources),this.modified=!0}}class PdfAnnotationCollection{constructor(page){this.alreadyExistsAnnotationError="This annotatation had been already added to page",this.missingAnnotationException="Annotation is not contained in collection.",this.dictionaryProperties=new DictionaryProperties,this.internalAnnotations=new PdfArray,this.lists=[],void 0!==page&&(this.page=page)}get annotations(){return this.internalAnnotations}set annotations(value){this.internalAnnotations=value}add(annotation){this.doAdd(annotation)}doAdd(annotation){if(void 0===annotation.destination)return annotation.setPage(this.page),this.internalAnnotations.add(new PdfReferenceHolder(annotation)),this.lists.push(annotation);{let layoutResult=(new PdfStringLayouter).layout(annotation.text,annotation.font,annotation.stringFormat,new SizeF(annotation.bounds.width,0),!1,new SizeF(0,0)),lastPosition=annotation.bounds.y;if(1===layoutResult.lines.length){let size=annotation.font.measureString(layoutResult.lines[0].text);annotation.bounds=new RectangleF(new PointF(annotation.bounds.x,lastPosition),size),annotation.text=layoutResult.lines[0].text,this.page.graphics.drawString(annotation.text,annotation.font,null,annotation.brush,annotation.bounds.x,annotation.bounds.y,annotation.bounds.width,annotation.bounds.height,null),annotation.setPage(this.page),this.setColor(annotation),this.internalAnnotations.add(new PdfReferenceHolder(annotation)),this.lists.push(annotation)}else for(let i=0;i<layoutResult.lines.length;i++){let size=annotation.font.measureString(layoutResult.lines[i].text);if(0===i)annotation.bounds=new RectangleF(annotation.bounds.x,lastPosition,size.width,size.height),annotation.text=layoutResult.lines[i].text,this.page.graphics.drawString(annotation.text,annotation.font,null,annotation.brush,annotation.bounds.x,lastPosition,size.width,size.height,null),annotation.setPage(this.page),this.setColor(annotation),this.internalAnnotations.add(new PdfReferenceHolder(annotation)),this.lists.push(annotation),lastPosition+=annotation.bounds.height;else{let annot=annotation.clone();annot.bounds=new RectangleF(new PointF(annotation.bounds.x,lastPosition),size),annot.text=layoutResult.lines[i].text,this.page.graphics.drawString(annot.text,annot.font,null,annot.brush,annot.bounds.x,annot.bounds.y,annot.bounds.width,annot.bounds.height,null),annot.setPage(this.page),this.setColor(annot),this.internalAnnotations.add(new PdfReferenceHolder(annot)),this.lists.push(annot),lastPosition+=annot.bounds.height}}}}setColor(annotation){let colours=annotation.color.toArray(PdfColorSpace.Rgb);annotation.dictionary.items.setValue(this.dictionaryProperties.c,colours)}get element(){return this.internalAnnotations}}class PdfPage extends PdfPageBase{constructor(){super(new PdfDictionary),this.annotationCollection=null,this.beginSave=null,this.initialize()}get document(){return null!==this.section&&null!==this.section.parent?this.section.parent.document:null}get graphics(){let result=this.defaultLayer.graphics;return result.currentPage=this,result}get crossTable(){if(null===this.section)throw new Error("PdfDocumentException : Page is not created");return null===this.section.parent?this.section.parentDocument.crossTable:this.section.parent.document.crossTable}get size(){return this.section.pageSettings.size}get origin(){return this.section.pageSettings.origin}get annotations(){return null==this.annotationCollection&&(this.annotationCollection=new PdfAnnotationCollection(this),this.dictionary.items.setValue(this.dictionaryProperties.annots,this.annotationCollection.element),this.annotationCollection.annotations=this.dictionary.items.getValue(this.dictionaryProperties.annots)),this.annotationCollection}initialize(){this.dictionary.items.setValue(this.dictionaryProperties.type,new PdfName("Page")),this.dictionary.pageBeginDrawTemplate=new SaveTemplateEventHandler(this)}setSection(section){this.section=section,this.dictionary.items.setValue(this.dictionaryProperties.parent,new PdfReferenceHolder(section))}resetProgress(){this.isProgressOn=!1}getClientSize(){let returnValue=this.section.getActualBounds(this,!0);return new SizeF(returnValue.width,returnValue.height)}pageBeginSave(){let doc=this.document;void 0!==typeof doc&&null!=doc&&this.drawPageTemplates(doc),null!=this.beginSave&&void 0!==this.beginSave&&this.beginSave(this)}drawPageTemplates(document){if(this.section.containsTemplates(document,this,!1)){let backLayer=new PdfPageLayer(this,!1);if(this.layers.insert(0,backLayer),this.section.drawTemplates(this,backLayer,document,!1),null!=backLayer.graphics)for(let i=0;i<backLayer.graphics.automaticFields.automaticFields.length;i++){let fieldInfo=backLayer.graphics.automaticFields.automaticFields[i];fieldInfo.field.performDraw(backLayer.graphics,fieldInfo.location,fieldInfo.scalingX,fieldInfo.scalingY)}}if(this.section.containsTemplates(document,this,!0)){let frontLayer=new PdfPageLayer(this,!1);this.layers.add(frontLayer),this.section.drawTemplates(this,frontLayer,document,!0)}}}class PageAddedEventArgs{get page(){return this.pdfPage}constructor(page){this.pdfPage=void 0!==page?page:null}}class PdfSectionPageCollection{constructor(section){if(this.pdfSection=null,null==section)throw Error('ArgumentNullException("section")');this.section=section}get section(){return this.pdfSection}set section(value){this.pdfSection=value}contains(page){return this.section.contains(page)}remove(page){this.section.remove(page)}add(){return this.section.add()}}class PdfDocumentTemplate{get left(){return this.leftTemplate}set left(value){this.leftTemplate=this.checkElement(value,TemplateType.Left)}get top(){return this.topTemplate}set top(value){this.topTemplate=this.checkElement(value,TemplateType.Top)}get right(){return this.rightTemplate}set right(value){this.rightTemplate=this.checkElement(value,TemplateType.Right)}get bottom(){return this.bottomTemplate}set bottom(value){this.bottomTemplate=this.checkElement(value,TemplateType.Bottom)}get EvenLeft(){return this.evenLeft}set EvenLeft(value){this.evenLeft=this.checkElement(value,TemplateType.Left)}get EvenTop(){return this.evenTop}set EvenTop(value){this.evenTop=this.checkElement(value,TemplateType.Top)}get EvenRight(){return this.evenRight}set EvenRight(value){this.evenRight=this.checkElement(value,TemplateType.Right)}get EvenBottom(){return this.evenBottom}set EvenBottom(value){this.evenBottom=this.checkElement(value,TemplateType.Bottom)}get OddLeft(){return this.oddLeft}set OddLeft(value){this.oddLeft=this.checkElement(value,TemplateType.Left)}get OddTop(){return this.oddTop}set OddTop(value){this.oddTop=this.checkElement(value,TemplateType.Top)}get OddRight(){return this.oddRight}set OddRight(value){this.oddRight=this.checkElement(value,TemplateType.Right)}get OddBottom(){return this.oddBottom}set OddBottom(value){this.oddBottom=this.checkElement(value,TemplateType.Bottom)}constructor(){}getLeft(page){if(null==page)throw new Error("ArgumentNullException:page");return this.isEven(page)?null!=this.EvenLeft?this.EvenLeft:this.left:null!=this.OddLeft?this.OddLeft:this.left}getTop(page){if(null==page)throw new Error("ArgumentNullException:page");return this.isEven(page)?null!=this.EvenTop?this.EvenTop:this.top:null!=this.OddTop?this.OddTop:this.top}getRight(page){if(null==page)throw new Error("ArgumentNullException:page");return this.isEven(page)?null!=this.EvenRight?this.EvenRight:this.right:null!=this.OddRight?this.OddRight:this.right}getBottom(page){if(null==page)throw new Error("ArgumentNullException:page");return this.isEven(page)?null!=this.EvenBottom?this.EvenBottom:this.bottom:null!=this.OddBottom?this.OddBottom:this.bottom}isEven(page){let pages=page.section.document.pages,index=0;return(index=pages.pageCollectionIndex.containsKey(page)?pages.pageCollectionIndex.getValue(page)+1:pages.indexOf(page)+1)%2==0}checkElement(templateElement,type){if(null!=templateElement){if(void 0!==templateElement.type&&templateElement.type!==TemplateType.None)throw new Error("NotSupportedException:Can not reassign the template element. Please, create new one.");templateElement.type=type}return templateElement}}class PdfSectionTemplate extends PdfDocumentTemplate{get applyDocumentLeftTemplate(){return this.leftValue}set applyDocumentLeftTemplate(value){this.leftValue=value}get applyDocumentTopTemplate(){return this.topValue}set applyDocumentTopTemplate(value){this.topValue=value}get applyDocumentRightTemplate(){return this.rightValue}set applyDocumentRightTemplate(value){this.rightValue=value}get applyDocumentBottomTemplate(){return this.bottomValue}set applyDocumentBottomTemplate(value){this.bottomValue=value}get applyDocumentStamps(){return this.stampValue}set applyDocumentStamps(value){this.stampValue=value}constructor(){super(),this.leftValue=this.topValue=this.rightValue=this.bottomValue=this.stampValue=!0}}class PdfSection{constructor(document,pageSettings){this.pageAdded=new PageAddedEventArgs,this.pdfPages=[],this.dictionaryProperties=new DictionaryProperties,this.pdfDocument=document,void 0===pageSettings?(this.settings=document.pageSettings.clone(),this.initialSettings=this.settings.clone()):(this.settings=pageSettings.clone(),this.initialSettings=this.settings.clone()),this.initialize()}get parent(){return this.sectionCollection}set parent(value){this.sectionCollection=value,this.section.items.setValue(this.dictionaryProperties.parent,new PdfReferenceHolder(value))}get parentDocument(){return this.pdfDocument}get pageSettings(){return this.settings}set pageSettings(value){if(null==value)throw Error("Value can not be null.");this.settings=value}get element(){return this.section}get count(){return this.pagesReferences.count}get template(){return null==this.pageTemplate&&(this.pageTemplate=new PdfSectionTemplate),this.pageTemplate}set template(value){this.pageTemplate=value}get document(){return this.sectionCollection.document}get pages(){return null!=this.pagesCollection&&void 0!==this.pagesCollection||(this.pagesCollection=new PdfSectionPageCollection(this)),this.pagesCollection}getPages(){return this.pdfPages}pointToNativePdf(page,point){let bounds=this.getActualBounds(page,!0);return point.x+=bounds.x,point.y=this.pageSettings.height-point.y,point}setPageSettings(settings){this.settings=settings,this.state.orientation=settings.orientation,this.state.rotate=settings.rotate,this.state.size=settings.size,this.state.origin=settings.origin}initialize(){this.pagesReferences=new PdfArray,this.section=new PdfDictionary,this.state=new PageSettingsState(this.pdfDocument),this.section.sectionBeginSave=new SaveSectionEventHandler(this,this.state),this.pageCount=new PdfNumber(0),this.section.items.setValue(this.dictionaryProperties.count,this.pageCount),this.section.items.setValue(this.dictionaryProperties.type,new PdfName(this.dictionaryProperties.pages)),this.section.items.setValue(this.dictionaryProperties.kids,this.pagesReferences)}containsTemplates(document,page,foreground){let documentHeaders=this.getDocumentTemplates(document,page,foreground),sectionTemplates=this.getSectionTemplates(page,foreground);return documentHeaders.length>0||sectionTemplates.length>0}getDocumentTemplates(document,page,foreground){let templates=[];return this.template.applyDocumentTopTemplate&&null!=document.template.getTop(page)&&(!document.template.getTop(page).foreground&&!foreground||document.template.getTop(page).foreground&&foreground)&&templates.push(document.template.getTop(page)),this.template.applyDocumentBottomTemplate&&null!=document.template.getBottom(page)&&(!document.template.getBottom(page).foreground&&!foreground||document.template.getBottom(page).foreground&&foreground)&&templates.push(document.template.getBottom(page)),this.template.applyDocumentLeftTemplate&&null!=document.template.getLeft(page)&&(!document.template.getLeft(page).foreground&&!foreground||document.template.getLeft(page).foreground&&foreground)&&templates.push(document.template.getLeft(page)),this.template.applyDocumentRightTemplate&&null!=document.template.getRight(page)&&(!document.template.getRight(page).foreground&&!foreground||document.template.getRight(page).foreground&&foreground)&&templates.push(document.template.getRight(page)),templates}getSectionTemplates(page,foreground){let templates=[];if(null!=this.template.getTop(page)){let pageTemplate=this.template.getTop(page);(!pageTemplate.foreground&&!foreground||pageTemplate.foreground&&foreground)&&templates.push(pageTemplate)}if(null!=this.template.getBottom(page)){let pageTemplate=this.template.getBottom(page);(!pageTemplate.foreground&&!foreground||pageTemplate.foreground&&foreground)&&templates.push(pageTemplate)}if(null!=this.template.getLeft(page)){let pageTemplate=this.template.getLeft(page);(!pageTemplate.foreground&&!foreground||pageTemplate.foreground&&foreground)&&templates.push(pageTemplate)}if(null!=this.template.getRight(page)){let pageTemplate=this.template.getRight(page);(!pageTemplate.foreground&&!foreground||pageTemplate.foreground&&foreground)&&templates.push(pageTemplate)}return templates}add(page){if(void 0===page){let page=new PdfPage;return this.add(page),page}{let r=this.checkPresence(page);this.pdfPages.push(page),this.pagesReferences.add(r),page.setSection(this),page.resetProgress(),this.pageAddedMethod(page)}}checkPresence(page){let rh=new PdfReferenceHolder(page),contains=!1,sc=this.parent;for(let index=0;index<sc.section.length;index++){let section=sc.section[index];contains=contains||section.contains(page)}return rh}contains(page){return 0<=this.indexOf(page)}indexOf(page){for(let index=0;index<this.pdfPages.length;index++)if(this.pdfPages[index]===page)return this.pdfPages.indexOf(page);let r=new PdfReferenceHolder(page);return this.pagesReferences.indexOf(r)}pageAddedMethod(page){let args=new PageAddedEventArgs(page);this.onPageAdded(args),this.parent.document.pages.onPageAdded(args),this.pageCount.intValue=this.count}onPageAdded(args){}getActualBounds(arg1,arg2,arg3){if(arg1 instanceof PdfPage&&"boolean"==typeof arg2){let result;return result=this.getActualBounds(this.parent.document,arg1,arg2)}{arg1=arg1,arg2=arg2,arg3=arg3;let bounds=new RectangleF(0,0,0,0);bounds.height=arg3?this.pageSettings.size.height:this.pageSettings.getActualSize().height,bounds.width=arg3?this.pageSettings.size.width:this.pageSettings.getActualSize().width;let left=this.getLeftIndentWidth(arg1,arg2,arg3),top=this.getTopIndentHeight(arg1,arg2,arg3),right=this.getRightIndentWidth(arg1,arg2,arg3),bottom=this.getBottomIndentHeight(arg1,arg2,arg3);return bounds.x+=left,bounds.y+=top,bounds.width-=left+right,bounds.height-=top+bottom,bounds}}getLeftIndentWidth(document,page,includeMargins){if(null==document)throw new Error("ArgumentNullException:document");if(null==page)throw new Error("ArgumentNullException:page");let value=includeMargins?this.pageSettings.margins.left:0,templateWidth=null!=this.template.getLeft(page)?this.template.getLeft(page).width:0,docTemplateWidth=null!=document.template.getLeft(page)?document.template.getLeft(page).width:0;return value+(this.template.applyDocumentLeftTemplate?Math.max(templateWidth,docTemplateWidth):templateWidth)}getTopIndentHeight(document,page,includeMargins){if(null==document)throw new Error("ArgumentNullException:document");if(null==page)throw new Error("ArgumentNullException:page");let value=includeMargins?this.pageSettings.margins.top:0,templateHeight=null!=this.template.getTop(page)?this.template.getTop(page).height:0,docTemplateHeight=null!=document.template.getTop(page)?document.template.getTop(page).height:0;return value+(this.template.applyDocumentTopTemplate?Math.max(templateHeight,docTemplateHeight):templateHeight)}getRightIndentWidth(document,page,includeMargins){if(null==document)throw new Error("ArgumentNullException:document");if(null==page)throw new Error("ArgumentNullException:page");let value=includeMargins?this.pageSettings.margins.right:0,templateWidth=null!=this.template.getRight(page)?this.template.getRight(page).width:0,docTemplateWidth=null!=document.template.getRight(page)?document.template.getRight(page).width:0;return value+(this.template.applyDocumentRightTemplate?Math.max(templateWidth,docTemplateWidth):templateWidth)}getBottomIndentHeight(document,page,includeMargins){if(null==document)throw new Error("ArgumentNullException:document");if(null==page)throw new Error("ArgumentNullException:page");let value=includeMargins?this.pageSettings.margins.bottom:0,templateHeight=null!=this.template.getBottom(page)?this.template.getBottom(page).height:0,docTemplateHeight=null!=document.template.getBottom(page)?document.template.getBottom(page).height:0;return value+(this.template.applyDocumentBottomTemplate?Math.max(templateHeight,docTemplateHeight):templateHeight)}remove(page){if(null==page)throw Error('ArgumentNullException("page")');let index=this.pdfPages.indexOf(page);this.pagesReferences.removeAt(index);let temproaryPages=[];for(let j=0;j<index;j++)temproaryPages.push(this.pdfPages[j]);for(let j=index+1;j<this.pdfPages.length;j++)temproaryPages.push(this.pdfPages[j]);this.pdfPages=temproaryPages}applyPageSettings(container,parentSettings,state){let bounds=new RectangleF(state.origin,state.size);container.items.setValue(this.dictionaryProperties.mediaBox,PdfArray.fromRectangle(bounds));let rotate=0,angle=new PdfNumber(rotate=PdfSectionCollection.rotateFactor*state.rotate);container.items.setValue(this.dictionaryProperties.rotate,angle)}beginSave(state,writer){this.applyPageSettings(this.section,writer.document.pageSettings,state)}drawTemplates(page,layer,document,foreground){let documentHeaders=this.getDocumentTemplates(document,page,foreground),sectionHeaders=this.getSectionTemplates(page,foreground);this.drawTemplatesHelper(layer,document,documentHeaders),this.drawTemplatesHelper(layer,document,sectionHeaders)}drawTemplatesHelper(layer,document,templates){if(null!=templates&&templates.length>0){let len=templates.length;for(let i=0;i<len;i++)templates[i].draw(layer,document)}}}class PageSettingsState{get orientation(){return this.pageOrientation}set orientation(value){this.pageOrientation=value}get rotate(){return this.pageRotate}set rotate(value){this.pageRotate=value}get size(){return this.pageSize}set size(value){this.pageSize=value}get origin(){return this.pageOrigin}set origin(value){this.pageOrigin=value}constructor(document){this.pageOrientation=document.pageSettings.orientation,this.pageRotate=document.pageSettings.rotate,this.pageSize=document.pageSettings.size,this.pageOrigin=document.pageSettings.origin}}let PdfSectionCollection=(()=>{class PdfSectionCollection{constructor(document){this.sections=[],this.dictionaryProperties=new DictionaryProperties,this.pdfDocument=document.clone(),this.initialize()}get section(){return this.sections}get document(){return this.pdfDocument}get count(){return this.sections.length}get element(){return this.pages}initialize(){this.sectionCount=new PdfNumber(0),this.sectionCollection=new PdfArray,this.pages=new PdfDictionary,this.pages.beginSave=new SaveSectionCollectionEventHandler(this),this.pages.items.setValue(this.dictionaryProperties.type,new PdfName("Pages")),this.pages.items.setValue(this.dictionaryProperties.kids,this.sectionCollection),this.pages.items.setValue(this.dictionaryProperties.count,this.sectionCount),this.pages.items.setValue(this.dictionaryProperties.resources,new PdfDictionary),this.setPageSettings(this.pages,this.pdfDocument.pageSettings)}pdfSectionCollection(index){if(index<0||index>=this.count)throw new Error("IndexOutOfRangeException()");return this.sections[index]}setPageSettings(container,pageSettings){let bounds=new RectangleF(new PointF,pageSettings.size);container.items.setValue(this.dictionaryProperties.mediaBox,PdfArray.fromRectangle(bounds))}add(section){if(void 0===section){let section=new PdfSection(this.pdfDocument);return this.add(section),section}{let r=this.checkSection(section);return this.sections.push(section),section.parent=this,this.sectionCollection.add(r),this.sections.indexOf(section)}}checkSection(section){let r=new PdfReferenceHolder(section);return this.sectionCollection.contains(r),r}countPages(){let count=0;return this.sections.forEach(n=>count+=n.count),count}beginSave(){this.sectionCount.intValue=this.countPages()}}return PdfSectionCollection.rotateFactor=90,PdfSectionCollection})();class PdfDocumentPageCollection{constructor(document){this.pdfPageCollectionIndex=new Dictionary,this.document=document}get count(){return this.countPages()}get pageCollectionIndex(){return this.pdfPageCollectionIndex}add(page){if(void 0===page){let page=new PdfPage;return this.add(page),page}this.getLastSection().add(page)}getLastSection(){let sc=this.document.sections;return 0===sc.section.length&&sc.add(),sc.section[sc.section.length-1]}onPageAdded(args){}countPages(){let sc=this.document.sections,count=0;for(let index=0;index<sc.section.length;index++)count+=sc.section[index].count;return count}getPageByIndex(index){return this.getPage(index)}getPage(index){if(index<0||index>=this.count)throw Error('ArgumentOutOfRangeException("index", "Value can not be less 0")');let page=null,sectionStartIndex=0,sectionCount=0,pageIndex=0,length=this.document.sections.count;for(let i=0;i<length;i++){let section=this.document.sections.section[i];if(sectionCount=section.count,pageIndex=index-sectionStartIndex,index>=sectionStartIndex&&pageIndex<sectionCount){page=section.getPages()[pageIndex];break}sectionStartIndex+=sectionCount}return page}indexOf(page){let index=-1;if(null==page)throw new Error("ArgumentNullException: page");{let numPages=0;for(let i=0,len=this.document.sections.count;i<len;i++){let section=this.document.sections.pdfSectionCollection(i);if((index=section.indexOf(page))>=0){index+=numPages;break}index=-1,numPages+=section.count}}return index}remove(page){if(null==page)throw Error('ArgumentNullException("page")');let section=null;for(let i=0,len=this.document.sections.count;i<len;i++)if((section=this.document.sections.pdfSectionCollection(i)).pages.contains(page)){section.pages.remove(page);break}return section}}class PdfCacheCollection{constructor(){this.referenceObjects=[],this.pdfFontCollection=new Dictionary}search(obj){let result=null,group=this.getGroup(obj);return null==group?group=this.createNewGroup():group.length>0&&(result=group[0]),group.push(obj),result}createNewGroup(){let group=[];return this.referenceObjects.push(group),group}getGroup(result){let group=null;if(null!==result){let len=this.referenceObjects.length;for(let i=0;i<len;i++){if(this.referenceObjects.length>0){let tGroup=this.referenceObjects[i];if(tGroup.length>0){if(result.equalsTo(tGroup[0])){group=tGroup;break}}else this.removeGroup(tGroup)}len=this.referenceObjects.length}}return group}removeGroup(group){if(null!==group){let index=this.referenceObjects.indexOf(group);this.referenceObjects.slice(index,index+1)}}destroy(){this.pdfFontCollection=void 0,this.referenceObjects=void 0}}let PdfDocument=(()=>{class PdfDocument extends ej2_pdf_export_es2015_PdfDocumentBase{constructor(isMerging){super(),this.defaultMargin=40,this.streamWriter=null,this.document=this;let isMerge=!1;void 0===isMerging?(PdfDocument.cacheCollection=new PdfCacheCollection,isMerge=!1):isMerge=isMerging;let objects=new PdfMainObjectCollection;this.setMainObjectCollection(objects);let crossTable=new PdfCrossTable;crossTable.isMerging=isMerge,crossTable.document=this,this.setCrossTable(crossTable);let catalog=new PdfCatalog;this.setCatalog(catalog),objects.add(catalog),catalog.position=-1,this.sectionCollection=new PdfSectionCollection(this),this.documentPageCollection=new PdfDocumentPageCollection(this),catalog.pages=this.sectionCollection}static get defaultFont(){return null==this.defaultStandardFont&&(this.defaultStandardFont=new PdfStandardFont(PdfFontFamily.Helvetica,8)),this.defaultStandardFont}get sections(){return this.sectionCollection}get pageSettings(){return null==this.settings&&(this.settings=new PdfPageSettings(this.defaultMargin)),this.settings}set pageSettings(value){this.settings=value}get pages(){return this.documentPageCollection}static get cache(){return void 0===PdfDocument.cacheCollection||null==PdfDocument.cacheCollection?new PdfCacheCollection:PdfDocument.cacheCollection}static set cache(value){this.cacheCollection=value}static get enableCache(){return this.isCacheEnabled}static set enableCache(value){this.isCacheEnabled=value}get colorSpace(){return this.pdfColorSpace===PdfColorSpace.Rgb||this.pdfColorSpace===PdfColorSpace.Cmyk||this.pdfColorSpace===PdfColorSpace.GrayScale?this.pdfColorSpace:PdfColorSpace.Rgb}set colorSpace(value){this.pdfColorSpace=value===PdfColorSpace.Rgb||value===PdfColorSpace.Cmyk||value===PdfColorSpace.GrayScale?value:PdfColorSpace.Rgb}get template(){return null==this.pageTemplate&&(this.pageTemplate=new PdfDocumentTemplate),this.pageTemplate}set template(value){this.pageTemplate=value}docSave(stream,arg2,arg3){if(this.checkPagesPresence(),null===stream)throw new Error("ArgumentNullException : stream");this.streamWriter=stream;let writer=new PdfWriter(stream);if(writer.document=this,"boolean"==typeof arg2&&void 0===arg3)return this.crossTable.save(writer);this.crossTable.save(writer,arg2)}checkPagesPresence(){0===this.pages.count&&this.pages.add()}destroy(){this.catalog=void 0,this.colorSpace=void 0,this.currentSavingObj=void 0,this.documentPageCollection=void 0,this.isStreamCopied=void 0,this.pageSettings=void 0,this.pageTemplate=void 0,this.pdfColorSpace=void 0,this.sectionCollection=void 0,PdfDocument.cache.destroy(),this.crossTable.pdfObjects.destroy(),PdfDocument.cache=void 0,this.streamWriter.destroy()}}return PdfDocument.defaultStandardFont=null,PdfDocument.isCacheEnabled=!0,PdfDocument})(),PdfStandardFontMetricsFactory=(()=>{class PdfStandardFontMetricsFactory{static getMetrics(fontFamily,fontStyle,size){let metrics=null;switch(fontFamily){case PdfFontFamily.Helvetica:metrics=this.getHelveticaMetrics(fontFamily,fontStyle,size);break;case PdfFontFamily.Courier:metrics=this.getCourierMetrics(fontFamily,fontStyle,size);break;case PdfFontFamily.TimesRoman:metrics=this.getTimesMetrics(fontFamily,fontStyle,size);break;case PdfFontFamily.Symbol:metrics=this.getSymbolMetrics(fontFamily,fontStyle,size);break;case PdfFontFamily.ZapfDingbats:metrics=this.getZapfDingbatsMetrics(fontFamily,fontStyle,size);break;default:metrics=this.getHelveticaMetrics(PdfFontFamily.Helvetica,fontStyle,size)}return metrics.name=fontFamily.toString(),metrics.subScriptSizeFactor=this.subSuperScriptFactor,metrics.superscriptSizeFactor=this.subSuperScriptFactor,metrics}static getHelveticaMetrics(fontFamily,fontStyle,size){let metrics=new PdfFontMetrics;return(fontStyle&PdfFontStyle.Bold)>0&&(fontStyle&PdfFontStyle.Italic)>0?(metrics.ascent=this.helveticaBoldItalicAscent,metrics.descent=this.helveticaBoldItalicDescent,metrics.postScriptName=this.helveticaBoldItalicName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.arialBoldWidth),metrics.height=metrics.ascent-metrics.descent):(fontStyle&PdfFontStyle.Bold)>0?(metrics.ascent=this.helveticaBoldAscent,metrics.descent=this.helveticaBoldDescent,metrics.postScriptName=this.helveticaBoldName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.arialBoldWidth),metrics.height=metrics.ascent-metrics.descent):(fontStyle&PdfFontStyle.Italic)>0?(metrics.ascent=this.helveticaItalicAscent,metrics.descent=this.helveticaItalicDescent,metrics.postScriptName=this.helveticaItalicName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.arialWidth),metrics.height=metrics.ascent-metrics.descent):(metrics.ascent=this.helveticaAscent,metrics.descent=this.helveticaDescent,metrics.postScriptName=this.helveticaName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.arialWidth),metrics.height=metrics.ascent-metrics.descent),metrics}static getCourierMetrics(fontFamily,fontStyle,size){let metrics=new PdfFontMetrics;return(fontStyle&PdfFontStyle.Bold)>0&&(fontStyle&PdfFontStyle.Italic)>0?(metrics.ascent=this.courierBoldItalicAscent,metrics.descent=this.courierBoldItalicDescent,metrics.postScriptName=this.courierBoldItalicName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.fixedWidth),metrics.height=metrics.ascent-metrics.descent):(fontStyle&PdfFontStyle.Bold)>0?(metrics.ascent=this.courierBoldAscent,metrics.descent=this.courierBoldDescent,metrics.postScriptName=this.courierBoldName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.fixedWidth),metrics.height=metrics.ascent-metrics.descent):(fontStyle&PdfFontStyle.Italic)>0?(metrics.ascent=this.courierItalicAscent,metrics.descent=this.courierItalicDescent,metrics.postScriptName=this.courierItalicName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.fixedWidth),metrics.height=metrics.ascent-metrics.descent):(metrics.ascent=this.courierAscent,metrics.descent=this.courierDescent,metrics.postScriptName=this.courierName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.fixedWidth),metrics.height=metrics.ascent-metrics.descent),metrics}static getTimesMetrics(fontFamily,fontStyle,size){let metrics=new PdfFontMetrics;return(fontStyle&PdfFontStyle.Bold)>0&&(fontStyle&PdfFontStyle.Italic)>0?(metrics.ascent=this.timesBoldItalicAscent,metrics.descent=this.timesBoldItalicDescent,metrics.postScriptName=this.timesBoldItalicName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.timesRomanBoldItalicWidths),metrics.height=metrics.ascent-metrics.descent):(fontStyle&PdfFontStyle.Bold)>0?(metrics.ascent=this.timesBoldAscent,metrics.descent=this.timesBoldDescent,metrics.postScriptName=this.timesBoldName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.timesRomanBoldWidth),metrics.height=metrics.ascent-metrics.descent):(fontStyle&PdfFontStyle.Italic)>0?(metrics.ascent=this.timesItalicAscent,metrics.descent=this.timesItalicDescent,metrics.postScriptName=this.timesItalicName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.timesRomanItalicWidth),metrics.height=metrics.ascent-metrics.descent):(metrics.ascent=this.timesAscent,metrics.descent=this.timesDescent,metrics.postScriptName=this.timesName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.timesRomanWidth),metrics.height=metrics.ascent-metrics.descent),metrics}static getSymbolMetrics(fontFamily,fontStyle,size){let metrics=new PdfFontMetrics;return metrics.ascent=this.symbolAscent,metrics.descent=this.symbolDescent,metrics.postScriptName=this.symbolName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.symbolWidth),metrics.height=metrics.ascent-metrics.descent,metrics}static getZapfDingbatsMetrics(fontFamily,fontStyle,size){let metrics=new PdfFontMetrics;return metrics.ascent=this.zapfDingbatsAscent,metrics.descent=this.zapfDingbatsDescent,metrics.postScriptName=this.zapfDingbatsName,metrics.size=size,metrics.widthTable=new StandardWidthTable(this.zapfDingbatsWidth),metrics.height=metrics.ascent-metrics.descent,metrics}}return PdfStandardFontMetricsFactory.subSuperScriptFactor=1.52,PdfStandardFontMetricsFactory.helveticaAscent=931,PdfStandardFontMetricsFactory.helveticaDescent=-225,PdfStandardFontMetricsFactory.helveticaName="Helvetica",PdfStandardFontMetricsFactory.helveticaBoldAscent=962,PdfStandardFontMetricsFactory.helveticaBoldDescent=-228,PdfStandardFontMetricsFactory.helveticaBoldName="Helvetica-Bold",PdfStandardFontMetricsFactory.helveticaItalicAscent=931,PdfStandardFontMetricsFactory.helveticaItalicDescent=-225,PdfStandardFontMetricsFactory.helveticaItalicName="Helvetica-Oblique",PdfStandardFontMetricsFactory.helveticaBoldItalicAscent=962,PdfStandardFontMetricsFactory.helveticaBoldItalicDescent=-228,PdfStandardFontMetricsFactory.helveticaBoldItalicName="Helvetica-BoldOblique",PdfStandardFontMetricsFactory.courierAscent=805,PdfStandardFontMetricsFactory.courierDescent=-250,PdfStandardFontMetricsFactory.courierName="Courier",PdfStandardFontMetricsFactory.courierBoldAscent=801,PdfStandardFontMetricsFactory.courierBoldDescent=-250,PdfStandardFontMetricsFactory.courierBoldName="Courier-Bold",PdfStandardFontMetricsFactory.courierItalicAscent=805,PdfStandardFontMetricsFactory.courierItalicDescent=-250,PdfStandardFontMetricsFactory.courierItalicName="Courier-Oblique",PdfStandardFontMetricsFactory.courierBoldItalicAscent=801,PdfStandardFontMetricsFactory.courierBoldItalicDescent=-250,PdfStandardFontMetricsFactory.courierBoldItalicName="Courier-BoldOblique",PdfStandardFontMetricsFactory.timesAscent=898,PdfStandardFontMetricsFactory.timesDescent=-218,PdfStandardFontMetricsFactory.timesName="Times-Roman",PdfStandardFontMetricsFactory.timesBoldAscent=935,PdfStandardFontMetricsFactory.timesBoldDescent=-218,PdfStandardFontMetricsFactory.timesBoldName="Times-Bold",PdfStandardFontMetricsFactory.timesItalicAscent=883,PdfStandardFontMetricsFactory.timesItalicDescent=-217,PdfStandardFontMetricsFactory.timesItalicName="Times-Italic",PdfStandardFontMetricsFactory.timesBoldItalicAscent=921,PdfStandardFontMetricsFactory.timesBoldItalicDescent=-218,PdfStandardFontMetricsFactory.timesBoldItalicName="Times-BoldItalic",PdfStandardFontMetricsFactory.symbolAscent=1010,PdfStandardFontMetricsFactory.symbolDescent=-293,PdfStandardFontMetricsFactory.symbolName="Symbol",PdfStandardFontMetricsFactory.zapfDingbatsAscent=820,PdfStandardFontMetricsFactory.zapfDingbatsDescent=-143,PdfStandardFontMetricsFactory.zapfDingbatsName="ZapfDingbats",PdfStandardFontMetricsFactory.arialWidth=[278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,0,556,0,222,556,333,1e3,556,556,333,1e3,667,333,1e3,0,611,0,0,222,222,333,333,350,556,1e3,333,1e3,500,333,944,0,500,667,0,333,556,556,556,556,260,556,333,737,370,556,584,0,737,333,400,584,333,333,333,556,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,584,611,556,556,556,556,500,556,500],PdfStandardFontMetricsFactory.arialBoldWidth=[278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,0,556,0,278,556,500,1e3,556,556,333,1e3,667,333,1e3,0,611,0,0,278,278,500,500,350,556,1e3,333,1e3,556,333,944,0,500,667,0,333,556,556,556,556,280,556,333,737,370,556,584,0,737,333,400,584,333,333,333,611,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,584,611,611,611,611,611,556,611,556],PdfStandardFontMetricsFactory.fixedWidth=[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],PdfStandardFontMetricsFactory.timesRomanWidth=[250,333,408,500,500,833,778,180,333,333,500,564,250,333,250,278,500,500,500,500,500,500,500,500,500,500,278,278,564,564,564,444,921,722,667,667,722,611,556,722,722,333,389,722,611,889,722,722,556,722,667,556,611,722,722,944,722,722,611,333,278,333,469,500,333,444,500,444,500,444,333,500,500,278,278,500,278,778,500,500,500,500,333,389,278,500,500,722,500,500,444,480,200,480,541,0,500,0,333,500,444,1e3,500,500,333,1e3,556,333,889,0,611,0,0,333,333,444,444,350,500,1e3,333,980,389,333,722,0,444,722,0,333,500,500,500,500,200,500,333,760,276,500,564,0,760,333,400,564,300,300,333,500,453,250,333,300,310,500,750,750,750,444,722,722,722,722,722,722,889,667,611,611,611,611,333,333,333,333,722,722,722,722,722,722,722,564,722,722,722,722,722,722,556,500,444,444,444,444,444,444,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,564,500,500,500,500,500,500,500,500],PdfStandardFontMetricsFactory.timesRomanBoldWidth=[250,333,555,500,500,1e3,833,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,930,722,667,722,722,667,611,778,778,389,500,778,667,944,722,778,611,778,722,556,667,722,722,1e3,722,722,667,333,278,333,581,500,333,500,556,444,556,444,333,500,556,278,333,556,278,833,556,500,556,556,444,389,333,556,500,722,500,500,444,394,220,394,520,0,500,0,333,500,500,1e3,500,500,333,1e3,556,333,1e3,0,667,0,0,333,333,500,500,350,500,1e3,333,1e3,389,333,722,0,444,722,0,333,500,500,500,500,220,500,333,747,300,500,570,0,747,333,400,570,300,300,333,556,540,250,333,300,330,500,750,750,750,500,722,722,722,722,722,722,1e3,722,667,667,667,667,389,389,389,389,722,722,778,778,778,778,778,570,778,722,722,722,722,722,611,556,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,500,556,500],PdfStandardFontMetricsFactory.timesRomanItalicWidth=[250,333,420,500,500,833,778,214,333,333,500,675,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,675,675,675,500,920,611,611,667,722,611,611,722,722,333,444,667,556,833,667,722,611,722,611,500,556,722,611,833,611,556,556,389,278,389,422,500,333,500,500,444,500,444,278,500,500,278,278,444,278,722,500,500,500,500,389,389,278,500,444,667,444,444,389,400,275,400,541,0,500,0,333,500,556,889,500,500,333,1e3,500,333,944,0,556,0,0,333,333,556,556,350,500,889,333,980,389,333,667,0,389,556,0,389,500,500,500,500,275,500,333,760,276,500,675,0,760,333,400,675,300,300,333,500,523,250,333,300,310,500,750,750,750,500,611,611,611,611,611,611,889,667,611,611,611,611,333,333,333,333,722,667,722,722,722,722,722,675,722,722,722,722,722,556,611,500,500,500,500,500,500,500,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,675,500,500,500,500,500,444,500,444],PdfStandardFontMetricsFactory.timesRomanBoldItalicWidths=[250,389,555,500,500,833,778,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,832,667,667,667,722,667,667,722,778,389,500,667,611,889,722,722,611,722,667,556,611,722,667,889,667,611,611,333,278,333,570,500,333,500,500,444,500,444,333,500,556,278,278,500,278,778,556,500,500,500,389,389,278,556,444,667,500,444,389,348,220,348,570,0,500,0,333,500,500,1e3,500,500,333,1e3,556,333,944,0,611,0,0,333,333,500,500,350,500,1e3,333,1e3,389,333,722,0,389,611,0,389,500,500,500,500,220,500,333,747,266,500,606,0,747,333,400,570,300,300,333,576,500,250,333,300,300,500,750,750,750,500,667,667,667,667,667,667,944,667,667,667,667,667,389,389,389,389,722,722,722,722,722,722,722,570,722,722,722,722,722,611,611,500,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,444,500,444],PdfStandardFontMetricsFactory.symbolWidth=[250,333,713,500,549,833,778,439,333,333,500,549,250,549,250,278,500,500,500,500,500,500,500,500,500,500,278,278,549,549,549,444,549,722,667,722,612,611,763,603,722,333,631,722,686,889,722,722,768,741,556,592,611,690,439,768,645,795,611,333,863,333,658,500,500,631,549,549,494,439,521,411,603,329,603,549,549,576,521,549,549,521,549,603,439,576,713,686,493,686,494,480,200,480,549,750,620,247,549,167,713,500,753,753,753,753,1042,987,603,987,603,400,549,411,549,549,713,494,460,549,549,549,549,1e3,603,1e3,658,823,686,795,987,768,768,823,768,768,713,713,713,713,713,713,713,768,713,790,790,890,823,549,250,713,603,603,1042,987,603,987,603,494,329,790,790,786,713,384,384,384,384,384,384,494,494,494,494,329,274,686,686,686,384,384,384,384,384,384,494,494,494,-1],PdfStandardFontMetricsFactory.zapfDingbatsWidth=[278,974,961,974,980,719,789,790,791,690,960,939,549,855,911,933,911,945,974,755,846,762,761,571,677,763,760,759,754,494,552,537,577,692,786,788,788,790,793,794,816,823,789,841,823,833,816,831,923,744,723,749,790,792,695,776,768,792,759,707,708,682,701,826,815,789,789,707,687,696,689,786,787,713,791,785,791,873,761,762,762,759,759,892,892,788,784,438,138,277,415,392,392,668,668,390,390,317,317,276,276,509,509,410,410,234,234,334,334,732,544,544,910,667,760,760,776,595,694,626,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,894,838,1016,458,748,924,748,918,927,928,928,834,873,828,924,924,917,930,931,463,883,836,836,867,867,696,696,874,874,760,946,771,865,771,888,967,888,831,873,927,970,918],PdfStandardFontMetricsFactory})(),PdfStandardFont=(()=>{class PdfStandardFont extends PdfFont{constructor(fontFamilyPrototype,size,style){super(size,void 0===style?fontFamilyPrototype instanceof PdfStandardFont?fontFamilyPrototype.style:PdfFontStyle.Regular:style),this.dictionaryProperties=new DictionaryProperties,this.encodings=["Unknown","StandardEncoding","MacRomanEncoding","MacExpertEncoding","WinAnsiEncoding","PDFDocEncoding","IdentityH"],this.pdfFontFamily=void 0===fontFamilyPrototype?PdfFontFamily.Helvetica:fontFamilyPrototype instanceof PdfStandardFont?fontFamilyPrototype.fontFamily:fontFamilyPrototype,this.checkStyle(),this.initializeInternals()}get fontFamily(){return this.pdfFontFamily}checkStyle(){if(this.fontFamily===PdfFontFamily.Symbol||this.fontFamily===PdfFontFamily.ZapfDingbats){let style=this.style;this.setStyle(style&=~(PdfFontStyle.Bold|PdfFontStyle.Italic))}}getLineWidth(line,format){if(null==line)throw new Error("ArgumentNullException:line");let width=0;for(let i=0,len=(line=PdfStandardFont.convert(line)).length;i<len;i++)width+=this.getCharWidthInternal(line[i],format);let size=this.metrics.getSize(format);return this.applyFormatSettings(line,format,width*=PdfFont.charSizeMultiplier*size)}equalsToFont(font){let equal=!1;if(null!=font){let lineReducer=~(PdfFontStyle.Underline|PdfFontStyle.Strikeout),styleEqual=(this.style&lineReducer)==(font.style&lineReducer);equal=this.fontFamily===font.fontFamily&&styleEqual}return equal}initializeInternals(){let equalFont=null;equalFont=PdfDocument.cache.search(this);let internals=null,metrics=PdfStandardFontMetricsFactory.getMetrics(this.pdfFontFamily,this.style,this.size);this.metrics=metrics,internals=this.createInternals(),this.setInternals(internals)}createInternals(){let dictionary=new PdfDictionary;return dictionary.items.setValue(this.dictionaryProperties.type,new PdfName(this.dictionaryProperties.font)),dictionary.items.setValue(this.dictionaryProperties.subtype,new PdfName(this.dictionaryProperties.type1)),dictionary.items.setValue(this.dictionaryProperties.baseFont,new PdfName(this.metrics.postScriptName)),this.fontFamily!==PdfFontFamily.Symbol&&this.fontFamily!==PdfFontFamily.ZapfDingbats&&dictionary.items.setValue(this.dictionaryProperties.encoding,new PdfName(this.encodings[FontEncoding.WinAnsiEncoding])),dictionary}getCharWidthInternal(charCode,format){let code=0;return code=charCode.charCodeAt(0),"0"!==this.name&&"1"!==this.name&&"2"!==this.name&&"3"!==this.name&&"4"!==this.name||(code-=PdfStandardFont.charOffset),this.metrics.widthTable.items(code=code>=0&&128!==code?code:0)}static convert(text){return text}}return PdfStandardFont.charOffset=32,PdfStandardFont})();class PdfAnnotation{constructor(arg1){this.dictionaryProperties=new DictionaryProperties,this.pdfColor=new PdfColor(255,255,255),this.rectangle=new RectangleF(0,0,0,0),this.pdfPage=null,this.textBrush=new PdfSolidBrush(new PdfColor(0,0,0)),this.textFont=new PdfStandardFont(PdfFontFamily.TimesRoman,10),this.format=new PdfStringFormat(PdfTextAlignment.Left),this.content="",this.pdfDictionary=new PdfDictionary,this.internalColor=new PdfColor,this.darkness=1,void 0===arg1?this.initialize():(this.initialize(),this.bounds=arg1)}get color(){return this.pdfColor}set color(value){this.pdfColor=value}get innerColor(){return this.internalColor}set innerColor(value){this.internalColor=value}get bounds(){return this.rectangle}set bounds(value){this.rectangle=value}get page(){return this.pdfPage}get font(){return this.textFont}set font(value){this.textFont=value}get stringFormat(){return this.format}set stringFormat(value){this.format=value}get brush(){return this.textBrush}set brush(value){this.textBrush=value}get text(){return this.content}set text(value){this.content=value,this.dictionary.items.setValue(this.dictionaryProperties.contents,new PdfString(this.content))}get dictionary(){return this.pdfDictionary}set dictionary(value){this.pdfDictionary=value}initialize(){this.pdfDictionary.annotationBeginSave=new SaveAnnotationEventHandler(this),this.pdfDictionary.items.setValue(this.dictionaryProperties.type,new PdfName(this.dictionaryProperties.annot))}setPage(page){this.pdfPage=page,this.pdfDictionary.items.setValue(this.dictionaryProperties.p,new PdfReferenceHolder(this.pdfPage))}beginSave(){this.save()}save(){let nativeRectangle=new RectangleF(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),initialHeight=nativeRectangle.height,tempLoacation=this.pdfPage.section.pointToNativePdf(this.page,new PointF(nativeRectangle.x,nativeRectangle.y));nativeRectangle.x=tempLoacation.x,nativeRectangle.width=tempLoacation.x+nativeRectangle.width,nativeRectangle.y=tempLoacation.y-this.page.document.pageSettings.margins.top,nativeRectangle.height=nativeRectangle.y-initialHeight,this.pdfDictionary.items.setValue(this.dictionaryProperties.rect,PdfArray.fromRectangle(nativeRectangle)),this.dictionary.items.setValue(this.dictionaryProperties.ca,new PdfNumber(this.darkness))}get element(){return this.pdfDictionary}}class PdfLinkAnnotation extends PdfAnnotation{constructor(rectangle){super(rectangle)}initialize(){super.initialize(),this.dictionary.items.setValue(this.dictionaryProperties.subtype,new PdfName(this.dictionaryProperties.link))}}class PdfActionLinkAnnotation extends PdfLinkAnnotation{constructor(rectangle){super(rectangle),this.pdfAction=null}getSetAction(value){if(void 0===value)return this.pdfAction;this.pdfAction=value}}class ElementLayouter{constructor(element){this.layoutElement=element}get elements(){return this.layoutElement}getElement(){return this.layoutElement}layout(param){return this.layoutInternal(param)}Layouter(param){return this.layoutInternal(param)}getNextPage(currentPage){return currentPage.section.add()}}class PdfLayoutFormat{get layout(){return this.layoutType}set layout(value){this.layoutType=value}get break(){return this.breakType}set break(value){this.breakType=value}get paginateBounds(){return void 0===this.layoutPaginateBounds&&null==this.layoutPaginateBounds&&(this.layoutPaginateBounds=new RectangleF(0,0,0,0)),this.layoutPaginateBounds}set paginateBounds(value){this.layoutPaginateBounds=value,this.boundsSet=!0}get usePaginateBounds(){return this.boundsSet}constructor(baseFormat){void 0===baseFormat||(this.break=baseFormat.break,this.layout=baseFormat.layout,this.paginateBounds=baseFormat.paginateBounds,this.boundsSet=baseFormat.usePaginateBounds)}}class PdfLayoutParams{get page(){return this.pdfPage}set page(value){this.pdfPage=value}get bounds(){return new RectangleF(this.layoutBounds.x,this.layoutBounds.y,this.layoutBounds.width,this.layoutBounds.height)}set bounds(value){this.layoutBounds=value}get format(){return this.layoutFormat}set format(value){this.layoutFormat=value}}class PdfLayoutResult{get page(){return this.pdfPage}get bounds(){return this.layoutBounds}constructor(page,bounds){this.pdfPage=page,this.layoutBounds=bounds}}class PdfLayoutElement{get raiseBeginPageLayout(){return void 0!==this.beginPageLayout}get raiseEndPageLayout(){return void 0!==this.endPageLayout}onBeginPageLayout(args){this.beginPageLayout&&this.beginPageLayout(this,args)}onEndPageLayout(args){this.endPageLayout&&this.endPageLayout(this,args)}drawHelper(arg2,arg3,arg4,arg5){if(arg3 instanceof PointF&&void 0===arg3.width&&void 0===arg4)return this.drawHelper(arg2,arg3.x,arg3.y);if("number"==typeof arg3&&"number"==typeof arg4&&void 0===arg5)return this.drawHelper(arg2,arg3,arg4,null);if(arg3 instanceof RectangleF&&void 0!==arg3.width&&void 0===arg4)return this.drawHelper(arg2,arg3,null);if(arg3 instanceof PointF&&void 0===arg3.width&&arg4 instanceof PdfLayoutFormat)return this.drawHelper(arg2,arg3.x,arg3.y,arg4);if("number"==typeof arg3&&"number"==typeof arg4&&(arg5 instanceof PdfLayoutFormat||null==arg5)){let layoutRectangle=new RectangleF(arg3,arg4,arg2.graphics.clientSize.width-arg3,0);return this.drawHelper(arg2,layoutRectangle,arg5)}if(arg3 instanceof RectangleF&&void 0!==arg3.width&&"boolean"==typeof arg4)return this.bEmbedFonts=arg4,this.drawHelper(arg2,arg3,null);{let param=new PdfLayoutParams,temparg3=arg3,temparg4=arg4;return param.page=arg2,param.bounds=temparg3,param.format=null!=temparg4?temparg4:new PdfLayoutFormat,this.layout(param)}}}var PdfLayoutType=function(PdfLayoutType){return PdfLayoutType[PdfLayoutType.Paginate=0]="Paginate",PdfLayoutType[PdfLayoutType.OnePage=1]="OnePage",PdfLayoutType}({}),PdfLayoutBreakType=function(PdfLayoutBreakType){return PdfLayoutBreakType[PdfLayoutBreakType.FitPage=0]="FitPage",PdfLayoutBreakType[PdfLayoutBreakType.FitElement=1]="FitElement",PdfLayoutBreakType[PdfLayoutBreakType.FitColumnsToPage=2]="FitColumnsToPage",PdfLayoutBreakType}({});class TextLayouter extends ElementLayouter{get element(){return super.getElement()}constructor(element){super(element)}layoutInternal(param){this.format=null!=this.element.stringFormat?this.element.stringFormat:null;let currentPage=param.page,currentBounds=param.bounds,text=this.element.value,result=null,pageResult=new TextPageLayoutResult;for(pageResult.page=currentPage,pageResult.remainder=text;;){pageResult=this.layoutOnPage(text,currentPage,currentBounds,param),result=this.getLayoutResult(pageResult);break}return result}getLayoutResult(pageResult){return new PdfTextLayoutResult(pageResult.page,pageResult.bounds,pageResult.remainder,pageResult.lastLineBounds)}layoutOnPage(text,currentPage,currentBounds,param){let result=new TextPageLayoutResult;result.remainder=text,result.page=currentPage,currentBounds=this.checkCorrectBounds(currentPage,currentBounds);let stringResult=(new PdfStringLayouter).layout(text,this.element.font,this.format,currentBounds,currentPage.getClientSize().height,!1,new SizeF(0,0)),textFinished=null==stringResult.remainder,graphics=currentPage.graphics,brush=this.element.getBrush();return this.element instanceof PdfTextWebLink&&(brush.color=new PdfColor(0,0,255)),graphics.drawStringLayoutResult(stringResult,this.element.font,this.element.pen,brush,currentBounds,this.format),result.lastLineBounds=graphics.getLineBounds(stringResult.lineCount-1,stringResult,this.element.font,currentBounds,this.format),result.bounds=this.getTextPageBounds(currentPage,currentBounds,stringResult),result.remainder=stringResult.remainder,result.end=textFinished,result}checkCorrectBounds(currentPage,currentBounds){return currentBounds.height=currentBounds.height>0?currentBounds.height:currentPage.graphics.clientSize.height-currentBounds.y,currentBounds}getTextPageBounds(currentPage,currentBounds,stringResult){let textSize=stringResult.actualSize,x=currentBounds.x,y=currentBounds.y,width=currentBounds.width>0?currentBounds.width:textSize.width,height=textSize.height;x=currentPage.graphics.checkCorrectLayoutRectangle(textSize,currentBounds.x,currentBounds.y,this.format).x;let verticalShift=currentPage.graphics.getTextVerticalAlignShift(textSize.height,currentBounds.height,this.format);return new RectangleF(x,y+=verticalShift,width,height)}}class TextPageLayoutResult{}class PdfTextLayoutResult extends PdfLayoutResult{get remainder(){return this.remainderText}get lastLineBounds(){return this.lastLineTextBounds}constructor(page,bounds,remainder,lastLineBounds){super(page,bounds),this.remainderText=remainder,this.lastLineTextBounds=lastLineBounds}}class PdfTextElement extends PdfLayoutElement{constructor(arg1,arg2,arg3,arg4,arg5){super(),this.content="",this.elementValue="",this.hasPointOverload=!1,this.isPdfTextElement=!1,void 0===arg1||("string"==typeof arg1&&void 0===arg2?(this.content=arg1,this.elementValue=arg1):"string"==typeof arg1&&arg2 instanceof PdfFont&&void 0===arg3?(this.content=arg1,this.elementValue=arg1,this.pdfFont=arg2):"string"==typeof arg1&&arg2 instanceof PdfFont&&arg3 instanceof PdfPen&&void 0===arg4?(this.content=arg1,this.elementValue=arg1,this.pdfFont=arg2,this.pdfPen=arg3):"string"==typeof arg1&&arg2 instanceof PdfFont&&arg3 instanceof PdfBrush&&void 0===arg4?(this.content=arg1,this.elementValue=arg1,this.pdfFont=arg2,this.pdfBrush=arg3):(this.content=arg1,this.elementValue=arg1,this.pdfFont=arg2,this.pdfPen=arg3,this.pdfBrush=arg4,this.format=arg5))}get text(){return this.content}set text(value){this.elementValue=value,this.content=value}get value(){return this.elementValue}get pen(){return this.pdfPen}set pen(value){this.pdfPen=value}get brush(){return this.pdfBrush}set brush(value){this.pdfBrush=value}get font(){return this.pdfFont}set font(value){this.pdfFont=value,this.elementValue=this.pdfFont instanceof PdfStandardFont&&null!=this.content?PdfStandardFont.convert(this.content):this.content}get stringFormat(){return this.format}set stringFormat(value){this.format=value}getBrush(){return null==this.pdfBrush||void 0===this.pdfBrush?new PdfSolidBrush(new PdfColor(0,0,0)):this.pdfBrush}layout(param){return new TextLayouter(this).layout(param)}drawText(arg2,arg3,arg4,arg5){if(arg3 instanceof PointF&&void 0===arg3.width&&void 0===arg4)return this.hasPointOverload=!0,this.drawText(arg2,arg3.x,arg3.y);if("number"==typeof arg3&&"number"==typeof arg4&&void 0===arg5)return this.hasPointOverload=!0,this.drawText(arg2,arg3,arg4,null);if(arg3 instanceof RectangleF&&void 0!==arg3.width&&void 0===arg4)return this.drawText(arg2,arg3,null);if(arg3 instanceof PointF&&void 0===arg3.width&&arg4 instanceof PdfLayoutFormat)return this.hasPointOverload=!0,this.drawText(arg2,arg3.x,arg3.y,arg4);if("number"==typeof arg3&&"number"==typeof arg4&&(arg5 instanceof PdfLayoutFormat||null==arg5)){this.hasPointOverload=!0;let layoutRectangle=new RectangleF(arg3,arg4,arg2.graphics.clientSize.width-arg3,0);return this.drawText(arg2,layoutRectangle,arg5)}if(arg3 instanceof RectangleF&&void 0!==arg3.width&&"boolean"==typeof arg4)return this.drawText(arg2,arg3,null);{let layout=new PdfStringLayouter;if(this.hasPointOverload){let layoutResult,stringLayoutResult=layout.layout(this.value,this.font,this.stringFormat,new SizeF(arg2.graphics.clientSize.width-arg3.x,0),!0,arg2.graphics.clientSize),param=new PdfLayoutParams,temparg3=arg3,temparg4=arg4;if(param.page=arg2,param.bounds=temparg3,param.format=null!=temparg4?temparg4:new PdfLayoutFormat,stringLayoutResult.lines.length>1){if(this.text=stringLayoutResult.layoutLines[0].text,param.bounds.y<=param.page.graphics.clientSize.height){let previousPosition=new PointF(param.bounds.x,param.bounds.y);layoutResult=this.layout(param);let bounds=new RectangleF(0,layoutResult.bounds.y+stringLayoutResult.lineHeight,arg2.graphics.clientSize.width,stringLayoutResult.lineHeight);for(let i=1;i<stringLayoutResult.lines.length;i++)if(param.page=layoutResult.page,param.bounds=new RectangleF(new PointF(bounds.x,bounds.y),new SizeF(bounds.width,bounds.height)),this.text=stringLayoutResult.layoutLines[i].text,bounds.y+stringLayoutResult.lineHeight>layoutResult.page.graphics.clientSize.height&&(param.page=param.page.graphics.getNextPage(),bounds=new RectangleF(0,previousPosition.y>layoutResult.page.graphics.clientSize.height-layoutResult.bounds.height?layoutResult.bounds.height:0,layoutResult.page.graphics.clientSize.width,stringLayoutResult.lineHeight),param.bounds=bounds),layoutResult=this.layout(param),i!==stringLayoutResult.lines.length-1)bounds=new RectangleF(0,layoutResult.bounds.y+stringLayoutResult.lineHeight,layoutResult.page.graphics.clientSize.width,stringLayoutResult.lineHeight);else{let lineWidth=this.font.measureString(this.text,this.format).width;layoutResult=this.calculateResultBounds(layoutResult,lineWidth,layoutResult.page.graphics.clientSize.width,0)}}return layoutResult}{let lineSize=this.font.measureString(this.text,this.format);return param.bounds.y<=param.page.graphics.clientSize.height&&(layoutResult=this.layout(param),layoutResult=this.calculateResultBounds(layoutResult,lineSize.width,layoutResult.page.graphics.clientSize.width,0)),layoutResult}}{let result,layoutResult=layout.layout(this.value,this.font,this.stringFormat,new SizeF(arg3.width,0),!1,arg2.graphics.clientSize),param=new PdfLayoutParams,temparg3=arg3,temparg4=arg4;if(param.page=arg2,param.bounds=temparg3,param.format=null!=temparg4?temparg4:new PdfLayoutFormat,layoutResult.lines.length>1){if(this.text=layoutResult.layoutLines[0].text,param.bounds.y<=param.page.graphics.clientSize.height){let previousPosition=new PointF(param.bounds.x,param.bounds.y);result=this.layout(param);let bounds=new RectangleF(temparg3.x,result.bounds.y+layoutResult.lineHeight,temparg3.width,layoutResult.lineHeight);for(let i=1;i<layoutResult.lines.length;i++)if(param.page=result.page,param.bounds=new RectangleF(bounds.x,bounds.y,bounds.width,bounds.height),this.text=layoutResult.layoutLines[i].text,bounds.y+layoutResult.lineHeight>result.page.graphics.clientSize.height&&(param.page=param.page.graphics.getNextPage(),bounds=new RectangleF(temparg3.x,previousPosition.y>result.page.graphics.clientSize.height-result.bounds.height?layoutResult.lineHeight:0,temparg3.width,layoutResult.lineHeight),param.bounds=bounds),result=this.layout(param),i!==layoutResult.lines.length-1)bounds=new RectangleF(temparg3.x,result.bounds.y+layoutResult.lineHeight,temparg3.width,layoutResult.lineHeight);else{let lineWidth=this.font.measureString(this.text,this.format).width;result=this.calculateResultBounds(result,lineWidth,temparg3.width,temparg3.x)}}return result}{let lineSize=this.font.measureString(this.text,this.format);return param.bounds.y<=param.page.graphics.clientSize.height&&(result=this.layout(param),result=this.calculateResultBounds(result,lineSize.width,temparg3.width,temparg3.x)),result}}}}calculateResultBounds(result,lineWidth,maximumWidth,startPosition){return null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===PdfTextAlignment.Center?(result.bounds.x=startPosition+(maximumWidth-lineWidth)/2,result.bounds.width=lineWidth):null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===PdfTextAlignment.Right?(result.bounds.x=startPosition+(maximumWidth-lineWidth),result.bounds.width=lineWidth):null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===PdfTextAlignment.Justify?(result.bounds.x=startPosition,result.bounds.width=maximumWidth):(result.bounds.width=startPosition,result.bounds.width=lineWidth),result}}class PdfUriAnnotation extends PdfActionLinkAnnotation{get uriAction(){return void 0===this.pdfUriAction&&(this.pdfUriAction=new PdfUriAction),this.pdfUriAction}get uri(){return this.uriAction.uri}set uri(value){this.uriAction.uri!==value&&(this.uriAction.uri=value)}get action(){return this.getSetAction()}set action(value){this.getSetAction(value),this.uriAction.next=value}constructor(rectangle,uri){super(rectangle),void 0!==uri&&(this.uri=uri)}initialize(){super.initialize(),this.dictionary.items.setValue(this.dictionaryProperties.subtype,new PdfName(this.dictionaryProperties.link)),this.dictionary.items.setValue(this.dictionaryProperties.a,this.uriAction.element)}}class PdfTextWebLink extends PdfTextElement{constructor(){super(),this.uniformResourceLocator="",this.uriAnnotation=null,this.recalculateBounds=!1,this.defaultBorder=new PdfArray;for(let i=0;i<3;i++)this.defaultBorder.add(new PdfNumber(0))}get url(){return this.uniformResourceLocator}set url(value){if(0===value.length)throw new Error("ArgumentException : Url - string can not be empty");this.uniformResourceLocator=value}draw(arg1,arg2){if(arg1 instanceof PdfPage){let layout=new PdfStringLayouter,previousFontStyle=this.font.style;if(arg2 instanceof PointF){this.recalculateBounds=!0,this.font.style=PdfFontStyle.Underline;let layoutResult=layout.layout(this.value,this.font,this.stringFormat,new SizeF(arg1.graphics.clientSize.width-arg2.x,0),!0,arg1.graphics.clientSize);if(1===layoutResult.lines.length){let textSize=this.font.measureString(this.value),rect=new RectangleF(arg2,textSize);rect=this.calculateBounds(rect,textSize.width,arg1.graphics.clientSize.width,arg2.x),this.uriAnnotation=new PdfUriAnnotation(rect,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),arg1.annotations.add(this.uriAnnotation);let result=this.drawText(arg1,arg2);return this.font.style=previousFontStyle,result}{let result=this.drawMultipleLineWithPoint(layoutResult,arg1,arg2);return this.font.style=previousFontStyle,result}}{let layoutResult=layout.layout(this.value,this.font,this.stringFormat,new SizeF(arg2.width,0),!1,new SizeF(0,0));if(this.font.style=PdfFontStyle.Underline,1===layoutResult.lines.length){let textSize=this.font.measureString(this.value),rect=new RectangleF(new PointF(arg2.x,arg2.y),textSize);rect=this.calculateBounds(rect,textSize.width,arg2.width,arg2.x),this.uriAnnotation=new PdfUriAnnotation(rect,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),arg1.annotations.add(this.uriAnnotation);let returnValue=this.drawText(arg1,arg2);return this.font.style=previousFontStyle,returnValue}{let returnValue=this.drawMultipleLineWithBounds(layoutResult,arg1,arg2);return this.font.style=previousFontStyle,returnValue}}}{let page=new PdfPage;return this.draw(page=arg1.page,arg2)}}drawMultipleLineWithPoint(result,page,location){let layoutResult;for(let i=0;i<result.layoutLines.length;i++){let size=this.font.measureString(result.lines[i].text),bounds=new RectangleF(location,size);if(0!==i&&(bounds.x=0),this.text=result.lines[i].text,bounds.y+size.height>page.graphics.clientSize.height){if(0===i)break;page=page.graphics.getNextPage(),bounds=new RectangleF(0,0,page.graphics.clientSize.width,size.height),location.y=0}bounds=this.calculateBounds(bounds,size.width,page.graphics.clientSize.width,bounds.x),this.uriAnnotation=new PdfUriAnnotation(bounds,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),page.annotations.add(this.uriAnnotation),layoutResult=0!==i?this.drawText(page,new PointF(0,bounds.y)):this.drawText(page,bounds.x,bounds.y),location.y+=size.height}return layoutResult}drawMultipleLineWithBounds(result,page,bounds){let layoutResult;for(let i=0;i<result.layoutLines.length;i++){let size=this.font.measureString(result.lines[i].text),internalBounds=new RectangleF(new PointF(bounds.x,bounds.y),size);if(internalBounds=this.calculateBounds(internalBounds,size.width,bounds.width,bounds.x),this.text=result.lines[i].text,bounds.y+size.height>page.graphics.clientSize.height){if(0===i)break;page=page.graphics.getNextPage(),bounds=new RectangleF(bounds.x,0,bounds.width,size.height),internalBounds.y=0}this.uriAnnotation=new PdfUriAnnotation(internalBounds,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),page.annotations.add(this.uriAnnotation),layoutResult=this.drawText(page,bounds),bounds.y+=size.height}return layoutResult}calculateBounds(currentBounds,lineWidth,maximumWidth,startPosition){return null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===PdfTextAlignment.Center?(currentBounds.x=startPosition+(maximumWidth-lineWidth)/2,currentBounds.width=lineWidth):null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===PdfTextAlignment.Right?(currentBounds.x=startPosition+(maximumWidth-lineWidth),currentBounds.width=lineWidth):null!=this.stringFormat&&void 0!==this.stringFormat&&this.stringFormat.alignment===PdfTextAlignment.Justify?(currentBounds.x=startPosition,currentBounds.width=maximumWidth):(currentBounds.width=startPosition,currentBounds.width=lineWidth),currentBounds}}let PdfNumbersConvertor=(()=>{class PdfNumbersConvertor{static convert(intArabic,numberStyle){let result="";switch(numberStyle){case PdfNumberStyle.None:result="";break;case PdfNumberStyle.Numeric:result=intArabic.toString();break;case PdfNumberStyle.LowerLatin:result=this.arabicToLetter(intArabic).toLowerCase();break;case PdfNumberStyle.LowerRoman:result=this.arabicToRoman(intArabic).toLowerCase();break;case PdfNumberStyle.UpperLatin:result=this.arabicToLetter(intArabic);break;case PdfNumberStyle.UpperRoman:result=this.arabicToRoman(intArabic)}return result}static arabicToRoman(intArabic){let retval="";return retval+=this.generateNumber(intArabic,1e3,"M"),retval+=this.generateNumber(intArabic,900,"CM"),retval+=this.generateNumber(intArabic,500,"D"),retval+=this.generateNumber(intArabic,400,"CD"),retval+=this.generateNumber(intArabic,100,"C"),retval+=this.generateNumber(intArabic,90,"XC"),retval+=this.generateNumber(intArabic,50,"L"),retval+=this.generateNumber(intArabic,40,"XL"),retval+=this.generateNumber(intArabic,10,"X"),retval+=this.generateNumber(intArabic,9,"IX"),retval+=this.generateNumber(intArabic,5,"V"),retval+=this.generateNumber(intArabic,4,"IV"),(retval+=this.generateNumber(intArabic,1,"I")).toString()}static arabicToLetter(arabic){let stack=this.convertToLetter(arabic),result="";for(;stack.length>0;){let num=stack.pop();result=this.appendChar(result,num)}return result.toString()}static generateNumber(value,magnitude,letter){let numberstring="";for(;value>=magnitude;)value-=magnitude,numberstring+=letter;return numberstring.toString()}static convertToLetter(arabic){if(arabic<=0)throw Error("ArgumentOutOfRangeException-arabic, Value can not be less 0");let stack=[];for(;arabic>this.letterLimit;){let remainder=arabic%this.letterLimit;0===remainder?(arabic=arabic/this.letterLimit-1,remainder=this.letterLimit):arabic/=this.letterLimit,stack.push(remainder)}return stack.push(arabic),stack}static appendChar(builder,value){return builder+String.fromCharCode(PdfNumbersConvertor.acsiiStartIndex+value)}}return PdfNumbersConvertor.letterLimit=26,PdfNumbersConvertor.acsiiStartIndex=64,PdfNumbersConvertor})();class PdfTemplateValuePair{constructor(template,value){this.pdfTemplate=null,this.content="",void 0===template||(this.template=template,this.value=value)}get template(){return this.pdfTemplate}set template(value){this.pdfTemplate=value}get value(){return this.content}set value(value){this.content=value}}class PdfMultipleValueField extends PdfAutomaticField{constructor(){super(),this.list=new TemporaryDictionary}performDraw(graphics,location,scalingX,scalingY){super.performDrawHelper(graphics,location,scalingX,scalingY);let value=this.getValue(graphics),template=new PdfTemplate(this.getSize());this.list.setValue(graphics,new PdfTemplateValuePair(template,value));let size=this.getSize();template.graphics.drawString(value,this.getFont(),this.pen,this.getBrush(),0,0,size.width,size.height,this.stringFormat);let drawLocation=new PointF(location.x+this.location.x,location.y+this.location.y);graphics.drawPdfTemplate(template,drawLocation,new SizeF(template.width*scalingX,template.height*scalingY))}}class PdfPageNumberField extends PdfMultipleValueField{constructor(font,arg2){super(),this.internalNumberStyle=PdfNumberStyle.Numeric,void 0===arg2?this.font=font:arg2 instanceof PdfBrush?(this.font=font,this.brush=arg2):(this.font=font,this.bounds=arg2)}get numberStyle(){return this.internalNumberStyle}set numberStyle(value){this.internalNumberStyle=value}getValue(graphics){let page=this.getPageFromGraphics(graphics);return this.internalGetValue(page)}internalGetValue(page){let pageIndex=page.document.pages.indexOf(page)+1;return PdfNumbersConvertor.convert(pageIndex,this.numberStyle)}}class PdfCompositeField extends PdfMultipleValueField{constructor(font,brush,text,...list){super(),this.internalAutomaticFields=null,this.internalText="",this.font=font,this.brush=brush,this.text=text,this.automaticFields=list}get text(){return this.internalText}set text(value){this.internalText=value}get automaticFields(){return this.internalAutomaticFields}set automaticFields(value){this.internalAutomaticFields=value}getValue(graphics){let text=this.text.toString();if(void 0!==this.automaticFields&&null!=this.automaticFields&&this.automaticFields.length>0)for(let i=0;i<this.automaticFields.length;i++)text=text.replace("{"+i+"}",this.automaticFields[i].getValue(graphics));return text}}class PdfSingleValueField extends PdfAutomaticField{constructor(){super(),this.list=new TemporaryDictionary,this.painterGraphics=[]}performDraw(graphics,location,scalingX,scalingY){super.performDrawHelper(graphics,location,scalingX,scalingY);let document=this.getPageFromGraphics(graphics).document,textValue=this.getValue(graphics);if(this.list.containsKey(document)){let pair=this.list.getValue(document),drawLocation=new PointF(location.x+this.location.x,location.y+this.location.y);graphics.drawPdfTemplate(pair.template,drawLocation,new SizeF(pair.template.width*scalingX,pair.template.height*scalingY)),this.painterGraphics.push(graphics)}else{let size=this.getSize(),template=new PdfTemplate(size);this.list.setValue(document,new PdfTemplateValuePair(template,textValue)),template.graphics.drawString(textValue,this.getFont(),this.pen,this.getBrush(),0,0,size.width,size.height,this.stringFormat);let drawLocation=new PointF(location.x+this.location.x,location.y+this.location.y);graphics.drawPdfTemplate(template,drawLocation,new SizeF(template.width*scalingX,template.height*scalingY)),this.painterGraphics.push(graphics)}}}class PdfPageCountField extends PdfSingleValueField{constructor(font,arg2){super(),this.internalNumberStyle=PdfNumberStyle.Numeric,void 0===arg2?this.font=font:arg2 instanceof PdfBrush?(this.font=font,this.brush=arg2):(this.font=font,this.bounds=arg2)}get numberStyle(){return this.internalNumberStyle}set numberStyle(value){this.internalNumberStyle=value}getValue(graphics){let page=this.getPageFromGraphics(graphics);return PdfNumbersConvertor.convert(page.section.parent.document.pages.count,this.numberStyle)}}class PdfPageTemplateElement{get dock(){return this.dockStyle}set dock(value){this.dockStyle=value,this.resetAlignment()}get alignment(){return this.alignmentStyle}set alignment(value){this.setAlignment(value)}get foreground(){return this.isForeground}set foreground(value){this.isForeground=value}get background(){return!this.isForeground}set background(value){this.isForeground=!value}get location(){return this.currentLocation}set location(value){this.type===TemplateType.None&&(this.currentLocation=value)}get x(){return void 0!==this.currentLocation?this.currentLocation.x:0}set x(value){this.type===TemplateType.None&&(this.currentLocation.x=value)}get y(){return void 0!==this.currentLocation?this.currentLocation.y:0}set y(value){this.type===TemplateType.None&&(this.currentLocation.y=value)}get size(){return this.template.size}set size(value){this.type===TemplateType.None&&this.template.reset(value)}get width(){return this.template.width}set width(value){if(this.template.width!==value&&this.type===TemplateType.None){let size=this.template.size;size.width=value,this.template.reset(size)}}get height(){return this.template.height}set height(value){if(this.template.height!==value&&this.type===TemplateType.None){let size=this.template.size;size.height=value,this.template.reset(size)}}get graphics(){return this.template.graphics}get template(){return this.pdfTemplate}get type(){return this.templateType}set type(value){this.updateDocking(value),this.templateType=value}get bounds(){return new RectangleF(new PointF(this.x,this.y),this.size)}set bounds(value){this.type===TemplateType.None&&(this.location=new PointF(value.x,value.y),this.size=new SizeF(value.width,value.height))}constructor(arg1,arg2,arg3,arg4,arg5){arg1 instanceof RectangleF&&void 0===arg2?this.InitiateBounds(arg1.x,arg1.y,arg1.width,arg1.height,null):arg1 instanceof RectangleF&&arg2 instanceof PdfPage&&void 0===arg3?this.InitiateBounds(arg1.x,arg1.y,arg1.width,arg1.height,arg2):arg1 instanceof PointF&&arg2 instanceof SizeF&&void 0===arg3?this.InitiateBounds(arg1.x,arg1.y,arg2.width,arg2.height,null):arg1 instanceof PointF&&arg2 instanceof SizeF&&arg3 instanceof PdfPage&&void 0===arg4?this.InitiateBounds(arg1.x,arg1.y,arg2.width,arg2.height,arg3):arg1 instanceof SizeF&&void 0===arg2?this.InitiateBounds(0,0,arg1.width,arg1.height,null):"number"==typeof arg1&&"number"==typeof arg2&&void 0===arg3?this.InitiateBounds(0,0,arg1,arg2,null):"number"==typeof arg1&&"number"==typeof arg2&&arg3 instanceof PdfPage&&void 0===arg4?this.InitiateBounds(0,0,arg1,arg2,arg3):this.InitiateBounds(arg1,arg2,arg3,arg4,null)}InitiateBounds(arg1,arg2,arg3,arg4,arg5){this.x=arg1,this.y=arg2,this.pdfTemplate=new PdfTemplate(arg3,arg4)}updateDocking(type){if(type!==TemplateType.None){switch(type){case TemplateType.Top:this.dock=PdfDockStyle.Top;break;case TemplateType.Bottom:this.dock=PdfDockStyle.Bottom;break;case TemplateType.Left:this.dock=PdfDockStyle.Left;break;case TemplateType.Right:this.dock=PdfDockStyle.Right}this.resetAlignment()}}resetAlignment(){this.alignment=PdfAlignmentStyle.None}setAlignment(alignment){if(this.dock===PdfDockStyle.None)this.alignmentStyle=alignment;else{let canBeSet=!1;switch(this.dock){case PdfDockStyle.Left:canBeSet=alignment===PdfAlignmentStyle.TopLeft||alignment===PdfAlignmentStyle.MiddleLeft||alignment===PdfAlignmentStyle.BottomLeft||alignment===PdfAlignmentStyle.None;break;case PdfDockStyle.Top:canBeSet=alignment===PdfAlignmentStyle.TopLeft||alignment===PdfAlignmentStyle.TopCenter||alignment===PdfAlignmentStyle.TopRight||alignment===PdfAlignmentStyle.None;break;case PdfDockStyle.Right:canBeSet=alignment===PdfAlignmentStyle.TopRight||alignment===PdfAlignmentStyle.MiddleRight||alignment===PdfAlignmentStyle.BottomRight||alignment===PdfAlignmentStyle.None;break;case PdfDockStyle.Bottom:canBeSet=alignment===PdfAlignmentStyle.BottomLeft||alignment===PdfAlignmentStyle.BottomCenter||alignment===PdfAlignmentStyle.BottomRight||alignment===PdfAlignmentStyle.None;break;case PdfDockStyle.Fill:canBeSet=alignment===PdfAlignmentStyle.MiddleCenter||alignment===PdfAlignmentStyle.None}canBeSet&&(this.alignmentStyle=alignment)}}draw(layer,document){let bounds=this.calculateBounds(layer.page,document);-0===bounds.x&&(bounds.x=0),layer.graphics.drawPdfTemplate(this.template,new PointF(bounds.x,bounds.y),new SizeF(bounds.width,bounds.height))}calculateBounds(page,document){let result=this.bounds;return this.alignmentStyle!==PdfAlignmentStyle.None?result=this.getAlignmentBounds(page,document):this.dockStyle!==PdfDockStyle.None&&(result=this.getDockBounds(page,document)),result}getAlignmentBounds(page,document){return this.type===TemplateType.None?this.getSimpleAlignmentBounds(page,document):this.getTemplateAlignmentBounds(page,document)}getSimpleAlignmentBounds(page,document){let bounds=this.bounds,actualBounds=page.section.getActualBounds(document,page,!1),x=this.x,y=this.y;switch(this.alignmentStyle){case PdfAlignmentStyle.TopLeft:x=0,y=0;break;case PdfAlignmentStyle.TopCenter:x=(actualBounds.width-this.width)/2,y=0;break;case PdfAlignmentStyle.TopRight:x=actualBounds.width-this.width,y=0;break;case PdfAlignmentStyle.MiddleLeft:x=0,y=(actualBounds.height-this.height)/2;break;case PdfAlignmentStyle.MiddleCenter:x=(actualBounds.width-this.width)/2,y=(actualBounds.height-this.height)/2;break;case PdfAlignmentStyle.MiddleRight:x=actualBounds.width-this.width,y=(actualBounds.height-this.height)/2;break;case PdfAlignmentStyle.BottomLeft:x=0,y=actualBounds.height-this.height;break;case PdfAlignmentStyle.BottomCenter:x=(actualBounds.width-this.width)/2,y=actualBounds.height-this.height;break;case PdfAlignmentStyle.BottomRight:x=actualBounds.width-this.width,y=actualBounds.height-this.height}return bounds.x=x,bounds.y=y,bounds}getTemplateAlignmentBounds(page,document){let result=this.bounds,section=page.section,actualBounds=section.getActualBounds(document,page,!1),x=this.x,y=this.y;switch(this.alignmentStyle){case PdfAlignmentStyle.TopLeft:this.type===TemplateType.Left?(x=-actualBounds.x,y=0):this.type===TemplateType.Top&&(x=-actualBounds.x,y=-actualBounds.y);break;case PdfAlignmentStyle.TopCenter:x=(actualBounds.width-this.width)/2,y=-actualBounds.y;break;case PdfAlignmentStyle.TopRight:this.type===TemplateType.Right?(x=actualBounds.width+section.getRightIndentWidth(document,page,!1)-this.width,y=0):this.type===TemplateType.Top&&(x=actualBounds.width+section.getRightIndentWidth(document,page,!1)-this.width,y=-actualBounds.y);break;case PdfAlignmentStyle.MiddleLeft:x=-actualBounds.x,y=(actualBounds.height-this.height)/2;break;case PdfAlignmentStyle.MiddleCenter:x=(actualBounds.width-this.width)/2,y=(actualBounds.height-this.height)/2;break;case PdfAlignmentStyle.MiddleRight:x=actualBounds.width+section.getRightIndentWidth(document,page,!1)-this.width,y=(actualBounds.height-this.height)/2;break;case PdfAlignmentStyle.BottomLeft:this.type===TemplateType.Left?(x=-actualBounds.x,y=actualBounds.height-this.height):this.type===TemplateType.Bottom&&(x=-actualBounds.x,y=actualBounds.height+section.getBottomIndentHeight(document,page,!1)-this.height);break;case PdfAlignmentStyle.BottomCenter:x=(actualBounds.width-this.width)/2,y=actualBounds.height+section.getBottomIndentHeight(document,page,!1)-this.height;break;case PdfAlignmentStyle.BottomRight:this.type===TemplateType.Right?(x=actualBounds.width+section.getRightIndentWidth(document,page,!1)-this.width,y=actualBounds.height-this.height):this.type===TemplateType.Bottom&&(x=actualBounds.width+section.getRightIndentWidth(document,page,!1)-this.width,y=actualBounds.height+section.getBottomIndentHeight(document,page,!1)-this.height)}return result.x=x,result.y=y,result}getDockBounds(page,document){return this.type===TemplateType.None?this.getSimpleDockBounds(page,document):this.getTemplateDockBounds(page,document)}getSimpleDockBounds(page,document){let actualBounds=page.section.getActualBounds(document,page,!1),x=this.x,y=this.y,width=this.width,height=this.height;switch(this.dockStyle){case PdfDockStyle.Left:x=0,y=0,width=this.width,height=actualBounds.height;break;case PdfDockStyle.Top:x=0,y=0,width=actualBounds.width,height=this.height;break;case PdfDockStyle.Right:x=actualBounds.width-this.width,y=0,width=this.width,height=actualBounds.height;break;case PdfDockStyle.Bottom:x=0,y=actualBounds.height-this.height,width=actualBounds.width,height=this.height;break;case PdfDockStyle.Fill:x=0,x=0,width=actualBounds.width,height=actualBounds.height}return new RectangleF(x,y,width,height)}getTemplateDockBounds(page,document){let section=page.section,actualBounds=section.getActualBounds(document,page,!1),actualSize=section.pageSettings.getActualSize(),x=this.x,y=this.y,width=this.width,height=this.height;switch(this.dockStyle){case PdfDockStyle.Left:x=-actualBounds.x,y=0,width=this.width,height=actualBounds.height;break;case PdfDockStyle.Top:x=-actualBounds.x,y=-actualBounds.y,width=actualSize.width,height=this.height,actualBounds.height<0&&(y=-actualBounds.y+actualSize.height);break;case PdfDockStyle.Right:x=actualBounds.width+section.getRightIndentWidth(document,page,!1)-this.width,y=0,width=this.width,height=actualBounds.height;break;case PdfDockStyle.Bottom:x=-actualBounds.x,y=actualBounds.height+section.getBottomIndentHeight(document,page,!1)-this.height,width=actualSize.width,height=this.height,actualBounds.height<0&&(y-=actualSize.height);break;case PdfDockStyle.Fill:x=0,x=0,width=actualBounds.width,height=actualBounds.height}return new RectangleF(x,y,width,height)}}class PdfBorders{get left(){return this.leftPen}set left(value){this.leftPen=value}get right(){return this.rightPen}set right(value){this.rightPen=value}get top(){return this.topPen}set top(value){this.topPen=value}get bottom(){return this.bottomPen}set bottom(value){this.bottomPen=value}set all(value){this.leftPen=this.rightPen=this.topPen=this.bottomPen=value}get isAll(){return this.leftPen===this.rightPen&&this.leftPen===this.topPen&&this.leftPen===this.bottomPen}static get default(){return new PdfBorders}constructor(){let defaultBorderPenLeft=new PdfPen(new PdfColor(0,0,0));defaultBorderPenLeft.dashStyle=PdfDashStyle.Solid;let defaultBorderPenRight=new PdfPen(new PdfColor(0,0,0));defaultBorderPenRight.dashStyle=PdfDashStyle.Solid;let defaultBorderPenTop=new PdfPen(new PdfColor(0,0,0));defaultBorderPenTop.dashStyle=PdfDashStyle.Solid;let defaultBorderPenBottom=new PdfPen(new PdfColor(0,0,0));defaultBorderPenBottom.dashStyle=PdfDashStyle.Solid,this.leftPen=defaultBorderPenLeft,this.rightPen=defaultBorderPenRight,this.topPen=defaultBorderPenTop,this.bottomPen=defaultBorderPenBottom}}class PdfPaddings{constructor(left,right,top,bottom){this.hasLeftPad=!1,this.hasRightPad=!1,this.hasTopPad=!1,this.hasBottomPad=!1,void 0===left?(this.leftPad=this.rightPad=5.76,this.bottomPad=this.topPad=.5):(this.leftPad=left,this.rightPad=right,this.topPad=top,this.bottomPad=bottom,this.hasLeftPad=!0,this.hasRightPad=!0,this.hasTopPad=!0,this.hasBottomPad=!0)}get left(){return this.leftPad}set left(value){this.leftPad=value,this.hasLeftPad=!0}get right(){return this.rightPad}set right(value){this.rightPad=value,this.hasRightPad=!0}get top(){return this.topPad}set top(value){this.topPad=value,this.hasTopPad=!0}get bottom(){return this.bottomPad}set bottom(value){this.bottomPad=value,this.hasBottomPad=!0}set all(value){this.leftPad=this.rightPad=this.topPad=this.bottomPad=value,this.hasLeftPad=!0,this.hasRightPad=!0,this.hasTopPad=!0,this.hasBottomPad=!0}}var PdfBorderOverlapStyle=function(PdfBorderOverlapStyle){return PdfBorderOverlapStyle[PdfBorderOverlapStyle.Overlap=0]="Overlap",PdfBorderOverlapStyle[PdfBorderOverlapStyle.Inside=1]="Inside",PdfBorderOverlapStyle}({});class PdfGridStyleBase{get backgroundBrush(){return this.gridBackgroundBrush}set backgroundBrush(value){this.gridBackgroundBrush=value}get textBrush(){return this.gridTextBrush}set textBrush(value){this.gridTextBrush=value}get textPen(){return this.gridTextPen}set textPen(value){this.gridTextPen=value}get font(){return this.gridFont}set font(value){this.gridFont=value}get backgroundImage(){return this.gridBackgroundImage}set backgroundImage(value){this.gridBackgroundImage=value}}class PdfGridStyle extends PdfGridStyleBase{constructor(){super(),this.gridBorderOverlapStyle=PdfBorderOverlapStyle.Overlap,this.bAllowHorizontalOverflow=!1,this.gridHorizontalOverflowType=PdfHorizontalOverflowType.LastPage}get cellSpacing(){return void 0===this.gridCellSpacing&&(this.gridCellSpacing=0),this.gridCellSpacing}set cellSpacing(value){this.gridCellSpacing=value}get horizontalOverflowType(){return this.gridHorizontalOverflowType}set horizontalOverflowType(value){this.gridHorizontalOverflowType=value}get allowHorizontalOverflow(){return this.bAllowHorizontalOverflow}set allowHorizontalOverflow(value){this.bAllowHorizontalOverflow=value}get cellPadding(){return void 0===this.gridCellPadding&&(this.gridCellPadding=new PdfPaddings),this.gridCellPadding}set cellPadding(value){void 0===this.gridCellPadding?(this.gridCellPadding=new PdfPaddings,this.gridCellPadding=value):this.gridCellPadding=value}get borderOverlapStyle(){return this.gridBorderOverlapStyle}set borderOverlapStyle(value){this.gridBorderOverlapStyle=value}}class PdfGridCellStyle extends PdfGridStyleBase{constructor(){super(),this.gridCellBorders=PdfBorders.default}get stringFormat(){return this.format}set stringFormat(value){this.format=value}get borders(){return this.gridCellBorders}set borders(value){this.gridCellBorders=value}get cellPadding(){return this.gridCellPadding}set cellPadding(value){null!=this.gridCellPadding&&void 0!==this.gridCellPadding||(this.gridCellPadding=new PdfPaddings),this.gridCellPadding=value}}class PdfGridRowStyle{get backgroundBrush(){return this.gridRowBackgroundBrush}setBackgroundBrush(value){if(this.gridRowBackgroundBrush=value,void 0!==this.parent)for(let i=0;i<this.parent.cells.count;i++)this.parent.cells.getCell(i).style.backgroundBrush=value}get textBrush(){return this.gridRowTextBrush}setTextBrush(value){if(this.gridRowTextBrush=value,void 0!==this.parent)for(let i=0;i<this.parent.cells.count;i++)this.parent.cells.getCell(i).style.textBrush=value}get textPen(){return this.gridRowTextPen}setTextPen(value){if(this.gridRowTextPen=value,void 0!==this.parent)for(let i=0;i<this.parent.cells.count;i++)this.parent.cells.getCell(i).style.textPen=value}get font(){return this.gridRowFont}setFont(value){if(this.gridRowFont=value,void 0!==this.parent)for(let i=0;i<this.parent.cells.count;i++)this.parent.cells.getCell(i).style.font=value}get border(){return void 0===this.gridRowBorder&&this.setBorder(new PdfBorders),this.gridRowBorder}setBorder(value){if(this.gridRowBorder=value,void 0!==this.parent)for(let i=0;i<this.parent.cells.count;i++)this.parent.cells.getCell(i).style.borders=value}setParent(parent){this.parent=parent}get backgroundImage(){return this.gridRowBackgroundImage}constructor(){}}var PdfHorizontalOverflowType=function(PdfHorizontalOverflowType){return PdfHorizontalOverflowType[PdfHorizontalOverflowType.NextPage=0]="NextPage",PdfHorizontalOverflowType[PdfHorizontalOverflowType.LastPage=1]="LastPage",PdfHorizontalOverflowType}({});class PdfGridCell{constructor(row){this.cellWidth=0,this.cellHeight=0,this.tempval=0,this.fontSpilt=!1,this.finsh=!0,this.rowSpanRemainingHeight=0,this.hasRowSpan=!1,this.hasColSpan=!1,this.isFinish=!0,this.present=!1,this.gridRowSpan=1,this.colSpan=1,void 0!==row&&(this.gridRow=row)}get isCellMergeContinue(){return this.internalIsCellMergeContinue}set isCellMergeContinue(value){this.internalIsCellMergeContinue=value}get isRowMergeContinue(){return this.internalIsRowMergeContinue}set isRowMergeContinue(value){this.internalIsRowMergeContinue=value}get isCellMergeStart(){return this.internalIsCellMergeStart}set isCellMergeStart(value){this.internalIsCellMergeStart=value}get isRowMergeStart(){return this.internalIsRowMergeStart}set isRowMergeStart(value){this.internalIsRowMergeStart=value}get remainingString(){return this.remaining}set remainingString(value){this.remaining=value}get FinishedDrawingCell(){return this.isFinish}set FinishedDrawingCell(value){this.isFinish=value}get stringFormat(){return null==this.format&&(this.format=new PdfStringFormat),this.format}set stringFormat(value){this.format=value}get row(){return this.gridRow}set row(value){this.gridRow=value}get value(){return this.objectValue}set value(value){if(this.objectValue=value,this.objectValue instanceof PdfGrid){this.row.grid.isSingleGrid=!1,this.objectValue.ParentCell=this,this.objectValue.isChildGrid=!0;let rowCount=this.row.grid.rows.count;for(let i=0;i<rowCount;i++){let row=this.row.grid.rows.getRow(i),colCount=row.cells.count;for(let j=0;j<colCount;j++)row.cells.getCell(j).parent=this}}}get rowSpan(){return this.gridRowSpan}set rowSpan(value){if(value<1)throw new Error("ArgumentException : Invalid span specified, must be greater than or equal to 1");this.gridRowSpan=value,this.row.rowSpanExists=!0,this.row.grid.hasRowSpanSpan=!0}get style(){return null==this.cellStyle&&(this.cellStyle=new PdfGridCellStyle),this.cellStyle}set style(value){this.cellStyle=value}get height(){return 0===this.cellHeight&&(this.cellHeight=this.measureHeight()),this.cellHeight}set height(value){this.cellHeight=value}get columnSpan(){return this.colSpan}set columnSpan(value){if(value<1)throw Error("Invalid span specified, must be greater than or equal to 1");this.colSpan=value,this.row.columnSpanExists=!0}get width(){return(0===this.cellWidth||this.row.grid.isComplete)&&(this.cellWidth=this.measureWidth()),Math.round(this.cellWidth)}set width(value){this.cellWidth=value}measureWidth(){let width=0,layouter=new PdfStringLayouter;if("string"==typeof this.objectValue)width+=layouter.layout(this.objectValue,this.getTextFont(),this.stringFormat,new SizeF(Number.MAX_VALUE,Number.MAX_VALUE),!1,new SizeF(0,0)).actualSize.width,width+=2*(this.style.borders.left.width+this.style.borders.right.width);else if(this.objectValue instanceof PdfGrid)width=this.objectValue.size.width;else if(this.objectValue instanceof PdfImage||this.objectValue instanceof PdfBitmap)width+=this.objectValue.width;else if(this.objectValue instanceof PdfTextWebLink){let webLink=this.objectValue;width+=layouter.layout(webLink.text,webLink.font,webLink.stringFormat,new SizeF(0,0),!1,new SizeF(0,0)).actualSize.width,width+=2*(this.style.borders.left.width+this.style.borders.right.width)}return this.objectValue instanceof PdfGrid?null!=this.style.cellPadding||void 0!==this.style.cellPadding?(void 0!==this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(width+=this.style.cellPadding.left),void 0!==this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(width+=this.style.cellPadding.right)):(void 0!==this.row.grid.style.cellPadding.left&&this.row.grid.style.cellPadding.hasLeftPad&&(width+=this.row.grid.style.cellPadding.left),void 0!==this.row.grid.style.cellPadding.right&&this.row.grid.style.cellPadding.hasRightPad&&(width+=this.row.grid.style.cellPadding.right)):width+=null!=this.style.cellPadding?this.style.cellPadding.left+this.style.cellPadding.right:this.row.grid.style.cellPadding.left+this.row.grid.style.cellPadding.right,width+this.row.grid.style.cellSpacing}drawCellBackground(graphics,bounds){let backgroundBrush=this.getBackgroundBrush();null!=backgroundBrush&&(graphics.save(),graphics.drawRectangle(backgroundBrush,bounds.x,bounds.y,bounds.width,bounds.height),graphics.restore()),null!=this.style.backgroundImage&&(this.getBackgroundImage(),graphics.drawImage(this.style.backgroundImage,bounds.x,bounds.y,bounds.width,bounds.height))}adjustContentLayoutArea(bounds){let returnBounds=new RectangleF(bounds.x,bounds.y,bounds.width,bounds.height);return this.objectValue instanceof PdfGrid?(null==this.style.cellPadding||void 0===this.style.cellPadding?(void 0!==this.gridRow.grid.style.cellPadding.left&&this.gridRow.grid.style.cellPadding.hasLeftPad&&(returnBounds.x+=this.gridRow.grid.style.cellPadding.left+this.cellStyle.borders.left.width,returnBounds.width-=this.gridRow.grid.style.cellPadding.left),void 0!==this.gridRow.grid.style.cellPadding.top&&this.gridRow.grid.style.cellPadding.hasTopPad&&(returnBounds.y+=this.gridRow.grid.style.cellPadding.top+this.cellStyle.borders.top.width,returnBounds.height-=this.gridRow.grid.style.cellPadding.top),void 0!==this.gridRow.grid.style.cellPadding.right&&this.gridRow.grid.style.cellPadding.hasRightPad&&(returnBounds.width-=this.gridRow.grid.style.cellPadding.right),void 0!==this.gridRow.grid.style.cellPadding.bottom&&this.gridRow.grid.style.cellPadding.hasBottomPad&&(returnBounds.height-=this.gridRow.grid.style.cellPadding.bottom)):(void 0!==this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(returnBounds.x+=this.style.cellPadding.left+this.cellStyle.borders.left.width,returnBounds.width-=this.style.cellPadding.left),void 0!==this.style.cellPadding.top&&this.style.cellPadding.hasTopPad&&(returnBounds.y+=this.style.cellPadding.top+this.cellStyle.borders.top.width,returnBounds.height-=this.style.cellPadding.top),void 0!==this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(returnBounds.width-=this.style.cellPadding.right),void 0!==this.style.cellPadding.bottom&&this.style.cellPadding.hasBottomPad&&(returnBounds.height-=this.style.cellPadding.bottom)),returnBounds.width-=this.cellStyle.borders.left.width+this.cellStyle.borders.right.width,returnBounds.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width):void 0===this.style.cellPadding||null==this.style.cellPadding?(returnBounds.x+=this.gridRow.grid.style.cellPadding.left+this.cellStyle.borders.left.width,returnBounds.y+=this.gridRow.grid.style.cellPadding.top+this.cellStyle.borders.top.width,returnBounds.width-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left,returnBounds.height-=this.gridRow.grid.style.cellPadding.bottom+this.gridRow.grid.style.cellPadding.top,returnBounds.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width):(returnBounds.x+=this.style.cellPadding.left+this.cellStyle.borders.left.width,returnBounds.y+=this.style.cellPadding.top+this.cellStyle.borders.top.width,returnBounds.width-=this.style.cellPadding.right+this.style.cellPadding.left,returnBounds.width-=this.cellStyle.borders.left.width+this.cellStyle.borders.right.width,returnBounds.height-=this.style.cellPadding.bottom+this.style.cellPadding.top,returnBounds.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width,1===this.rowSpan&&(returnBounds.width-=this.style.borders.left.width)),returnBounds}draw(graphics,bounds,cancelSubsequentSpans){let result=null;if(this.internalIsCellMergeContinue||this.internalIsRowMergeContinue){if(!this.internalIsCellMergeContinue||!this.row.grid.style.allowHorizontalOverflow)return result;if(this.row.rowOverflowIndex>0&&this.row.cells.indexOf(this)!=this.row.rowOverflowIndex+1||0==this.row.rowOverflowIndex&&this.internalIsCellMergeContinue)return result}bounds=this.adjustOuterLayoutArea(bounds,graphics),this.drawCellBackground(graphics,bounds);let textPen=this.getTextPen(),textBrush=this.getTextBrush();void 0===textPen&&void 0===textBrush&&(textBrush=new PdfSolidBrush(new PdfColor(0,0,0)));let font=this.getTextFont(),strFormat=this.getStringFormat(),innerLayoutArea=bounds;if(innerLayoutArea.height>=graphics.clientSize.height&&this.row.grid.allowRowBreakAcrossPages&&(innerLayoutArea.height-=innerLayoutArea.y),innerLayoutArea=this.adjustContentLayoutArea(innerLayoutArea),"string"==typeof this.objectValue||"string"==typeof this.remaining){let temp,layoutRectangle;if(layoutRectangle=innerLayoutArea.height<font.height?new RectangleF(innerLayoutArea.x,innerLayoutArea.y,innerLayoutArea.width,font.height):innerLayoutArea,innerLayoutArea.height<font.height&&this.row.grid.isChildGrid&&null!=this.row.grid.ParentCell){let height=layoutRectangle.height-this.row.grid.ParentCell.row.grid.style.cellPadding.bottom-this.row.grid.style.cellPadding.bottom;-1!=this.row.grid.splitChildRowIndex&&(this.fontSpilt=!0,this.row.rowFontSplit=!0),height>0&&height<font.height&&(layoutRectangle.height=height)}0!=this.gridRow.grid.style.cellSpacing&&(layoutRectangle.width-=this.gridRow.grid.style.cellSpacing,bounds.width-=this.gridRow.grid.style.cellSpacing),this.isFinish?(graphics.drawString(temp=""===this.remaining?this.remaining:this.objectValue,font,textPen,textBrush,layoutRectangle.x,layoutRectangle.y,layoutRectangle.width,layoutRectangle.height,strFormat),-1==this.row.grid.splitChildRowIndex||this.row.grid.isChildGrid||void 0!==this.remaining||(this.remaining="")):(null==this.remaining&&(this.remaining=""),this.row.repeatFlag&&graphics.drawString(this.remaining,font,textPen,textBrush,layoutRectangle.x,layoutRectangle.y,layoutRectangle.width,layoutRectangle.height,strFormat),this.isFinish=!0),result=graphics.stringLayoutResult}else if(this.objectValue instanceof PdfGrid){let layoutRect,childGrid=this.objectValue;childGrid.isChildGrid=!0,childGrid.ParentCell=this,layoutRect=innerLayoutArea,0!=this.gridRow.grid.style.cellSpacing&&(bounds.width-=this.gridRow.grid.style.cellSpacing);let layouter=new PdfGridLayouter(childGrid),format=new PdfGridLayoutFormat;null!=this.row.grid.LayoutFormat?format=this.row.grid.LayoutFormat:format.layout=PdfLayoutType.Paginate;let param=new PdfLayoutParams;if(null!=graphics.layer){param.page=graphics.page,param.bounds=layoutRect,param.format=format,childGrid.setSpan(),childGrid.checkSpan();let childGridResult=layouter.Layouter(param);this.value=childGrid,-1!==this.row.grid.splitChildRowIndex&&(this.height=this.row.rowBreakHeightValue),param.page!=childGridResult.page&&(childGridResult.bounds.height=this.row.rowBreakHeightValue,0==this.row.rowBreakHeight?this.row.NestedGridLayoutResult=childGridResult:this.row.rowBreakHeight=this.row.rowBreakHeightValue)}}else if(this.objectValue instanceof PdfImage||this.objectValue instanceof PdfBitmap){let imageBounds;imageBounds=this.objectValue.width<=innerLayoutArea.width?new RectangleF(innerLayoutArea.x,innerLayoutArea.y,this.objectValue.width,innerLayoutArea.height):innerLayoutArea,graphics.drawImage(this.objectValue,imageBounds.x,imageBounds.y,imageBounds.width,imageBounds.height)}else this.objectValue instanceof PdfTextWebLink?this.objectValue.draw(graphics.currentPage,innerLayoutArea):void 0===this.objectValue&&(this.objectValue="",graphics.drawString(this.objectValue,font,textPen,textBrush,innerLayoutArea.x,innerLayoutArea.y,innerLayoutArea.width,innerLayoutArea.height,strFormat),null!=this.style.cellPadding&&0==this.style.cellPadding.bottom&&0==this.style.cellPadding.left&&0==this.style.cellPadding.right&&0==this.style.cellPadding.top&&(bounds.width-=this.style.borders.left.width+this.style.borders.right.width),0!=this.gridRow.grid.style.cellSpacing&&(bounds.width-=this.gridRow.grid.style.cellSpacing));return null!=this.style.borders&&(this.fontSpilt?-1!=this.row.grid.ParentCell.row.grid.splitChildRowIndex&&(this.row.rowFontSplit=!1,this.drawCellBorders(graphics,bounds)):this.drawCellBorders(graphics,bounds)),result}drawCellBorders(graphics,bounds){this.row.grid.style.borderOverlapStyle===PdfBorderOverlapStyle.Inside&&(bounds.x+=this.style.borders.left.width,bounds.y+=this.style.borders.top.width,bounds.width-=this.style.borders.right.width,bounds.height-=this.style.borders.bottom.width);let p1=new PointF(bounds.x,bounds.y+bounds.height),p2=new PointF(bounds.x,bounds.y),pen=this.cellStyle.borders.left;this.cellStyle.borders.left.dashStyle===PdfDashStyle.Solid&&(pen.lineCap=PdfLineCap.Square),graphics.drawLine(pen,p1,p2),p1=new PointF(bounds.x+bounds.width,bounds.y),p2=new PointF(bounds.x+bounds.width,bounds.y+bounds.height),bounds.x+bounds.width>graphics.clientSize.width-(pen=this.cellStyle.borders.right).width/2&&(p1=new PointF(graphics.clientSize.width-pen.width/2,bounds.y),p2=new PointF(graphics.clientSize.width-pen.width/2,bounds.y+bounds.height)),this.cellStyle.borders.right.dashStyle===PdfDashStyle.Solid&&(pen.lineCap=PdfLineCap.Square),graphics.drawLine(pen,p1,p2),p1=new PointF(bounds.x,bounds.y),p2=new PointF(bounds.x+bounds.width,bounds.y),pen=this.cellStyle.borders.top,this.cellStyle.borders.top.dashStyle===PdfDashStyle.Solid&&(pen.lineCap=PdfLineCap.Square),graphics.drawLine(pen,p1,p2),p1=new PointF(bounds.x+bounds.width,bounds.y+bounds.height),p2=new PointF(bounds.x,bounds.y+bounds.height),pen=this.cellStyle.borders.bottom,this.cellStyle.borders.bottom.dashStyle===PdfDashStyle.Solid&&(pen.lineCap=PdfLineCap.Square),graphics.drawLine(pen,p1,p2)}adjustOuterLayoutArea(bounds,g){let isHeader=!1,cellSpacing=this.row.grid.style.cellSpacing;cellSpacing>0&&(bounds=new RectangleF(bounds.x+cellSpacing,bounds.y+cellSpacing,bounds.width-cellSpacing,bounds.height-cellSpacing));let currentColIndex=this.row.cells.indexOf(this);if(this.columnSpan>1||this.row.rowOverflowIndex>0&&currentColIndex==this.row.rowOverflowIndex+1&&this.isCellMergeContinue){let span=this.columnSpan;if(1==span&&this.isCellMergeContinue)for(let j=currentColIndex+1;j<this.row.grid.columns.count&&this.row.cells.getCell(j).isCellMergeContinue;j++)span++;let totalWidth=0;for(let i=currentColIndex;i<currentColIndex+span;i++){if(this.row.grid.style.allowHorizontalOverflow){let width,compWidth=this.row.grid.size.width<g.clientSize.width?this.row.grid.size.width:g.clientSize.width;if((width=this.row.grid.size.width>g.clientSize.width?bounds.x+totalWidth+this.row.grid.columns.getColumn(i).width:totalWidth+this.row.grid.columns.getColumn(i).width)>compWidth)break}totalWidth+=this.row.grid.columns.getColumn(i).width}bounds.width=totalWidth-=this.row.grid.style.cellSpacing}if(this.rowSpan>1||this.row.rowSpanExists){let span=this.rowSpan,currentRowIndex=this.row.grid.rows.rowCollection.indexOf(this.row);-1==currentRowIndex&&-1!=(currentRowIndex=this.row.grid.headers.indexOf(this.row))&&(isHeader=!0);let totalHeight=0;for(let i=currentRowIndex;i<currentRowIndex+span;i++){totalHeight+=isHeader?this.row.grid.headers.getHeader(i).height:this.row.grid.rows.getRow(i).height;let row=this.row.grid.rows.getRow(i);this.row.grid.rows.rowCollection.indexOf(row)}this.row.cells.indexOf(this),bounds.height=totalHeight-=this.row.grid.style.cellSpacing,this.row.rowMergeComplete||(bounds.height=totalHeight)}return bounds}getTextFont(){return void 0!==this.style.font&&null!=this.style.font?this.style.font:void 0!==this.row.style.font&&null!=this.row.style.font?this.row.style.font:void 0!==this.row.grid.style.font&&null!=this.row.grid.style.font?this.row.grid.style.font:PdfDocument.defaultFont}getTextBrush(){return void 0!==this.style.textBrush&&null!=this.style.textBrush?this.style.textBrush:void 0!==this.row.style.textBrush&&null!=this.row.style.textBrush?this.row.style.textBrush:this.row.grid.style.textBrush}getTextPen(){return void 0!==this.style.textPen&&null!=this.style.textPen?this.style.textPen:void 0!==this.row.style.textPen&&null!=this.row.style.textPen?this.row.style.textPen:this.row.grid.style.textPen}getBackgroundBrush(){return void 0!==this.style.backgroundBrush&&null!=this.style.backgroundBrush?this.style.backgroundBrush:void 0!==this.row.style.backgroundBrush&&null!=this.row.style.backgroundBrush?this.row.style.backgroundBrush:this.row.grid.style.backgroundBrush}getBackgroundImage(){return void 0!==this.style.backgroundImage&&null!=this.style.backgroundImage?this.style.backgroundImage:void 0!==this.row.style.backgroundImage&&null!=this.row.style.backgroundImage?this.row.style.backgroundImage:this.row.grid.style.backgroundImage}getStringFormat(){return void 0!==this.style.stringFormat&&null!=this.style.stringFormat?this.style.stringFormat:this.stringFormat}measureHeight(){let width=this.calculateWidth();null==this.style.cellPadding||void 0===this.style.cellPadding?width-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(width-=this.style.cellPadding.right+this.style.cellPadding.left,width-=this.style.borders.left.width+this.style.borders.right.width);let height=0,layouter=new PdfStringLayouter;if("string"==typeof this.objectValue||"string"==typeof this.remaining){let currentValue=this.objectValue;this.isFinish||(currentValue=null!==this.remaining&&""!==this.remaining&&void 0!==this.remaining?this.remaining:this.objectValue);let slr=null,cellIndex=this.row.cells.indexOf(this);0!=this.gridRow.grid.style.cellSpacing&&(width-=2*this.gridRow.grid.style.cellSpacing),this.row.cells.getCell(cellIndex).hasColSpan||this.row.cells.getCell(cellIndex).hasRowSpan||(this.gridRow.grid.isChildGrid?(width<0?(this.tempval=width,null==this.style.cellPadding||void 0===this.style.cellPadding?this.tempval+=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(this.tempval+=this.style.cellPadding.right+this.style.cellPadding.left,this.tempval+=this.style.borders.left.width+this.style.borders.right.width)):this.tempval=width,height+=(slr=layouter.layout(currentValue,this.getTextFont(),this.stringFormat,new SizeF(this.tempval,0),!1,new SizeF(0,0))).actualSize.height):height+=(slr=layouter.layout(currentValue,this.getTextFont(),this.stringFormat,new SizeF(width,0),!1,new SizeF(0,0))).actualSize.height),height+=2*(this.style.borders.top.width+this.style.borders.bottom.width)}else if(this.objectValue instanceof PdfGrid){let cellIndex=this.row.cells.indexOf(this),internalWidth=0;null!=this.style.cellPadding||void 0!==this.style.cellPadding?(internalWidth=this.calculateWidth(),void 0!==this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(internalWidth-=this.style.cellPadding.left),void 0!==this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(internalWidth-=this.style.cellPadding.right)):null!=this.row.grid.style.cellPadding||void 0!==this.row.grid.style.cellPadding?(internalWidth=this.calculateWidth(),void 0!==this.row.grid.style.cellPadding.left&&this.row.grid.style.cellPadding.hasLeftPad&&(internalWidth-=this.row.grid.style.cellPadding.left),void 0!==this.row.grid.style.cellPadding.right&&this.row.grid.style.cellPadding.hasRightPad&&(internalWidth-=this.row.grid.style.cellPadding.right)):internalWidth=this.calculateWidth(),this.objectValue.tempWidth=internalWidth,this.row.cells.getCell(cellIndex).hasColSpan||this.row.cells.getCell(cellIndex).hasRowSpan?height+=2*(this.style.borders.top.width+this.style.borders.bottom.width):height=this.objectValue.size.height,0!==this.gridRow.grid.style.cellSpacing&&(width-=2*this.gridRow.grid.style.cellSpacing),null==this.style.cellPadding&&void 0===this.style.cellPadding||(void 0!==this.row.grid.style.cellPadding.top&&this.row.grid.style.cellPadding.hasTopPad&&(height+=this.row.grid.style.cellPadding.top),this.row.grid.style.cellPadding.hasBottomPad&&void 0!==this.row.grid.style.cellPadding.bottom&&(height+=this.row.grid.style.cellPadding.bottom)),height+=this.objectValue.style.cellSpacing}else if(this.objectValue instanceof PdfImage||this.objectValue instanceof PdfBitmap)height+=this.objectValue.height;else if(this.objectValue instanceof PdfTextWebLink){let webLink=this.objectValue;height+=layouter.layout(webLink.text,webLink.font,webLink.stringFormat,new SizeF(width,0),!1,new SizeF(0,0)).actualSize.height,height+=2*(this.style.borders.top.width+this.style.borders.bottom.width)}else void 0===this.objectValue&&(null==this.style.cellPadding||void 0===this.style.cellPadding?width-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(width-=this.style.cellPadding.right+this.style.cellPadding.left,width-=this.style.borders.left.width+this.style.borders.right.width),height+=2*(this.style.borders.top.width+this.style.borders.bottom.width));return this.objectValue instanceof PdfGrid?null==this.style.cellPadding||void 0===this.style.cellPadding?(void 0!==this.row.grid.style.cellPadding.top&&this.row.grid.style.cellPadding.hasTopPad&&(height+=this.row.grid.style.cellPadding.top),void 0!==this.row.grid.style.cellPadding.bottom&&this.row.grid.style.cellPadding.hasBottomPad&&(height+=this.row.grid.style.cellPadding.bottom)):(void 0!==this.style.cellPadding.top&&this.style.cellPadding.hasTopPad&&(height+=this.style.cellPadding.top),void 0!==this.style.cellPadding.bottom&&this.style.cellPadding.hasBottomPad&&(height+=this.style.cellPadding.bottom)):height+=null==this.style.cellPadding||void 0===this.style.cellPadding?this.row.grid.style.cellPadding.top+this.row.grid.style.cellPadding.bottom:this.style.cellPadding.top+this.style.cellPadding.bottom,height+this.row.grid.style.cellSpacing}calculateWidth(){let cellIndex=this.row.cells.indexOf(this),columnSpan=(this.row.grid.rows.rowCollection.indexOf(this.row),this.columnSpan),width=0;if(1===columnSpan)for(let i=0;i<columnSpan;i++)width+=this.row.grid.columns.getColumn(cellIndex+i).width;else if(columnSpan>1)for(let i=0;i<columnSpan;i++)width+=this.row.grid.columns.getColumn(cellIndex+i).width,i+1<columnSpan&&(this.row.cells.getCell(cellIndex+i+1).hasColSpan=!0);if(null!=this.parent&&this.parent.row.width>0&&this.row.grid.isChildGrid&&null!=this.parent&&this.row.width>this.parent.row.width){width=0;for(let j=0;j<this.parent.columnSpan;j++)width+=this.parent.row.grid.columns.getColumn(j).width;width/=this.row.cells.count}return width}}class PdfGridCellCollection{constructor(row){this.cells=[],this.gridRow=row}getCell(index){if(index<0||index>=this.count)throw new Error("IndexOutOfRangeException");return this.cells[index]}get count(){return this.cells.length}add(cell){if(void 0===cell){let tempcell=new PdfGridCell;return this.add(tempcell),cell}cell.row=this.gridRow,this.cells.push(cell)}indexOf(cell){return this.cells.indexOf(cell)}}class PdfGridColumn{constructor(grid){this.columnWidth=0,this.grid=grid}get width(){return this.columnWidth}set width(value){this.isCustomWidth=!0,this.columnWidth=value}get format(){return null==this.stringFormat&&(this.stringFormat=new PdfStringFormat),this.stringFormat}set format(value){this.stringFormat=value}}class PdfGridColumnCollection{constructor(grid){this.internalColumns=[],this.columnWidth=0,this.grid=grid,this.internalColumns=[]}add(count){for(let i=0;i<count;i++){this.internalColumns.push(new PdfGridColumn(this.grid));for(let index=0;index<this.grid.rows.count;index++){let row=this.grid.rows.getRow(index),cell=new PdfGridCell;cell.value="",row.cells.add(cell)}}}get count(){return this.internalColumns.length}get width(){return 0===this.columnWidth&&(this.columnWidth=this.measureColumnsWidth()),0===this.grid.initialWidth||this.columnWidth===this.grid.initialWidth||this.grid.style.allowHorizontalOverflow||(this.columnWidth=this.grid.initialWidth,this.grid.isPageWidth=!0),this.columnWidth}get columns(){return this.internalColumns}getColumn(index){if(index>=0&&index<=this.columns.length)return this.columns[index];throw Error("can not get the column from the index: "+index)}measureColumnsWidth(){let totalWidth=0;this.grid.measureColumnsWidth();for(let i=0,count=this.internalColumns.length;i<count;i++)totalWidth+=this.internalColumns[i].width;return totalWidth}getDefaultWidths(totalWidth){let widths=[],subFactor=this.count;for(let i=0;i<this.count;i++)this.grid.isPageWidth&&totalWidth>=0&&!this.internalColumns[i].isCustomWidth?this.internalColumns[i].width=0:(widths[i]=this.internalColumns[i].width,this.internalColumns[i].width>0&&this.internalColumns[i].isCustomWidth?(totalWidth-=this.internalColumns[i].width,subFactor--):widths[i]=0);for(let i=0;i<this.count;i++){let width=totalWidth/subFactor;widths[i]<=0&&(widths[i]=width)}return widths}}class PdfGridRow{constructor(grid){this.gridRowOverflowIndex=0,this.rowHeight=0,this.rowWidth=0,this.isrowFinish=!1,this.isRowSpanRowHeightSet=!1,this.noOfPageCount=0,this.isRowHeightSet=!1,this.isPageBreakRowSpanApplied=!1,this.isRowMergeComplete=!0,this.repeatFlag=!1,this.rowFontSplit=!1,this.pdfGrid=grid}get rowSpanExists(){return this.bRowSpanExists}set rowSpanExists(value){this.bRowSpanExists=value}get cells(){return null==this.gridCells&&(this.gridCells=new PdfGridCellCollection(this)),this.gridCells}get grid(){return this.pdfGrid}set grid(value){this.pdfGrid=value}get style(){return void 0===this.rowStyle&&(this.rowStyle=new PdfGridRowStyle,this.rowStyle.setParent(this)),this.rowStyle}set style(value){this.rowStyle=value;for(let i=0;i<this.cells.count;i++)this.cells.getCell(i).style.borders=value.border,void 0!==value.font&&(this.cells.getCell(i).style.font=value.font),void 0!==value.backgroundBrush&&(this.cells.getCell(i).style.backgroundBrush=value.backgroundBrush),void 0!==value.backgroundImage&&(this.cells.getCell(i).style.backgroundImage=value.backgroundImage),void 0!==value.textBrush&&(this.cells.getCell(i).style.textBrush=value.textBrush),void 0!==value.textPen&&(this.cells.getCell(i).style.textPen=value.textPen)}get rowBreakHeight(){return void 0===this.gridRowBreakHeight&&(this.gridRowBreakHeight=0),this.gridRowBreakHeight}set rowBreakHeight(value){this.gridRowBreakHeight=value}get rowOverflowIndex(){return this.gridRowOverflowIndex}set rowOverflowIndex(value){this.gridRowOverflowIndex=value}get height(){return this.isRowHeightSet||(this.rowHeight=this.measureHeight()),this.rowHeight}set height(value){this.rowHeight=value,this.isRowHeightSet=!0}get width(){return 0!==this.rowWidth&&void 0!==this.rowWidth||(this.rowWidth=this.measureWidth()),this.rowWidth}get NestedGridLayoutResult(){return this.gridResult}set NestedGridLayoutResult(value){this.gridResult=value}get columnSpanExists(){return this.bColumnSpanExists}set columnSpanExists(value){this.bColumnSpanExists=value}get rowMergeComplete(){return this.isRowMergeComplete}set rowMergeComplete(value){this.isRowMergeComplete=value}get rowIndex(){return this.grid.rows.rowCollection.indexOf(this)}measureHeight(){let rowHeight,rowSpanRemainingHeight=0,maxHeight=0;rowHeight=this.cells.getCell(0).rowSpan>1?0:this.cells.getCell(0).height;for(let i=0;i<this.cells.count;i++){let cell=this.cells.getCell(i);if(cell.rowSpanRemainingHeight>rowSpanRemainingHeight&&(rowSpanRemainingHeight=cell.rowSpanRemainingHeight),this.rowMergeComplete=!1,cell.rowSpan>1){let cellIn=i,rowin=this.grid.rows.rowCollection.indexOf(this);for(let j=0;j<cell.rowSpan;j++)j+1<cell.rowSpan&&(this.grid.rows.getRow(rowin+j+1).cells.getCell(cellIn).hasRowSpan=!0);maxHeight<cell.height&&(maxHeight=cell.height)}else rowHeight=Math.max(rowHeight,cell.height)}return maxHeight>rowHeight&&(rowHeight=maxHeight),0===rowHeight?rowHeight=maxHeight:rowSpanRemainingHeight>0&&(rowHeight+=rowSpanRemainingHeight),rowHeight}measureWidth(){let rowWid=0;for(let i=0;i<this.grid.columns.count;i++)rowWid+=this.grid.columns.getColumn(i).width;return rowWid}}class PdfGridRowCollection{constructor(grid){this.rows=[],this.grid=grid}get count(){return this.rows.length}get rowCollection(){return this.rows}addRow(arg){if(void 0===arg){let temprow=new PdfGridRow(this.grid);return this.addRow(temprow),temprow}if(arg.style.setBackgroundBrush(this.grid.style.backgroundBrush),arg.style.setFont(this.grid.style.font),arg.style.setTextBrush(this.grid.style.textBrush),arg.style.setTextPen(this.grid.style.textPen),0===arg.cells.count)for(let i=0;i<this.grid.columns.count;i++)arg.cells.add(new PdfGridCell);this.rows.push(arg)}getRow(index){return this.rows[index]}}class PdfGridHeaderCollection{constructor(grid){this.rows=[],this.grid=grid,this.rows=[]}getHeader(index){return this.rows[index]}get count(){return this.rows.length}add(arg){if("number"==typeof arg){let row;for(let i=0;i<arg;i++){row=new PdfGridRow(this.grid);for(let j=0;j<this.grid.columns.count;j++)row.cells.add(new PdfGridCell);this.rows.push(row)}return this.rows}this.rows.push(arg)}indexOf(row){return this.rows.indexOf(row)}}class PdfGrid extends PdfLayoutElement{constructor(){super(),this.gridSize=new SizeF(0,0),this.isGridSplit=!1,this.isRearranged=!1,this.pageBounds=new RectangleF,this.listOfNavigatePages=[],this.parentCellIndex=0,this.tempWidth=0,this.breakRow=!0,this.splitChildRowIndex=-1,this.hasRowSpanSpan=!1,this.hasColumnSpan=!1,this.isSingleGrid=!0}get raiseBeginCellDraw(){return void 0!==this.beginCellDraw&&null!==typeof this.beginCellDraw}get raiseEndCellDraw(){return void 0!==this.endCellDraw&&null!==typeof this.endCellDraw}get repeatHeader(){return null!=this.bRepeatHeader&&void 0!==this.bRepeatHeader||(this.bRepeatHeader=!1),this.bRepeatHeader}set repeatHeader(value){this.bRepeatHeader=value}get allowRowBreakAcrossPages(){return this.breakRow}set allowRowBreakAcrossPages(value){this.breakRow=value}get columns(){return null!=this.gridColumns&&void 0!==this.gridColumns||(this.gridColumns=new PdfGridColumnCollection(this)),this.gridColumns}get rows(){return null==this.gridRows&&(this.gridRows=new PdfGridRowCollection(this)),this.gridRows}get headers(){return null!=this.gridHeaders&&void 0!==this.gridHeaders||(this.gridHeaders=new PdfGridHeaderCollection(this)),this.gridHeaders}get initialWidth(){return this.gridInitialWidth}set initialWidth(value){this.gridInitialWidth=value}get style(){return null==this.gridStyle&&(this.gridStyle=new PdfGridStyle),this.gridStyle}set style(value){null==this.gridStyle&&(this.gridStyle=value)}get isPageWidth(){return this.ispageWidth}set isPageWidth(value){this.ispageWidth=value}get isChildGrid(){return this.ischildGrid}set isChildGrid(value){this.ischildGrid=value}get size(){return 0!==this.gridSize.width&&void 0!==this.gridSize.width||0!==this.gridSize.height||(this.gridSize=this.measure()),this.gridSize}set size(value){this.gridSize=value}get ParentCell(){return this.parentCell}set ParentCell(value){this.parentCell=value}get LayoutFormat(){return this.layoutFormat}draw(arg1,arg2,arg3,arg4){if(arg2 instanceof PointF&&void 0===arg2.width&&void 0===arg3)return this.drawHelper(arg1,arg2.x,arg2.y);if("number"==typeof arg2&&"number"==typeof arg3&&void 0===arg4)return this.drawHelper(arg1,arg2,arg3,null);if(arg2 instanceof RectangleF&&void 0!==arg2.width&&void 0===arg3)return this.drawHelper(arg1,arg2,null);if(arg2 instanceof PointF&&void 0===arg2.width&&arg3 instanceof PdfLayoutFormat)return this.drawHelper(arg1,arg2.x,arg2.y,arg3);if("number"==typeof arg2&&"number"==typeof arg3&&(arg4 instanceof PdfLayoutFormat||null==arg4)){let layoutRectangle=new RectangleF(arg2,arg3,arg1.graphics.clientSize.width-arg2,0);return this.drawHelper(arg1,layoutRectangle,arg4)}return this.drawHelper(arg1,arg2,arg2 instanceof RectangleF&&void 0!==arg2.width&&"boolean"==typeof arg3?null:arg3)}measure(){let height=0,width=this.columns.width;for(let i=0;i<this.headers.count;i++)height+=this.headers.getHeader(i).height;for(let i=0;i<this.rows.count;i++)height+=this.rows.getRow(i).height;return new SizeF(width,height)}onBeginCellDraw(args){this.raiseBeginCellDraw&&this.beginCellDraw(this,args)}onEndCellDraw(args){this.raiseEndCellDraw&&this.endCellDraw(this,args)}layout(param){return this.setSpan(),this.checkSpan(),this.layoutFormat=param.format,this.gridLocation=param.bounds,new PdfGridLayouter(this).Layouter(param)}setSpan(){let colSpan=1,rowSpan=1,currentCellIndex=0,currentRowIndex=0,maxSpan=0,rowCount=this.headers.count;for(let i=0;i<rowCount;i++){let row=this.headers.getHeader(i);maxSpan=0;let colCount=row.cells.count;for(let j=0;j<colCount;j++){let cell=row.cells.getCell(j);if(maxSpan=Math.max(maxSpan,cell.rowSpan),!cell.isCellMergeContinue&&!cell.isRowMergeContinue&&(cell.columnSpan>1||cell.rowSpan>1)){if(cell.columnSpan+j>row.cells.count)throw new Error("Invalid span specified at row "+j.toString()+" column "+i.toString());if(cell.rowSpan+i>this.headers.count)throw new Error("Invalid span specified at Header "+j.toString()+" column "+i.toString());if(cell.columnSpan>1&&cell.rowSpan>1){for(colSpan=cell.columnSpan,rowSpan=cell.rowSpan,currentCellIndex=j,currentRowIndex=i,cell.isCellMergeStart=!0,cell.isRowMergeStart=!0;colSpan>1;)row.cells.getCell(++currentCellIndex).isCellMergeContinue=!0,row.cells.getCell(currentCellIndex).isRowMergeContinue=!0,row.cells.getCell(currentCellIndex).rowSpan=rowSpan,colSpan--;for(currentCellIndex=j,colSpan=cell.columnSpan;rowSpan>1;){for(this.headers.getHeader(++currentRowIndex).cells.getCell(j).isRowMergeContinue=!0,this.headers.getHeader(currentRowIndex).cells.getCell(currentCellIndex).isRowMergeContinue=!0,rowSpan--;colSpan>1;)currentCellIndex++,this.headers.getHeader(currentRowIndex).cells.getCell(currentCellIndex).isCellMergeContinue=!0,this.headers.getHeader(currentRowIndex).cells.getCell(currentCellIndex).isRowMergeContinue=!0,colSpan--;colSpan=cell.columnSpan,currentCellIndex=j}}else if(cell.columnSpan>1&&1===cell.rowSpan)for(colSpan=cell.columnSpan,currentCellIndex=j,cell.isCellMergeStart=!0;colSpan>1;)row.cells.getCell(++currentCellIndex).isCellMergeContinue=!0,colSpan--;else if(1===cell.columnSpan&&cell.rowSpan>1)for(rowSpan=cell.rowSpan,currentRowIndex=i;rowSpan>1;)this.headers.getHeader(++currentRowIndex).cells.getCell(j).isRowMergeContinue=!0,rowSpan--}}row.maximumRowSpan=maxSpan}}checkSpan(){let cellcolSpan,currentCellIndex,cellrowSpan=1,cellmaxSpan=0,currentRowIndex=0;if(cellcolSpan=cellrowSpan=1,currentCellIndex=currentRowIndex=0,this.hasRowSpanSpan||this.hasColumnSpan){let rowCount=this.rows.count;for(let i=0;i<rowCount;i++){let row=this.rows.getRow(i);cellmaxSpan=0;let colCount=row.cells.count;for(let j=0;j<colCount;j++){let cell=row.cells.getCell(j);if(cellmaxSpan=Math.max(cellmaxSpan,cell.rowSpan),!cell.isCellMergeContinue&&!cell.isRowMergeContinue&&(cell.columnSpan>1||cell.rowSpan>1)){if(cell.columnSpan+j>row.cells.count)throw new Error("Invalid span specified at row  "+j.toString()+" column "+i.toString());if(cell.rowSpan+i>this.rows.count)throw new Error("Invalid span specified at row  "+j.toString()+" column "+i.toString());if(cell.columnSpan>1&&cell.rowSpan>1){for(cellcolSpan=cell.columnSpan,cellrowSpan=cell.rowSpan,currentCellIndex=j,currentRowIndex=i,cell.isCellMergeStart=!0,cell.isRowMergeStart=!0;cellcolSpan>1;)row.cells.getCell(++currentCellIndex).isCellMergeContinue=!0,row.cells.getCell(currentCellIndex).isRowMergeContinue=!0,cellcolSpan--;for(currentCellIndex=j,cellcolSpan=cell.columnSpan;cellrowSpan>1;){for(this.rows.getRow(++currentRowIndex).cells.getCell(j).isRowMergeContinue=!0,this.rows.getRow(currentRowIndex).cells.getCell(currentCellIndex).isRowMergeContinue=!0,cellrowSpan--;cellcolSpan>1;)currentCellIndex++,this.rows.getRow(currentRowIndex).cells.getCell(currentCellIndex).isCellMergeContinue=!0,this.rows.getRow(currentRowIndex).cells.getCell(currentCellIndex).isRowMergeContinue=!0,cellcolSpan--;cellcolSpan=cell.columnSpan,currentCellIndex=j}}else if(cell.columnSpan>1&&1===cell.rowSpan)for(cellcolSpan=cell.columnSpan,currentCellIndex=j,cell.isCellMergeStart=!0;cellcolSpan>1;)row.cells.getCell(++currentCellIndex).isCellMergeContinue=!0,cellcolSpan--;else if(1===cell.columnSpan&&cell.rowSpan>1)for(cellrowSpan=cell.rowSpan,currentRowIndex=i;cellrowSpan>1;)this.rows.getRow(++currentRowIndex).cells.getCell(j).isRowMergeContinue=!0,cellrowSpan--}}row.maximumRowSpan=cellmaxSpan}}}measureColumnsWidth(bounds){if(void 0!==bounds){this.isPageWidth=!1;let widths=this.columns.getDefaultWidths(bounds.width-bounds.x);for(let i=0,count=this.columns.count;i<count;i++)this.columns.getColumn(i).columnWidth=widths[i],this.tempWidth=widths[i];if(null!=this.ParentCell&&0==this.style.allowHorizontalOverflow&&0==this.ParentCell.row.grid.style.allowHorizontalOverflow){let padding=0,columnWidth=0,columnCount=this.columns.count,childGridColumnWidth=0;null==this.ParentCell.style.cellPadding&&void 0===this.ParentCell.style.cellPadding||(void 0!==this.ParentCell.style.cellPadding.left&&this.ParentCell.style.cellPadding.hasLeftPad&&(padding+=this.ParentCell.style.cellPadding.left),void 0!==this.ParentCell.style.cellPadding.right&&this.ParentCell.style.cellPadding.hasRightPad&&(padding+=this.ParentCell.style.cellPadding.right));for(let i=0;i<this.ParentCell.columnSpan;i++)columnWidth+=this.ParentCell.row.grid.columns.getColumn(this.parentCellIndex+i).width;for(let j=0;j<this.columns.count;j++)this.gridColumns.getColumn(j).width>0&&this.gridColumns.getColumn(j).isCustomWidth&&(columnWidth-=this.gridColumns.getColumn(j).width,columnCount--);if(null==this.ParentCell.row.grid.style.cellPadding&&void 0===this.ParentCell.row.grid.style.cellPadding||(void 0!==this.ParentCell.row.grid.style.cellPadding.top&&this.ParentCell.row.grid.style.cellPadding.hasTopPad&&(padding+=this.ParentCell.row.grid.style.cellPadding.top),void 0!==this.ParentCell.row.grid.style.cellPadding.bottom&&this.ParentCell.row.grid.style.cellPadding.hasBottomPad&&(padding+=this.ParentCell.row.grid.style.cellPadding.bottom)),0!=this.ParentCell.row.grid.style.cellSpacing&&(columnWidth-=2*this.ParentCell.row.grid.style.cellSpacing),columnWidth>padding&&(this.tempWidth=childGridColumnWidth=(columnWidth-padding)/columnCount,null!=this.ParentCell))for(let j=0;j<this.columns.count;j++)this.columns.getColumn(j).isCustomWidth||(this.columns.getColumn(j).columnWidth=childGridColumnWidth)}}else{let widths=[this.columns.count];for(let n=0;n<this.columns.count;n++)widths[n]=0;let cellWidth=0;if((void 0===this.isChildGrid&&void 0!==this.gridLocation||null===this.isChildGrid&&void 0!==this.gridLocation)&&(this.initialWidth=this.gridLocation.width),this.headers.count>0){let colCount=this.headers.getHeader(0).cells.count,rowCount=this.headers.count;for(let i=0;i<colCount;i++){cellWidth=0;for(let j=0;j<rowCount;j++){let rowWidth=Math.min(this.initialWidth,this.headers.getHeader(j).cells.getCell(i).width);cellWidth=Math.max(cellWidth,rowWidth)}widths[i]=cellWidth}}cellWidth=0;for(let i=0,colCount=this.columns.count;i<colCount;i++){for(let j=0,rowCount=this.rows.count;j<rowCount;j++)if(1==this.rows.getRow(j).cells.getCell(i).columnSpan&&!this.rows.getRow(j).cells.getCell(i).isCellMergeContinue||null!=this.rows.getRow(j).cells.getCell(i).value){null==this.rows.getRow(j).cells.getCell(i).value||this.rows.getRow(j).grid.style.allowHorizontalOverflow||(this.rows.getRow(j),this.rows.getRow(j),this.rows.getRow(j).cells.getCell(i));let rowWidth=0;rowWidth=this.initialWidth>0?Math.min(this.initialWidth,this.rows.getRow(j).cells.getCell(i).width):this.rows.getRow(j).cells.getCell(i).width,cellWidth=Math.max(widths[i],Math.max(cellWidth,rowWidth)),cellWidth=Math.max(this.columns.getColumn(i).width,cellWidth)}0!=this.rows.count&&(widths[i]=cellWidth),cellWidth=0}for(let i=0,RowCount=this.rows.count;i<RowCount;i++)for(let j=0,ColCount=this.columns.count;j<ColCount;j++)if(this.rows.getRow(i).cells.getCell(j).columnSpan>1)for(let k=1;k<this.rows.getRow(i).cells.getCell(j).columnSpan;k++);for(let i=0,count=this.columns.count;i<count;i++)this.columns.getColumn(i).width<=0?this.columns.getColumn(i).columnWidth=widths[i]:this.columns.getColumn(i).width>0&&!this.columns.getColumn(i).isCustomWidth&&(this.columns.getColumn(i).columnWidth=widths[i]);let padding=0,colWidth=0,colCount=this.columns.count,childGridColWidth=0;colWidth=this.tempWidth;for(let j=0;j<this.columns.count;j++)this.gridColumns.getColumn(j).width>0&&this.gridColumns.getColumn(j).isCustomWidth&&(colWidth-=this.gridColumns.getColumn(j).width,colCount--);if(colWidth>0&&0!=this.ParentCell.row.grid.style.cellSpacing&&(colWidth-=2*this.ParentCell.row.grid.style.cellSpacing),colWidth>padding&&(childGridColWidth=colWidth/colCount,null!=this.ParentCell))for(let j=0;j<this.columns.count;j++)this.columns.getColumn(j).isCustomWidth||(this.columns.getColumn(j).columnWidth=childGridColWidth)}}}let PdfGridLayouter=(()=>{class PdfGridLayouter extends ElementLayouter{constructor(baseFormat){super(baseFormat),this.gridInitialWidth=0,this.gridSize=new SizeF(0,0),this.parentCellIndex=0,this.tempWidth=0,this.childheight=0,this.isChildGrid=!1,this.hasRowSpanSpan=!1,this.isRearranged=!1,this.pageBounds=new RectangleF,this.listOfNavigatePages=[],this.flag=!0,this.columnRanges=[],this.currentLocation=new PointF(0,0),this.breakRow=!0,this.isOverloadWithPosition=!1}get Grid(){return this.elements}getFormat(format){return format}layoutInternal(param){let format=this.getFormat(param.format);if(this.gridLayoutFormat=this.getFormat(param.format),this.currentPage=param.page,null===this.currentPage)throw Error("Can not set page as null");this.currentPage.getClientSize(),this.currentPage.getClientSize(),this.currentPageBounds=this.currentPage.getClientSize(),this.currentGraphics=this.currentPage.graphics;let index=0;if(index=this.currentGraphics.page.section.indexOf(this.currentGraphics.page),this.listOfNavigatePages.push(index),this.currentBounds=new RectangleF(new PointF(param.bounds.x,param.bounds.y),null!=format&&format.break===PdfLayoutBreakType.FitColumnsToPage?new SizeF(this.Grid.columns.width,this.currentGraphics.clientSize.height):this.currentGraphics.clientSize),0!==this.Grid.rows.count)this.currentBounds.width=param.bounds.width>0?param.bounds.width:this.currentBounds.width-this.Grid.rows.getRow(0).cells.getCell(0).style.borders.left.width/2;else{if(0===this.Grid.headers.count)throw Error("Please add row or header into grid");this.currentBounds.width=param.bounds.width}if(this.startLocation=new PointF(param.bounds.x,param.bounds.y),param.bounds.height>0&&!this.Grid.isChildGrid&&(this.currentBounds.height=param.bounds.height),this.Grid.isChildGrid||(this.hType=this.Grid.style.horizontalOverflowType),this.Grid.style.allowHorizontalOverflow?(this.Grid.measureColumnsWidth(),this.determineColumnDrawRanges()):(this.columnRanges=[],this.Grid.measureColumnsWidth(this.currentBounds),this.columnRanges.push([0,this.Grid.columns.count-1])),this.Grid.hasRowSpanSpan)for(let i=0;i<this.Grid.rows.count;i++)this.Grid.rows.getRow(i),this.Grid.rows.getRow(i).isRowHeightSet||(this.Grid.rows.getRow(i).isRowHeightSet=!0);return this.layoutOnPage(param)}determineColumnDrawRanges(){let startColumn=0,endColumn=0,cellWidths=0,availableWidth=this.currentGraphics.clientSize.width-this.currentBounds.x;for(let i=0;i<this.Grid.columns.count;i++)if((cellWidths+=this.Grid.columns.getColumn(i).width)>=availableWidth){let subWidths=0;for(let j=startColumn;j<=i&&!((subWidths+=this.Grid.columns.getColumn(j).width)>availableWidth);j++)endColumn=j;this.columnRanges.push([startColumn,endColumn]),cellWidths=(endColumn=startColumn=endColumn+1)<=i?this.Grid.columns.getColumn(i).width:0}this.columnRanges.push([startColumn,this.Grid.columns.count-1])}layoutOnPage(param){this.pageBounds.x=param.bounds.x,this.pageBounds.y=param.bounds.y,this.pageBounds.height=param.bounds.height;let format=this.getFormat(param.format),endArgs=null,result=null,layoutedPages=new TemporaryDictionary,startPage=param.page,isParentCell=!1,cellBounds=[];for(let index=0;index<this.columnRanges.length;index++){let range=this.columnRanges[index];this.cellStartIndex=range[0],this.cellEndIndex=range[1];let returnObject=this.raiseBeforePageLayout(this.currentPage,this.currentBounds,this.currentRowIndex);this.currentBounds=returnObject.currentBounds,this.currentRowIndex=returnObject.currentRowIndex;for(let i=0;i<this.Grid.headers.count;i++){let row=this.Grid.headers.getHeader(i);this.drawRow(row)}let repeatRow,i=0,flag=!0;cellBounds=[];for(let j=0;j<this.Grid.rows.count;j++){let row=this.Grid.rows.getRow(j);this.currentRowIndex=++i-1;let originalHeight=this.currentBounds.y;startPage=this.currentPage,PdfGridLayouter.repeatRowIndex=-1,flag&&row.grid.isChildGrid&&(flag=!1);let rowResult=null;if(-1==this.Grid.splitChildRowIndex)rowResult=this.drawRow(row),row.isrowFinish=!0;else{if(!(row.grid.ParentCell.row.grid.isGridSplit&&this.Grid.splitChildRowIndex<=row.rowIndex)){if(row.isrowFinish)continue;break}rowResult=this.drawRow(row),row.isrowFinish=!0}for(cellBounds.push(rowResult.bounds.width),originalHeight===this.currentBounds.y?(repeatRow=!0,PdfGridLayouter.repeatRowIndex=this.Grid.rows.rowCollection.indexOf(row)):(repeatRow=!1,PdfGridLayouter.repeatRowIndex=-1);!rowResult.isFinish&&null!=startPage;){let tempResult=this.getLayoutResult();if((endArgs=this.raisePageLayouted(tempResult)).cancel||repeatRow)break;if(this.Grid.allowRowBreakAcrossPages){if(this.currentPage=this.getNextPageformat(format),originalHeight=this.currentBounds.y,new PointF(PdfBorders.default.right.width/2,PdfBorders.default.top.width/2),this.Grid.isChildGrid&&null!=row.grid.ParentCell&&null!=this.Grid.ParentCell.row.grid.style.cellPadding&&row.rowBreakHeight+this.Grid.ParentCell.row.grid.style.cellPadding.top<this.currentBounds.height&&(this.currentBounds.y=this.Grid.ParentCell.row.grid.style.cellPadding.top),null!=row.grid.ParentCell){row.grid.ParentCell.row.isRowBreaksNextPage=!0,row.grid.ParentCell.row.rowBreakHeightValue=row.rowBreakHeight+this.Grid.ParentCell.row.grid.style.cellPadding.top+this.Grid.ParentCell.row.grid.style.cellPadding.bottom;for(let i=row.rowIndex+1;i<row.grid.rows.count;i++)row.grid.ParentCell.row.rowBreakHeightValue+=row.grid.rows.getRow(i).height}if(row.grid.isChildGrid){row.isrowFinish=!1,row.grid.splitChildRowIndex=row.rowIndex,row.grid.ParentCell.row.grid.splitChildRowIndex=row.grid.ParentCell.row.rowIndex,row.grid.ParentCell.row.grid.isGridSplit&&(row.grid.ParentCell.row.noOfPageCount+=1,row.grid.ParentCell.row.grid.isGridSplit=!1);break}if(row.noOfPageCount<1){if(-1!=row.grid.splitChildRowIndex&&(row.grid.isGridSplit=!0),this.currentBounds.y=.5,this.Grid.repeatHeader)for(let j=0;j<this.Grid.headers.count;j++){let headerRepeat=this.Grid.headers.getHeader(j);this.drawRow(headerRepeat)}if(rowResult=this.drawRow(row),row.noOfPageCount>=1)for(let j=0;j<row.noOfPageCount;j++){let tempResult1=this.getLayoutResult();if(endArgs=this.raisePageLayouted(tempResult1),this.currentPage=this.getNextPageformat(format),originalHeight=this.currentBounds.y,-1!=row.grid.splitChildRowIndex&&(row.grid.isGridSplit=!0),this.currentBounds.y=.5,this.Grid.repeatHeader)for(let i=0;i<this.Grid.headers.count;i++){let header=this.Grid.headers.getHeader(i);this.drawRow(header)}this.drawRow(row)}row.grid.splitChildRowIndex=-1,row.grid.isGridSplit=!1,rowResult.isFinish=!0;for(let i=0;i<row.cells.count;i++)row.cells.getCell(i).value instanceof PdfGrid&&(row.cells.getCell(i).value.splitChildRowIndex=-1)}}}if(!rowResult.isFinish&&null!==startPage&&format.layout!==PdfLayoutType.OnePage&&repeatRow){if(this.startLocation.x=this.currentBounds.x,this.currentPage=this.getNextPageformat(format),null!==param.format&&!param.format.usePaginateBounds&&null!==param.bounds&&param.bounds.height>0&&!this.Grid.isChildGrid&&(this.currentBounds.height=param.bounds.height),null!==param.format&&!param.format.usePaginateBounds&&null!==param.bounds&&param.bounds.y>0&&!this.Grid.isChildGrid&&(this.currentBounds.y=param.bounds.y),this.startLocation.y=this.currentBounds.y,format.paginateBounds.x===format.paginateBounds.y&&format.paginateBounds.y===format.paginateBounds.height&&format.paginateBounds.height===format.paginateBounds.width&&0===format.paginateBounds.width&&(this.currentBounds.x+=this.startLocation.x),this.currentBounds.x===PdfBorders.default.left.width/2&&(this.currentBounds.y+=this.startLocation.x),this.Grid.repeatHeader)for(let i=0;i<this.Grid.headers.count;i++){let header=this.Grid.headers.getHeader(i);this.drawRow(header)}this.drawRow(row),null===this.currentPage||layoutedPages.containsKey(this.currentPage)||layoutedPages.add(this.currentPage,range)}if(null!=row.NestedGridLayoutResult){this.currentPage=row.NestedGridLayoutResult.page,this.currentGraphics=this.currentPage.graphics,this.startLocation=new PointF(row.NestedGridLayoutResult.bounds.x,row.NestedGridLayoutResult.bounds.y);let recalHeight=this.ReCalculateHeight(row,row.NestedGridLayoutResult.bounds.height);if(this.currentBounds.y=recalHeight,startPage!=this.currentPage){let secion=this.currentPage.section,startIndex=secion.indexOf(startPage)+1,endIndex=secion.indexOf(this.currentPage);for(let page=startIndex;page<endIndex+1;page++){let pageGraphics=this.currentPage.graphics,location=new PointF(format.paginateBounds.x,format.paginateBounds.y),height=page==endIndex?row.NestedGridLayoutResult.bounds.height-param.bounds.y:this.currentBounds.height-location.y;height<=pageGraphics.clientSize.height&&(height+=param.bounds.y),location.y=null==format?.5:format.paginateBounds.y;for(let c=0;c<row.cells.count;c++){let cell=row.cells.getCell(c),cellWidth=0,totalwidth=0;if(cell.value instanceof PdfGrid)for(let i=0;i<cell.value.columns.count;i++)totalwidth+=cell.value.columns.getColumn(i).columnWidth;else totalwidth=cell.width;cellWidth=Math.max(totalwidth,row.grid.columns.getColumn(c).width),cell.drawCellBorders(pageGraphics,new RectangleF(location,new SizeF(cellWidth,height))),location.x+=cellWidth,c+=cell.columnSpan-1}}startPage=this.currentPage}}}let isPdfGrid=!1,maximumCellBoundsWidth=0;cellBounds.length>0&&(maximumCellBoundsWidth=cellBounds[0]);let largeNavigatePage=[[1,2]];for(let c=0;c<this.Grid.rows.count;c++)if(-1!=this.cellEndIndex&&this.Grid.rows.getRow(c).cells.getCell(this.cellEndIndex).value instanceof PdfGrid){let grid=this.Grid.rows.getRow(c).cells.getCell(this.cellEndIndex).value;this.rowLayoutBoundsWidth=grid.rowLayoutBoundsWidth,isPdfGrid=!0}if(!isPdfGrid&&cellBounds.length>0){for(let c=0;c<i-1;c++)maximumCellBoundsWidth<cellBounds[c]&&(maximumCellBoundsWidth=cellBounds[c]);this.rowLayoutBoundsWidth=maximumCellBoundsWidth}else this.rowLayoutBoundsWidth=largeNavigatePage[0][1];this.columnRanges.indexOf(range)<this.columnRanges.length-1&&null!=startPage&&format.layout!=PdfLayoutType.OnePage&&(isParentCell=this.Grid.isChildGrid,0!=largeNavigatePage[0][0]?(this.currentPage.section.indexOf(this.currentPage),this.currentGraphics=this.currentPage.graphics,this.currentBounds=new RectangleF(new PointF(0,0),this.currentPage.getClientSize()),this.currentGraphics.page.section.indexOf(this.currentGraphics.page)):this.currentPage=this.getNextPageformat(format)),this.columnRanges.length-1!==index&&this.columnRanges.length>1&&format.layout!==PdfLayoutType.OnePage&&(this.currentPage=this.getNextPageformat(format),format.paginateBounds.x===format.paginateBounds.y&&format.paginateBounds.y===format.paginateBounds.height&&format.paginateBounds.height===format.paginateBounds.width&&0===format.paginateBounds.width&&(this.currentBounds.x+=this.startLocation.x,this.currentBounds.y+=this.startLocation.y))}return result=this.getLayoutResult(),this.Grid.style.allowHorizontalOverflow&&this.Grid.style.horizontalOverflowType==PdfHorizontalOverflowType.NextPage&&this.reArrangePages(layoutedPages),this.raisePageLayouted(result),result}getNextPageformat(format){let section=this.currentPage.section,nextPage=null,index=section.indexOf(this.currentPage);this.flag=!1,nextPage=index===section.count-1?section.add():section.getPages()[index+1],this.currentGraphics=nextPage.graphics;let pageindex=this.currentGraphics.page.section.indexOf(this.currentGraphics.page);return-1===this.listOfNavigatePages.indexOf(pageindex)&&this.listOfNavigatePages.push(pageindex),this.currentBounds=new RectangleF(new PointF(0,0),nextPage.getClientSize()),nextPage}CheckIfDefaultFormat(format){let defaultFormat=new PdfStringFormat;return format.alignment===defaultFormat.alignment&&format.characterSpacing===defaultFormat.characterSpacing&&format.clipPath===defaultFormat.clipPath&&format.firstLineIndent===defaultFormat.firstLineIndent&&format.horizontalScalingFactor===defaultFormat.horizontalScalingFactor&&format.lineAlignment===defaultFormat.lineAlignment&&format.lineLimit===defaultFormat.lineLimit&&format.lineSpacing===defaultFormat.lineSpacing&&format.measureTrailingSpaces===defaultFormat.measureTrailingSpaces&&format.noClip===defaultFormat.noClip&&format.paragraphIndent===defaultFormat.paragraphIndent&&format.rightToLeft===defaultFormat.rightToLeft&&format.subSuperScript===defaultFormat.subSuperScript&&format.wordSpacing===defaultFormat.wordSpacing&&format.wordWrap===defaultFormat.wordWrap}RaiseBeforeCellDraw(graphics,rowIndex,cellIndex,bounds,value,style){let args=null;return this.Grid.raiseBeginCellDraw&&(args=new PdfGridBeginCellDrawEventArgs(graphics,rowIndex,cellIndex,bounds,value,style),this.Grid.onBeginCellDraw(args),style=args.style),style}raiseAfterCellDraw(graphics,rowIndex,cellIndex,bounds,value,cellstyle){let args=null;this.Grid.raiseEndCellDraw&&(args=new PdfGridEndCellDrawEventArgs(graphics,rowIndex,cellIndex,bounds,value,cellstyle),this.Grid.onEndCellDraw(args))}reArrangePages(layoutedPages){let document=this.currentPage.document,pages=[],keys=layoutedPages.keys();layoutedPages.values();for(let i=0;i<keys.length;i++){let page=keys[i];page.section=null,pages.push(page),document.pages.remove(page)}for(let i=0;i<layoutedPages.size();i++)for(let j=i,count=layoutedPages.size()/this.columnRanges.length;j<layoutedPages.size();j+=count){let page=pages[j];-1===document.pages.indexOf(page)&&document.pages.add(page)}}getLayoutResult(){if(this.Grid.isChildGrid&&this.Grid.allowRowBreakAcrossPages)for(let i=0;i<this.Grid.rows.count;i++){let row=this.Grid.rows.getRow(i);row.rowBreakHeight>0&&row.repeatFlag&&(this.startLocation.y=this.currentPage.origin.y)}let bounds;return this.isChanged||(bounds=new RectangleF(this.startLocation,new SizeF(this.currentBounds.width,this.currentBounds.y-this.startLocation.y))),new PdfGridLayoutResult(this.currentPage,bounds)}ReCalculateHeight(row,height){let newHeight=0;for(let i=this.cellStartIndex;i<=this.cellEndIndex;i++)null!==row.cells.getCell(i).remainingString&&""!==row.cells.getCell(i).remainingString&&void 0!==row.cells.getCell(i).remainingString&&(newHeight=Math.max(newHeight,row.cells.getCell(i).measureHeight()));return Math.max(height,newHeight)}raiseBeforePageLayout(currentPage,currentBounds,currentRow){let cancel=!1;if(this.Grid.raiseBeginPageLayout){let args=new PdfGridBeginPageLayoutEventArgs(currentBounds,currentPage,currentRow);this.Grid.onBeginPageLayout(args),cancel=args.cancel,currentBounds=args.bounds,currentRow=args.startRowIndex}return{returnValue:cancel,currentBounds:currentBounds,currentRowIndex:currentRow}}raisePageLayouted(result){let args=new PdfGridEndPageLayoutEventArgs(result);return this.Grid.raiseEndPageLayout&&this.Grid.onEndPageLayout(args),args}drawRow(row,result,height){if(void 0===result){let result=new RowLayoutResult,rowHeightWithSpan=0,isHeader=!1;if(row.rowSpanExists){let maxSpan=0,currRowIndex=this.Grid.rows.rowCollection.indexOf(row);-1===currRowIndex&&-1!==(currRowIndex=this.Grid.headers.indexOf(row))&&(isHeader=!0);for(let i=0;i<row.cells.count;i++){let cell=row.cells.getCell(i);maxSpan=Math.max(maxSpan,cell.rowSpan)}for(let i=currRowIndex;i<currRowIndex+maxSpan;i++)rowHeightWithSpan+=isHeader?this.Grid.headers.getHeader(i).height:this.Grid.rows.getRow(i).height}let calculatedHeight=row.rowBreakHeight>0?row.rowBreakHeight:row.height;return this.Grid.isChildGrid&&null!=this.Grid.ParentCell?this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+calculatedHeight>this.currentPageBounds.height||this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+calculatedHeight>this.currentBounds.height||this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+rowHeightWithSpan>this.currentPageBounds.height?(this.Grid.ParentCell.row.grid.LayoutFormat.break===PdfLayoutBreakType.FitPage&&(PdfGridLayouter.repeatRowIndex=this.Grid.rows.rowCollection.indexOf(row),this.Grid.splitChildRowIndex=this.Grid.rows.rowCollection.indexOf(row)),PdfGridLayouter.repeatRowIndex>-1&&PdfGridLayouter.repeatRowIndex===row.rowIndex&&this.Grid.allowRowBreakAcrossPages&&(result.isFinish=!0,result.bounds=this.currentBounds,this.drawRowWithBreak(result,row,calculatedHeight),row.repeatFlag=!0,row.repeatRowNumber=PdfGridLayouter.repeatRowIndex)):(result.isFinish=!0,row.grid.ParentCell.row.rowBreakHeightValue>0?row.repeatFlag=!0:(row.repeatFlag=!1,calculatedHeight=row.height),this.Grid.isChildGrid&&row.rowBreakHeight>0&&null!=this.Grid.ParentCell.row.grid.style.cellPadding&&(calculatedHeight+=this.Grid.ParentCell.row.grid.style.cellPadding.bottom),this.drawRow(row,result,calculatedHeight)):calculatedHeight>this.currentPageBounds.height?this.Grid.allowRowBreakAcrossPages&&(result.isFinish=!0,this.drawRowWithBreak(result,row,calculatedHeight),row.isrowFinish=!0,row.repeatFlag=!0,-1!==row.grid.splitChildRowIndex&&(result.isFinish=!1)):this.currentBounds.y+calculatedHeight>this.currentPageBounds.height||this.currentBounds.y+calculatedHeight>this.currentBounds.height+this.startLocation.y||this.currentBounds.y+rowHeightWithSpan>this.currentPageBounds.height?(this.Grid.LayoutFormat.break===PdfLayoutBreakType.FitPage&&(PdfGridLayouter.repeatRowIndex=this.Grid.rows.rowCollection.indexOf(row)),PdfGridLayouter.repeatRowIndex>-1&&PdfGridLayouter.repeatRowIndex===row.rowIndex?this.Grid.allowRowBreakAcrossPages&&(result.isFinish=!0,this.drawRowWithBreak(result,row,calculatedHeight),row.repeatFlag=!0,row.repeatRowNumber=PdfGridLayouter.repeatRowIndex,-1!==row.grid.splitChildRowIndex&&(result.isFinish=!1)):result.isFinish=!1):(result.isFinish=!0,this.drawRow(row,result,calculatedHeight),row.repeatFlag=!1),result}{let skipcell=!1,location=new PointF(this.currentBounds.x,this.currentBounds.y);result.bounds=new RectangleF(location,new SizeF(0,0)),height=this.ReCalculateHeight(row,height);for(let i=this.cellStartIndex;i<=this.cellEndIndex;i++){let cancelSpans=i>this.cellEndIndex+1&&row.cells.getCell(i).columnSpan>1;if(!cancelSpans)for(let j=1;j<row.cells.getCell(i).columnSpan;j++)row.cells.getCell(i+j).isCellMergeContinue=!0;let size=new SizeF(this.Grid.columns.getColumn(i).width,height);!this.CheckIfDefaultFormat(this.Grid.columns.getColumn(i).format)&&this.CheckIfDefaultFormat(row.cells.getCell(i).stringFormat)&&(row.cells.getCell(i).stringFormat=this.Grid.columns.getColumn(i).format);let cellstyle=row.cells.getCell(i).style,tempValue="string"==typeof row.cells.getCell(i).value&&null!==row.cells.getCell(i).value?row.cells.getCell(i).value:"";if(row.cells.getCell(i).style=this.RaiseBeforeCellDraw(this.currentGraphics,this.currentRowIndex,i,new RectangleF(location,size),tempValue,cellstyle),!skipcell){row.cells.getCell(i).value instanceof PdfGrid&&(row.cells.getCell(i).value.parentCellIndex=i);let stringResult=row.cells.getCell(i).draw(this.currentGraphics,new RectangleF(location,size),cancelSpans);row.grid.style.allowHorizontalOverflow&&(row.cells.getCell(i).columnSpan>this.cellEndIndex||i+row.cells.getCell(i).columnSpan>this.cellEndIndex+1)&&this.cellEndIndex<row.cells.count-1&&(row.rowOverflowIndex=this.cellEndIndex),row.grid.style.allowHorizontalOverflow&&row.rowOverflowIndex>0&&(row.cells.getCell(i).columnSpan>this.cellEndIndex||i+row.cells.getCell(i).columnSpan>this.cellEndIndex+1)&&row.cells.getCell(i).columnSpan-this.cellEndIndex+i-1>0&&(row.cells.getCell(row.rowOverflowIndex+1).value=null!==stringResult&&void 0!==stringResult.remainder?stringResult.remainder:"",row.cells.getCell(row.rowOverflowIndex+1).stringFormat=row.cells.getCell(i).stringFormat,row.cells.getCell(row.rowOverflowIndex+1).style=row.cells.getCell(i).style,row.cells.getCell(row.rowOverflowIndex+1).columnSpan=row.cells.getCell(i).columnSpan-this.cellEndIndex+i-1)}if(tempValue="string"==typeof row.cells.getCell(i).value&&null!==row.cells.getCell(i).value?row.cells.getCell(i).value:"",cancelSpans||this.raiseAfterCellDraw(this.currentGraphics,this.currentRowIndex,i,new RectangleF(location,size),tempValue,row.cells.getCell(i).style),row.cells.getCell(i).value instanceof PdfGrid){let grid=row.cells.getCell(i).value;this.Grid.columns.getColumn(i).width>=this.currentGraphics.clientSize.width?(location.x=grid.rowLayoutBoundsWidth,location.x+=grid.style.cellSpacing):location.x+=this.Grid.columns.getColumn(i).width}else location.x+=this.Grid.columns.getColumn(i).width}row.rowMergeComplete&&!row.isRowHeightSet||(this.currentBounds.y+=height),result.bounds=new RectangleF(new PointF(result.bounds.x,result.bounds.y),new SizeF(location.x,location.y))}}drawRowWithBreak(result,row,calculateHeight){let location=new PointF(this.currentBounds.x,this.currentBounds.y);row.grid.isChildGrid&&row.grid.allowRowBreakAcrossPages&&this.startLocation.x!==this.currentBounds.x&&(location.x=this.startLocation.x),result.bounds=new RectangleF(location,new SizeF(0,0)),this.gridHeight=row.rowBreakHeight>0?this.currentPageBounds.height:0,row.grid.style.cellPadding.top+this.currentBounds.y+row.grid.style.cellPadding.bottom<this.currentPageBounds.height&&(row.rowBreakHeight=this.currentBounds.y+calculateHeight-this.currentPageBounds.height);for(let i=0;i<row.cells.count;i++){let cell=row.cells.getCell(i);cell.measureHeight()===calculateHeight&&cell.value instanceof PdfGrid&&(row.rowBreakHeight=0)}for(let i=this.cellStartIndex;i<=this.cellEndIndex;i++){let cancelSpans=row.cells.getCell(i).columnSpan+i>this.cellEndIndex+1&&row.cells.getCell(i).columnSpan>1,size=new SizeF(this.Grid.columns.getColumn(i).width,this.gridHeight>0?this.gridHeight:this.currentPageBounds.height),cellstyle1=row.cells.getCell(i).style;row.cells.getCell(i).style=cellstyle1;let stringResult=null;if(stringResult=row.cells.getCell(i).draw(this.currentGraphics,new RectangleF(location,size),cancelSpans),row.rowBreakHeight>0&&null!=stringResult&&(row.cells.getCell(i).FinishedDrawingCell=!1,row.cells.getCell(i).remainingString=null==stringResult.remainder?" ":stringResult.remainder,row.grid.isChildGrid&&(row.rowBreakHeight=calculateHeight-stringResult.actualSize.height)),result.isFinish=result.isFinish?row.cells.getCell(i).FinishedDrawingCell:result.isFinish,row.cells.getCell(i).value instanceof PdfGrid){let grid=row.cells.getCell(i).value;this.rowBreakPageHeightCellIndex=i,this.Grid.columns.getColumn(i).width>=this.currentGraphics.clientSize.width?(location.x=this.rowLayoutBoundsWidth,location.x+=grid.style.cellSpacing):location.x+=this.Grid.columns.getColumn(i).width}else location.x+=this.Grid.columns.getColumn(i).width}this.currentBounds.y+=this.gridHeight>0?this.gridHeight:calculateHeight,result.bounds=new RectangleF(new PointF(result.bounds.x,result.bounds.y),new SizeF(location.x,location.y))}}return PdfGridLayouter.repeatRowIndex=-1,PdfGridLayouter})();class PdfGridLayoutResult extends PdfLayoutResult{constructor(page,bounds){super(page,bounds)}}class PdfGridLayoutFormat extends PdfLayoutFormat{constructor(baseFormat){super(baseFormat)}}class GridCellEventArgs{get rowIndex(){return this.gridRowIndex}get cellIndex(){return this.gridCellIndex}get value(){return this.internalValue}get bounds(){return this.gridBounds}get graphics(){return this.pdfGraphics}constructor(graphics,rowIndex,cellIndex,bounds,value){this.gridRowIndex=rowIndex,this.gridCellIndex=cellIndex,this.internalValue=value,this.gridBounds=bounds,this.pdfGraphics=graphics}}class PdfGridBeginCellDrawEventArgs extends GridCellEventArgs{get skip(){return this.bSkip}set skip(value){this.bSkip=value}get style(){return this.cellStyle}set style(value){this.cellStyle=value}constructor(graphics,rowIndex,cellIndex,bounds,value,style){super(graphics,rowIndex,cellIndex,bounds,value),this.style=style}}class PdfGridEndCellDrawEventArgs extends GridCellEventArgs{get style(){return this.cellStyle}constructor(graphics,rowIndex,cellIndex,bounds,value,style){super(graphics,rowIndex,cellIndex,bounds,value),this.cellStyle=style}}class PdfCancelEventArgs{get cancel(){return this.isCancel}set cancel(value){this.isCancel=value}}class BeginPageLayoutEventArgs extends PdfCancelEventArgs{get bounds(){return this.cellBounds}set bounds(value){this.cellBounds=value}get page(){return this.pdfPage}constructor(bounds,page){super(),this.bounds=bounds,this.pdfPage=page}}class EndPageLayoutEventArgs extends PdfCancelEventArgs{get result(){return this.layoutResult}get nextPage(){return this.nextPdfPage}set nextPage(value){this.nextPdfPage=value}constructor(result){super(),this.layoutResult=result}}class PdfGridBeginPageLayoutEventArgs extends BeginPageLayoutEventArgs{get startRowIndex(){return this.startRow}constructor(bounds,page,startRow){super(bounds,page),this.startRow=startRow}}class PdfGridEndPageLayoutEventArgs extends EndPageLayoutEventArgs{constructor(result){super(result)}}class RowLayoutResult{get isFinish(){return this.bIsFinished}set isFinish(value){this.bIsFinished=value}get bounds(){return this.layoutedBounds}set bounds(value){this.layoutedBounds=value}constructor(){this.layoutedBounds=new RectangleF(0,0,0,0)}}class ej2_grids_es2015_ValueFormatter{constructor(cultureName){this.intl=new Internationalization,isNullOrUndefined(cultureName)||(this.intl.culture=cultureName)}getFormatFunction(format){return format.type?this.intl.getDateFormat(format):this.intl.getNumberFormat(format)}getParserFunction(format){return format.type?this.intl.getDateParser(format):this.intl.getNumberParser(format)}fromView(value,format,type){return"date"!==type&&"datetime"!==type&&"number"!==type||isNullOrUndefined(format)?value:format(value)}toView(value,format){let result=value;return isNullOrUndefined(format)||isNullOrUndefined(value)||(result=format(value)),result}setCulture(cultureName){isNullOrUndefined(cultureName)||function(cultureName){onIntlChange.notify("notifyExternalChange",{locale:defaultCulture=cultureName})}(cultureName)}}class ej2_grids_es2015_Column{constructor(options){this.allowSorting=!0,this.allowResizing=!0,this.allowFiltering=!0,this.allowGrouping=!0,this.allowReordering=!0,this.showColumnMenu=!0,this.enableGroupByFormat=!1,this.allowEditing=!0,this.filter={},this.showInColumnChooser=!0,this.edit={},this.allowSearching=!0,this.autoFit=!1,this.sortDirection="Descending",this.getEditTemplate=()=>this.editTemplateFn,this.getFilterTemplate=()=>this.filterTemplateFn,ej2_base_es2015_merge(this,options),this.type="none"===this.type?null:this.type?this.type.toLowerCase():this.type,this.editType&&(this.editType=this.editType.toLowerCase()),this.uid=getUid("grid-column");let valueFormatter=new ej2_grids_es2015_ValueFormatter;if(options.format&&(options.format.skeleton||options.format.format)&&(this.setFormatter(valueFormatter.getFormatFunction(options.format)),this.setParser(valueFormatter.getParserFunction(options.format))),this.toJSON=()=>{let col={},skip=["filter","dataSource","headerText","template","headerTemplate","edit","editTemplate","filterTemplate","commandsTemplate"],keys=Object.keys(this);for(let i=0;i<keys.length;i++)if("columns"===keys[i]){col[keys[i]]=[];for(let j=0;j<this[keys[i]].length;j++)col[keys[i]].push(this[keys[i]][j].toJSON())}else skip.indexOf(keys[i])<0&&(col[keys[i]]=this[keys[i]]);return col},this.field||(this.allowFiltering=!1,this.allowGrouping=!1,this.allowSorting=!1,this.columns&&(this.allowResizing=this.columns.some(col=>col.allowResizing))),this.commands&&!this.textAlign&&(this.textAlign="Right"),(this.template||this.commandsTemplate)&&(this.templateFn=ej2_grids_es2015_templateCompiler(this.template||this.commandsTemplate)),this.headerTemplate&&(this.headerTemplateFn=ej2_grids_es2015_templateCompiler(this.headerTemplate)),!isNullOrUndefined(this.filter)&&this.filter.itemTemplate&&(this.fltrTemplateFn=ej2_grids_es2015_templateCompiler(this.filter.itemTemplate)),this.editTemplate&&(this.editTemplateFn=ej2_grids_es2015_templateCompiler(this.editTemplate)),this.filterTemplate&&(this.filterTemplateFn=ej2_grids_es2015_templateCompiler(this.filterTemplate)),this.isForeignColumn()&&(isNullOrUndefined(this.editType)||"dropdownedit"===this.editType)&&(this.editType="dropdownedit",this.edit.params=extend({dataSource:this.dataSource,query:new ej2_data_es2015_Query,fields:{value:this.foreignKeyField||this.field,text:this.foreignKeyValue}},this.edit.params)),this.sortComparer){let a=this.sortComparer;this.sortComparer=function(x,y,xObj,yObj){if("string"==typeof a&&(a=ej2_grids_es2015_getObject(a,window)),"Descending"===this.sortDirection){let z=x;x=y,y=z;let obj=xObj;xObj=yObj,yObj=obj}return a(x,y,xObj,yObj)}}!this.sortComparer&&this.isForeignColumn()&&(this.sortComparer=(x,y)=>(x=ej2_grids_es2015_getObject(this.foreignKeyValue,getForeignData(this,{},x)[0]),y=ej2_grids_es2015_getObject(this.foreignKeyValue,getForeignData(this,{},y)[0]),"Descending"===this.sortDirection?ej2_data_es2015_DataUtil.fnDescending(x,y):ej2_data_es2015_DataUtil.fnAscending(x,y)))}getSortDirection(){return this.sortDirection}setSortDirection(direction){this.sortDirection=direction}setProperties(column){let keys=Object.keys(column);for(let i=0;i<keys.length;i++)this[keys[i]]=column[keys[i]]}isForeignColumn(){return!(!this.dataSource||!this.foreignKeyValue)}getFormatter(){return this.formatFn}setFormatter(value){this.formatFn=value}getParser(){return this.parserFn}setParser(value){this.parserFn=value}getColumnTemplate(){return this.templateFn}getHeaderTemplate(){return this.headerTemplateFn}getFilterItemTemplate(){return this.fltrTemplateFn}getDomSetter(){return this.disableHtmlEncode?"textContent":"innerHTML"}}const rowDataBound="rowDataBound",queryCellInfo="queryCellInfo",headerCellInfo="headerCellInfo",actionBegin="actionBegin",actionComplete="actionComplete",ej2_grids_es2015_actionFailure="actionFailure",dataBound="dataBound",rowSelecting="rowSelecting",rowSelected="rowSelected",rowDeselecting="rowDeselecting",rowDeselected="rowDeselected",cellSelecting="cellSelecting",cellSelected="cellSelected",cellDeselecting="cellDeselecting",cellDeselected="cellDeselected",columnDragStart="columnDragStart",columnDrag="columnDrag",columnDrop="columnDrop",rowDragStartHelper="rowDragStartHelper",rowDragStart="rowDragStart",rowDrag="rowDrag",rowDrop="rowDrop",beforePrint="beforePrint",printComplete="printComplete",detailDataBound="detailDataBound",toolbarClick="toolbarClick",batchAdd="batchAdd",batchCancel="batchCancel",batchDelete="batchDelete",beforeBatchAdd="beforeBatchAdd",beforeBatchDelete="beforeBatchDelete",beforeBatchSave="beforeBatchSave",beginEdit="beginEdit",cellEdit="cellEdit",cellSave="cellSave",cellSaved="cellSaved",beforeDataBound="beforeDataBound",ej2_grids_es2015_resizeStart="resizeStart",onResize="resizing",resizeStop="resizeStop",checkBoxChange="checkBoxChange",beforeCopy="beforeCopy",beforePaste="beforePaste",filterChoiceRequest="filterchoicerequest",filterAfterOpen="filterafteropen",filterBeforeOpen="filterbeforeopen",filterSearchBegin="filtersearchbegin",initialLoad="initial-load",initialEnd="initial-end",dataReady="data-ready",contentReady="content-ready",uiUpdate="ui-update",onEmpty="on-empty",inBoundModelChanged="inbound-model-changed",modelChanged="model-changed",colGroupRefresh="colgroup-refresh",headerRefreshed="header-refreshed",pageComplete="paging-complete",sortComplete="sorting-complete",filterComplete="filtering-complete",searchComplete="searching-complete",reorderComplete="reorder-complete",groupComplete="grouping-complete",ungroupComplete="ungrouping-complete",groupAggregates="group-aggregates",refreshFooterRenderer="refresh-footer-rendered",refreshAggregateCell="refresh-aggregate-cell",rowSelectionComplete="rowselected",cellSelectionComplete="cellselected",beforeCellFocused="beforecellfocused",cellFocused="cellfocused",keyPressed="key-pressed",click="click",ej2_grids_es2015_destroy="destroy",columnVisibilityChanged="column-visible-changed",ej2_grids_es2015_scroll="scroll",columnWidthChanged="column-width-changed",columnPositionChanged="column-position-changed",rowsAdded="rows-added",rowsRemoved="rows-removed",columnDragStop="column-drag-stop",headerDrop="header-drop",dataSourceModified="datasource-modified",refreshComplete="refresh-complete",dblclick="dblclick",toolbarRefresh="toolbar-refresh",bulkSave="bulk-save",autoCol="auto-col",tooltipDestroy="tooltip-destroy",updateData="update-data",saveComplete="save-complete",deleteComplete="delete-complete",preventBatch="prevent-batch",dialogDestroy="dialog-destroy",crudAction="crud-Action",addDeleteAction="add-delete-Action",destroyForm="destroy-form",doubleTap="double-tap",beforeExcelExport="beforeExcelExport",excelExportComplete="excelExportComplete",excelQueryCellInfo="excelQueryCellInfo",excelHeaderQueryCellInfo="excelHeaderQueryCellInfo",exportDetailDataBound="exportdetaildatabound",beforePdfExport="beforePdfExport",pdfExportComplete="pdfExportComplete",pdfQueryCellInfo="pdfQueryCellInfo",pdfHeaderQueryCellInfo="pdfHeaderQueryCellInfo",contextMenuClick="contextMenuClick",freezeRender="freezerender",contextMenuOpen="contextMenuOpen",columnMenuClick="columnMenuClick",columnMenuOpen="columnMenuOpen",filterOpen="filterOpen",filterDialogCreated="filterDialogCreated",filterMenuClose="filter-menu-close",initForeignKeyColumn="initForeignKeyColumn",getForeignKeyData="getForeignKeyData",generateQuery="generateQuery",showEmptyGrid="showEmptyGrid",ej2_grids_es2015_foreignKeyData="foreignKeyData",dataStateChange="dataStateChange",dataSourceChanged="dataSourceChanged",beforeFragAppend="beforeFragAppend",frozenHeight="frozenHeight",textWrapRefresh="textWrapRefresh",recordAdded="recordAdded",cancelBegin="cancel-Begin",editNextValCell="editNextValCell",hierarchyPrint="hierarchyprint",expandChildGrid="expandchildgrid",printGridInit="printGrid-Init",exportRowDataBound="export-RowDataBound",rowPositionChanged="row-position-changed",batchForm="batchedit-form",beforeStartEdit="edit-form",beforeBatchCancel="before-batch-cancel",batchEditFormRendered="batcheditform-rendered",partialRefresh="partial-refresh",beforeCustomFilterOpen="beforeCustomFilterOpen",selectVirtualRow="select-virtual-Row";function getCloneProperties(){return["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings"]}let ej2_grids_es2015_Print=(()=>{class Print{constructor(parent,scrollModule){this.isAsyncPrint=!1,this.defered=new Deferred,this.parent=parent,this.parent.isDestroyed||(this.parent.on(contentReady,this.isContentReady(),this),this.parent.addEventListener(actionBegin,this.actionBegin.bind(this)),this.parent.on(onEmpty,this.onEmpty.bind(this)),this.parent.on(hierarchyPrint,this.hierarchyPrint,this),this.scrollModule=scrollModule)}isContentReady(){return!this.isPrintGrid()||"None"!==this.parent.hierarchyPrintMode&&this.parent.childGrid?()=>{this.defered.promise.then(()=>{this.contentReady()}),this.isPrintGrid()&&this.hierarchyPrint()}:this.contentReady}hierarchyPrint(){this.removeColGroup(this.parent);let printGridObj=window.printGridObj;printGridObj&&!printGridObj.element.querySelector("[aria-busy=true")&&printGridObj.printModule.defered.resolve()}print(){this.renderPrintGrid(),this.printWind=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWind.moveTo(0,0),this.printWind.resizeTo(screen.availWidth,screen.availHeight)}onEmpty(){this.isPrintGrid()&&this.contentReady()}actionBegin(){this.isPrintGrid()&&(this.isAsyncPrint=!0)}renderPrintGrid(){let gObj=this.parent,element=ej2_base_es2015_createElement("div",{id:this.parent.element.id+"_print",className:gObj.element.className+" e-print-grid"});document.body.appendChild(element);let printGrid=new ej2_grids_es2015_Grid(getPrintGridModel(gObj,gObj.hierarchyPrintMode));printGrid.query=gObj.getQuery().clone(),window.printGridObj=printGrid,printGrid.isPrinting=!0;let modules=printGrid.getInjectedModules(),injectedModues=gObj.getInjectedModules();modules&&modules.length===injectedModues.length||printGrid.setInjectedModules(injectedModues),gObj.notify(printGridInit,{element:element,printgrid:printGrid}),this.parent.log("exporting_begin",this.getModuleName()),printGrid.appendTo(element),printGrid.registeredTemplate=this.parent.registeredTemplate,printGrid.trigger=gObj.trigger}contentReady(){if(this.isPrintGrid()){let gObj=this.parent;if(this.isAsyncPrint)return void this.printGrid();let args={requestType:"print",element:gObj.element,selectedRows:gObj.getContentTable().querySelectorAll('tr[aria-selected="true"]'),cancel:!1,hierarchyPrintMode:gObj.hierarchyPrintMode};if(this.isAsyncPrint||gObj.trigger(beforePrint,args),args.cancel)return void detach(gObj.element);this.isAsyncPrint||this.printGrid()}}printGrid(){let gObj=this.parent;if("auto"!==gObj.height){let cssProps=this.scrollModule.getCssProperties(),contentDiv=gObj.element.querySelector(".e-content"),headerDiv=gObj.element.querySelector(".e-gridheader");contentDiv.style.height="auto",contentDiv.style.overflowY="auto",headerDiv.style[cssProps.padding]="",headerDiv.firstElementChild.style[cssProps.border]=""}gObj.allowGrouping&&(gObj.groupSettings.columns.length?this.removeColGroup(gObj):gObj.element.querySelector(".e-groupdroparea").style.display="none");for(let element of[].slice.call(gObj.element.querySelectorAll(".e-content")))element.style.overflowX="hidden";let waitingPop=gObj.element.querySelectorAll(".e-spin-show");for(let element of[].slice.call(waitingPop))ej2_base_es2015_classList(element,["e-spin-hide"],["e-spin-show"]);this.printGridElement(gObj),gObj.isPrinting=!1,delete window.printGridObj,gObj.trigger(printComplete,{element:gObj.element}),this.parent.log("exporting_complete",this.getModuleName())}printGridElement(gObj){ej2_base_es2015_classList(gObj.element,["e-print-grid-layout"],["e-print-grid"]),gObj.isPrinting&&detach(gObj.element),this.printWind=print(gObj.element,this.printWind)}removeColGroup(gObj){let depth=gObj.groupSettings.columns.length,element=gObj.element,id="#"+gObj.element.id;if(!depth)return;let groupCaption=element.querySelectorAll(`${id}captioncell.e-groupcaption`),colSpan=groupCaption[depth-1].getAttribute("colspan");for(let i=0;i<groupCaption.length;i++)groupCaption[i].setAttribute("colspan",colSpan);let colGroups=element.querySelectorAll(`colgroup${id}colGroup`);for(let i=0;i<colGroups.length;i++)for(let j=0;j<depth;j++)colGroups[i].childNodes[j].style.display="none"}isPrintGrid(){return this.parent.element.id.indexOf("_print")>0&&this.parent.isPrinting}destroy(){this.parent.isDestroyed||(this.parent.off(contentReady,this.contentReady.bind(this)),this.parent.removeEventListener(actionBegin,this.actionBegin.bind(this)),this.parent.off(onEmpty,this.onEmpty.bind(this)),this.parent.off(hierarchyPrint,this.hierarchyPrint))}getModuleName(){return"print"}}return Print.printGridProp=[...getCloneProperties(),beforePrint,printComplete],Print})();function valueAccessor(field,data,column){return isNullOrUndefined(field)||""===field?"":ej2_data_es2015_DataUtil.getObject(field,data)}function getUpdateUsingRaf(updateFunction,callBack){requestAnimationFrame(()=>{try{callBack(null,updateFunction())}catch(e){callBack(e)}})}let ej2_grids_es2015_count=0;function getCollapsedRowsCount(val,grid){ej2_grids_es2015_count=0;let gLen=grid.groupSettings.columns.length,value=val.gSummary,dataRowCnt=0,agrCnt="aggregatesCount";if(value===val.data.count)return grid.groupSettings.columns.length&&!isNullOrUndefined(val[agrCnt])?1!==grid.groupSettings.columns.length&&val[agrCnt]?ej2_grids_es2015_count+=0!==val.indent&&value<2?val.gSummary*(gLen-val.indent+(gLen-val.indent)*val[agrCnt]):val.gSummary*(gLen-val.indent+(gLen-val.indent-1)*val[agrCnt])+val[agrCnt]:val[agrCnt]&&1===grid.groupSettings.columns.length&&(ej2_grids_es2015_count+=val.gSummary*(gLen-val.indent)+val[agrCnt]):grid.groupSettings.columns.length&&(ej2_grids_es2015_count+=1!==grid.groupSettings.columns.length?val.gSummary*(grid.groupSettings.columns.length-val.indent):val.gSummary),ej2_grids_es2015_count;for(let i=0,len=val.data.items.length;i<len;i++){let gLevel=val.data.items[i];ej2_grids_es2015_count+=gLevel.items.length+(gLen===grid.columns.length||isNullOrUndefined(gLevel.items.records)?0:gLevel.items.records.length),dataRowCnt+=isNullOrUndefined(gLevel.items.records)||isNullOrUndefined(val[agrCnt])?gLevel.items.length:gLevel.items.records.length,gLevel.items.GroupGuid&&0!==gLevel.items.childLevels&&recursive(gLevel)}return ej2_grids_es2015_count+=val.data.items.length,isNullOrUndefined(val[agrCnt])||val[agrCnt]&&ej2_grids_es2015_count&&0!==dataRowCnt&&(ej2_grids_es2015_count+=(ej2_grids_es2015_count-dataRowCnt)*val[agrCnt]+val[agrCnt]),ej2_grids_es2015_count}function recursive(row){for(let j=0,length=row.items.length;j<length;j++){let nLevel=row.items[j];ej2_grids_es2015_count+=nLevel.count,0!==nLevel.items.childLevels&&recursive(nLevel)}}function iterateArrayOrObject(collection,predicate){let result=[];for(let i=0,len=collection.length;i<len;i++){let pred=predicate(collection[i],i);isNullOrUndefined(pred)||result.push(pred)}return result}function iterateExtend(array){let obj=[];for(let i=0;i<array.length;i++)obj.push(extend({},getActualProperties(array[i]),{},!0));return obj}function ej2_grids_es2015_templateCompiler(template){if(template)try{if(document.querySelectorAll(template).length)return compile$$1(document.querySelector(template).innerHTML.trim())}catch(e){return compile$$1(template)}}function setStyleAndAttributes(node,customAttributes){let copyAttr={},literals=["style","class"];extend(copyAttr,customAttributes,{}),"style"in copyAttr&&(setStyleAttribute(node,copyAttr[literals[0]]),delete copyAttr[literals[0]]),"class"in copyAttr&&(addClass([node],copyAttr[literals[1]]),delete copyAttr[literals[1]]),attributes(node,copyAttr)}function extend$1(copied,first,second,exclude){let moved=extend(copied,first,second);return Object.keys(moved).forEach((value,index)=>{exclude&&-1!==exclude.indexOf(value)&&delete moved[value]}),moved}function setColumnIndex(columnModel,ind=0){for(let i=0,len=columnModel.length;i<len;i++)columnModel[i].columns?(columnModel[i].index=isNullOrUndefined(columnModel[i].index)?ind:columnModel[i].index,ind=setColumnIndex(columnModel[i].columns,++ind)):(columnModel[i].index=isNullOrUndefined(columnModel[i].index)?ind:columnModel[i].index,ind++);return ind}function prepareColumns(columns,autoWidth){for(let c=0,len=columns.length;c<len;c++){let column;"string"==typeof columns[c]?column=new ej2_grids_es2015_Column({field:columns[c]}):columns[c]instanceof ej2_grids_es2015_Column?column=columns[c]:columns[c].columns?(columns[c].columns=prepareColumns(columns[c].columns),column=new ej2_grids_es2015_Column(columns[c])):column=new ej2_grids_es2015_Column(columns[c]),column.headerText=isNullOrUndefined(column.headerText)?column.foreignKeyValue||column.field||"":column.headerText,column.foreignKeyField=column.foreignKeyField||column.field,column.valueAccessor=("string"==typeof column.valueAccessor?getValue(column.valueAccessor,window):column.valueAccessor)||valueAccessor,column.width=autoWidth&&isNullOrUndefined(column.width)?200:column.width,isNullOrUndefined(column.visible)&&(column.visible=!0),columns[c]=column}return columns}function setCssInGridPopUp(popUp,e,className){let isBottomTail,popUpSpan=popUp.querySelector("span"),position=popUp.parentElement.getBoundingClientRect(),targetPosition=e.target.getBoundingClientRect();popUpSpan.className=className,popUp.style.display="",isBottomTail=(isNullOrUndefined(e.clientY)?e.changedTouches[0].clientY:e.clientY)>popUp.offsetHeight+10,popUp.style.top=targetPosition.top-position.top+(isBottomTail?-(popUp.offsetHeight+10):popUp.offsetHeight+10)+"px",popUp.style.left=function(popup,e,targetPosition,left){let width=popUp.offsetWidth/2,x=getPosition(e).x;return x-targetPosition.left<width?targetPosition.left-left:targetPosition.right-x<width?targetPosition.right-left-2*width:x-left-width}(0,e,targetPosition,position.left)+"px",isBottomTail?(popUp.querySelector(".e-downtail").style.display="",popUp.querySelector(".e-uptail").style.display="none"):(popUp.querySelector(".e-downtail").style.display="none",popUp.querySelector(".e-uptail").style.display="")}function getActualProperties(obj){return obj instanceof ChildProperty?getValue("properties",obj):obj}function parentsUntil(elem,selector,isID){let parent=elem;for(;parent&&(isID?parent.id!==selector:!parent.classList.contains(selector));)parent=parent.parentElement;return parent}function getElementIndex(element,elements){let index=-1;for(let i=0,len=elements.length;i<len;i++)if(elements[i].isEqualNode(element)){index=i;break}return index}function inArray(value,collection){for(let i=0,len=collection.length;i<len;i++)if(collection[i]===value)return i;return-1}function getActualPropFromColl(collection){let coll=[];for(let i=0,len=collection.length;i<len;i++)collection[i].hasOwnProperty("properties")?coll.push(collection[i].properties):coll.push(collection[i]);return coll}function removeElement(target,selector){let elements=[].slice.call(target.querySelectorAll(selector));for(let i=0;i<elements.length;i++)ej2_base_es2015_remove(elements[i])}function getPosition(e){let position={};return position.x=isNullOrUndefined(e.clientX)?e.changedTouches[0].clientX:e.clientX,position.y=isNullOrUndefined(e.clientY)?e.changedTouches[0].clientY:e.clientY,position}let ej2_grids_es2015_uid=0;function getUid(prefix){return prefix+ej2_grids_es2015_uid++}function appendChildren(elem,children){for(let i=0,len=children.length;i<len;i++)elem.appendChild(len===children.length?children[i]:children[0]);return elem}let ej2_grids_es2015_rowHeight,scrollWidth=null;function getScrollBarWidth(){if(null!==scrollWidth)return scrollWidth;let divNode=document.createElement("div"),value=0;return divNode.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(divNode),value=divNode.offsetWidth-divNode.clientWidth|0,document.body.removeChild(divNode),scrollWidth=value}function isComplexField(field){return field.split(".").length>1}function getComplexFieldID(field=""){return field.replace(/\./g,"___")}function isEditable(col,type,elem){let row=parentsUntil(elem,"e-row"),isOldRow=!row||row&&!row.classList.contains("e-insertedrow");return"beginEdit"===type&&isOldRow?!(col.isIdentity||col.isPrimaryKey||!col.allowEditing):!("add"===type&&col.isIdentity||isOldRow&&!col.allowEditing&&!col.isIdentity&&!col.isPrimaryKey)}function isActionPrevent(inst){let dlg=inst.element.querySelector("#"+inst.element.id+"EditConfirm");return"Batch"===inst.editSettings.mode&&inst.element.querySelectorAll(".e-updatedtd").length&&inst.editSettings.showConfirmDialog&&(!dlg||dlg.classList.contains("e-popup-close"))}function ej2_grids_es2015_wrap(elem,action){elem=elem instanceof Array?elem:[elem];for(let i=0;i<elem.length;i++)action?elem[i].classList.add("e-wrap"):elem[i].classList.remove("e-wrap")}function setFormatter(serviceLocator,column){let fmtr=serviceLocator.getService("valueFormatter");switch(column.type){case"date":column.setFormatter(fmtr.getFormatFunction({type:"date",skeleton:column.format})),column.setParser(fmtr.getParserFunction({type:"date",skeleton:column.format}));break;case"datetime":column.setFormatter(fmtr.getFormatFunction({type:"dateTime",skeleton:column.format})),column.setParser(fmtr.getParserFunction({type:"dateTime",skeleton:column.format}));break;case"number":column.setFormatter(fmtr.getFormatFunction({format:column.format})),column.setParser(fmtr.getParserFunction({format:column.format}))}}function addRemoveActiveClasses(cells,add,...args){for(let i=0,len=cells.length;i<len;i++)add?(ej2_base_es2015_classList(cells[i],[...args],[]),cells[i].setAttribute("aria-selected","true")):(ej2_base_es2015_classList(cells[i],[],[...args]),cells[i].removeAttribute("aria-selected"))}function getFilterMenuPostion(target,dialogObj,grid){let elementVisible=dialogObj.element.style.display;dialogObj.element.style.display="block";let newpos,dlgWidth=dialogObj.width;if(grid.enableRtl){newpos=calculatePosition(target,"left","bottom"),dialogObj.element.style.top=newpos.top+target.getBoundingClientRect().height-35+"px",dialogObj.element.style.display=elementVisible;let leftPos=newpos.left-dlgWidth+target.clientWidth;dialogObj.element.style.left=leftPos<1?dlgWidth+leftPos+-16+"px":leftPos-16+"px"}else{newpos=calculateRelativeBasedPosition(target,dialogObj.element),dialogObj.element.style.display=elementVisible,dialogObj.element.style.top=newpos.top+target.getBoundingClientRect().height-5+"px";let leftPos=newpos.left-dlgWidth+target.clientWidth;dialogObj.element.style.left=leftPos<1?dlgWidth+leftPos-16+"px":leftPos+-4+"px"}}function getZIndexCalcualtion(args,dialogObj){args.popup.element.style.zIndex=(dialogObj.zIndex+1).toString()}function createCboxWithWrap(uid,elem,className){let div=ej2_base_es2015_createElement("div",{className:className});return div.appendChild(elem),div.setAttribute("uid",uid),div}function removeAddCboxClasses(elem,checked){removeClass([elem],["e-check","e-stop","e-uncheck"]),elem.classList.add(checked?"e-check":"e-uncheck")}function refreshForeignData(row,columns,data){columns.forEach(col=>{setValue(col.field,getForeignData(col,data),row.foreignKeyData)}),row.cells.forEach(cell=>{cell.isForeignKey&&setValue("foreignKeyData",getValue(cell.column.field,row.foreignKeyData),cell)})}function getForeignData(column,data,lValue,foreignKeyData){let fField=column.foreignKeyField,key=isNullOrUndefined(lValue)?valueAccessor(column.field,data):lValue;key=isNullOrUndefined(key)?"":key;let query=new ej2_data_es2015_Query,fdata=foreignKeyData||(column.dataSource instanceof ej2_data_es2015_DataManager&&column.dataSource.dataSource.json.length?column.dataSource.dataSource.json:column.columnData);return key.getDay?query.where(getDatePredicate({field:fField,operator:"equal",value:key,matchCase:!1})):query.where(fField,"==",key,!1),new ej2_data_es2015_DataManager(fdata).executeLocal(query)}function getColumnByForeignKeyValue(foreignKeyValue,columns){let column;return columns.some(col=>(column=col,col.foreignKeyValue===foreignKeyValue))&&column}function getDatePredicate(filterObject,type){let datePredicate,prevDate,nextDate,prevObj=extend({},getActualProperties(filterObject)),nextObj=extend({},getActualProperties(filterObject));if(null===filterObject.value)return new ej2_data_es2015_Predicate(prevObj.field,prevObj.operator,prevObj.value,!1);let value=new Date(filterObject.value);if("equal"===filterObject.operator||"notequal"===filterObject.operator){"datetime"===type?(prevDate=new Date(value.setSeconds(value.getSeconds()-1)),nextDate=new Date(value.setSeconds(value.getSeconds()+2)),filterObject.value=new Date(value.setSeconds(nextDate.getSeconds()-1))):(prevDate=new Date(value.setHours(0)-1),nextDate=new Date(value.setHours(24))),prevObj.value=prevDate,nextObj.value=nextDate,"equal"===filterObject.operator?(prevObj.operator="greaterthan",nextObj.operator="lessthan"):"notequal"===filterObject.operator&&(prevObj.operator="lessthanorequal",nextObj.operator="greaterthanorequal");let predicateSt=new ej2_data_es2015_Predicate(prevObj.field,prevObj.operator,prevObj.value,!1),predicateEnd=new ej2_data_es2015_Predicate(nextObj.field,nextObj.operator,nextObj.value,!1);datePredicate="equal"===filterObject.operator?predicateSt.and(predicateEnd):predicateSt.or(predicateEnd)}else"string"==typeof prevObj.value&&(prevObj.value=new Date(prevObj.value)),datePredicate=new ej2_data_es2015_Predicate(prevObj.field,prevObj.operator,prevObj.value,!1);return filterObject.setProperties?filterObject.setProperties({ejpredicate:datePredicate},!0):filterObject.ejpredicate=datePredicate,datePredicate}function isGroupAdaptive(grid){return grid.enableVirtualization&&grid.groupSettings.columns.length>0&&grid.isVirtualAdaptive}function ej2_grids_es2015_getObject(field="",object){if(field){let value=object,splits=field.split(".");for(let i=0;i<splits.length&&!isNullOrUndefined(value);i++)value=value[splits[i]];return value}}function getCustomDateFormat(format,colType){return(new Internationalization).getDatePattern("date"===colType?"object"==typeof format?{type:format.type?format.type:"date",format:format.format}:{type:"date",skeleton:format}:"object"==typeof format?{type:format.type?format.type:"dateTime",format:format.format}:{type:"dateTime",skeleton:format},!1)}function getPrintGridModel(gObj,hierarchyPrintMode="Expanded"){let printGridModel={};if(!gObj)return printGridModel;for(let key of ej2_grids_es2015_Print.printGridProp)printGridModel[key]="columns"===key?getActualPropFromColl(gObj[key]):"allowPaging"===key?"CurrentPage"===gObj.printMode:getActualProperties(gObj[key]);return gObj.childGrid&&"None"!==hierarchyPrintMode&&(printGridModel.expandedRows=function(gObj,hierarchyPrintMode){let rows=gObj.getRowsObject(),obj={};for(const row of rows)if(row.isExpand&&!row.isDetailRow){let index=gObj.allowPaging&&"AllPages"===gObj.printMode?row.index+gObj.pageSettings.currentPage*gObj.pageSettings.pageSize-gObj.pageSettings.pageSize:row.index;obj[index]={},obj[index].isExpand=!0,obj[index].gridModel=getPrintGridModel(row.childGrid,hierarchyPrintMode),obj[index].gridModel.query=gObj.childGrid.query}return obj}(gObj,hierarchyPrintMode)),printGridModel}function extendObjWithFn(copied,first,second,deep){let res=copied||{},len=arguments.length;deep&&(len-=1);for(let i=1;i<len;i++){if(!arguments[i])continue;let obj1=arguments[i];(Object.keys(Object.getPrototypeOf(obj1)).length?Object.keys(obj1).concat(getPrototypesOfObj(obj1)):Object.keys(obj1)).forEach(key=>{let cln,source=res[key],cpy=obj1[key];res[key]=deep&&(ej2_base_es2015_isObject(cpy)||Array.isArray(cpy))?ej2_base_es2015_isObject(cpy)?extend({},cln=source||{},cpy,deep):extend([],cln=source||[],cpy,deep):cpy})}return res}function getPrototypesOfObj(obj){let keys=[];for(;Object.getPrototypeOf(obj)&&Object.keys(Object.getPrototypeOf(obj)).length;)keys=keys.concat(Object.keys(Object.getPrototypeOf(obj))),obj=Object.getPrototypeOf(obj);return keys}function measureColumnDepth(column){let max=0;for(let i=0;i<column.length;i++){let depth=checkDepth(column[i],0);max<depth&&(max=depth)}return max+1}function checkDepth(col,index){let max=index,indices=[];if(col.columns){index++;for(let i=0;i<col.columns.length;i++)indices[i]=checkDepth(col.columns[i],index);for(let j=0;j<indices.length;j++)max<indices[j]&&(max=indices[j]);index=max}return index}var CellType=function(CellType){return CellType[CellType.Data=0]="Data",CellType[CellType.Header=1]="Header",CellType[CellType.Summary=2]="Summary",CellType[CellType.GroupSummary=3]="GroupSummary",CellType[CellType.CaptionSummary=4]="CaptionSummary",CellType[CellType.Filter=5]="Filter",CellType[CellType.Indent=6]="Indent",CellType[CellType.GroupCaption=7]="GroupCaption",CellType[CellType.GroupCaptionEmpty=8]="GroupCaptionEmpty",CellType[CellType.Expand=9]="Expand",CellType[CellType.HeaderIndent=10]="HeaderIndent",CellType[CellType.StackedHeader=11]="StackedHeader",CellType[CellType.DetailHeader=12]="DetailHeader",CellType[CellType.DetailExpand=13]="DetailExpand",CellType[CellType.CommandColumn=14]="CommandColumn",CellType[CellType.DetailFooterIntent=15]="DetailFooterIntent",CellType[CellType.RowDragIcon=16]="RowDragIcon",CellType[CellType.RowDragHIcon=17]="RowDragHIcon",CellType}({}),RenderType=function(RenderType){return RenderType[RenderType.Header=0]="Header",RenderType[RenderType.Content=1]="Content",RenderType[RenderType.Summary=2]="Summary",RenderType}({});class ej2_grids_es2015_CheckBoxFilter{constructor(parent,filterSettings,serviceLocator){this.existingPredicate={},this.foreignKeyQuery=new ej2_data_es2015_Query,this.filterState=!0,this.values={},this.renderEmpty=!1,this.parent=parent,this.id=this.parent.element.id,this.serviceLocator=serviceLocator,this.filterSettings=filterSettings,this.valueFormatter=new ej2_grids_es2015_ValueFormatter(this.parent.locale),this.cBoxTrue=createCheckBox(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&addClass([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}destroy(){this.closeDialog()}wireEvents(){EventHandler.add(this.dlg,"click",this.clickHandler,this),this.searchHandler=debounce(this.searchBoxKeyUp,200),EventHandler.add(this.dlg.querySelector(".e-searchinput"),"keyup",this.searchHandler,this)}unWireEvents(){EventHandler.remove(this.dlg,"click",this.clickHandler);let elem=this.dlg.querySelector(".e-searchinput");elem&&EventHandler.remove(elem,"keyup",this.searchHandler)}foreignKeyFilter(args,fColl,mPredicate){let fPredicate={},filterCollection=[],query=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(query.where(mPredicate)).then(e=>{this.options.column.columnData=e.result,this.parent.notify(generateQuery,{predicate:fPredicate,column:this.options.column}),args.ejpredicate=fPredicate.predicate.predicates,fPredicate.predicate.predicates.forEach(fpred=>{filterCollection.push({field:fpred.field,predicate:"or",matchCase:fpred.ignoreCase,ignoreAccent:fpred.ignoreAccent,operator:fpred.operator,value:fpred.value,type:this.options.type})}),args.filterCollection=filterCollection.length?filterCollection:fColl.filter(col=>col.field=this.options.field),this.options.handler(args)})}foreignFilter(args,value){let operator=this.parent.getDataModule().isRemote()?"string"===this.options.column.type?"contains":"equal":this.options.column.type?"startswith":"contains",initalPredicate=new ej2_data_es2015_Predicate(this.options.column.foreignKeyValue,operator,value,!0,this.parent.filterSettings.ignoreAccent);this.foreignKeyFilter(args,[args.filterCollection],initalPredicate)}searchBoxClick(e){e.target.classList.contains("e-searchclear")&&(this.sInput.value="",this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())}searchBoxKeyUp(e){this.refreshCheckboxes(),this.updateSearchIcon()}updateSearchIcon(){this.sInput.value.length?ej2_base_es2015_classList(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]):ej2_base_es2015_classList(this.sIcon,["e-search-icon"],["e-chkcancel-icon"])}getLocalizedLabel(key){return this.localeObj.getConstant(key)}updateDataSource(){let dataSource=this.options.dataSource;if(!(dataSource instanceof ej2_data_es2015_DataManager))for(let i=0;i<dataSource.length;i++)if("object"!=typeof dataSource){let obj={};obj[this.options.field]=dataSource[i],dataSource[i]=obj}}updateModel(options){this.options=options,this.existingPredicate=options.actualPredicate||{},this.options.dataSource=options.dataSource,this.updateDataSource(),this.parent.log("column_type_missing",{column:options.column}),this.options.type=options.type,this.options.format=options.format||"",this.options.filteredColumns=options.filteredColumns||this.parent.filterSettings.columns,this.options.sortedColumns=options.sortedColumns||this.parent.sortSettings.columns,this.options.query=options.query||new ej2_data_es2015_Query,this.options.allowCaseSensitive=options.allowCaseSensitive||!1,this.options.uid=options.column.uid,this.values={},this.localeObj=options.localeObj,this.isFiltered=options.filteredColumns.length}getAndSetChkElem(options){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!options.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox);let inputargs={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search")}};ej2_inputs_es2015_Input.createInput(inputargs,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox}showDialog(options){let args={requestType:filterBeforeOpen,columnName:this.options.field,columnType:this.options.type,cancel:!1};isBlazor()&&!this.parent.isJsComponent||(args.filterModel=this),this.parent.trigger(actionBegin,args),args.cancel||(this.dialogObj=new ej2_popups_es2015_Dialog({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),width:!isNullOrUndefined(parentsUntil(options.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this)}),this.dialogObj.isStringTemplate=!0,this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight="800px",this.dialogObj.show(),this.wireEvents(),createSpinner({target:this.spinner},this.parent.createElement),showSpinner(this.spinner),this.getAllData())}dialogCreated(e){Browser.isDevice?this.dialogObj.position={X:"center",Y:"center"}:getFilterMenuPostion(this.options.target,this.dialogObj,this.parent),this.parent.notify(filterDialogCreated,e)}openDialog(options){this.updateModel(options),this.getAndSetChkElem(options),this.showDialog(options)}closeDialog(){this.dialogObj&&!this.dialogObj.isDestroyed&&(this.parent.getColumns().filter(col=>col.getFilterItemTemplate()).length&&this.parent.destroyTemplate(["filterItemTemplate"]),this.parent.notify(filterMenuClose,{field:this.options.field}),this.dialogObj.destroy(),this.unWireEvents(),ej2_base_es2015_remove(this.dlg),this.dlg=null)}clearFilter(){isActionPrevent(this.parent)?this.parent.notify(preventBatch,{instance:this,handler:this.clearFilter}):this.options.handler({action:"clear-filter",field:this.options.field})}btnClick(e){if(this.filterState){if("input"===e.target.tagName.toLowerCase()){let value=e.target.value;"boolean"===this.options.column.type&&(void 0!==value&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(value.toLowerCase())?value="true":void 0!==value&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(value.toLowerCase())&&(value="false"));let args={action:"filtering",filterCollection:{field:this.options.field,operator:this.parent.getDataModule().isRemote()?"string"===this.options.column.type?"contains":"equal":"date"===this.options.column.type||"datetime"===this.options.column.type||"boolean"===this.options.column.type?"equal":"contains",value:value,matchCase:!1,type:this.options.column.type},field:this.options.field};value?this.options.column.isForeignColumn()?this.foreignFilter(args,value):this.options.handler(args):this.closeDialog()}else{let text=e.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===text?this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===text&&this.clearFilter()}this.closeDialog()}else"input"!==e.target.tagName.toLowerCase()&&(this.clearFilter(),this.closeDialog())}fltrBtnHandler(){let value,fObj,checked=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall)")),optr="equal",searchInput=this.searchBox.querySelector(".e-searchinput"),defaults={field:this.options.field,predicate:"or",uid:this.options.uid,operator:optr,type:this.options.type,matchCase:this.filterSettings.enableCaseSensitivity,ignoreAccent:this.parent.filterSettings.ignoreAccent},isNotEqual=this.itemsCnt!==checked.length&&this.itemsCnt-checked.length<checked.length;isNotEqual&&""===searchInput.value&&(optr="notequal",checked=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),defaults.predicate="and",defaults.operator="notequal");let coll=[];if(checked.length!==this.itemsCnt||searchInput.value&&""!==searchInput.value){for(let i=0;i<checked.length;i++)if(fObj=extend({},{value:value=this.values[parentsUntil(checked[i],"e-ftrchk").getAttribute("uid")]},defaults),value&&!value.toString().length&&(fObj.operator=isNotEqual?"notequal":"equal"),""===value||isNullOrUndefined(value)?("string"===this.options.type&&coll.push({field:defaults.field,ignoreAccent:defaults.ignoreAccent,matchCase:defaults.matchCase,operator:defaults.operator,predicate:defaults.predicate,value:""}),coll.push({field:defaults.field,matchCase:defaults.matchCase,operator:defaults.operator,predicate:defaults.predicate,value:null}),coll.push({field:defaults.field,matchCase:defaults.matchCase,operator:defaults.operator,predicate:defaults.predicate,value:void 0})):coll.push(fObj),isActionPrevent(this.parent))return void this.parent.notify(preventBatch,{instance:this,handler:this.fltrBtnHandler,arg1:fObj.field,arg2:fObj.predicate,arg3:fObj.operator,arg4:fObj.matchCase,arg5:fObj.ignoreAccent,arg6:fObj.value});this.initiateFilter(coll)}else this.clearFilter()}initiateFilter(fColl){let predicate,firstVal=fColl[0];if(!isNullOrUndefined(firstVal)){predicate=firstVal.ejpredicate?firstVal.ejpredicate:new ej2_data_es2015_Predicate(firstVal.field,firstVal.operator,firstVal.value,!firstVal.matchCase,firstVal.ignoreAccent);for(let j=1;j<fColl.length;j++)predicate=void 0!==fColl[j].ejpredicate?predicate[fColl[j].predicate](fColl[j].ejpredicate):predicate[fColl[j].predicate](fColl[j].field,fColl[j].operator,fColl[j].value,!fColl[j].matchCase,fColl[j].ignoreAccent);let args={action:"filtering",filterCollection:fColl,field:this.options.field,ejpredicate:ej2_data_es2015_Predicate.or(predicate)};this.options.handler(args)}}refreshCheckboxes(){let val=this.sInput.value,column=this.options.column,query=column.isForeignColumn()?this.foreignKeyQuery.clone():this.options.query.clone(),foreignQuery=this.options.query.clone();query.queries=[],foreignQuery.queries=[];let predicte,parsed="string"!==this.options.type&&parseFloat(val)?parseFloat(val):val,operator=this.parent.getDataModule().isRemote()?"string"===this.options.type?"contains":"equal":this.options.type?"startswith":"contains",ignoreAccent=this.parent.filterSettings.ignoreAccent,field=column.isForeignColumn()?column.foreignKeyValue:column.field;parsed=""===parsed||void 0===parsed?void 0:parsed,"boolean"===this.options.type&&(void 0!==parsed&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(parsed.toLowerCase())?parsed="true":void 0!==parsed&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(parsed.toLowerCase())&&(parsed="false"),operator="equal"),this.addDistinct(query);let args={requestType:filterSearchBegin,filterModel:this,columnName:field,column:column,operator:operator,matchCase:!0,ignoreAccent:ignoreAccent,filterChoiceCount:null,query:query};if(this.parent.trigger(actionBegin,args),predicte=new ej2_data_es2015_Predicate(field,args.operator,parsed,args.matchCase,args.ignoreAccent),"date"===this.options.type||"datetime"===this.options.type){if(operator="equal",isNullOrUndefined(parsed=this.valueFormatter.fromView(val,this.options.parserFn,this.options.type))&&val.length)return;predicte=getDatePredicate({field:field,operator:operator,value:parsed,matchCase:!0,ignoreAccent:ignoreAccent},this.options.type)}val.length&&query.where(predicte),args.filterChoiceCount=isNullOrUndefined(args.filterChoiceCount)?1e3:args.filterChoiceCount;let fPredicate={};showSpinner(this.spinner),this.renderEmpty=!1,column.isForeignColumn()&&val.length?column.dataSource.executeQuery(query).then(e=>{let columnData=this.options.column.columnData;this.options.column.columnData=e.result,this.parent.notify(generateQuery,{predicate:fPredicate,column:column}),fPredicate.predicate.predicates.length?foreignQuery.where(fPredicate.predicate):this.renderEmpty=!0,this.options.column.columnData=columnData,foreignQuery.take(args.filterChoiceCount),this.search(args,foreignQuery)}):(query.take(args.filterChoiceCount),this.search(args,query))}search(args,query){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(args,query):this.processSearch(query)}getPredicateFromCols(columns){let predicates=ej2_grids_es2015_CheckBoxFilter.getPredicate(columns),predicateList=[],fPredicate={},foreignColumn=this.parent.getForeignKeyColumns();for(let prop of Object.keys(predicates)){let col;this.parent.getColumnByField(prop).isForeignColumn()&&(col=getColumnByForeignKeyValue(prop,foreignColumn)),col?(this.parent.notify(generateQuery,{predicate:fPredicate,column:col}),fPredicate.predicate.predicates.length&&predicateList.push(ej2_data_es2015_Predicate.or(fPredicate.predicate.predicates))):predicateList.push(predicates[prop])}return predicateList.length&&ej2_data_es2015_Predicate.and(predicateList)}getAllData(){let query=this.parent.getQuery().clone();query.requiresCount(),this.addDistinct(query);let args={requestType:filterChoiceRequest,query:query,filterChoiceCount:null};isBlazor()&&!this.parent.isJsComponent||(args.filterModel=this),this.parent.trigger(actionBegin,args),args.filterChoiceCount=isNullOrUndefined(args.filterChoiceCount)?1e3:args.filterChoiceCount,query.take(args.filterChoiceCount),this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(args,query):this.processDataOperation(query,!0)}addDistinct(query){let filteredColumn=ej2_data_es2015_DataUtil.distinct(this.parent.filterSettings.columns,"field");return filteredColumn.indexOf(this.options.column.field)<=-1&&(filteredColumn=filteredColumn.concat(this.options.column.field)),query.distinct(filteredColumn),query}filterEvent(args,query){this.eventPromise(args,query).promise.then(e=>{this.dataSuccess(e)})}eventPromise(args,query){let state;state=this.getStateEventArgument(query);let def=new Deferred;return state.dataSource=def.resolve,state.action=args,this.parent.trigger(dataStateChange,state),def}getStateEventArgument(query){let adaptr=new ej2_data_es2015_UrlAdaptor,dm=new ej2_data_es2015_DataManager({url:"",adaptor:new ej2_data_es2015_UrlAdaptor}),state=adaptr.processQuery(dm,query);return JSON.parse(state.data)}processDataOperation(query,isInitial){this.options.dataSource=this.options.dataSource instanceof ej2_data_es2015_DataManager?this.options.dataSource:new ej2_data_es2015_DataManager(this.options.dataSource);let allPromise=[],runArray=[];this.options.column.isForeignColumn()&&isInitial&&(allPromise.push(this.options.column.dataSource.executeQuery(this.foreignKeyQuery)),runArray.push(data=>this.foreignKeyData=data)),allPromise.push(this.options.dataSource.executeQuery(query)),runArray.push(this.dataSuccess.bind(this));let i=0;Promise.all(allPromise).then(e=>{e.forEach(data=>{runArray[i++](data.result)})})}dataSuccess(e){this.fullData=e;let query=new ej2_data_es2015_Query;if(this.parent.searchSettings.key.length){let sSettings=this.parent.searchSettings,fields=sSettings.fields.length?sSettings.fields:this.parent.getColumns().map(f=>f.field);query.search(sSettings.key,fields,sSettings.operator,sSettings.ignoreCase,sSettings.ignoreAccent)}if(this.options.filteredColumns.length){let cols=[];for(let i=0;i<this.options.filteredColumns.length;i++){let filterColumn=this.options.filteredColumns[i];filterColumn.uid=filterColumn.uid||this.parent.getColumnByField(filterColumn.field).uid,filterColumn.uid!==this.options.uid&&cols.push(this.options.filteredColumns[i])}let predicate=this.getPredicateFromCols(cols);predicate&&query.where(predicate)}let result=new ej2_data_es2015_DataManager(this.fullData).executeLocal(query);this.filteredData=ej2_grids_es2015_CheckBoxFilter.getDistinct(result,this.options.field,this.options.column,this.foreignKeyData).records||[],this.processDataSource(null,!0,this.filteredData),this.sInput.focus();let args={requestType:filterAfterOpen,columnName:this.options.field,columnType:this.options.type};isBlazor()&&!this.parent.isJsComponent||(args.filterModel=this),this.parent.trigger(actionComplete,args)}processDataSource(query,isInitial,dataSource){showSpinner(this.spinner),this.updateResult(),this.createFilterItems(dataSource,isInitial)}processSearch(query){this.processDataOperation(query)}updateResult(){this.result={};let predicate=this.getPredicateFromCols(this.options.filteredColumns),query=new ej2_data_es2015_Query;predicate&&query.where(predicate);let result=new ej2_data_es2015_DataManager(this.fullData).executeLocal(query);for(let res of result)this.result[getValue(this.options.field,res)]=!0}clickHandler(e){let target=e.target,elem=parentsUntil(target,"e-checkbox-wrapper");if(parentsUntil(target,"e-searchbox")&&this.searchBoxClick(e),elem){let selectAll=elem.querySelector(".e-selectall");selectAll?this.updateAllCBoxes(!selectAll.classList.contains("e-check")):function(elem){let span=elem.querySelector(".e-frame");span.classList.contains("e-check")?ej2_base_es2015_classList(span,["e-uncheck"],["e-check"]):ej2_base_es2015_classList(span,["e-check"],["e-uncheck"])}(elem.parentElement),this.updateIndeterminatenBtn(),elem.querySelector(".e-chk-hidden").focus()}}updateAllCBoxes(checked){let cBoxes=[].slice.call(this.cBox.querySelectorAll(".e-frame"));for(let cBox of cBoxes)removeAddCboxClasses(cBox,checked)}dialogOpen(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.dialogObj.element.querySelector(".e-btn").focus())}createCheckbox(value,checked,data){let elem=checked?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0),label=elem.querySelector(".e-label");return label.innerHTML=!isNullOrUndefined(value)&&value.toString().length?value:this.getLocalizedLabel("Blanks"),addClass([label],["e-checkboxfiltertext"]),this.options.template&&(label.innerHTML="",appendChildren(label,this.options.template(data,this.parent,"filterItemTemplate"))),elem}updateIndeterminatenBtn(){let cnt=this.cBox.children.length-1,className=[],elem=this.cBox.querySelector(".e-selectall"),selected=this.cBox.querySelectorAll(".e-check:not(.e-selectall)").length,btn=this.dialogObj.btnObj[0];btn.disabled=!1,cnt===selected?className=["e-check"]:selected?className=["e-stop"]:(className=["e-uncheck"],btn.disabled=!0),this.filterState=!btn.disabled,btn.dataBind(),removeClass([elem],["e-check","e-stop","e-uncheck"]),addClass([elem],className)}createFilterItems(data,isInitial){let cBoxes=this.parent.createElement("div"),btn=this.dialogObj.btnObj[0],nullCounter=-1;for(let i=0;i<data.length;i++){let val=getValue("ejValue",data[i]);(""===val||isNullOrUndefined(val))&&(nullCounter+=1)}if(this.itemsCnt=-1!==nullCounter?data.length-nullCounter:data.length,data.length&&!this.renderEmpty){let selectAllValue=this.getLocalizedLabel("SelectAll"),checkBox=this.createCheckbox(selectAllValue,!1,{[this.options.field]:selectAllValue}),selectAll=createCboxWithWrap(getUid("cbox"),checkBox,"e-ftrchk");selectAll.querySelector(".e-frame").classList.add("e-selectall"),cBoxes.appendChild(selectAll);let predicate=new ej2_data_es2015_Predicate("field","equal",this.options.field);this.options.foreignKeyValue&&(predicate=predicate.or("field","equal",this.options.foreignKeyValue));let isRndere,isColFiltered=new ej2_data_es2015_DataManager(this.options.filteredColumns).executeLocal((new ej2_data_es2015_Query).where(predicate)).length;for(let i=0;i<data.length;i++){let uid=getUid("cbox");this.values[uid]=getValue("ejValue",data[i]);let value=this.valueFormatter.toView(getValue(this.options.field,data[i]),this.options.formatFn);if(""===value||isNullOrUndefined(value)){if(isRndere)continue;isRndere=!0}let checkbox=this.createCheckbox(value,this.getCheckedState(isColFiltered,this.values[uid]),getValue("dataObj",data[i]));cBoxes.appendChild(createCboxWithWrap(uid,checkbox,"e-ftrchk"))}this.cBox.innerHTML="",appendChildren(this.cBox,[].slice.call(cBoxes.children)),this.updateIndeterminatenBtn(),btn.disabled=!1}else cBoxes.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",appendChildren(this.cBox,[].slice.call(cBoxes.children)),btn.disabled=!0;this.filterState=!btn.disabled,btn.dataBind();let args={requestType:filterChoiceRequest,dataSource:this.renderEmpty?[]:data};isBlazor()&&!this.parent.isJsComponent||(args.filterModel=this),this.parent.trigger(actionComplete,args),hideSpinner(this.spinner)}getCheckedState(isColFiltered,value){return!this.isFiltered||!isColFiltered||this.result[value]}static getDistinct(json,field,column,foreignKeyData$$1){let value,len=json.length,result=[],lookup={},isForeignKey=column&&column.isForeignColumn();for(;len--;)if(!((value=getValue(field,value=json[len]))in lookup)){let obj={};if(obj.ejValue=value,lookup[value]=!0,isForeignKey){let foreignDataObj=getForeignData(column,{},value,foreignKeyData$$1)[0];setValue(ej2_grids_es2015_foreignKeyData,foreignDataObj,json[len]),value=getValue(column.foreignKeyValue,foreignDataObj)}setValue(field,isNullOrUndefined(value)?null:value,obj),setValue("dataObj",json[len],obj),result.push(obj)}return ej2_data_es2015_DataUtil.group(ej2_data_es2015_DataUtil.sort(result,field,ej2_data_es2015_DataUtil.fnAscending),"ejValue")}static getPredicate(columns){let cols=ej2_data_es2015_DataUtil.distinct(columns,"field",!0)||[],collection=[],pred={};for(let i=0;i<cols.length;i++)0!==(collection=new ej2_data_es2015_DataManager(columns).executeLocal((new ej2_data_es2015_Query).where("field","equal",cols[i].field))).length&&(pred[cols[i].field]=ej2_grids_es2015_CheckBoxFilter.generatePredicate(collection));return pred}static generatePredicate(cols){let predicate,first,len=cols?cols.length:0;(first=ej2_grids_es2015_CheckBoxFilter.updateDateFilter(cols[0])).ignoreAccent=!isNullOrUndefined(first.ignoreAccent)&&first.ignoreAccent,predicate="date"===first.type||"datetime"===first.type?getDatePredicate(first,first.type):first.ejpredicate?first.ejpredicate:new ej2_data_es2015_Predicate(first.field,first.operator,first.value,!ej2_grids_es2015_CheckBoxFilter.getCaseValue(first),first.ignoreAccent);for(let p=1;p<len;p++)cols[p]=ej2_grids_es2015_CheckBoxFilter.updateDateFilter(cols[p]),len>2&&p>1&&"or"===cols[p].predicate?predicate.predicates.push("date"===cols[p].type||"datetime"===cols[p].type?getDatePredicate(cols[p],cols[p].type):new ej2_data_es2015_Predicate(cols[p].field,cols[p].operator,cols[p].value,!ej2_grids_es2015_CheckBoxFilter.getCaseValue(cols[p]),cols[p].ignoreAccent)):predicate="date"===cols[p].type||"datetime"===cols[p].type?predicate[cols[p].predicate](getDatePredicate(cols[p]),cols[p].type,cols[p].ignoreAccent):cols[p].ejpredicate?predicate[cols[p].predicate](cols[p].ejpredicate):predicate[cols[p].predicate](cols[p].field,cols[p].operator,cols[p].value,!ej2_grids_es2015_CheckBoxFilter.getCaseValue(cols[p]),cols[p].ignoreAccent);return predicate||null}static getCaseValue(filter){return!!isNullOrUndefined(filter.matchCase)||filter.matchCase}static updateDateFilter(filter){return("date"===filter.type||"datetime"===filter.type||filter.value instanceof Date)&&(filter.type=filter.type||"date"),filter}getModuleName(){return"checkboxFilter"}}class ej2_grids_es2015_Data{constructor(parent,serviceLocator){this.dataState={isPending:!1,resolver:null,group:[]},this.parent=parent,this.serviceLocator=serviceLocator,this.initDataManager(),this.parent.isDestroyed||"foreignKey"===this.getModuleName()||(this.parent.on(rowsAdded,this.addRows,this),this.parent.on(rowPositionChanged,this.reorderRows,this),this.parent.on(rowsRemoved,this.removeRows,this),this.parent.on(dataSourceModified,this.initDataManager,this),this.parent.on(ej2_grids_es2015_destroy,this.destroy,this),this.parent.on(updateData,this.crudActions,this),this.parent.on(addDeleteAction,this.getData,this),this.parent.on(autoCol,this.refreshFilteredCols,this))}reorderRows(e){this.dataManager.dataSource.json.splice(e.toIndex,0,this.dataManager.dataSource.json.splice(e.fromIndex,1)[0])}getModuleName(){return"data"}initDataManager(){let gObj=this.parent;this.dataManager=gObj.dataSource instanceof ej2_data_es2015_DataManager?gObj.dataSource:isNullOrUndefined(gObj.dataSource)?new ej2_data_es2015_DataManager:new ej2_data_es2015_DataManager(gObj.dataSource),gObj.setProperties({query:gObj.query instanceof ej2_data_es2015_Query?gObj.query:new ej2_data_es2015_Query},!0)}generateQuery(skipPage){let query=this.parent.getQuery().clone();if("ExcludeHidden"===this.parent.columnQueryMode)query.select(this.parent.getColumns().filter(column=>!(!0!==column.isPrimaryKey&&!1===column.visible||void 0===column.field)).map(column=>column.field));else if("Schema"===this.parent.columnQueryMode){let selectQueryFields=[],columns=this.parent.columns;for(let i=0;i<columns.length;i++)selectQueryFields.push(columns[i].field);query.select(selectQueryFields)}return this.filterQuery(query),this.searchQuery(query),this.aggregateQuery(query),this.sortQuery(query),isGroupAdaptive(this.parent)?this.virtualGroupPageQuery(query):this.pageQuery(query,skipPage),this.groupQuery(query),query}aggregateQuery(query,isForeign){return this.parent.aggregates.forEach(row=>{row.columns.forEach(column=>{(column.type instanceof Array?column.type:[column.type]).forEach(type=>query.aggregate(type.toLowerCase(),column.field))})}),query}virtualGroupPageQuery(query){if(query.queries.length)for(let i=0;i<query.queries.length;i++)"onPage"===query.queries[i].fn&&query.queries.splice(i,1);return query}pageQuery(query,skipPage){let gObj=this.parent;if((gObj.allowPaging||gObj.enableVirtualization)&&!0!==skipPage){if(gObj.pageSettings.currentPage=Math.max(1,gObj.pageSettings.currentPage),gObj.pageSettings.pageCount<=0&&(gObj.pageSettings.pageCount=8),gObj.pageSettings.pageSize<=0&&(gObj.pageSettings.pageSize=12),query.queries.length)for(let i=0;i<query.queries.length;i++)"onPage"===query.queries[i].fn&&query.queries.splice(i,1);query.page(gObj.pageSettings.currentPage,gObj.pageSettings.pageSize)}return query}groupQuery(query){let gObj=this.parent;if(gObj.allowGrouping&&gObj.groupSettings.columns.length){let columns=gObj.groupSettings.columns;for(let i=0,len=columns.length;i<len;i++){let column=this.getColumnByField(columns[i]);column||this.parent.log("initial_action",{moduleName:"group",columnName:columns[i]});let format=column.format;column.enableGroupByFormat?query.group(columns[i],this.formatGroupColumn.bind(this),format):query.group(columns[i],null)}}return query}sortQuery(query){let gObj=this.parent;if((gObj.allowSorting||gObj.allowGrouping)&&gObj.sortSettings.columns.length){let columns=gObj.sortSettings.columns,sortGrp=[];for(let i=columns.length-1;i>-1;i--){let col=this.getColumnByField(columns[i].field);if(!col)return this.parent.log("initial_action",{moduleName:"sort",columnName:columns[i].field}),query;col.setSortDirection(columns[i].direction);let fn=columns[i].direction;col.sortComparer&&(this.parent.log("grid_sort_comparer"),fn=this.isRemote()?columns[i].direction:col.sortComparer.bind(col)),-1===gObj.groupSettings.columns.indexOf(columns[i].field)?query.sortBy(col.field,fn):sortGrp.push({direction:fn,field:col.field})}for(let i=0,len=sortGrp.length;i<len;i++)query.sortBy(sortGrp[i].field,sortGrp[i].direction)}return query}searchQuery(query){let sSettings=this.parent.searchSettings,fields=sSettings.fields.length?sSettings.fields:this.getSearchColumnFieldNames(),predicateList=[];return this.parent.searchSettings.key.length&&(!this.parent.getForeignKeyColumns().some(col=>fields.indexOf(col.field)>-1)||this.dataManager.adaptor.getModulename&&"ODataV4Adaptor"===this.dataManager.adaptor.getModulename()?query.search(sSettings.key,fields,sSettings.operator,sSettings.ignoreCase,sSettings.ignoreAccent):(fields.forEach(columnName=>{let column=this.getColumnByField(columnName);column.isForeignColumn()?predicateList=this.fGeneratePredicate(column,predicateList):predicateList.push(new ej2_data_es2015_Predicate(column.field,sSettings.operator,sSettings.key,sSettings.ignoreCase,sSettings.ignoreAccent))}),query.where(ej2_data_es2015_Predicate.or(predicateList)))),query}filterQuery(query,column,skipFoerign){let gObj=this.parent,predicateList=[],actualFilter=[],foreignColumn=this.parent.getForeignKeyColumns();if(gObj.allowFiltering&&gObj.filterSettings.columns.length){let columns=column||gObj.filterSettings.columns,colType={};for(let col of gObj.getColumns())colType[col.field]=col.filter.type?col.filter.type:gObj.filterSettings.type;let checkBoxCols=[],defaultFltrCols=[];for(let col of columns)"CheckBox"===colType[col.field]||"Excel"===colType[col.field]?checkBoxCols.push(col):defaultFltrCols.push(col);if(checkBoxCols.length){let excelPredicate=ej2_grids_es2015_CheckBoxFilter.getPredicate(checkBoxCols);for(let prop of Object.keys(excelPredicate)){let col;this.parent.getColumnByField(prop).isForeignColumn()&&(col=getColumnByForeignKeyValue(prop,foreignColumn)),col||this.parent.log("initial_action",{moduleName:"filter",columnName:prop}),col&&!skipFoerign?(predicateList=this.fGeneratePredicate(col,predicateList),actualFilter.push(col)):predicateList.push(excelPredicate[prop])}}if(defaultFltrCols.length)for(let col of defaultFltrCols){col.uid=col.uid||this.parent.grabColumnByFieldFromAllCols(col.field).uid;let column=this.parent.grabColumnByUidFromAllCols(col.uid);column||this.parent.log("initial_action",{moduleName:"filter",columnName:col.field});let sType=column.type;column.isForeignColumn()&&getColumnByForeignKeyValue(col.field,foreignColumn)&&!skipFoerign?(actualFilter.push(col),predicateList=this.fGeneratePredicate(column,predicateList)):predicateList.push("date"!==sType&&"datetime"!==sType?new ej2_data_es2015_Predicate(col.field,col.operator,col.value,!col.matchCase,this.parent.filterSettings.ignoreAccent):getDatePredicate(col,sType))}predicateList.length?query.where(ej2_data_es2015_Predicate.and(predicateList)):this.parent.notify(showEmptyGrid,{})}return query}fGeneratePredicate(col,predicateList){let fPredicate={};return col&&(this.parent.notify(generateQuery,{predicate:fPredicate,column:col}),fPredicate.predicate.predicates.length&&predicateList.push(fPredicate.predicate)),predicateList}getData(args={requestType:""},query){let key=this.getKey(args.foreignKeyData&&Object.keys(args.foreignKeyData).length?args.foreignKeyData:this.parent.getPrimaryKeyFieldNames());if(this.parent.log("datasource_syntax_mismatch",{dataState:this.parent}),this.parent.dataSource&&"result"in this.parent.dataSource)return this.eventPromise(args,query,key).promise;{let crud;switch(args.requestType){case"delete":if(query=query||this.generateQuery(),1===Object.keys(args.data).length)crud=this.dataManager.remove(key,args.data[0],query.fromTable,query);else{let changes={addedRecords:[],deletedRecords:[],changedRecords:[]};changes.deletedRecords=args.data,crud=this.dataManager.saveChanges(changes,key,query.fromTable,query.requiresCount())}break;case"save":query=query||this.generateQuery(),args.index=isNullOrUndefined(args.index)?0:args.index,crud=this.dataManager.insert(args.data,query.fromTable,query,args.index)}return!crud||Array.isArray(crud)||crud.hasOwnProperty("deletedRecords")?this.insert(query,args):crud.then(result=>this.insert(query,args))}}insert(query,args){return"save"===args.requestType&&this.parent.notify(recordAdded,args),this.executeQuery(query)}executeQuery(query){if(this.dataManager.ready){let deferred=new Deferred;return this.dataManager.ready.then(e=>{this.dataManager.executeQuery(query).then(result=>{deferred.resolve(result)})}).catch(e=>{deferred.reject(e)}),deferred.promise}return this.dataManager.executeQuery(query)}formatGroupColumn(value,field){let serviceLocator=this.serviceLocator,column=this.getColumnByField(field),date=value;return column.type||(column.type=date.getDay?date.getHours()>0||date.getMinutes()>0||date.getSeconds()>0||date.getMilliseconds()>0?"datetime":"date":typeof value),isNullOrUndefined(column.getFormatter())&&setFormatter(serviceLocator,column),ej2_grids_es2015_ValueFormatter.prototype.toView(value,column.getFormatter())}crudActions(args){let query=this.generateQuery(),promise=null,pr="promise",key=this.getKey(args.foreignKeyData&&Object.keys(args.foreignKeyData).length?args.foreignKeyData:this.parent.getPrimaryKeyFieldNames());switch(this.parent.dataSource&&"result"in this.parent.dataSource&&this.eventPromise(args,query,key),args.requestType){case"save":promise=this.dataManager.update(key,args.data,query.fromTable,query,args.previousData)}args[pr]=promise||args[pr],this.parent.notify(crudAction,args)}saveChanges(changes,key,original,query=this.generateQuery()){if(query.requiresCount(),"result"in this.parent.dataSource){let state;state=this.getStateEventArgument(query);let deff=new Deferred,args={requestType:"batchsave",changes:changes,key:key,query:query,endEdit:deff.resolve};return this.setState({isPending:!0,resolver:deff.resolve}),this.parent.trigger(dataSourceChanged,args),deff.promise}return this.dataManager.saveChanges(changes,key,query.fromTable,query,original)}getKey(keys){if(keys&&keys.length)return keys[0]}isRemote(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url}addRows(e){for(let i=e.records.length;i>0;i--)this.dataManager.dataSource.json.splice(e.toIndex,0,e.records[i-1])}removeRows(e){this.dataManager.dataSource.json=this.dataManager.dataSource.json.filter((value,index)=>-1===e.records.indexOf(value))}getColumnByField(field){let col;return this.parent.columnModel.some(column=>(col=column,column.field===field))&&col}destroy(){this.parent.isDestroyed||(this.parent.off(rowsAdded,this.addRows),this.parent.off(rowsRemoved,this.removeRows),this.parent.off(dataSourceModified,this.initDataManager),this.parent.off(ej2_grids_es2015_destroy,this.destroy),this.parent.off(updateData,this.crudActions),this.parent.off(addDeleteAction,this.getData),this.parent.off(autoCol,this.refreshFilteredCols))}getState(){return this.dataState}setState(state){return this.dataState=state}getStateEventArgument(query){let adaptr=new ej2_data_es2015_UrlAdaptor,dm=new ej2_data_es2015_DataManager({url:"",adaptor:new ej2_data_es2015_UrlAdaptor}),state=adaptr.processQuery(dm,query);return extend(JSON.parse(state.data),state.pvtData)}eventPromise(args,query,key){let state,dataArgs=args;state=this.getStateEventArgument(query);let def=new Deferred,deff=new Deferred;if(void 0!==args.requestType&&!1!==this.dataState.isDataChanged)if(state.action=args,"save"===args.requestType||"delete"===args.requestType){let editArgs=args;editArgs.key=key,editArgs.promise=deff.promise,editArgs.state=state,this.setState({isPending:!0,resolver:deff.resolve}),dataArgs.endEdit=deff.resolve,dataArgs.cancelEdit=deff.reject,this.parent.trigger(dataSourceChanged,editArgs),deff.promise.then(e=>{this.setState({isPending:!0,resolver:def.resolve,group:state.group,aggregates:state.aggregates}),this.parent.trigger(dataStateChange,state)}).catch(()=>void 0)}else this.setState({isPending:!0,resolver:def.resolve,group:state.group,aggregates:state.aggregates}),this.parent.trigger(dataStateChange,state);else this.setState({}),def.resolve(this.parent.dataSource);return def}getSearchColumnFieldNames(){let colFieldNames=[],columns=this.parent.getColumns();for(let col of columns)col.allowSearching&&!isNullOrUndefined(col.field)&&colFieldNames.push(col.field);return colFieldNames}refreshFilteredCols(){this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&function(gObj,filteredCols){for(let i=0;i<filteredCols.length;i++)filteredCols[i].uid=filteredCols[i].isForeignKey?getColumnByForeignKeyValue(filteredCols[i].field,gObj.getForeignKeyColumns()).uid:gObj.getColumnByField(filteredCols[i].field).uid}(this.parent,this.parent.filterSettings.columns)}}class ej2_grids_es2015_Row{constructor(options){ej2_base_es2015_merge(this,options)}clone(){let row=new ej2_grids_es2015_Row({});return ej2_base_es2015_merge(row,this),row.cells=this.cells.map(cell=>cell.clone()),row}}class ej2_grids_es2015_Cell{constructor(options){this.isSpanned=!1,this.isRowSpanned=!1,ej2_base_es2015_merge(this,options)}clone(){let cell=new ej2_grids_es2015_Cell({});return ej2_base_es2015_merge(cell,this),cell}}class ej2_grids_es2015_CellMergeRender{constructor(serviceLocator,parent){this.serviceLocator=serviceLocator,this.parent=parent}render(cellArgs,row,i,td){let spannedCell,cellRenderer=this.serviceLocator.getService("cellRendererFactory").getCellRenderer(row.cells[i].cellType||CellType.Data),colSpan=row.cells[i].cellSpan?row.cells[i].cellSpan:cellArgs.colSpan+i<=row.cells.length?cellArgs.colSpan:row.cells.length-i,rowSpan=cellArgs.rowSpan,visible=0;if(row.index>0){let cells=this.parent.groupSettings.columns.length>0&&!this.parent.getRowsObject()[row.index-1].isDataRow?this.parent.getRowsObject()[row.index].cells:this.parent.getRowsObject()[row.index-1].cells,targetCell=row.cells[i],uid="uid";spannedCell=cells.filter(cell=>cell.column.uid===targetCell.column[uid])[0]}let colSpanLen=spannedCell&&spannedCell.colSpanRange>1&&spannedCell.rowSpanRange>1?spannedCell.colSpanRange:colSpan;for(let j=i+1;j<i+colSpanLen&&j<row.cells.length;j++)!1===row.cells[j].visible?visible++:row.cells[j].isSpanned=!0;if(visible>0){for(let j=i+colSpan;j<i+colSpan+visible&&j<row.cells.length;j++)row.cells[j].isSpanned=!0;i+colSpan+visible>=row.cells.length&&(colSpan-=i+colSpan+visible-row.cells.length)}return row.cells[i].cellSpan&&(row.data[cellArgs.column.field]=row.cells[i].spanText,td=cellRenderer.render(row.cells[i],row.data,{index:isNullOrUndefined(row.index)?"":row.index.toString()})),colSpan>1&&attributes(td,{colSpan:colSpan.toString(),"aria-colSpan":colSpan.toString()}),rowSpan>1&&(attributes(td,{rowspan:rowSpan.toString(),"aria-rowspan":rowSpan.toString()}),row.cells[i].isRowSpanned=!0,row.cells[i].rowSpanRange=Number(rowSpan),colSpan>1&&(row.cells[i].colSpanRange=Number(colSpan))),row.index>0&&spannedCell.rowSpanRange>1&&(row.cells[i].isSpanned=!0,row.cells[i].rowSpanRange=Number(spannedCell.rowSpanRange-1),row.cells[i].colSpanRange=spannedCell.rowSpanRange>0?spannedCell.colSpanRange:1),!this.parent.enableColumnVirtualization||row.cells[i].cellSpan||this.containsKey(cellArgs.column.field,cellArgs.data[cellArgs.column.field])||this.backupMergeCells(cellArgs.column.field,cellArgs.data[cellArgs.column.field],cellArgs.colSpan),td}backupMergeCells(fName,data,span){this.setMergeCells(this.generteKey(fName,data),span)}generteKey(fname,data){return fname+"__"+data.toString()}splitKey(key){return key.split("__")}containsKey(fname,data){return this.getMergeCells().hasOwnProperty(this.generteKey(fname,data))}getMergeCells(){return this.parent.mergeCells}setMergeCells(key,span){this.parent.mergeCells[key]=span}updateVirtualCells(rows){let mCells=this.getMergeCells();for(let key of Object.keys(mCells)){let value=mCells[key],merge$$1=this.splitKey(key),columnIndex=this.getIndexFromAllColumns(merge$$1[0]),vColumnIndices=this.parent.getColumnIndexesInView(),span=value-(vColumnIndices[0]-columnIndex);if(columnIndex<vColumnIndices[0]&&span>1)for(let row of rows)if(row.data[merge$$1[0]].toString()===merge$$1[1].toString()){row.cells[0].cellSpan=span,row.cells[0].spanText=merge$$1[1];break}}return rows}getIndexFromAllColumns(field){return iterateArrayOrObject(this.parent.getVisibleColumns(),(item,index)=>{if(item.field===field)return index})[0]}}class ej2_grids_es2015_RowRenderer{constructor(serviceLocator,cellType,parent){this.isSpan=!1,this.cellType=cellType,this.serviceLocator=serviceLocator,this.parent=parent,this.element=this.parent.createElement("tr",{attrs:{role:"row"}})}render(row,columns,attributes$$1,rowTemplate,cloneNode){return this.refreshRow(row,columns,attributes$$1,rowTemplate,cloneNode)}refresh(row,columns,isChanged,attributes$$1,rowTemplate){isChanged&&(row.data=extendObjWithFn({},row.changes),this.refreshMergeCells(row));let node=this.parent.element.querySelector("[data-uid="+row.uid+"]"),tr=this.refreshRow(row,columns,attributes$$1,rowTemplate,null,isChanged),cells=[].slice.call(tr.cells);node.innerHTML="";for(let cell of cells)node.appendChild(cell)}refreshRow(row,columns,attributes$$1,rowTemplate,cloneNode,isEdit){let tr=isNullOrUndefined(cloneNode)?this.element.cloneNode():cloneNode,rowArgs={data:row.data},cellArgs={data:row.data},attrCopy=extend({},attributes$$1,{}),chekBoxEnable=this.parent.getColumns().filter(col=>"checkbox"===col.type&&col.field)[0],value=!1;chekBoxEnable&&(value=ej2_grids_es2015_getObject(chekBoxEnable.field,rowArgs.data)),row.isDataRow&&(row.isSelected=this.parent.getSelectedRowIndexes().indexOf(row.index)>-1||value),row.isDataRow&&this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(row.isSelected=!0,-1===this.parent.getSelectedRowIndexes().indexOf(row.index)&&this.parent.getSelectedRowIndexes().push(row.index)),this.buildAttributeFromRow(tr,row),attributes(tr,attrCopy),setStyleAndAttributes(tr,row.attributes);let cellRendererFact=this.serviceLocator.getService("cellRendererFactory");for(let i=0,len=row.cells.length;i<len;i++){let cell=row.cells[i];cell.isSelected=row.isSelected;let cellRenderer=cellRendererFact.getCellRenderer(row.cells[i].cellType||CellType.Data),attrs={index:isNullOrUndefined(row.index)?"":row.index.toString()};row.isExpand&&row.cells[i].cellType===CellType.DetailExpand&&(attrs.class=this.parent.isPrinting?"e-detailrowcollapse":"e-detailrowexpand");let td=cellRenderer.render(row.cells[i],row.data,attrs,row.isExpand,isEdit);if(row.cells[i].cellType!==CellType.Filter){if(row.cells[i].cellType===CellType.Data||row.cells[i].cellType===CellType.CommandColumn){this.parent.trigger(queryCellInfo,extend(cellArgs,{cell:td,column:cell.column,colSpan:1,rowSpan:1,foreignKeyData:row.cells[i].foreignKeyData,requestType:this.parent.requestTypeAction}));let isRowSpanned=!1;if(row.index>0&&this.isSpan){let prevRowCells=this.parent.groupSettings.columns.length>0&&!this.parent.getRowsObject()[row.index-1].isDataRow?this.parent.getRowsObject()[row.index].cells:this.parent.getRowsObject()[row.index-1].cells,uid="uid",prevRowCell=prevRowCells.filter(cell=>cell.column.uid===row.cells[i].column[uid])[0];isRowSpanned=prevRowCell.isRowSpanned?prevRowCell.isRowSpanned:prevRowCell.rowSpanRange>1}(cellArgs.colSpan>1||row.cells[i].cellSpan>1||cellArgs.rowSpan>1||isRowSpanned)&&(this.isSpan=!0,td=new ej2_grids_es2015_CellMergeRender(this.serviceLocator,this.parent).render(cellArgs,row,i,td))}row.cells[i].isSpanned||tr.appendChild(td)}}if(row.isDataRow&&(this.parent.trigger(rowDataBound,extend(rowArgs,{row:tr,rowHeight:this.parent.rowHeight})),this.parent.childGrid||this.parent.isRowDragable()||this.parent.detailTemplate)){let td=tr.querySelectorAll(".e-rowcell:not(.e-hide)")[0];td&&td.classList.add("e-detailrowvisible")}if(this.parent.enableVirtualization&&(rowArgs.rowHeight=this.parent.rowHeight),rowArgs.rowHeight?tr.style.height=rowArgs.rowHeight+"px":this.parent.rowHeight&&(tr.querySelector(".e-headercell")||tr.querySelector(".e-groupcaption"))&&(tr.style.height=this.parent.rowHeight+"px"),row.cssClass&&tr.classList.add(row.cssClass),this.parent.element.scrollHeight>this.parent.height&&this.parent.aggregates.length)for(let i=0;i<this.parent.aggregates.length;i++)if(this.parent.aggregates[i].properties.columns[0].footerTemplate){let summarycell=tr.querySelectorAll(".e-summarycell");summarycell.length&&addClass([summarycell[summarycell.length-1]],["e-lastsummarycell"])}return tr}refreshMergeCells(row){for(let cell of row.cells)cell.isSpanned=!1;return row}buildAttributeFromRow(tr,row){let attr={},classes=[];row.isDataRow&&classes.push("e-row"),row.isAltRow&&classes.push("e-altrow"),isNullOrUndefined(row.index)||(attr["aria-rowindex"]=row.index),row.rowSpan&&(attr.rowSpan=row.rowSpan),row.uid&&(attr["data-uid"]=row.uid),row.isSelected&&(attr["aria-selected"]=!0),!1===row.visible&&classes.push("e-hide"),attr.class=classes,setStyleAndAttributes(tr,attr)}}class ej2_grids_es2015_RowModelGenerator{constructor(parent){this.parent=parent}generateRows(data,args){let rows=[],startIndex=this.parent.enableVirtualization?args.startIndex:0;for(let i=0,len=Object.keys(data).length;i<len;i++,startIndex++)rows[i]=this.generateRow(data[i],startIndex);return rows}ensureColumns(){let cols=[];return(this.parent.detailTemplate||this.parent.childGrid)&&cols.push(this.generateCell({},null,CellType.DetailExpand)),this.parent.isRowDragable()&&cols.push(this.generateCell({},null,CellType.RowDragIcon)),cols}generateRow(data,index,cssClass,indent,pid,tIndex){let options={foreignKeyData:{}};options.uid=getUid("grid-row"),options.data=data,options.index=index,options.indent=indent,options.tIndex=tIndex,options.isDataRow=!0,options.parentGid=pid,this.parent.isPrinting&&("All"===this.parent.hierarchyPrintMode?options.isExpand=!0:"Expanded"===this.parent.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[index]&&(options.isExpand=this.parent.expandedRows[index].isExpand)),options.cssClass=cssClass,options.isAltRow=!!this.parent.enableAltRow&&index%2!=0,options.isSelected=this.parent.getSelectedRowIndexes().indexOf(index)>-1,this.refreshForeignKeyRow(options);let cells=this.ensureColumns(),row=new ej2_grids_es2015_Row(options);return row.cells=cells.concat(this.generateCells(options)),row}refreshForeignKeyRow(options){this.parent.getForeignKeyColumns().forEach(col=>{setValue(col.field,getForeignData(col,options.data),options.foreignKeyData)})}generateCells(options){let dummies=this.parent.getColumns(),tmp=[];return dummies.forEach((dummy,index)=>tmp.push(this.generateCell(dummy,options.uid,isNullOrUndefined(dummy.commands)?void 0:CellType.CommandColumn,null,index,options.foreignKeyData))),tmp}generateCell(column,rowId,cellType,colSpan,oIndex,foreignKeyData){let opt={visible:column.visible,isDataCell:!isNullOrUndefined(column.field||column.template),isTemplate:!isNullOrUndefined(column.template),rowID:rowId,column:column,cellType:isNullOrUndefined(cellType)?CellType.Data:cellType,colSpan:colSpan,commands:column.commands,isForeignKey:column.isForeignColumn&&column.isForeignColumn(),foreignKeyData:column.isForeignColumn&&column.isForeignColumn()&&getValue(column.field,foreignKeyData)};return(opt.isDataCell||"checkbox"===opt.column.type)&&(opt.index=oIndex),new ej2_grids_es2015_Cell(opt)}refreshRows(input){return input.forEach(row=>{this.refreshForeignKeyRow(row),row.cells=this.generateCells(row)}),input}}class ej2_grids_es2015_SummaryModelGenerator{constructor(parent){this.parent=parent}getData(){let rows=[];return this.parent.aggregates.slice().forEach(row=>{let columns=row.columns.filter(column=>!(column.footerTemplate||column.groupFooterTemplate||column.groupCaptionTemplate)||this.columnSelector(column));columns.length&&rows.push({columns:columns})}),rows}columnSelector(column){return void 0!==column.footerTemplate}getColumns(start,end){let columns=[];return this.parent.allowGrouping&&this.parent.groupSettings.columns.forEach(value=>columns.push(new ej2_grids_es2015_Column({}))),(this.parent.detailTemplate||!isNullOrUndefined(this.parent.childGrid)||this.parent.isRowDragable())&&columns.push(new ej2_grids_es2015_Column({})),columns.push(...this.parent.getColumns()),isNullOrUndefined(start)?columns:columns.slice(start,end)}generateRows(input,args,start,end){if(0===this.parent.currentViewData.length)return[];let data=this.buildSummaryData(input,args),rows=[];return this.getData().forEach((row,index)=>{rows.push(this.getGeneratedRow(row,data[index],args?args.level:void 0,start,end))}),rows}getGeneratedRow(summaryRow,data,raw,start,end){let tmp=[],indents=this.getIndentByLevel(raw),isDetailGridAlone=!isNullOrUndefined(this.parent.childGrid),indentLength=this.parent.groupSettings.columns.length+(this.parent.detailTemplate||!isNullOrUndefined(this.parent.childGrid)?1:0);this.parent.isRowDragable()&&(indentLength++,indents=["e-indentcelltop"]),this.getColumns(start,end).forEach((value,index)=>tmp.push(this.getGeneratedCell(value,summaryRow,index>=indentLength?this.getCellType():index<this.parent.groupSettings.columns.length?CellType.Indent:CellType.DetailFooterIntent,indents[index],isDetailGridAlone)));let row=new ej2_grids_es2015_Row({data:data,attributes:{class:"e-summaryrow"}});return row.cells=tmp,row.uid=getUid("grid-row"),row.visible=tmp.some(cell=>cell.isDataCell&&cell.visible),row}getGeneratedCell(column,summaryRow,cellType,indent,isDetailGridAlone){let sColumn=summaryRow.columns.filter(scolumn=>scolumn.columnName===column.field)[0],attrs={style:{textAlign:column.textAlign}};indent&&(attrs.class=indent),isNullOrUndefined(indent)&&isDetailGridAlone&&(attrs.class="e-detailindentcelltop");let opt={visible:column.visible,isDataCell:!isNullOrUndefined(sColumn),isTemplate:sColumn&&!isNullOrUndefined(sColumn.footerTemplate||sColumn.groupFooterTemplate||sColumn.groupCaptionTemplate),column:sColumn||{},attributes:attrs,cellType:cellType};return new ej2_grids_es2015_Cell(opt)}buildSummaryData(data,args){let dummy=[],summaryRows=this.getData(),single={};return summaryRows.forEach(row=>{single={},row.columns.forEach(column=>{single=this.setTemplate(column,args&&args.aggregates?args:data,single)}),dummy.push(single)}),dummy}getIndentByLevel(data){return this.parent.groupSettings.columns.map(()=>"e-indentcelltop")}setTemplate(column,data,single){let types=column.type,helper={},formatFn=column.getFormatter()||(a=>a),group=data;return types instanceof Array||(types=[column.type]),types.forEach(type=>{let key=column.field+" - "+type.toLowerCase(),disp=column.columnName,val="Custom"!==type&&group.aggregates&&key in group.aggregates?group.aggregates[key]:function(type,data,column,context){if("Custom"===type){let temp=column.customAggregate;return"string"==typeof temp&&(temp=getValue(temp,window)),temp?temp.call(context,data,column):""}return column.field in data||data instanceof Array?ej2_data_es2015_DataUtil.aggregates[type.toLowerCase()](data,column.field):null}(type,group.aggregates?group:data,column,this.parent);single[disp]=single[disp]||{},single[disp][key]=val,single[disp][type]=isNullOrUndefined(val)?" ":formatFn(val),group.field&&(single[disp].field=group.field,single[disp].key=group.key)}),helper.format=column.getFormatter(),column.setTemplate(helper),single}getCellType(){return CellType.Summary}}class GroupSummaryModelGenerator extends ej2_grids_es2015_SummaryModelGenerator{columnSelector(column){return void 0!==column.groupFooterTemplate}getIndentByLevel(level=this.parent.groupSettings.columns.length){return this.parent.groupSettings.columns.map((v,indx)=>indx<=level-1?"":"e-indentcelltop")}getCellType(){return CellType.GroupSummary}}class CaptionSummaryModelGenerator extends ej2_grids_es2015_SummaryModelGenerator{columnSelector(column){return void 0!==column.groupCaptionTemplate}getData(){return[super.getData().reduce((prev,cur)=>(prev.columns=[...prev.columns,...cur.columns],prev),{columns:[]})]}isEmpty(){return 0===(this.getData()[0].columns||[]).length}getCellType(){return CellType.CaptionSummary}}class ej2_grids_es2015_GroupModelGenerator extends ej2_grids_es2015_RowModelGenerator{constructor(parent){super(parent),this.rows=[],this.index=0,this.parent=parent,this.summaryModelGen=new GroupSummaryModelGenerator(parent),this.captionModelGen=new CaptionSummaryModelGenerator(parent)}generateRows(data,args){if(0===this.parent.groupSettings.columns.length)return super.generateRows(data,args);this.rows=[],this.index=this.parent.enableVirtualization?args.startIndex:0;for(let i=0,len=data.length;i<len;i++)this.getGroupedRecords(0,data[i],data.level,i,void 0,this.rows.length);return this.index=0,this.rows}getGroupedRecords(index,data,raw,parentid,childId,tIndex){let level=raw;if(isNullOrUndefined(data.items))if(isNullOrUndefined(data.GroupGuid))this.rows=this.rows.concat(this.generateDataRows(data,index,parentid,this.rows.length));else for(let j=0,len=data.length;j<len;j++)this.getGroupedRecords(index,data[j],data.level,parentid,index,this.rows.length);else if(this.rows=this.rows.concat(this.generateCaptionRow(data,index,parentid,childId,tIndex)),data.items&&data.items.length&&this.getGroupedRecords(index+1,data.items,data.items.level,parentid,index+1,this.rows.length),this.parent.aggregates.length){let rowCnt=this.rows.length;this.rows.push(...this.summaryModelGen.generateRows(data,{level:level}));for(let i=rowCnt-1;i>=0;i--)if(this.rows[i].isCaptionRow)this.rows[i].aggregatesCount=this.rows.length-rowCnt;else if(!this.rows[i].isCaptionRow&&!this.rows[i].isDataRow)break}}getCaptionRowCells(field,indent,data){let cells=[],visibles=[],column=this.parent.getColumnByField(field),indexes=this.parent.getColumnIndexesInView();this.parent.enableColumnVirtualization&&(column=this.parent.columns.filter(c=>c.field===field)[0]);let groupedLen=this.parent.groupSettings.columns.length,gObj=this.parent;if(!this.parent.enableColumnVirtualization||-1!==indexes.indexOf(indent)){for(let i=0;i<indent;i++)cells.push(this.generateIndentCell());cells.push(this.generateCell({},null,CellType.Expand))}if(indent=this.parent.enableColumnVirtualization?1:this.parent.getVisibleColumns().length+groupedLen+(gObj.detailTemplate||gObj.childGrid?1:0)-indent+(this.parent.getVisibleColumns().length?-1:0),this.parent.aggregates.length&&!this.captionModelGen.isEmpty()){let captionCells=this.captionModelGen.generateRows(data)[0];extend(data,captionCells.data);let cIndex=0;captionCells.cells.some((cell,index)=>(cIndex=index,cell.visible&&cell.isDataCell)),visibles=captionCells.cells.slice(cIndex).filter(cell=>cell.visible),captionCells.visible&&visibles[0].column.field===this.parent.getVisibleColumns()[0].field&&(visibles=visibles.slice(1)),1===this.parent.getVisibleColumns().length&&(visibles=[]),indent-=visibles.length}let cols=this.parent.enableColumnVirtualization?this.parent.getColumns():[column],wFlag=!0;return cols.forEach((col,index)=>{let tmpFlag=wFlag&&-1!==indexes.indexOf(indent);tmpFlag&&(wFlag=!1);let cellType=!this.parent.enableColumnVirtualization||tmpFlag?CellType.GroupCaption:CellType.GroupCaptionEmpty;indent=this.parent.enableColumnVirtualization&&cellType===CellType.GroupCaption?indent+groupedLen:indent,gObj.isRowDragable()&&indent++,cells.push(this.generateCell(column,null,cellType,indent))}),cells.push(...visibles),cells}generateCaptionRow(data,indent,parentID,childID,tIndex){let options={},col=this.parent.getColumnByField(data.field);options.data=extend({},data),col&&(options.data.field=data.field),options.isDataRow=!1,options.isExpand=!0,options.parentGid=parentID,options.childGid=childID,options.tIndex=tIndex,options.isCaptionRow=!0,options.gSummary=isNullOrUndefined(data.items.records)?data.items.length:data.items.records.length,options.uid=getUid("grid-row");let row=new ej2_grids_es2015_Row(options);return row.indent=indent,this.getForeignKeyData(row),row.cells=this.getCaptionRowCells(data.field,indent,row.data),row}getForeignKeyData(row){let data=row.data,col=this.parent.getColumnByField(data.field);col&&col.isForeignColumn&&col.isForeignColumn()&&setValue("foreignKey",isNullOrUndefined(data.key)?"":col.valueAccessor(col.foreignKeyValue,getForeignData(col,{},data.key)[0],col),row.data)}generateDataRows(data,indent,childID,tIndex){let rows=[],indexes=this.parent.getColumnIndexesInView();for(let i=0,len=data.length;i<len;i++,tIndex++){rows[i]=this.generateRow(data[i],this.index,i?void 0:"e-firstchildrow",indent,childID,tIndex);for(let j=0;j<indent;j++)this.parent.enableColumnVirtualization&&-1===indexes.indexOf(indent)||rows[i].cells.unshift(this.generateIndentCell());this.index++}return rows}generateIndentCell(){return this.generateCell({},null,CellType.Indent)}refreshRows(input){let indexes=this.parent.getColumnIndexesInView();return input.forEach(row=>{if(row.isDataRow){row.cells=this.generateCells(row);for(let j=0;j<row.indent;j++)this.parent.enableColumnVirtualization&&-1===indexes.indexOf(row.indent)||row.cells.unshift(this.generateIndentCell())}else{let cRow=this.generateCaptionRow(row.data,row.indent);row.cells=cRow.cells}}),input}}class ej2_grids_es2015_ContentRender{constructor(parent,serviceLocator){this.rows=[],this.freezeRows=[],this.movableRows=[],this.freezeRowElements=[],this.isLoaded=!0,this.drop=e=>{this.parent.notify(columnDrop,{target:e.target,droppedElement:e.droppedElement}),ej2_base_es2015_remove(e.droppedElement)},this.rafCallback=args=>{let arg=args;return()=>{if(this.ariaService.setBusy(this.getPanel().firstChild,!1),this.parent.isDestroyed)return;let rows=this.rows.slice(0);if(0!==this.parent.getFrozenColumns()&&(rows=args.isFrozen?this.freezeRows:this.movableRows),this.parent.notify(contentReady,{rows:rows,args:arg}),this.isLoaded&&(this.parent.trigger(dataBound,{}),this.parent.allowTextWrap&&this.parent.notify(freezeRender,{case:"textwrap"}),0===this.parent.getFrozenColumns()||this.parent.allowTextWrap||this.parent.notify(freezeRender,{case:"refreshHeight"})),arg){let action=(arg.requestType||"").toLowerCase()+"-complete";this.parent.notify(action,arg),"batchsave"===args.requestType&&(args.cancel=!1,this.parent.trigger(actionComplete,args))}this.isLoaded&&this.parent.hideSpinner()}},this.parent=parent,this.serviceLocator=serviceLocator,this.ariaService=this.serviceLocator.getService("ariaService"),this.generator=this.getModelGenerator(),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.enableVirtualization||this.parent.on(columnVisibilityChanged,this.setVisible,this),this.parent.on(colGroupRefresh,this.colGroupRefresh,this),this.parent.on(uiUpdate,this.enableAfterRender,this))}renderPanel(){let gObj=this.parent,div=this.parent.createElement("div",{className:"e-gridcontent"}),innerDiv=this.parent.createElement("div",{className:"e-content"});this.ariaService.setOptions(innerDiv,{busy:!1}),div.appendChild(innerDiv),this.setPanel(div),gObj.element.appendChild(div)}renderTable(){let contentDiv=this.getPanel(),virtualTable=contentDiv.querySelector(".e-virtualtable"),virtualTrack=contentDiv.querySelector(".e-virtualtrack");!this.parent.enableVirtualization||isNullOrUndefined(virtualTable)||isNullOrUndefined(virtualTrack)||(ej2_base_es2015_remove(virtualTable),ej2_base_es2015_remove(virtualTrack)),contentDiv.appendChild(this.createContentTable("_content_table")),this.setTable(contentDiv.querySelector(".e-table")),this.ariaService.setOptions(this.getTable(),{multiselectable:"Multiple"===this.parent.selectionSettings.type}),this.initializeContentDrop(),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")}createContentTable(id){let innerDiv=this.getPanel().firstChild;this.getTable()&&ej2_base_es2015_remove(this.getTable());let table=this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"0.25px",role:"grid",id:this.parent.element.id+id}});return this.setColGroup(this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0)),table.appendChild(this.getColGroup()),table.appendChild(this.parent.createElement("tbody")),innerDiv.appendChild(table),innerDiv}splitRows(idx){this.parent.getFrozenColumns()&&(0===idx?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows)}refreshContentRows(args={}){let gObj=this.parent;if(0===gObj.currentViewData.length)return;let tr,hdrTbody,trElement,dataSource=gObj.currentViewData,frag=document.createDocumentFragment(),hdrfrag=document.createDocumentFragment(),columns=gObj.getColumns(),frzCols=gObj.getFrozenColumns(),row=new ej2_grids_es2015_RowRenderer(this.serviceLocator,null,this.parent);this.rowElements=[],this.rows=[];let fCont=this.getPanel().querySelector(".e-frozencontent"),mCont=this.getPanel().querySelector(".e-movablecontent"),cont=this.getPanel().querySelector(".e-content");isGroupAdaptive(gObj)&&["sorting","filtering","searching","grouping","ungrouping","reorder"].some(value=>args.requestType===value)&&(gObj.vcRows=[],gObj.vRows=[]);let modelData=this.generator.generateRows(dataSource,args);isNullOrUndefined(modelData[0].cells[0])&&(mCont.querySelector("tbody").innerHTML="");let idx=modelData[0].cells[0].index;if(this.parent.registeredTemplate&&this.parent.registeredTemplate.template&&!args.isFrozen){let templatetoclear=[];for(let i=0;i<this.parent.registeredTemplate.template.length;i++)for(let j=0;j<this.parent.registeredTemplate.template[i].rootNodes.length;j++)isNullOrUndefined(this.parent.registeredTemplate.template[i].rootNodes[j].parentNode)&&templatetoclear.push(this.parent.registeredTemplate.template[i]);this.parent.destroyTemplate(["template"],templatetoclear)}this.parent.enableColumnVirtualization&&new ej2_grids_es2015_CellMergeRender(this.serviceLocator,this.parent).updateVirtualCells(modelData),this.tbody=frzCols&&idx>=frzCols?mCont.querySelector("tbody"):this.getTable().querySelector("tbody");let startIndex=0,blockLoad=!0;if(isGroupAdaptive(gObj)&&gObj.vcRows.length){let top="top",scrollTop=isNullOrUndefined(args.virtualInfo.offsets)?isNullOrUndefined(args.scrollTop)?0:args.scrollTop[top]:args.virtualInfo.offsets.top;if(0!==scrollTop){let offsets=gObj.vGroupOffsets,bSize=gObj.pageSettings.pageSize/2,values=Object.keys(offsets).map(key=>offsets[key]);for(let m=0;m<values.length;m++)if(scrollTop<values[m]){if(isNullOrUndefined(args.virtualInfo)||"up"!==args.virtualInfo.direction){args.virtualInfo.blockIndexes=0===m||1===m?[1,2]:[m,m+1],startIndex=0===m||1===m?0:m*bSize;break}args.virtualInfo.blockIndexes=0===m||1===m?[1,2]:[m,m+1],startIndex=0===m||1===m?0:m*bSize;break}scrollTop+this.contentPanel.firstElementChild.offsetHeight!==this.contentPanel.firstElementChild.scrollHeight||args.rowObject||(blockLoad=!1)}}for(let i=startIndex,len=modelData.length;i<len&&(this.rows.push(modelData[i]),!(isGroupAdaptive(gObj)&&this.rows.length>=gObj.pageSettings.pageSize&&blockLoad));i++){if(gObj.rowTemplate){let rowTemplateID=gObj.element.id+"rowTemplate",elements=gObj.getRowTemplate()(extend({index:i},dataSource[i]),gObj,"rowTemplate",rowTemplateID);if("TBODY"===elements[0].tagName){for(let j=0;j<elements.length;j++){let isTR="tr"===elements[j].nodeName.toLowerCase();(isTR||elements[j].querySelectorAll&&elements[j].querySelectorAll("tr").length)&&(tr=isTR?elements[j]:elements[j].querySelector("tr"))}gObj.frozenRows&&i<gObj.frozenRows?hdrfrag.appendChild(tr):frag.appendChild(tr)}else gObj.frozenRows&&i<gObj.frozenRows?tr=appendChildren(hdrfrag,elements):trElement=(tr=appendChildren(frag,elements)).lastElementChild;this.parent.trigger(rowDataBound,{data:modelData[i].data,row:trElement||tr})}else tr=row.render(modelData[i],columns),gObj.frozenRows&&i<gObj.frozenRows?hdrfrag.appendChild(tr):frag.appendChild(tr),modelData[i].isExpand&&gObj.notify(expandChildGrid,tr.cells[gObj.groupSettings.columns.length]);modelData[i].isDataRow&&this.rowElements.push(tr),this.ariaService.setOptions(this.getTable(),{colcount:gObj.getColumns().length.toString()})}this.splitRows(idx),gObj.frozenRows&&((hdrTbody=frzCols?gObj.getHeaderContent().querySelector(0===idx?".e-frozenheader":".e-movableheader").querySelector("tbody"):gObj.getHeaderTable().querySelector("tbody")).innerHTML="",hdrTbody.appendChild(hdrfrag)),gObj.frozenRows&&0===idx&&cont.offsetHeight===Number(gObj.height)&&(cont.style.height=cont.offsetHeight-hdrTbody.offsetHeight+"px"),frzCols&&0===idx&&(this.getPanel().firstChild.style.overflowY="hidden"),isBlazor()&&!this.parent.isJsComponent||(args.rows=this.rows.slice(0)),args.isFrozen=0!==this.parent.getFrozenColumns()&&!args.isFrozen,this.index=idx,getUpdateUsingRaf(()=>{this.parent.notify(beforeFragAppend,args),this.parent.enableVirtualization||(ej2_base_es2015_remove(this.tbody),this.tbody=this.parent.createElement("tbody")),frzCols?(this.tbody.appendChild(frag),0===this.index?(this.isLoaded=!1,fCont.querySelector("table").appendChild(this.tbody)):(this.tbody.childElementCount<1&&this.tbody.appendChild(this.parent.createElement("tr").appendChild(this.parent.createElement("td"))),this.isLoaded=!0,mCont.querySelector("table").appendChild(this.tbody),fCont.style.height=mCont.offsetHeight-getScrollBarWidth()+"px",mCont.style.overflowY="auto"!==this.parent.height?"scroll":"auto",fCont.style.borderRightWidth="1px")):(gObj.rowTemplate&&updateBlazorTemplate(gObj.element.id+"rowTemplate","RowTemplate",gObj),this.appendContent(this.tbody,frag,args)),frzCols&&0===idx&&this.refreshContentRows(extend({},args)),frag=null},this.rafCallback(extend({},args)))}appendContent(tbody,frag,args){tbody.appendChild(frag),this.getTable().appendChild(tbody)}getPanel(){return this.contentPanel}setPanel(panel){this.contentPanel=panel}getTable(){return this.contentTable}setTable(table){this.contentTable=table}getRows(){return this.parent.getFrozenColumns()?this.freezeRows:this.rows}getMovableRows(){return this.movableRows}getRowElements(){return this.parent.getFrozenColumns()?this.freezeRowElements:this.rowElements}getMovableRowElements(){return this.rowElements}setRowElements(elements){this.rowElements=elements}getColGroup(){return this.colgroup}setColGroup(colGroup){return isNullOrUndefined(colGroup)||(colGroup.id="content-"+colGroup.id),this.colgroup=colGroup}setVisible(columns){let testRow,gObj=this.parent,frzCols=gObj.getFrozenColumns(),rows=[];if(frzCols){let cellLen,fRows=this.freezeRows,mRows=this.movableRows,rowLen=fRows.length;for(let row,i=0;i<rowLen;i++){cellLen=mRows[i].cells.length,row=fRows[i].clone();for(let j=0;j<cellLen;j++)row.cells.push(mRows[i].cells[j]);rows.push(row)}}else rows=this.getRows();rows.some(r=>(r.isDataRow&&(testRow=r),r.isDataRow));let needFullRefresh=!0;!gObj.groupSettings.columns.length&&testRow&&(needFullRefresh=!1);let tr=gObj.getDataRows(),contentrows=this.rows.filter(row=>!row.isDetailRow);for(let c=0,clen=columns.length;c<clen;c++){let column=columns[c],idx=this.parent.getNormalizedColumnIndex(column.uid),displayVal=!0===column.visible?"":"none";-1!==idx&&testRow&&idx<testRow.cells.length&&(frzCols?idx<frzCols?(setStyleAttribute(this.getColGroup().childNodes[idx],{display:displayVal}),contentrows=this.freezeRows):(setStyleAttribute(gObj.getContent().querySelector(".e-movablecontent").querySelector("colgroup").childNodes[idx-=frzCols],{display:displayVal}),tr=gObj.getMovableDataRows(),contentrows=this.movableRows):(gObj.isRowDragable()&&idx++,setStyleAttribute(this.getColGroup().childNodes[idx],{display:displayVal}),gObj.isRowDragable()&&idx--)),idx=gObj.isDetail()?idx-1:idx,needFullRefresh||this.setDisplayNone(tr,idx,displayVal,contentrows),!this.parent.invokedFromMedia&&column.hideAtMedia&&this.parent.updateMediaColumns(column),this.parent.invokedFromMedia=!1}needFullRefresh?this.refreshContentRows({requestType:"refresh"}):this.parent.getFrozenColumns()?(this.parent.notify(partialRefresh,{rows:this.freezeRows,args:{isFrozen:!0,rows:this.freezeRows}}),this.parent.notify(partialRefresh,{rows:this.movableRows,args:{isFrozen:!1,rows:this.movableRows}})):this.parent.notify(partialRefresh,{rows:contentrows,args:{}})}setDisplayNone(tr,idx,displayVal,rows){Object.keys(tr).forEach(i=>{tr[i].querySelectorAll("td.e-rowcell").length&&(setStyleAttribute(tr[i].querySelectorAll("td.e-rowcell")[idx],{display:displayVal}),tr[i].querySelectorAll("td.e-rowcell")[idx].classList.contains("e-hide")&&removeClass([tr[i].querySelectorAll("td.e-rowcell")[idx]],["e-hide"]),rows[i].cells[idx].visible=""===displayVal)})}colGroupRefresh(){if(this.getColGroup()){let colGroup=this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0);this.getTable().replaceChild(colGroup,this.getColGroup()),this.setColGroup(colGroup)}}initializeContentDrop(){new ej2_base_es2015_Droppable(this.parent.getContent(),{accept:".e-dragclone",drop:this.drop})}canSkip(column,row,index){return isNullOrUndefined(row)||isNullOrUndefined(column.visible)||row.cells[index].visible===column.visible}getModelGenerator(){return this.generator=this.parent.allowGrouping?new ej2_grids_es2015_GroupModelGenerator(this.parent):new ej2_grids_es2015_RowModelGenerator(this.parent)}renderEmpty(tbody){this.getTable().appendChild(tbody),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector("tbody").innerHTML="")}setSelection(uid,set,clearAll){this.parent.getFrozenColumns()&&this.getMovableRows().filter(row=>clearAll||uid===row.uid).forEach(row=>row.isSelected=set),this.getRows().filter(row=>clearAll||uid===row.uid).forEach(row=>{row.isSelected=set,row.cells.forEach(cell=>cell.isSelected=set)})}getRowByIndex(index){return this.parent.getDataRows()[index]}getVirtualRowIndex(index){return index}getMovableRowByIndex(index){return this.parent.getMovableDataRows()[index]}enableAfterRender(e){"group"===e.module&&e.enable&&(this.generator=this.getModelGenerator())}setRowObjects(rows){this.rows=rows}}class ej2_grids_es2015_HeaderRender{constructor(parent,serviceLocator){this.frzIdx=0,this.notfrzIdx=0,this.helper=e=>{let gObj=this.parent,target=e.sender.target,parentEle=parentsUntil(target,"e-headercell");if(!gObj.allowReordering&&!gObj.allowGrouping||!isNullOrUndefined(parentEle)&&parentEle.querySelectorAll(".e-checkselectall").length>0)return!1;let visualElement=this.parent.createElement("div",{className:"e-cloneproperties e-dragclone e-headerclone"}),element=target.classList.contains("e-headercell")?target:parentEle;if(!element||!gObj.allowReordering&&element.classList.contains("e-stackedheadercell"))return!1;let col,height=element.offsetHeight,headercelldiv=element.querySelector(".e-headercelldiv")||element.querySelector(".e-stackedheadercelldiv");if(headercelldiv){if(col=element.querySelector(".e-stackedheadercelldiv")?gObj.getStackedHeaderColumnByHeaderText(headercelldiv.innerText.trim(),gObj.columns):gObj.getColumnByUid(headercelldiv.getAttribute("e-mappinguid")),this.column=col,this.column.lockColumn)return!1;visualElement.setAttribute("e-mappinguid",this.column.uid)}if(col&&!isNullOrUndefined(col.headerTemplate))if(isNullOrUndefined(col.headerTemplate))visualElement.innerHTML=col.headerTemplate;else{let result,colIndex=gObj.getColumnIndexByField(col.field);appendChildren(visualElement,result=col.getHeaderTemplate()(extend({index:colIndex},col),gObj,"headerTemplate"))}else visualElement.innerHTML=headercelldiv?col.headerText:element.firstElementChild.innerHTML;return visualElement.style.width=element.offsetWidth+"px",visualElement.style.height=element.offsetHeight+"px",visualElement.style.lineHeight=(height-6).toString()+"px",gObj.element.appendChild(visualElement),visualElement},this.dragStart=e=>{let gObj=this.parent;gObj.element.querySelector(".e-gridpopup").style.display="none",gObj.notify(columnDragStart,{target:e.target,column:this.column,event:e.event})},this.drag=e=>{let gObj=this.parent,target=e.target;if(target){let closest$$1=closest(target,".e-grid"),cloneElement=this.parent.element.querySelector(".e-cloneproperties");if(!closest$$1||closest$$1.getAttribute("id")!==gObj.element.getAttribute("id"))return ej2_base_es2015_classList(cloneElement,["e-notallowedcur"],["e-defaultcur"]),void(gObj.allowReordering&&(gObj.element.querySelector(".e-reorderuparrow").style.display="none",gObj.element.querySelector(".e-reorderdownarrow").style.display="none"));gObj.notify(columnDrag,{target:e.target,column:this.column,event:e.event})}},this.dragStop=e=>{let cancel,gObj=this.parent;gObj.element.querySelector(".e-gridpopup").style.display="none",(!parentsUntil(e.target,"e-headercell")&&!parentsUntil(e.target,"e-groupdroparea")||!gObj.allowReordering&&parentsUntil(e.target,"e-headercell")||!e.helper.getAttribute("e-mappinguid")&&parentsUntil(e.target,"e-groupdroparea"))&&(ej2_base_es2015_remove(e.helper),cancel=!0),gObj.notify(columnDragStop,{target:e.target,event:e.event,column:this.column,cancel:cancel})},this.drop=e=>{let gObj=this.parent,uid=e.droppedElement.getAttribute("e-mappinguid"),closest$$1=closest(e.target,".e-grid");ej2_base_es2015_remove(e.droppedElement),closest$$1&&closest$$1.getAttribute("id")!==gObj.element.getAttribute("id")||!gObj.allowReordering&&!gObj.allowGrouping||gObj.notify(headerDrop,{target:e.target,uid:uid})},this.parent=parent,this.serviceLocator=serviceLocator,this.ariaService=this.serviceLocator.getService("ariaService"),this.widthService=this.serviceLocator.getService("widthService"),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.on(columnVisibilityChanged,this.setVisible,this),this.parent.on(columnPositionChanged,this.colPosRefresh,this))}renderPanel(){let div=this.parent.createElement("div",{className:"e-gridheader"}),innerDiv=this.parent.createElement("div",{className:"e-headercontent"});this.toggleStackClass(div),div.appendChild(innerDiv),this.setPanel(div),this.parent.element.appendChild(div)}renderTable(){let headerDiv=this.getPanel();headerDiv.appendChild(this.createHeaderTable()),this.setTable(headerDiv.querySelector(".e-table")),this.parent.getFrozenColumns()||(this.initializeHeaderDrag(),this.initializeHeaderDrop()),this.parent.notify(headerRefreshed,{rows:this.rows,args:{isFrozen:0!==this.parent.getFrozenColumns()}})}getPanel(){return this.headerPanel}setPanel(panel){this.headerPanel=panel}getTable(){return this.headerTable}setTable(table){this.headerTable=table}getColGroup(){return this.colgroup}setColGroup(colGroup){return this.colgroup=colGroup}getRows(){return this.getTable().tHead.rows}createHeaderTable(){let table=this.createTable(),innerDiv=this.getPanel().firstChild;return innerDiv.appendChild(table),innerDiv}createTable(){let gObj=this.parent;this.getTable()&&!gObj.getFrozenColumns()&&ej2_base_es2015_remove(this.getTable()),gObj.getColumns();let table=this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"0.25px",role:"grid"}}),findHeaderRow=(this.getPanel(),this.createHeaderContent()),thead=findHeaderRow.thead,tbody=this.parent.createElement("tbody",{className:this.parent.frozenRows?"":"e-hide"});this.caption=this.parent.createElement("caption",{innerHTML:this.parent.element.id+"_header_table",className:"e-hide"});let bodyCell,colGroup=this.parent.createElement("colgroup"),rowBody=this.parent.createElement("tr"),rows=this.rows=findHeaderRow.rows;new ej2_grids_es2015_RowRenderer(this.serviceLocator,CellType.Header,this.parent);for(let i=0,len=rows.length;i<len;i++)for(let j=0,len=rows[i].cells.length;j<len;j++)bodyCell=this.parent.createElement("td"),rowBody.appendChild(bodyCell);return(gObj.allowFiltering||gObj.allowSorting||gObj.allowGrouping)&&table.classList.add("e-sortfilter"),this.updateColGroup(colGroup),tbody.appendChild(rowBody),table.appendChild(this.setColGroup(colGroup)),table.appendChild(thead),table.appendChild(tbody),table.appendChild(this.caption),this.ariaService.setOptions(table,{colcount:gObj.getColumns().length.toString()}),table}createHeaderContent(){let gObj=this.parent,columns=gObj.getColumns(),thead=this.parent.createElement("thead"),colHeader=this.parent.createElement("tr",{className:"e-columnheader"}),rowRenderer=new ej2_grids_es2015_RowRenderer(this.serviceLocator,CellType.Header,gObj);rowRenderer.element=colHeader;let headerRow,rows=[];this.colDepth=measureColumnDepth(gObj.columns);for(let i=0,len=this.colDepth;i<len;i++)rows[i]=this.generateRow(i),rows[i].cells=[];rows=this.ensureColumns(rows),rows=this.getHeaderCells(rows);for(let i=0,len=this.colDepth;i<len;i++)headerRow=rowRenderer.render(rows[i],columns),this.parent.rowHeight&&headerRow.querySelector(".e-headercell")&&(headerRow.style.height=this.parent.rowHeight+"px"),thead.appendChild(headerRow);return{thead:thead,rows:rows}}updateColGroup(colGroup){let col,cols=this.parent.getColumns(),indexes=this.parent.getColumnIndexesInView();if(colGroup.id=this.parent.element.id+"colGroup",this.parent.allowGrouping)for(let i=0,len=this.parent.groupSettings.columns.length;i<len;i++)this.parent.enableColumnVirtualization&&-1===indexes.indexOf(i)||(col=this.parent.createElement("col",{className:"e-group-intent"}),colGroup.appendChild(col));(this.parent.detailTemplate||this.parent.childGrid)&&(col=this.parent.createElement("col",{className:"e-detail-intent"}),colGroup.appendChild(col)),this.parent.isRowDragable()&&(col=this.parent.createElement("col",{className:"e-drag-intent"}),colGroup.appendChild(col));for(let i=0,len=cols.length;i<len;i++)col=this.parent.createElement("col"),!1===cols[i].visible&&setStyleAttribute(col,{display:"none"}),colGroup.appendChild(col);return colGroup}ensureColumns(rows){let gObj=this.parent,indexes=this.parent.getColumnIndexesInView();for(let i=0,len=rows.length;i<len;i++){if(gObj.allowGrouping)for(let c=0,len=gObj.groupSettings.columns.length;c<len;c++)this.parent.enableColumnVirtualization&&-1===indexes.indexOf(c)||rows[i].cells.push(this.generateCell({},CellType.HeaderIndent));(gObj.detailTemplate||gObj.childGrid)&&rows[i].cells.push(this.generateCell({},CellType.DetailHeader)),gObj.isRowDragable()&&rows[i].cells.push(this.generateCell({},CellType.RowDragHIcon))}return rows}getHeaderCells(rows){let thead=this.parent.getHeaderTable()&&this.parent.getHeaderTable().querySelector("thead"),cols=this.parent.enableColumnVirtualization?this.parent.getColumns(this.parent.enablePersistence):this.parent.columns;if(this.frzIdx=0,this.notfrzIdx=0,this.parent.lockcolPositionCount)for(let i=0;i<cols.length;i++)this.lockColsRendered=!1,rows=this.appendCells(cols[i],rows,0,0===i,!1,i===cols.length-1,thead);for(let i=0,len=cols.length;i<len;i++)this.notfrzIdx=0,this.lockColsRendered=!0,rows=this.appendCells(cols[i],rows,0,0===i,!1,i===len-1,thead);return rows}appendCells(cols,rows,index,isFirstObj,isFirstCol,isLastCol,isMovable){let lastCol=isLastCol?"e-lastcell":"",frzCols=this.parent.getFrozenColumns();if(cols.columns){let colSpan=this.getCellCnt(cols,0);if(colSpan){let frzObj=this.refreshFrozenHdr(cols.columns,{isPartial:!1,isComp:!0,cnt:0}),stackedLockColsCount=this.getStackedLockColsCount(cols,0);(!frzCols&&(!this.parent.lockcolPositionCount||!this.lockColsRendered&&stackedLockColsCount||this.lockColsRendered&&colSpan-stackedLockColsCount)||frzCols&&(!isMovable&&(this.parent.frozenColumns-this.frzIdx>0||frzObj.isPartial)||isMovable&&colSpan+this.frzIdx>this.parent.frozenColumns&&!frzObj.isComp))&&rows[index].cells.push(new ej2_grids_es2015_Cell({cellType:CellType.StackedHeader,column:cols,colSpan:this.getColSpan(colSpan,isMovable,frzObj.cnt,stackedLockColsCount)}))}if(this.parent.lockcolPositionCount&&!this.lockColsRendered)for(let i=0;i<cols.columns.length;i++)rows=this.appendCells(cols.columns[i],rows,index+1,isFirstObj,0===i,i===cols.columns.length-1&&isLastCol,isMovable);if(this.lockColsRendered)for(let i=0,len=cols.columns.length;i<len;i++)rows=this.appendCells(cols.columns[i],rows,index+1,isFirstObj,0===i,i===len-1&&isLastCol,isMovable)}else(!frzCols&&(!this.parent.lockcolPositionCount||cols.lockColumn&&!this.lockColsRendered||!cols.lockColumn&&this.lockColsRendered)||frzCols&&(!isMovable&&(this.frzIdx+this.notfrzIdx<this.parent.frozenColumns||cols.isFrozen)&&(!this.parent.lockcolPositionCount||cols.lockColumn&&!this.lockColsRendered||!cols.lockColumn&&this.lockColsRendered)||isMovable&&this.frzIdx+this.notfrzIdx>=this.parent.frozenColumns&&!cols.isFrozen&&(!this.parent.lockcolPositionCount||cols.lockColumn&&!this.lockColsRendered||!cols.lockColumn&&this.lockColsRendered)))&&rows[index].cells.push(this.generateCell(cols,CellType.Header,this.colDepth-index,(isFirstObj?"":isFirstCol?"e-firstcell":"")+lastCol,index,this.parent.getColumnIndexByUid(cols.uid))),this.parent.lockcolPositionCount?this.frzIdx+this.notfrzIdx<this.parent.frozenColumns&&(cols.lockColumn&&!this.lockColsRendered||!cols.lockColumn&&this.lockColsRendered)?this.frzIdx++:this.notfrzIdx++:this.frzIdx++;return rows}getStackedLockColsCount(col,lockColsCount){if(col.columns)for(let i=0;i<col.columns.length;i++)lockColsCount=this.getStackedLockColsCount(col.columns[i],lockColsCount);else col.lockColumn&&lockColsCount++;return lockColsCount}refreshFrozenHdr(cols,frzObj){for(let i=0;i<cols.length;i++)cols[i].columns?frzObj=this.refreshFrozenHdr(cols[i].columns,frzObj):(cols[i].isFrozen&&(frzObj.isPartial=!0,frzObj.cnt++),frzObj.isComp=frzObj.isComp&&(cols[i].isFrozen||this.parent.getColumnIndexByField(cols[i].field)<this.parent.frozenColumns));return frzObj}getColSpan(colSpan,isMovable,frozenCnt,stackedLockColsCount){let frzCol=this.parent.frozenColumns;return this.parent.getFrozenColumns()&&this.frzIdx+colSpan>frzCol?isMovable?colSpan=colSpan-(frzCol>this.frzIdx?frzCol-this.frzIdx:0)-frozenCnt:colSpan-=colSpan-(frzCol>this.frzIdx?frzCol+frozenCnt-this.frzIdx:frozenCnt):this.parent.lockcolPositionCount&&(colSpan=this.lockColsRendered?colSpan-stackedLockColsCount:stackedLockColsCount),colSpan}generateRow(index){return new ej2_grids_es2015_Row({})}generateCell(column,cellType,rowSpan,className,rowIndex,colIndex){let opt={visible:column.visible,isDataCell:!1,isTemplate:!isNullOrUndefined(column.headerTemplate),rowID:"",column:column,cellType:cellType,rowSpan:rowSpan,className:className,index:rowIndex,colIndex:colIndex};return(!opt.rowSpan||opt.rowSpan<2)&&delete opt.rowSpan,new ej2_grids_es2015_Cell(opt)}setVisible(columns){let displayVal,idx,gObj=this.parent,frzCols=([].slice.call(this.getRows()),gObj.getFrozenColumns());for(let c=0,clen=columns.length;c<clen;c++){let column=columns[c];idx=gObj.getNormalizedColumnIndex(column.uid),displayVal=column.visible?"":"none",frzCols?setStyleAttribute(idx<frzCols?this.getColGroup().children[idx]:gObj.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").children[idx-frzCols],{display:displayVal}):(gObj.isRowDragable()&&idx++,setStyleAttribute(this.getColGroup().children[idx],{display:displayVal})),this.refreshUI()}}colPosRefresh(){this.refreshUI()}refreshUI(){let headerDiv=this.getPanel();this.toggleStackClass(headerDiv);let table=this.getTable(),frzCols=this.parent.getFrozenColumns();if(this.getTable()){ej2_base_es2015_remove(this.getTable()),table.removeChild(table.firstChild),table.removeChild(table.childNodes[0]);let colGroup=this.parent.createElement("colgroup"),findHeaderRow=this.createHeaderContent();this.rows=findHeaderRow.rows,table.insertBefore(findHeaderRow.thead,table.firstChild),this.updateColGroup(colGroup),table.insertBefore(this.setColGroup(colGroup),table.firstChild),this.setTable(table),this.appendContent(table),this.parent.notify(colGroupRefresh,{}),this.widthService.setWidthToColumns(),this.parent.updateDefaultCursor(),frzCols||this.initializeHeaderDrag();let rows=[].slice.call(headerDiv.querySelectorAll("tr.e-columnheader"));for(let row of rows){let gCells=[].slice.call(row.querySelectorAll(".e-grouptopleftcell"));gCells.length&&gCells[gCells.length-1].classList.add("e-lastgrouptopleftcell")}frzCols||this.parent.notify(headerRefreshed,{rows:this.rows,args:{isFrozen:0!==this.parent.getFrozenColumns()}}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&ej2_grids_es2015_wrap(rows,!0)}}toggleStackClass(div){this.parent.columns.some(column=>!isNullOrUndefined(column.columns))?div.classList.add("e-stackedheader"):div.classList.remove("e-stackedheader")}appendContent(table){this.getPanel().firstChild.appendChild(table)}getCellCnt(col,cnt){if(col.columns)for(let i=0,len=col.columns.length;i<len;i++)cnt=this.getCellCnt(col.columns[i],cnt);else col.visible&&cnt++;return cnt}initializeHeaderDrag(){if(!(this.parent.allowReordering||this.parent.allowGrouping&&this.parent.groupSettings.showDropArea))return;let headerRows=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-columnheader"));for(let i=0,len=headerRows.length;i<len;i++)new ej2_base_es2015_Draggable(headerRows[i],{dragTarget:".e-headercell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,abort:".e-rhandler"})}initializeHeaderDrop(){new ej2_base_es2015_Droppable(this.parent.getHeaderContent(),{accept:".e-dragclone",drop:this.drop})}}class ej2_grids_es2015_CellRenderer{constructor(parent,locator){this.localizer=locator.getService("localization"),this.formatter=locator.getService("valueFormatter"),this.parent=parent,this.element=this.parent.createElement("TD",{className:"e-rowcell",attrs:{role:"gridcell",tabindex:"-1"}}),this.rowChkBox=this.parent.createElement("input",{className:"e-checkselect",attrs:{type:"checkbox"}})}getGui(){return""}format(column,value,data){return isNullOrUndefined(column.format)||(value=this.formatter.toView(value,column.getFormatter())),isNullOrUndefined(value)?"":value.toString()}evaluate(node,cell,data,attributes$$1,fData,isEdit){let result;if(cell.column.template){let literals=["index"],dummyData=extendObjWithFn({},data,{[ej2_grids_es2015_foreignKeyData]:fData,column:cell.column}),templateID=this.parent.element.id+cell.column.uid,str="isStringTemplate",index="index";if(isBlazor()&&isEdit){let rNumber="Batch"!==this.parent.editSettings.mode?parseInt(attributes$$1[index],10):null;result=cell.column.getColumnTemplate()(extend({index:attributes$$1[literals[0]]},dummyData),this.parent,"template",templateID,this.parent[str],rNumber),window[templateID]=null,"Batch"!==this.parent.editSettings.mode&&updateBlazorTemplate(templateID,"Template",cell.column,!1)}else result=cell.column.getColumnTemplate()(extend({index:attributes$$1[literals[0]]},dummyData),this.parent,"template",templateID,this.parent[str]);return appendChildren(node,result),this.parent.notify("template-result",{template:result}),result=null,node.setAttribute("aria-label",node.innerText+" is template cell column header "+cell.column.headerText),!1}return!0}invokeFormatter(column,value,data){var target;return isNullOrUndefined(column.formatter)||(value=(target=column.formatter).prototype&&"getValue"in target.prototype?(new(0,column.formatter)).getValue(column,data):"function"==typeof column.formatter?column.formatter(column,data):column.formatter.getValue(column,data)),value}render(cell,data,attributes$$1,isExpand,isEdit){return this.refreshCell(cell,data,attributes$$1,isEdit)}refreshTD(td,cell,data,attributes$$1){let isEdit="Batch"===this.parent.editSettings.mode&&td.classList.contains("e-editedbatchcell"),node=this.refreshCell(cell,data,attributes$$1,isEdit);td.innerHTML="",td.setAttribute("aria-label",node.getAttribute("aria-label"));let elements=[].slice.call(node.childNodes);for(let elem of elements)td.appendChild(elem)}refreshCell(cell,data,attributes$$1,isEdit){let fData,node=this.element.cloneNode(),column=cell.column;cell.isForeignKey&&(fData=cell.foreignKeyData[0]||{[column.foreignKeyValue]:column.format?null:""});let innerHtml=this.getGui(),value=cell.isForeignKey?this.getValue(column.foreignKeyValue,fData,column):this.getValue(column.field,data,column);if("date"!==column.type&&"datetime"!==column.type||isNullOrUndefined(value)||(value=new Date(value)),innerHtml=(value=this.format(column,value,data)).toString(),"boolean"===column.type&&!column.displayAsCheckBox){let localeStr="true"!==value&&"false"!==value?null:"true"===value?"True":"False";innerHtml=localeStr?this.localizer.getConstant(localeStr):innerHtml}let fromFormatter=this.invokeFormatter(column,value,data);if(innerHtml=isNullOrUndefined(column.formatter)?innerHtml:isNullOrUndefined(fromFormatter)?"":fromFormatter.toString(),node.setAttribute("aria-label",(""===innerHtml?"empty":innerHtml)+" column header "+cell.column.headerText),isNullOrUndefined(cell.column.headerText)||node.setAttribute("aria-label",innerHtml+" column header "+cell.column.headerText),this.evaluate(node,cell,data,attributes$$1,fData,isEdit)&&"checkbox"!==column.type)this.appendHtml(node,innerHtml,column.getDomSetter?column.getDomSetter():"innerHTML");else if("checkbox"===column.type){node.classList.add("e-gridchkbox"),node.setAttribute("aria-label","checkbox");let checkWrap=createCheckBox(this.parent.createElement,!1,{checked:value=!!this.parent.selectionSettings.persistSelection&&"true"===value,label:" "});checkWrap.insertBefore(this.rowChkBox.cloneNode(),checkWrap.firstChild),node.appendChild(checkWrap)}if("Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(cell.isSelected=!0),this.setAttributes(node,cell,attributes$$1),"boolean"===column.type&&column.displayAsCheckBox){let checked=isNaN(parseInt(value.toString(),10))?"true"===value:parseInt(value.toString(),10)>0,checkWrap=createCheckBox(this.parent.createElement,!1,{checked:checked,label:" "});node.innerHTML="",checkWrap.classList.add("e-checkbox-disabled"),node.appendChild(checkWrap),node.setAttribute("aria-label",checked+" column header "+cell.column.headerText)}return node}appendHtml(node,innerHtml,property="innerHTML"){return node[property]=innerHtml,node}setAttributes(node,cell,attributes$$1){let column=cell.column;this.buildAttributeFromCell(node,cell,"checkbox"===column.type),setStyleAndAttributes(node,attributes$$1),setStyleAndAttributes(node,cell.attributes),column.customAttributes&&setStyleAndAttributes(node,column.customAttributes),column.textAlign&&(node.style.textAlign=column.textAlign),"Clip"===column.clipMode?node.classList.add("e-gridclip"):"EllipsisWithTooltip"===column.clipMode&&node.classList.add("e-ellipsistooltip")}buildAttributeFromCell(node,cell,isCheckBoxType){let attr={},classes=[];cell.colSpan&&(attr.colSpan=cell.colSpan),cell.rowSpan&&(attr.rowSpan=cell.rowSpan),cell.isTemplate&&classes.push("e-templatecell"),cell.isSelected&&(classes.push("e-selectionbackground","e-active"),isCheckBoxType&&node.querySelector(".e-frame").classList.add("e-check")),isNullOrUndefined(cell.index)||(attr["aria-colindex"]=cell.index),cell.visible||classes.push("e-hide"),attr.class=classes,setStyleAndAttributes(node,attr)}getValue(field,data,column){return column.valueAccessor(field,data,column)}}class AriaService{setOptions(target,options){Object.keys(options).forEach(name=>setStateAndProperties(target,ej2_grids_es2015_config[name],options[name]))}setExpand(target,expand){setStateAndProperties(target,ej2_grids_es2015_config.expand,expand)}setSort(target,direction){setStateAndProperties(target,ej2_grids_es2015_config.sort,direction,"boolean"==typeof direction)}setBusy(target,isBusy){setStateAndProperties(target,ej2_grids_es2015_config.busy,isBusy),setStateAndProperties(target,ej2_grids_es2015_config.invalid,null,!0)}setGrabbed(target,isGrabbed,remove$$1){setStateAndProperties(target,ej2_grids_es2015_config.grabbed,isGrabbed,remove$$1)}setDropTarget(target,isTarget){setStateAndProperties(target,ej2_grids_es2015_config.dropeffect,"copy",!isTarget)}}function setStateAndProperties(target,attribute,value,remove$$1){remove$$1&&target?target.removeAttribute(attribute):target&&target.setAttribute(attribute,value)}const ej2_grids_es2015_config={expand:"aria-expanded",role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",sort:"aria-sort",busy:"aria-busy",invalid:"aria-invalid",grabbed:"aria-grabbed",dropeffect:"aria-dropeffect",haspopup:"aria-haspopup",level:"aria-level",colcount:"aria-colcount"};class ej2_grids_es2015_HeaderCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-headercell",attrs:{role:"columnheader",tabindex:"-1"}}),this.ariaService=new AriaService,this.hTxtEle=this.parent.createElement("span",{className:"e-headertext"}),this.sortEle=this.parent.createElement("div",{className:"e-sortfilterdiv e-icons"}),this.gui=this.parent.createElement("div"),this.chkAllBox=this.parent.createElement("input",{className:"e-checkselectall",attrs:{type:"checkbox"}})}getGui(){return this.gui.cloneNode()}render(cell,data,attributes$$1){let node=this.element.cloneNode(),fltrMenuEle=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(cell,node,fltrMenuEle)}refresh(cell,node){this.clean(node);let fltrMenuEle=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(cell,node,fltrMenuEle)}clean(node){node.innerHTML=""}prepareHeader(cell,node,fltrMenuEle){let result,column=cell.column,ariaAttr={},innerDIV=this.getGui();if(attributes(innerDIV,{"e-mappinguid":column.uid,class:"e-headercelldiv"}),"checkbox"!==column.type){let value=column.headerText,headerText=this.hTxtEle.cloneNode();headerText[column.getDomSetter()]=value,innerDIV.appendChild(headerText)}else{column.editType="booleanedit";let checkAllWrap=createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "});checkAllWrap.insertBefore(this.chkAllBox.cloneNode(),checkAllWrap.firstChild),innerDIV.appendChild(checkAllWrap),innerDIV.classList.add("e-headerchkcelldiv")}if(this.buildAttributeFromCell(node,cell),this.appendHtml(node,innerDIV),node.appendChild(this.sortEle.cloneNode()),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&column.allowFiltering&&!isNullOrUndefined(column.field)&&(!this.parent.showColumnMenu||!column.showColumnMenu)){attributes(fltrMenuEle,{"e-mappinguid":"e-flmenu-"+column.uid}),node.classList.add("e-fltr-icon");let matchFlColumns=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==matchFlColumns.length)for(let index=0;index<this.parent.columns.length;index++)for(let count=0;count<this.parent.filterSettings.columns.length;count++)if(this.parent.filterSettings.columns[count].field===column.field){fltrMenuEle.classList.add("e-filtered"),matchFlColumns.push(column.field);break}node.appendChild(fltrMenuEle.cloneNode())}cell.className&&node.classList.add(cell.className),column.customAttributes&&setStyleAndAttributes(node,column.customAttributes),column.allowSorting&&(ariaAttr.sort="none"),column.allowGrouping&&(ariaAttr.grabbed=!1),node=this.extendPrepareHeader(column,node);let gridObj=this.parent,colIndex=gridObj.getColumnIndexByField(column.field);if(!isNullOrUndefined(column.headerTemplate)){let headerTempID=gridObj.element.id+column.uid+"headerTemplate",str="isStringTemplate";result=column.getHeaderTemplate()(extend({index:colIndex},column),gridObj,"headerTemplate",headerTempID,this.parent[str]),node.firstElementChild.innerHTML="",appendChildren(node.firstElementChild,result)}if(this.ariaService.setOptions(node,ariaAttr),!isNullOrUndefined(column.headerTextAlign)||!isNullOrUndefined(column.textAlign)){let alignment=column.headerTextAlign||column.textAlign;innerDIV.style.textAlign=alignment,"Right"===alignment||"Left"===alignment?node.classList.add("Right"===alignment?"e-rightalign":"e-leftalign"):"Center"===alignment&&node.classList.add("e-centeralign")}return"Clip"===column.clipMode?node.classList.add("e-gridclip"):"EllipsisWithTooltip"===column.clipMode&&node.classList.add("e-ellipsistooltip"),node.setAttribute("aria-rowspan",(isNullOrUndefined(cell.rowSpan)?1:cell.rowSpan).toString()),node.setAttribute("aria-colspan","1"),this.parent.trigger(headerCellInfo,{cell:cell,node:node}),node}extendPrepareHeader(column,node){if(this.parent.showColumnMenu&&column.showColumnMenu&&!isNullOrUndefined(column.field)){let element=this.parent.createElement("div",{className:"e-icons e-columnmenu"}),matchFilteredColumns=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==matchFilteredColumns.length)for(let i=0;i<this.parent.columns.length;i++)for(let j=0;j<this.parent.filterSettings.columns.length;j++)if(this.parent.filterSettings.columns[j].field===column.field){element.classList.add("e-filtered"),matchFilteredColumns.push(column.field);break}node.classList.add("e-fltr-icon"),node.appendChild(element)}if(this.parent.allowResizing){let handler=this.parent.createElement("div");handler.className=column.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",node.appendChild(handler)}return node}appendHtml(node,innerHtml){return node.appendChild(innerHtml),node}}class ej2_grids_es2015_StackedHeaderCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-headercell e-stackedheadercell",attrs:{role:"columnheader",tabindex:"-1"}})}render(cell,data,attributes$$1){let node=this.element.cloneNode(),div=this.parent.createElement("div",{className:"e-stackedheadercelldiv",attrs:{"e-mappinguid":cell.column.uid}}),column=cell.column;if(node.appendChild(div),isNullOrUndefined(column.headerTemplate)?this.appendHtml(div,column.headerText,column.getDomSetter()):appendChildren(div,column.getHeaderTemplate()(column,this.parent,"headerTemplate")),cell.column.toolTip&&node.setAttribute("title",cell.column.toolTip),isNullOrUndefined(cell.column.textAlign)||(div.style.textAlign=cell.column.textAlign),cell.column.customAttributes&&setStyleAndAttributes(node,cell.column.customAttributes),node.setAttribute("colspan",cell.colSpan.toString()),node.setAttribute("aria-colspan",cell.colSpan.toString()),node.setAttribute("aria-rowspan","1"),this.parent.allowResizing){let handler=this.parent.createElement("div");handler.className=cell.column.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",node.appendChild(handler)}return this.parent.trigger(headerCellInfo,{cell:cell,node:node}),node}}class IndentCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-indentcell"})}render(cell,data){let node=this.element.cloneNode();return setStyleAndAttributes(node,cell.attributes),node}}class ej2_grids_es2015_GroupCaptionCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-groupcaption",attrs:{id:this.parent.element.id+"captioncell",role:"gridcell",tabindex:"-1"}})}render(cell,data){let result,fKeyValue,node=this.element.cloneNode(),gObj=this.parent;data.headerText=cell.column.headerText,cell.isForeignKey&&(fKeyValue=this.format(cell.column,cell.column.valueAccessor("foreignKey",data,cell.column)));let value=cell.isForeignKey?fKeyValue:cell.column.enableGroupByFormat?data.key:this.format(cell.column,cell.column.valueAccessor("key",data,cell.column));if(isNullOrUndefined(gObj.groupSettings.captionTemplate))node.innerHTML=cell.column.headerText+": "+value+" - "+data.count+" "+this.localizer.getConstant(data.count<2?"Item":"Items");else{if(isBlazor()){let tempID=gObj.element.id+"captionTemplate";result=ej2_grids_es2015_templateCompiler(gObj.groupSettings.captionTemplate)(data,null,null,tempID)}else result=ej2_grids_es2015_templateCompiler(gObj.groupSettings.captionTemplate)(data);appendChildren(node,result)}return node.setAttribute("colspan",cell.colSpan.toString()),node.setAttribute("aria-label",node.innerHTML+" is groupcaption cell"),node.setAttribute("title",node.innerHTML),node}}class GroupCaptionEmptyCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-groupcaption"})}render(cell,data){let node=this.element.cloneNode();return node.innerHTML="&nbsp;",node.setAttribute("colspan",cell.colSpan.toString()),node}}class ExpandCellRenderer extends IndentCellRenderer{render(cell,data,attr,isExpand){let node=this.element.cloneNode();return node.className=isExpand?"e-recordplusexpand":"e-recordpluscollapse",node.setAttribute("ej-mappingname",data.field),node.setAttribute("ej-mappingvalue",data.key),node.setAttribute("aria-expanded",isExpand?"true":"false"),node.setAttribute("tabindex","-1"),node.appendChild(this.parent.createElement("div",{className:isExpand?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"})),node}}class HeaderIndentCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-grouptopleftcell"})}render(cell,data){let node=this.element.cloneNode();return node.appendChild(this.parent.createElement("div",{className:"e-headercelldiv e-emptycell",innerHTML:""})),node}}class DetailHeaderIndentCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-detailheadercell"})}render(cell,data){let node=this.element.cloneNode();return node.appendChild(this.parent.createElement("div",{className:"e-emptycell"})),node}}class ej2_grids_es2015_DetailExpandCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-detailrowcollapse",attrs:{"aria-expanded":"false",role:"gridcell",tabindex:"-1"}})}render(cell,data,attributes$$1){let node=this.element.cloneNode();return attributes$$1&&!isNullOrUndefined(attributes$$1.class)?(node.className="",node.className=attributes$$1.class,node.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonaldown e-icon-gdownarrow"}))):node.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonalright e-icon-grightarrow"})),node}}class RowDragDropRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-rowdragdrop",attrs:{role:"gridcell",tabindex:"-1"}})}render(cell,data){let nodeElement=this.element.cloneNode();return nodeElement.appendChild(this.parent.createElement("div",{className:"e-icons e-rowcelldrag e-dtdiagonalright e-icon-rowdragicon"})),nodeElement}}class ej2_grids_es2015_RowDragDropHeaderRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-rowdragheader"})}render(cell,data){let node=this.element.cloneNode();return node.appendChild(ej2_base_es2015_createElement("div",{className:"e-emptycell"})),node}}class ej2_grids_es2015_Render{constructor(parent,locator){this.emptyGrid=!1,this.parent=parent,this.locator=locator,this.data=new ej2_grids_es2015_Data(parent,locator),this.l10n=locator.getService("localization"),this.ariaService=this.locator.getService("ariaService"),this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}render(){let gObj=this.parent;this.headerRenderer=this.renderer.getRenderer(RenderType.Header),this.contentRenderer=this.renderer.getRenderer(RenderType.Content),this.headerRenderer.renderPanel(),this.contentRenderer.renderPanel(),gObj.getColumns().length&&(this.isLayoutRendered=!0,this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.emptyRow(!1)),this.parent.scrollModule.setWidth(),this.parent.scrollModule.setHeight(),"auto"!==this.parent.height&&this.parent.scrollModule.setPadding(),this.refreshDataManager()}refresh(e={requestType:"refresh"}){let gObj=this.parent;gObj.notify(`${e.requestType}-begin`,e),isBlazor()&&this.resetTemplates(),gObj.trigger(actionBegin,e,(args={requestType:"refresh"})=>{if("delete"===args.requestType&&isBlazor()&&!gObj.isJsComponent&&(args.data=gObj.getSelectedRecords()),args.cancel)gObj.notify(cancelBegin,args);else{if("delete"===args.requestType&&gObj.allowPaging){let dataLength=args.data.length,count=gObj.pageSettings.totalRecordsCount-dataLength;gObj.currentViewData.length-dataLength||!count||(gObj.prevPageMoving=!0,gObj.setProperties({pageSettings:{totalRecordsCount:count,currentPage:Math.ceil(count/gObj.pageSettings.pageSize)}},!0),gObj.pagerModule.pagerObj.totalRecordsCount=count)}this.refreshDataManager(args)}})}resetTemplates(){let gObj=this.parent,gridColumns=gObj.getColumns();if(gObj.detailTemplate){let detailTemplateID=gObj.element.id+"detailTemplate";blazorTemplates[detailTemplateID]=[],resetBlazorTemplate(detailTemplateID)}gObj.groupSettings.captionTemplate&&resetBlazorTemplate(gObj.element.id+"captionTemplate"),gObj.rowTemplate&&resetBlazorTemplate(gObj.element.id+"rowTemplate"),gObj.toolbarTemplate&&resetBlazorTemplate(gObj.element.id+"toolbarTemplate");for(let i=0;i<gridColumns.length;i++)gridColumns[i].template&&(blazorTemplates[gObj.element.id+gridColumns[i].uid]=[],resetBlazorTemplate(gObj.element.id+gridColumns[i].uid)),gridColumns[i].headerTemplate&&resetBlazorTemplate(gObj.element.id+gridColumns[i].uid+"headerTemplate"),gridColumns[i].filterTemplate&&resetBlazorTemplate(gObj.element.id+gridColumns[i].uid+"filterTemplate");for(let k=0;k<gObj.aggregates.length;k++)for(let j=0;j<gObj.aggregates[k].columns.length;j++)gObj.aggregates[k].columns[j].footerTemplate&&resetBlazorTemplate(gObj.element.id+gObj.aggregates[k].columns[j].guid+"footerTemplate"),gObj.aggregates[k].columns[j].groupFooterTemplate&&resetBlazorTemplate(gObj.element.id+gObj.aggregates[k].columns[j].guid+"groupFooterTemplate"),gObj.aggregates[k].columns[j].groupCaptionTemplate&&resetBlazorTemplate(gObj.element.id+gObj.aggregates[k].columns[j].guid+"groupCaptionTemplate")}refreshComplete(e){this.parent.trigger(actionComplete,e)}refreshDataManager(args={}){let dataManager;"virtualscroll"!==args.requestType&&this.parent.showSpinner(),this.emptyGrid=!1;let isFActon=this.isNeedForeignAction();if(this.ariaService.setBusy(this.parent.getContent().firstChild,!0),isFActon){let deffered=new Deferred;dataManager=this.getFData(deffered)}if(dataManager=dataManager?dataManager.then(e=>{let query=this.data.generateQuery().requiresCount();if(this.emptyGrid){let def=new Deferred;return def.resolve({result:[],count:0}),def.promise}return this.data.getData(args,query)}):this.data.getData(args,this.data.generateQuery().requiresCount()),this.parent.getForeignKeyColumns().length&&(!isFActon||this.parent.searchSettings.key.length)){let deffered=new Deferred;dataManager=dataManager.then(e=>(this.parent.notify(getForeignKeyData,{dataManager:dataManager,result:e,promise:deffered}),deffered.promise))}this.parent.groupSettings.disablePageWiseAggregates&&this.parent.groupSettings.columns.length&&(dataManager=dataManager.then(e=>this.validateGroupRecords(e))),dataManager.then(e=>this.dataManagerSuccess(e,args)).catch(e=>this.dataManagerFailure(e,args))}getFData(deferred){return this.parent.notify(getForeignKeyData,{isComplex:!0,promise:deferred}),deferred.promise}isNeedForeignAction(){let gObj=this.parent;return!!(gObj.allowFiltering&&gObj.filterSettings.columns.length||gObj.searchSettings.key.length)&&this.foreignKey(this.parent.getForeignKeyColumns())}foreignKey(columns){return columns.some(col=>{let fbool=!1;return!(!(fbool=this.parent.filterSettings.columns.some(value=>col.uid===value.uid))&&!this.parent.searchSettings.key.length)})}sendBulkRequest(args){args.requestType="batchsave";let promise=this.data.saveChanges(args.changes,this.parent.getPrimaryKeyFieldNames()[0],args.original),query=this.data.generateQuery().requiresCount();this.data.dataManager.dataSource.offline?this.refreshDataManager({requestType:"batchsave"}):promise.then(e=>{this.data.getData(args,query).then(e=>this.dmSuccess(e,args)).catch(e=>this.dmFailure(e,args))}).catch(e=>this.dmFailure(e,args))}dmSuccess(e,args){this.dataManagerSuccess(e,args)}dmFailure(e,args){this.dataManagerFailure(e,args)}renderEmptyRow(){this.emptyRow(!0)}emptyRow(isTrigger){let tr,gObj=this.parent,tbody=this.contentRenderer.getTable().querySelector("tbody");isNullOrUndefined(tbody)||ej2_base_es2015_remove(tbody),tbody=this.parent.createElement("tbody");let spanCount=0;(gObj.detailTemplate||gObj.childGrid)&&++spanCount,(tr=this.parent.createElement("tr",{className:"e-emptyrow"})).appendChild(this.parent.createElement("td",{innerHTML:this.l10n.getConstant("EmptyRecord"),attrs:{colspan:(gObj.getColumns().length+spanCount).toString()}})),tbody.appendChild(tr),this.contentRenderer.renderEmpty(tbody),isTrigger&&(this.parent.trigger(dataBound,{}),this.parent.notify(onEmpty,{rows:[new ej2_grids_es2015_Row({isDataRow:!0,cells:[new ej2_grids_es2015_Cell({isDataCell:!0,visible:!0})]})]}))}dynamicColumnChange(){this.parent.getCurrentViewRecords().length&&this.updateColumnType(this.parent.getCurrentViewRecords()[0])}updateColumnType(record){let value,columns=this.parent.getColumns(),data=record&&record.items?record.items[0]:record,fmtr=this.locator.getService("valueFormatter");for(let i=0,len=columns.length;i<len;i++){value=ej2_grids_es2015_getObject(columns[i].field||"",data),isNullOrUndefined(columns[i].customFormat)||(columns[i].format=columns[i].customFormat),isNullOrUndefined(columns[i].validationRules)||isNullOrUndefined(columns[i].validationRules.equalTo)||(columns[i].validationRules.equalTo[0]=this.parent.element.id+columns[i].validationRules.equalTo[0]),columns[i].isForeignColumn()&&columns[i].columnData&&(value=ej2_grids_es2015_getObject(columns[i].foreignKeyValue||"",columns[i].columnData[0])),isNullOrUndefined(value)?columns[i].type=columns[i].type||null:(this.isColTypeDef=!0,columns[i].type||(columns[i].type=value.getDay?value.getHours()>0||value.getMinutes()>0||value.getSeconds()>0||value.getMilliseconds()>0?"datetime":"date":typeof value));let valueFormatter=new ej2_grids_es2015_ValueFormatter;columns[i].format&&(columns[i].format.skeleton||columns[i].format.format)&&(columns[i].setFormatter(valueFormatter.getFormatFunction(columns[i].format)),columns[i].setParser(valueFormatter.getParserFunction(columns[i].format))),"string"==typeof columns[i].format?setFormatter(this.locator,columns[i]):columns[i].format||"number"!==columns[i].type||columns[i].setParser(fmtr.getParserFunction({format:"n2"}))}}dataManagerSuccess(e,args){let gObj=this.parent;this.contentRenderer=this.renderer.getRenderer(RenderType.Content),this.headerRenderer=this.renderer.getRenderer(RenderType.Header),e.actionArgs=args,gObj.trigger(beforeDataBound,e,dataArgs=>{if(dataArgs.cancel)return;let len=Object.keys(dataArgs.result).length;if(!this.parent.isDestroyed)if(gObj.getColumns().length||len||gObj.columns.length&&gObj.columns[0]instanceof ej2_grids_es2015_Column){if(this.parent.isEdit=!1,this.parent.notify(tooltipDestroy,{}),gObj.currentViewData=dataArgs.result,!len&&dataArgs.count&&gObj.allowPaging&&args&&"delete"!==args.requestType)return gObj.prevPageMoving=!0,gObj.pageSettings.totalRecordsCount=dataArgs.count,"paging"!==args.requestType&&(gObj.pageSettings.currentPage=Math.ceil(dataArgs.count/gObj.pageSettings.pageSize)),void gObj.dataBind();if((gObj.getColumns().length||!len)&&this.isLayoutRendered||isGroupAdaptive(gObj)||this.updatesOnInitialRender(dataArgs),!this.isColTypeDef&&gObj.getCurrentViewRecords()&&this.updateColumnType(gObj.getCurrentViewRecords()[0]),this.parent.isInitialLoad||!this.parent.groupSettings.disablePageWiseAggregates||this.parent.groupSettings.columns.length||(dataArgs.result=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.currentViewData),this.parent.notify(dataReady,extend({count:dataArgs.count,result:dataArgs.result,aggregates:dataArgs.aggregates},args)),(gObj.groupSettings.columns.length||args&&"ungrouping"===args.requestType)&&args&&"filtering"!==args.requestType&&this.headerRenderer.refreshUI(),len)isGroupAdaptive(gObj)&&(args.scrollTop={top:this.contentRenderer.content.scrollTop}),this.contentRenderer.refreshContentRows(args);else{if(!gObj.getColumns().length)return gObj.element.innerHTML="",void alert(this.l10n.getConstant("EmptyDataSourceError"));if(this.contentRenderer.setRowElements([]),this.contentRenderer.setRowObjects([]),this.ariaService.setBusy(this.parent.getContent().firstChild,!1),this.renderEmptyRow(),args){let action=(args.requestType||"").toLowerCase()+"-complete";this.parent.notify(action,args),"batchsave"===args.requestType&&(args.cancel=!1,args.rows=[],args.isFrozen=0!==this.parent.getFrozenColumns()&&!args.isFrozen,this.parent.trigger(actionComplete,args))}this.parent.hideSpinner()}this.parent.notify(toolbarRefresh,{})}else gObj.hideSpinner()})}dataManagerFailure(e,args){this.ariaService.setOptions(this.parent.getContent().firstChild,{busy:!1,invalid:!0}),this.parent.trigger(ej2_grids_es2015_actionFailure,{error:e}),this.parent.hideSpinner(),"save"!==args.requestType&&"delete"!==args.requestType&&"bulk-save"!==args.name&&(this.parent.currentViewData=[],this.renderEmptyRow(),this.parent.log("actionfailure",{error:e}))}updatesOnInitialRender(e){this.isLayoutRendered=!0,this.parent.columns.length<1&&this.buildColumns(e.result[0]),prepareColumns(this.parent.columns),this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.parent.notify(autoCol,{})}buildColumns(record){let columns=Object.keys(record),cols=[];for(let i=0,len=columns.length;i<len;i++)cols[i]={field:columns[i]},this.parent.enableColumnVirtualization&&(cols[i].width=isNullOrUndefined(cols[i].width)?200:cols[i].width);this.parent.setProperties({columns:cols},!0)}instantiateRenderer(){this.renderer.addRenderer(RenderType.Header,new ej2_grids_es2015_HeaderRender(this.parent,this.locator)),this.renderer.addRenderer(RenderType.Content,new ej2_grids_es2015_ContentRender(this.parent,this.locator));let cellrender=this.locator.getService("cellRendererFactory");cellrender.addCellRenderer(CellType.Header,new ej2_grids_es2015_HeaderCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.Data,new ej2_grids_es2015_CellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.StackedHeader,new ej2_grids_es2015_StackedHeaderCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.Indent,new IndentCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.GroupCaption,new ej2_grids_es2015_GroupCaptionCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.GroupCaptionEmpty,new GroupCaptionEmptyCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.Expand,new ExpandCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.HeaderIndent,new HeaderIndentCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.StackedHeader,new ej2_grids_es2015_StackedHeaderCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.DetailHeader,new DetailHeaderIndentCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.RowDragHIcon,new ej2_grids_es2015_RowDragDropHeaderRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.DetailExpand,new ej2_grids_es2015_DetailExpandCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.DetailFooterIntent,new IndentCellRenderer(this.parent,this.locator)),cellrender.addCellRenderer(CellType.RowDragIcon,new RowDragDropRenderer(this.parent,this.locator))}addEventListener(){this.parent.isDestroyed||(this.parent.on(initialLoad,this.instantiateRenderer,this),this.parent.on("refreshdataSource",this.dataManagerSuccess,this),this.parent.on(modelChanged,this.refresh,this),this.parent.on(refreshComplete,this.refreshComplete,this),this.parent.on(bulkSave,this.sendBulkRequest,this),this.parent.on(showEmptyGrid,()=>{this.emptyGrid=!0},this),this.parent.on(autoCol,this.dynamicColumnChange,this))}validateGroupRecords(e){let index=e.result.length-1;if(index<0)return Promise.resolve(e);let group0=e.result[0],groupN=e.result[index],predicate=[],addWhere=input=>{[group0,groupN].forEach(group=>predicate.push(new ej2_data_es2015_Predicate("field","==",group.field).and(this.getPredicate("key","equal",group.key)))),input.where(ej2_data_es2015_Predicate.or(predicate))},query=new ej2_data_es2015_Query;addWhere(query);let curFilter=new ej2_data_es2015_DataManager(e.result).executeLocal(query),newQuery=this.data.generateQuery(!0),rPredicate=[];this.data.isRemote()?([group0,groupN].forEach(group=>rPredicate.push(this.getPredicate(group.field,"equal",group.key))),newQuery.where(ej2_data_es2015_Predicate.or(rPredicate))):addWhere(newQuery);let deferred=new Deferred;return this.data.getData({},newQuery).then(r=>{this.updateGroupInfo(curFilter,r.result),deferred.resolve(e)}).catch(e=>deferred.reject(e)),deferred.promise}getPredicate(key,operator,value){return value instanceof Date?getDatePredicate({field:key,operator:operator,value:value}):new ej2_data_es2015_Predicate(key,operator,value)}updateGroupInfo(current,untouched){let dm=new ej2_data_es2015_DataManager(untouched);return current.forEach((element,index,array)=>{let uGroup=dm.executeLocal((new ej2_data_es2015_Query).where(new ej2_data_es2015_Predicate("field","==",element.field).and(this.getPredicate("key","equal",element.key))))[0];element.count=uGroup.count;let itemGroup=element.items,uGroupItem=uGroup.items;itemGroup.GroupGuid&&(element.items=this.updateGroupInfo(element.items,uGroup.items)),this.parent.aggregates.forEach(row=>row.columns.forEach(column=>{(column.type instanceof Array?column.type:[column.type]).forEach(type=>{let key=column.field+" - "+type.toLowerCase(),data=itemGroup.level?uGroupItem.records:uGroup.items;if("Custom"===type){let data=itemGroup.level?uGroupItem:uGroup;element.aggregates[key]=column.customAggregate?column.customAggregate.call(this.parent,data,column):""}else element.aggregates[key]=ej2_data_es2015_DataUtil.aggregates[type.toLowerCase()](data,column.field)})}))}),current}}class ej2_grids_es2015_CellRendererFactory{constructor(){this.cellRenderMap={}}addCellRenderer(name,type){name="string"==typeof name?name:getEnumValue(CellType,name),isNullOrUndefined(this.cellRenderMap[name])&&(this.cellRenderMap[name]=type)}getCellRenderer(name){if(name="string"==typeof name?name:getEnumValue(CellType,name),isNullOrUndefined(this.cellRenderMap[name]))throw`The cellRenderer ${name} is not found`;return this.cellRenderMap[name]}}class ej2_grids_es2015_ServiceLocator{constructor(){this.services={}}register(name,type){isNullOrUndefined(this.services[name])&&(this.services[name]=type)}getService(name){if(isNullOrUndefined(this.services[name]))throw`The service ${name} is not registered`;return this.services[name]}}class ej2_grids_es2015_RendererFactory{constructor(){this.rendererMap={}}addRenderer(name,type){let rName=getEnumValue(RenderType,name);isNullOrUndefined(this.rendererMap[rName])&&(this.rendererMap[rName]=type)}getRenderer(name){let rName=getEnumValue(RenderType,name);if(isNullOrUndefined(this.rendererMap[rName]))throw`The renderer ${rName} is not found`;return this.rendererMap[rName]}}class ej2_grids_es2015_ColumnWidthService{constructor(parent){this.parent=parent}setWidthToColumns(){let i=0,indexes=this.parent.getColumnIndexesInView(),wFlag=!0,totalColumnsWidth=0;if(this.parent.allowGrouping)for(let len=this.parent.groupSettings.columns.length;i<len;i++)this.parent.enableColumnVirtualization&&-1===indexes.indexOf(i)?wFlag=!1:this.setColumnWidth(new ej2_grids_es2015_Column({width:"30px"}),i);(this.parent.detailTemplate||this.parent.childGrid)&&(this.setColumnWidth(new ej2_grids_es2015_Column({width:"30px"}),i),i++),this.parent.isRowDragable()&&(this.setColumnWidth(new ej2_grids_es2015_Column({width:"30px"}),i),i++),this.parent.getColumns().forEach((column,index)=>{this.setColumnWidth(column,wFlag&&this.parent.enableColumnVirtualization?void 0:index+i)}),totalColumnsWidth=this.getTableWidth(this.parent.getColumns()),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(totalColumnsWidth)}setMinwidthBycalculation(tWidth){let difference=0,collection=this.parent.getColumns().filter(a=>isNullOrUndefined(a.width)||"auto"===a.width);if(collection.length){isNullOrUndefined(this.parent.width)||"auto"===this.parent.width||(difference=("string"==typeof this.parent.width?parseInt(this.parent.width,10):this.parent.width)-tWidth);let tmWidth=0;for(let cols of collection)tmWidth+=isNullOrUndefined(cols.minWidth)?0:"string"==typeof cols.minWidth?parseInt(cols.minWidth,10):cols.minWidth;for(let i=0;i<collection.length;i++)0===tWidth&&this.parent.allowResizing&&this.isWidthUndefined()&&i!==collection.length-1&&this.setUndefinedColumnWidth(collection),0!==tWidth&&difference<tmWidth?this.setWidth(collection[i].minWidth,this.parent.getColumnIndexByField(collection[i].field)):0!==tWidth&&difference>tmWidth&&this.setWidth("",this.parent.getColumnIndexByField(collection[i].field),!0)}}setUndefinedColumnWidth(collection){for(let k=0;k<collection.length;k++)k!==collection.length-1&&(collection[k].width=200,this.setWidth(200,this.parent.getColumnIndexByField(collection[k].field)))}setColumnWidth(column,index,module){let columnIndex=isNullOrUndefined(index)?this.parent.getNormalizedColumnIndex(column.uid):index,cWidth=this.getWidth(column),tgridWidth=this.getTableWidth(this.parent.getColumns());null!==cWidth&&(this.setWidth(cWidth,columnIndex),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(tgridWidth),(this.parent.allowResizing&&"resize"===module||this.parent.getFrozenColumns()&&this.parent.allowResizing)&&this.setWidthToTable(),this.parent.notify(columnWidthChanged,{index:columnIndex,width:cWidth,column:column,module:module}))}setWidth(width,index,clear){if("string"==typeof width&&-1!==width.indexOf("%")&&(!Boolean(window.chrome)||!Boolean(window.chrome.webstore))&&this.parent.allowGrouping){let elementWidth=this.parent.element.offsetWidth;width=parseInt(width,10)/100*elementWidth}let headerCol,contentCol,header=this.parent.getHeaderTable(),content=this.parent.getContentTable(),fWidth=formatUnit(width),frzCols=this.parent.getFrozenColumns(),mHdr=this.parent.getHeaderContent().querySelector(".e-movableheader");(headerCol=frzCols&&index>=frzCols&&mHdr&&mHdr.querySelector("colgroup")?mHdr.querySelector("colgroup").children[index-frzCols]:header.querySelector("colgroup").children[index])&&!clear?headerCol.style.width=fWidth:headerCol&&clear&&(headerCol.style.width=" "),(contentCol=frzCols&&index>=frzCols?this.parent.getContent().querySelector(".e-movablecontent").querySelector("colgroup").children[index-frzCols]:content.querySelector("colgroup").children[index])&&!clear?contentCol.style.width=fWidth:contentCol&&clear&&(contentCol.style.width=" ");let edit=this.parent.element.querySelectorAll(".e-table.e-inline-edit"),editTableCol=[];for(let i=0;i<edit.length;i++)for(let j=0;j<edit[i].querySelector("colgroup").children.length;j++)editTableCol.push(edit[i].querySelector("colgroup").children[j]);edit.length&&(editTableCol[index].style.width=fWidth)}getSiblingsHeight(element){return this.getHeightFromDirection(element,"previous")+this.getHeightFromDirection(element,"next")}getHeightFromDirection(element,direction){let sibling=element[direction+"ElementSibling"],result=0,classList$$1=["e-gridheader","e-gridfooter","e-groupdroparea","e-gridpager","e-toolbar"];for(;sibling;)classList$$1.some(value=>sibling.classList.contains(value))&&(result+=sibling.offsetHeight),sibling=sibling[direction+"ElementSibling"];return result}isWidthUndefined(){let isWidUndefCount=this.parent.getColumns().filter(col=>isNullOrUndefined(col.width)&&isNullOrUndefined(col.minWidth)).length;return this.parent.getColumns().length===isWidUndefCount}getWidth(column){if(isNullOrUndefined(column.width)&&this.parent.allowResizing&&isNullOrUndefined(column.minWidth)&&!this.isWidthUndefined()&&(column.width=200),!column.width)return null;let width=parseInt(column.width.toString(),10);return column.minWidth&&width<parseInt(column.minWidth.toString(),10)?column.minWidth:column.maxWidth&&width>parseInt(column.maxWidth.toString(),10)?column.maxWidth:column.width}getTableWidth(columns){let tWidth=0;for(let column of columns){let cWidth=this.getWidth(column);"auto"===column.width&&(cWidth=0),!1!==column.visible&&null!==cWidth&&(tWidth+=parseInt(cWidth.toString(),10))}return tWidth}calcMovableOrFreezeColWidth(tableType){let columns=this.parent.getColumns().slice();return"movable"===tableType?columns.splice(0,this.parent.getFrozenColumns()):"freeze"===tableType&&columns.splice(this.parent.getFrozenColumns(),columns.length),formatUnit(this.getTableWidth(columns))}setWidthToFrozenTable(){let freezeWidth=this.calcMovableOrFreezeColWidth("freeze");this.parent.getHeaderTable().style.width=freezeWidth,this.parent.getContentTable().style.width=freezeWidth}setWidthToMovableTable(){let movableWidth="",isColUndefined=this.parent.getColumns().filter(a=>isNullOrUndefined(a.width)).length>=1,isWidthAuto=this.parent.getColumns().filter(a=>"auto"===a.width).length>=1;"number"!=typeof this.parent.width||isColUndefined||isWidthAuto?isColUndefined||isWidthAuto||(movableWidth=this.calcMovableOrFreezeColWidth("movable")):movableWidth=formatUnit(this.parent.width-parseInt(this.calcMovableOrFreezeColWidth("freeze").split("px")[0],10)-5),this.parent.getHeaderContent().querySelector(".e-movableheader").firstElementChild&&(this.parent.getHeaderContent().querySelector(".e-movableheader").firstElementChild.style.width=movableWidth),this.parent.getContent().querySelector(".e-movablecontent").firstElementChild.style.width=movableWidth}setWidthToFrozenEditTable(){let freezeWidth=this.calcMovableOrFreezeColWidth("freeze");this.parent.element.querySelectorAll(".e-table.e-inline-edit")[0].style.width=freezeWidth}setWidthToMovableEditTable(){let movableWidth=this.calcMovableOrFreezeColWidth("movable");this.parent.element.querySelectorAll(".e-table.e-inline-edit")[1].style.width=movableWidth}setWidthToTable(){let tWidth=formatUnit(this.getTableWidth(this.parent.getColumns()));this.parent.getFrozenColumns()?(this.setWidthToFrozenTable(),this.setWidthToMovableTable()):((this.parent.detailTemplate||this.parent.childGrid)&&this.setColumnWidth(new ej2_grids_es2015_Column({width:"30px"})),this.parent.getHeaderTable().style.width=tWidth,this.parent.getContentTable().style.width=tWidth);let edit=this.parent.element.querySelector(".e-table.e-inline-edit");edit&&this.parent.getFrozenColumns()?(this.setWidthToFrozenEditTable(),this.setWidthToMovableEditTable()):edit&&(edit.style.width=tWidth)}}class ej2_grids_es2015_FocusStrategy{constructor(parent){this.currentInfo={},this.oneTime=!0,this.swap={},this.forget=!0,this.skipFocus=!0,this.focusByClick=!1,this.prevIndexes={},this.refMatrix=this.refreshMatrix(!0),this.parent=parent,this.addEventListener()}focusCheck(e){let target=e.target;this.focusByClick=!0,this.skipFocus=target.classList.contains("e-grid")}onFocus(){if(this.parent.isDestroyed||Browser.isDevice||this.parent.enableVirtualization)return;this.setActive(0===this.parent.frozenRows,0!==this.parent.frozenColumns);let current=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(current[0],current[1]),this.skipFocus&&(this.focus(),this.skipFocus=!1)}passiveFocus(e){this.parent.isDestroyed||e.target&&e.target.classList.contains("e-detailcell")&&(this.currentInfo.skipAction=!1,addClass([this.currentInfo.element],["e-focused","e-focus"]))}onBlur(e){this.parent.isEdit||e&&(!e.relatedTarget||closest(e.relatedTarget,".e-grid"))||(this.removeFocus(),this.skipFocus=!1,this.currentInfo.skipAction=!1,this.getContent().getFocusInfo().elementToFocus&&(this.getContent().getFocusInfo().elementToFocus.tabIndex=0))}onClick(e,force){let isContent=!isNullOrUndefined(closest(e.target,".e-gridcontent")),isHeader=!isNullOrUndefined(closest(e.target,".e-gridheader"));isContent=isContent&&isHeader?!isContent:isContent;let isFrozen=!isNullOrUndefined(closest(e.target,".e-frozencontent"))||!isNullOrUndefined(closest(e.target,".e-frozenheader"));if(!isContent&&isNullOrUndefined(closest(e.target,".e-gridheader"))||e.target.classList.contains("e-content")||!isNullOrUndefined(closest(e.target,".e-unboundcell")))return;if(this.setActive(isContent,isFrozen),!isContent&&isNullOrUndefined(closest(e.target,".e-gridheader"))||e.target.classList.contains("e-filtermenudiv"))return void this.clearOutline();let beforeArgs={cancel:!1,byKey:!1,byClick:!isNullOrUndefined(e.target),clickArgs:e};if(this.parent.notify(beforeCellFocused,beforeArgs),!beforeArgs.cancel&&!closest(e.target,".e-inline-edit")&&(this.setActive(isContent,isFrozen),this.getContent())){if(!1===this.getContent().onClick(e,force))return;this.focus()}}onKeyPress(e){if(this.skipOn(e))return;let beforeArgs={cancel:!1,byKey:!0,byClick:!1,keyArgs:e};if(this.parent.notify(beforeCellFocused,beforeArgs),beforeArgs.cancel)return;let bValue=this.getContent().matrix.current;this.currentInfo.outline=!0;let swapInfo=this.getContent().jump(e.action,bValue);this.swap=swapInfo,swapInfo.swap&&(this.setActive(!swapInfo.toHeader,swapInfo.toFrozen),this.getContent().matrix.current=this.getContent().getNextCurrent(bValue,swapInfo,this.active,e.action),this.prevIndexes={}),this.setActiveByKey(e.action,this.getContent()),!1!==this.getContent().onKeyPress(e)?(e.preventDefault(),this.focus(e)):this.clearIndicator()}skipOn(e){let target=e.target;return!!target&&(this.currentInfo.skipAction?(this.clearIndicator(),!0):["pageUp","pageDown"].indexOf(e.action)>-1?(this.clearIndicator(),!0):(closest(target,"th")&&!closest(target,"th").tabIndex&&null!==closest(document.activeElement,".e-filterbarcell")&&this.removeFocus(),"delete"===e.action||"Batch"!==this.parent.editSettings.mode&&(this.parent.isEdit||["insert","f2"].indexOf(e.action)>-1)||null!==closest(document.activeElement,".e-filterbarcell")||null!==closest(document.activeElement,"#"+this.parent.element.id+"_searchbar")&&["enter","leftArrow","rightArrow","shiftLeft","shiftRight","ctrlPlusA"].indexOf(e.action)>-1||null===closest(target,".e-gridcontent")&&null===closest(target,".e-gridheader")||"space"===e.action&&!target.classList.contains("e-gridchkbox")&&null===closest(target,".e-gridchkbox")&&null===closest(target,".e-headerchkcelldiv")))}getFocusedElement(){return this.currentInfo.elementToFocus}getContent(){return this.active||this.content}setActive(content,isFrozen){this.active=content?isFrozen?this.fContent:this.content:isFrozen?this.fHeader:this.header}setFocusedElement(element){this.currentInfo.elementToFocus=element,setTimeout(()=>this.currentInfo.elementToFocus.focus(),0)}focus(e){this.removeFocus(),this.addFocus(this.getContent().getFocusInfo(),e)}removeFocus(e){this.currentInfo.element&&(removeClass([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focused","e-focus"]),this.currentInfo.element.tabIndex=-1)}addFocus(info,e){if(this.currentInfo=info,this.currentInfo.outline=info.outline&&!isNullOrUndefined(e),!info.element)return;let isFocused=info.elementToFocus.classList.contains("e-focus");if(isFocused)return;this.currentInfo.outline&&addClass([info.element],["e-focused"]),addClass([info.elementToFocus],["e-focus"]),info.element.tabIndex=0,isFocused||this.setFocusedElement(info.elementToFocus),this.parent.notify(cellFocused,{element:info.elementToFocus,parent:info.element,indexes:this.getContent().matrix.current,byKey:!isNullOrUndefined(e),byClick:isNullOrUndefined(e),keyArgs:e,isJump:this.swap.swap,container:this.getContent().getInfo(e),outline:!isNullOrUndefined(e),swapInfo:this.swap});let[rowIndex,cellIndex]=this.getContent().matrix.current;this.prevIndexes={rowIndex:rowIndex,cellIndex:cellIndex},this.focusedColumnUid=this.parent.getColumnByIndex(cellIndex).uid,this.focusByClick=!1}refreshMatrix(content){return e=>{content&&e.args&&e.args.isFrozen&&!this.fContent?this.fContent=new FixedContentFocus(this.parent):content&&!this.content&&(this.content=new ej2_grids_es2015_ContentFocus(this.parent)),!content&&e.args&&e.args.isFrozen&&!this.fHeader?this.fHeader=new FixedHeaderFocus(this.parent):content||this.header||(this.header=new ej2_grids_es2015_HeaderFocus(this.parent));let cFocus=content?e.args&&e.args.isFrozen?this.fContent:this.content:e.args&&e.args.isFrozen?this.fHeader:this.header,rows=content?e.rows.slice(this.parent.frozenRows):e.rows,updateRow=content?e.rows.slice(0,this.parent.frozenRows):e.rows,isRowTemplate=!isNullOrUndefined(this.parent.rowTemplate),matrix=cFocus.matrix.generate(updateRow,cFocus.selector,isRowTemplate),frozenColumnsCount=this.parent.getFrozenColumns();if("batchAdd"===e.name&&frozenColumnsCount){let newMovableRows=rows.map(row=>row.clone()),newFrozenRows=rows.map(row=>row.clone());for(let i=0;i<rows.length;i++)rows[i].cells.length>frozenColumnsCount&&(newFrozenRows[i].cells=rows[i].cells.slice(0,frozenColumnsCount),newMovableRows[i].cells=rows[i].cells.slice(frozenColumnsCount));this.fContent.matrix.generate(newFrozenRows,this.fContent.selector,isRowTemplate),cFocus.matrix.generate(newMovableRows,cFocus.selector,isRowTemplate)}else cFocus.matrix.generate(rows,cFocus.selector,isRowTemplate);if(cFocus.generateRows(updateRow,{matrix:matrix,handlerInstance:e.args&&e.args.isFrozen?this.fHeader:this.header}),!Browser.isDevice&&!this.focusByClick&&e&&e.args&&"paging"===e.args.requestType&&(this.skipFocus=!1,this.parent.element.focus()),e&&e.args&&"virtualscroll"===e.args.requestType)if(this.currentInfo.uid){let index;if(e.rows.some((row,i)=>(index=i,row.uid===this.currentInfo.uid))){this.content.matrix.current[0]=index,this.content.matrix.current[1]=this.parent.getColumnIndexByUid(this.focusedColumnUid)||0;let focusElement=this.getContent().getFocusInfo().elementToFocus;if(focusElement){let cellPosition=focusElement.getBoundingClientRect(),gridPosition=this.parent.element.getBoundingClientRect();cellPosition.top>=0&&cellPosition.left>=0&&cellPosition.right<=Math.min(gridPosition.right,window.innerWidth||document.documentElement.clientWidth)&&cellPosition.bottom<=Math.min(gridPosition.bottom,window.innerHeight||document.documentElement.clientHeight)&&this.focus()}}}else if(e.args.focusElement&&e.args.focusElement.classList.contains("e-filtertext")){let focusElement=this.parent.element.querySelector("#"+e.args.focusElement.id);focusElement&&focusElement.focus()}}}addEventListener(){this.parent.isDestroyed||(EventHandler.add(this.parent.element,"mousedown",this.focusCheck,this),EventHandler.add(this.parent.element,"focus",this.onFocus,this),this.parent.element.addEventListener("focus",this.passiveHandler=e=>this.passiveFocus(e),!0),EventHandler.add(this.parent.element,"focusout",this.onBlur,this),this.parent.on(keyPressed,this.onKeyPress,this),this.parent.on(click,this.onClick,this),this.parent.on(contentReady,this.refMatrix,this),this.parent.on(partialRefresh,this.refMatrix,this),this.parent.on(headerRefreshed,this.refreshMatrix(),this),this.parent.on("close-edit",this.restoreFocus,this),["start-edit","start-add"].forEach(evt=>this.parent.on(evt,this.clearIndicator,this)),["sorting"].forEach(action=>this.parent.on(`${action}-complete`,this.restoreFocus,this)),this.parent.on(batchAdd,this.refMatrix,this),this.parent.on(batchCancel,this.refMatrix,this),this.parent.on(batchDelete,this.refMatrix,this),this.parent.on(detailDataBound,this.refMatrix,this),this.parent.on(onEmpty,this.refMatrix,this),this.parent.on(cellFocused,this.internalCellFocus,this))}removeEventListener(){this.parent.isDestroyed||(EventHandler.remove(this.parent.element,"mousedown",this.focusCheck),EventHandler.remove(this.parent.element,"focus",this.onFocus),EventHandler.remove(this.parent.element,"focusout",this.onBlur),this.parent.element.removeEventListener("focus",this.passiveHandler,!0),this.parent.off(keyPressed,this.onKeyPress),this.parent.off(click,this.onClick),this.parent.off(contentReady,this.refMatrix),this.parent.off(partialRefresh,this.refMatrix),this.parent.off(headerRefreshed,this.refreshMatrix()),this.parent.off("close-edit",this.restoreFocus),["start-edit","start-add"].forEach(evt=>this.parent.off(evt,this.clearOutline)),["sorting"].forEach(action=>this.parent.off(`${action}-complete`,this.restoreFocus)),this.parent.off(batchAdd,this.refMatrix),this.parent.off(batchDelete,this.refMatrix),this.parent.off(batchCancel,this.refMatrix),this.parent.off(detailDataBound,this.refMatrix),this.parent.off(onEmpty,this.refMatrix),this.parent.off(cellFocused,this.internalCellFocus))}destroy(){this.removeEventListener()}restoreFocus(){this.addFocus(this.getContent().getFocusInfo())}clearOutline(){this.getContent().matrix.current=this.getContent().matrix.get(0,-1,[0,1],"downArrow",this.getContent().validator()),this.clearIndicator()}clearIndicator(){this.currentInfo.element&&this.currentInfo.elementToFocus&&removeClass([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focus","e-focused"])}getPrevIndexes(){let forget=this.forget;return this.forget=!1,forget?{rowIndex:null,cellIndex:null}:this.prevIndexes}forgetPrevious(){this.forget=!0}setActiveByKey(action,active){if(0===this.parent.frozenColumns&&0===this.parent.frozenRows)return;let info,actions={home:()=>({toHeader:!info.isContent,toFrozen:!0}),end:()=>({toHeader:!info.isContent,toFrozen:!1}),ctrlHome:()=>({toHeader:!0,toFrozen:0!==this.parent.frozenColumns}),ctrlEnd:()=>({toHeader:!1,toFrozen:!1})};if(!(action in actions))return;info=active.getInfo();let swap=actions[action]();this.setActive(!swap.toHeader,swap.toFrozen),this.getContent().matrix.current=active.matrix.current}internalCellFocus(e){if(!(e.byKey&&e.container.isContent&&"enter"===e.keyArgs.action&&(e.parent.classList.contains("e-detailcell")||e.parent.classList.contains("e-unboundcell")||e.parent.classList.contains("e-templatecell"))))return;this.clearIndicator();let focusEle=this.getContent().getFocusable(this.getFocusedElement());this.setFocusedElement(focusEle),this.currentInfo.skipAction=!0}}class ej2_grids_es2015_Matrix{constructor(){this.matrix=[],this.current=[]}set(rowIndex,columnIndex,allow){rowIndex=Math.max(0,Math.min(rowIndex,this.rows)),columnIndex=Math.max(0,Math.min(columnIndex,this.columns)),this.matrix[rowIndex]=this.matrix[rowIndex]||[],this.matrix[rowIndex][columnIndex]=allow?1:0}get(rowIndex,columnIndex,navigator,action,validator){let tmp=columnIndex;if(rowIndex+navigator[0]<0)return[rowIndex,columnIndex];if(rowIndex=Math.max(0,Math.min(rowIndex+navigator[0],this.rows)),isNullOrUndefined(this.matrix[rowIndex]))return null;if(columnIndex=Math.max(0,Math.min(columnIndex+navigator[1],this.matrix[rowIndex].length-1)),tmp+navigator[1]>this.matrix[rowIndex].length-1&&validator(rowIndex,columnIndex,action))return[rowIndex,tmp];let first=this.first(this.matrix[rowIndex],columnIndex,navigator,!0,action),val=getValue(`${rowIndex}.${columnIndex=null===first?tmp:first}`,this.matrix);return rowIndex!==this.rows||"downArrow"!==action&&"enter"!==action||(navigator[0]=-1),this.inValid(val)||!validator(rowIndex,columnIndex,action)?this.get(rowIndex,tmp,navigator,action,validator):[rowIndex,columnIndex]}first(vector,index,navigator,moveTo,action){return(index<0||index===vector.length)&&this.inValid(vector[index])&&"upArrow"!==action&&"downArrow"!==action||!vector.some(v=>1===v)?null:this.inValid(vector[index])?this.first(vector,-1!==["upArrow","downArrow","shiftUp","shiftDown"].indexOf(action)?moveTo?0:++index:index+navigator[1],navigator,!1,action):index}select(rowIndex,columnIndex){rowIndex=Math.max(0,Math.min(rowIndex,this.rows)),columnIndex=Math.max(0,Math.min(columnIndex,this.matrix[rowIndex].length-1)),this.current=[rowIndex,columnIndex]}generate(rows,selector,isRowTemplate){return this.rows=rows.length-1,this.matrix=[],rows.forEach((row,rIndex)=>{let cells=row.cells.filter(c=>!0!==c.isSpanned);this.columns=Math.max(cells.length-1,0|this.columns),cells.forEach((cell,cIndex)=>{this.set(rIndex,cIndex,selector(row,cell,isRowTemplate))})}),this.matrix}inValid(value){return 0===value||void 0===value}}class ej2_grids_es2015_ContentFocus{constructor(parent){this.matrix=new ej2_grids_es2015_Matrix,this.parent=parent,this.keyActions={rightArrow:[0,1],tab:[0,1],leftArrow:[0,-1],shiftTab:[0,-1],upArrow:[-1,0],downArrow:[1,0],shiftUp:[-1,0],shiftDown:[1,0],shiftRight:[0,1],shiftLeft:[0,-1],enter:[1,0],shiftEnter:[-1,0]},this.indexesByKey=action=>({home:[this.matrix.current[0],-1,0,1],end:[this.matrix.current[0],this.matrix.columns+1,0,-1],ctrlHome:[0,-1,0,1],ctrlEnd:[this.matrix.rows,this.matrix.columns+1,0,-1]})[action]||null}getTable(){return this.parent.frozenColumns?this.parent.getContent().querySelector(".e-movablecontent .e-table"):this.parent.getContentTable()}onKeyPress(e){let current=this.getCurrentFromAction(e.action,this.keyActions[e.action],e.action in this.keyActions,e);if(current){if((["tab","shiftTab"].indexOf(e.action)>-1&&this.matrix.current||[]).toString()===current.toString()){if(current.toString()===[this.matrix.rows,this.matrix.columns].toString()||current.toString()===[0,0].toString()||this.matrix.current[0]===this.matrix.rows&&this.matrix.current.toString()===current.toString())return!1;current=this.editNextRow(current[0],current[1],e.action)}this.matrix.select(current[0],current[1])}}editNextRow(rowIndex,cellIndex,action){let gObj=this.parent,editNextRow=gObj.editSettings.allowNextRowEdit&&(gObj.isEdit||gObj.isLastCellPrimaryKey),visibleIndex=gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);return"tab"===action&&editNextRow&&(rowIndex++,cellIndex=visibleIndex+(this.getTable().rows[rowIndex].querySelectorAll(".e-indentcell").length+this.getTable().rows[rowIndex].querySelectorAll(".e-detailrowcollapse").length)),"shiftTab"===action&&editNextRow&&(rowIndex--,cellIndex=gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length-1].field)),this.getTable().rows[rowIndex].cells[cellIndex].classList.contains("e-rowcell")?[rowIndex,cellIndex]:this.editNextRow(rowIndex,cellIndex,action)}getCurrentFromAction(action,navigator=[0,0],isPresent,e){if(!isPresent&&!this.indexesByKey(action)||0===this.matrix.current.length)return null;if(!this.shouldFocusChange(e))return this.matrix.current;let[rowIndex,cellIndex,rN,cN]=this.indexesByKey(action)||[...this.matrix.current,...navigator];return this.matrix.get(rowIndex,cellIndex,[rN,cN],action,this.validator())}onClick(e,force){let target=e.target;if(target=(target=target.classList.contains("e-rowcell")?target:closest(target,"td"))||closest(e.target,"td.e-detailrowcollapse")||closest(e.target,"td.e-detailrowexpand"),!(target=(target=closest(e.target,"td.e-detailcell")&&isNullOrUndefined(closest(closest(e.target,".e-grid"),"td.e-detailcell"))?null:target)&&closest(target,"table").classList.contains("e-table")?target:null))return!1;let[rowIndex,cellIndex]=[target.parentElement.rowIndex,target.cellIndex],[oRowIndex,oCellIndex]=this.matrix.current,val=getValue(`${rowIndex}.${cellIndex}`,this.matrix.matrix);if(this.matrix.inValid(val)||!force&&oRowIndex===rowIndex&&oCellIndex===cellIndex)return!1;this.matrix.select(rowIndex,cellIndex)}getFocusInfo(){let info={},[rowIndex=0,cellIndex=0]=this.matrix.current;return this.matrix.current=[rowIndex,cellIndex],info.element=isNullOrUndefined(this.getTable().rows[rowIndex])?null:this.getTable().rows[rowIndex].cells[cellIndex],info.element?(info.elementToFocus=info.element.classList.contains("e-unboundcell")||info.element.classList.contains("e-detailcell")?info.element:this.getFocusable(info.element),info.outline=!0,info.uid=info.element.parentElement.getAttribute("data-uid"),info):info}getFocusable(element){let query='button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])';this.parent.isEdit&&(query='input:not([type="hidden"]), select:not([aria-hidden="true"]), textarea');let child=[].slice.call(element.querySelectorAll(query));return child.length?child[0]:element}selector(row,cell,isRowTemplate){let types=[CellType.Expand,CellType.GroupCaption,CellType.CaptionSummary,CellType.GroupSummary];return(row.isDataRow&&cell.visible&&(cell.isDataCell||cell.isTemplate)||row.isDataRow&&cell.cellType===CellType.DetailExpand&&isNullOrUndefined(cell.visible)||!row.isDataRow&&types.indexOf(cell.cellType)>-1||cell.column&&"checkbox"===cell.column.type||cell.cellType===CellType.CommandColumn||row.isDataRow&&isRowTemplate)&&!("delete"===row.edit&&row.isDirty)}jump(action,current){let frozenSwap=this.parent.frozenColumns>0&&("leftArrow"===action||"shiftTab"===action)&&0===current[1],enterFrozen=0!==this.parent.frozenRows&&"shiftEnter"===action;return{swap:("upArrow"===action||enterFrozen)&&0===current[0]||frozenSwap,toHeader:("upArrow"===action||enterFrozen)&&0===current[0],toFrozen:frozenSwap}}getNextCurrent(previous=[],swap,active,action){let current=[];return"rightArrow"===action||"tab"===action?(current[0]=previous[0],current[1]=-1):"downArrow"!==action&&"enter"!==action||(current[0]=-1,current[1]=previous[1]),current}generateRows(rows,optionals){let{matrix:matrix,handlerInstance:handlerInstance}=optionals,len=handlerInstance.matrix.matrix.length,defaultLen=this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type?len+1:len;handlerInstance.matrix.matrix=handlerInstance.matrix.matrix.slice(0,defaultLen),handlerInstance.matrix.rows=defaultLen,handlerInstance.matrix.matrix.push(...matrix),handlerInstance.matrix.rows+=matrix.length}getInfo(e){let info=this.getFocusInfo(),[rIndex,cIndex]=this.matrix.current,isData=info.element.classList.contains("e-rowcell"),isSelectable=isData||e&&"enter"!==e.action&&(info.element.classList.contains("e-detailrowcollapse")||info.element.classList.contains("e-detailrowexpand")),[rowIndex,cellIndex]=[Math.min(parseInt(info.element.parentElement.getAttribute("aria-rowindex"),10),rIndex),Math.min(parseInt(info.element.getAttribute("aria-colindex"),10),cIndex)];return{isContent:!0,isDataCell:isData,indexes:[rowIndex,cellIndex],isSelectable:isSelectable}}validator(){let table=this.getTable();return(rowIndex,cellIndex,action)=>{let cell,isCellWidth=0!==(cell=table.rows[rowIndex].cells[0].classList.contains("e-editcell")?table.rows[rowIndex].cells[0].querySelectorAll("td")[cellIndex]:table.rows[rowIndex].cells[cellIndex]).getBoundingClientRect().width;return"enter"===action||"shiftEnter"===action?isCellWidth&&cell.classList.contains("e-rowcell"):"shiftUp"!==action&&"shiftDown"!==action||!cell.classList.contains("e-rowcell")?"shiftUp"!==action&&"shiftDown"!==action&&isCellWidth:isCellWidth}}shouldFocusChange(e){let[rIndex=-1,cIndex=-1]=this.matrix.current;if(rIndex<0||cIndex<0)return!0;let cell=getValue(`${rIndex}.cells.${cIndex}`,this.getTable().rows);return!cell||"enter"!==e.action&&"shiftEnter"!==e.action||cell.classList.contains("e-rowcell")&&!cell.classList.contains("e-unboundcell")&&!cell.classList.contains("e-templatecell")&&!cell.classList.contains("e-detailcell")}}class ej2_grids_es2015_HeaderFocus extends ej2_grids_es2015_ContentFocus{constructor(parent){super(parent)}getTable(){return this.parent.getFrozenColumns()?this.parent.getHeaderContent().querySelector(".e-movableheader .e-table"):this.parent.getHeaderTable()}onClick(e){let target=e.target;if((target=target.classList.contains("e-headercell")?target:closest(target,"th"))||0===this.parent.frozenRows||(target=e.target.classList.contains("e-rowcell")?e.target:closest(e.target,"td")),e.target.classList.contains("e-columnheader")||e.target.querySelector(".e-stackedheadercell"))return!1;if(!target)return;let[rowIndex,cellIndex]=[target.parentElement.rowIndex,target.cellIndex],val=getValue(`${rowIndex}.${cellIndex}`,this.matrix.matrix);if(this.matrix.inValid(val))return!1;this.matrix.select(target.parentElement.rowIndex,target.cellIndex)}getFocusInfo(){let info={},[rowIndex=0,cellIndex=0]=this.matrix.current;return info.element=this.getTable().rows[rowIndex].cells[cellIndex],info.elementToFocus=this.getFocusable(info.element),info.outline=!info.element.classList.contains("e-filterbarcell"),info}selector(row,cell){return cell.visible&&(void 0!==cell.column.field||cell.isTemplate)||"checkbox"===cell.column.type||cell.cellType===CellType.StackedHeader}jump(action,current){let frozenSwap=this.parent.frozenColumns>0&&("leftArrow"===action||"shiftTab"===action)&&0===current[1];return{swap:("downArrow"===action||0!==this.parent.frozenRows&&"enter"===action)&&current[0]===this.matrix.matrix.length-1||frozenSwap,toHeader:frozenSwap,toFrozen:frozenSwap}}getNextCurrent(previous=[],swap,active,action){let current1=[];return"upArrow"===action||"shiftEnter"===action?(current1[0]=this.matrix.matrix.length,current1[1]=previous[1]):"rightArrow"!==action&&"tab"!==action||(current1[0]=previous[0],current1[1]=-1),current1}generateRows(rows){let length=this.matrix.matrix.length;this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type&&(this.matrix.rows=++this.matrix.rows,rows[0].cells.forEach((cell,cIndex)=>this.matrix.set(length,cIndex,cell.visible&&!1!==cell.column.allowFiltering)))}getInfo(e){return extend(super.getInfo(e),{isContent:!1,isHeader:!0})}validator(){return()=>!0}shouldFocusChange(e){let[rowIndex,columnIndex]=this.matrix.current;if(rowIndex<0||columnIndex<0)return!0;let cell=getValue(`${rowIndex}.cells.${columnIndex}`,this.getTable().rows);return!cell||"enter"!==e.action&&"altDownArrow"!==e.action||!cell.classList.contains("e-headercell")}}class FixedContentFocus extends ej2_grids_es2015_ContentFocus{getTable(){return this.parent.getContent().querySelector(".e-frozencontent .e-table")}jump(action,current){let enterFrozen=0!==this.parent.frozenRows&&"shiftEnter"===action;return{swap:("upArrow"===action||enterFrozen)&&0===current[0]||("tab"===action||"rightArrow"===action)&&current[1]===this.matrix.columns,toHeader:("upArrow"===action||enterFrozen)&&0===current[0],toFrozen:("upArrow"===action||enterFrozen)&&0===current[0]}}getNextCurrent(previous=[],swap,active,action){let current2=[];return"leftArrow"===action||"shiftTab"===action?(current2[0]=previous[0],current2[1]=active.matrix.columns+1):"downArrow"!==action&&"enter"!==action||(current2[0]=-1,current2[1]=previous[1]),current2}}class FixedHeaderFocus extends ej2_grids_es2015_HeaderFocus{jump(action,current){let enterFrozen=0!==this.parent.frozenRows&&"enter"===action;return{swap:("downArrow"===action||enterFrozen)&&current[0]===this.matrix.matrix.length-1||("rightArrow"===action||"tab"===action)&&current[1]===this.matrix.columns,toHeader:("rightArrow"===action||"tab"===action)&&current[1]===this.matrix.columns,toFrozen:("downArrow"===action||enterFrozen)&&current[0]===this.matrix.matrix.length-1}}getTable(){return this.parent.getHeaderContent().querySelector(".e-frozenheader .e-table")}getNextCurrent(previous=[],swap,active,action){let current3=[];return"leftArrow"===action||"shiftTab"===action?(current3[0]=previous[0],current3[1]=active.matrix.columns+1):"upArrow"!==action&&"shiftEnter"!==action||(current3[0]=this.matrix.matrix.length,current3[1]=previous[1]),current3}}class ej2_grids_es2015_SearchBox{constructor(searchBox){this.searchBox=searchBox}searchFocus(args){args.target.parentElement.classList.add("e-input-focus")}searchBlur(args){args.target.parentElement.classList.remove("e-input-focus")}wireEvent(){this.searchBox&&(EventHandler.add(this.searchBox,"focus",this.searchFocus,this),EventHandler.add(this.searchBox,"blur",this.searchBlur,this))}unWireEvent(){this.searchBox&&(EventHandler.remove(this.searchBox,"focus",this.searchFocus),EventHandler.remove(this.searchBox,"blur",this.searchBlur))}}let ej2_grids_es2015_PageSettings=(()=>{class PageSettings extends ChildProperty{}return __decorate([Property(12)],PageSettings.prototype,"pageSize",void 0),__decorate([Property(8)],PageSettings.prototype,"pageCount",void 0),__decorate([Property(1)],PageSettings.prototype,"currentPage",void 0),__decorate([Property()],PageSettings.prototype,"totalRecordsCount",void 0),__decorate([Property(!1)],PageSettings.prototype,"enableQueryString",void 0),__decorate([Property(!1)],PageSettings.prototype,"pageSizes",void 0),__decorate([Property(null)],PageSettings.prototype,"template",void 0),PageSettings})();class ej2_grids_es2015_Selection{constructor(parent,selectionSettings,locator){this.selectedRowIndexes=[],this.selectedRowCellIndexes=[],this.selectedRecords=[],this.preventFocus=!1,this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1,this.enableSelectMultiTouch=!1,this.selectedRowState={},this.totalRecordsCount=0,this.chkAllCollec=[],this.isCheckedOnAdd=!1,this.persistSelectedData=[],this.isCancelDeSelect=!1,this.isPreventCellSelect=!1,this.disableUI=!1,this.isPersisted=!1,this.cmdKeyPressed=!1,this.parent=parent,this.selectionSettings=selectionSettings,this.factory=locator.getService("rendererFactory"),this.focus=locator.getService("focus"),this.addEventListener(),this.wireEvents()}initializeSelection(){this.parent.log("selection_key_missing"),EventHandler.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this)}onActionBegin(args,type){this.parent.trigger(type,this.fDataUpdate(args))}fDataUpdate(args){if(args.cellIndex||args.rowIndex){let rowObj=this.getRowObj(isNullOrUndefined(args.rowIndex)?isNullOrUndefined(args.cellIndex)?this.currentIndex:args.cellIndex.rowIndex:args.rowIndex);args.foreignKeyData=rowObj.foreignKeyData}return args}onActionComplete(args,type){this.parent.trigger(type,this.fDataUpdate(args))}getModuleName(){return"selection"}destroy(){let gridElement=this.parent.element;gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.hidePopUp(),this.clearSelection(),this.removeEventListener(),this.unWireEvents(),EventHandler.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler))}isEditing(){return("Normal"===this.parent.editSettings.mode||"Batch"===this.parent.editSettings.mode&&this.parent.editModule&&this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate())&&this.parent.isEdit&&!this.parent.isPersistSelection}getSelectedMovableRow(index){let gObj=this.parent;return gObj.getFrozenColumns()?gObj.getMovableRowByIndex(index):null}getCurrentBatchRecordChanges(){let gObj=this.parent;if("Batch"===gObj.editSettings.mode&&gObj.editModule){let currentRecords=iterateExtend(this.parent.getCurrentViewRecords());currentRecords=this.parent.editModule.getBatchChanges().addedRecords.concat(currentRecords);let deletedRecords=this.parent.editModule.getBatchChanges().deletedRecords,primaryKey=this.parent.getPrimaryKeyFieldNames()[0];for(let i=0;i<deletedRecords.length;i++)for(let j=0;j<currentRecords.length;j++)if(deletedRecords[i][primaryKey]===currentRecords[j][primaryKey]){currentRecords.splice(j,1);break}return currentRecords}return gObj.getCurrentViewRecords()}selectRow(index,isToggle){if(this.selectedRowIndexes.length&&this.selectionSettings.enableSimpleMultiRowSelection)return void this.addRowsToSelection([index]);let selectData,gObj=this.parent,selectedRow=gObj.getRowByIndex(index),selectedMovableRow=this.getSelectedMovableRow(index),isRemoved=!1;if(gObj.enableVirtualization&&index>-1){if(!selectedRow)return this.parent.getSelectedRecords().length>0&&this.clearRowSelection(),void this.parent.notify(selectVirtualRow,{selectedIndex:index});selectData=gObj.getRowObjectFromUID(selectedRow.getAttribute("data-uid")).data}else selectData=this.getCurrentBatchRecordChanges()[index];if(!this.isRowType()||!selectedRow||this.isEditing())return;let args,isRowSelected=selectedRow.hasAttribute("aria-selected");(isToggle=isToggle?!!this.selectedRowIndexes.length&&1===this.selectedRowIndexes.length&&index===this.selectedRowIndexes[0]:isToggle)||(args={data:selectData,rowIndex:index,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,row:selectedRow,previousRow:gObj.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,cancel:!1},args=this.addMovableArgs(args,selectedMovableRow),this.onActionBegin(args,rowSelecting)),(isNullOrUndefined(args)||!0!==args.cancel)&&(isRowSelected&&this.selectionSettings.persistSelection&&(this.clearSelectedRow(index),isRemoved=!0),this.selectionSettings.persistSelection||this.clearRow(),isToggle||isRemoved||(this.selectedRowIndexes.indexOf(index)<=-1&&(this.updateRowSelection(selectedRow,index),gObj.getFrozenColumns()&&this.updateRowSelection(selectedMovableRow,index)),this.selectRowIndex(index)),isToggle||(args={data:selectData,rowIndex:index,row:selectedRow,previousRow:gObj.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget},args=this.addMovableArgs(args,selectedMovableRow),this.onActionComplete(args,rowSelected)),this.updateRowProps(index))}addMovableArgs(targetObj,mRow){if(this.parent.getFrozenColumns()){let mObj={mRow:mRow,previousMovRow:this.parent.getMovableRows()[this.prevRowIndex]};targetObj=Object.assign({},targetObj,mObj)}return targetObj}selectRowsByRange(startIndex,endIndex){this.selectRows(this.getCollectionFromIndexes(startIndex,endIndex)),this.selectRowIndex(endIndex)}selectRows(rowIndexes){let gObj=this.parent,rowIndex=this.isSingleSel()?rowIndexes[rowIndexes.length-1]:rowIndexes[0],selectedRow=gObj.getRowByIndex(rowIndex),selectedMovableRow=this.getSelectedMovableRow(rowIndex),frzCols=gObj.getFrozenColumns(),selectedData=this.getCurrentBatchRecordChanges()[rowIndexes[0]];if(!this.isRowType()||this.isEditing())return;let args={rowIndexes:rowIndexes,row:selectedRow,rowIndex:rowIndex,target:this.actualTarget,prevRow:gObj.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:selectedData};if(args=this.addMovableArgs(args,selectedMovableRow),this.onActionBegin(args,rowSelecting),isNullOrUndefined(args)||!0!==args.cancel){if(this.clearRow(),this.selectRowIndex(rowIndexes.slice(-1)[0]),this.isSingleSel())this.updateRowSelection(gObj.getRowByIndex(rowIndex),rowIndex),frzCols&&this.updateRowSelection(gObj.getMovableRowByIndex(rowIndex),rowIndex),this.updateRowProps(rowIndex);else for(let rowIdx of rowIndexes)this.updateRowSelection(gObj.getRowByIndex(rowIdx),rowIdx),frzCols&&this.updateRowSelection(gObj.getMovableRowByIndex(rowIdx),rowIdx),this.updateRowProps(rowIndex);args={rowIndexes:rowIndexes,row:selectedRow,rowIndex:rowIndex,target:this.actualTarget,prevRow:gObj.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,data:selectedData},args=this.addMovableArgs(args,selectedMovableRow),this.onActionComplete(args,rowSelected)}}addRowsToSelection(rowIndexes){let args,gObj=this.parent,target=this.target,selectedRow=this.isSingleSel()?gObj.getRowByIndex(rowIndexes[rowIndexes.length-1]):gObj.getRowByIndex(rowIndexes[0]),selectedMovableRow=this.isSingleSel()?this.getSelectedMovableRow(rowIndexes[rowIndexes.length-1]):this.getSelectedMovableRow(rowIndexes[0]),frzCols=gObj.getFrozenColumns();if(!this.isRowType()||this.isEditing())return;let checkboxColumn=this.parent.getColumns().filter(col=>"checkbox"===col.type);for(let rowIndex of rowIndexes){let rowObj=this.getRowObj(rowIndex),isUnSelected=this.selectedRowIndexes.indexOf(rowIndex)>-1;if(this.selectRowIndex(rowIndex),isUnSelected&&(checkboxColumn.length||this.selectionSettings.enableToggle||this.isMultiCtrlRequest)){if(this.rowDeselect(rowDeselecting,[rowIndex],[rowObj.data],[selectedRow],[rowObj.foreignKeyData],target),this.isCancelDeSelect)return;this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(rowIndex),1),this.selectedRecords.splice(this.selectedRecords.indexOf(selectedRow),1),selectedRow.removeAttribute("aria-selected"),this.addRemoveClassesForRow(selectedRow,!1,null,"e-selectionbackground","e-active"),selectedMovableRow&&(this.selectedRecords.splice(this.selectedRecords.indexOf(selectedMovableRow),1),selectedMovableRow.removeAttribute("aria-selected"),this.addRemoveClassesForRow(selectedMovableRow,!1,null,"e-selectionbackground","e-active")),this.rowDeselect(rowDeselected,[rowIndex],[rowObj.data],[selectedRow],[rowObj.foreignKeyData],target,[selectedMovableRow]),this.isInteracted=!1}else{if(args={data:rowObj.data,rowIndex:rowIndex,row:selectedRow,target:this.actualTarget,prevRow:gObj.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,foreignKeyData:rowObj.foreignKeyData},args=this.addMovableArgs(args,selectedMovableRow),this.onActionBegin(args,rowSelecting),!isNullOrUndefined(args)&&!0===args.cancel)return;this.isSingleSel()&&this.clearRow(),this.updateRowSelection(selectedRow,rowIndex),frzCols&&this.updateRowSelection(selectedMovableRow,rowIndex)}if(isUnSelected||(args={data:rowObj.data,rowIndex:rowIndex,row:selectedRow,target:this.actualTarget,prevRow:gObj.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,foreignKeyData:rowObj.foreignKeyData},args=this.addMovableArgs(args,selectedMovableRow),this.onActionComplete(args,rowSelected)),this.updateRowProps(rowIndex),this.isSingleSel())break}}getCollectionFromIndexes(startIndex,endIndex){let indexes=[],{i:i,max:max}=startIndex<=endIndex?{i:startIndex,max:endIndex}:{i:endIndex,max:startIndex};for(;i<=max;i++)indexes.push(i);return startIndex>endIndex&&indexes.reverse(),indexes}clearRow(){this.clearRowSelection(),this.isCancelDeSelect&&"Check"!==this.parent.checkAllRows||(this.selectedRowIndexes=[],this.selectedRecords=[],this.selectRowIndex(-1),this.isSingleSel()&&this.parent.isPersistSelection&&(this.selectedRowState={}))}clearSelectedRow(index){if(this.target){let selectedEle=this.target.parentElement;this.disableUI||(selectedEle.removeAttribute("aria-selected"),this.addRemoveClassesForRow(selectedEle,!1,!0,"e-selectionbackground","e-active")),this.updatePersistCollection(selectedEle,!1),this.updateCheckBoxes(selectedEle),this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(index),1),this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(index)),1)}}updateRowProps(startIndex){this.prevRowIndex=startIndex,this.isRowSelected=this.selectedRowIndexes.length&&!0}updatePersistCollection(selectedRow,chkState){if(this.parent.isPersistSelection&&!isNullOrUndefined(selectedRow)){let rowObj=this.getRowObj(selectedRow),pKey=rowObj.data?rowObj.data[this.primaryKey]:null;if(null===pKey)return;rowObj.isSelected=chkState,chkState?(this.selectedRowState[pKey]=chkState,this.persistSelectedData.some(data=>data[this.primaryKey]===pKey)||this.persistSelectedData.push(rowObj.data)):this.updatePersistDelete(pKey)}}updatePersistDelete(pKey){let index;delete this.selectedRowState[pKey],this.persistSelectedData.some((data,i)=>(index=i,data[this.primaryKey]===pKey))&&this.persistSelectedData.splice(index,1)}updateCheckBoxes(row,chkState,rowIndex){if(!isNullOrUndefined(row)){let chkBox=row.querySelector(".e-checkselect");isNullOrUndefined(chkBox)||(removeAddCboxClasses(chkBox.nextElementSibling,chkState),(isNullOrUndefined(this.checkedTarget)||!isNullOrUndefined(this.checkedTarget)&&!this.checkedTarget.classList.contains("e-checkselectall"))&&this.setCheckAllState(rowIndex))}}updateRowSelection(selectedRow,startIndex){if(!selectedRow)return;this.selectedRowIndexes.push(startIndex);let len=this.selectedRowIndexes.length;if(this.parent.getFrozenColumns()&&len>1&&this.selectedRowIndexes[len-2]===this.selectedRowIndexes[len-1]&&this.selectedRowIndexes.pop(),this.selectedRecords.push(selectedRow),selectedRow.setAttribute("aria-selected","true"),this.updatePersistCollection(selectedRow,!0),this.updateCheckBoxes(selectedRow,!0),this.addRemoveClassesForRow(selectedRow,!0,null,"e-selectionbackground","e-active"),!this.preventFocus){let target=this.focus.getPrevIndexes().cellIndex?selectedRow.cells[this.focus.getPrevIndexes().cellIndex]:selectedRow.querySelector(".e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)");if(!target)return;this.focus.onClick({target:target},!0)}}clearSelection(){if(!this.parent.isPersistSelection||this.parent.isPersistSelection&&!this.parent.isEdit||!isNullOrUndefined(this.checkedTarget)&&this.checkedTarget.classList.contains("e-checkselectall")){let span=this.parent.element.querySelector(".e-gridpopup").querySelector("span");span.classList.contains("e-rowselect")&&span.classList.remove("e-spanclicked"),this.isInteracted=!1,this.parent.isPersistSelection&&(this.persistSelectedData=[],this.selectedRowState={}),this.clearRowSelection(),this.clearCellSelection(),this.enableSelectMultiTouch=!1}}clearRowSelection(){if(this.isRowSelected){let gObj=this.parent,rows=this.parent.getDataRows(),data=[],row=[],mRow=[],rowIndex=[],frzCols=gObj.getFrozenColumns(),foreignKeyData$$1=[],target=this.target;this.parent.getCurrentViewRecords();for(let i=0,len=this.selectedRowIndexes.length;i<len;i++){let currentRow="Batch"===this.parent.editSettings.mode?this.parent.getRows()[this.selectedRowIndexes[i]]:this.parent.getDataRows()[this.selectedRowIndexes[i]],rowObj=this.getRowObj(currentRow);rowObj&&(data.push(rowObj.data),row.push(currentRow),rowIndex.push(this.selectedRowIndexes[i]),foreignKeyData$$1.push(rowObj.foreignKeyData)),frzCols&&mRow.push(gObj.getMovableRows()[this.selectedRowIndexes[i]])}if(this.selectionSettings.persistSelection&&(this.isInteracted=!!this.checkSelectAllClicked),this.rowDeselect(rowDeselecting,rowIndex,data,row,foreignKeyData$$1,target,mRow),this.isCancelDeSelect&&(this.isInteracted||this.checkSelectAllClicked)){if(this.parent.isPersistSelection)if("Intermediate"===this.getCheckAllStatus(this.parent.element.querySelector(".e-checkselectall")))for(let i=0;i<this.selectedRecords.length;i++)this.updatePersistCollection(this.selectedRecords[i],!0);else this.parent.checkAllRows="Check",this.updatePersistSelectedData(!0);return}rows.filter(record=>record.hasAttribute("aria-selected")).forEach(ele=>{this.disableUI||(ele.removeAttribute("aria-selected"),this.addRemoveClassesForRow(ele,!1,!0,"e-selectionbackground","e-active")),this.updatePersistCollection(ele,!1),this.updateCheckBoxes(ele)});for(let i=0,len=this.selectedRowIndexes.length;i<len;i++){let movableRow=this.getSelectedMovableRow(this.selectedRowIndexes[i]);movableRow&&(this.disableUI||(movableRow.removeAttribute("aria-selected"),this.addRemoveClassesForRow(movableRow,!1,!0,"e-selectionbackground","e-active")),this.updatePersistCollection(movableRow,!1))}this.selectedRowIndexes=[],this.selectedRecords=[],this.isRowSelected=!1,this.selectRowIndex(-1),this.rowDeselect(rowDeselected,rowIndex,data,row,foreignKeyData$$1,target,mRow),this.isInteracted=!1}}rowDeselect(type,rowIndex,data,row,foreignKeyData$$1,target,mRow){if(this.selectionSettings.persistSelection&&this.isInteracted||!this.selectionSettings.persistSelection){let cancl="cancel",rowDeselectObj={rowIndex:rowIndex,data:data,foreignKeyData:foreignKeyData$$1,cancel:!1,target:target,isInteracted:this.isInteracted};if(!isBlazor()||this.parent.isJsComponent)rowDeselectObj.row=row;else{let rowIndex="rowIndex",data="data";rowDeselectObj[rowIndex]=rowDeselectObj[rowIndex][rowDeselectObj[rowIndex].length-1],rowDeselectObj[data]=rowDeselectObj[data][rowDeselectObj[data].length-1]}this.parent.trigger(type,this.parent.getFrozenColumns()?Object.assign({},rowDeselectObj,{mRow:mRow}):rowDeselectObj),this.isCancelDeSelect=rowDeselectObj[cancl],this.isCancelDeSelect&&(this.isInteracted||this.checkSelectAllClicked)||(this.updatePersistCollection(row[0],!1),this.updateCheckBoxes(row[0],void 0,rowIndex[0]))}}getRowObj(row=this.currentIndex){return isNullOrUndefined(row)?{}:("number"==typeof row&&(row=this.parent.getRowByIndex(row)),row&&this.parent.getRowObjectFromUID(row.getAttribute("data-uid"))||{})}getSelectedMovableCell(cellIndex){let gObj=this.parent,frzCols=gObj.getFrozenColumns();return frzCols&&cellIndex.cellIndex>=frzCols?gObj.getMovableCellFromIndex(cellIndex.rowIndex,this.getColIndex(cellIndex.rowIndex,cellIndex.cellIndex)):null}selectCell(cellIndex,isToggle){if(!this.isCellType())return;let args,gObj=this.parent,selectedCell=this.getSelectedMovableCell(cellIndex);selectedCell||(selectedCell=gObj.getCellFromIndex(cellIndex.rowIndex,this.getColIndex(cellIndex.rowIndex,cellIndex.cellIndex))),this.currentIndex=cellIndex.rowIndex;let selectedData=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isCellType()||!selectedCell||this.isEditing())return;let isCellSelected=selectedCell.classList.contains("e-cellselectionbackground");(isToggle=isToggle?!isUndefined(this.prevCIdxs)&&cellIndex.rowIndex===this.prevCIdxs.rowIndex&&cellIndex.cellIndex===this.prevCIdxs.cellIndex&&isCellSelected:isToggle)?this.successCallBack(args,isToggle,cellIndex,selectedCell,selectedData)(args):(args={data:selectedData,cellIndex:cellIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,cancel:!1},(!isBlazor()||this.parent.isJsComponent)&&(args.currentCell=selectedCell,args.previousRowCellIndex=this.prevECIdxs),this.parent.trigger(cellSelecting,this.fDataUpdate(args),this.successCallBack(args,isToggle,cellIndex,selectedCell,selectedData)))}successCallBack(cellSelectingArgs,isToggle,cellIndex,selectedCell,selectedData){return cellSelectingArgs=>{if((isNullOrUndefined(cellSelectingArgs)||!0!==cellSelectingArgs.cancel)&&(isToggle||(cellSelectingArgs.currentCell=cellSelectingArgs.currentCell?cellSelectingArgs.currentCell:selectedCell),this.clearCell(),isToggle||this.updateCellSelection(selectedCell,cellIndex.rowIndex,cellIndex.cellIndex),this.updateCellProps(cellIndex,cellIndex),!isToggle)){let args={data:selectedData,cellIndex:cellIndex,currentCell:selectedCell,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};isBlazor()||(args.previousRowCellIndex=this.prevECIdxs),this.onActionComplete(args,cellSelected)}}}getCellIndex(rIdx,cIdx){return this.parent.getFrozenColumns()&&cIdx>=this.parent.getFrozenColumns()?this.parent.getMovableCellFromIndex(rIdx,cIdx):this.parent.getCellFromIndex(rIdx,cIdx)}selectCellsByRange(startIndex,endIndex){if(!this.isCellType())return;let min,max,gObj=this.parent,selectedCell=this.getSelectedMovableCell(startIndex),frzCols=gObj.getFrozenColumns();selectedCell||(selectedCell=gObj.getCellFromIndex(startIndex.rowIndex,startIndex.cellIndex));let cellIndexes,stIndex=startIndex,edIndex=endIndex=endIndex||startIndex;this.currentIndex=startIndex.rowIndex;let selectedData=this.getCurrentBatchRecordChanges()[this.currentIndex];if(this.isSingleSel()||!this.isCellType()||this.isEditing())return;let args={data:selectedData,cellIndex:startIndex,currentCell:selectedCell,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};isBlazor()||(args.previousRowCellIndex=this.prevECIdxs),this.parent.trigger(cellSelecting,this.fDataUpdate(args),cellSelectingArgs=>{if(!isNullOrUndefined(cellSelectingArgs)&&!0===cellSelectingArgs.cancel)return;if(this.clearCell(),startIndex.rowIndex>endIndex.rowIndex){let temp=startIndex;startIndex=endIndex,endIndex=temp}for(let i=startIndex.rowIndex;i<=endIndex.rowIndex;i++){this.selectionSettings.cellSelectionMode.indexOf("Box")<0?(min=i===startIndex.rowIndex?startIndex.cellIndex:0,max=i===endIndex.rowIndex?endIndex.cellIndex:this.getLastColIndex(i)):(min=startIndex.cellIndex,max=endIndex.cellIndex),cellIndexes=[];for(let j=min<max?min:max,len=min>max?min:max;j<=len;j++)(selectedCell=frzCols?j<frzCols?gObj.getCellFromIndex(i,j):gObj.getMovableCellFromIndex(i,j):gObj.getCellFromIndex(i,j))&&(cellIndexes.push(j),this.updateCellSelection(selectedCell),this.addAttribute(selectedCell));this.selectedRowCellIndexes.push({rowIndex:i,cellIndexes:cellIndexes})}this.updateCellProps(stIndex,edIndex);let cellSelectedArgs={data:selectedData,cellIndex:startIndex,currentCell:selectedCell,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};isBlazor()||(cellSelectedArgs.previousRowCellIndex=this.prevECIdxs),this.onActionComplete(cellSelectedArgs,cellSelected)})}selectCells(rowCellIndexes){if(!this.isCellType())return;let gObj=this.parent,selectedCell=this.getSelectedMovableCell(rowCellIndexes[0]),frzCols=gObj.getFrozenColumns();selectedCell||(selectedCell=gObj.getCellFromIndex(rowCellIndexes[0].rowIndex,rowCellIndexes[0].cellIndexes[0])),this.currentIndex=rowCellIndexes[0].rowIndex;let selectedData=this.getCurrentBatchRecordChanges()[this.currentIndex];if(this.isSingleSel()||!this.isCellType()||this.isEditing())return;let cellSelectArgs={data:selectedData,cellIndex:rowCellIndexes[0].cellIndexes[0],currentCell:selectedCell,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};isBlazor()||(cellSelectArgs.previousRowCellIndex=this.prevECIdxs),this.onActionBegin(cellSelectArgs,cellSelecting);for(let i=0,len=rowCellIndexes.length;i<len;i++)for(let j=0,cellLen=rowCellIndexes[i].cellIndexes.length;j<cellLen;j++)(selectedCell=frzCols?rowCellIndexes[i].cellIndexes[j]<frzCols?gObj.getCellFromIndex(rowCellIndexes[i].rowIndex,rowCellIndexes[i].cellIndexes[j]):gObj.getMovableCellFromIndex(rowCellIndexes[i].rowIndex,rowCellIndexes[i].cellIndexes[j]):gObj.getCellFromIndex(rowCellIndexes[i].rowIndex,rowCellIndexes[i].cellIndexes[j]))&&(this.updateCellSelection(selectedCell),this.addAttribute(selectedCell),this.addRowCellIndex({rowIndex:rowCellIndexes[i].rowIndex,cellIndex:rowCellIndexes[i].cellIndexes[j]}));this.updateCellProps({rowIndex:rowCellIndexes[0].rowIndex,cellIndex:rowCellIndexes[0].cellIndexes[0]},{rowIndex:rowCellIndexes[0].rowIndex,cellIndex:rowCellIndexes[0].cellIndexes[0]});let cellSelectedArgs={data:selectedData,cellIndex:rowCellIndexes[0].cellIndexes[0],currentCell:selectedCell,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};isBlazor()||(cellSelectedArgs.previousRowCellIndex=this.prevECIdxs),this.onActionComplete(cellSelectedArgs,cellSelected)}addCellsToSelection(cellIndexes){if(!this.isCellType())return;let selectedCell,index,gObj=this.parent,frzCols=gObj.getFrozenColumns();this.currentIndex=cellIndexes[0].rowIndex;let rowObj,selectedData=this.getCurrentBatchRecordChanges()[this.currentIndex];if(this.isSingleSel()||!this.isCellType()||this.isEditing())return;this.hideAutoFill(),rowObj=frzCols&&cellIndexes[0].cellIndex>=frzCols?gObj.getMovableRowsObject()[cellIndexes[0].rowIndex]:this.getRowObj(cellIndexes[0].rowIndex);let foreignKeyData$$1=[];for(let cellIndex of cellIndexes){for(let i=0,len=this.selectedRowCellIndexes.length;i<len;i++)if(this.selectedRowCellIndexes[i].rowIndex===cellIndex.rowIndex){index=i;break}(selectedCell=this.getSelectedMovableCell(cellIndex))||(selectedCell=gObj.getCellFromIndex(cellIndex.rowIndex,this.getColIndex(cellIndex.rowIndex,cellIndex.cellIndex))),foreignKeyData$$1.push(rowObj.cells[frzCols&&cellIndexes[0].cellIndex>=frzCols?cellIndex.cellIndex-frzCols:cellIndex.cellIndex].foreignKeyData);let args={data:selectedData,cellIndex:cellIndexes[0],isShiftPressed:this.isMultiShiftRequest,currentCell:selectedCell,isCtrlPressed:this.isMultiCtrlRequest,previousRowCell:this.prevECIdxs?gObj.getCellFromIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};isBlazor()||(args.previousRowCellIndex=this.prevECIdxs);let isUnSelected=index>-1;if(isUnSelected){let selectedCellIdx=this.selectedRowCellIndexes[index].cellIndexes;selectedCellIdx.indexOf(cellIndex.cellIndex)>-1?(this.cellDeselect(cellDeselecting,[{rowIndex:cellIndex.rowIndex,cellIndexes:[cellIndex.cellIndex]}],selectedData,[selectedCell],foreignKeyData$$1),selectedCellIdx.splice(selectedCellIdx.indexOf(cellIndex.cellIndex),1),0===selectedCellIdx.length&&this.selectedRowCellIndexes.splice(index,1),selectedCell.classList.remove("e-cellselectionbackground"),selectedCell.removeAttribute("aria-selected"),this.cellDeselect(cellDeselected,[{rowIndex:cellIndex.rowIndex,cellIndexes:[cellIndex.cellIndex]}],selectedData,[selectedCell],foreignKeyData$$1)):(isUnSelected=!1,this.onActionBegin(args,cellSelecting),this.addRowCellIndex({rowIndex:cellIndex.rowIndex,cellIndex:cellIndex.cellIndex}),this.updateCellSelection(selectedCell),this.addAttribute(selectedCell))}else this.onActionBegin(args,cellSelecting),this.updateCellSelection(selectedCell,cellIndex.rowIndex,cellIndex.cellIndex);if(this.updateCellProps(cellIndex,cellIndex),!isUnSelected){let cellSelectedArgs={data:selectedData,cellIndex:cellIndexes[0],currentCell:selectedCell,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,selectedRowCellIndex:this.selectedRowCellIndexes};isBlazor()||(cellSelectedArgs.previousRowCellIndex=this.prevECIdxs),this.onActionComplete(cellSelectedArgs,cellSelected)}}}getColIndex(rowIndex,index){let cells,frzCols=this.parent.getFrozenColumns();if(frzCols&&index>=frzCols&&(cells=this.parent.getMovableDataRows()[rowIndex]&&this.parent.getMovableDataRows()[rowIndex].querySelectorAll("td.e-rowcell")),cells||(cells=this.parent.getDataRows()[rowIndex]&&this.parent.getDataRows()[rowIndex].querySelectorAll("td.e-rowcell")),cells)for(let m=0;m<cells.length;m++)if(parseInt(cells[m].getAttribute("aria-colindex"),10)===index)return frzCols&&index>=frzCols&&(m+=frzCols),m;return-1}getLastColIndex(rowIndex){let cells=this.parent.getFrozenColumns()?this.parent.getMovableDataRows()[rowIndex].querySelectorAll("td.e-rowcell"):this.parent.getDataRows()[rowIndex].querySelectorAll("td.e-rowcell");return parseInt(cells[cells.length-1].getAttribute("aria-colindex"),10)}clearCell(){this.clearCellSelection()}cellDeselect(type,cellIndexes,data,cells,foreignKeyData$$1){cells[0]&&cells[0].classList.contains("e-gridchkbox")&&this.updateCheckBoxes(closest(cells[0],"tr"));let args={cells:cells,data:data,cellIndexes:cellIndexes,foreignKeyData:foreignKeyData$$1,cancel:!1};this.parent.trigger(type,args),this.isPreventCellSelect=args.cancel}updateCellSelection(selectedCell,rowIndex,cellIndex){isNullOrUndefined(rowIndex)||this.addRowCellIndex({rowIndex:rowIndex,cellIndex:cellIndex}),selectedCell.classList.add("e-cellselectionbackground"),selectedCell.classList.contains("e-gridchkbox")&&this.updateCheckBoxes(closest(selectedCell,"tr"),!0),this.addAttribute(selectedCell)}addAttribute(cell){this.target=cell,isNullOrUndefined(cell)||(cell.setAttribute("aria-selected","true"),this.preventFocus||this.focus.onClick({target:cell},!0))}updateCellProps(startIndex,endIndex){this.prevCIdxs=startIndex,this.prevECIdxs=endIndex,this.isCellSelected=this.selectedRowCellIndexes.length&&!0}addRowCellIndex(rowCellIndex){let isRowAvail,index;for(let i=0,len=this.selectedRowCellIndexes.length;i<len;i++)if(this.selectedRowCellIndexes[i].rowIndex===rowCellIndex.rowIndex){isRowAvail=!0,index=i;break}isRowAvail?this.selectedRowCellIndexes[index].cellIndexes.indexOf(rowCellIndex.cellIndex)<0&&this.selectedRowCellIndexes[index].cellIndexes.push(rowCellIndex.cellIndex):this.selectedRowCellIndexes.push({rowIndex:rowCellIndex.rowIndex,cellIndexes:[rowCellIndex.cellIndex]})}clearCellSelection(){if(this.isCellSelected){let gObj=this.parent,selectedCells=this.getSelectedCellsElement(),rowCell=this.selectedRowCellIndexes,data=[],cells=[],foreignKeyData$$1=[],currentViewData=this.getCurrentBatchRecordChanges(),frzCols=gObj.getFrozenColumns();this.hideAutoFill();for(let i=0,len=rowCell.length;i<len;i++){data.push(currentViewData[rowCell[i].rowIndex]);let rowObj=this.getRowObj(rowCell[i].rowIndex);for(let j=0,cLen=rowCell[i].cellIndexes.length;j<cLen;j++)frzCols?cells.push(rowCell[i].cellIndexes[j]<frzCols?gObj.getCellFromIndex(rowCell[i].rowIndex,rowCell[i].cellIndexes[j]):gObj.getMovableCellFromIndex(rowCell[i].rowIndex,rowCell[i].cellIndexes[j])):(rowObj.cells&&foreignKeyData$$1.push(rowObj.cells[rowCell[i].cellIndexes[j]].foreignKeyData),cells.push(gObj.getCellFromIndex(rowCell[i].rowIndex,rowCell[i].cellIndexes[j])))}if(this.cellDeselect(cellDeselecting,rowCell,data,cells,foreignKeyData$$1),!0===this.isPreventCellSelect)return;for(let i=0,len=selectedCells.length;i<len;i++)selectedCells[i].classList.remove("e-cellselectionbackground"),selectedCells[i].removeAttribute("aria-selected");this.bdrBottom&&this.hideBorders(),this.selectedRowCellIndexes=[],this.isCellSelected=!1,this.cellDeselect(cellDeselected,rowCell,data,cells,foreignKeyData$$1)}}getSelectedCellsElement(){let mRows,gObj=this.parent,rows=gObj.getDataRows();gObj.getFrozenColumns()&&(mRows=gObj.getMovableDataRows(),rows=gObj.addMovableRows(rows,mRows));let cells=[];for(let i=0,len=rows.length;i<len;i++)cells=cells.concat([].slice.call(rows[i].querySelectorAll(".e-cellselectionbackground")));return cells}mouseMoveHandler(e){e.preventDefault();let tmp,gBRect=this.parent.element.getBoundingClientRect(),x1=this.x,y1=this.y,position=getPosition(e),x2=position.x-gBRect.left,y2=position.y-gBRect.top,target=closest(e.target,"tr");if(this.isDragged=!0,this.isCellDrag||(target||(target=closest(document.elementFromPoint(this.parent.element.offsetLeft+2,e.clientY),"tr")),x1>x2&&(tmp=x2,x2=x1,x1=tmp),y1>y2&&(tmp=y2,y2=y1,y1=tmp),this.element.style.left=x1+"px",this.element.style.top=y1+"px",this.element.style.width=x2-x1+"px",this.element.style.height=y2-y1+"px"),target&&!e.ctrlKey&&!e.shiftKey){let rowIndex=parseInt(target.getAttribute("aria-rowindex"),10);if(this.isCellDrag){let td=parentsUntil(e.target,"e-rowcell");td&&(this.startAFCell=this.startCell,this.endAFCell=parentsUntil(e.target,"e-rowcell"),this.selectLikeExcel(e,rowIndex,parseInt(td.getAttribute("aria-colindex"),10)))}else this.hideAutoFill(),this.selectRowsByRange(this.startDIndex,rowIndex)}}selectLikeExcel(e,rowIndex,cellIndex){this.isAutoFillSel?(this.showAFBorders(),this.selectLikeAutoFill(e)):(this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:rowIndex,cellIndex:cellIndex}),this.drawBorders())}drawBorders(){"BoxWithBorder"===this.selectionSettings.cellSelectionMode&&this.selectedRowCellIndexes.length&&!this.parent.isEdit?(this.bdrBottom||this.createBorders(),this.positionBorders()):this.hideBorders()}positionBorders(){if(this.updateStartEndCells(),!this.startCell||!this.bdrLeft||!this.selectedRowCellIndexes.length)return;this.showBorders();let stOff=this.startCell.getBoundingClientRect(),endOff=this.endCell.getBoundingClientRect(),parentOff=this.startCell.offsetParent.getBoundingClientRect();this.bdrLeft.style.left=stOff.left-parentOff.left+"px",this.bdrLeft.style.top=stOff.top-parentOff.top+"px",this.bdrLeft.style.height=endOff.top-stOff.top>0?endOff.top-parentOff.top+endOff.height+1-(stOff.top-parentOff.top)+"px":endOff.height+"px",this.bdrRight.style.left=endOff.left-parentOff.left+endOff.width+"px",this.bdrRight.style.top=this.bdrLeft.style.top,this.bdrRight.style.height=this.bdrLeft.style.height,this.bdrTop.style.left=this.bdrLeft.style.left,this.bdrTop.style.top=this.bdrRight.style.top,this.bdrTop.style.width=parseInt(this.bdrRight.style.left,10)-parseInt(this.bdrLeft.style.left,10)+1+"px",this.bdrBottom.style.left=this.bdrLeft.style.left,this.bdrBottom.style.top=parseInt(this.bdrLeft.style.top,10)+parseInt(this.bdrLeft.style.height,10)+"px",this.bdrBottom.style.width=this.bdrTop.style.width}createBorders(){this.bdrLeft||(this.bdrLeft=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdrleft",styles:"width: 2px;"})),this.bdrRight=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdrright",styles:"width: 2px;"})),this.bdrBottom=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdrbottom",styles:"height: 2px;"})),this.bdrTop=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdrtop",styles:"height: 2px;"})))}showBorders(){this.bdrLeft&&(this.bdrLeft.style.display="",this.bdrRight.style.display="",this.bdrBottom.style.display="",this.bdrTop.style.display="")}hideBorders(){this.bdrLeft&&(this.bdrLeft.style.display="none",this.bdrRight.style.display="none",this.bdrBottom.style.display="none",this.bdrTop.style.display="none")}drawAFBorders(){this.bdrAFBottom||this.createAFBorders(),this.positionAFBorders()}positionAFBorders(){if(!this.startCell||!this.bdrAFLeft)return;this.showBorders();let stOff=this.startAFCell.getBoundingClientRect(),endOff=this.endAFCell.getBoundingClientRect(),parentOff=this.startAFCell.offsetParent.getBoundingClientRect();this.bdrAFLeft.style.left=stOff.left-parentOff.left+"px",this.bdrAFLeft.style.top=stOff.top-parentOff.top+"px",this.bdrAFLeft.style.height=endOff.top-stOff.top>0?endOff.top-parentOff.top+endOff.height+1-(stOff.top-parentOff.top)+"px":endOff.height+"px",this.bdrAFRight.style.left=endOff.left-parentOff.left+endOff.width+"px",this.bdrAFRight.style.top=this.bdrAFLeft.style.top,this.bdrAFRight.style.height=this.bdrAFLeft.style.height,this.bdrAFTop.style.left=this.bdrAFLeft.style.left,this.bdrAFTop.style.top=this.bdrAFRight.style.top,this.bdrAFTop.style.width=parseInt(this.bdrAFRight.style.left,10)-parseInt(this.bdrAFLeft.style.left,10)+1+"px",this.bdrAFBottom.style.left=this.bdrAFLeft.style.left,this.bdrAFBottom.style.top=parseInt(this.bdrAFLeft.style.top,10)+parseInt(this.bdrAFLeft.style.height,10)+"px",this.bdrAFBottom.style.width=this.bdrAFTop.style.width}createAFBorders(){this.bdrAFLeft||(this.bdrAFLeft=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdrafleft",styles:"width: 2px;"})),this.bdrAFRight=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdrafright",styles:"width: 2px;"})),this.bdrAFBottom=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdrafbottom",styles:"height: 2px;"})),this.bdrAFTop=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdraftop",styles:"height: 2px;"})))}showAFBorders(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="",this.bdrAFRight.style.display="",this.bdrAFBottom.style.display="",this.bdrAFTop.style.display="")}hideAFBorders(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="none",this.bdrAFRight.style.display="none",this.bdrAFBottom.style.display="none",this.bdrAFTop.style.display="none")}updateValue(rIdx,cIdx,cell){let col=this.parent.getColumnByIndex(cIdx);this.parent.editModule&&cell&&this.parent.editModule.updateCell(rIdx,col.field,"number"===col.type?parseInt(cell.textContent,10):cell.textContent)}selectLikeAutoFill(e,isApply){let startrowIdx=parseInt(parentsUntil(this.startAFCell,"e-row").getAttribute("aria-rowindex"),10),startCellIdx=parseInt(this.startAFCell.getAttribute("aria-colindex"),10),endrowIdx=parseInt(parentsUntil(this.endAFCell,"e-row").getAttribute("aria-rowindex"),10),endCellIdx=parseInt(this.endAFCell.getAttribute("aria-colindex"),10),rowLen=this.selectedRowCellIndexes.length-1,colLen=this.selectedRowCellIndexes[0].cellIndexes.length-1;switch(!0){case!isApply&&this.endAFCell.classList.contains("e-cellselectionbackground")&&!!parentsUntil(e.target,"e-rowcell"):this.startAFCell=this.parent.getCellFromIndex(startrowIdx,startCellIdx),this.endAFCell=this.parent.getCellFromIndex(startrowIdx+rowLen,startCellIdx+colLen),this.drawAFBorders();break;case startCellIdx+colLen<endCellIdx&&endCellIdx-startCellIdx-colLen+1>endrowIdx-startrowIdx-rowLen&&endCellIdx-startCellIdx-colLen+1>startrowIdx-endrowIdx:if(this.endAFCell=this.parent.getCellFromIndex(startrowIdx+rowLen,endCellIdx),endrowIdx=parseInt(parentsUntil(this.endAFCell,"e-row").getAttribute("aria-rowindex"),10),endCellIdx=parseInt(this.endAFCell.getAttribute("aria-colindex"),10),isApply){let cellIdx=parseInt(this.endCell.getAttribute("aria-colindex"),10);for(let i=startrowIdx;i<=endrowIdx;i++){let cells=[].slice.call(this.parent.getDataRows()[i].querySelectorAll(".e-cellselectionbackground")),c=0;for(let j=cellIdx+1;j<=endCellIdx;j++)c>colLen&&(c=0),this.updateValue(i,j,cells[c]),c++}this.selectCellsByRange({rowIndex:startrowIdx,cellIndex:this.startCellIndex},{rowIndex:endrowIdx,cellIndex:endCellIdx})}else this.drawAFBorders();break;case startCellIdx>endCellIdx&&startCellIdx-endCellIdx+1>endrowIdx-startrowIdx-rowLen&&startCellIdx-endCellIdx+1>startrowIdx-endrowIdx:if(this.startAFCell=this.parent.getCellFromIndex(startrowIdx,endCellIdx),this.endAFCell=this.endCell,isApply){for(let i=startrowIdx;i<=startrowIdx+rowLen;i++){let cells=[].slice.call(this.parent.getDataRows()[i].querySelectorAll(".e-cellselectionbackground"));cells.reverse();let c=0;for(let j=this.startCellIndex-1;j>=endCellIdx;j--)c>colLen&&(c=0),this.updateValue(i,j,cells[c]),c++}this.selectCellsByRange({rowIndex:startrowIdx,cellIndex:endCellIdx},{rowIndex:startrowIdx+rowLen,cellIndex:this.startCellIndex+colLen})}else this.drawAFBorders();break;case startrowIdx>endrowIdx:if(this.startAFCell=this.parent.getCellFromIndex(endrowIdx,startCellIdx),this.endAFCell=this.endCell,isApply){let trIdx=parseInt(this.endCell.parentElement.getAttribute("aria-rowindex"),10),r=trIdx;for(let i=startrowIdx-1;i>=endrowIdx;i--){r===this.startIndex-1&&(r=trIdx);let cells=[].slice.call(this.parent.getDataRows()[r].querySelectorAll(".e-cellselectionbackground")),c=0;r--;for(let j=this.startCellIndex;j<=this.startCellIndex+colLen;j++)this.updateValue(i,j,cells[c]),c++}this.selectCellsByRange({rowIndex:endrowIdx,cellIndex:startCellIdx+colLen},{rowIndex:startrowIdx+rowLen,cellIndex:startCellIdx})}else this.drawAFBorders();break;default:if(this.endAFCell=this.parent.getCellFromIndex(endrowIdx,startCellIdx+colLen),isApply){let trIdx=parseInt(this.endCell.parentElement.getAttribute("aria-rowindex"),10),r=this.startIndex;for(let i=trIdx+1;i<=endrowIdx;i++){r===trIdx+1&&(r=this.startIndex);let cells=[].slice.call(this.parent.getDataRows()[r].querySelectorAll(".e-cellselectionbackground"));r++;let c=0;for(let m=this.startCellIndex;m<=this.startCellIndex+colLen;m++)this.updateValue(i,m,cells[c]),c++}this.selectCellsByRange({rowIndex:trIdx-rowLen,cellIndex:startCellIdx},{rowIndex:endrowIdx,cellIndex:startCellIdx+colLen})}else this.drawAFBorders()}}mouseUpHandler(e){document.body.classList.remove("e-disableuserselect"),this.element&&ej2_base_es2015_remove(this.element),this.mUPTarget=this.isDragged&&1===this.selectedRowCellIndexes.length&&1===this.selectedRowCellIndexes[0].cellIndexes.length?parentsUntil(e.target,"e-rowcell"):null,this.isDragged=!1,this.updateAutoFillPosition(),this.isAutoFillSel&&(this.startAFCell=this.startCell,this.endAFCell=parentsUntil(e.target,"e-rowcell"),this.updateStartCellsIndex(),this.selectLikeAutoFill(e,!0),this.updateAutoFillPosition(),this.hideAFBorders(),this.positionBorders(),this.isAutoFillSel=!1),EventHandler.remove(this.parent.getContent(),"mousemove",this.mouseMoveHandler),EventHandler.remove(document.body,"mouseup",this.mouseUpHandler)}hideAutoFill(){this.autofill&&(this.autofill.style.display="none")}updateAutoFillPosition(){if(this.parent.enableAutoFill&&!this.parent.isEdit&&this.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel()&&this.selectedRowCellIndexes.length){let cells=[].slice.call(this.parent.getDataRows()[this.selectedRowCellIndexes[this.selectedRowCellIndexes.length-1].rowIndex].querySelectorAll(".e-cellselectionbackground"));this.parent.element.querySelector("#"+this.parent.element.id+"_autofill")||(this.autofill=this.parent.getContentTable().parentElement.appendChild(ej2_base_es2015_createElement("div",{className:"e-autofill",id:this.parent.element.id+"_autofill"})));let cell=cells[cells.length-1];if(cell&&cell.offsetParent){let clientRect=cell.getBoundingClientRect(),parentOff=cell.offsetParent.getBoundingClientRect();this.autofill.style.left=clientRect.left-parentOff.left+clientRect.width-3+"px",this.autofill.style.top=clientRect.top-parentOff.top+clientRect.height-3+"px"}this.autofill.style.display=""}else this.hideAutoFill()}mouseDownHandler(e){let isDrag,target=e.target,gObj=this.parent,gridElement=parentsUntil(target,"e-grid");if(!gridElement||gridElement.id===gObj.element.id){if((e.shiftKey||e.ctrlKey)&&e.preventDefault(),parentsUntil(target,"e-rowcell")&&!e.shiftKey&&!e.ctrlKey){if(gObj.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel())this.isCellDrag=!0,isDrag=!0;else if(gObj.allowRowDragAndDrop&&!gObj.isEdit){if(!this.isRowType()||this.isSingleSel()||closest(target,"td").classList.contains("e-selectionbackground"))return void(this.isDragged=!1);isDrag=!0,this.element=this.parent.createElement("div",{className:"e-griddragarea"}),gObj.getContent().appendChild(this.element)}isDrag&&this.enableDrag(e,!0)}this.updateStartEndCells(),target.classList.contains("e-autofill")&&(this.isCellDrag=!0,this.isAutoFillSel=!0,this.enableDrag(e))}}updateStartEndCells(){let cells=[].slice.call(this.parent.element.querySelectorAll(".e-cellselectionbackground"));this.startCell=cells[0],this.endCell=cells[cells.length-1],this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute("aria-rowindex"),10),this.startCellIndex=parseInt(parentsUntil(this.startCell,"e-rowcell").getAttribute("aria-colindex"),10))}updateStartCellsIndex(){this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute("aria-rowindex"),10),this.startCellIndex=parseInt(parentsUntil(this.startCell,"e-rowcell").getAttribute("aria-colindex"),10))}enableDrag(e,isUpdate){let gObj=this.parent;if(isUpdate){let tr=closest(e.target,"tr");this.startDIndex=parseInt(tr.getAttribute("aria-rowindex"),10),this.startDCellIndex=parseInt(parentsUntil(e.target,"e-rowcell").getAttribute("aria-colindex"),10)}document.body.classList.add("e-disableuserselect");let gBRect=gObj.element.getBoundingClientRect(),postion=getPosition(e);this.x=postion.x-gBRect.left,this.y=postion.y-gBRect.top,EventHandler.add(gObj.getContent(),"mousemove",this.mouseMoveHandler,this),EventHandler.add(document.body,"mouseup",this.mouseUpHandler,this)}clearSelAfterRefresh(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.clearSelection()}addEventListener(){this.parent.isDestroyed||(this.parent.on(uiUpdate,this.enableAfterRender,this),this.parent.on(initialEnd,this.initializeSelection,this),this.parent.on(rowSelectionComplete,this.onActionComplete,this),this.parent.on(cellSelectionComplete,this.onActionComplete,this),this.parent.on(inBoundModelChanged,this.onPropertyChanged,this),this.parent.on(cellFocused,this.onCellFocused,this),this.parent.on(beforeFragAppend,this.clearSelAfterRefresh,this),this.parent.on(columnPositionChanged,this.columnPositionChanged,this),this.parent.on(contentReady,this.initialEnd,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(actionBegin,this.actionBeginFunction),this.parent.addEventListener(actionComplete,this.actionCompleteFunction),this.parent.on(rowsRemoved,this.rowsRemoved,this),this.parent.on(headerRefreshed,this.refreshHeader,this),this.addEventListener_checkbox())}removeEventListener(){this.parent.isDestroyed||(this.parent.off(uiUpdate,this.enableAfterRender),this.parent.off(initialEnd,this.initializeSelection),this.parent.off(rowSelectionComplete,this.onActionComplete),this.parent.off(cellSelectionComplete,this.onActionComplete),this.parent.off(inBoundModelChanged,this.onPropertyChanged),this.parent.off(cellFocused,this.onCellFocused),this.parent.off(beforeFragAppend,this.clearSelAfterRefresh),this.parent.off(columnPositionChanged,this.columnPositionChanged),this.parent.removeEventListener(actionBegin,this.actionBeginFunction),this.parent.removeEventListener(actionComplete,this.actionCompleteFunction),this.parent.off(rowsRemoved,this.rowsRemoved),this.parent.off(headerRefreshed,this.refreshHeader),this.removeEventListener_checkbox())}wireEvents(){this.isMacOS=-1!==navigator.userAgent.indexOf("Mac OS"),this.isMacOS&&(EventHandler.add(this.parent.element,"keydown",this.keyDownHandler,this),EventHandler.add(this.parent.element,"keyup",this.keyUpHandler,this))}unWireEvents(){this.isMacOS&&(EventHandler.remove(this.parent.element,"keydown",this.keyDownHandler),EventHandler.remove(this.parent.element,"keyup",this.keyUpHandler))}columnPositionChanged(){this.parent.isPersistSelection||this.clearSelection()}refreshHeader(){this.setCheckAllState()}rowsRemoved(e){for(let i=0;i<e.records.length;i++)delete this.selectedRowState[e.records[i][this.primaryKey]],--this.totalRecordsCount;this.setCheckAllState()}beforeFragAppend(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.clearSelection()}getCheckAllBox(){return this.parent.getHeaderContent().querySelector(".e-checkselectall")}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&this.render()}render(e){EventHandler.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this)}onPropertyChanged(e){if(e.module!==this.getModuleName())return;let gObj=this.parent;isNullOrUndefined(e.properties.type)||"Single"!==this.selectionSettings.type||(this.selectedRowCellIndexes.length>1&&(this.clearCellSelection(),this.prevCIdxs=void 0),this.selectedRowIndexes.length>1&&(this.clearRowSelection(),this.prevRowIndex=void 0),this.enableSelectMultiTouch=!1,this.hidePopUp()),isNullOrUndefined(e.properties.mode)&&isNullOrUndefined(e.properties.cellSelectionMode)||(this.clearSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0),this.isPersisted=!0,this.checkBoxSelectionChanged(),this.isPersisted=!1,this.initPerisistSelection(),this.parent.getColumns().filter(col=>"checkbox"===col.type).length&&(gObj.isCheckBoxSelection=!("ResetOnRowClick"===this.selectionSettings.checkboxMode)),this.drawBorders()}hidePopUp(){this.parent.element.querySelector(".e-gridpopup").querySelectorAll(".e-rowselect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none")}initialEnd(){this.parent.off(contentReady,this.initialEnd),this.selectRow(this.parent.selectedRowIndex)}checkBoxSelectionChanged(){this.parent.off(contentReady,this.checkBoxSelectionChanged);let gobj=this.parent,checkboxColumn=gobj.getColumns().filter(col=>"checkbox"===col.type);checkboxColumn.length>0&&(gobj.isCheckBoxSelection=!0,this.chkField=checkboxColumn[0].field,this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,isNullOrUndefined(this.totalRecordsCount)&&(this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.isSingleSel()?(gobj.selectionSettings.type="Multiple",gobj.dataBind()):this.initPerisistSelection()),gobj.isCheckBoxSelection||this.isPersisted||(this.chkField=null,this.initPerisistSelection())}initPerisistSelection(){let gobj=this.parent;this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0?(gobj.isPersistSelection=!0,this.ensureCheckboxFieldSelection()):this.parent.getPrimaryKeyFieldNames().length>0?(gobj.isPersistSelection=!1,this.ensureCheckboxFieldSelection()):(gobj.isPersistSelection=!1,this.selectedRowState={})}ensureCheckboxFieldSelection(){let gobj=this.parent;if(this.primaryKey=this.parent.getPrimaryKeyFieldNames()[0],!gobj.enableVirtualization&&this.chkField&&(gobj.isPersistSelection&&0===Object.keys(this.selectedRowState).length||!gobj.isPersistSelection)){let data=this.parent.getDataModule(),query=(new ej2_data_es2015_Query).where(this.chkField,"equal",!0);query.params||(query.params=this.parent.query.params);let dataManager=data.getData({},query),proxy=this;this.parent.showSpinner(),dataManager.then(e=>{proxy.dataSuccess(e.result),proxy.refreshPersistSelection(),proxy.parent.hideSpinner()})}}dataSuccess(res){for(let i=0;i<res.length;i++)isNullOrUndefined(this.selectedRowState[res[i][this.primaryKey]])&&res[i][this.chkField]&&(this.selectedRowState[res[i][this.primaryKey]]=res[i][this.chkField]);this.persistSelectedData=res}setRowSelection(state){if(!this.parent.getDataModule().isRemote()&&"BlazorAdaptor"!==this.parent.dataSource.adaptorName)if(state)for(let data of this.getData())this.selectedRowState[data[this.primaryKey]]=!0;else this.selectedRowState={}}getData(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))}refreshPersistSelection(){let rows=this.parent.getRows();if(rows.length>0&&(this.parent.isPersistSelection||this.chkField)){let indexes=[];for(let j=0;j<rows.length;j++){let checkState,rowObj=this.getRowObj(rows[j]),pKey=rowObj?rowObj.data[this.primaryKey]:null;if(null===pKey)return;let chkBox=rows[j].querySelector(".e-checkselect");this.selectedRowState[pKey]||"Check"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(pKey)<0||"Uncheck"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(pKey)>0||"Intermediate"===this.parent.checkAllRows&&!isNullOrUndefined(this.chkField)&&rowObj.data[this.chkField]?(indexes.push(parseInt(rows[j].getAttribute("aria-rowindex"),10)),checkState=!0):(checkState=!1,this.checkedTarget!==chkBox&&this.parent.isCheckBoxSelection&&removeAddCboxClasses(chkBox.nextElementSibling,checkState)),this.updatePersistCollection(rows[j],checkState)}this.isSingleSel()&&indexes.length>0?this.selectRow(indexes[0],!0):this.selectRows(indexes)}this.parent.isCheckBoxSelection&&this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState()}actionBegin(e){if("save"===e.requestType&&this.parent.isPersistSelection){let editChkBox=this.parent.element.querySelector(".e-edit-checkselect");if(!isNullOrUndefined(editChkBox)){let row=closest(editChkBox,".e-editedrow");if(row){"Dialog"===this.parent.editSettings.mode&&(row=this.parent.element.querySelector(".e-dlgeditrow"));let rowObj=this.getRowObj(row);if(!rowObj)return;this.selectedRowState[rowObj.data[this.primaryKey]]=rowObj.isSelected=editChkBox.checked}else this.isCheckedOnAdd=editChkBox.checked}}}actionComplete(e){if("save"===e.requestType&&this.parent.isPersistSelection){if("add"===e.action&&this.isCheckedOnAdd){let rowObj=this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute("data-uid"));this.selectedRowState[rowObj.data[this.primaryKey]]=rowObj.isSelected=this.isCheckedOnAdd}this.refreshPersistSelection()}"delete"===e.requestType&&this.parent.isPersistSelection&&(e.data.slice().forEach(data=>{isNullOrUndefined(data[this.primaryKey])||this.updatePersistDelete(data[this.primaryKey])}),this.setCheckAllState(),this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),"paging"===e.requestType&&(this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0)}onDataBound(){!this.parent.enableVirtualization&&this.parent.isPersistSelection&&this.refreshPersistSelection()}updatePersistSelectedData(checkState){if(this.parent.isPersistSelection){let adaptorName="adaptorName",rows=this.parent.getRows();for(let i=0;i<rows.length;i++)this.updatePersistCollection(rows[i],checkState);"Uncheck"===this.parent.checkAllRows?(this.setRowSelection(!1),this.persistSelectedData=this.parent.getDataModule().isRemote()?this.persistSelectedData:[]):"Check"===this.parent.checkAllRows&&(this.setRowSelection(!0),this.persistSelectedData=this.parent.getDataModule().isRemote()||"BlazorAdaptor"===this.parent.dataSource[adaptorName]?this.persistSelectedData:this.getData().slice())}}checkSelectAllAction(checkState){let cRenderer=this.getRenderer(),editForm=this.parent.element.querySelector(".e-gridform");if(this.checkedTarget=this.getCheckAllBox(),checkState&&this.getCurrentBatchRecordChanges().length?(this.parent.checkAllRows="Check",this.updatePersistSelectedData(checkState),this.selectRowsByRange(cRenderer.getVirtualRowIndex(0),cRenderer.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length-1))):(this.parent.checkAllRows="Uncheck",this.updatePersistSelectedData(checkState),this.clearSelection()),this.chkAllCollec=[],!isNullOrUndefined(editForm)){let editChkBox=editForm.querySelector(".e-edit-checkselect");isNullOrUndefined(editChkBox)||removeAddCboxClasses(editChkBox.nextElementSibling,checkState)}}checkSelectAll(checkBox){let stateStr=this.getCheckAllStatus(checkBox),state="Check"===stateStr;"Intermediate"===stateStr&&(state=this.getCurrentBatchRecordChanges().some(data=>data[this.primaryKey]in this.selectedRowState)),this.checkSelectAllAction(!state),this.target=null,this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState(),this.triggerChkChangeEvent(checkBox,!state)}getCheckAllStatus(ele){let classes=ele?ele.nextElementSibling.classList:this.getCheckAllBox().nextElementSibling.classList;return classes.contains("e-check")?"Check":classes.contains("e-uncheck")?"Uncheck":classes.contains("e-stop")?"Intermediate":"None"}checkSelect(checkBox){let target=closest(this.checkedTarget,".e-rowcell"),gObj=this.parent;this.isMultiCtrlRequest=!0;let rIndex=0;if(isGroupAdaptive(gObj)){let uid=target.parentElement.getAttribute("data-uid");rIndex=gObj.getRows().map(m=>m.getAttribute("data-uid")).indexOf(uid)}else rIndex=parseInt(target.parentElement.getAttribute("aria-rowindex"),10);this.parent.isPersistSelection&&this.parent.element.querySelectorAll(".e-addedrow").length>0&&++rIndex,this.rowCellSelectionHandler(rIndex,parseInt(target.getAttribute("aria-colindex"),10)),this.moveIntoUncheckCollection(closest(target,".e-row")),this.setCheckAllState(),this.isMultiCtrlRequest=!1,this.triggerChkChangeEvent(checkBox,checkBox.nextElementSibling.classList.contains("e-check"))}moveIntoUncheckCollection(row){if("Check"===this.parent.checkAllRows||"Uncheck"===this.parent.checkAllRows){let rowObj=this.getRowObj(row),pKey=rowObj&&rowObj.data?rowObj.data[this.primaryKey]:null;if(!pKey)return;this.chkAllCollec.indexOf(pKey)<0?this.chkAllCollec.push(pKey):this.chkAllCollec.splice(this.chkAllCollec.indexOf(pKey),1)}}triggerChkChangeEvent(checkBox,checkState){this.parent.trigger(checkBoxChange,{checked:checkState,selectedRowIndexes:this.parent.getSelectedRowIndexes(),target:checkBox}),this.parent.isEdit||(this.checkedTarget=null)}updateSelectedRowIndex(index){if(this.parent.isCheckBoxSelection&&this.parent.enableVirtualization&&!this.parent.getDataModule().isRemote())if("Check"===this.parent.checkAllRows){this.selectedRowIndexes=[];for(let data=0;data<this.getData().length;data++)this.selectedRowIndexes.push(data)}else if("Uncheck"===this.parent.checkAllRows)this.selectedRowIndexes=[];else if(index&&"false"===this.parent.getRowByIndex(index).getAttribute("aria-selected")){let selectedVal=this.selectedRowIndexes.indexOf(index);this.selectedRowIndexes.splice(selectedVal,1)}}setCheckAllState(index,isInteraction){if(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode){let checkedLen=Object.keys(this.selectedRowState).length;if(this.parent.isPersistSelection||(checkedLen=this.selectedRowIndexes.length,this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.getCheckAllBox()){let spanEle=this.getCheckAllBox().nextElementSibling;removeClass([spanEle],["e-check","e-stop","e-uncheck"]),checkedLen===this.totalRecordsCount&&this.totalRecordsCount||this.parent.enableVirtualization&&!this.parent.allowPaging&&!this.parent.getDataModule().isRemote()&&checkedLen===this.getData().length?(addClass([spanEle],["e-check"]),isInteraction&&this.getRenderer().setSelection(null,!0,!0),this.parent.checkAllRows="Check"):0===checkedLen||0===this.getCurrentBatchRecordChanges().length?(addClass([spanEle],["e-uncheck"]),isInteraction&&this.getRenderer().setSelection(null,!1,!0),this.parent.checkAllRows="Uncheck",0===checkedLen&&0===this.getCurrentBatchRecordChanges().length?addClass([spanEle.parentElement],["e-checkbox-disabled"]):removeClass([spanEle.parentElement],["e-checkbox-disabled"])):(addClass([spanEle],["e-stop"]),this.parent.checkAllRows="Intermediate"),!this.parent.enableVirtualization||this.parent.allowPaging||this.parent.getDataModule().isRemote()||this.updateSelectedRowIndex(index)}}}keyDownHandler(e){("chrome"===Browser.info.name&&(91===e.keyCode||93===e.keyCode)||"opera"===Browser.info.name&&17===e.keyCode||"mozilla"===Browser.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!0)}keyUpHandler(e){("chrome"===Browser.info.name&&(91===e.keyCode||93===e.keyCode)||"opera"===Browser.info.name&&17===e.keyCode||"mozilla"===Browser.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!1)}clickHandler(e){let target=e.target;this.actualTarget=target,this.isInteracted=!0,this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch||this.isMacOS&&this.cmdKeyPressed,this.isMultiShiftRequest=e.shiftKey,this.popUpClickHandler(e);let checkBox,chkSelect=!1;this.preventFocus=!0;let checkWrap=parentsUntil(target,"e-checkbox-wrapper");if(this.checkSelectAllClicked=!(!checkWrap||!checkWrap.querySelectorAll(".e-checkselectall")),checkWrap&&checkWrap.querySelectorAll(".e-checkselect,.e-checkselectall").length>0&&(checkBox=checkWrap.querySelector('input[type="checkbox"]'),chkSelect=!0),this.drawBorders(),(target=parentsUntil(target,"e-rowcell"))&&target.parentElement.classList.contains("e-row")&&!this.parent.selectionSettings.checkboxOnly||chkSelect){if(this.parent.isCheckBoxSelection&&(this.isMultiCtrlRequest=!0),this.target=target,isNullOrUndefined(checkBox)){let gObj=this.parent,rIndex=0;if(isGroupAdaptive(gObj)){let uid=target.parentElement.getAttribute("data-uid");rIndex=gObj.getRows().map(m=>m.getAttribute("data-uid")).indexOf(uid)}else rIndex=parseInt(target.parentElement.getAttribute("aria-rowindex"),10);this.parent.isPersistSelection&&this.parent.element.querySelectorAll(".e-addedrow").length>0&&++rIndex,this.mUPTarget&&this.mUPTarget.isEqualNode(target)||this.rowCellSelectionHandler(rIndex,parseInt(target.getAttribute("aria-colindex"),10)),this.parent.isCheckBoxSelection&&(this.moveIntoUncheckCollection(closest(target,".e-row")),this.setCheckAllState())}else this.checkedTarget=checkBox,checkBox.classList.contains("e-checkselectall")?this.checkSelectAll(checkBox):this.checkSelect(checkBox);this.parent.isCheckBoxSelection||!Browser.isDevice||this.isSingleSel()||this.showPopup(e)}this.isMultiCtrlRequest=!1,this.isMultiShiftRequest=!1,isNullOrUndefined(closest(e.target,".e-unboundcell"))&&(this.preventFocus=!1)}popUpClickHandler(e){let target=e.target;closest(target,".e-headercell")||e.target.classList.contains("e-rowcell")||closest(target,".e-gridpopup")?target.classList.contains("e-rowselect")&&(target.classList.contains("e-spanclicked")?(target.classList.remove("e-spanclicked"),this.enableSelectMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(target.classList.add("e-spanclicked"),this.enableSelectMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"}showPopup(e){this.selectionSettings.enableSimpleMultiRowSelection||setCssInGridPopUp(this.parent.element.querySelector(".e-gridpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(!this.isSingleSel()&&(this.selectedRecords.length>(this.parent.getFrozenColumns()?2:1)||this.selectedRowCellIndexes.length>1)?" e-spanclicked":""))}rowCellSelectionHandler(rowIndex,cellIndex){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?(this.isDragged||this.selectRow(rowIndex,this.selectionSettings.enableToggle),this.selectCell({rowIndex:rowIndex,cellIndex:cellIndex},this.selectionSettings.enableToggle),this.selectedRowCellIndexes.length&&this.updateAutoFillPosition(),this.drawBorders()):this.isMultiShiftRequest?(this.parent.isCheckBoxSelection||!this.parent.isCheckBoxSelection&&!closest(this.target,".e-rowcell").classList.contains("e-gridchkbox")?this.selectRowsByRange(isUndefined(this.prevRowIndex)?rowIndex:this.prevRowIndex,rowIndex):this.addRowsToSelection([rowIndex]),this.selectCellsByRange(isUndefined(this.prevCIdxs)?{rowIndex:rowIndex,cellIndex:cellIndex}:this.prevCIdxs,{rowIndex:rowIndex,cellIndex:cellIndex}),this.updateAutoFillPosition(),this.drawBorders()):(this.addRowsToSelection([rowIndex]),this.addCellsToSelection([{rowIndex:rowIndex,cellIndex:cellIndex}]),this.hideBorders()),this.isDragged=!1}onCellFocused(e){if(this.parent.frozenRows&&e.container.isHeader&&e.byKey)if("upArrow"===e.keyArgs.action)e.isJump=this.parent.allowFiltering?"INPUT"===e.element.tagName:"TH"===e.element.tagName;else if("downArrow"===e.keyArgs.action){let rIdx=Number(e.element.parentElement.getAttribute("aria-rowindex"));e.isJump=0===rIdx}else"ctrlHome"===e.keyArgs.action&&(e.isJump=!0);let clear=this.parent.getFrozenColumns()?(e.container.isHeader&&"TD"!==e.element.tagName&&e.isJump||(e.container.isContent||"TD"===e.element.tagName)&&!(e.container.isSelectable||"TD"===e.element.tagName))&&!(e.byKey&&"space"===e.keyArgs.action):(e.container.isHeader&&e.isJump||e.container.isContent&&!e.container.isSelectable)&&!(e.byKey&&"space"===e.keyArgs.action),headerAction=e.container.isHeader&&"TD"!==e.element.tagName&&!closest(e.element,".e-rowcell")&&!(e.byKey&&"space"===e.keyArgs.action);if(!e.byKey||clear)return void(clear&&!this.parent.isCheckBoxSelection&&this.clearSelection());let[rowIndex,cellIndex]=e.container.isContent?e.container.indexes:e.indexes,prev=this.focus.getPrevIndexes();if(this.parent.frozenRows)if(e.container.isHeader&&("TD"===e.element.tagName||closest(e.element,".e-rowcell"))){let thLen=this.parent.getHeaderTable().querySelector("thead").childElementCount;rowIndex-=thLen,prev.rowIndex=prev.rowIndex?prev.rowIndex-thLen:null}else rowIndex+=this.parent.frozenRows,prev.rowIndex=0!==prev.rowIndex&&isNullOrUndefined(prev.rowIndex)?null:prev.rowIndex+this.parent.frozenRows;if(this.parent.getFrozenColumns()){let cIdx=Number(e.element.getAttribute("aria-colindex"));prev.cellIndex=prev.cellIndex?prev.cellIndex===cellIndex?cIdx:cIdx-1:null,cellIndex=cIdx}if(!(headerAction||-1===["ctrlPlusA","escape"].indexOf(e.keyArgs.action)&&"space"!==e.keyArgs.action&&rowIndex===prev.rowIndex&&cellIndex===prev.cellIndex)){switch(this.preventFocus=!0,e.keyArgs.action){case"downArrow":case"upArrow":case"enter":case"shiftEnter":this.applyDownUpKey(rowIndex,cellIndex);break;case"rightArrow":case"leftArrow":this.applyRightLeftKey(rowIndex,cellIndex);break;case"shiftDown":case"shiftUp":this.shiftDownKey(rowIndex,cellIndex);break;case"shiftLeft":case"shiftRight":this.applyShiftLeftRightKey(rowIndex,cellIndex);break;case"home":case"end":cellIndex="end"===e.keyArgs.action?this.getLastColIndex(rowIndex):0,this.applyHomeEndKey(rowIndex,cellIndex);break;case"ctrlHome":case"ctrlEnd":this.applyCtrlHomeEndKey(rowIndex,cellIndex);break;case"escape":this.clearSelection();break;case"ctrlPlusA":this.ctrlPlusA();break;case"space":this.applySpaceSelection(e.element);break;case"tab":this.parent.editSettings.allowNextRowEdit&&this.selectRow(rowIndex)}this.preventFocus=!1,this.positionBorders(),this.updateAutoFillPosition()}}ctrlPlusA(){this.isRowType()&&!this.isSingleSel()&&this.selectRowsByRange(0,this.parent.getRows().length-1),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange({rowIndex:0,cellIndex:0},{rowIndex:this.parent.getRows().length-1,cellIndex:this.parent.getColumns().length-1})}applySpaceSelection(target){target.classList.contains("e-checkselectall")?(this.checkedTarget=target,this.checkSelectAll(this.checkedTarget)):target.classList.contains("e-checkselect")&&(this.checkedTarget=target,this.checkSelect(this.checkedTarget))}applyDownUpKey(rowIndex,cellIndex){let gObj=this.parent;this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&!this.selectionSettings.persistSelection&&(this.checkSelectAllAction(!1),this.checkedTarget=null),this.isRowType()&&(this.selectRow(rowIndex,!0),this.applyUpDown(gObj.selectedRowIndex)),this.isCellType()&&this.selectCell({rowIndex:rowIndex,cellIndex:cellIndex},!0)}applyUpDown(rowIndex){if(rowIndex<0)return;this.target||(this.target=this.parent.getRows()[0].children[this.parent.groupSettings.columns.length||0]);let cIndex=parseInt(this.target.getAttribute("aria-colindex"),10),frzCols=this.parent.getFrozenColumns();this.target=frzCols&&cIndex>=frzCols?this.contentRenderer.getMovableRowByIndex(rowIndex).querySelectorAll(".e-rowcell")[cIndex-frzCols]:this.contentRenderer.getRowByIndex(rowIndex).querySelectorAll(".e-rowcell")[cIndex],this.addAttribute(this.target)}applyRightLeftKey(rowIndex,cellIndex){this.isCellType()&&(this.selectCell({rowIndex:rowIndex,cellIndex:cellIndex},!0),this.addAttribute(this.target))}applyHomeEndKey(rowIndex,cellIndex){this.isCellType()?this.selectCell({rowIndex:rowIndex,cellIndex:cellIndex},!0):this.addAttribute(this.parent.getCellFromIndex(rowIndex,cellIndex))}shiftDownKey(rowIndex,cellIndex){this.isMultiShiftRequest=!0,this.isRowType()&&!this.isSingleSel()&&(isUndefined(this.prevRowIndex)?this.selectRow(0,!0):(this.selectRowsByRange(this.prevRowIndex,rowIndex),this.applyUpDown(rowIndex))),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange(this.prevCIdxs||{rowIndex:0,cellIndex:0},{rowIndex:rowIndex,cellIndex:cellIndex}),this.isMultiShiftRequest=!1}applyShiftLeftRightKey(rowIndex,cellIndex){this.isMultiShiftRequest=!0,this.selectCellsByRange(this.prevCIdxs,{rowIndex:rowIndex,cellIndex:cellIndex}),this.isMultiShiftRequest=!1}applyCtrlHomeEndKey(rowIndex,cellIndex){this.isRowType()&&(this.selectRow(rowIndex,!0),this.addAttribute(this.parent.getCellFromIndex(rowIndex,cellIndex))),this.isCellType()&&this.selectCell({rowIndex:rowIndex,cellIndex:cellIndex},!0)}addRemoveClassesForRow(row,isAdd,clearAll,...args){if(row){let cells=[].slice.call(row.querySelectorAll(".e-rowcell")),detailIndentCell=row.querySelector(".e-detailrowcollapse")||row.querySelector(".e-detailrowexpand"),dragdropIndentCell=row.querySelector(".e-rowdragdrop");detailIndentCell&&cells.push(detailIndentCell),dragdropIndentCell&&cells.push(dragdropIndentCell),addRemoveActiveClasses(cells,isAdd,...args)}this.getRenderer().setSelection(row?row.getAttribute("data-uid"):null,isAdd,clearAll)}isRowType(){return"Row"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode}isCellType(){return"Cell"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode}isSingleSel(){return"Single"===this.selectionSettings.type}getRenderer(){return isNullOrUndefined(this.contentRenderer)&&(this.contentRenderer=this.factory.getRenderer(RenderType.Content)),this.contentRenderer}getSelectedRecords(){return this.selectionSettings.persistSelection?this.persistSelectedData:this.parent.getRowsObject().filter(row=>row.isSelected).map(m=>m.data)}addEventListener_checkbox(){this.parent.on(dataReady,this.dataReady,this),this.onDataBoundFunction=this.onDataBound.bind(this),this.parent.addEventListener(dataBound,this.onDataBoundFunction),this.parent.on(contentReady,this.checkBoxSelectionChanged,this),this.actionCompleteFunc=this.actionCompleteHandler.bind(this),this.parent.addEventListener(actionComplete,this.actionCompleteFunc),this.parent.on(click,this.clickHandler,this),this.resizeEndFn=()=>{this.updateAutoFillPosition(),this.drawBorders()},this.resizeEndFn.bind(this),this.parent.addEventListener(resizeStop,this.resizeEndFn)}removeEventListener_checkbox(){this.parent.off(dataReady,this.dataReady),this.parent.removeEventListener(dataBound,this.onDataBoundFunction),this.parent.removeEventListener(actionComplete,this.actionCompleteFunc),this.parent.off(click,this.clickHandler)}dataReady(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||(this.disableUI=!0,this.clearSelection(),this.disableUI=!1)}actionCompleteHandler(e){"save"===e.requestType&&this.parent.isPersistSelection&&this.refreshPersistSelection()}selectRowIndex(index){this.parent.isSelectedRowIndexUpdating=!0,this.parent.selectedRowIndex=index}}class ej2_grids_es2015_Search{constructor(parent){this.parent=parent,this.addEventListener()}search(searchString){let gObj=this.parent;searchString=isNullOrUndefined(searchString)?"":searchString,isActionPrevent(gObj)?gObj.notify(preventBatch,{instance:this,handler:this.search,arg1:searchString}):searchString!==gObj.searchSettings.key?(gObj.searchSettings.key=searchString.toString(),gObj.dataBind()):this.refreshSearch&&gObj.refresh()}addEventListener(){this.parent.isDestroyed||(this.parent.on(inBoundModelChanged,this.onPropertyChanged,this),this.parent.on(searchComplete,this.onSearchComplete,this),this.parent.on(ej2_grids_es2015_destroy,this.destroy,this),this.actionCompleteFunc=this.onActionComplete.bind(this),this.parent.addEventListener(actionComplete,this.actionCompleteFunc),this.parent.on(cancelBegin,this.cancelBeginEvent,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(inBoundModelChanged,this.onPropertyChanged),this.parent.off(searchComplete,this.onSearchComplete),this.parent.off(ej2_grids_es2015_destroy,this.destroy),this.parent.removeEventListener(actionComplete,this.actionCompleteFunc),this.parent.off(cancelBegin,this.cancelBeginEvent))}destroy(){this.removeEventListener()}onPropertyChanged(e){e.module===this.getModuleName()&&(isNullOrUndefined(e.properties.key)?this.parent.notify(modelChanged,{requestType:"searching",type:actionBegin}):this.parent.notify(modelChanged,{requestType:"searching",type:actionBegin,searchString:this.parent.searchSettings.key}))}onSearchComplete(e){this.parent.trigger(actionComplete,extend(e,{searchString:this.parent.searchSettings.key,requestType:"searching",type:actionComplete}))}onActionComplete(e){this.refreshSearch="searching"!==e.requestType}cancelBeginEvent(e){"searching"===e.requestType&&this.parent.setProperties({searchSettings:{key:""}},!0)}getModuleName(){return"search"}}class ej2_grids_es2015_ShowHide{constructor(parent){this.parent=parent}show(columnName,showBy){let keys=this.getToggleFields(columnName),columns=this.getColumns(keys,showBy);this.parent.notify(tooltipDestroy,{module:"edit"}),columns.forEach(value=>{value.visible=!0}),this.setVisible(columns)}hide(columnName,hideBy){let keys=this.getToggleFields(columnName),columns=this.getColumns(keys,hideBy);this.parent.notify(tooltipDestroy,{module:"edit"}),columns.forEach(value=>{value.visible=!1}),this.setVisible(columns)}getToggleFields(key){return"string"==typeof key?[key]:key}getColumns(keys,getKeyBy){return iterateArrayOrObject(keys,(key,index)=>iterateArrayOrObject(this.parent.columnModel,(item,index)=>{if(item[getKeyBy]===key)return item})[0])}setVisible(columns){if(isActionPrevent(this.parent))return void this.parent.notify(preventBatch,{instance:this,handler:this.setVisible,arg1:columns});let currentViewCols=this.parent.getColumns();columns=isNullOrUndefined(columns)?currentViewCols:columns,this.parent.allowSelection&&this.parent.getSelectedRecords().length&&this.parent.clearSelection(),this.parent.enableColumnVirtualization?columns.filter(col1=>currentViewCols.some(col2=>col1.field===col2.field)).length&&this.parent.notify(columnVisibilityChanged,columns):this.parent.notify(columnVisibilityChanged,columns),"All"!==this.parent.columnQueryMode&&this.parent.refresh()}}class ej2_grids_es2015_Scroll{constructor(parent){this.lastScrollTop=0,this.previousValues={top:0,left:0},this.oneTimeReady=!0,this.parent=parent,this.widthService=new ej2_grids_es2015_ColumnWidthService(parent),this.addEventListener()}getModuleName(){return"scroll"}setWidth(uiupdate){this.parent.element.style.width=formatUnit(this.parent.width),uiupdate&&this.widthService.setWidthToColumns(),this.parent.toolbarModule&&this.parent.toolbarModule.toolbar&&this.parent.toolbarModule.toolbar.element&&this.parent.toolbarModule.toolbar.refreshOverflow()}setHeight(){let mHdrHeight=0,content=this.parent.getContent().firstChild;this.parent.frozenRows&&"auto"!==this.parent.height?(mHdrHeight=this.parent.getHeaderContent().querySelector("tbody").offsetHeight,content.style.height=formatUnit(this.parent.height-mHdrHeight)):content.style.height=formatUnit(this.parent.height),this.ensureOverflow(content)}setPadding(){let content=this.parent.getHeaderContent(),scrollWidth=ej2_grids_es2015_Scroll.getScrollBarWidth()-this.getThreshold(),cssProps=this.getCssProperties();content.firstChild.style[cssProps.border]=scrollWidth>0?"1px":"0px",content.style[cssProps.padding]=scrollWidth>0?scrollWidth+"px":"0px"}removePadding(rtl){let cssProps=this.getCssProperties(rtl);this.parent.getHeaderContent().firstChild.style[cssProps.border]="",this.parent.getHeaderContent().firstChild.parentElement.style[cssProps.padding]=""}refresh(){if("100%"!==this.parent.height)return;let content=this.parent.getContent();this.parent.element.style.height="100%";let height=this.widthService.getSiblingsHeight(content);content.style.height="calc(100% - "+height+"px)"}getThreshold(){return"mozilla"===Browser.info.name?.5:1}addEventListener(){this.parent.isDestroyed||(this.parent.on(onEmpty,this.wireEvents,this),this.parent.on(contentReady,this.wireEvents,this),this.parent.on(uiUpdate,this.onPropertyChanged,this),this.parent.on(textWrapRefresh,this.wireEvents,this),this.parent.on(headerRefreshed,this.setScrollLeft,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(onEmpty,this.wireEvents),this.parent.off(contentReady,this.wireEvents),this.parent.off(uiUpdate,this.onPropertyChanged),this.parent.off(textWrapRefresh,this.wireEvents),this.parent.off(headerRefreshed,this.setScrollLeft))}setScrollLeft(){this.parent.frozenColumns&&(this.parent.headerModule.getMovableHeader().scrollLeft=this.previousValues.left)}onContentScroll(scrollTarget){let element=scrollTarget,isHeader=element.classList.contains("e-headercontent");return e=>{if(null===this.content.querySelector("tbody")||this.parent.isPreventScrollEvent)return;let target=e.target,left=target.scrollLeft,isFooter=target.classList.contains("e-summarycontent");this.previousValues.left!==left?(element.scrollLeft=left,isFooter&&(this.header.scrollLeft=left),this.previousValues.left=left,this.parent.notify(ej2_grids_es2015_scroll,{left:left})):this.previousValues.top=isHeader?target.scrollTop:this.previousValues.top}}onFreezeContentScroll(scrollTarget){let element=scrollTarget;return e=>{if(null===this.content.querySelector("tbody"))return;let top=e.target.scrollTop;this.previousValues.top!==top&&(element.scrollTop=top,this.previousValues.top=top)}}onWheelScroll(scrollTarget){let element=scrollTarget;return e=>{if(null===this.content.querySelector("tbody"))return;let top=element.scrollTop+(1===e.deltaMode?30*e.deltaY:e.deltaY);this.previousValues.top!==top&&(e.preventDefault(),this.parent.getContent().querySelector(".e-frozencontent").scrollTop=top,element.scrollTop=top,this.previousValues.top=top)}}onTouchScroll(scrollTarget){let element=scrollTarget;return e=>{if("mouse"===e.pointerType)return;let cont,mHdr,pageXY=this.getPointXY(e),top=element.scrollTop+(this.pageXY.y-pageXY.y),left=element.scrollLeft+(this.pageXY.x-pageXY.x);if(this.parent.getHeaderContent().contains(e.target)){if(mHdr=this.parent.getFrozenColumns()?this.parent.getHeaderContent().querySelector(".e-movableheader"):this.parent.getHeaderContent().firstChild,this.previousValues.left===left||left<0||mHdr.scrollWidth-mHdr.clientWidth<left)return;e.preventDefault(),mHdr.scrollLeft=left,element.scrollLeft=left,this.pageXY.x=pageXY.x,this.previousValues.left=left}else{if(cont=this.parent.getContent().querySelector(".e-frozencontent"),this.previousValues.top===top&&(top<0||cont.scrollHeight-cont.clientHeight<top)||top<0||cont.scrollHeight-cont.clientHeight<top)return;e.preventDefault(),cont.scrollTop=top,element.scrollTop=top,this.pageXY.y=pageXY.y,this.previousValues.top=top}}}setPageXY(){return e=>{"mouse"!==e.pointerType&&(this.pageXY=this.getPointXY(e))}}getPointXY(e){let pageXY={x:0,y:0};return e.touches&&e.touches.length?(pageXY.x=e.touches[0].pageX,pageXY.y=e.touches[0].pageY):(pageXY.x=e.pageX,pageXY.y=e.pageY),pageXY}wireEvents(){if(this.oneTimeReady){let frzCols=this.parent.getFrozenColumns();this.content=this.parent.getContent().firstChild,this.header=this.parent.getHeaderContent().firstChild;let mCont=this.content.querySelector(".e-movablecontent"),fCont=this.content.querySelector(".e-frozencontent"),mHdr=this.header.querySelector(".e-movableheader");this.parent.frozenRows&&(EventHandler.add(frzCols?mHdr:this.header,"touchstart pointerdown",this.setPageXY(),this),EventHandler.add(frzCols?mHdr:this.header,"touchmove pointermove",this.onTouchScroll(frzCols?mCont:this.content),this)),frzCols?(EventHandler.add(mCont,"scroll",this.onContentScroll(mHdr),this),EventHandler.add(mCont,"scroll",this.onFreezeContentScroll(fCont),this),EventHandler.add(fCont,"scroll",this.onFreezeContentScroll(mCont),this),EventHandler.add(mHdr,"scroll",this.onContentScroll(mCont),this),EventHandler.add(fCont,"wheel",this.onWheelScroll(mCont),this),EventHandler.add(fCont,"touchstart pointerdown",this.setPageXY(),this),EventHandler.add(fCont,"touchmove pointermove",this.onTouchScroll(mCont),this)):(EventHandler.add(this.content,"scroll",this.onContentScroll(this.header),this),EventHandler.add(this.header,"scroll",this.onContentScroll(this.content),this)),this.parent.aggregates.length&&EventHandler.add(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll(this.content),this),this.refresh(),this.oneTimeReady=!1}let sLeft,sHeight,clientHeight,table=this.parent.getContentTable();getUpdateUsingRaf(()=>{sLeft=this.header.scrollLeft,sHeight=table.scrollHeight,clientHeight=this.parent.getContent().clientHeight},()=>{this.parent.enableVirtualization||(sHeight<clientHeight&&(addClass(table.querySelectorAll("tr:last-child td"),"e-lastrowcell"),this.parent.getFrozenColumns()&&addClass(this.parent.getContent().querySelector(".e-movablecontent").querySelectorAll("tr:last-child td"),"e-lastrowcell")),(this.parent.frozenRows>0||this.parent.frozenColumns>0)&&this.header.querySelector(".e-movableheader")?this.header.querySelector(".e-movableheader").scrollLeft=this.previousValues.left:this.header.scrollLeft=this.previousValues.left,this.content.scrollLeft=this.previousValues.left,this.content.scrollTop=this.previousValues.top),this.parent.enableColumnVirtualization||(this.content.scrollLeft=sLeft),this.parent.frozenColumns&&this.header.querySelector(".e-movableheader")&&(this.header.querySelector(".e-movableheader").scrollLeft=this.content.querySelector(".e-movablecontent").scrollLeft)}),this.parent.isPreventScrollEvent=!1}getCssProperties(rtl){let css={},enableRtl=isNullOrUndefined(rtl)?this.parent.enableRtl:rtl;return css.border=enableRtl?"borderLeftWidth":"borderRightWidth",css.padding=enableRtl?"paddingLeft":"paddingRight",css}ensureOverflow(content){this.parent.getFrozenColumns()?(content.querySelector(".e-movablecontent").style.overflowY="auto"===this.parent.height?"auto":"scroll","scroll"===content.querySelector(".e-movablecontent").style.overflowY&&this.setPadding()):content.style.overflowY="auto"===this.parent.height?"auto":"scroll"}onPropertyChanged(e){e.module===this.getModuleName()&&(this.setPadding(),this.oneTimeReady=!0,"auto"===this.parent.height&&this.removePadding(),this.wireEvents(),this.setHeight(),this.setWidth(!isNullOrUndefined(e.properties.width)))}destroy(){let gridElement=this.parent.element;gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.removeEventListener(),this.removePadding(),removeClass([this.parent.getHeaderContent().firstChild],"e-headercontent"),removeClass([this.parent.getContent().firstChild],"e-content"),this.parent.getContent().firstChild.style.height="",this.parent.element.style.width="",EventHandler.remove(this.parent.getContent().firstChild,"scroll",this.onContentScroll))}static getScrollBarWidth(){return getScrollBarWidth()}}let ej2_grids_es2015_AggregateColumn=(()=>{class AggregateColumn extends ChildProperty{constructor(){super(...arguments),this.templateFn={}}setFormatter(cultureName){let valueFormatter=new ej2_grids_es2015_ValueFormatter(cultureName);this.format&&(this.format.skeleton||this.format.format)&&(this.formatFn=valueFormatter.getFormatFunction(this.format))}getFormatter(){return this.formatFn}setTemplate(helper={}){void 0!==this.footerTemplate&&(this.templateFn[getEnumValue(CellType,CellType.Summary)]={fn:compile$$1(this.footerTemplate,helper),property:"footerTemplate"}),void 0!==this.groupFooterTemplate&&(this.templateFn[getEnumValue(CellType,CellType.GroupSummary)]={fn:compile$$1(this.groupFooterTemplate,helper),property:"groupFooterTemplate"}),void 0!==this.groupCaptionTemplate&&(this.templateFn[getEnumValue(CellType,CellType.CaptionSummary)]={fn:compile$$1(this.groupCaptionTemplate,helper),property:"groupCaptionTemplate"})}getTemplate(type){return this.templateFn[getEnumValue(CellType,type)]}setPropertiesSilent(prop){this.setProperties(prop,!0)}}return __decorate([Property()],AggregateColumn.prototype,"type",void 0),__decorate([Property()],AggregateColumn.prototype,"field",void 0),__decorate([Property()],AggregateColumn.prototype,"columnName",void 0),__decorate([Property()],AggregateColumn.prototype,"format",void 0),__decorate([Property()],AggregateColumn.prototype,"footerTemplate",void 0),__decorate([Property()],AggregateColumn.prototype,"groupFooterTemplate",void 0),__decorate([Property()],AggregateColumn.prototype,"groupCaptionTemplate",void 0),__decorate([Property()],AggregateColumn.prototype,"customAggregate",void 0),AggregateColumn})(),ej2_grids_es2015_AggregateRow=(()=>{class AggregateRow extends ChildProperty{}return __decorate([Collection([],ej2_grids_es2015_AggregateColumn)],AggregateRow.prototype,"columns",void 0),AggregateRow})();class ej2_grids_es2015_Clipboard{constructor(parent){this.copyContent="",this.isSelect=!1,this.parent=parent,this.addEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on(contentReady,this.initialEnd,this),this.parent.on(keyPressed,this.keyDownHandler,this),this.parent.on(click,this.clickHandler,this),EventHandler.add(this.parent.element,"keydown",this.pasteHandler,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(keyPressed,this.keyDownHandler),this.parent.off(click,this.clickHandler),EventHandler.remove(this.parent.element,"keydown",this.pasteHandler))}clickHandler(e){let target=e.target;target=parentsUntil(target,"e-rowcell")}pasteHandler(e){if(86===e.keyCode&&e.ctrlKey&&!this.parent.isEdit){let target=closest(document.activeElement,".e-rowcell");if(!target)return;this.activeElement=document.activeElement,this.clipBoardTextArea.value="";let x=window.scrollX,y=window.scrollY;this.clipBoardTextArea.focus(),setTimeout(()=>{this.activeElement.focus(),window.scrollTo(x,y),this.paste(this.clipBoardTextArea.value,parseInt(target.parentElement.getAttribute("aria-rowindex"),10),parseInt(target.getAttribute("aria-colindex"),10))},10)}}paste(data,rowIndex,colIndex){let col,value,isAvail,grid=this.parent,cIdx=colIndex,rIdx=rowIndex;if(!grid.editSettings.allowEditing||"Batch"!==grid.editSettings.mode||"Cell"!==grid.selectionSettings.mode||"Flow"===grid.selectionSettings.cellSelectionMode)return;let cols,mRows,rows=data.split("\n"),dataRows=grid.getDataRows(),isFrozen=this.parent.getFrozenColumns();isFrozen&&(mRows=grid.getMovableDataRows());for(let r=0;r<rows.length;r++){if(cols=rows[r].split("\t"),cIdx=colIndex,r===rows.length-1&&""===rows[r]||isUndefined(grid.getRowByIndex(rIdx))){cIdx++;break}for(let c=0;c<cols.length;c++){if(isAvail=grid.getCellFromIndex(rIdx,cIdx),isFrozen){let mTr=mRows[rIdx];isAvail=!!dataRows[rIdx].querySelector('[aria-colindex="'+cIdx+'"]')||mTr.querySelector('[aria-colindex="'+cIdx+'"]')}if(!isAvail){cIdx++;break}if(value=(col=grid.getColumnByIndex(cIdx)).getParser()?col.getParser()(cols[c]):cols[c],col.allowEditing&&!col.isPrimaryKey&&!col.template){let args={column:col,data:value};this.parent.trigger(beforePaste,args),grid.editModule&&("number"===col.type?this.parent.editModule.updateCell(rIdx,col.field,parseInt(args.data,10)):grid.editModule.updateCell(rIdx,col.field,args.data))}cIdx++}rIdx++}grid.selectionModule.selectCellsByRange({rowIndex:rowIndex,cellIndex:colIndex},{rowIndex:rIdx-1,cellIndex:cIdx-1});let cell=this.parent.getCellFromIndex(rIdx-1,cIdx-1);cell&&ej2_base_es2015_classList(cell,["e-focus","e-focused"],[])}initialEnd(){this.parent.off(contentReady,this.initialEnd),this.clipBoardTextArea=this.parent.createElement("textarea",{className:"e-clipboard",styles:"opacity: 0",attrs:{tabindex:"-1","aria-label":"clipboard"}}),this.parent.element.appendChild(this.clipBoardTextArea)}keyDownHandler(e){"ctrlPlusC"===e.action?this.copy():"ctrlShiftPlusH"===e.action&&this.copy(!0)}setCopyData(withHeader){if(""===window.getSelection().toString()){let mRows,isFrozen=this.parent.getFrozenColumns();this.clipBoardTextArea.value=this.copyContent="";let rows=this.parent.getRows();if(isFrozen&&(mRows=this.parent.getMovableDataRows()),"Cell"!==this.parent.selectionSettings.mode){let selectedIndexes=this.parent.getSelectedRowIndexes().sort((a,b)=>a-b);if(withHeader){let headerTextArray=[];for(let i=0;i<this.parent.getVisibleColumns().length;i++)headerTextArray[i]=this.parent.getVisibleColumns()[i].headerText;this.getCopyData(headerTextArray,!1,"\t",withHeader),this.copyContent+="\n"}for(let i=0;i<selectedIndexes.length;i++){i>0&&(this.copyContent+="\n");let cells=[].slice.call(rows[selectedIndexes[i]].querySelectorAll(".e-rowcell"));isFrozen&&cells.push(...[].slice.call(mRows[selectedIndexes[i]].querySelectorAll(".e-rowcell"))),this.getCopyData(cells,!1,"\t",withHeader)}}else{let obj=this.checkBoxSelection();if(obj.status){if(withHeader){let headers=[];for(let i=0;i<obj.colIndexes.length;i++)headers.push(this.parent.getColumnHeaderByIndex(obj.colIndexes[i]));this.getCopyData(headers,!1,"\t",withHeader),this.copyContent+="\n"}for(let i=0;i<obj.rowIndexes.length;i++){i>0&&(this.copyContent+="\n");let cells=[].slice.call(rows[obj.rowIndexes[i]].querySelectorAll(".e-cellselectionbackground"));isFrozen&&cells.push(...[].slice.call(mRows[obj.rowIndexes[i]].querySelectorAll(".e-cellselectionbackground"))),this.getCopyData(cells,!1,"\t",withHeader)}}else this.getCopyData([].slice.call(this.parent.element.querySelectorAll(".e-cellselectionbackground")),!0,"\n",withHeader)}let args={data:this.copyContent,cancel:!1};if(this.parent.trigger(beforeCopy,args),args.cancel)return;this.clipBoardTextArea.value=this.copyContent=args.data,Browser.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select(),this.isSelect=!0}}getCopyData(cells,isCell,splitKey,withHeader){let isElement="string"!=typeof cells[0];for(let j=0;j<cells.length;j++)withHeader&&isCell&&(this.copyContent+=this.parent.getColumns()[parseInt(cells[j].getAttribute("aria-colindex"),10)].headerText+"\n"),isElement?cells[j].classList.contains("e-hide")||(this.copyContent+=cells[j].textContent):this.copyContent+=cells[j],j<cells.length-1&&(this.copyContent+=splitKey)}copy(withHeader){document.queryCommandSupported("copy")&&(this.setCopyData(withHeader),document.execCommand("copy"),this.clipBoardTextArea.blur()),this.isSelect&&(window.getSelection().removeAllRanges(),this.isSelect=!1)}getModuleName(){return"clipboard"}destroy(){this.removeEventListener(),this.clipBoardTextArea&&ej2_base_es2015_remove(this.clipBoardTextArea)}checkBoxSelection(){let gridObj=this.parent,obj={status:!1};if("Cell"===gridObj.selectionSettings.mode){let str,i,rowCellIndxes=gridObj.getSelectedRowCellIndexes(),rowIndexes=[];for(i=0;i<rowCellIndxes.length&&(rowCellIndxes[i].cellIndexes.length&&rowIndexes.push(rowCellIndxes[i].rowIndex),!rowCellIndxes[i].cellIndexes.length||(str||(str=JSON.stringify(rowCellIndxes[i].cellIndexes.sort())),str===JSON.stringify(rowCellIndxes[i].cellIndexes.sort())));i++);rowIndexes.sort((a,b)=>a-b),i===rowCellIndxes.length&&rowIndexes[rowIndexes.length-1]-rowIndexes[0]==rowIndexes.length-1&&(obj={status:!0,rowIndexes:rowIndexes,colIndexes:rowCellIndxes[0].cellIndexes})}return obj}}var Grid_1;let ej2_grids_es2015_SortDescriptor=(()=>{class SortDescriptor extends ChildProperty{}return __decorate([Property()],SortDescriptor.prototype,"field",void 0),__decorate([Property()],SortDescriptor.prototype,"direction",void 0),__decorate([Property(!1)],SortDescriptor.prototype,"isFromGroup",void 0),SortDescriptor})(),ej2_grids_es2015_SortSettings=(()=>{class SortSettings extends ChildProperty{}return __decorate([Collection([],ej2_grids_es2015_SortDescriptor)],SortSettings.prototype,"columns",void 0),__decorate([Property(!0)],SortSettings.prototype,"allowUnsort",void 0),SortSettings})(),ej2_grids_es2015_Predicate$1=(()=>{class Predicate$1 extends ChildProperty{}return __decorate([Property()],Predicate$1.prototype,"field",void 0),__decorate([Property()],Predicate$1.prototype,"operator",void 0),__decorate([Property()],Predicate$1.prototype,"value",void 0),__decorate([Property()],Predicate$1.prototype,"matchCase",void 0),__decorate([Property()],Predicate$1.prototype,"ignoreAccent",void 0),__decorate([Property()],Predicate$1.prototype,"predicate",void 0),__decorate([Property({})],Predicate$1.prototype,"actualFilterValue",void 0),__decorate([Property({})],Predicate$1.prototype,"actualOperator",void 0),__decorate([Property()],Predicate$1.prototype,"type",void 0),__decorate([Property()],Predicate$1.prototype,"ejpredicate",void 0),__decorate([Property()],Predicate$1.prototype,"uid",void 0),__decorate([Property()],Predicate$1.prototype,"isForeignKey",void 0),Predicate$1})(),ej2_grids_es2015_FilterSettings=(()=>{class FilterSettings extends ChildProperty{}return __decorate([Collection([],ej2_grids_es2015_Predicate$1)],FilterSettings.prototype,"columns",void 0),__decorate([Property("FilterBar")],FilterSettings.prototype,"type",void 0),__decorate([Property()],FilterSettings.prototype,"mode",void 0),__decorate([Property(!0)],FilterSettings.prototype,"showFilterBarStatus",void 0),__decorate([Property(1500)],FilterSettings.prototype,"immediateModeDelay",void 0),__decorate([Property()],FilterSettings.prototype,"operators",void 0),__decorate([Property(!1)],FilterSettings.prototype,"ignoreAccent",void 0),__decorate([Property(!1)],FilterSettings.prototype,"enableCaseSensitivity",void 0),FilterSettings})(),ej2_grids_es2015_SelectionSettings=(()=>{class SelectionSettings extends ChildProperty{}return __decorate([Property("Row")],SelectionSettings.prototype,"mode",void 0),__decorate([Property("Flow")],SelectionSettings.prototype,"cellSelectionMode",void 0),__decorate([Property("Single")],SelectionSettings.prototype,"type",void 0),__decorate([Property(!1)],SelectionSettings.prototype,"checkboxOnly",void 0),__decorate([Property(!1)],SelectionSettings.prototype,"persistSelection",void 0),__decorate([Property("Default")],SelectionSettings.prototype,"checkboxMode",void 0),__decorate([Property(!1)],SelectionSettings.prototype,"enableSimpleMultiRowSelection",void 0),__decorate([Property(!0)],SelectionSettings.prototype,"enableToggle",void 0),SelectionSettings})(),ej2_grids_es2015_SearchSettings=(()=>{class SearchSettings extends ChildProperty{}return __decorate([Property([])],SearchSettings.prototype,"fields",void 0),__decorate([Property("")],SearchSettings.prototype,"key",void 0),__decorate([Property("contains")],SearchSettings.prototype,"operator",void 0),__decorate([Property(!0)],SearchSettings.prototype,"ignoreCase",void 0),__decorate([Property(!1)],SearchSettings.prototype,"ignoreAccent",void 0),SearchSettings})(),ej2_grids_es2015_RowDropSettings=(()=>{class RowDropSettings extends ChildProperty{}return __decorate([Property()],RowDropSettings.prototype,"targetID",void 0),RowDropSettings})(),ej2_grids_es2015_TextWrapSettings=(()=>{class TextWrapSettings extends ChildProperty{}return __decorate([Property("Both")],TextWrapSettings.prototype,"wrapMode",void 0),TextWrapSettings})(),ej2_grids_es2015_GroupSettings=(()=>{class GroupSettings extends ChildProperty{}return __decorate([Property(!0)],GroupSettings.prototype,"showDropArea",void 0),__decorate([Property(!1)],GroupSettings.prototype,"showToggleButton",void 0),__decorate([Property(!1)],GroupSettings.prototype,"showGroupedColumn",void 0),__decorate([Property(!0)],GroupSettings.prototype,"showUngroupButton",void 0),__decorate([Property(!1)],GroupSettings.prototype,"disablePageWiseAggregates",void 0),__decorate([Property([])],GroupSettings.prototype,"columns",void 0),__decorate([Property()],GroupSettings.prototype,"captionTemplate",void 0),GroupSettings})(),ej2_grids_es2015_EditSettings=(()=>{class EditSettings extends ChildProperty{}return __decorate([Property(!1)],EditSettings.prototype,"allowAdding",void 0),__decorate([Property(!1)],EditSettings.prototype,"allowEditing",void 0),__decorate([Property(!1)],EditSettings.prototype,"allowDeleting",void 0),__decorate([Property("Normal")],EditSettings.prototype,"mode",void 0),__decorate([Property(!0)],EditSettings.prototype,"allowEditOnDblClick",void 0),__decorate([Property(!0)],EditSettings.prototype,"showConfirmDialog",void 0),__decorate([Property(!1)],EditSettings.prototype,"showDeleteConfirmDialog",void 0),__decorate([Property("")],EditSettings.prototype,"template",void 0),__decorate([Property("Top")],EditSettings.prototype,"newRowPosition",void 0),__decorate([Property({})],EditSettings.prototype,"dialog",void 0),__decorate([Property(!1)],EditSettings.prototype,"allowNextRowEdit",void 0),EditSettings})(),ej2_grids_es2015_Grid=(()=>{let Grid=Grid_1=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.isPreventScrollEvent=!1,this.inViewIndexes=[],this.media={},this.freezeRefresh=ej2_base_es2015_Component.prototype.refresh,this.isVirtualAdaptive=!1,this.vRows=[],this.vcRows=[],this.vGroupOffsets={},this.currentViewData=[],this.lockcolPositionCount=0,this.prevPageMoving=!1,this.pageTemplateChange=!1,this.enableLogger=!0,this.needsID=!0,Grid_1.Inject(ej2_grids_es2015_Selection),setValue("mergePersistData",this.mergePersistGridData,this)}getPersistData(){let keyEntity=["pageSettings","sortSettings","filterSettings","groupSettings","columns","searchSettings","selectedRowIndex","scrollPosition"],ignoreOnPersist={pageSettings:["template","pageSizes","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent"],groupSettings:["showDropArea","showToggleButton","showGroupedColumn","showUngroupButton","disablePageWiseAggregates","hideCaptionCount"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[],scrollPosition:[]};return keyEntity.forEach(value=>{let currentObject=this[value];for(let val of ignoreOnPersist[value])delete currentObject[val]}),this.pageSettings.template=void 0,this.pageTemplateChange=!isNullOrUndefined(this.pagerTemplate),this.addOnPersist(keyEntity)}requiredModules(){let modules=[];return this.isDestroyed?modules:(this.allowFiltering&&modules.push({member:"filter",args:[this,this.filterSettings,this.serviceLocator]}),this.allowExcelExport&&modules.push({member:"ExcelExport",args:[this,this.serviceLocator]}),this.allowPdfExport&&modules.push({member:"PdfExport",args:[this]}),this.allowSorting&&modules.push({member:"sort",args:[this,this.sortSettings,this.sortedColumns,this.serviceLocator]}),this.allowPaging&&modules.push({member:"pager",args:[this,this.pageSettings]}),this.allowSelection&&modules.push({member:"selection",args:[this,this.selectionSettings,this.serviceLocator]}),modules.push({member:"resize",args:[this]}),this.allowReordering&&modules.push({member:"reorder",args:[this]}),this.allowRowDragAndDrop&&modules.push({member:"rowDragAndDrop",args:[this]}),this.allowGrouping&&modules.push({member:"group",args:[this,this.groupSettings,this.sortedColumns,this.serviceLocator]}),this.aggregates.length&&modules.push({member:"aggregate",args:[this,this.serviceLocator]}),this.isDetail()&&modules.push({member:"detailRow",args:[this,this.serviceLocator]}),(this.toolbar||this.toolbarTemplate)&&modules.push({member:"toolbar",args:[this,this.serviceLocator]}),(this.enableVirtualization||this.enableColumnVirtualization)&&modules.push({member:"virtualscroll",args:[this,this.serviceLocator]}),(this.getFrozenColumns()||this.frozenRows)&&modules.push({member:"freeze",args:[this,this.serviceLocator]}),this.isCommandColumn(this.columns)&&modules.push({member:"commandColumn",args:[this,this.serviceLocator]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&modules.push({member:"edit",args:[this,this.serviceLocator]}),this.extendRequiredModules(modules),modules)}extendRequiredModules(modules){this.contextMenuItems&&modules.push({member:"contextMenu",args:[this,this.serviceLocator]}),this.showColumnMenu&&modules.push({member:"columnMenu",args:[this,this.serviceLocator]}),this.showColumnChooser&&modules.push({member:"columnChooser",args:[this,this.serviceLocator]}),this.isForeignKeyEnabled(this.columns)&&modules.push({member:"foreignKey",args:[this,this.serviceLocator]}),this.enableLogger&&modules.push({member:"logger",args:[this]})}preRender(){this.serviceLocator=new ej2_grids_es2015_ServiceLocator,this.initProperties(),this.initializeServices()}initProperties(){this.isInitial=!0,this.sortedColumns=[],this.inViewIndexes=[],this.mediaCol=[],this.isInitialLoad=!1,this.mergeCells={},this.isEdit=!1,this.checkAllRows="None",this.isCheckBoxSelection=!1,this.isPersistSelection=!1,this.freezeRefresh=ej2_base_es2015_Component.prototype.refresh,this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"},this.defaultLocale={EmptyRecord:"No records to display",True:"true",False:"false",InvalidFilterMessage:"Invalid Filter Data",GroupDropArea:"Drag a column header here to group its column",UnGroup:"Click here to ungroup",GroupDisable:"Grouping is disabled for this column",FilterbarTitle:"'s filter bar cell",EmptyDataSourceError:"DataSource must not be empty at initial load since columns are generated from dataSource in AutoGenerate Column Grid",Add:"Add",Edit:"Edit",Cancel:"Cancel",Update:"Update",Delete:"Delete",Print:"Print",Pdfexport:"PDF Export",Excelexport:"Excel Export",Wordexport:"Word Export",Csvexport:"CSV Export",Search:"Search",Columnchooser:"Columns",Save:"Save",Item:"item",Items:"items",EditOperationAlert:"No records selected for edit operation",DeleteOperationAlert:"No records selected for delete operation",SaveButton:"Save",OKButton:"OK",CancelButton:"Cancel",EditFormTitle:"Details of ",AddFormTitle:"Add New Record",BatchSaveConfirm:"Are you sure you want to save changes?",BatchSaveLostChanges:"Unsaved changes will be lost. Are you sure you want to continue?",ConfirmDelete:"Are you sure you want to Delete Record?",CancelEdit:"Are you sure you want to Cancel the changes?",ChooseColumns:"Choose Column",SearchColumns:"search columns",Matchs:"No Matches Found",FilterButton:"Filter",ClearButton:"Clear",StartsWith:"Starts With",EndsWith:"Ends With",Contains:"Contains",Equal:"Equal",NotEqual:"Not Equal",LessThan:"Less Than",LessThanOrEqual:"Less Than Or Equal",GreaterThan:"Greater Than",GreaterThanOrEqual:"Greater Than Or Equal",ChooseDate:"Choose a Date",EnterValue:"Enter the value",Copy:"Copy",Group:"Group by this column",Ungroup:"Ungroup by this column",autoFitAll:"Autofit all columns",autoFit:"Autofit this column",Export:"Export",FirstPage:"First Page",LastPage:"Last Page",PreviousPage:"Previous Page",NextPage:"Next Page",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",EditRecord:"Edit Record",DeleteRecord:"Delete Record",FilterMenu:"Filter",SelectAll:"Select All",Blanks:"Blanks",FilterTrue:"True",FilterFalse:"False",NoResult:"No Matches Found",ClearFilter:"Clear Filter",NumberFilter:"Number Filters",TextFilter:"Text Filters",DateFilter:"Date Filters",DateTimeFilter:"DateTime Filters",MatchCase:"Match Case",Between:"Between",CustomFilter:"Custom Filter",CustomFilterPlaceHolder:"Enter the value",CustomFilterDatePlaceHolder:"Choose a date",AND:"AND",OR:"OR",ShowRowsWhere:"Show rows where:"},this.keyConfigs={downArrow:"downarrow",upArrow:"uparrow",rightArrow:"rightarrow",leftArrow:"leftarrow",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftRight:"shift+rightarrow",shiftLeft:"shift+leftarrow",home:"home",end:"end",escape:"escape",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",pageUp:"pageup",pageDown:"pagedown",ctrlAltPageUp:"ctrl+alt+pageup",ctrlAltPageDown:"ctrl+alt+pagedown",altPageUp:"alt+pageup",altPageDown:"alt+pagedown",altDownArrow:"alt+downarrow",altUpArrow:"alt+uparrow",ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlPlusA:"ctrl+A",ctrlPlusP:"ctrl+P",insert:"insert",delete:"delete",f2:"f2",enter:"enter",ctrlEnter:"ctrl+enter",shiftEnter:"shift+enter",tab:"tab",shiftTab:"shift+tab",space:"space",ctrlPlusC:"ctrl+C",ctrlShiftPlusH:"ctrl+shift+H"}}render(){this.log(["module_missing","promise_enabled","locale_missing","check_datasource_columns"]),this.ariaService.setOptions(this.element,{role:"grid"}),isBlazor()&&this.renderComplete(),createSpinner({target:this.element},this.createElement),this.renderModule=new ej2_grids_es2015_Render(this,this.serviceLocator),this.searchModule=new ej2_grids_es2015_Search(this),this.scrollModule=new ej2_grids_es2015_Scroll(this),this.notify(initialLoad,{}),!0!==this.getDataModule().dataManager.dataSource.offline&&void 0!==this.getDataModule().dataManager.dataSource.url||(this.isVirtualAdaptive=!0),this.trigger("load"),prepareColumns(this.columns,this.enableColumnVirtualization),this.getMediaColumns(),setColumnIndex(this.columns),this.checkLockColumns(this.columns),this.getColumns(),this.processModel(),this.gridRender(),this.wireEvents(),this.addListener(),this.updateDefaultCursor(),this.updateStackedFilter(),this.showSpinner(),this.notify(initialEnd,{})}showSpinner(){showSpinner(this.element)}hideSpinner(){hideSpinner(this.element)}updateStackedFilter(){this.allowFiltering&&"FilterBar"===this.filterSettings.type&&this.getHeaderContent().querySelectorAll(".e-stackedheadercell").length?this.getHeaderContent().classList.add("e-stackedfilter"):this.getHeaderContent().classList.remove("e-stackedfilter")}getMediaColumns(){if(!this.enableColumnVirtualization){let gcol=this.getColumns();if(this.getShowHideService=this.serviceLocator.getService("showHideService"),!isNullOrUndefined(gcol))for(let index=0;index<gcol.length;index++)isNullOrUndefined(gcol[index].hideAtMedia)||!isNullOrUndefined(gcol[index].visible)&&!gcol[index].visible||this.pushMediaColumn(gcol[index],index)}}pushMediaColumn(col,index){this.mediaCol.push(col),this.media[col.uid]=window.matchMedia(col.hideAtMedia),this.mediaQueryUpdate(index,this.media[col.uid]),this.media[col.uid].addListener(this.mediaQueryUpdate.bind(this,index))}updateMediaColumns(col){if(!this.enableColumnVirtualization){let index=this.getColumnIndexByUid(col.uid);for(let i=0;i<this.mediaCol.length;i++)if(col.uid===this.mediaCol[i].uid)return void this.mediaCol.splice(i,1);this.pushMediaColumn(col,index)}}mediaQueryUpdate(columnIndex,e){let col=this.getColumns()[columnIndex];this.mediaCol.some(mediaColumn=>mediaColumn.uid===col.uid)&&(col.visible=e.matches,this.isInitialLoad&&(this.invokedFromMedia=!0,col.visible?this.showHider.show(col.headerText,"headerText"):this.showHider.hide(col.headerText,"headerText")))}refreshMediaCol(){this.isInitialLoad=!0,this.aggregates.length&&this.element.scrollHeight>this.height&&addClass([this.element.querySelector(".e-gridfooter")],["e-footerpadding"]),this.getColumns().filter(col=>"checkbox"===col.type).length&&"ResetOnRowClick"===this.selectionSettings.checkboxMode&&(this.isCheckBoxSelection=!1,this.refreshHeader())}eventInitializer(){}destroy(){let gridElement=this.element;if(!gridElement)return;let hasGridChild=!(!gridElement.querySelector(".e-gridheader")||!gridElement.querySelector(".e-gridcontent"));hasGridChild&&this.unwireEvents(),this.removeListener(),this.notify(ej2_grids_es2015_destroy,{}),this.destroyDependentModules(),hasGridChild&&super.destroy(),this.toolTipObj.destroy();let modules=["renderModule","headerModule","contentModule","valueFormatterService","serviceLocator","ariaService","keyboardModule","widthService","searchModule","showHider","scrollModule","printModule","clipboardModule","focusModule"];for(let i=0;i<modules.length;i++)this[modules[i]]&&(this[modules[i]]=null);this.element.innerHTML="",ej2_base_es2015_classList(this.element,[],["e-rtl","e-gridhover","e-responsive","e-default","e-device","e-grid-min-height"])}destroyDependentModules(){let gridElement=this.element;gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.scrollModule.destroy(),this.keyboardModule.destroy(),this.focusModule.destroy())}getModuleName(){return"grid"}enableBoxSelection(){this.enableAutoFill&&(this.selectionSettings.cellSelectionMode="BoxWithBorder")}onPropertyChanged(newProp,oldProp){let checkCursor,requireRefresh=!1,requireGridRefresh=!1,freezeRefresh$$1=!1;if(this.isDestroyed)return;this.log("module_missing");let properties=Object.keys(newProp);properties.indexOf("columns")>-1&&(this.updateColumnObject(),requireGridRefresh=!0);for(let prop of properties)switch(prop){case"allowPaging":this.notify(uiUpdate,{module:"pager",enable:this.allowPaging}),requireRefresh=!0;break;case"pageSettings":if(this.pageTemplateChange){this.pageTemplateChange=!1;break}this.notify(inBoundModelChanged,{module:"pager",properties:newProp.pageSettings}),(isNullOrUndefined(newProp.pageSettings.currentPage)&&isNullOrUndefined(newProp.pageSettings.pageSize)&&isNullOrUndefined(newProp.pageSettings.totalRecordsCount)||!isNullOrUndefined(oldProp.pageSettings)&&newProp.pageSettings.currentPage!==oldProp.pageSettings.currentPage&&!this.enableColumnVirtualization&&!this.enableVirtualization&&this.pageSettings.totalRecordsCount<=this.pageSettings.pageSize)&&(requireRefresh=!0);break;case"allowSorting":this.notify(uiUpdate,{module:"sort",enable:this.allowSorting}),requireRefresh=!0,checkCursor=!0;break;case"allowFiltering":this.updateStackedFilter(),this.notify(uiUpdate,{module:"filter",enable:this.allowFiltering}),requireRefresh=!0,"FilterBar"!==this.filterSettings.type&&this.refreshHeader();break;case"height":case"width":this.notify(uiUpdate,{module:"scroll",properties:{width:newProp.width,height:newProp.height}});break;case"allowReordering":this.headerModule.refreshUI(),checkCursor=!0;break;case"allowRowDragAndDrop":this.notify(uiUpdate,{module:"rowDragAndDrop",enable:this.allowRowDragAndDrop});break;case"allowSelection":this.notify(uiUpdate,{module:"selection",enable:this.allowSelection});break;case"enableAutoFill":this.selectionModule&&(this.enableBoxSelection(),this.selectionModule.updateAutoFillPosition());break;case"rowTemplate":this.rowTemplateFn=ej2_grids_es2015_templateCompiler(this.rowTemplate),requireRefresh=!0;break;case"detailTemplate":this.detailTemplateFn=ej2_grids_es2015_templateCompiler(this.detailTemplate),requireRefresh=!0;break;case"allowGrouping":this.notify(uiUpdate,{module:"group",enable:this.allowGrouping}),this.headerModule.refreshUI(),requireRefresh=!0,checkCursor=!0;break;case"childGrid":requireRefresh=!0;break;case"toolbar":this.notify(uiUpdate,{module:"toolbar"});break;case"groupSettings":this.notify(inBoundModelChanged,{module:"group",properties:newProp.groupSettings,oldProperties:oldProp.groupSettings});break;case"aggregates":!this.aggregates.length&&this.allowGrouping&&this.groupSettings.columns.length&&(requireRefresh=!0),this.notify(uiUpdate,{module:"aggregate",properties:newProp});break;case"frozenColumns":case"frozenRows":case"enableVirtualization":case"currencyCode":case"locale":this.log("frozen_rows_columns"),freezeRefresh$$1=!0,requireGridRefresh=!0;break;case"query":requireRefresh=!0;break;default:this.extendedPropertyChange(prop,newProp,requireGridRefresh)}checkCursor&&this.updateDefaultCursor(),requireGridRefresh?freezeRefresh$$1||this.frozenColumns||this.frozenRows?this.freezeRefresh():this.refresh():requireRefresh&&(this.notify(modelChanged,{requestType:"refresh"}),requireRefresh=!1,this.maintainSelection(newProp.selectedRowIndex))}extendedPropertyChange(prop,newProp,requireGridRefresh){switch(prop){case"enableRtl":this.updateRTL(),this.allowPaging&&(this.element.querySelector(".e-gridpager").ej2_instances[0].enableRtl=newProp.enableRtl,this.element.querySelector(".e-gridpager").ej2_instances[0].dataBind()),"auto"!==this.height&&(this.scrollModule.removePadding(!newProp.enableRtl),this.scrollModule.setPadding()),this.toolbar&&this.toolbarModule&&(this.toolbarModule.getToolbar().ej2_instances[0].enableRtl=newProp.enableRtl,this.toolbarModule.getToolbar().ej2_instances[0].dataBind()),this.contextMenuItems&&this.contextMenuModule&&(this.contextMenuModule.getContextMenu().ej2_instances[0].enableRtl=newProp.enableRtl,this.contextMenuModule.getContextMenu().ej2_instances[0].dataBind()),this.showColumnMenu&&this.columnMenuModule&&(this.columnMenuModule.getColumnMenu().ej2_instances[0].enableRtl=newProp.enableRtl,this.columnMenuModule.getColumnMenu().ej2_instances[0].dataBind()),this.notify("rtl-updated",{});break;case"enableAltRow":this.renderModule.refresh();break;case"allowResizing":this.headerModule.refreshUI(),this.updateResizeLines();break;case"rowHeight":this.rowHeight?addClass([this.element],"e-grid-min-height"):removeClass([this.element],"e-grid-min-height"),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"gridLines":this.updateGridLines();break;case"showColumnMenu":this.headerModule.refreshUI(),this.notify(uiUpdate,{module:"columnMenu",enable:!0});break;case"columnMenuItems":this.notify(uiUpdate,{module:"columnMenu",enable:this.columnMenuItems});break;case"contextMenuItems":this.notify(uiUpdate,{module:"contextMenu",enable:this.contextMenuItems});break;case"showColumnChooser":this.notify(uiUpdate,{module:"columnChooser",enable:this.showColumnChooser});break;case"filterSettings":this.updateStackedFilter(),this.notify(inBoundModelChanged,{module:"filter",properties:newProp.filterSettings});break;case"searchSettings":this.notify(inBoundModelChanged,{module:"search",properties:newProp.searchSettings});break;case"sortSettings":this.notify(inBoundModelChanged,{module:"sort"});break;case"selectionSettings":this.notify(inBoundModelChanged,{module:"selection",properties:newProp.selectionSettings});break;case"editSettings":this.notify(inBoundModelChanged,{module:"edit",properties:newProp.editSettings});break;case"allowTextWrap":case"textWrapSettings":this.allowTextWrap?this.applyTextWrap():this.removeTextWrap(),this.notify(freezeRender,{case:"textwrap",isModeChg:"textWrapSettings"===prop});break;case"dataSource":let pending=this.getDataModule().getState();if(Object.getPrototypeOf(newProp).deepWatch){let pKeyField=this.getPrimaryKeyFieldNames()[0];for(let i=0,props=Object.keys(newProp.dataSource);i<props.length;i++)this.setRowData(getValue(pKeyField,this.dataSource[props[i]]),this.dataSource[props[i]])}else if(pending.isPending){let gResult=isNullOrUndefined(this.dataSource)?[]:this.dataSource.result;(pending.group||[]).forEach(name=>{gResult=ej2_data_es2015_DataUtil.group(gResult,name,pending.aggregates||[])}),this.dataSource={result:gResult,count:this.dataSource.count,aggregates:this.dataSource.aggregates},this.getDataModule().setState({}),pending.resolver(this.dataSource)}else this.getDataModule().setState({isDataChanged:!1}),this.notify(dataSourceModified,{}),requireGridRefresh||this.renderModule.refresh();break;case"enableHover":(newProp.enableHover?addClass:removeClass)([this.element],"e-gridhover");break;case"selectedRowIndex":this.isSelectedRowIndexUpdating||this.selectRow(newProp.selectedRowIndex),this.isSelectedRowIndexUpdating=!1}}maintainSelection(index){if(-1!==index){let fn=()=>{this.selectRow(index),this.off(contentReady,fn)};this.on(contentReady,fn,this)}}setProperties(prop,muteOnChange){super.setProperties(prop,muteOnChange),prop.filterSettings&&this.filterModule&&muteOnChange&&this.filterModule.refreshFilter()}updateDefaultCursor(){let headerRows=[].slice.call(this.element.querySelectorAll(".e-columnheader"));for(let row of headerRows)this.allowSorting||this.allowGrouping&&this.groupSettings.showDropArea||this.allowReordering?row.classList.remove("e-defaultcursor"):row.classList.add("e-defaultcursor")}updateColumnModel(columns){for(let i=0,len=columns.length;i<len;i++)columns[i].columns?this.updateColumnModel(columns[i].columns):this.columnModel.push(columns[i]);this.updateFrozenColumns(),this.updateLockableColumns()}updateFrozenColumns(){let cols=this.columnModel,count=0;for(let i=0,len=cols.length;i<len;i++)cols[i].isFrozen&&(cols.splice(this.frozenColumns+count,0,cols.splice(i,1)[0]),count++)}updateLockableColumns(){let cols=this.columnModel,frozenCount=0,movableCount=0,frozenColumns=this.getFrozenColumns();for(let i=0;i<cols.length;i++)cols[i].lockColumn&&(i<frozenColumns?(cols.splice(frozenCount,0,cols.splice(i,1)[0]),frozenCount++):(cols.splice(frozenColumns+movableCount,0,cols.splice(i,1)[0]),movableCount++))}checkLockColumns(cols){for(let i=0;i<cols.length;i++)cols[i].columns?this.checkLockColumns(cols[i].columns):cols[i].lockColumn&&this.lockcolPositionCount++}getColumns(isRefresh){let inview=this.inViewIndexes.map(v=>v-this.groupSettings.columns.length).filter(v=>v>-1),vLen=inview.length;return(!this.enableColumnVirtualization||isNullOrUndefined(this.columnModel)||0===this.columnModel.length||isRefresh)&&(this.columnModel=[],this.updateColumnModel(this.columns)),0===vLen?this.columnModel:this.columnModel.slice(inview[0],inview[vLen-1]+1)}getStackedHeaderColumnByHeaderText(stackedHeader,col){for(let i=0;i<col.length;i++){let individualColumn=col[i];if(individualColumn.field===stackedHeader||individualColumn.headerText===stackedHeader){this.stackedColumn=individualColumn;break}individualColumn.columns&&this.getStackedHeaderColumnByHeaderText(stackedHeader,individualColumn.columns)}return this.stackedColumn}getColumnIndexesInView(){return this.inViewIndexes}getQuery(){return this.query}getLocaleConstants(){return this.defaultLocale}setColumnIndexesInView(indexes){this.inViewIndexes=indexes}getVisibleColumns(){let cols=[];for(let col of this.columnModel)col.visible&&cols.push(col);return cols}getHeaderContent(){return this.headerModule.getPanel()}setGridHeaderContent(element){this.headerModule.setPanel(element)}getContentTable(){return this.contentModule.getTable()}setGridContentTable(element){this.contentModule.setTable(element)}getContent(){return this.contentModule.getPanel()}setGridContent(element){this.contentModule.setPanel(element)}getHeaderTable(){return this.headerModule.getTable()}setGridHeaderTable(element){this.headerModule.setTable(element)}getFooterContent(){return isNullOrUndefined(this.footerElement)&&(this.footerElement=this.element.getElementsByClassName("e-gridfooter")[0]),this.footerElement}getFooterContentTable(){return isNullOrUndefined(this.footerElement)&&(this.footerElement=this.element.getElementsByClassName("e-gridfooter")[0]),this.footerElement.firstChild.firstChild}getPager(){return this.gridPager}setGridPager(element){this.gridPager=element}getRowByIndex(index){return this.contentModule.getRowByIndex(index)}getMovableRowByIndex(index){return this.contentModule.getMovableRowByIndex(index)}getRows(){return this.contentModule.getRowElements()}getRowInfo(target){let ele=target,args={target:target};if(!isNullOrUndefined(target)&&isNullOrUndefined(parentsUntil(ele,"e-detailrowcollapse")&&isNullOrUndefined(parentsUntil(ele,"e-recordplusexpand")))&&!this.isEdit){let cell=closest(ele,".e-rowcell");if(!cell)return args;let cellIndex=parseInt(cell.getAttribute("aria-colindex"),10);if(!isNullOrUndefined(cell)&&!isNaN(cellIndex)){let column,row=closest(cell,".e-row"),rowIndex=parseInt(row.getAttribute("aria-rowindex"),10),frzCols=this.getFrozenColumns(),isMovable=!!frzCols&&cellIndex>=frzCols,rowsObject=(isMovable?this.contentModule.getMovableRows():this.contentModule.getRows()).filter(r=>r.uid===row.getAttribute("data-uid")),rowData={};Object.keys(rowsObject).length&&(rowData=rowsObject[0].data,column=rowsObject[0].cells[isMovable?cellIndex-frzCols:cellIndex].column),args={cell:cell,cellIndex:cellIndex,row:row,rowIndex:rowIndex,rowData:rowData,column:column,target:target}}}return args}getMovableRows(){return this.contentModule.getMovableRowElements()}getDataRows(){let rows=[].slice.call(this.getContentTable().querySelector("tbody").children);if(this.frozenRows){let freezeRows=[].slice.call(this.getHeaderTable().querySelector("tbody").children);rows=this.addMovableRows(freezeRows,rows)}return this.generateDataRows(rows)}addMovableRows(fRows,mrows){for(let i=0,len=mrows.length;i<len;i++)fRows.push(mrows[i]);return fRows}generateDataRows(rows){let dRows=[];for(let i=0,len=rows.length;i<len;i++)rows[i].classList.contains("e-row")&&!rows[i].classList.contains("e-hiddenrow")&&dRows.push(rows[i]);return dRows}getMovableDataRows(){let rows=[].slice.call(this.getContent().querySelector(".e-movablecontent").querySelector("tbody").children);if(this.frozenRows){let freezeRows=[].slice.call(this.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").children);rows=this.addMovableRows(freezeRows,rows)}return this.generateDataRows(rows)}setCellValue(key,field,value){let fieldIdx,col,tr,mTr,pkName=this.getPrimaryKeyFieldNames()[0],cell=new ej2_grids_es2015_CellRenderer(this,this.serviceLocator),selectedRow={},movableSelectedRow={},rowObjects=this.contentModule.getRows(),movableRowObjects=this.contentModule.getMovableRows();if(fieldIdx=this.getColumnIndexByField(field),(this.groupSettings.columns.length>0||this.childGrid||this.detailTemplate)&&(fieldIdx+=1),col=this.getColumnByField(field),selectedRow=rowObjects.filter(r=>getValue(pkName,r.data)===key)[0],movableSelectedRow=movableRowObjects.filter(r=>getValue(pkName,r.data)===key)[0],tr=isNullOrUndefined(selectedRow)?null:this.element.querySelector("[data-uid="+selectedRow.uid+"]"),mTr=isNullOrUndefined(movableSelectedRow)?null:this.element.querySelector("[data-uid="+movableSelectedRow.uid+"]"),!isNullOrUndefined(tr)){setValue(field,value,selectedRow.data);let td=isNullOrUndefined(tr.childNodes[fieldIdx])?mTr.childNodes[fieldIdx-this.frozenColumns]:tr.childNodes[fieldIdx];if(!isNullOrUndefined(td)){let mRow,sRow=selectedRow.cells[fieldIdx];this.frozenColumns&&(mRow=movableSelectedRow.cells[fieldIdx-this.frozenColumns]),cell.refreshTD(td,isNullOrUndefined(sRow)?mRow:sRow,selectedRow.data,{index:selectedRow.index}),this.aggregates.length>0&&(this.notify(refreshFooterRenderer,{}),this.groupSettings.columns.length>0&&this.notify(groupAggregates,{})),isNullOrUndefined(movableSelectedRow)||isNullOrUndefined(movableSelectedRow.changes)||(movableSelectedRow.changes[field]=value),this.trigger(queryCellInfo,{cell:td,column:col,data:selectedRow.data})}}}setRowData(key,rowData){let selectedRow,rowObjects=this.contentModule.getRows(),pkName=this.getPrimaryKeyFieldNames()[0],rowRenderer=new ej2_grids_es2015_RowRenderer(this.serviceLocator,null,this);this.groupSettings.columns.length>0&&this.aggregates.length>0&&(rowObjects=rowObjects.filter(row=>row.isDataRow)),!isNullOrUndefined(selectedRow=rowObjects.filter(r=>getValue(pkName,r.data)===key)[0])&&this.element.querySelectorAll("[data-uid="+selectedRow.uid+"]").length&&(selectedRow.changes=rowData,refreshForeignData(selectedRow,this.getForeignKeyColumns(),selectedRow.changes),rowRenderer.refresh(selectedRow,this.getColumns(),!0),this.aggregates.length>0&&(this.notify(refreshFooterRenderer,{}),this.groupSettings.columns.length>0&&this.notify(groupAggregates,{})))}getCellFromIndex(rowIndex,columnIndex){return this.getDataRows()[rowIndex]&&this.getDataRows()[rowIndex].querySelectorAll(".e-rowcell")[columnIndex]}getMovableCellFromIndex(rowIndex,columnIndex){return this.getMovableDataRows()[rowIndex]&&this.getMovableDataRows()[rowIndex].querySelectorAll(".e-rowcell")[columnIndex-this.getFrozenColumns()]}getColumnHeaderByIndex(index){return this.getHeaderTable().querySelectorAll(".e-headercell")[index]}getRowObjectFromUID(uid){let rows=this.contentModule.getRows(),row=this.rowObject(rows,uid);return this.getFrozenColumns()&&!row?row=this.rowObject(this.contentModule.getMovableRows(),uid):row}rowObject(rows,uid){for(let row of rows)if(row.uid===uid)return row;return null}getRowsObject(){return this.contentModule.getRows()}getMovableRowsObject(){return this.contentModule.getMovableRows()}getColumnHeaderByField(field){return this.getColumnHeaderByUid(this.getColumnByField(field).uid)}getColumnHeaderByUid(uid){return this.getHeaderContent().querySelector("[e-mappinguid="+uid+"]").parentElement}getColumnByIndex(index){let column;return this.getColumns().some((col,i)=>(column=col,i===index)),column}getColumnByField(field){return iterateArrayOrObject(this.getColumns(),(item,index)=>{if(item.field===field)return item})[0]}getColumnIndexByField(field){let cols=this.getColumns();for(let i=0;i<cols.length;i++)if(cols[i].field===field)return i;return-1}getColumnByUid(uid){return iterateArrayOrObject([...this.getColumns(),...this.getStackedColumns(this.columns)],(item,index)=>{if(item.uid===uid)return item})[0]}getStackedColumns(columns,stackedColumn=[]){for(const column of columns)column.columns&&(stackedColumn.push(column),this.getStackedColumns(column.columns,stackedColumn));return stackedColumn}getColumnIndexByUid(uid){let index=iterateArrayOrObject(this.getColumns(),(item,index)=>{if(item.uid===uid)return index})[0];return isNullOrUndefined(index)?-1:index}getUidByColumnField(field){return iterateArrayOrObject(this.getColumns(),(item,index)=>{if(item.field===field)return item.uid})[0]}getNormalizedColumnIndex(uid){let index=this.getColumnIndexByUid(uid);return this.allowGrouping&&(index+=this.groupSettings.columns.length),this.isDetail()&&index++,this.allowRowDragAndDrop&&this.allowResizing&&index++,index}getColumnFieldNames(){let column,columnNames=[];for(let i=0,len=this.getColumns().length;i<len;i++)(column=this.getColumns()[i]).visible&&columnNames.push(column.field);return columnNames}getRowTemplate(){return this.rowTemplateFn}getDetailTemplate(){return this.detailTemplateFn}getEditTemplate(){return this.editTemplateFn}getPrimaryKeyFieldNames(){let keys=[];for(let k=0;k<this.columnModel.length;k++)this.columnModel[k].isPrimaryKey&&keys.push(this.columnModel[k].field);return keys}refresh(){this.headerModule.refreshUI(),this.updateStackedFilter(),this.renderModule.refresh()}refreshHeader(){this.headerModule.refreshUI()}getSelectedRows(){return this.selectionModule?this.selectionModule.selectedRecords:[]}getSelectedRowIndexes(){return this.selectionModule?this.selectionModule.selectedRowIndexes:[]}getSelectedRowCellIndexes(){return this.selectionModule?this.selectionModule.selectedRowCellIndexes:[]}getSelectedRecords(){return this.selectionModule?this.selectionModule.getSelectedRecords():[]}getDataModule(){return this.renderModule.data}showColumns(keys,showBy){this.showHider.show(keys,showBy=showBy||"headerText")}hideColumns(keys,hideBy){this.showHider.hide(keys,hideBy=hideBy||"headerText")}getFrozenColumns(){return this.frozenColumns+this.getFrozenCount(this.columns,0)}getVisibleFrozenColumns(){return this.getVisibleFrozenColumnsCount()+this.getVisibleFrozenCount(this.columns,0)}getVisibleFrozenColumnsCount(){let visibleFrozenColumns=0,col=this.columns;for(let i=0;i<this.frozenColumns;i++)col[i].visible&&visibleFrozenColumns++;return visibleFrozenColumns}getVisibleFrozenCount(cols,cnt){for(let i=0,len=cols.length;i<len;i++)cols[i].columns?cnt=this.getVisibleFrozenCount(cols[i].columns,cnt):cols[i].isFrozen&&cols[i].visible&&cnt++;return cnt}getFrozenCount(cols,cnt){for(let i=0,len=cols.length;i<len;i++)cols[i].columns?cnt=this.getFrozenCount(cols[i].columns,cnt):cols[i].isFrozen&&cnt++;return cnt}goToPage(pageNo){this.pagerModule&&this.pagerModule.goToPage(pageNo)}updateExternalMessage(message){this.pagerModule&&this.pagerModule.updateExternalMessage(message)}sortColumn(columnName,direction,isMultiSort){this.sortModule&&this.sortModule.sortColumn(columnName,direction,isMultiSort)}clearSorting(){this.sortModule&&this.sortModule.clearSorting()}removeSortColumn(field){this.sortModule&&this.sortModule.removeSortColumn(field)}filterByColumn(fieldName,filterOperator,filterValue,predicate,matchCase,ignoreAccent,actualFilterValue,actualOperator){this.filterModule&&this.filterModule.filterByColumn(fieldName,filterOperator,filterValue,predicate,matchCase,ignoreAccent,actualFilterValue,actualOperator)}clearFiltering(){this.filterModule&&this.filterModule.clearFiltering()}removeFilteredColsByField(field,isClearFilterBar){this.filterModule&&this.filterModule.removeFilteredColsByField(field,isClearFilterBar)}selectRow(index,isToggle){this.selectionModule&&this.selectionModule.selectRow(index,isToggle)}selectRows(rowIndexes){this.selectionModule&&this.selectionModule.selectRows(rowIndexes)}clearSelection(){this.selectionModule&&this.selectionModule.clearSelection()}selectCell(cellIndex,isToggle){this.selectionModule&&this.selectionModule.selectCell(cellIndex,isToggle)}selectCellsByRange(startIndex,endIndex){this.selectionModule.selectCellsByRange(startIndex,endIndex)}search(searchString){this.searchModule&&this.searchModule.search(searchString)}print(){this.printModule&&this.printModule.print()}deleteRecord(fieldname,data){this.editModule&&this.editModule.deleteRecord(fieldname,data)}startEdit(){this.editModule&&this.editModule.startEdit()}endEdit(){this.editModule&&this.editModule.endEdit()}closeEdit(){this.editModule&&this.editModule.closeEdit()}addRecord(data,index){this.editModule&&this.editModule.addRecord(data,index)}deleteRow(tr){this.editModule&&this.editModule.deleteRow(tr)}editCell(index,field){this.editModule&&this.editModule.editCell(index,field)}saveCell(){this.editModule&&this.editModule.saveCell()}updateCell(rowIndex,field,value){this.editModule&&this.editModule.updateCell(rowIndex,field,value)}updateRow(index,data){this.editModule&&this.editModule.updateRow(index,data)}getBatchChanges(){return this.editModule?this.editModule.getBatchChanges():{}}enableToolbarItems(items,isEnable){this.toolbarModule&&this.toolbarModule.enableItems(items,isEnable)}copy(withHeader){this.clipboardModule&&this.clipboardModule.copy(withHeader)}recalcIndentWidth(){if(!this.getHeaderTable().querySelector(".e-emptycell"))return;if(!this.groupSettings.columns.length&&!this.isDetail()&&!this.isRowDragable()||this.getHeaderTable().querySelector(".e-emptycell").getAttribute("indentRefreshed")||!this.getContentTable())return;let indentWidth=this.getHeaderTable().querySelector(".e-emptycell").parentElement.offsetWidth,headerCol=[].slice.call(this.getHeaderTable().querySelector("colgroup").childNodes),contentCol=[].slice.call(this.getContentTable().querySelector("colgroup").childNodes),perPixel=indentWidth/30,i=0;for(perPixel>=1&&(indentWidth=30/perPixel),this.enableColumnVirtualization&&(indentWidth=30);i<this.groupSettings.columns.length;)headerCol[i].style.width=indentWidth+"px",contentCol[i].style.width=indentWidth+"px",this.notify(columnWidthChanged,{index:i,width:indentWidth}),i++;this.isDetail()&&(headerCol[i].style.width=indentWidth+"px",contentCol[i].style.width=indentWidth+"px",this.notify(columnWidthChanged,{index:i,width:indentWidth}),i++),this.isRowDragable()&&(headerCol[i].style.width=indentWidth+"px",contentCol[i].style.width=indentWidth+"px",this.notify(columnWidthChanged,{index:i,width:indentWidth})),this.getHeaderTable().querySelector(".e-emptycell").setAttribute("indentRefreshed","true")}isRowDragable(){return this.allowRowDragAndDrop&&!this.rowDropSettings.targetID}reorderColumns(fromFName,toFName){this.reorderModule&&this.reorderModule.reorderColumns(fromFName,toFName)}reorderColumnByIndex(fromIndex,toIndex){this.reorderModule&&this.reorderModule.reorderColumnByIndex(fromIndex,toIndex)}reorderColumnByTargetIndex(fieldName,toIndex){this.reorderModule&&this.reorderModule.reorderColumnByTargetIndex(fieldName,toIndex)}reorderRows(fromIndexes,toIndex){this.rowDragAndDropModule&&this.rowDragAndDropModule.reorderRows(fromIndexes,toIndex)}refreshDataSource(e,args){this.notify("refreshdataSource",e)}disableRowDD(enable){let headerTable=this.getHeaderTable(),contentTable=this.getContentTable(),headerRows=headerTable.querySelectorAll("th.e-rowdragheader, th.e-mastercell"),rows=this.getRows(),disValue=enable?"none":"";setStyleAttribute(headerTable.querySelector("colgroup").childNodes[0],{display:disValue}),setStyleAttribute(contentTable.querySelector("colgroup").childNodes[0],{display:disValue});for(let i=0;i<this.getRows().length;i++){let ele=rows[i].firstElementChild;enable?addClass([ele],"e-hide"):removeClass([ele],["e-hide"])}for(let j=0;j<headerTable.querySelectorAll("th.e-rowdragheader, th.e-mastercell").length;j++){let ele=headerRows[j];enable?addClass([ele],"e-hide"):removeClass([ele],["e-hide"])}}autoFitColumns(fieldNames){this.resizeModule&&this.resizeModule.autoFitColumns(fieldNames)}createColumnchooser(x,y,target){this.columnChooserModule&&this.columnChooserModule.renderColumnChooser(x,y,target)}initializeServices(){this.serviceLocator.register("widthService",this.widthService=new ej2_grids_es2015_ColumnWidthService(this)),this.serviceLocator.register("cellRendererFactory",new ej2_grids_es2015_CellRendererFactory),this.serviceLocator.register("rendererFactory",new ej2_grids_es2015_RendererFactory),this.serviceLocator.register("localization",this.localeObj=new L10n(this.getModuleName(),this.defaultLocale,this.locale)),this.serviceLocator.register("valueFormatter",this.valueFormatterService=new ej2_grids_es2015_ValueFormatter(this.locale)),this.serviceLocator.register("showHideService",this.showHider=new ej2_grids_es2015_ShowHide(this)),this.serviceLocator.register("ariaService",this.ariaService=new AriaService),this.serviceLocator.register("focus",this.focusModule=new ej2_grids_es2015_FocusStrategy(this))}processModel(){let flag,j,gCols=this.groupSettings.columns,sCols=this.sortSettings.columns;if(this.allowGrouping)for(let i=0,len=gCols.length;i<len;i++){j=0;for(let sLen=sCols.length;j<sLen;j++)if(sCols[j].field===gCols[i]){flag=!0;break}if(flag?this.allowSorting?this.sortedColumns.push(sCols[j].field):sCols[j].direction="Ascending":sCols.push({field:gCols[i],direction:"Ascending"}),!this.groupSettings.showGroupedColumn){let column=this.enableColumnVirtualization?this.columns.filter(c=>c.field===gCols[i])[0]:this.getColumnByField(gCols[i]);column?column.visible=!1:this.log("initial_action",{moduleName:"group",columnName:gCols[i]})}}if(gCols.length||sCols.forEach(col=>{this.sortedColumns.push(col.field)}),this.rowTemplateFn=ej2_grids_es2015_templateCompiler(this.rowTemplate),this.detailTemplateFn=ej2_grids_es2015_templateCompiler(this.detailTemplate),this.editTemplateFn=ej2_grids_es2015_templateCompiler(this.editSettings.template),!isNullOrUndefined(this.parentDetails)){let value=isNullOrUndefined(this.parentDetails.parentKeyFieldValue)?"undefined":this.parentDetails.parentKeyFieldValue;this.query.where(this.queryString,"equal",value,!0)}this.initForeignColumn()}initForeignColumn(){this.isForeignKeyEnabled(this.getColumns())&&this.notify(initForeignKeyColumn,this.getForeignKeyColumns())}gridRender(){this.updateRTL(),this.enableHover&&this.element.classList.add("e-gridhover"),Browser.isDevice&&this.element.classList.add("e-device"),this.rowHeight&&this.element.classList.add("e-grid-min-height"),ej2_base_es2015_classList(this.element,["e-responsive","e-default"],[]);let rendererFactory=this.serviceLocator.getService("rendererFactory");this.headerModule=rendererFactory.getRenderer(RenderType.Header),this.contentModule=rendererFactory.getRenderer(RenderType.Content),this.printModule=new ej2_grids_es2015_Print(this,this.scrollModule),this.clipboardModule=new ej2_grids_es2015_Clipboard(this),this.renderModule.render(),this.eventInitializer(),this.createGridPopUpElement(),this.widthService.setWidthToColumns(),this.updateGridLines(),this.applyTextWrap(),this.createTooltip(),this.enableBoxSelection()}dataReady(){this.scrollModule.setWidth(),this.scrollModule.setHeight(),"auto"!==this.height&&this.scrollModule.setPadding()}updateRTL(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}createGridPopUpElement(){let popup=this.createElement("div",{className:"e-gridpopup",styles:"display:none;"}),content=this.createElement("div",{className:"e-content",attrs:{tabIndex:"-1"}});append([content,this.createElement("div",{className:"e-uptail e-tail"})],popup),content.appendChild(this.createElement("span")),append([content,this.createElement("div",{className:"e-downtail e-tail"})],popup),this.element.appendChild(popup)}updateGridLines(){switch(ej2_base_es2015_classList(this.element,[],["e-verticallines","e-horizontallines","e-hidelines","e-bothlines"]),this.gridLines){case"Horizontal":this.element.classList.add("e-horizontallines");break;case"Vertical":this.element.classList.add("e-verticallines");break;case"None":this.element.classList.add("e-hidelines");break;case"Both":this.element.classList.add("e-bothlines")}this.updateResizeLines()}updateResizeLines(){this.allowResizing&&"Vertical"!==this.gridLines&&"Both"!==this.gridLines?this.element.classList.add("e-resize-lines"):this.element.classList.remove("e-resize-lines")}applyTextWrap(){if(this.allowTextWrap){let headerRows=[].slice.call(this.element.querySelectorAll(".e-columnheader"));switch(this.textWrapSettings.wrapMode){case"Header":ej2_grids_es2015_wrap(this.element,!1),ej2_grids_es2015_wrap(this.getContent(),!1),ej2_grids_es2015_wrap(headerRows,!0);break;case"Content":ej2_grids_es2015_wrap(this.getContent(),!0),ej2_grids_es2015_wrap(this.element,!1),ej2_grids_es2015_wrap(headerRows,!1);break;default:ej2_grids_es2015_wrap(this.element,!0),ej2_grids_es2015_wrap(this.getContent(),!1),ej2_grids_es2015_wrap(headerRows,!1)}}}removeTextWrap(){ej2_grids_es2015_wrap(this.element,!1),ej2_grids_es2015_wrap([].slice.call(this.element.querySelectorAll(".e-columnheader")),!1),ej2_grids_es2015_wrap(this.getContent(),!1)}createTooltip(){this.toolTipObj=new ej2_popups_es2015_Tooltip({opensOn:"custom",content:""},this.element)}getTooltipStatus(element){let width,headerTable=this.getHeaderTable(),htable=(this.getContentTable(),this.createTable(headerTable,"e-gridheader","header")),ctable=this.createTable(headerTable,"e-gridheader","content"),table=headerTable.contains(element)?htable:ctable,ele=headerTable.contains(element)?"th":"tr";return table.querySelector(ele).className=element.className,table.querySelector(ele).innerHTML=element.innerHTML,width=table.querySelector(ele).getBoundingClientRect().width,document.body.removeChild(htable),document.body.removeChild(ctable),width>element.getBoundingClientRect().width}mouseMoveHandler(e){if(this.isEllipsisTooltip()){let element=parentsUntil(e.target,"e-ellipsistooltip");this.prevElement===element&&"mouseout"!==e.type||this.toolTipObj.close();let tagName=e.target.tagName,elemNames=["A","BUTTON","INPUT"];if(element&&"mouseout"!==e.type&&(!Browser.isDevice||-1===elemNames.indexOf(tagName))){if(element.getAttribute("aria-describedby"))return;this.getTooltipStatus(element)&&(this.toolTipObj.content=element.getElementsByClassName("e-headertext").length?element.getElementsByClassName("e-headertext")[0].innerText:element.innerText,this.prevElement=element,this.toolTipObj.open(element))}}}isEllipsisTooltip(){let cols=this.getColumns();for(let i=0;i<cols.length;i++)if("EllipsisWithTooltip"===cols[i].clipMode)return!0;return!1}scrollHandler(){this.isEllipsisTooltip()&&this.toolTipObj.close()}createTable(table,tag,type){let myTableDiv=this.createElement("div");myTableDiv.className=this.element.className,myTableDiv.style.cssText="display: inline-block;visibility:hidden;position:absolute";let mySubDiv=this.createElement("div");mySubDiv.className=tag;let myTable=this.createElement("table");myTable.className=table.className,myTable.style.cssText="table-layout: auto;width: auto";let ele="header"===type?"th":"td",myTr=this.createElement("tr"),mytd=this.createElement(ele);return myTr.appendChild(mytd),myTable.appendChild(myTr),mySubDiv.appendChild(myTable),myTableDiv.appendChild(mySubDiv),document.body.appendChild(myTableDiv),myTableDiv}onKeyPressed(e){"tab"!==e.action&&"shiftTab"!==e.action||this.toolTipObj.close()}wireEvents(){EventHandler.add(this.element,"click",this.mouseClickHandler,this),EventHandler.add(this.element,"touchend",this.mouseClickHandler,this),EventHandler.add(this.element,"focusout",this.focusOutHandler,this),EventHandler.add(this.element,"dblclick",this.dblClickHandler,this),EventHandler.add(this.element,"keydown",this.keyPressHandler,this),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex),this.keyboardModule=new ej2_base_es2015_KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),EventHandler.add(this.getContent().firstElementChild,"scroll",this.scrollHandler,this),EventHandler.add(this.element,"mousemove",this.mouseMoveHandler,this),EventHandler.add(this.element,"mouseout",this.mouseMoveHandler,this)}unwireEvents(){EventHandler.remove(this.element,"click",this.mouseClickHandler),EventHandler.remove(this.element,"touchend",this.mouseClickHandler),EventHandler.remove(this.element,"focusout",this.focusOutHandler),EventHandler.remove(this.getContent().firstElementChild,"scroll",this.scrollHandler),EventHandler.remove(this.element,"mousemove",this.mouseMoveHandler),EventHandler.remove(this.element,"mouseout",this.mouseMoveHandler),EventHandler.remove(this.element,"keydown",this.keyPressHandler)}addListener(){this.isDestroyed||(this.on(dataReady,this.dataReady,this),this.on(contentReady,this.recalcIndentWidth,this),this.on(headerRefreshed,this.recalcIndentWidth,this),this.dataBoundFunction=this.refreshMediaCol.bind(this),this.addEventListener(dataBound,this.dataBoundFunction),this.on(keyPressed,this.onKeyPressed,this),this.on(contentReady,this.blazorTemplate,this))}removeListener(){this.isDestroyed||(this.off(dataReady,this.dataReady),this.off(contentReady,this.recalcIndentWidth),this.off(headerRefreshed,this.recalcIndentWidth),this.removeEventListener(dataBound,this.dataBoundFunction),this.off(keyPressed,this.onKeyPressed))}blazorTemplate(){if(isBlazor()){for(let i=0;i<this.columnModel.length;i++){if(this.columnModel[i].template&&updateBlazorTemplate(this.element.id+this.columnModel[i].uid,"Template",this.columnModel[i],!1),this.columnModel[i].headerTemplate&&updateBlazorTemplate(this.element.id+this.columnModel[i].uid+"headerTemplate","HeaderTemplate",this.columnModel[i],!1),"FilterBar"==this.filterSettings.type&&this.columnModel[i].filterTemplate){let fieldName=this.columnModel[i].field,tempID=this.element.id+this.columnModel[i].uid+"filterTemplate",filteredColumns=this.filterSettings.columns;for(let k=0;k<filteredColumns.length;k++)fieldName==filteredColumns[k].field&&(blazorTemplates[tempID][0][fieldName]=filteredColumns[k].value);updateBlazorTemplate(this.element.id+this.columnModel[i].uid+"filterTemplate","FilterTemplate",this.columnModel[i],!1)}"FilterBar"!=this.filterSettings.type&&this.columnModel[i].filterTemplate&&updateBlazorTemplate(this.element.id+this.columnModel[i].uid+"filterTemplate","FilterTemplate",this.columnModel[i])}this.groupSettings.captionTemplate&&updateBlazorTemplate(this.element.id+"captionTemplate","CaptionTemplate",this.groupSettings);let guid="guid";for(let k=0;k<this.aggregates.length;k++)for(let j=0;j<this.aggregates[k].columns.length;j++)this.aggregates[k].columns[j].footerTemplate&&updateBlazorTemplate(this.element.id+this.aggregates[k].columns[j][guid]+"footerTemplate","FooterTemplate",this.aggregates[k].columns[j]),this.aggregates[k].columns[j].groupFooterTemplate&&updateBlazorTemplate(this.element.id+this.aggregates[k].columns[j][guid]+"groupFooterTemplate","GroupFooterTemplate",this.aggregates[k].columns[j]),this.aggregates[k].columns[j].groupCaptionTemplate&&updateBlazorTemplate(this.element.id+this.aggregates[k].columns[j][guid]+"groupCaptionTemplate","GroupCaptionTemplate",this.aggregates[k].columns[j])}}getCurrentViewRecords(){return isGroupAdaptive(this)?isNullOrUndefined(this.currentViewData.records)?this.currentViewData:this.currentViewData.records:this.allowGrouping&&this.groupSettings.columns.length&&this.currentViewData.length?this.currentViewData.records:this.currentViewData}mouseClickHandler(e){this.isChildGrid(e)||parentsUntil(e.target,"e-gridpopup")&&e.touches||this.element.querySelectorAll(".e-cloneproperties").length||this.checkEdit(e)||(!this.allowRowDragAndDrop&&(parentsUntil(e.target,"e-gridcontent")||"TD"===e.target.tagName)||!this.allowGrouping&&!this.allowReordering&&parentsUntil(e.target,"e-gridheader"))&&e.touches||(parentsUntil(e.target,"e-gridheader")&&this.allowRowDragAndDrop&&e.preventDefault(),this.notify(click,e))}checkEdit(e){let tr=parentsUntil(e.target,"e-row"),isEdit="Batch"!==this.editSettings.mode&&this.isEdit&&tr&&(tr.classList.contains("e-editedrow")||tr.classList.contains("e-addedrow"));return!parentsUntil(e.target,"e-unboundcelldiv")&&(isEdit||parentsUntil(e.target,"e-rowcell")&&parentsUntil(e.target,"e-rowcell").classList.contains("e-editedbatchcell"))}dblClickHandler(e){let grid=parentsUntil(e.target,"e-grid");if(isNullOrUndefined(grid)||grid.id!==this.element.id||closest(e.target,".e-unboundcelldiv"))return;let dataRow=!1,tr=closest(e.target,"tr");if(tr&&tr.getAttribute("data-uid")){let rowObj=this.getRowObjectFromUID(tr.getAttribute("data-uid"));dataRow=!!rowObj&&rowObj.isDataRow}let args=this.getRowInfo(e.target);args.target=e.target,dataRow&&this.trigger("recordDoubleClick",args),this.notify(dblclick,e)}focusOutHandler(e){if(this.isChildGrid(e))return;parentsUntil(e.target,"e-grid")||(this.element.querySelector(".e-gridpopup").style.display="None");let filterClear=this.element.querySelector(".e-cancel:not(.e-hide)");filterClear&&filterClear.classList.add("e-hide");let relatedTarget=e.relatedTarget,ariaOwns=relatedTarget?relatedTarget.getAttribute("aria-owns"):null;relatedTarget&&(parentsUntil(relatedTarget,"e-grid")||(!isNullOrUndefined(ariaOwns)&&ariaOwns)===e.target.getAttribute("aria-owns"))||this.keyPress||!this.isEdit||Browser.isDevice||("Batch"===this.editSettings.mode&&(this.editModule.saveCell(),this.notify(editNextValCell,{})),"Normal"===this.editSettings.mode&&this.editModule.editFormValidate()),this.keyPress=!1}isChildGrid(e){let gridElement=parentsUntil(e.target,"e-grid");return!(!gridElement||gridElement.id===this.element.id)}mergePersistGridData(){let data=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!isNullOrUndefined(data)&&""!==data){let dataObj=JSON.parse(data);this.enableVirtualization&&(dataObj.pageSettings.currentPage=1);let keys=Object.keys(dataObj);this.isProtectedOnChange=!0;for(let key of keys)"object"!=typeof this[key]||isNullOrUndefined(this[key])?this[key]=dataObj[key]:Array.isArray(this[key])&&"columns"===key?(setColumnIndex(this[key]),this.mergeColumns(dataObj[key],this[key]),this[key]=dataObj[key]):extend(this[key],dataObj[key]);this.isProtectedOnChange=!1}}mergeColumns(storedColumn,columns){storedColumn.forEach((col,index,arr)=>{let localCol=columns.filter(tCol=>tCol.index===col.index)[0];isNullOrUndefined(localCol)||(localCol.columns&&localCol.columns.length?(this.mergeColumns(col.columns,localCol.columns),arr[index]=extend(localCol,col,!0)):arr[index]=extend(localCol,col,!0))})}isDetail(){return!isNullOrUndefined(this.detailTemplate)||!isNullOrUndefined(this.childGrid)}isCommandColumn(columns){return columns.some(col=>col.columns?this.isCommandColumn(col.columns):!(!col.commands&&!col.commandsTemplate))}isForeignKeyEnabled(columns){return columns.some(col=>col.columns?this.isForeignKeyEnabled(col.columns):!(!col.dataSource||!col.foreignKeyValue))}keyPressHandler(e){let presskey=extend(e,{cancel:!1});this.trigger("keyPressed",presskey),!0===presskey.cancel&&e.stopImmediatePropagation()}keyActionHandler(e){this.keyPress="space"!==e.action,this.isChildGrid(e)||this.isEdit&&"escape"!==e.action&&"enter"!==e.action&&"shiftEnter"!==e.action&&"tab"!==e.action&&"shiftTab"!==e.action||this.allowKeyboard&&("ctrlPlusP"===e.action&&(e.preventDefault(),this.print()),this.notify(keyPressed,e))}setInjectedModules(modules){this.injectedModules=modules}updateColumnObject(){prepareColumns(this.columns,this.enableColumnVirtualization),setColumnIndex(this.columns),this.initForeignColumn(),this.notify(autoCol,{})}getForeignKeyColumns(){return this.getColumns().filter(col=>col.isForeignColumn())}getRowHeight(){return this.rowHeight?this.rowHeight:function(element){if(void 0!==ej2_grids_es2015_rowHeight)return ej2_grids_es2015_rowHeight;let table=ej2_base_es2015_createElement("table",{className:"e-table",styles:"visibility: hidden"});table.innerHTML='<tr><td class="e-rowcell">A<td></tr>',element.appendChild(table);let rect=table.querySelector("td").getBoundingClientRect();return element.removeChild(table),ej2_grids_es2015_rowHeight=Math.ceil(rect.height)}(this.element)}refreshColumns(){this.isPreventScrollEvent=!0,this.updateColumnObject(),this.checkLockColumns(this.getColumns()),this.refresh()}excelExport(excelExportProperties,isMultipleExport,workbook,isBlob){return this.excelExportModule?this.excelExportModule.Map(this,excelExportProperties,isMultipleExport,workbook,!1,isBlob):null}csvExport(excelExportProperties,isMultipleExport,workbook,isBlob){return this.excelExportModule?this.excelExportModule.Map(this,excelExportProperties,isMultipleExport,workbook,!0,isBlob):null}pdfExport(pdfExportProperties,isMultipleExport,pdfDoc,isBlob){return this.pdfExportModule?this.pdfExportModule.Map(this,pdfExportProperties,isMultipleExport,pdfDoc,isBlob):null}groupColumn(columnName){this.groupModule&&this.groupModule.groupColumn(columnName)}groupExpandAll(){this.groupModule&&this.groupModule.expandAll()}groupCollapseAll(){this.groupModule&&this.groupModule.collapseAll()}clearGrouping(){this.groupModule&&this.groupModule.clearGrouping()}ungroupColumn(columnName){this.groupModule&&this.groupModule.ungroupColumn(columnName)}openColumnChooser(x,y){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(x,y)}detailCollapseAll(){this.detailRowModule&&this.detailRowModule.collapseAll()}detailExpandAll(){this.detailRowModule&&this.detailRowModule.expandAll()}clearCellSelection(){this.selectionModule&&this.selectionModule.clearCellSelection()}clearRowSelection(){this.selectionModule&&this.selectionModule.clearRowSelection()}selectCells(rowCellIndexes){this.selectionModule&&this.selectionModule.selectCells(rowCellIndexes)}selectRowsByRange(startIndex,endIndex){this.selectionModule&&this.selectionModule.selectRowsByRange(startIndex,endIndex)}isContextMenuOpen(){return this.contextMenuModule&&this.contextMenuModule.isOpen}ensureModuleInjected(module){return this.getInjectedModules().indexOf(module)>=0}destroyTemplate(propertyNames,index){this.clearTemplate(propertyNames,index)}log(type,args){this.loggerModule&&this.loggerModule.log(type,args)}applyBiggerTheme(element){this.element.classList.contains("e-bigger")&&element.classList.add("e-bigger")}getPreviousRowData(){return this.getRowsObject()[this.getRows().length-1].data}hideScroll(){let content=this.getContent().querySelector(".e-content"),cTable=content.querySelector(".e-movablecontent")?content.querySelector(".e-movablecontent"):content,fTable=content.querySelector(".e-frozencontent")?content.querySelector(".e-frozencontent"):content;cTable.scrollHeight<=cTable.clientHeight&&fTable.scrollHeight<=fTable.clientHeight&&(this.scrollModule.removePadding(),cTable.style.overflowY="auto"),this.frozenColumns&&cTable.scrollWidth<=cTable.clientWidth&&(cTable.style.overflowX="auto",cTable.style.overflowY="auto",this.notify(frozenHeight,0))}getRowIndexByPrimaryKey(value){let pkName=this.getPrimaryKeyFieldNames()[0];value="object"==typeof value?value[pkName]:value;for(let i=0;i<this.getRowsObject().length;i++)if(this.getRowsObject()[i].data[pkName]===value)return this.getRowsObject()[i].index;return-1}grabColumnByFieldFromAllCols(field){let column;return this.columnModel=[],this.updateColumnModel(this.columns),this.columnModel.forEach(gCol=>{field===gCol.field&&(column=gCol)}),column}grabColumnByUidFromAllCols(uid){let column;return this.columnModel=[],this.updateColumnModel(this.columns),this.columnModel.forEach(gCol=>{uid===gCol.uid&&(column=gCol)}),column}};return __decorate([Property([])],Grid.prototype,"columns",void 0),__decorate([Property(!0)],Grid.prototype,"enableAltRow",void 0),__decorate([Property(!0)],Grid.prototype,"enableHover",void 0),__decorate([Property(!1)],Grid.prototype,"enableAutoFill",void 0),__decorate([Property(!0)],Grid.prototype,"allowKeyboard",void 0),__decorate([Property(!1)],Grid.prototype,"allowTextWrap",void 0),__decorate([Complex({},ej2_grids_es2015_TextWrapSettings)],Grid.prototype,"textWrapSettings",void 0),__decorate([Property(!1)],Grid.prototype,"allowPaging",void 0),__decorate([Complex({},ej2_grids_es2015_PageSettings)],Grid.prototype,"pageSettings",void 0),__decorate([Property(!1)],Grid.prototype,"enableVirtualization",void 0),__decorate([Property(!1)],Grid.prototype,"enableColumnVirtualization",void 0),__decorate([Complex({},ej2_grids_es2015_SearchSettings)],Grid.prototype,"searchSettings",void 0),__decorate([Property(!1)],Grid.prototype,"allowSorting",void 0),__decorate([Property(!0)],Grid.prototype,"allowMultiSorting",void 0),__decorate([Property(!1)],Grid.prototype,"allowExcelExport",void 0),__decorate([Property(!1)],Grid.prototype,"allowPdfExport",void 0),__decorate([Complex({},ej2_grids_es2015_SortSettings)],Grid.prototype,"sortSettings",void 0),__decorate([Property(!0)],Grid.prototype,"allowSelection",void 0),__decorate([Property(-1)],Grid.prototype,"selectedRowIndex",void 0),__decorate([Complex({},ej2_grids_es2015_SelectionSettings)],Grid.prototype,"selectionSettings",void 0),__decorate([Property(!1)],Grid.prototype,"allowFiltering",void 0),__decorate([Property(!1)],Grid.prototype,"allowReordering",void 0),__decorate([Property(!1)],Grid.prototype,"allowResizing",void 0),__decorate([Property(!1)],Grid.prototype,"allowRowDragAndDrop",void 0),__decorate([Complex({},ej2_grids_es2015_RowDropSettings)],Grid.prototype,"rowDropSettings",void 0),__decorate([Complex({},ej2_grids_es2015_FilterSettings)],Grid.prototype,"filterSettings",void 0),__decorate([Property(!1)],Grid.prototype,"allowGrouping",void 0),__decorate([Property(!1)],Grid.prototype,"showColumnMenu",void 0),__decorate([Complex({},ej2_grids_es2015_GroupSettings)],Grid.prototype,"groupSettings",void 0),__decorate([Complex({},ej2_grids_es2015_EditSettings)],Grid.prototype,"editSettings",void 0),__decorate([Collection([],ej2_grids_es2015_AggregateRow)],Grid.prototype,"aggregates",void 0),__decorate([Property(!1)],Grid.prototype,"showColumnChooser",void 0),__decorate([Property("auto")],Grid.prototype,"height",void 0),__decorate([Property("auto")],Grid.prototype,"width",void 0),__decorate([Property("Default")],Grid.prototype,"gridLines",void 0),__decorate([Property()],Grid.prototype,"rowTemplate",void 0),__decorate([Property()],Grid.prototype,"detailTemplate",void 0),__decorate([Property()],Grid.prototype,"childGrid",void 0),__decorate([Property()],Grid.prototype,"queryString",void 0),__decorate([Property("AllPages")],Grid.prototype,"printMode",void 0),__decorate([Property("Expanded")],Grid.prototype,"hierarchyPrintMode",void 0),__decorate([Property([])],Grid.prototype,"dataSource",void 0),__decorate([Property(null)],Grid.prototype,"rowHeight",void 0),__decorate([Property()],Grid.prototype,"query",void 0),__decorate([Property("USD")],Grid.prototype,"currencyCode",void 0),__decorate([Property()],Grid.prototype,"toolbar",void 0),__decorate([Property()],Grid.prototype,"contextMenuItems",void 0),__decorate([Property()],Grid.prototype,"columnMenuItems",void 0),__decorate([Property()],Grid.prototype,"toolbarTemplate",void 0),__decorate([Property()],Grid.prototype,"pagerTemplate",void 0),__decorate([Property(0)],Grid.prototype,"frozenRows",void 0),__decorate([Property(0)],Grid.prototype,"frozenColumns",void 0),__decorate([Property("All")],Grid.prototype,"columnQueryMode",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"destroyed",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"load",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowDataBound",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"queryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"headerCellInfo",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"actionBegin",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"actionComplete",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"actionFailure",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"dataBound",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"recordDoubleClick",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowSelecting",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowSelected",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowDeselecting",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowDeselected",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"cellSelecting",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"cellSelected",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"cellDeselecting",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"cellDeselected",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"columnDragStart",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"columnDrag",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"columnDrop",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"printComplete",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforePrint",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"pdfQueryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"pdfHeaderQueryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"exportDetailDataBound",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"excelQueryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"excelHeaderQueryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforeExcelExport",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"excelExportComplete",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforePdfExport",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"pdfExportComplete",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowDragStartHelper",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"detailDataBound",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowDragStart",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowDrag",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"rowDrop",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"toolbarClick",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforeOpenColumnChooser",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"batchAdd",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"batchDelete",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"batchCancel",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforeBatchAdd",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforeBatchDelete",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforeBatchSave",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beginEdit",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"commandClick",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"cellEdit",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"cellSave",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"cellSaved",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"resizeStart",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"resizing",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"resizeStop",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"keyPressed",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforeDataBound",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"contextMenuOpen",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"contextMenuClick",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"columnMenuOpen",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"columnMenuClick",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"checkBoxChange",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforeCopy",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"beforePaste",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"dataStateChange",void 0),__decorate([ej2_base_es2015_Event()],Grid.prototype,"dataSourceChanged",void 0),Grid_1=__decorate([NotifyPropertyChanges],Grid)})();class ej2_grids_es2015_Sort{constructor(parent,sortSettings,sortedColumns,locator){this.contentRefresh=!0,this.isModelChanged=!0,this.aria=new AriaService,this.currentTarget=null,this.parent=parent,this.sortSettings=sortSettings,this.sortedColumns=sortedColumns,this.focus=locator.getService("focus"),this.addEventListener()}updateModel(){let index,sortedColumn={field:this.columnName,direction:this.direction},gCols=this.parent.groupSettings.columns,flag=!1;if(this.isMultiSort)(index=this.getSortedColsIndexByField(this.columnName))>-1&&this.sortSettings.columns.splice(index,1),this.sortSettings.columns.push(sortedColumn),this.sortSettings.columns=this.sortSettings.columns;else if(gCols.length){let sortedCols=[];for(let i=0,len=gCols.length;i<len;i++)if(index=this.getSortedColsIndexByField(gCols[i],sortedCols),this.columnName===gCols[i])flag=!0,sortedCols.push(sortedColumn);else{let sCol=this.getSortColumnFromField(gCols[i]);sortedCols.push({field:sCol.field,direction:sCol.direction,isFromGroup:sCol.isFromGroup})}flag||sortedCols.push(sortedColumn),this.sortSettings.columns=sortedCols}else this.sortSettings.columns=[sortedColumn];this.parent.dataBind(),this.lastSortedCol=this.columnName}onActionComplete(e){let args=this.isRemove?{requestType:"sorting",type:actionComplete}:{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:actionComplete};this.isRemove=!1,this.parent.trigger(actionComplete,extend(e,args))}sortColumn(columnName,direction,isMultiSort){let gObj=this.parent;!1===this.parent.getColumnByField(columnName).allowSorting||this.parent.isContextMenuOpen()?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:columnName}):(gObj.allowMultiSorting||(isMultiSort=gObj.allowMultiSorting),this.isActionPrevent()?gObj.notify(preventBatch,{instance:this,handler:this.sortColumn,arg1:columnName,arg2:direction,arg3:isMultiSort}):(this.backupSettings(),this.columnName=columnName,this.direction=direction,this.isMultiSort=isMultiSort,this.removeSortIcons(),gObj.getColumnHeaderByField(columnName),this.updateSortedCols(columnName,isMultiSort),this.updateModel()))}backupSettings(){this.lastSortedCols=iterateExtend(this.sortSettings.columns),this.lastCols=this.sortedColumns}restoreSettings(){this.isModelChanged=!1,this.isMultiSort=!0,this.parent.setProperties({sortSettings:{columns:this.lastSortedCols}},!0),this.sortedColumns=this.lastCols,this.isModelChanged=!0}updateSortedCols(columnName,isMultiSort){if(!isMultiSort)if(this.parent.allowGrouping)for(let i=0,len=this.sortedColumns.length;i<len;i++)this.parent.groupSettings.columns.indexOf(this.sortedColumns[i])<0&&(this.sortedColumns.splice(i,1),len--,i--);else this.sortedColumns.splice(0,this.sortedColumns.length);this.sortedColumns.indexOf(columnName)<0&&this.sortedColumns.push(columnName)}onPropertyChanged(e){e.module===this.getModuleName()&&(this.contentRefresh&&this.parent.notify(modelChanged,this.sortSettings.columns.length?{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:actionBegin,target:this.currentTarget}:{requestType:"sorting",type:actionBegin,cancel:!1,target:this.currentTarget}),this.refreshSortSettings(),this.removeSortIcons(),this.addSortIcons())}refreshSortSettings(){this.sortedColumns.length=0,this.sortSettings.columns.forEach(e=>{e.isFromGroup||this.sortedColumns.push(e.field)})}clearSorting(){let cols=getActualPropFromColl(this.sortSettings.columns);if(this.isActionPrevent())this.parent.notify(preventBatch,{instance:this,handler:this.clearSorting});else for(let i=0,len=cols.length;i<len;i++)this.removeSortColumn(cols[i].field)}isActionPrevent(){return isActionPrevent(this.parent)}removeSortColumn(field){let gObj=this.parent,cols=this.sortSettings.columns;if(!(this.sortedColumns.indexOf(field)<0))if(this.isActionPrevent())this.parent.notify(preventBatch,{instance:this,handler:this.removeSortColumn,arg1:field});else{this.backupSettings(),this.removeSortIcons();for(let i=0,len=cols.length;i<len;i++)if(cols[i].field===field){if(gObj.allowGrouping&&gObj.groupSettings.columns.indexOf(cols[i].field)>-1)continue;this.sortedColumns.splice(this.sortedColumns.indexOf(cols[i].field),1),cols.splice(i,1),this.isRemove=!0,this.isModelChanged&&this.parent.notify(modelChanged,{requestType:"sorting",type:actionBegin,target:this.currentTarget});break}this.addSortIcons()}}getSortedColsIndexByField(field,sortedColumns){let cols=sortedColumns||this.sortSettings.columns;for(let i=0,len=cols.length;i<len;i++)if(cols[i].field===field)return i;return-1}getModuleName(){return"sort"}initialEnd(){if(this.parent.off(contentReady,this.initialEnd),this.parent.getColumns().length&&this.sortSettings.columns.length){let gObj=this.parent;this.contentRefresh=!1,this.isMultiSort=this.sortSettings.columns.length>1;for(let col of gObj.sortSettings.columns.slice())this.sortedColumns.indexOf(col.field)>-1&&this.sortColumn(col.field,col.direction,!0);this.isMultiSort=!1,this.contentRefresh=!0}}addEventListener(){this.parent.isDestroyed||(this.parent.on(contentReady,this.initialEnd,this),this.parent.on(sortComplete,this.onActionComplete,this),this.parent.on(inBoundModelChanged,this.onPropertyChanged,this),this.parent.on(click,this.clickHandler,this),this.parent.on(headerRefreshed,this.refreshSortIcons,this),this.parent.on(keyPressed,this.keyPressed,this),this.parent.on(cancelBegin,this.cancelBeginEvent,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(sortComplete,this.onActionComplete),this.parent.off(inBoundModelChanged,this.onPropertyChanged),this.parent.off(click,this.clickHandler),this.parent.off(headerRefreshed,this.refreshSortIcons),this.parent.off(keyPressed,this.keyPressed),this.parent.off(cancelBegin,this.cancelBeginEvent))}destroy(){this.isModelChanged=!1;let gridElement=this.parent.element;gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.parent.element.querySelector(".e-gridpopup").querySelectorAll(".e-sortdirect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none"),this.parent.refreshing||this.clearSorting(),this.isModelChanged=!0,this.removeEventListener())}cancelBeginEvent(e){"sorting"===e.requestType&&(this.restoreSettings(),this.refreshSortIcons(),this.isMultiSort=!0)}clickHandler(e){this.currentTarget=null,this.popUpClickHandler(e);let target=closest(e.target,".e-headercell");if(target&&!e.target.classList.contains("e-grptogglebtn")&&!e.target.classList.contains("e-stackedheadercell")&&!e.target.classList.contains("e-stackedheadercelldiv")&&!target.classList.contains("e-resized")&&!e.target.classList.contains("e-rhandler")&&!e.target.classList.contains("e-columnmenu")&&!e.target.classList.contains("e-filtermenudiv")){let colObj=this.parent.getColumnByUid(target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));target.querySelectorAll(".e-ascending"),"checkbox"!==colObj.type&&(this.initiateSort(target,e,colObj),Browser.isDevice&&this.showPopUp(e))}target&&target.classList.remove("e-resized")}keyPressed(e){if(!this.parent.isEdit&&("enter"===e.action||"ctrlEnter"===e.action||"shiftEnter"===e.action)&&closest(e.target,".e-headercell")){let target=this.focus.getFocusedElement();if(isNullOrUndefined(target)||!target.classList.contains("e-headercell")||!target.querySelector(".e-headercelldiv"))return;let col=this.parent.getColumnByUid(target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));this.initiateSort(target,e,col)}}initiateSort(target,e,column){let gObj=this.parent,field=column.field;this.currentTarget=e.target;let direction=target.querySelectorAll(".e-ascending").length?"Descending":"Ascending";e.shiftKey||this.sortSettings.allowUnsort&&target.querySelectorAll(".e-descending").length&&!(gObj.groupSettings.columns.indexOf(field)>-1)?this.removeSortColumn(field):this.sortColumn(field,direction,e.ctrlKey||this.enableSortMultiTouch)}showPopUp(e){isNullOrUndefined(closest(e.target,".e-headercell"))&&!this.parent.isContextMenuOpen()||setCssInGridPopUp(this.parent.element.querySelector(".e-gridpopup"),e,"e-sortdirect e-icons e-icon-sortdirect"+(this.sortedColumns.length>1?" e-spanclicked":""))}popUpClickHandler(e){let target=e.target;closest(target,".e-headercell")||e.target.classList.contains("e-rowcell")||closest(target,".e-gridpopup")?target.classList.contains("e-sortdirect")&&(target.classList.contains("e-spanclicked")?(target.classList.remove("e-spanclicked"),this.enableSortMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(target.classList.add("e-spanclicked"),this.enableSortMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"}addSortIcons(){let header,filterElement,gObj=this.parent,cols=this.sortSettings.columns,fieldNames=this.parent.getColumns().map(c=>c.field);for(let i=0,len=cols.length;i<len;i++)-1!==fieldNames.indexOf(cols[i].field)&&(header=gObj.getColumnHeaderByField(cols[i].field),this.aria.setSort(header,cols[i].direction),this.isMultiSort&&cols.length>1&&header.querySelector(".e-headercelldiv").insertBefore(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(i+1).toString()}),header.querySelector(".e-headertext")),ej2_base_es2015_classList(filterElement=header.querySelector(".e-sortfilterdiv"),"Ascending"===cols[i].direction?["e-ascending","e-icon-ascending"]:["e-descending","e-icon-descending"],[]))}removeSortIcons(position){let header,gObj=this.parent,cols=this.sortSettings.columns,fieldNames=this.parent.getColumns().map(c=>c.field);for(let i=position||0,len=isNullOrUndefined(position)?cols.length:position+1;i<len;i++)header=gObj.getColumnHeaderByField(cols[i].field),gObj.allowGrouping&&gObj.groupSettings.columns.indexOf(cols[i].field)>-1&&(isNullOrUndefined(header)||!header.querySelector(".e-sortfilterdiv"))||-1!==fieldNames.indexOf(cols[i].field)&&(this.aria.setSort(header,"none"),ej2_base_es2015_classList(header.querySelector(".e-sortfilterdiv"),[],["e-descending","e-icon-descending","e-ascending","e-icon-ascending"]),header.querySelector(".e-sortnumber")&&header.querySelector(".e-headercelldiv").removeChild(header.querySelector(".e-sortnumber")))}getSortColumnFromField(field){for(let i=0,len=this.sortSettings.columns.length;i<len;i++)if(this.sortSettings.columns[i].field===field)return this.sortSettings.columns[i];return!1}updateAriaAttr(){let fieldNames=this.parent.getColumns().map(c=>c.field);for(let col of this.sortedColumns){if(-1===fieldNames.indexOf(col))continue;let header=this.parent.getColumnHeaderByField(col);this.aria.setSort(header,this.getSortColumnFromField(col).direction)}}refreshSortIcons(params={args:{isFrozen:!1}}){params.args.isFrozen||(this.removeSortIcons(),this.isMultiSort=!0,this.removeSortIcons(),this.addSortIcons(),this.isMultiSort=!1,this.updateAriaAttr())}}class ej2_grids_es2015_NumericContainer{constructor(pagerModule){this.pagerModule=pagerModule}render(){this.pagerElement=this.pagerModule.element,this.renderNumericContainer(),this.refreshNumericLinks(),this.wireEvents()}refresh(){this.pagerModule.updateTotalPages(),this.links.length&&this.updateLinksHtml(),this.updateStyles()}refreshNumericLinks(){let link,pagerObj=this.pagerModule,div=pagerObj.element.querySelector(".e-numericcontainer"),frag=document.createDocumentFragment();div.innerHTML="";for(let i=1;i<=pagerObj.pageCount;i++)link=ej2_base_es2015_createElement("a",{className:"e-link e-numericitem e-spacing e-pager-default",attrs:{role:"link",tabindex:"-1","aria-label":"Goto Page "+i,href:"javascript:void(0);",name:"Goto page"+i}}),pagerObj.currentPage===i&&ej2_base_es2015_classList(link,["e-currentitem","e-active"],["e-pager-default"]),frag.appendChild(link);div.appendChild(frag),this.links=[].slice.call(div.childNodes)}wireEvents(){EventHandler.add(this.pagerElement,"click",this.clickHandler,this)}unwireEvents(){EventHandler.remove(this.pagerModule.element,"click",this.clickHandler)}destroy(){this.unwireEvents()}renderNumericContainer(){this.element=ej2_base_es2015_createElement("div",{className:"e-pagercontainer",attrs:{role:"navigation"}}),this.renderFirstNPrev(this.element),this.renderPrevPagerSet(this.element),this.element.appendChild(ej2_base_es2015_createElement("div",{className:"e-numericcontainer"})),this.renderNextPagerSet(this.element),this.renderNextNLast(this.element),this.pagerModule.element.appendChild(this.element)}renderFirstNPrev(pagerContainer){this.first=ej2_base_es2015_createElement("div",{className:"e-first e-icons e-icon-first",attrs:{title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}}),this.prev=ej2_base_es2015_createElement("div",{className:"e-prev e-icons e-icon-prev",attrs:{title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}),append([this.first,this.prev],pagerContainer)}renderPrevPagerSet(pagerContainer){let prevPager=ej2_base_es2015_createElement("div");this.PP=ej2_base_es2015_createElement("a",{className:"e-link e-pp e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("previousPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),href:"javascript:void(0);"}}),prevPager.appendChild(this.PP),pagerContainer.appendChild(prevPager)}renderNextPagerSet(pagerContainer){let nextPager=ej2_base_es2015_createElement("div");this.NP=ej2_base_es2015_createElement("a",{className:"e-link e-np e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("nextPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),href:"javascript:void(0);"}}),nextPager.appendChild(this.NP),pagerContainer.appendChild(nextPager)}renderNextNLast(pagerContainer){this.next=ej2_base_es2015_createElement("div",{className:"e-next e-icons e-icon-next",attrs:{title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}}),this.last=ej2_base_es2015_createElement("div",{className:"e-last e-icons e-icon-last",attrs:{title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}),append([this.next,this.last],pagerContainer)}clickHandler(e){let pagerObj=this.pagerModule,target=e.target;return pagerObj.previousPageNo=pagerObj.currentPage,target.classList.contains("e-disable")||isNullOrUndefined(target.getAttribute("index"))||(pagerObj.currentPage=parseInt(target.getAttribute("index"),10),pagerObj.dataBind()),!1}updateLinksHtml(){let currentPageSet,pageNo,pagerObj=this.pagerModule;pagerObj.currentPage=1===pagerObj.totalPages?1:pagerObj.currentPage,pagerObj.currentPage>pagerObj.totalPages&&pagerObj.totalPages&&(pagerObj.currentPage=pagerObj.totalPages),currentPageSet=parseInt((pagerObj.currentPage/pagerObj.pageCount).toString(),10),pagerObj.currentPage%pagerObj.pageCount==0&&currentPageSet>0&&(currentPageSet-=1);for(let i=0;i<pagerObj.pageCount;i++)(pageNo=currentPageSet*pagerObj.pageCount+1+i)<=pagerObj.totalPages?(this.links[i].style.display="",this.links[i].setAttribute("index",pageNo.toString()),this.links[i].innerHTML=pagerObj.customText?pagerObj.customText+pageNo:pageNo.toString(),pagerObj.currentPage!==pageNo?this.links[i].classList.add("e-pager-default"):this.links[i].classList.remove("e-pager-default")):(this.links[i].innerHTML=pagerObj.customText?pagerObj.customText+pageNo:pageNo.toString(),this.links[i].style.display="none"),ej2_base_es2015_classList(this.links[i],[],["e-currentitem","e-active"]);this.first.setAttribute("index","1"),this.last.setAttribute("index",pagerObj.totalPages.toString()),this.prev.setAttribute("index",(pagerObj.currentPage-1).toString()),this.next.setAttribute("index",(pagerObj.currentPage+1).toString()),this.pagerElement.querySelector(".e-mfirst").setAttribute("index","1"),this.pagerElement.querySelector(".e-mlast").setAttribute("index",pagerObj.totalPages.toString()),this.pagerElement.querySelector(".e-mprev").setAttribute("index",(pagerObj.currentPage-1).toString()),this.pagerElement.querySelector(".e-mnext").setAttribute("index",(pagerObj.currentPage+1).toString()),this.PP.setAttribute("index",(parseInt(this.links[0].getAttribute("index"),10)-pagerObj.pageCount).toString()),this.NP.setAttribute("index",(parseInt(this.links[this.links.length-1].getAttribute("index"),10)+1).toString())}updateStyles(){this.updateFirstNPrevStyles(),this.updatePrevPagerSetStyles(),this.updateNextPagerSetStyles(),this.updateNextNLastStyles(),this.links.length&&ej2_base_es2015_classList(this.links[(this.pagerModule.currentPage-1)%this.pagerModule.pageCount],["e-currentitem","e-active"],[])}updateFirstNPrevStyles(){let firstPage=["e-firstpage","e-pager-default"],firstPageDisabled=["e-firstpagedisabled","e-disable"],prevPage=["e-prevpage","e-pager-default"],prevPageDisabled=["e-prevpagedisabled","e-disable"];this.pagerModule.totalPages>0&&this.pagerModule.currentPage>1?(ej2_base_es2015_classList(this.prev,prevPage,prevPageDisabled),ej2_base_es2015_classList(this.first,firstPage,firstPageDisabled),ej2_base_es2015_classList(this.pagerElement.querySelector(".e-mfirst"),firstPage,firstPageDisabled),ej2_base_es2015_classList(this.pagerElement.querySelector(".e-mprev"),prevPage,prevPageDisabled)):(ej2_base_es2015_classList(this.prev,prevPageDisabled,prevPage),ej2_base_es2015_classList(this.first,firstPageDisabled,firstPage),ej2_base_es2015_classList(this.pagerElement.querySelector(".e-mprev"),prevPageDisabled,prevPage),ej2_base_es2015_classList(this.pagerElement.querySelector(".e-mfirst"),firstPageDisabled,firstPage))}updatePrevPagerSetStyles(){this.pagerModule.currentPage>this.pagerModule.pageCount?ej2_base_es2015_classList(this.PP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]):ej2_base_es2015_classList(this.PP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"])}updateNextPagerSetStyles(){let pagerObj=this.pagerModule,firstPage=this.links[0].innerHTML.replace(pagerObj.customText,"");!firstPage.length||!this.links.length||parseInt(firstPage,10)+pagerObj.pageCount>pagerObj.totalPages?ej2_base_es2015_classList(this.NP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]):ej2_base_es2015_classList(this.NP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])}updateNextNLastStyles(){let lastPage=["e-lastpage","e-pager-default"],lastPageDisabled=["e-lastpagedisabled","e-disable"],nextPage=["e-nextpage","e-pager-default"],nextPageDisabled=["e-nextpagedisabled","e-disable"],pagerObj=this.pagerModule;pagerObj.currentPage===pagerObj.totalPages||0===pagerObj.totalRecordsCount?(ej2_base_es2015_classList(this.last,lastPageDisabled,lastPage),ej2_base_es2015_classList(this.next,nextPageDisabled,nextPage),ej2_base_es2015_classList(this.pagerElement.querySelector(".e-mlast"),lastPageDisabled,lastPage),ej2_base_es2015_classList(this.pagerElement.querySelector(".e-mnext"),nextPageDisabled,nextPage)):(ej2_base_es2015_classList(this.last,lastPage,lastPageDisabled),ej2_base_es2015_classList(this.next,nextPage,nextPageDisabled),ej2_base_es2015_classList(this.pagerElement.querySelector(".e-mlast"),lastPage,lastPageDisabled),ej2_base_es2015_classList(this.pagerElement.querySelector(".e-mnext"),nextPage,nextPageDisabled))}}class ej2_grids_es2015_PagerMessage{constructor(pagerModule){this.pagerModule=pagerModule}render(){let div=ej2_base_es2015_createElement("div",{className:"e-parentmsgbar",attrs:{"aria-label":"Pager Information"}});this.pageNoMsgElem=ej2_base_es2015_createElement("span",{className:"e-pagenomsg",styles:"textalign:right"}),this.pageCountMsgElem=ej2_base_es2015_createElement("span",{className:"e-pagecountmsg",styles:"textalign:right"}),append([this.pageNoMsgElem,this.pageCountMsgElem],div),this.pagerModule.element.appendChild(div),this.refresh()}refresh(){let pagerObj=this.pagerModule;this.pageNoMsgElem.textContent=this.format(pagerObj.getLocalizedLabel("currentPageInfo"),[0===pagerObj.totalRecordsCount?0:pagerObj.currentPage,pagerObj.totalPages||0])+" ",this.pageCountMsgElem.textContent=this.format(pagerObj.getLocalizedLabel("totalItemsInfo"),[pagerObj.totalRecordsCount||0]),this.pageNoMsgElem.parentElement.setAttribute("aria-label",this.pageNoMsgElem.textContent+this.pageCountMsgElem.textContent)}hideMessage(){this.pageNoMsgElem&&(this.pageNoMsgElem.style.display="none"),this.pageCountMsgElem&&(this.pageCountMsgElem.style.display="none")}showMessage(){this.pageNoMsgElem||this.render(),this.pageNoMsgElem.style.display="",this.pageCountMsgElem.style.display=""}destroy(){}format(str,args){let regx;for(let i=0;i<args.length;i++)regx=new RegExp("\\{"+i+"\\}","gm"),str=str.replace(regx,args[i].toString());return str}}let ej2_grids_es2015_Pager=(()=>{let Pager=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element)}requiredModules(){let modules=[];return this.enableExternalMessage&&modules.push({member:"externalMessage",args:[this]}),this.checkpagesizes()&&modules.push({member:"pagerdropdown",args:[this]}),modules}preRender(){this.defaultConstants={currentPageInfo:"{0} of {1} pages",totalItemsInfo:"({0} items)",firstPageTooltip:"Go to first page",lastPageTooltip:"Go to last page",nextPageTooltip:"Go to next page",previousPageTooltip:"Go to previous page",nextPagerTooltip:"Go to next pager",previousPagerTooltip:"Go to previous pager",pagerDropDown:"Items per page",pagerAllDropDown:"Items",All:"All"},this.containerModule=new ej2_grids_es2015_NumericContainer(this),this.pagerMessageModule=new ej2_grids_es2015_PagerMessage(this)}render(){this.template?this.pagerTemplate():(this.initLocalization(),this.updateRTL(),this.totalRecordsCount=this.totalRecordsCount||0,this.renderFirstPrevDivForDevice(),this.containerModule.render(),this.enablePagerMessage&&this.pagerMessageModule.render(),this.renderNextLastDivForDevice(),this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.render(),this.addAriaLabel(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render(),this.refresh(),this.trigger("created",{currentPage:this.currentPage,totalRecordsCount:this.totalRecordsCount}))}getPersistData(){return this.addOnPersist(["currentPage","pageSize"])}destroy(){super.destroy(),this.containerModule.destroy(),this.pagerMessageModule.destroy(),this.element.innerHTML=""}getModuleName(){return"pager"}onPropertyChanged(newProp,oldProp){if(!this.isDestroyed){newProp.pageCount!==oldProp.pageCount&&(this.containerModule.refreshNumericLinks(),this.containerModule.refresh());for(let prop of Object.keys(newProp))switch(prop){case"currentPage":this.checkGoToPage(newProp.currentPage,oldProp.currentPage)&&this.currentPageChanged(newProp,oldProp);break;case"pageSize":case"totalRecordsCount":case"customText":this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.setDropDownValue("value",this.pageSize),newProp.pageSize!==oldProp.pageSize?(this.pageSize=newProp.pageSize,this.currentPageChanged(newProp,oldProp)):this.refresh();break;case"pageSizes":this.checkpagesizes()&&this.pagerdropdownModule&&(this.pagerdropdownModule.destroy(),this.pagerdropdownModule.render()),this.refresh();break;case"template":this.templateFn=this.compile(this.template),this.refresh();break;case"locale":this.initLocalization(),this.refresh();break;case"enableExternalMessage":this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render();break;case"externalMessage":this.externalMessageModule&&this.externalMessageModule.refresh();break;case"enableRtl":this.updateRTL();break;case"enablePagerMessage":this.enablePagerMessage?this.pagerMessageModule.showMessage():this.pagerMessageModule.hideMessage()}}}getLocalizedLabel(key){return this.localeObj.getConstant(key)}goToPage(pageNo){this.checkGoToPage(pageNo)&&(this.currentPage=pageNo,this.dataBind())}setPageSize(pageSize){this.pageSize=pageSize,this.dataBind()}checkpagesizes(){return!(!0!==this.pageSizes&&!this.pageSizes.length)}checkGoToPage(newPageNo,oldPageNo){return newPageNo!==this.currentPage&&(this.previousPageNo=this.currentPage),isNullOrUndefined(oldPageNo)||(this.previousPageNo=oldPageNo),this.previousPageNo!==newPageNo&&newPageNo>=1&&newPageNo<=this.totalPages}currentPageChanged(newProp,oldProp){if(this.enableQueryString&&this.updateQueryString(this.currentPage),newProp.currentPage!==oldProp.currentPage||newProp.pageSize!==oldProp.pageSize){let args={currentPage:this.currentPage,newProp:newProp,oldProp:oldProp,cancel:!1};this.trigger("click",args),args.cancel||this.refresh()}}pagerTemplate(){let result;this.element.classList.add("e-pagertemplate"),this.compile(this.template);let data={currentPage:this.currentPage,pageSize:this.pageSize,pageCount:this.pageCount,totalRecordsCount:this.totalRecordsCount,totalPages:this.totalPages};result=this.getPagerTemplate()(data),appendChildren(this.element,result)}updateTotalPages(){this.totalPages=this.totalRecordsCount%this.pageSize==0?this.totalRecordsCount/this.pageSize:parseInt((this.totalRecordsCount/this.pageSize).toString(),10)+1}getPagerTemplate(){return this.templateFn}compile(template){if(template)try{document.querySelectorAll(template).length&&(this.templateFn=compile$$1(document.querySelector(template).innerHTML.trim()))}catch(e){this.templateFn=compile$$1(template)}}refresh(){this.template?(this.element.innerHTML="",this.updateTotalPages(),this.pagerTemplate()):(this.updateRTL(),this.containerModule.refresh(),this.enablePagerMessage&&this.pagerMessageModule.refresh(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.refresh())}updateRTL(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}initLocalization(){this.localeObj=new L10n(this.getModuleName(),this.defaultConstants,this.locale)}updateQueryString(value){let updatedUrl=this.getUpdatedURL(window.location.href,"page",value.toString());window.history.pushState({path:updatedUrl},"",updatedUrl)}getUpdatedURL(uri,key,value){let regx=new RegExp("([?|&])"+key+"=.*?(&|#|$)","i");if(uri.match(regx))return uri.replace(regx,"$1"+key+"="+value+"$2");{let hash="";return-1!==uri.indexOf("#")&&(hash=uri.replace(/.*#/,"#"),uri=uri.replace(/#.*/,"")),uri+(-1!==uri.indexOf("?")?"&":"?")+key+"="+value+hash}}renderFirstPrevDivForDevice(){this.element.appendChild(ej2_base_es2015_createElement("div",{className:"e-mfirst e-icons e-icon-first",attrs:{title:this.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}})),this.element.appendChild(ej2_base_es2015_createElement("div",{className:"e-mprev e-icons e-icon-prev",attrs:{title:this.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}))}renderNextLastDivForDevice(){this.element.appendChild(ej2_base_es2015_createElement("div",{className:"e-mnext e-icons e-icon-next",attrs:{title:this.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}})),this.element.appendChild(ej2_base_es2015_createElement("div",{className:"e-mlast e-icons e-icon-last",attrs:{title:this.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}))}addAriaLabel(){Browser.isDevice||[".e-mfirst",".e-mprev",".e-mnext",".e-mlast"].forEach(value=>{let element=this.element.querySelector(value);element.setAttribute("aria-label",element.getAttribute("title"))})}};return __decorate([Property(!1)],Pager.prototype,"enableQueryString",void 0),__decorate([Property(!1)],Pager.prototype,"enableExternalMessage",void 0),__decorate([Property(!0)],Pager.prototype,"enablePagerMessage",void 0),__decorate([Property(12)],Pager.prototype,"pageSize",void 0),__decorate([Property(10)],Pager.prototype,"pageCount",void 0),__decorate([Property(1)],Pager.prototype,"currentPage",void 0),__decorate([Property()],Pager.prototype,"totalRecordsCount",void 0),__decorate([Property()],Pager.prototype,"externalMessage",void 0),__decorate([Property(!1)],Pager.prototype,"pageSizes",void 0),__decorate([Property()],Pager.prototype,"template",void 0),__decorate([Property("")],Pager.prototype,"customText",void 0),__decorate([ej2_base_es2015_Event()],Pager.prototype,"click",void 0),__decorate([ej2_base_es2015_Event()],Pager.prototype,"dropDownChanged",void 0),__decorate([ej2_base_es2015_Event()],Pager.prototype,"created",void 0),__decorate([NotifyPropertyChanges],Pager)})();class ej2_grids_es2015_PagerDropDown{constructor(pagerModule){this.pagerModule=pagerModule}getModuleName(){return"pagerdropdown"}render(){let pagerObj=this.pagerModule;this.pagerDropDownDiv=ej2_base_es2015_createElement("div",{className:"e-pagesizes"});let dropDownDiv=ej2_base_es2015_createElement("div",{className:"e-pagerdropdown"}),defaultTextDiv=ej2_base_es2015_createElement("div",{className:"e-pagerconstant"}),input=ej2_base_es2015_createElement("input",{attrs:{type:"text",tabindex:"1"}});this.pagerCons=ej2_base_es2015_createElement("span",{className:"e-constant",innerHTML:this.pagerModule.getLocalizedLabel("pagerDropDown")}),dropDownDiv.appendChild(input),defaultTextDiv.appendChild(this.pagerCons),this.pagerDropDownDiv.appendChild(dropDownDiv),this.pagerDropDownDiv.appendChild(defaultTextDiv),this.pagerModule.element.appendChild(this.pagerDropDownDiv);let pageSizesModule=this.pagerModule.pageSizes,pageSizesArray=pageSizesModule.length?this.convertValue(pageSizesModule):[this.pagerModule.getLocalizedLabel("All"),"5","10","12","20"],defaultValue=this.pagerModule.pageSize;this.dropDownListObject=new ej2_dropdowns_es2015_DropDownList({dataSource:pageSizesArray,value:defaultValue.toString(),change:this.onChange.bind(this),cssClass:"e-alldrop"}),this.dropDownListObject.appendTo(input),pageSizesModule.length&&(this.dropDownListObject.element.value=this.pagerModule.pageSize.toString()),pagerObj.pageSize=defaultValue,pagerObj.dataBind(),pagerObj.trigger("dropDownChanged",{pageSize:defaultValue}),this.addEventListener()}onChange(e){this.dropDownListObject.value===this.pagerModule.getLocalizedLabel("All")?(this.pagerModule.pageSize=this.pagerModule.totalRecordsCount,this.pagerCons.innerHTML=this.pagerModule.getLocalizedLabel("pagerAllDropDown"),e.value=this.pagerModule.pageSize,document.getElementsByClassName("e-popup-open e-alldrop").length&&(document.getElementsByClassName("e-popup-open e-alldrop")[0].style.display="none")):(this.pagerModule.pageSize=parseInt(this.dropDownListObject.value,10),this.pagerCons.innerHTML!==this.pagerModule.getLocalizedLabel("pagerDropDown")&&(this.pagerCons.innerHTML=this.pagerModule.getLocalizedLabel("pagerDropDown"))),this.pagerModule.dataBind(),this.pagerModule.trigger("dropDownChanged",{pageSize:parseInt(this.dropDownListObject.value,10)})}beforeValueChange(prop){if("number"==typeof prop.newProp.value){let val=prop.newProp.value.toString();prop.newProp.value=val}}convertValue(pageSizeValue){let item=pageSizeValue;for(let i=0;i<item.length;i++)item[i]="number"==typeof item[i]?item[i].toString():item[i];return item}setDropDownValue(prop,value){this.dropDownListObject&&(this.dropDownListObject[prop]=value)}addEventListener(){this.dropDownListObject.on("beforeValueChange",this.beforeValueChange,this)}removeEventListener(){this.dropDownListObject.off("beforeValueChange",this.beforeValueChange)}destroy(args){this.dropDownListObject&&!this.dropDownListObject.isDestroyed&&(this.removeEventListener(),this.dropDownListObject.destroy(),ej2_base_es2015_remove(this.pagerDropDownDiv))}}class ej2_grids_es2015_ExternalMessage{constructor(pagerModule){this.pagerModule=pagerModule}getModuleName(){return"externalMessage"}render(){this.element=ej2_base_es2015_createElement("div",{className:"e-pagerexternalmsg",attrs:{"aria-label":"Pager external message"}}),this.pagerModule.element.appendChild(this.element),this.refresh()}refresh(){this.pagerModule.externalMessage&&this.pagerModule.externalMessage.toString().length?(this.showMessage(),this.element.innerHTML=this.pagerModule.externalMessage):this.hideMessage()}hideMessage(){isNullOrUndefined(this.element)||(this.element.style.display="none")}showMessage(){this.element.style.display=""}destroy(){ej2_base_es2015_remove(this.element)}}class ej2_grids_es2015_Page{constructor(parent,pageSettings){ej2_grids_es2015_Pager.Inject(ej2_grids_es2015_ExternalMessage,ej2_grids_es2015_PagerDropDown),this.parent=parent,this.pageSettings=pageSettings,this.addEventListener()}getModuleName(){return"pager"}render(){let pagerObj,gObj=this.parent;this.pagerDestroy(),isNullOrUndefined(this.parent.pagerTemplate)||(this.pageSettings.template=this.parent.pagerTemplate),this.element=this.parent.createElement("div",{className:"e-gridpager"}),pagerObj=extend$1({},extend({},getActualProperties(this.pageSettings)),{click:this.clickHandler.bind(this),dropDownChanged:this.onSelect.bind(this),enableRtl:gObj.enableRtl,locale:gObj.locale,created:this.addAriaAttr.bind(this)},["parentObj","propName"]),this.pagerObj=new ej2_grids_es2015_Pager(pagerObj)}onSelect(e){this.pageSettings.pageSize=e.pageSize,this.isInitialLoad||(this.pageSettings.currentPage=1)}addAriaAttr(){if(!this.pageSettings.template){let numericContainerNew=this.parent.createElement("div",{className:"e-numericcontainer"}),pagerContainer=this.element.querySelector(".e-pagercontainer"),frag=document.createDocumentFragment(),numericContainer=this.element.querySelector(".e-numericcontainer"),links=numericContainer.querySelectorAll("a");for(let i=0;i<links.length;i++){this.parent.getContentTable()?links[i].setAttribute("aria-owns",this.parent.getContentTable().id):links[i].setAttribute("aria-owns",this.parent.element.getAttribute("id")+"_content_table");let numericContainerDiv=this.parent.createElement("div");numericContainerDiv.appendChild(links[i]),frag.appendChild(numericContainerDiv)}numericContainerNew.appendChild(frag),pagerContainer.replaceChild(numericContainerNew,numericContainer),[".e-mfirst",".e-mprev",".e-first",".e-prev",".e-next",".e-last",".e-mnext",".e-mlast"].forEach(value=>{let element=this.element.querySelector(value);this.parent.getContentTable()&&element.setAttribute("aria-owns",this.parent.getContentTable().id)})}}dataReady(e){this.updateModel(e)}refresh(){this.pagerObj.refresh()}goToPage(pageNo){this.pagerObj.goToPage(pageNo)}setPageSize(pageSize){this.pagerObj.setPageSize(pageSize)}updateModel(e){this.parent.pageSettings.totalRecordsCount=e.count,this.parent.dataBind()}onActionComplete(e){this.parent.trigger(actionComplete,extend(e,{currentPage:this.parent.pageSettings.currentPage,requestType:"paging",type:actionComplete}))}onPropertyChanged(e){if(e.module!==this.getModuleName())return;let newProp=e.properties;for(let prop of Object.keys(newProp))this.pagerObj[prop]=newProp[prop];this.pagerObj.dataBind()}clickHandler(e){let gObj=this.parent;if(this.isForceCancel||isActionPrevent(gObj)&&!gObj.prevPageMoving)return this.isForceCancel?this.isForceCancel=!1:(isNullOrUndefined(e.newProp)||isNullOrUndefined(e.newProp.pageSize)?e.currentPage&&(gObj.notify(preventBatch,{instance:this,handler:this.goToPage,arg1:e.currentPage}),this.pagerObj.currentPage=gObj.pageSettings.currentPage===this.pagerObj.currentPage?this.pagerObj.previousPageNo:gObj.pageSettings.currentPage):(gObj.notify(preventBatch,{instance:this,handler:this.setPageSize,arg1:e.newProp.pageSize}),this.pagerObj.pageSize=e.oldProp.pageSize,gObj.pageSettings.pageSize=e.newProp.pageSize),this.isForceCancel=!0,this.pagerObj.dataBind()),void(e.cancel=!0);gObj.pageSettings.pageSize=this.pagerObj.pageSize,gObj.prevPageMoving=!1;let prevPage=this.pageSettings.currentPage;this.pageSettings.currentPage=e.currentPage,this.parent.notify(modelChanged,{requestType:"paging",previousPage:prevPage,currentPage:e.currentPage,type:actionBegin}),this.parent.requestTypeAction="paging"}keyPressHandler(e){e.action in keyActions&&(e.preventDefault(),this.element.querySelector(keyActions[e.action]).click())}updateExternalMessage(message){this.pagerObj.enableExternalMessage||(this.pagerObj.enableExternalMessage=!0,this.pagerObj.dataBind()),this.pagerObj.externalMessage=message,this.pagerObj.dataBind()}appendToElement(e){this.isInitialLoad=!0,this.parent.element.appendChild(this.element),this.parent.setGridPager(this.element),this.pagerObj.appendTo(this.element),this.isInitialLoad=!1}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.appendToElement())}addEventListener(){this.handlers={load:this.render,end:this.appendToElement,ready:this.dataReady,complete:this.onActionComplete,updateLayout:this.enableAfterRender,inboundChange:this.onPropertyChanged,keyPress:this.keyPressHandler},this.parent.isDestroyed||(this.parent.on(initialLoad,this.handlers.load,this),this.parent.on(initialEnd,this.handlers.end,this),this.parent.on(dataReady,this.handlers.ready,this),this.parent.on(pageComplete,this.handlers.complete,this),this.parent.on(uiUpdate,this.handlers.updateLayout,this),this.parent.on(inBoundModelChanged,this.handlers.inboundChange,this),this.parent.on(keyPressed,this.handlers.keyPress,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(initialLoad,this.handlers.load),this.parent.off(initialEnd,this.handlers.end),this.parent.off(dataReady,this.handlers.ready),this.parent.off(pageComplete,this.handlers.complete),this.parent.off(uiUpdate,this.handlers.updateLayout),this.parent.off(inBoundModelChanged,this.handlers.inboundChange),this.parent.off(keyPressed,this.handlers.keyPress))}destroy(){this.removeEventListener(),this.pagerDestroy()}pagerDestroy(){this.pagerObj&&!this.pagerObj.isDestroyed&&(this.pagerObj.destroy(),ej2_base_es2015_remove(this.element))}}const keyActions={pageUp:".e-prev",pageDown:".e-next",ctrlAltPageDown:".e-last",ctrlAltPageUp:".e-first",altPageUp:".e-pp",altPageDown:".e-np"};class ej2_grids_es2015_FilterCellRenderer extends ej2_grids_es2015_CellRenderer{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-filterbarcell"})}getGui(){return this.parent.createElement("div")}render(cell,data){let input,tr=this.parent.element.querySelector(".e-filterbar"),node=this.element.cloneNode(),innerDIV=this.getGui(),column=cell.column;if(tr.appendChild(node),node.setAttribute("e-mappinguid",column.uid),column.filterTemplate){let fltrData={};if(data&&(fltrData[column.field]=data[column.field]),fltrData.column=column,column.visible){let tempID=this.parent.element.id+column.uid+"filterTemplate";appendChildren(node,column.getFilterTemplate()(fltrData,this.parent,"filterTemplate",tempID))}else node.classList.add("e-hide")}else if("checkbox"!==column.type){if(!isNullOrUndefined(column.allowFiltering)&&!column.allowFiltering||isNullOrUndefined(column.filterBarTemplate))attributes(innerDIV,{class:"e-filterdiv e-fltrinputdiv"}),input=this.parent.createElement("input",{id:column.field+"_filterBarcell",className:"e-filtertext",attrs:{type:"search",title:column.headerText+cell.attributes.title,value:data[cell.column.field]?data[cell.column.field]:"",role:"search"}}),innerDIV.appendChild(input),ej2_inputs_es2015_Input.createInput({element:input,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}},this.parent.createElement);else if(node.classList.add("e-fltrtemp"),attributes(innerDIV,{class:"e-fltrtempdiv"}),isNullOrUndefined(column.filterBarTemplate.create))input=this.parent.createElement("input",{id:column.field+"_filterBarcell",className:"e-filterUi_input e-filtertext e-fltrTemp",attrs:{type:"search",title:column.headerText}}),innerDIV.appendChild(input);else{let args={column:column,node:Element},temp=column.filterBarTemplate.create;if("string"==typeof temp&&(temp=getValue(temp,window)),"string"==typeof(input=temp(args))){let div=this.parent.createElement("div");div.innerHTML=input,input=div.firstChild}attributes(innerDIV,{class:"e-filterUi_input e-filtertext e-fltrTemp",title:column.headerText,id:column.field+"_filterBarcell"}),innerDIV.appendChild(input)}if((!1===column.allowFiltering||""===column.field||isNullOrUndefined(column.field))&&(input.setAttribute("disabled","true"),input.classList.add("e-disable")),column.visible||node.classList.add("e-hide"),this.appendHtml(node,innerDIV),(isNullOrUndefined(column.allowFiltering)||column.allowFiltering)&&!isNullOrUndefined(column.filterBarTemplate)){let templateWrite=column.filterBarTemplate.write,args={element:input,column:column};"string"==typeof templateWrite&&(templateWrite=getValue(templateWrite,window)),templateWrite.call(this,args)}}return node}appendHtml(node,innerHtml){return node.appendChild(innerHtml),node}}class ej2_grids_es2015_FlMenuOptrUI{constructor(parent,customFltrOperators,serviceLocator,filterSettings){this.parent=parent,this.serviceLocator=serviceLocator,this.filterSettings=filterSettings,this.customFilterOperators=customFltrOperators}renderOperatorUI(dlgConetntEle,target,column,dlgObj){this.dialogObj=dlgObj;let optr=column.type+"Operator";this.optrData=this.customOptr=isNullOrUndefined(this.parent.filterSettings.operators)||isNullOrUndefined(this.parent.filterSettings.operators[optr])?this.customFilterOperators[optr]:this.parent.filterSettings.operators[optr];let dropDatasource=this.customOptr,selectedValue=this.dropSelectedVal(column,optr),optrDiv=this.parent.createElement("div",{className:"e-flm_optrdiv"});dlgConetntEle.appendChild(optrDiv);let optrInput=this.parent.createElement("input",{id:column.uid+"-floptr"});optrDiv.appendChild(optrInput),this.dropOptr=new ej2_dropdowns_es2015_DropDownList({dataSource:dropDatasource,fields:{text:"text",value:"value"},open:this.dropDownOpen.bind(this),text:selectedValue}),this.dropOptr.appendTo("#"+column.uid+"-floptr")}dropDownOpen(args){args.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}dropSelectedVal(col,optr){let selValue="",columns=this.parent.filterSettings.columns;for(let column of columns)if(col.field===column.field||col.isForeignColumn()&&col.foreignKeyValue===column.field){let selectedField=new ej2_data_es2015_DataManager(this.optrData).executeLocal((new ej2_data_es2015_Query).where("value","equal",column.operator));selValue=isNullOrUndefined(selectedField[0])?"":selectedField[0].text}if(""===selValue)if(col.filter.operator){let optrLen=Object.keys(this.optrData).length;for(let i=0;i<optrLen;i++)this.optrData[i].value===col.filter.operator&&(selValue=this.optrData[i].text)}else selValue=this.optrData[0].text;return selValue}getFlOperator(){return this.dropOptr.value}}class ej2_grids_es2015_StringFilterUI{constructor(parent,serviceLocator,filterSettings){this.parent=parent,this.serLocator=serviceLocator,this.filterSettings=filterSettings}create(args){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"strui-"+args.column.uid}),args.target.appendChild(this.instance),this.dialogObj=args.dialogObj,this.actObj=this.getAutoCompleteOptions(args),this.actObj.appendTo(this.instance)}getAutoCompleteOptions(args){let isForeignColumn=args.column.isForeignColumn(),dataSource=isForeignColumn?args.column.dataSource:this.parent.dataSource,fields={value:isForeignColumn?args.column.foreignKeyValue:args.column.field};return new ej2_dropdowns_es2015_AutoComplete(extend({dataSource:dataSource instanceof ej2_data_es2015_DataManager?dataSource:new ej2_data_es2015_DataManager(dataSource),fields:fields,locale:this.parent.locale,enableRtl:this.parent.enableRtl,query:this.parent.query.clone(),sortOrder:"Ascending",open:this.openPopup.bind(this),cssClass:"e-popup-flmenu",focus:()=>{this.actObj.filterType=args.getOptrInstance.getFlOperator()},autofill:!0,placeholder:args.localizeText.getConstant("EnterValue"),actionComplete:e=>{e.result=e.result.filter((obj,index,arr)=>arr.map(mapObj=>mapObj[this.actObj.fields.value]).indexOf(obj[this.actObj.fields.value])===index)}},args.column.filter.params))}write(args){""===args.filteredValue||isNullOrUndefined(args.filteredValue)||(document.querySelector("#strui-"+args.column.uid).ej2_instances[0].value=args.filteredValue)}read(element,column,filterOptr,filterObj){let actuiObj=document.querySelector("#strui-"+column.uid).ej2_instances[0];Browser.isDevice&&(actuiObj.hidePopup(),actuiObj.focusOut());let filterValue=actuiObj.value;(isNullOrUndefined(filterValue)||""===filterValue)&&(filterValue=null),filterObj.filterByColumn(column.field,filterOptr,filterValue,"and",!1)}openPopup(args){getZIndexCalcualtion(args,this.dialogObj)}}class ej2_grids_es2015_NumberFilterUI{constructor(parent,serviceLocator,filterSettings){this.filterSettings=filterSettings,this.parent=parent,this.serviceLocator=serviceLocator}create(args){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"numberui-"+args.column.uid}),args.target.appendChild(this.instance),this.numericTxtObj=new ej2_inputs_es2015_NumericTextBox(extend({format:args.column.format,locale:this.parent.locale,cssClass:"e-popup-flmenu",placeholder:args.localizeText.getConstant("EnterValue"),enableRtl:this.parent.enableRtl},args.column.filter.params)),this.numericTxtObj.appendTo(this.instance)}write(args){document.querySelector("#numberui-"+args.column.uid).ej2_instances[0].value=args.filteredValue}read(element,column,filterOptr,filterObj){let numberuiObj=document.querySelector("#numberui-"+column.uid).ej2_instances[0];filterObj.filterByColumn(column.field,filterOptr,numberuiObj.value,"and",!0)}}class ej2_grids_es2015_BooleanFilterUI{constructor(parent,serviceLocator,filterSettings){this.parent=parent,this.serviceLocator=serviceLocator,this.filterSettings=filterSettings}create(args){let isForeignColumn=args.column.isForeignColumn(),dataSource=isForeignColumn?args.column.dataSource:this.parent.dataSource,fields=isForeignColumn?args.column.foreignKeyValue:args.column.field;this.elem=this.parent.createElement("input",{className:"e-flmenu-input",id:"bool-ui-"+args.column.uid}),args.target.appendChild(this.elem),this.dialogObj=args.dialogObj,this.dropInstance=new ej2_dropdowns_es2015_DropDownList(extend({dataSource:dataSource instanceof ej2_data_es2015_DataManager?dataSource:new ej2_data_es2015_DataManager(dataSource),query:(new ej2_data_es2015_Query).select(fields),fields:{text:fields,value:fields},placeholder:args.localizeText.getConstant("SelectValue"),cssClass:"e-popup-flmenu",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this),actionComplete:e=>{e.result=ej2_data_es2015_DataUtil.distinct(e.result,fields,!0)}},args.column.filter.params)),this.dropInstance.appendTo(this.elem)}write(args){let drpuiObj=document.querySelector("#bool-ui-"+args.column.uid).ej2_instances[0];isNullOrUndefined(args.filteredValue)||(drpuiObj.text=args.filteredValue)}read(element,column,filterOptr,filterObj){let drpuiObj=document.querySelector("#bool-ui-"+column.uid).ej2_instances[0];filterObj.filterByColumn(column.field,filterOptr,drpuiObj.value,"and",!1)}openPopup(args){getZIndexCalcualtion(args,this.dialogObj)}}class ej2_grids_es2015_DateFilterUI{constructor(parent,serviceLocator,filterSettings){this.parent=parent,this.locator=serviceLocator,this.fltrSettings=filterSettings}create(args){let format=getCustomDateFormat(args.column.format,args.column.type);this.dialogObj=args.dialogObj,this.inputElem=this.parent.createElement("input",{className:"e-flmenu-input",id:"dateui-"+args.column.uid}),args.target.appendChild(this.inputElem),"date"===args.column.type?this.datePickerObj=new ej2_calendars_es2015_DatePicker(extend({format:format,cssClass:"e-popup-flmenu",placeholder:args.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this)},args.column.filter.params)):"datetime"===args.column.type&&(this.datePickerObj=new ej2_calendars_es2015_DateTimePicker(extend({format:format,cssClass:"e-popup-flmenu",placeholder:args.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this)},args.column.filter.params))),this.datePickerObj.appendTo(this.inputElem)}write(args){document.querySelector("#dateui-"+args.column.uid).ej2_instances[0].value=isNullOrUndefined(args.filteredValue)?null:new Date(args.filteredValue)}read(element,column,filterOptr,filterObj){let filterValue=document.querySelector("#dateui-"+column.uid).ej2_instances[0].value;filterValue=isNullOrUndefined(filterValue)?null:filterValue,filterObj.filterByColumn(column.field,filterOptr,filterValue,"and",!0)}openPopup(args){args.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}}class ej2_grids_es2015_FilterMenuRenderer{constructor(parent,filterSettings,serviceLocator,customFltrOperators,fltrObj){this.isDialogOpen=!1,this.colTypes={string:ej2_grids_es2015_StringFilterUI,number:ej2_grids_es2015_NumberFilterUI,date:ej2_grids_es2015_DateFilterUI,boolean:ej2_grids_es2015_BooleanFilterUI,datetime:ej2_grids_es2015_DateFilterUI},this.parent=parent,this.filterSettings=filterSettings,this.serviceLocator=serviceLocator,this.customFilterOperators=customFltrOperators,this.filterObj=fltrObj,this.flMuiObj=new ej2_grids_es2015_FlMenuOptrUI(this.parent,this.customFilterOperators,this.serviceLocator),this.l10n=this.serviceLocator.getService("localization")}openDialog(args){this.col=this.parent.getColumnByField(args.field),(isNullOrUndefined(this.col.filter)||isNullOrUndefined(this.col.filter.type)||"Menu"===this.col.filter.type)&&this.renderDlgContent(args.target,this.col)}closeDialog(){if(!this.dlgObj)return;if(isBlazor()){let columns=this.parent.getColumns();for(let i=0;i<columns.length;i++)columns[i].filterTemplate&&updateBlazorTemplate(this.parent.element.id+columns[i].uid+"filterTemplate","FilterTemplate",columns[i])}let elem=document.getElementById(this.dlgObj.element.id);this.dlgObj&&!this.dlgObj.isDestroyed&&elem&&(this.parent.notify(filterMenuClose,{field:this.col.field}),this.isDialogOpen=!1,this.dlgObj.destroy(),ej2_base_es2015_remove(elem))}renderDlgContent(target,column){let args={requestType:filterBeforeOpen,columnName:column.field,columnType:column.type};isBlazor()&&!this.parent.isJsComponent||(args.filterModel=this),this.parent.trigger(actionBegin,args);let mainDiv=this.parent.createElement("div",{className:"e-flmenu-maindiv",id:column.uid+"-flmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-flmenu",id:column.uid+"-flmdlg"}),this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new ej2_popups_es2015_Dialog({showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,created:this.dialogCreated.bind(this,target,column),position:this.parent.element.classList.contains("e-device")?{X:"center",Y:"center"}:{X:"",Y:""},target:this.parent.element.classList.contains("e-device")?document.body:this.parent.element,buttons:[{click:this.filterBtnClick.bind(this,column),buttonModel:{content:this.l10n.getConstant("FilterButton"),isPrimary:!0,cssClass:"e-flmenu-okbtn"}},{click:this.clearBtnClick.bind(this,column),buttonModel:{content:this.l10n.getConstant("ClearButton"),cssClass:"e-flmenu-cancelbtn"}}],content:mainDiv,width:!isNullOrUndefined(parentsUntil(target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:250,animationSettings:{effect:"None"},cssClass:"e-filter-popup"}),this.dlgObj.isStringTemplate=!0,this.dlgObj.appendTo(this.dlgDiv)}dialogCreated(target,column){Browser.isDevice||getFilterMenuPostion(target,this.dlgObj,this.parent),this.renderFilterUI(target,column),this.parent.notify(filterDialogCreated,{}),this.dlgObj.element.style.maxHeight="350px",this.dlgObj.show(),column.filterTemplate||this.writeMethod(column,this.dlgObj.element.querySelector("#"+column.uid+"-flmenu"));let args={requestType:filterAfterOpen,columnName:column.field,columnType:column.type};isBlazor()&&!this.parent.isJsComponent||(args.filterModel=this),this.isDialogOpen=!0,this.parent.trigger(actionComplete,args)}renderFilterUI(target,col){let dlgConetntEle=this.dlgObj.element.querySelector(".e-flmenu-maindiv");this.parent.log("column_type_missing",{column:col}),this.renderOperatorUI(dlgConetntEle,target,col),this.renderFlValueUI(dlgConetntEle,target,col)}renderOperatorUI(dlgConetntEle,target,column){this.flMuiObj.renderOperatorUI(dlgConetntEle,target,column,this.dlgObj)}renderFlValueUI(dlgConetntEle,target,column){let valueDiv=this.parent.createElement("div",{className:"e-flmenu-valuediv"}),fObj=this.filterObj;dlgConetntEle.appendChild(valueDiv);let instanceofFilterUI=new this.colTypes[column.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(column.filterTemplate){let fltrData={};fltrData[column.field]=fltrData.value=fObj.values[column.field],column.foreignKeyValue&&(fltrData[column.foreignKeyValue]=fObj.values[column.field],fltrData[column.field]=void 0),fltrData.column=column;let tempID=this.parent.element.id+column.uid+"filterTemplate",compElement=column.getFilterTemplate()(fltrData,this.parent,"filterTemplate",tempID);updateBlazorTemplate(tempID,"FilterTemplate",column),appendChildren(valueDiv,compElement)}else if(isNullOrUndefined(column.filter)||isNullOrUndefined(column.filter.ui)||isNullOrUndefined(column.filter.ui.create))instanceofFilterUI.create({column:column,target:valueDiv,getOptrInstance:this.flMuiObj,localizeText:this.l10n,dialogObj:this.dlgObj});else{let temp=column.filter.ui.create;"string"==typeof temp&&(temp=getValue(temp,window)),temp({column:column,target:valueDiv,getOptrInstance:this.flMuiObj,dialogObj:this.dlgObj})}}writeMethod(col,dlgContentEle){let flValue,target=dlgContentEle.querySelector(".e-flmenu-valinput"),instanceofFilterUI=new this.colTypes[col.type](this.parent,this.serviceLocator,this.parent.filterSettings),columns=this.filterSettings.columns;for(let column of columns)col.uid===column.uid&&(flValue=column.value);if(isNullOrUndefined(col.filter)||isNullOrUndefined(col.filter.ui)||isNullOrUndefined(col.filter.ui.write))instanceofFilterUI.write({column:col,target:target,parent:this.parent,filteredValue:flValue});else{let temp=col.filter.ui.write;"string"==typeof temp&&(temp=getValue(temp,window)),temp({column:col,target:target,parent:this.parent,filteredValue:flValue})}}filterBtnClick(col){let flValue,flOptrValue,targ=this.dlgObj.element.querySelector(".e-flmenu-valuediv input");flOptrValue=this.flMuiObj.getFlOperator();let instanceofFilterUI=new this.colTypes[col.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(col.filterTemplate){let fltrValue,element=this.dlgDiv.querySelector(".e-flmenu-valuediv");fltrValue=element.children[0].value?element.children[0].value:isBlazor()||isNullOrUndefined(element.children[0].ej2_instances)?element.querySelector(".e-control").ej2_instances[0].value:element.children[0].ej2_instances[0].value,this.filterObj.filterByColumn(col.field,flOptrValue,fltrValue)}else if(isNullOrUndefined(col.filter)||isNullOrUndefined(col.filter.ui)||isNullOrUndefined(col.filter.ui.read))instanceofFilterUI.read(targ,col,flOptrValue,this.filterObj);else{let temp=col.filter.ui.read;"string"==typeof temp&&(temp=getValue(temp,window)),flValue=temp({element:targ,column:col,operator:flOptrValue,fltrObj:this.filterObj})}let iconClass=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter",flIcon=this.parent.element.querySelector('[e-mappinguid="'+col.uid+'"]').parentElement.querySelector(iconClass);flIcon&&flIcon.classList.add("e-filtered"),this.closeDialog()}clearBtnClick(column){this.filterObj.removeFilteredColsByField(column.field),this.closeDialog();let iconClass=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter",flIcon=this.parent.element.querySelector('[e-mappinguid="'+column.uid+'"]').parentElement.querySelector(iconClass);flIcon&&flIcon.classList.remove("e-filtered")}destroy(){this.closeDialog()}}class ej2_grids_es2015_ExcelFilter extends ej2_grids_es2015_CheckBoxFilter{constructor(parent,filterSettings,serviceLocator,customFltrOperators){super(parent,filterSettings,serviceLocator),this.customFilterOperators=customFltrOperators,this.isExcel=!0}getCMenuDS(type,operator){let options={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","","CustomFilter"]};options.date=options.number,options.datetime=options.number;let model=[];for(let i=0;i<options[type].length;i++)model.push(options[type][i].length?operator?{text:this.getLocalizedLabel(options[type][i])+"...",iconCss:"e-icons e-icon-check "+(operator===options[type][i].toLowerCase()?"":"e-emptyicon")}:{text:this.getLocalizedLabel(options[type][i])+"..."}:{separator:!0});return model}destroy(){this.dlg&&(this.unwireExEvents(),super.destroy()),this.cmenu&&this.cmenu.parentElement&&ej2_base_es2015_remove(this.cmenu)}createMenu(type,isFiltered,isCheckIcon){this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl");let ul=this.parent.createElement("ul"),icon=isFiltered?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";ul.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),isFiltered?"":"e-disabled",icon)),"boolean"!==type&&ul.appendChild(this.createMenuElem(this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[type]),"e-submenu",isCheckIcon&&this.ensureTextFilter()?"e-icon-check":icon+" e-emptyicon",!0)),this.menu.appendChild(ul)}createMenuElem(val,className,iconName,isSubMenu){let li=this.parent.createElement("li",{className:className+" e-menu-item"});return li.innerHTML=val,li.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+iconName}),li.firstChild),isSubMenu&&li.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),li}wireExEvents(){EventHandler.add(this.dlg,"mouseover",this.hoverHandler,this),EventHandler.add(this.dlg,"click",this.clickExHandler,this)}unwireExEvents(){EventHandler.remove(this.dlg,"mouseover",this.hoverHandler),EventHandler.remove(this.dlg,"click",this.clickExHandler)}clickExHandler(e){let menuItem=parentsUntil(e.target,"e-menu-item");menuItem&&this.getLocalizedLabel("ClearFilter")===menuItem.innerText.trim()&&(this.clearFilter(),this.closeDialog())}destroyCMenu(){this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),ej2_base_es2015_remove(this.cmenu))}hoverHandler(e){let isSubMenu,target=e.target.querySelector(".e-contextmenu"),li=parentsUntil(e.target,"e-menu-item"),focused=this.menu.querySelector(".e-focused");if(focused&&focused.classList.remove("e-focused"),li&&(li.classList.add("e-focused"),isSubMenu=li.classList.contains("e-submenu")),target)return;if(!isSubMenu){let submenu=this.menu.querySelector(".e-submenu");isNullOrUndefined(submenu)||submenu.classList.remove("e-selected"),this.isCMenuOpen=!1,this.destroyCMenu()}let selectedMenu=this.ensureTextFilter();if(!this.isCMenuOpen&&isSubMenu){li.classList.add("e-selected"),this.isCMenuOpen=!0;let menuOptions={items:this.getCMenuDS(this.options.type,selectedMenu?selectedMenu.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,beforeClose:this.preventClose};this.parent.element.appendChild(this.cmenu),this.menuObj=new ej2_navigations_es2015_ContextMenu(menuOptions,this.cmenu);let client=this.menu.querySelector(".e-submenu").getBoundingClientRect(),pos={top:0,left:0};if(Browser.isDevice){let contextRect=this.getContextBounds(this.menuObj);pos.top=(window.innerHeight-contextRect.height)/2,pos.left=(window.innerWidth-contextRect.width)/2,this.closeDialog()}else pos.top=Browser.isIE?window.pageYOffset+client.top:window.scrollY+client.top,pos.left=this.getCMenuYPosition(this.dlg,this.menuObj);this.menuObj.open(pos.top,pos.left,e.target),this.parent.applyBiggerTheme(this.menuObj.element.parentElement)}}ensureTextFilter(){let selectedMenu,predicates=this.existingPredicate[this.options.field];return predicates&&2===predicates.length?selectedMenu="greaterthanorequal"===predicates[0].operator&&"lessthanorequal"===predicates[1].operator?"between":"customfilter":predicates&&1===predicates.length&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],selectedMenu=predicates[0].operator),selectedMenu}preventClose(args){args.event instanceof MouseEvent&&args.event.target.classList.contains("e-submenu")&&(args.cancel=!0)}getContextBounds(context){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()}getCMenuYPosition(target,context){let contextWidth=this.getContextBounds(context).width,targetPosition=target.getBoundingClientRect(),targetBorder=target.offsetWidth-target.clientWidth;return targetBorder=targetBorder?targetBorder+1:0,targetPosition.right+contextWidth-this.parent.element.clientWidth<1?targetPosition.right+1-targetBorder:targetPosition.left-contextWidth-1+targetBorder}openDialog(options){this.updateModel(options),this.getAndSetChkElem(options),this.showDialog(options),this.dialogObj.dataBind();let filterLength=this.existingPredicate[options.field]&&this.existingPredicate[options.field].length||this.options.filteredColumns.filter(col=>this.options.field===col.field).length;this.createMenu(options.type,filterLength>0,1===filterLength||2===filterLength),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"}),this.wireExEvents()}closeDialog(){super.closeDialog()}selectHandler(e){e.item&&(this.menuItem=e.item,this.renderDialogue(e))}renderDialogue(e){let target=e.element,column=this.options.field,isComplex=!isNullOrUndefined(column)&&isComplexField(column),complexFieldName=!isNullOrUndefined(column)&&getComplexFieldID(column),mainDiv=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:isComplex?complexFieldName+"-xlflmenu":column+"-xlflmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:isComplex?complexFieldName+"-xlfldlg":column+"-xlfldlg"}),this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new ej2_popups_es2015_Dialog({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,closeOnEscape:!1,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:()=>{let row=this.dlgObj.element.querySelector("table.e-xlfl-table>tr");this.options.column.filterTemplate?isBlazor()?row.querySelector(".e-xlfl-valuediv").children[0].focus():row.querySelector("#"+this.options.column.field+"-xlfl-frstvalue").focus():row.cells[1].querySelector("input:not([type=hidden])").focus()},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,target,column),buttons:[{click:this.filterBtnClick.bind(this,column),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:"e-xlfl-cancelbtn"}}],content:mainDiv,width:430,animationSettings:{effect:"None"}}),this.dlgObj.isStringTemplate=!0,this.dlgObj.appendTo(this.dlgDiv)}removeDialog(){if(isBlazor()){let columns=this.parent.getColumns();for(let i=0;i<columns.length;i++)columns[i].filterTemplate&&updateBlazorTemplate(this.parent.element.id+columns[i].uid+"filterTemplate","FilterTemplate",columns[i])}this.removeObjects([this.dropOptr,this.datePicker,this.dateTimePicker,this.actObj,this.numericTxtObj,this.dlgObj]),ej2_base_es2015_remove(this.dlgDiv)}createdDialog(target,column){this.renderCustomFilter(target,column),this.dlgObj.element.style.left="0px",this.dlgObj.element.style.top="0px",Browser.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify(beforeCustomFilterOpen,{column:column,dialog:this.dialogObj}),this.dlgObj.show(),this.parent.applyBiggerTheme(this.dlgObj.element.parentElement)}renderCustomFilter(target,column){let dlgConetntEle=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),dlgFields=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});dlgConetntEle.appendChild(dlgFields);let fieldSet=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});dlgConetntEle.appendChild(fieldSet),this.renderFilterUI(column,dlgConetntEle)}filterBtnClick(col){let checkBoxValue,isComplex=!isNullOrUndefined(col)&&isComplexField(col),complexFieldName=!isNullOrUndefined(col)&&getComplexFieldID(col),colValue=isComplex?complexFieldName:col,fValue=this.parent.getColumnByField(col).filterTemplate&&isBlazor()?this.dlgDiv.querySelector(".-xlfl-frstvalue").children[0].querySelector(".e-control").ej2_instances[0]:this.dlgDiv.querySelector("#"+colValue+"-xlfl-frstvalue").ej2_instances[0],fOperator=this.dlgDiv.querySelector("#"+colValue+"-xlfl-frstoptr").ej2_instances[0],sValue=this.parent.getColumnByField(col).filterTemplate&&isBlazor()?this.dlgDiv.querySelector(".-xlfl-secndvalue").children[0].querySelector(".e-control").ej2_instances[0]:this.dlgDiv.querySelector("#"+colValue+"-xlfl-secndvalue").ej2_instances[0],sOperator=this.dlgDiv.querySelector("#"+colValue+"-xlfl-secndoptr").ej2_instances[0];"string"===this.options.type&&(checkBoxValue=this.dlgDiv.querySelector("#"+colValue+"-xlflmtcase").ej2_instances[0].checked);let andRadio=this.dlgDiv.querySelector("#"+colValue+"e-xlfl-frstpredicate").ej2_instances[0],predicate=(this.dlgDiv.querySelector("#"+colValue+"e-xlfl-secndpredicate"),andRadio.checked?"and":"or");null===sValue.value&&(predicate="or"),this.filterByColumn(this.options.field,fOperator.value,fValue.value,predicate,checkBoxValue,this.parent.filterSettings.ignoreAccent,sOperator.value,sValue.value),this.removeDialog()}filterByColumn(fieldName,firstOperator,firstValue,predicate,matchCase,ignoreAccent,secondOperator,secondValue){let mPredicate,col=this.parent.getColumnByField(fieldName),field=col.isForeignColumn()?col.foreignKeyValue:fieldName,fColl=[];if(fColl.push({field:field,predicate:predicate,matchCase:matchCase,ignoreAccent:ignoreAccent,operator:firstOperator,value:firstValue,type:this.options.type}),isActionPrevent(this.parent))return void this.parent.notify(preventBatch,{instance:this,handler:this.filterByColumn,arg1:fieldName,arg2:firstOperator,arg3:firstValue,arg4:predicate,arg5:matchCase,arg6:ignoreAccent,arg7:secondOperator,arg8:secondValue});mPredicate=new ej2_data_es2015_Predicate(field,firstOperator.toLowerCase(),firstValue,!matchCase,ignoreAccent),isNullOrUndefined(secondValue)||(secondOperator=isNullOrUndefined(secondOperator)?"equal":secondOperator,fColl.push({field:field,predicate:predicate,matchCase:matchCase,ignoreAccent:ignoreAccent,operator:secondOperator,value:secondValue,type:this.options.type}),mPredicate=mPredicate[predicate](field,secondOperator.toLowerCase(),secondValue,!matchCase,ignoreAccent));let args={action:"filtering",filterCollection:fColl,field:this.options.field,ejpredicate:mPredicate,actualPredicate:fColl};col.isForeignColumn()?this.foreignKeyFilter(args,fColl,mPredicate):this.options.handler(args)}renderOperatorUI(column,table,elementID,predicates,isFirst){let fieldElement=this.parent.createElement("tr",{className:"e-xlfl-fields"});table.appendChild(fieldElement);let xlfloptr=this.parent.createElement("td",{className:"e-xlfl-optr"});fieldElement.appendChild(xlfloptr);let optrDiv=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),isComplex=!isNullOrUndefined(column)&&isComplexField(column),complexFieldName=!isNullOrUndefined(column)&&getComplexFieldID(column),optrInput=this.parent.createElement("input",{id:isComplex?complexFieldName+elementID:column+elementID});optrDiv.appendChild(optrInput),xlfloptr.appendChild(optrDiv);let dropDatasource=this.customFilterOperators[this.options.type+"Operator"];this.optrData=dropDatasource;let selectedValue=this.dropSelectedVal(this.parent.getColumnByField(column),predicates,isFirst),menuText="";this.menuItem&&((menuText=this.menuItem.text.slice(0,-3))!==this.getLocalizedLabel("CustomFilter")&&(selectedValue=isFirst?menuText:void 0),menuText===this.getLocalizedLabel("Between")&&(selectedValue=this.getLocalizedLabel(isFirst?"GreaterThanOrEqual":"LessThanOrEqual")));let col=this.parent.getColumnByField(column);return this.dropOptr=new ej2_dropdowns_es2015_DropDownList(extend$1({dataSource:dropDatasource,fields:{text:"text",value:"value"},text:selectedValue,open:this.dropDownOpen.bind(this),enableRtl:this.parent.enableRtl},col.filter.params)),this.dropOptr.appendTo(optrInput),{fieldElement:fieldElement,operator:this.getSelectedValue(selectedValue)}}dropDownOpen(args){args.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}getSelectedValue(text){let selectedField=new ej2_data_es2015_DataManager(this.optrData).executeLocal((new ej2_data_es2015_Query).where("text","equal",text));return isNullOrUndefined(selectedField[0])?"":selectedField[0].value}dropSelectedVal(col,predicates,isFirst){let operator;return this.getSelectedText(operator=predicates&&predicates.length>0?2===predicates.length?isFirst?predicates[0].operator:predicates[1].operator:isFirst?predicates[0].operator:void 0:isFirst?col.filter.operator||"equal":void 0)}getSelectedText(operator){let selectedField=new ej2_data_es2015_DataManager(this.optrData).executeLocal((new ej2_data_es2015_Query).where("value","equal",operator));return isNullOrUndefined(selectedField[0])?"":selectedField[0].text}renderFilterUI(column,dlgConetntEle){let predicates=this.existingPredicate[column],table=this.parent.createElement("table",{className:"e-xlfl-table"});dlgConetntEle.appendChild(table);let colGroup=this.parent.createElement("colGroup");colGroup.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',table.appendChild(colGroup);let optr=this.renderOperatorUI(column,table,"-xlfl-frstoptr",predicates,!0);this.renderFlValueUI(column,optr,"-xlfl-frstvalue",predicates,!0);let predicate=this.parent.createElement("tr",{className:"e-xlfl-predicate"});table.appendChild(predicate),this.renderRadioButton(column,predicate,predicates),optr=this.renderOperatorUI(column,table,"-xlfl-secndoptr",predicates,!1),this.renderFlValueUI(column,optr,"-xlfl-secndvalue",predicates,!1)}renderRadioButton(column,tr,predicates){let td=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});tr.appendChild(td);let radioDiv=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),isComplex=!isNullOrUndefined(column)&&isComplexField(column),complexFieldName=!isNullOrUndefined(column)&&getComplexFieldID(column),frstpredicate=this.parent.createElement("input",{id:isComplex?complexFieldName+"e-xlfl-frstpredicate":column+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),secndpredicate=this.parent.createElement("input",{id:isComplex?complexFieldName+"e-xlfl-secndpredicate":column+"e-xlfl-secndpredicate",attrs:{type:"radio"}});radioDiv.appendChild(frstpredicate),radioDiv.appendChild(secndpredicate),td.appendChild(radioDiv),"string"===this.options.type&&this.renderMatchCase(column,tr,td,"-xlflmtcase",predicates);let andRadio=new ej2_buttons_es2015_RadioButton({label:this.getLocalizedLabel("AND"),name:"default",cssClass:"e-xlfl-radio-and",checked:!0,enableRtl:this.parent.enableRtl}),orRadio=new ej2_buttons_es2015_RadioButton({label:this.getLocalizedLabel("OR"),name:"default",cssClass:"e-xlfl-radio-or",enableRtl:this.parent.enableRtl});"and"===(predicates&&2===predicates.length?predicates[1].predicate:"and")?(andRadio.checked=!0,orRadio.checked=!1):(orRadio.checked=!0,andRadio.checked=!1),andRadio.appendTo(frstpredicate),orRadio.appendTo(secndpredicate)}removeObjects(elements){for(let obj of elements)obj&&!obj.isDestroyed&&obj.destroy()}renderFlValueUI(column,optr,elementId,predicates,isFirst){let value=this.parent.createElement("td",{className:"e-xlfl-value"});optr.fieldElement.appendChild(value);let isComplex=!isNullOrUndefined(column)&&isComplexField(column),complexFieldName=!isNullOrUndefined(column)&&getComplexFieldID(column),valueDiv=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),isFilteredCol=this.filterSettings.columns.some(col=>column===col.field),fltrPredicates=this.options.filteredColumns.filter(col=>col.field===column);if(this.options.column.filterTemplate){let data={},columnObj=this.parent.getColumnByField(column);isFilteredCol&&elementId&&(data=this.getExcelFilterData(elementId,data,columnObj,predicates,fltrPredicates));let tempID=this.parent.element.id+columnObj.uid+"filterTemplate";appendChildren(valueDiv,this.options.column.getFilterTemplate()(data,this.parent,"filterTemplate",tempID)),isBlazor()?(valueDiv.children[0].classList.add(elementId),this.dlgDiv.querySelectorAll(".e-xlfl-value").length>1&&updateBlazorTemplate(tempID,"FilterTemplate",columnObj)):valueDiv.children[0].id=isComplex?complexFieldName+elementId:column+elementId,value.appendChild(valueDiv)}else{let flValue,predicate,valueInput=this.parent.createElement("input",{id:isComplex?complexFieldName+elementId:column+elementId});valueDiv.appendChild(valueInput),value.appendChild(valueDiv),predicates&&predicates.length>0&&(flValue=(predicate=2===predicates.length?isFirst?predicates[0]:predicates[1]:isFirst?predicates[0]:void 0)&&predicate.operator===optr.operator?predicate.value:void 0),{string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)}[this.options.type](this.options,column,valueInput,flValue,this.parent.enableRtl)}}getExcelFilterData(elementId,data,columnObj,predicates,fltrPredicates){let predIndex="-xlfl-frstvalue"===elementId?0:1;if("-xlfl-frstvalue"===elementId||fltrPredicates.length>1){data={column:predicates instanceof Array?predicates[predIndex]:predicates};let indx=this.options.column.columnData&&fltrPredicates.length>1?1===this.options.column.columnData.length?0:1:predIndex;data[this.options.field]=columnObj.foreignKeyValue?this.options.column.columnData[indx][columnObj.foreignKeyValue]:fltrPredicates[indx].value,this.options.foreignKeyValue&&(data[this.options.foreignKeyValue]=this.options.column.columnData[indx][columnObj.foreignKeyValue])}return data}renderMatchCase(column,tr,matchCase,elementId,predicates){let matchCaseDiv=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),isComplex=!isNullOrUndefined(column)&&isComplexField(column),complexFieldName=!isNullOrUndefined(column)&&getComplexFieldID(column),matchCaseInput=this.parent.createElement("input",{id:isComplex?complexFieldName+elementId:column+elementId,attrs:{type:"checkbox"}});matchCaseDiv.appendChild(matchCaseInput),matchCase.appendChild(matchCaseDiv);let flValue=!!(predicates&&predicates.length>0)&&(predicates&&2===predicates.length?predicates[1].matchCase:predicates[0].matchCase);new ej2_buttons_es2015_CheckBox({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:flValue}).appendTo(matchCaseInput)}renderDate(options,column,inputValue,fValue,isRtl){let format=getCustomDateFormat(options.format,options.type);this.datePicker=new ej2_calendars_es2015_DatePicker(extend$1({format:format,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:isRtl,value:new Date(fValue)},options.column.filter.params)),this.datePicker.appendTo(inputValue)}renderDateTime(options,column,inputValue,fValue,isRtl){let format=getCustomDateFormat(options.format,options.type);this.dateTimePicker=new ej2_calendars_es2015_DateTimePicker(extend$1({format:format,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:isRtl,value:new Date(fValue)},options.column.filter.params)),this.dateTimePicker.appendTo(inputValue)}completeAction(e){e.result=function(result){let temp={},res=[];for(let i=0;i<result.length;i++)result[i]in temp||(res.push(result[i].toString()),temp[result[i]]=1);return res}(e.result)}renderNumericTextBox(options,column,inputValue,fValue,isRtl){this.numericTxtObj=new ej2_inputs_es2015_NumericTextBox(extend$1({format:options.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:isRtl,value:fValue},options.column.filter.params)),this.numericTxtObj.appendTo(inputValue)}renderAutoComplete(options,column,inputValue,fValue,isRtl){let colObj=this.parent.getColumnByField(column),isForeignColumn=colObj.isForeignColumn(),dataSource=isForeignColumn?colObj.dataSource:options.dataSource,fields={value:isForeignColumn?colObj.foreignKeyValue:column},actObj=new ej2_dropdowns_es2015_AutoComplete(extend$1({dataSource:dataSource instanceof ej2_data_es2015_DataManager?dataSource:new ej2_data_es2015_DataManager(dataSource),fields:fields,query:this.parent.getQuery().clone(),sortOrder:"Ascending",locale:this.parent.locale,autofill:!0,focus:()=>{let isComplex=!isNullOrUndefined(column)&&isComplexField(column),complexFieldName=!isNullOrUndefined(column)&&getComplexFieldID(column),columnvalue=isComplex?complexFieldName:column;actObj.filterType=this.dlgDiv.querySelector("#"+columnvalue+(inputValue.id===columnvalue+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,actObj.ignoreCase="string"!==options.type||!this.dlgDiv.querySelector("#"+columnvalue+"-xlflmtcase").ej2_instances[0].checked,actObj.filterType=isNullOrUndefined(actObj.filterType)?"equal":actObj.filterType},placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:isRtl,actionComplete:e=>{let isComplex=!isNullOrUndefined(column)&&isComplexField(column);e.result=e.result.filter((obj,index,arr)=>arr.map(mapObject=>isComplex?this.performComplexDataOperation(actObj.fields.value,mapObject):mapObject[actObj.fields.value]).indexOf(isComplex?this.performComplexDataOperation(actObj.fields.value,obj):obj[this.actObj.fields.value])===index)},value:fValue},colObj.filter.params));actObj.appendTo(inputValue),this.actObj=actObj}performComplexDataOperation(value,mapObject){let returnObj,length=value.split(".").length,splits=value.split("."),duplicateMap=mapObject;for(let i=0;i<length;i++)duplicateMap=returnObj=duplicateMap[splits[i]];return returnObj}getModuleName(){return"excelFilter"}}class ej2_grids_es2015_Filter{constructor(parent,filterSettings,serviceLocator){this.predicate="and",this.contentRefresh=!0,this.refresh=!0,this.values={},this.cellText={},this.nextFlMenuOpen="",this.type={Menu:ej2_grids_es2015_FilterMenuRenderer,CheckBox:ej2_grids_es2015_CheckBoxFilter,Excel:ej2_grids_es2015_ExcelFilter},this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"},this.fltrDlgDetails={field:"",isOpen:!1},this.actualPredicate={},this.parent=parent,this.filterSettings=filterSettings,this.serviceLocator=serviceLocator,this.addEventListener()}render(e){if(ej2_data_es2015_DataUtil.getObject("args.isFrozen",e))return;let gObj=this.parent;if(this.l10n=this.serviceLocator.getService("localization"),this.getLocalizedCustomOperators(),"FilterBar"===this.parent.filterSettings.type&&gObj.columns.length){let fltrElem=this.parent.element.querySelector(".e-filterbar");fltrElem&&ej2_base_es2015_remove(fltrElem);let row,rowRenderer=new ej2_grids_es2015_RowRenderer(this.serviceLocator,CellType.Filter,gObj);this.serviceLocator.getService("cellRendererFactory").addCellRenderer(CellType.Filter,new ej2_grids_es2015_FilterCellRenderer(this.parent,this.serviceLocator)),this.valueFormatter=this.serviceLocator.getService("valueFormatter"),rowRenderer.element=this.parent.createElement("tr",{className:"e-filterbar"}),(row=this.generateRow()).data=this.values,this.parent.getHeaderContent().querySelector("thead").appendChild(rowRenderer.element);let rowdrag=this.parent.element.querySelector(".e-rowdragheader");this.element=rowRenderer.render(row,gObj.getColumns(),null,null,rowRenderer.element);let detail=this.element.querySelector(".e-detailheadercell");detail&&(detail.className="e-filterbarcell e-mastercell"),rowdrag&&(rowdrag.className="e-dragheadercell e-mastercell");let gCells=[].slice.call(this.element.querySelectorAll(".e-grouptopleftcell"));gCells.length&&gCells[gCells.length-1].classList.add("e-lastgrouptopleftcell"),this.wireEvents(),this.parent.notify(freezeRender,{case:"filter"})}}destroy(){let gridElement=this.parent.element;if(gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.filterModule&&this.filterModule.destroy(),this.parent.refreshing||(this.filterSettings.columns=[]),this.updateFilterMsg(),this.removeEventListener(),this.unWireEvents(),this.element)){ej2_base_es2015_remove(this.element);let filterBarElement=this.parent.getHeaderContent().querySelector(".e-filterbar");this.parent.getFrozenColumns()&&filterBarElement&&ej2_base_es2015_remove(filterBarElement)}}generateRow(index){let row=new ej2_grids_es2015_Row({});return row.cells=this.generateCells(),row}generateCells(){let cells=[];if(this.parent.allowGrouping)for(let c=0,len=this.parent.groupSettings.columns.length;c<len;c++)cells.push(this.generateCell({},CellType.HeaderIndent));(this.parent.detailTemplate||this.parent.childGrid)&&cells.push(this.generateCell({},CellType.DetailHeader)),this.parent.isRowDragable()&&cells.push(this.generateCell({},CellType.RowDragHIcon));for(let dummy of this.parent.getColumns())cells.push(this.generateCell(dummy));return cells}generateCell(column,cellType){let opt={visible:column.visible,isDataCell:!1,rowId:"",column:column,cellType:cellType||CellType.Filter,attributes:{title:this.l10n.getConstant("FilterbarTitle")}};return new ej2_grids_es2015_Cell(opt)}updateModel(){let col=this.parent.getColumnByField(this.fieldName),field=col.isForeignColumn()?col.foreignKeyValue:this.fieldName;this.currentFilterObject={field:field,uid:col.uid,isForeignKey:col.isForeignColumn(),operator:this.operator,value:this.value,predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}};let index=this.getFilteredColsIndexByField(col);index>-1?this.filterSettings.columns[index]=this.currentFilterObject:this.filterSettings.columns.push(this.currentFilterObject),this.filterSettings.columns=this.filterSettings.columns,this.parent.dataBind()}getFilteredColsIndexByField(col){let cols=this.filterSettings.columns;for(let i=0,len=cols.length;i<len;i++)if(cols[i].uid===col.uid||col.isForeignColumn()&&this.parent.getColumnByUid(col.uid).field===col.foreignKeyValue)return i;return-1}onActionComplete(e){let args=this.isRemove?{requestType:"filtering",type:actionComplete}:{currentFilterObject:this.currentFilterObject,currentFilteringColumn:isNullOrUndefined(this.column)?void 0:this.column.field,columns:this.filterSettings.columns,requestType:"filtering",type:actionComplete};this.parent.trigger(actionComplete,extend(e,args)),this.isRemove=!1}wireEvents(){EventHandler.add(this.parent.getHeaderContent(),"keyup",this.keyUpHandler,this)}unWireEvents(){EventHandler.remove(this.parent.getHeaderContent(),"keyup",this.keyUpHandler)}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&(this.parent.getHeaderTable().classList.add("e-sortfilter"),this.render())}initialEnd(){if(this.parent.off(contentReady,this.initialEnd),this.parent.getColumns().length&&this.filterSettings.columns.length){let gObj=this.parent;this.contentRefresh=!1,this.initialLoad=!0;for(let col of gObj.filterSettings.columns)this.filterByColumn(col.field,col.operator,col.value,col.predicate,col.matchCase,col.ignoreAccent,col.actualFilterValue,col.actualOperator);this.initialLoad=!1,this.updateFilterMsg(),this.contentRefresh=!0}}addEventListener(){this.parent.isDestroyed||(this.parent.on(uiUpdate,this.enableAfterRender,this),this.parent.on(filterComplete,this.onActionComplete,this),this.parent.on(inBoundModelChanged,this.onPropertyChanged,this),this.parent.on(keyPressed,this.keyUpHandler,this),this.parent.on(columnPositionChanged,this.columnPositionChanged,this),this.parent.on(headerRefreshed,this.render,this),this.parent.on(contentReady,this.initialEnd,this),this.parent.on(filterMenuClose,this.filterMenuClose,this),EventHandler.add(document,"click",this.clickHandler,this),this.parent.on(filterOpen,this.columnMenuFilter,this),this.parent.on(click,this.filterIconClickHandler,this))}removeEventListener(){EventHandler.remove(document,"click",this.clickHandler),this.parent.isDestroyed||(this.parent.off(uiUpdate,this.enableAfterRender),this.parent.off(filterComplete,this.onActionComplete),this.parent.off(inBoundModelChanged,this.onPropertyChanged),this.parent.off(keyPressed,this.keyUpHandler),this.parent.off(columnPositionChanged,this.columnPositionChanged),this.parent.off(headerRefreshed,this.render),this.parent.off(filterOpen,this.columnMenuFilter),this.parent.off(filterMenuClose,this.filterMenuClose),this.parent.off(click,this.filterIconClickHandler))}filterMenuClose(args){this.fltrDlgDetails.isOpen=!1}filterByColumn(fieldName,filterOperator,filterValue,predicate,matchCase,ignoreAccent,actualFilterValue,actualOperator){let filterCell,gObj=this.parent;if(this.column=gObj.grabColumnByFieldFromAllCols(fieldName),"FilterBar"===this.filterSettings.type&&(filterCell=gObj.getHeaderContent().querySelector("[id='"+this.column.field+"_filterBarcell']")),isNullOrUndefined(this.column.allowFiltering)||this.column.allowFiltering)if(isActionPrevent(gObj))gObj.notify(preventBatch,{instance:this,handler:this.filterByColumn,arg1:fieldName,arg2:filterOperator,arg3:filterValue,arg4:predicate,arg5:matchCase,arg6:ignoreAccent,arg7:actualFilterValue,arg8:actualOperator});else{if(this.value=filterValue,this.matchCase=this.filterSettings.enableCaseSensitivity,this.ignoreAccent=this.ignoreAccent=isNullOrUndefined(ignoreAccent)?this.parent.filterSettings.ignoreAccent:ignoreAccent,this.fieldName=fieldName,this.predicate=predicate||"and",this.operator=filterOperator,filterValue=!isNullOrUndefined(filterValue)&&filterValue.toString(),"number"!==this.column.type&&"date"!==this.column.type||(this.matchCase=!0),gObj.getColumnHeaderByField(fieldName).setAttribute("aria-filtered","true"),filterValue.length<1||this.checkForSkipInput(this.column,filterValue))return this.filterStatusMsg=filterValue.length<1?"":this.l10n.getConstant("InvalidFilterMessage"),void this.updateFilterMsg();filterCell&&"FilterBar"===this.filterSettings.type&&filterCell.value!==filterValue&&(filterCell.value=filterValue),isNullOrUndefined(this.column.format)?this.values[this.column.field]=filterValue:(this.applyColumnFormat(filterValue),this.initialLoad&&"FilterBar"===this.filterSettings.type&&(filterCell.value=this.values[this.column.field])),this.actualPredicate[this.fieldName]=[{field:this.fieldName,predicate:predicate,matchCase:matchCase,ignoreAccent:ignoreAccent,operator:this.operator,value:this.value,type:this.column.type}],this.addFilteredClass(this.fieldName),this.checkAlreadyColFiltered(this.column.field)||this.updateModel()}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:this.column.headerText})}applyColumnFormat(filterValue){let getFlvalue="date"===this.column.type||"datetime"===this.column.type?new Date(filterValue):parseFloat(filterValue);this.values[this.column.field]=this.setFormatForFlColumn(getFlvalue,this.column)}onPropertyChanged(e){if(e.module===this.getModuleName())for(let prop of Object.keys(e.properties))switch(prop){case"columns":this.contentRefresh&&(this.parent.notify(modelChanged,{currentFilterObject:this.currentFilterObject,currentFilteringColumn:this.column?this.column.field:void 0,columns:this.filterSettings.columns,requestType:"filtering",type:actionBegin}),this.refreshFilterSettings(),this.updateFilterMsg(),this.updateFilter());break;case"showFilterBarStatus":e.properties[prop]?this.updateFilterMsg():this.parent.allowPaging&&this.parent.updateExternalMessage("");break;case"type":this.parent.refreshHeader(),this.refreshFilterSettings()}}refreshFilterSettings(){if("FilterBar"===this.filterSettings.type){for(let i=0;i<this.filterSettings.columns.length;i++){this.column=this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[i].uid);let filterValue=this.filterSettings.columns[i].value;filterValue=!isNullOrUndefined(filterValue)&&filterValue.toString(),isNullOrUndefined(this.column.format)?this.values[this.filterSettings.columns[i].field]=this.filterSettings.columns[i].value:this.applyColumnFormat(filterValue);let filterElement=this.getFilterBarElement(this.column.field);filterElement&&(filterElement.value=isNullOrUndefined(this.cellText[this.filterSettings.columns[i].field])?this.filterSettings.columns[i].value:this.cellText[this.column.field])}if(0===this.filterSettings.columns.length){let col=this.parent.getColumns();for(let i=0;i<col.length;i++){let filterElement=this.getFilterBarElement(col[i].field);filterElement&&""!==filterElement.value&&(filterElement.value="",delete this.values[col[i].field])}}}}getFilterBarElement(col){let filterElement,selector="[id='"+col+"_filterBarcell']";return selector&&!isNullOrUndefined(this.element)&&(filterElement=this.element.querySelector(selector)),filterElement}refreshFilter(){this.refreshFilterSettings(),this.updateFilterMsg()}clearFiltering(){let cols=getActualPropFromColl(this.filterSettings.columns);if(isActionPrevent(this.parent))return void this.parent.notify(preventBatch,{instance:this,handler:this.clearFiltering});cols.forEach(col=>{col.uid=col.uid||this.parent.getColumnByField(col.field).uid});let colUid=cols.map(f=>f.uid),filteredcols=colUid.filter((item,pos)=>colUid.indexOf(item)===pos);this.refresh=!1;for(let i=0,len=filteredcols.length;i<len;i++)this.removeFilteredColsByField(this.parent.getColumnByUid(filteredcols[i]).field,!1);if(this.refresh=!0,filteredcols.length&&this.parent.renderModule.refresh(),0===this.parent.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered")){let fltrElement=[].slice.call(this.parent.element.querySelectorAll(".e-filtered"));for(let i=0,len=fltrElement.length;i<len;i++)fltrElement[0].removeAttribute("aria-filtered"),fltrElement[0].classList.remove("e-filtered")}this.isRemove=!0,this.filterStatusMsg="",this.updateFilterMsg()}checkAlreadyColFiltered(field){let columns=this.filterSettings.columns;for(let col of columns)if(col.field===field&&col.value===this.value&&col.operator===this.operator&&col.predicate===this.predicate)return!0;return!1}columnMenuFilter(args){this.column=args.col;let ele=closest(args.target,"#"+args.id);args.isClose&&!ele?this.filterModule.closeDialog():ele&&this.filterDialogOpen(this.column,args.target)}filterDialogOpen(col,target,left,top){let gObj=this.parent;this.filterModule&&this.filterModule.closeDialog(),this.filterModule=new this.type[col.filter.type||this.parent.filterSettings.type](this.parent,gObj.filterSettings,this.serviceLocator,this.customOperators,this);let dataSource=col.filter.dataSource||gObj.getDataModule().dataManager;this.filterModule.openDialog({type:col.type,field:col.field,displayName:col.headerText,dataSource:dataSource,format:col.format,filteredColumns:gObj.filterSettings.columns,target:target,sortedColumns:gObj.sortSettings.columns,formatFn:col.getFormatter(),parserFn:col.getParser(),query:gObj.query,template:col.getFilterItemTemplate(),hideSearchbox:!isNullOrUndefined(col.filter.hideSearchbox)&&col.filter.hideSearchbox,handler:this.filterHandler.bind(this),localizedStrings:gObj.getLocaleConstants(),position:{X:left,Y:top},column:col,foreignKeyValue:col.foreignKeyValue,actualPredicate:this.actualPredicate,localeObj:this.parent.localeObj})}removeFilteredColsByField(field,isClearFilterBar){let fCell,cols=this.filterSettings.columns;if(isActionPrevent(this.parent))return void this.parent.notify(preventBatch,{instance:this,handler:this.removeFilteredColsByField,arg1:field,arg2:isClearFilterBar});let colUid=cols.map(f=>f.uid),filteredColsUid=colUid.filter((item,pos)=>colUid.indexOf(item)===pos);for(let i=0,len=filteredColsUid.length;i<len;i++){cols[i].uid=cols[i].uid||this.parent.getColumnByField(cols[i].field).uid;let len=cols.length,column=this.parent.grabColumnByUidFromAllCols(filteredColsUid[i]);if(column.field===field||column.field===column.foreignKeyValue&&column.isForeignColumn()){if("FilterBar"===this.filterSettings.type&&!isClearFilterBar){let selector="[id='"+column.field+"_filterBarcell']";(fCell=this.parent.getHeaderContent().querySelector(selector))&&(fCell.value="",delete this.values[field])}for(;len--;)cols[len].uid===column.uid&&cols.splice(len,1);let fltrElement=this.parent.getColumnHeaderByField(column.field);fltrElement.removeAttribute("aria-filtered"),"FilterBar"!==this.filterSettings.type&&fltrElement.querySelector(this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter").classList.remove("e-filtered"),this.isRemove=!0,this.actualPredicate[field]&&delete this.actualPredicate[field],this.values[field]&&delete this.values[field],this.refresh&&this.parent.notify(modelChanged,{requestType:"filtering",type:actionBegin,currentFilterObject:{field:column.field,operator:this.operator,value:this.value,predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}},currentFilterColumn:column});break}}this.updateFilterMsg()}getModuleName(){return"filter"}keyUpHandler(e){let gObj=this.parent,target=e.target;if(target&&matches(target,".e-filterbar input")){let closeHeaderEle=closest(target,"th.e-filterbarcell");if(this.column=gObj.getColumnByUid(closeHeaderEle.getAttribute("e-mappinguid")),!this.column)return;"Immediate"!==this.filterSettings.mode&&13!==e.keyCode||9===e.keyCode||(this.value=target.value.trim(),this.processFilter(e))}}updateCrossIcon(element){element.value.length&&element.nextElementSibling.classList.remove("e-hide")}updateFilterMsg(){if("FilterBar"===this.filterSettings.type){let getFormatFlValue,column,gObj=this.parent,columns=this.filterSettings.columns;if(this.serviceLocator.getService("valueFormatter"),!this.filterSettings.showFilterBarStatus)return;if(columns.length>0&&this.filterStatusMsg!==this.l10n.getConstant("InvalidFilterMessage")){this.filterStatusMsg="";for(let index=0;index<columns.length;index++)if(column=gObj.grabColumnByUidFromAllCols(columns[index].uid),index&&(this.filterStatusMsg+=" && "),isNullOrUndefined(column.format))this.filterStatusMsg+=column.headerText+": "+this.values[column.field];else{let flValue="date"===column.type||"datetime"===column.type?this.valueFormatter.fromView(this.values[column.field],column.getParser(),column.type):this.values[column.field];getFormatFlValue="date"!==column.type&&"datetime"!==column.type?this.serviceLocator.getService("valueFormatter").toView(flValue,column.getParser()).toString():this.setFormatForFlColumn(flValue,column),this.filterStatusMsg+=column.headerText+": "+getFormatFlValue}}gObj.allowPaging&&gObj.updateExternalMessage(this.filterStatusMsg),this.filterStatusMsg=""}}setFormatForFlColumn(value,column){return this.serviceLocator.getService("valueFormatter").toView(value,column.getFormatter()).toString()}checkForSkipInput(column,value){let isSkip,skipInput;if("number"===column.type)skipInput=["="," ","!"],(ej2_data_es2015_DataUtil.operatorSymbols[value]||skipInput.indexOf(value)>-1)&&(isSkip=!0);else if("string"===column.type){skipInput=[">","<","=","!"];for(let val of value)skipInput.indexOf(val)>-1&&(isSkip=!0)}return isSkip}processFilter(e){this.stopTimer(),this.startTimer(e)}startTimer(e){this.timer=window.setInterval(()=>{this.onTimerTick()},13===e.keyCode?0:this.filterSettings.immediateModeDelay)}stopTimer(){window.clearInterval(this.timer)}onTimerTick(){let filterValue,selector="[id='"+this.column.field+"_filterBarcell']",filterElement=this.element.querySelector(selector);if(!filterElement&&this.parent.getFrozenColumns()&&(filterElement=this.parent.getHeaderContent().querySelector(selector)),this.cellText[this.column.field]=filterElement.value,this.stopTimer(),isNullOrUndefined(this.column.filterBarTemplate))filterValue=JSON.parse(JSON.stringify(filterElement.value));else{let templateRead=this.column.filterBarTemplate.read;"string"==typeof templateRead&&(templateRead=getValue(templateRead,window)),isNullOrUndefined(templateRead)||(this.value=templateRead.call(this,filterElement))}isNullOrUndefined(this.value)||""===this.value?this.removeFilteredColsByField(this.column.field):(this.validateFilterValue(this.value),this.filterByColumn(this.column.field,this.operator,this.value,this.predicate,this.matchCase,this.ignoreAccent),filterElement.value=filterValue,this.updateFilterMsg())}validateFilterValue(value){let skipInput,index;switch(this.matchCase=this.filterSettings.enableCaseSensitivity,this.column.type){case"number":this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal,skipInput=[">","<","=","!"];for(let i=0;i<value.length;i++)if(skipInput.indexOf(value[i])>-1){index=i;break}this.getOperator(value.substring(index)),0!==index&&(this.value=value.substring(0,index)),""!==this.value&&value.length>=1&&(this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type)),isNaN(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));break;case"date":case"datetime":this.operator=this.filterOperators.equal,""===this.value||this.value instanceof Date||(this.getOperator(value),this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type),isNullOrUndefined(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")));break;case"string":this.matchCase=!1,"*"===value.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.startsWith):"%"===value.charAt(value.length-1)?(this.value=this.value.slice(0,-1),this.operator=this.filterOperators.startsWith):"%"===value.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.endsWith):this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.startsWith;break;case"boolean":"true"===value.toLowerCase()||"1"===value?this.value=!0:"false"===value.toLowerCase()||"0"===value?this.value=!1:value.length&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")),this.operator=this.filterOperators.equal;break;default:this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal}}getOperator(value){let singleOp=value.charAt(0),multipleOp=value.slice(0,2),operators=extend({"=":this.filterOperators.equal,"!":this.filterOperators.notEqual},ej2_data_es2015_DataUtil.operatorSymbols);(operators.hasOwnProperty(singleOp)||operators.hasOwnProperty(multipleOp))&&(this.operator=operators[singleOp],this.value=value.substring(1),this.operator||(this.operator=operators[multipleOp],this.value=value.substring(2))),this.operator!==this.filterOperators.lessThan&&this.operator!==this.filterOperators.greaterThan||"="===this.value.charAt(0)&&(this.operator=this.operator+"orequal",this.value=this.value.substring(1))}columnPositionChanged(e){}getLocalizedCustomOperators(){let numOptr=[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"greaterthan",text:this.l10n.getConstant("GreaterThan")},{value:"greaterthanorequal",text:this.l10n.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:this.l10n.getConstant("LessThan")},{value:"lessthanorequal",text:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}];this.customOperators={stringOperator:[{value:"startswith",text:this.l10n.getConstant("StartsWith")},{value:"endswith",text:this.l10n.getConstant("EndsWith")},{value:"contains",text:this.l10n.getConstant("Contains")},{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}],numberOperator:numOptr,dateOperator:numOptr,datetimeOperator:numOptr,booleanOperator:[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}]}}filterIconClickHandler(e){let target=e.target;if(target.classList.contains("e-filtermenudiv")&&("Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type)){let gObj=this.parent,col=gObj.getColumnByUid(parentsUntil(target,"e-headercell").firstElementChild.getAttribute("e-mappinguid")),gClient=gObj.element.getBoundingClientRect(),fClient=target.getBoundingClientRect();if(this.column=col,this.fltrDlgDetails.field===col.field&&this.fltrDlgDetails.isOpen)return;this.filterModule&&this.filterModule.closeDialog(),this.fltrDlgDetails={field:col.field,isOpen:!0},this.filterDialogOpen(this.column,target,fClient.right-gClient.left,fClient.bottom-gClient.top)}}clickHandler(e){if("Immediate"===this.filterSettings.mode||"Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type){let target=e.target,datepickerEle=target.classList.contains("e-day");if(parentsUntil(target,"e-filter-popup")||target.classList.contains("e-filtermenudiv"))return;!this.filterModule||parentsUntil(target,"e-popup-wrapper")||closest(target,".e-filter-item.e-menu-item")||parentsUntil(target,"e-filter-popup")||datepickerEle||this.filterModule.closeDialog(target),"Immediate"===this.filterSettings.mode&&target.classList.contains("e-clear-icon")&&this.removeFilteredColsByField(target.previousElementSibling.id.slice(0,-14))}}filterHandler(args){let filterIconElement;this.actualPredicate[args.field]=args.actualPredicate;let dataManager=new ej2_data_es2015_DataManager(this.filterSettings.columns),query=(new ej2_data_es2015_Query).where("field",this.filterOperators.equal,args.field),result=dataManager.executeLocal(query);for(let i=0;i<result.length;i++){let index=-1;for(let j=0;j<this.filterSettings.columns.length;j++)if(result[i].field===this.filterSettings.columns[j].field){index=j;break}-1!==index&&this.filterSettings.columns.splice(index,1)}this.values[args.field]&&delete this.values[args.field];let iconClass=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter";filterIconElement=this.parent.getColumnHeaderByField(args.field).querySelector(iconClass),"filtering"===args.action?(this.filterSettings.columns=this.filterSettings.columns.concat(args.filterCollection),this.filterSettings.columns.length&&filterIconElement&&filterIconElement.classList.add("e-filtered")):(filterIconElement&&filterIconElement.classList.remove("e-filtered"),this.parent.renderModule.refresh()),this.parent.dataBind()}updateFilter(){let cols=this.filterSettings.columns;this.actualPredicate={};for(let i=0;i<cols.length;i++){this.column=this.parent.getColumnByField(cols[i].field)||getColumnByForeignKeyValue(cols[i].field,this.parent.getForeignKeyColumns());let fieldName=cols[i].field;this.parent.getColumnByField(cols[i].field)||(fieldName=getColumnByForeignKeyValue(cols[i].field,this.parent.getForeignKeyColumns()).field),this.refreshFilterIcon(fieldName,cols[i].operator,cols[i].value,cols[i].type,cols[i].predicate,cols[i].matchCase,cols[i].ignoreAccent,cols[i].uid)}}refreshFilterIcon(fieldName,operator,value,type,predicate,matchCase,ignoreAccent,uid){let obj;obj={field:fieldName,predicate:predicate,matchCase:matchCase,ignoreAccent:ignoreAccent,operator:operator,value:value,type:type},this.actualPredicate[fieldName]?this.actualPredicate[fieldName].push(obj):this.actualPredicate[fieldName]=[obj];let field=uid?this.parent.grabColumnByUidFromAllCols(uid).field:fieldName;this.addFilteredClass(field)}addFilteredClass(fieldName){let filterIconElement;this.parent.showColumnMenu?filterIconElement=this.parent.getColumnHeaderByField(fieldName).querySelector(".e-columnmenu"):this.parent.getColumnByField(fieldName)&&(filterIconElement=this.parent.getColumnHeaderByField(fieldName).querySelector(".e-icon-filter")),filterIconElement&&filterIconElement.classList.add("e-filtered")}}const resizeClassList={root:"e-rhandler",suppress:"e-rsuppress",icon:"e-ricon",helper:"e-rhelper",header:"th.e-headercell",cursor:"e-rcursor"};class ej2_grids_es2015_Resize{constructor(parent){this.tapped=!1,this.isDblClk=!0,this.parent=parent,this.parent.isDestroyed||(this.widthService=new ej2_grids_es2015_ColumnWidthService(parent),this.addEventListener())}autoFitColumns(fName){let columnName=null==fName||fName.length<=0?this.parent.getColumns().map(x=>x.field):"string"==typeof fName?[fName]:fName;this.findColumn(columnName)}autoFit(){let newarray=this.parent.getColumns().filter(c=>!0===c.autoFit).map(c=>c.field||c.headerText);newarray.length>0&&this.autoFitColumns(newarray)}resizeColumn(fName,index,id){let headerTable,contentTable,footerTable,headerTextClone,contentTextClone,footerTextClone,gObj=this.parent,tWidth=0,indentWidth=0,uid=id||this.parent.getUidByColumnField(fName),columnIndex=this.parent.getNormalizedColumnIndex(uid),frzCols=gObj.getFrozenColumns();isNullOrUndefined(gObj.getFooterContent())||(footerTable=gObj.getFooterContentTable()),frzCols?index<frzCols?(headerTable=gObj.getHeaderTable(),contentTable=gObj.getContentTable(),headerTextClone=headerTable.querySelector('[e-mappinguid="'+uid+'"]').parentElement.cloneNode(!0),contentTextClone=contentTable.querySelectorAll(`td:nth-child(${columnIndex+1})`),footerTable&&(footerTextClone=footerTable.querySelectorAll(`td:nth-child(${columnIndex+1})`))):(headerTable=gObj.getHeaderContent().querySelector(".e-movableheader").children[0],contentTable=gObj.getContent().querySelector(".e-movablecontent").children[0],headerTextClone=headerTable.querySelector('[e-mappinguid="'+uid+'"]').parentElement.cloneNode(!0),contentTextClone=contentTable.querySelectorAll(`td:nth-child(${columnIndex-frzCols+1})`),footerTable&&(footerTextClone=(footerTable=gObj.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll(`td:nth-child(${columnIndex-frzCols+1})`))):(headerTable=gObj.getHeaderTable(),contentTable=gObj.getContentTable(),headerTextClone=headerTable.querySelector('[e-mappinguid="'+uid+'"]').parentElement.cloneNode(!0),contentTextClone=contentTable.querySelectorAll(`td:nth-child(${columnIndex+1}):not(.e-groupcaption)`),footerTable&&(footerTextClone=footerTable.querySelectorAll(`td:nth-child(${columnIndex+1}):not(.e-groupcaption)`)));let indentWidthClone=headerTable.querySelector("tr").querySelectorAll(".e-grouptopleftcell");if(indentWidthClone.length>0)for(let i=0;i<indentWidthClone.length;i++)indentWidth+=indentWidthClone[i].offsetWidth;let detailsElement=contentTable.querySelector(".e-detailrowcollapse")||contentTable.querySelector(".e-detailrowexpand");(this.parent.detailTemplate||this.parent.childGrid)&&detailsElement&&(indentWidth+=detailsElement.offsetWidth);let headerText=[headerTextClone],contentText=[],footerText=[];if(footerTable)for(let i=0;i<footerTextClone.length;i++)footerText[i]=footerTextClone[i].cloneNode(!0);for(let i=0;i<contentTextClone.length;i++)contentText[i]=contentTextClone[i].cloneNode(!0);let result,wHeader=this.createTable(headerTable,headerText,"e-gridheader"),wContent=this.createTable(contentTable,contentText,"e-gridcontent"),wFooter=null;footerText.length&&(wFooter=this.createTable(footerTable,footerText,"e-gridfooter")),gObj.getColumns()[index].width=formatUnit(Math.max(wHeader,wContent,wFooter)),this.widthService.setColumnWidth(gObj.getColumns()[index]),!1===(result=gObj.getColumns().some(x=>null==x.width||x.width.length<=0))&&gObj.getColumns().forEach(element=>{element.visible&&(tWidth+=parseFloat(element.width))});let calcTableWidth=tWidth+indentWidth;tWidth>0&&!gObj.getFrozenColumns()&&((this.parent.detailTemplate||this.parent.childGrid)&&this.widthService.setColumnWidth(new ej2_grids_es2015_Column({width:"30px"})),headerTable.style.width=formatUnit(calcTableWidth),contentTable.style.width=formatUnit(calcTableWidth),isNullOrUndefined(footerTable)||(footerTable.style.width=formatUnit(calcTableWidth)));let tableWidth=headerTable.offsetWidth;gObj.getContent().scrollWidth>tableWidth?(headerTable.classList.add("e-tableborder"),contentTable.classList.add("e-tableborder")):(headerTable.classList.remove("e-tableborder"),contentTable.classList.remove("e-tableborder")),isNullOrUndefined(footerTable)||footerTable.classList.add("e-tableborder")}destroy(){let gridElement=this.parent.element;gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.widthService=null,this.unwireEvents(),this.removeEventListener())}getModuleName(){return"resize"}findColumn(fName){fName.forEach(element=>{let fieldName=element,columnIndex=this.parent.getColumnIndexByField(fieldName);!0===this.parent.getColumns()[columnIndex].visible&&this.resizeColumn(fieldName,columnIndex)})}createTable(table,text,tag){let myTableDiv=this.parent.createElement("div");myTableDiv.className=this.parent.element.className,myTableDiv.style.cssText="display: inline-block;visibility:hidden;position:absolute";let mySubDiv=this.parent.createElement("div");mySubDiv.className=tag;let myTable=this.parent.createElement("table");myTable.className=table.className,myTable.classList.add("e-resizetable"),myTable.style.cssText="table-layout: auto;width: auto";let myTr=this.parent.createElement("tr");text.forEach(element=>{let tr=myTr.cloneNode();tr.className=table.querySelector("tr").className,tr.appendChild(element),myTable.appendChild(tr)}),mySubDiv.appendChild(myTable),myTableDiv.appendChild(mySubDiv),document.body.appendChild(myTableDiv);let offsetWidthValue=myTable.getBoundingClientRect().width;return document.body.removeChild(myTableDiv),Math.ceil(offsetWidthValue)}addEventListener(){this.parent.isDestroyed||(this.parent.on(headerRefreshed,this.refreshHeight,this),this.parent.on(initialEnd,this.wireEvents,this),this.parent.on(contentReady,this.autoFit,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(headerRefreshed,this.refreshHeight),this.parent.off(initialEnd,this.wireEvents))}render(){this.unwireEvents(),this.wireEvents(),this.setHandlerHeight()}refreshHeight(){this.getResizeHandlers().forEach(ele=>{ele.parentElement.offsetHeight>0&&(ele.style.height=ele.parentElement.offsetHeight+"px")}),this.setHandlerHeight()}wireEvents(){EventHandler.add(this.parent.getHeaderContent(),Browser.touchStartEvent,this.resizeStart,this),EventHandler.add(this.parent.getHeaderContent(),dblclick,this.callAutoFit,this)}unwireEvents(){EventHandler.remove(this.parent.getHeaderContent(),Browser.touchStartEvent,this.resizeStart),EventHandler.remove(this.parent.getHeaderContent(),dblclick,this.callAutoFit)}getResizeHandlers(){return this.parent.getFrozenColumns()?[].slice.call(this.parent.getHeaderContent().querySelectorAll("."+resizeClassList.root)):[].slice.call(this.parent.getHeaderTable().querySelectorAll("."+resizeClassList.root))}setHandlerHeight(){[].slice.call(this.parent.getHeaderTable().querySelectorAll("."+resizeClassList.suppress)).forEach(ele=>{ele.style.height=ele.parentElement.offsetHeight+"px"})}callAutoFit(e){if(e.target.classList.contains("e-rhandler")){let col=this.getTargetColumn(e);if(col.columns)return;this.resizeColumn(col.field,this.parent.getNormalizedColumnIndex(col.uid),col.uid),closest(e.target,resizeClassList.header).classList.add("e-resized")}}resizeStart(e){if(e.target.classList.contains("e-rhandler")){if(!this.helper){if(0===this.getScrollBarWidth()){for(let col of this.refreshColumnWidth())this.widthService.setColumnWidth(col);this.widthService.setWidthToTable()}if(this.refreshStackedColumnWidth(),this.element=e.target,this.parent.getVisibleFrozenColumns()){let mtbody=this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody"),ftbody=this.parent.getContent().querySelector(".e-frozencontent").querySelector("tbody"),mtr=mtbody.querySelectorAll("tr"),ftr=ftbody.querySelectorAll("tr");for(let i=0;i<mtr.length;i++)this.parent.rowHeight?(mtr[i].style.height=this.parent.rowHeight+"px",ftr[i].style.height=this.parent.rowHeight+"px"):(mtr[i].style.removeProperty("height"),ftr[i].style.removeProperty("height"))}this.parentElementWidth=this.parent.element.getBoundingClientRect().width,this.appendHelper(),this.column=this.getTargetColumn(e),this.pageX=this.getPointX(e),this.minMove=this.parent.enableRtl?parseFloat(this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(isNullOrUndefined(this.column.width)?"":this.column.width.toString()),this.minMove+=this.pageX}if(Browser.isDevice&&!this.helper.classList.contains(resizeClassList.icon))this.helper.classList.add(resizeClassList.icon),EventHandler.add(document,Browser.touchStartEvent,this.removeHelper,this),EventHandler.add(this.helper,Browser.touchStartEvent,this.resizeStart,this);else{let args={e:e,column:this.column};if(this.parent.trigger(ej2_grids_es2015_resizeStart,args),args.cancel)return void this.cancelResizeAction();EventHandler.add(document,Browser.touchEndEvent,this.resizeEnd,this),EventHandler.add(this.parent.element,Browser.touchMoveEvent,this.resizing,this),this.updateCursor("add")}}}cancelResizeAction(removeEvents){removeEvents&&(EventHandler.remove(this.parent.element,Browser.touchMoveEvent,this.resizing),EventHandler.remove(document,Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove")),Browser.isDevice&&(EventHandler.remove(document,Browser.touchStartEvent,this.removeHelper),EventHandler.remove(this.helper,Browser.touchStartEvent,this.resizeStart)),detach(this.helper),this.refresh()}getWidth(width,minWidth,maxWidth){return minWidth&&width<minWidth?minWidth:maxWidth&&width>maxWidth?maxWidth:width}getColData(column,mousemove){return{width:parseFloat(isNullOrUndefined(this.widthService.getWidth(column))||"auto"===this.widthService.getWidth(column)?"0":this.widthService.getWidth(column).toString())+mousemove,minWidth:column.minWidth?parseFloat(column.minWidth.toString()):null,maxWidth:column.maxWidth?parseFloat(column.maxWidth.toString()):null}}resizing(e){if(isNullOrUndefined(this.column))return;let offsetWidth=0;isNullOrUndefined(this.column)&&(offsetWidth=parentsUntil(this.element,"th").offsetWidth),this.parent.allowTextWrap&&(this.element.style.height=this.element.parentElement.offsetHeight+"px",this.setHelperHeight());let pageX=this.getPointX(e),mousemove=this.parent.enableRtl?-(pageX-this.pageX):pageX-this.pageX,colData=this.getColData(this.column,mousemove);colData.width||(colData.width=closest(this.element,"th").offsetWidth);let width=this.getWidth(colData.width,colData.minWidth,colData.maxWidth);if(this.parent.log("resize_min_max",{column:this.column,width:width}),(!this.parent.enableRtl&&this.minMove>=pageX||this.parent.enableRtl&&this.minMove<=pageX)&&(width=this.column.minWidth?parseFloat(this.column.minWidth.toString()):0,this.pageX=pageX=this.minMove),width!==parseFloat(isNullOrUndefined(this.column.width)||"auto"===this.column.width?offsetWidth.toString():this.column.width.toString())){this.pageX=pageX,this.column.width=formatUnit(width);let args={e:e,column:this.column};if(this.parent.trigger(onResize,args),args.cancel)return void this.cancelResizeAction(!0);let columns=[this.column],finalColumns=[this.column];this.column.columns&&(columns=this.getSubColumns(this.column,[]),columns=this.calulateColumnsWidth(columns,!1,mousemove),finalColumns=this.calulateColumnsWidth(columns,!0,mousemove));for(const col of finalColumns)this.widthService.setColumnWidth(col,null,"resize");this.updateHelper()}this.isDblClk=!1}calulateColumnsWidth(columns,isUpdate,mousemove){let finalColumns=[];for(const col of columns){let totalWidth=0;columns.forEach(col=>{totalWidth+=parseFloat(col.width.toString())});let colData=this.getColData(col,parseFloat(col.width)*mousemove/totalWidth),colWidth=this.getWidth(colData.width,colData.minWidth,colData.maxWidth);colWidth!==parseFloat(col.width.toString())&&(isUpdate&&(col.width=formatUnit(colWidth<1?1:colWidth)),finalColumns.push(col))}return finalColumns}getSubColumns(column,subColumns){for(const col of column.columns)!1!==col.visible&&col.allowResizing&&(col.columns?this.getSubColumns(col,subColumns):subColumns.push(col));return subColumns}resizeEnd(e){if(!this.helper||this.parent.isDestroyed)return;EventHandler.remove(this.parent.element,Browser.touchMoveEvent,this.resizing),EventHandler.remove(document,Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove"),detach(this.helper);let args={e:e,column:this.column},content=this.parent.getContent().querySelector(".e-content"),cTable=content.querySelector(".e-movablecontent")?content.querySelector(".e-movablecontent"):content;cTable.scrollHeight>=cTable.clientHeight&&(this.parent.scrollModule.setPadding(),cTable.style.overflowY="scroll"),this.parent.trigger(resizeStop,args),closest(this.element,".e-headercell").classList.add("e-resized"),this.isFrozenColResized=!!parentsUntil(this.element,"e-frozenheader"),this.parent.getFrozenColumns()&&this.parent.notify(freezeRender,{case:"textwrap"}),this.parent.allowTextWrap&&this.parent.notify(textWrapRefresh,{case:"textwrap"}),this.refresh(),this.doubleTapEvent(e),this.isDblClk=!0}getPointX(e){return e.touches&&e.touches.length?e.touches[0].pageX:e.pageX}refreshColumnWidth(){let columns=this.parent.getColumns();for(let ele of[].slice.apply(this.parent.getHeaderTable().querySelectorAll("th.e-headercell")))for(let column of columns)if(ele.querySelector("[e-mappinguid]")&&ele.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===column.uid&&column.visible){column.width=ele.getBoundingClientRect().width;break}return columns}refreshStackedColumnWidth(){for(const stackedColumn of this.parent.getStackedColumns(this.parent.columns))stackedColumn.width=this.getStackedWidth(stackedColumn,0)}getStackedWidth(column,width){for(const col of column.columns)!1!==col.visible&&(col.columns?this.getStackedWidth(col,width):width+=col.width);return width}getTargetColumn(e){let cell=closest(e.target,resizeClassList.header),uid=(cell=cell.querySelector(".e-headercelldiv")||cell.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");return this.parent.getColumnByUid(uid)}updateCursor(action){let headerRows=[].slice.call(this.parent.getHeaderContent().querySelectorAll("th"));headerRows.push(this.parent.element);for(let row of headerRows)row.classList[action](resizeClassList.cursor)}refresh(){this.column=null,this.pageX=null,this.element=null,this.helper=null}appendHelper(){this.helper=this.parent.createElement("div",{className:resizeClassList.helper}),this.parent.element.appendChild(this.helper),this.setHelperHeight()}setHelperHeight(){let height=this.parent.getContent().offsetHeight-this.getScrollBarWidth(),rect=closest(this.element,resizeClassList.header),tr=[].slice.call(this.parent.getHeaderContent().querySelectorAll("tr")),frzCols=this.parent.getFrozenColumns();frzCols&&tr.splice(rect.parentElement.children.length!==frzCols?0:tr.length/2,tr.length/2);for(let i=tr.indexOf(rect.parentElement);i<tr.length;i++)height+=tr[i].offsetHeight;let pos=this.calcPos(rect);pos.left+=this.parent.enableRtl?-1:rect.offsetWidth-2,this.helper.style.cssText="height: "+height+"px; top: "+pos.top+"px; left:"+Math.floor(pos.left)+"px;"}getScrollBarWidth(height){let ele=this.parent.getFrozenColumns()?this.parent.getContent().querySelector(".e-movablecontent"):this.parent.getContent().firstChild;return ele.scrollHeight>ele.clientHeight&&height||ele.scrollWidth>ele.clientWidth?getScrollBarWidth():0}removeHelper(e){let cls=e.target.classList;cls.contains(resizeClassList.root)||cls.contains(resizeClassList.icon)||!this.helper||(EventHandler.remove(document,Browser.touchStartEvent,this.removeHelper),EventHandler.remove(this.helper,Browser.touchStartEvent,this.resizeStart),detach(this.helper),this.refresh())}updateHelper(){let rect=closest(this.element,resizeClassList.header),left=Math.floor(this.calcPos(rect).left+(this.parent.enableRtl?-1:rect.offsetWidth-2));if(left>this.parentElementWidth&&(left=this.parentElementWidth-2),this.parent.getFrozenColumns()){let fLeft=closest(rect,".e-table").offsetLeft;left<fLeft&&(left=fLeft)}this.helper.style.left=left+"px"}calcPos(elem){let parentOffset={top:0,left:0},offset=elem.getBoundingClientRect(),doc=elem.ownerDocument,offsetParent=elem.offsetParent||doc.documentElement;for(;offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&"static"===offsetParent.style.position;)offsetParent=offsetParent.parentNode;return offsetParent&&offsetParent!==elem&&1===offsetParent.nodeType&&(parentOffset=offsetParent.getBoundingClientRect()),{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}}doubleTapEvent(e){this.getUserAgent()&&this.isDblClk&&(this.tapped?(clearTimeout(this.tapped),this.callAutoFit(e),this.tapped=null):this.tapped=setTimeout(this.timeoutHandler(),300))}getUserAgent(){let userAgent=Browser.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(userAgent)}timeoutHandler(){this.tapped=null}}class ej2_grids_es2015_Reorder{constructor(parent){this.parent=parent,this.parent.isDestroyed||(this.parent.on(headerDrop,this.headerDrop,this),this.parent.on(uiUpdate,this.enableAfterRender,this),this.parent.on(reorderComplete,this.onActionComplete,this),this.parent.on(columnDrag,this.drag,this),this.parent.on(columnDragStart,this.dragStart,this),this.parent.on(columnDragStop,this.dragStop,this),this.parent.on(headerDrop,this.headerDrop,this),this.parent.on(headerRefreshed,this.createReorderElement,this))}chkDropPosition(srcElem,destElem){let col=this.parent.getColumnByUid(destElem.firstElementChild.getAttribute("e-mappinguid")),bool=!col||!col.lockColumn;return(srcElem.parentElement.isEqualNode(destElem.parentElement)||this.parent.getFrozenColumns()&&Array.prototype.indexOf.call(closest(srcElem,"thead").children,srcElem.parentElement)===Array.prototype.indexOf.call(closest(destElem,"thead").children,destElem.parentElement))&&this.targetParentContainerIndex(srcElem,destElem)>-1&&bool}chkDropAllCols(srcElem,destElem){let isFound,header,headers=this.getHeaderCells();for(;!isFound&&headers.length>0;)isFound=srcElem!==(header=headers.pop())&&this.targetParentContainerIndex(srcElem,destElem)>-1;return isFound}findColParent(col,cols,parent){parent=parent;for(let i=0,len=cols.length;i<len;i++){if(col===cols[i])return!0;if(cols[i].columns){let cnt=parent.length;if(parent.push(cols[i]),this.findColParent(col,cols[i].columns,parent))return!0;parent.splice(cnt,parent.length-cnt)}}return!1}getColumnsModel(cols){let columnModel=[],subCols=[];for(let i=0,len=cols.length;i<len;i++)columnModel.push(cols[i]),cols[i].columns&&(subCols=subCols.concat(cols[i].columns));return subCols.length&&(columnModel=columnModel.concat(this.getColumnsModel(subCols))),columnModel}headerDrop(e){let gObj=this.parent,uId=(this.element.querySelector(".e-headercelldiv")||this.element.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),column=gObj.getColumnByUid(uId);if(!closest(e.target,"th")||!isNullOrUndefined(column)&&(!column.allowReordering||column.lockColumn))return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:column});let destElem=closest(e.target,".e-headercell"),destElemUid=(destElem.querySelector(".e-headercelldiv")||destElem.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");if(!isNullOrUndefined(destElemUid)){let destColumn=gObj.getColumnByUid(destElemUid);if(isNullOrUndefined(destColumn)||!destColumn.allowReordering||destColumn.lockColumn)return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:column,destColumn:destColumn})}if(destElem&&this.chkDropPosition(this.element,destElem)&&this.chkDropAllCols(this.element,destElem))if(this.parent.enableColumnVirtualization){let columns=this.parent.columns,sourceUid=this.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),col=this.parent.getColumns(!0).filter(col=>col.uid===sourceUid),colMatchIndex=null,column=col[0],destUid=destElem.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");columns.some((col,index)=>col.uid===destUid&&(colMatchIndex=index,col.uid===destUid)),isNullOrUndefined(colMatchIndex)||this.moveColumns(colMatchIndex,column)}else{let newIndex=this.targetParentContainerIndex(this.element,destElem),uid=this.element.firstElementChild.getAttribute("e-mappinguid");if(this.destElement=destElem,uid)this.moveColumns(newIndex,this.parent.getColumnByUid(uid));else{let headers=this.getHeaderCells(),oldIdx=getElementIndex(this.element,headers),columns=this.getColumnsModel(this.parent.columns);this.moveColumns(newIndex,columns[oldIdx])}}}isActionPrevent(gObj){return isActionPrevent(gObj)}moveColumns(destIndex,column,reorderByColumn){let gObj=this.parent;if(this.isActionPrevent(gObj))return void gObj.notify(preventBatch,{instance:this,handler:this.moveColumns,arg1:destIndex,arg2:column});let parent=this.getColParent(column,this.parent.columns),cols=parent?parent.columns:this.parent.columns,srcIdx=inArray(column,cols);if((this.parent.getFrozenColumns()&&parent||this.parent.lockcolPositionCount)&&!reorderByColumn){for(let i=0;i<cols.length;i++)if(cols[i].field===column.field){srcIdx=i;break}let col=this.parent.getColumnByUid(this.destElement.firstElementChild.getAttribute("e-mappinguid"));if(col){for(let i=0;i<cols.length;i++)if(cols[i].field===col.field){destIndex=i;break}}else for(let i=0;i<cols.length;i++)cols[i].headerText===this.destElement.innerText.trim()&&(destIndex=i)}gObj.allowReordering&&srcIdx!==destIndex&&-1!==srcIdx&&-1!==destIndex&&(cols.splice(destIndex,0,cols.splice(srcIdx,1)[0]),gObj.getColumns(!0),gObj.notify(columnPositionChanged,{fromIndex:destIndex,toIndex:srcIdx}),gObj.notify(modelChanged,{type:actionBegin,requestType:"reorder"}))}targetParentContainerIndex(srcElem,destElem){let headers=this.getHeaderCells(),cols=this.parent.columns,flatColumns=this.getColumnsModel(cols),parent=this.getColParent(flatColumns[getElementIndex(srcElem,headers)],cols);return cols=parent?parent.columns:cols,inArray(flatColumns[getElementIndex(destElem,headers)],cols)}getHeaderCells(){let frozenColumns=this.parent.getFrozenColumns();if(frozenColumns||this.parent.lockcolPositionCount){let fTh,mTh,fHeaders=[],fRows=[].slice.call(this.parent.getHeaderTable().querySelectorAll(".e-columnheader"));if(frozenColumns){let mRows=[].slice.call(this.parent.getHeaderContent().querySelector(".e-movableheader").querySelectorAll(".e-columnheader"));for(let i=0;i<fRows.length;i++){let isAvail;fTh=[].slice.call(fRows[i].getElementsByClassName("e-headercell")),mTh=[].slice.call(mRows[i].getElementsByClassName("e-headercell"));for(let k=0;k<fTh.length;k++){for(let j=0;j<mTh.length;j++)if(mTh[j].innerText===fTh[k].innerText){isAvail=!0;break}isAvail||(fHeaders=fHeaders.concat([fTh[k]]))}for(let j=0;j<mTh.length;j++)fHeaders.push(mTh[j])}}else for(let i=0;i<fRows.length;i++){mTh=[].slice.call(fRows[i].getElementsByClassName("e-headercell"));for(let k=0;k<mTh.length;k++){let isAvail;for(let j=k+1;j<mTh.length;j++)if(mTh[j].innerText===mTh[k].innerText){isAvail=!0;break}isAvail||(fHeaders=fHeaders.concat([mTh[k]]))}}return fHeaders}return[].slice.call(this.parent.element.getElementsByClassName("e-headercell"))}getColParent(column,columns){let parents$$1=[];return this.findColParent(column,columns,parents$$1),parents$$1[parents$$1.length-1]}reorderSingleColumn(fromFName,toFName){let fColumn=this.parent.getColumnByField(fromFName),toColumn=this.parent.getColumnByField(toFName);if(!isNullOrUndefined(fColumn)&&(!fColumn.allowReordering||fColumn.lockColumn)||!isNullOrUndefined(toColumn)&&(!toColumn.allowReordering||fColumn.lockColumn))return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:fColumn,destColumn:toColumn});let column=this.parent.getColumnByField(toFName),parent=this.getColParent(column,this.parent.columns),destIndex=inArray(column,parent?parent.columns:this.parent.columns);destIndex>-1&&this.moveColumns(destIndex,this.parent.getColumnByField(fromFName),!0)}reorderMultipleColumns(fromFNames,toFName){let toIndex=this.parent.getColumnIndexByField(toFName),toColumn=this.parent.getColumnByField(toFName);if(!(toIndex<0)&&(isNullOrUndefined(toColumn)||toColumn.allowReordering&&!toColumn.lockColumn)){for(let i=0;i<fromFNames.length;i++){let column=this.parent.getColumnByField(fromFNames[i]);if(!isNullOrUndefined(column)&&(!column.allowReordering||column.lockColumn))return}for(let i=0;i<fromFNames.length;i++){let column=this.parent.getColumnByIndex(toIndex),parent=this.getColParent(column,this.parent.columns),destIndex=inArray(column,parent?parent.columns:this.parent.columns);destIndex>-1&&this.moveColumns(destIndex,this.parent.getColumnByField(fromFNames[i]),!0),this.parent.getColumnIndexByField(fromFNames[i+1])>=destIndex&&toIndex++}}}moveTargetColumn(column,toIndex){toIndex>-1&&this.moveColumns(toIndex,column,!0)}reorderSingleColumnByTarget(fieldName,toIndex){let column=this.parent.getColumnByField(fieldName);this.moveTargetColumn(column,toIndex)}reorderMultipleColumnByTarget(fieldName,toIndex){for(let i=0;i<fieldName.length;i++)this.reorderSingleColumnByTarget(fieldName[i],toIndex)}reorderColumns(fromFName,toFName){"string"==typeof fromFName?this.reorderSingleColumn(fromFName,toFName):this.reorderMultipleColumns(fromFName,toFName)}reorderColumnByIndex(fromIndex,toIndex){let column=this.parent.getColumnByIndex(fromIndex);this.moveTargetColumn(column,toIndex)}reorderColumnByTargetIndex(fieldName,toIndex){"string"==typeof fieldName?this.reorderSingleColumnByTarget(fieldName,toIndex):this.reorderMultipleColumnByTarget(fieldName,toIndex)}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&this.createReorderElement()}createReorderElement(){let header=this.parent.element.querySelector(".e-headercontent");this.upArrow=header.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderuparrow e-reorderuparrow",attrs:{style:"display:none"}})),this.downArrow=header.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderdownarrow e-reorderdownarrow",attrs:{style:"display:none"}}))}onActionComplete(e){this.parent.trigger(actionComplete,extend(e,{type:actionComplete}))}destroy(){let gridElement=this.parent.element;!this.parent.isDestroyed&&gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(ej2_base_es2015_remove(this.upArrow),ej2_base_es2015_remove(this.downArrow),this.parent.off(headerDrop,this.headerDrop),this.parent.off(uiUpdate,this.enableAfterRender),this.parent.off(reorderComplete,this.onActionComplete),this.parent.off(columnDrag,this.drag),this.parent.off(columnDragStart,this.dragStart),this.parent.off(columnDragStop,this.dragStop),this.parent.off(headerRefreshed,this.createReorderElement))}drag(e){let gObj=this.parent,target=e.target;if(!e.column.allowReordering||e.column.lockColumn)return;let closest$$1=closest(target,".e-headercell:not(.e-stackedHeaderCell)"),cloneElement=gObj.element.querySelector(".e-cloneproperties"),isLeft=this.x>getPosition(e.event).x+gObj.getContent().firstElementChild.scrollLeft;removeClass(gObj.getHeaderTable().querySelectorAll(".e-reorderindicate"),["e-reorderindicate"]),this.setDisplay("none"),this.stopTimer(),ej2_base_es2015_classList(cloneElement,["e-defaultcur"],["e-notallowedcur"]),this.updateScrollPostion(e.event),closest$$1&&!closest$$1.isEqualNode(this.element)&&(this.chkDropPosition(this.element,target=closest$$1)&&this.chkDropAllCols(this.element,target)?(this.updateArrowPosition(target,isLeft),ej2_base_es2015_classList(target,["e-allowDrop","e-reorderindicate"],[])):gObj.allowGrouping&&parentsUntil(e.target,"e-groupdroparea")||ej2_base_es2015_classList(cloneElement,["e-notallowedcur"],["e-defaultcur"])),gObj.trigger(columnDrag,{target:target,draggableType:"headercell",column:e.column})}updateScrollPostion(e){let frzCols=this.parent.getFrozenColumns(),x=getPosition(e).x,cliRect=this.parent.element.getBoundingClientRect(),cliRectBaseLeft=frzCols?this.parent.element.querySelector(".e-movableheader").getBoundingClientRect().left:cliRect.left,cliRectBaseRight=cliRect.right,scrollElem=frzCols?this.parent.getContent().querySelector(".e-movablecontent"):this.parent.getContent().firstElementChild;x>cliRectBaseLeft&&x<cliRectBaseLeft+35?this.timer=window.setInterval(()=>{this.setScrollLeft(scrollElem,!0)},50):x<cliRectBaseRight&&x>cliRectBaseRight-35&&(this.timer=window.setInterval(()=>{this.setScrollLeft(scrollElem,!1)},50))}setScrollLeft(scrollElem,isLeft){let scrollLeft=scrollElem.scrollLeft;scrollElem.scrollLeft=scrollElem.scrollLeft+(isLeft?-5:5),scrollLeft!==scrollElem.scrollLeft&&this.setDisplay("none")}stopTimer(){window.clearInterval(this.timer)}updateArrowPosition(target,isLeft){let cliRect=target.getBoundingClientRect(),cliRectBase=this.parent.element.getBoundingClientRect();isLeft&&cliRect.left<cliRectBase.left||!isLeft&&cliRect.right>cliRectBase.right||(this.upArrow.style.top=cliRect.top+cliRect.height-cliRectBase.top+"px",this.downArrow.style.top=cliRect.top-cliRectBase.top-4+"px",this.upArrow.style.left=this.downArrow.style.left=(isLeft?cliRect.left:cliRect.right)-cliRectBase.left-4+"px",this.setDisplay(""))}dragStart(e){let gObj=this.parent,target=e.target;this.element=target.classList.contains("e-headercell")?target:parentsUntil(target,"e-headercell"),e.column.allowReordering&&!e.column.lockColumn&&(this.x=getPosition(e.event).x+gObj.getContent().firstElementChild.scrollLeft,gObj.trigger(columnDragStart,{target:target,draggableType:"headercell",column:e.column}))}dragStop(e){let gObj=this.parent;this.setDisplay("none"),this.stopTimer(),e.cancel||gObj.trigger(columnDrop,{target:e.target,draggableType:"headercell",column:e.column}),removeClass(gObj.getHeaderTable().querySelectorAll(".e-reorderindicate"),["e-reorderindicate"])}setDisplay(display){this.upArrow.style.display=display,this.downArrow.style.display=display}getModuleName(){return"reorder"}}class ej2_grids_es2015_RowDD{constructor(parent){this.selectedRows=[],this.isOverflowBorder=!0,this.selectedRowColls=[],this.isRefresh=!0,this.helper=e=>{let gObj=this.parent,target=e.sender.target,visualElement=this.parent.createElement("div",{className:"e-cloneproperties e-draganddrop e-grid e-dragclone",styles:'height:"auto", z-index:2, width:'+gObj.element.offsetWidth}),table=this.parent.createElement("table",{styles:"width:"+gObj.element.offsetWidth}),tbody=this.parent.createElement("tbody");if(document.getElementsByClassName("e-griddragarea").length||gObj.rowDropSettings.targetID&&!e.sender.target.classList.contains("e-selectionbackground")&&"Single"!==gObj.selectionSettings.type||!gObj.rowDropSettings.targetID&&!parentsUntil(e.sender.target,"e-rowdragdrop"))return!1;gObj.rowDropSettings.targetID&&"Row"===gObj.selectionSettings.mode&&"Single"===gObj.selectionSettings.type&&gObj.selectRow(parseInt(e.sender.target.parentElement.getAttribute("aria-rowindex"),10)),this.startedRow=closest(target,"tr").cloneNode(!0),this.processArgs(target);let args={selectedRow:this.rows,dragelement:target,cloneElement:visualElement,cancel:!1,data:this.rowData},selectedRows=gObj.getSelectedRows();if(gObj.trigger(rowDragStartHelper,args),args.cancel)return args.cloneElement;removeElement(this.startedRow,".e-indentcell"),removeElement(this.startedRow,".e-detailrowcollapse"),removeElement(this.startedRow,".e-detailrowexpand"),this.removeCell(this.startedRow,"e-gridchkbox");let exp=new RegExp("e-active","g");if(this.startedRow.innerHTML=this.startedRow.innerHTML.replace(exp,""),tbody.appendChild(this.startedRow),gObj.getSelectedRows().length>1){let dropCountEle=this.parent.createElement("span",{className:"e-dropitemscount",innerHTML:""+selectedRows.length});visualElement.appendChild(dropCountEle)}let ele=closest(target,"tr").querySelector(".e-icon-rowdragicon");return ele&&ele.classList.add("e-dragstartrow"),table.appendChild(tbody),visualElement.appendChild(table),gObj.element.appendChild(visualElement),visualElement},this.dragStart=e=>{let gObj=this.parent;if(document.getElementsByClassName("e-griddragarea").length)return;let target=e.target;const spanCssEle=this.parent.element.querySelector(".e-dropitemscount");this.parent.getSelectedRecords().length>1&&spanCssEle&&(spanCssEle.style.left=this.parent.element.querySelector(".e-cloneproperties table").offsetWidth-5+"px"),this.processArgs(target),gObj.trigger(rowDragStart,{rows:this.rows,target:e.target,draggableType:"rows",fromIndex:parseInt(this.rows[0].getAttribute("aria-rowindex"),10),data:this.rowData}),this.dragStartData=this.rowData;let dropElem=document.getElementById(gObj.rowDropSettings.targetID);gObj.rowDropSettings.targetID&&dropElem&&dropElem.ej2_instances&&"grid"===dropElem.ej2_instances[0].getModuleName()&&dropElem.ej2_instances[0].getContent().classList.add("e-allowRowDrop")},this.drag=e=>{let gObj=this.parent,cloneElement=this.parent.element.querySelector(".e-cloneproperties"),target=this.getElementFromPosition(cloneElement,e.event);ej2_base_es2015_classList(cloneElement,["e-defaultcur"],["e-notallowedcur","e-movecur"]),this.isOverflowBorder=!0,this.hoverState=gObj.enableHover;let trElement=closest(e.target,"tr");if(gObj.enableHover=!1,!e.target)return;this.processArgs(target);let args={rows:this.rows,target:target,draggableType:"rows",data:this.rowData,originalEvent:e,cancel:!1};if(gObj.trigger(rowDrag,args),this.stopTimer(),!args.cancel){if(gObj.element.classList.add("e-rowdrag"),this.dragTarget=trElement&&parentsUntil(target,"e-grid").id===cloneElement.parentElement.id?trElement.rowIndex:parseInt(this.startedRow.getAttribute("aria-rowindex"),10),gObj.rowDropSettings.targetID)parentsUntil(target,"e-gridcontent")&&parentsUntil(cloneElement.parentElement,"e-grid").id!==parentsUntil(target,"e-grid").id?ej2_base_es2015_classList(cloneElement,["e-defaultcur"],["e-notallowedcur"]):ej2_base_es2015_classList(cloneElement,["e-notallowedcur"],["e-defaultcur"]);else{let elem=parentsUntil(target,"e-grid");elem&&elem.id===cloneElement.parentElement.id?ej2_base_es2015_classList(cloneElement,["e-movecur"],["e-defaultcur"]):ej2_base_es2015_classList(cloneElement,["e-notallowedcur"],["e-movecur"])}if(!gObj.rowDropSettings.targetID&&(!gObj.groupSettings.columns.length||e.target.classList.contains("e-selectionbackground")))if(parentsUntil(target,"e-grid")&&this.updateScrollPostion(e.event,target),this.isOverflowBorder&&parseInt(this.startedRow.getAttribute("aria-rowindex"),10)!==this.dragTarget)this.moveDragRows(e,this.startedRow,trElement);else{if(trElement&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")===trElement.getAttribute("data-uid")){let bottomborder=this.parent.createElement("div",{className:"e-lastrow-dragborder"}),gridcontentEle=this.parent.getContent();bottomborder.style.width=this.parent.element.offsetWidth-this.getScrollWidth()+"px",gridcontentEle.querySelectorAll(".e-lastrow-dragborder").length||(gridcontentEle.classList.add("e-grid-relative"),gridcontentEle.appendChild(bottomborder),bottomborder.style.bottom=this.getScrollWidth()+"px")}this.removeBorder(trElement)}}},this.dragStop=e=>{let gObj=this.parent;if(this.parent.isDestroyed)return;let targetEle=this.getElementFromPosition(e.helper,e.event),target=targetEle||e.target;this.parent.element.querySelector(".e-cloneproperties"),gObj.element.classList.remove("e-rowdrag");let dropElement=document.getElementById(gObj.rowDropSettings.targetID);if(gObj.rowDropSettings.targetID&&dropElement&&dropElement.ej2_instances&&"grid"===dropElement.ej2_instances[0].getModuleName()&&dropElement.ej2_instances[0].getContent().classList.remove("e-allowRowDrop"),gObj.isRowDragable()){this.stopTimer(),gObj.enableHover=this.hoverState,this.parent.getContent().classList.remove("e-grid-relative"),this.removeBorder(targetEle);let stRow=gObj.element.querySelector(".e-dragstartrow");stRow&&stRow.classList.remove("e-dragstartrow")}this.processArgs(target);let args={target:target,draggableType:"rows",cancel:!1,fromIndex:parseInt(this.rows[0].getAttribute("aria-rowindex"),10),dropIndex:this.dragTarget,rows:this.rows,data:this.dragStartData};if(gObj.trigger(rowDrop,args),!parentsUntil(target,"e-gridcontent")||args.cancel)return this.dragTarget=null,void ej2_base_es2015_remove(e.helper);this.isRefresh=!1;let selectedIndexes=this.parent.getSelectedRowIndexes();gObj.isRowDragable()&&(!this.parent.rowDropSettings.targetID&&this.startedRow.querySelector("td.e-selectionbackground")&&selectedIndexes.length>1&&selectedIndexes.length!==this.parent.getCurrentViewRecords().length?this.reorderRows(selectedIndexes,args.dropIndex):this.reorderRows([parseInt(this.startedRow.getAttribute("aria-rowindex"),10)],this.dragTarget),this.dragTarget=null,gObj.rowDropSettings.targetID||(ej2_base_es2015_remove(e.helper),gObj.refresh())),this.isRefresh=!0},this.removeCell=(targetRow,className)=>[].slice.call(targetRow.querySelectorAll("td")).filter(cell=>{cell.classList.contains(className)&&targetRow.deleteCell(cell.cellIndex)}),this.parent=parent,this.parent.isDestroyed||(this.parent.on(initialEnd,this.initializeDrag,this),this.parent.on(columnDrop,this.columnDrop,this),this.onDataBoundFn=this.onDataBound.bind(this),this.parent.addEventListener(dataBound,this.onDataBoundFn),this.parent.on(uiUpdate,this.enableAfterRender,this))}reorderRows(fromIndexes,toIndex){let selectedIndexes=this.parent.getSelectedRowIndexes(),selectedRecords=[],draggedRecords=[],currentViewData=this.parent.renderModule.data.dataManager.dataSource.json,dropIdx=toIndex,actualIdx=fromIndexes[0];for(let i=0,len=fromIndexes.length;i<len;i++)draggedRecords[i]=currentViewData[fromIndexes[i]];for(let i=0,len=selectedIndexes.length;i<len;i++)selectedRecords[i]=currentViewData[selectedIndexes[i]];for(let i=0,len=draggedRecords.length;i<len;i++){if(0!==i){for(let j=0,len1=currentViewData.length;j<len1;j++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j])===JSON.stringify(draggedRecords[i])){actualIdx=j;break}for(let j=0,len1=currentViewData.length;j<len1;j++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j])===JSON.stringify(draggedRecords[i-1])){actualIdx>j&&(dropIdx=j+1);break}}this.reorderRow(actualIdx,dropIdx)}this.isRefresh&&this.parent.notify(modelChanged,{type:actionBegin,requestType:"rowdraganddrop"});for(let i=0,len=selectedRecords.length;i<len;i++)for(let j=0,len1=currentViewData.length;j<len1;j++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j])===JSON.stringify(selectedRecords[i])){selectedIndexes[i]=j;break}this.selectedRowColls=selectedIndexes}stopTimer(){window.clearInterval(this.timer)}initializeDrag(){this.draggable=new ej2_base_es2015_Draggable(this.parent.getContent(),{dragTarget:".e-rowcelldrag, .e-rowdragdrop, .e-rowcell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop})}updateScrollPostion(e,target){let frzCols=this.parent.getFrozenColumns(),y=getPosition(e).y,cliRect=this.parent.getContent().getBoundingClientRect(),rowHeight=this.parent.getRowHeight()-15,scrollElem=frzCols?this.parent.getContent().querySelector(".e-movablecontent"):this.parent.getContent().firstElementChild;if(cliRect.top+rowHeight>=y){let scrollPixel=-this.parent.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval(()=>{this.setScrollDown(scrollElem,scrollPixel,!0)},200)}else if(cliRect.top+this.parent.getContent().clientHeight-rowHeight-33<=y){let scrollPixel=this.parent.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval(()=>{this.setScrollDown(scrollElem,scrollPixel,!0)},200)}}setScrollDown(scrollElem,scrollPixel,isLeft){scrollElem.scrollTop=scrollElem.scrollTop+scrollPixel}moveDragRows(e,startedRow,targetRow){let cloneElement=this.parent.element.querySelector(".e-cloneproperties"),element=closest(e.target,"tr");parentsUntil(element,"e-gridcontent")&&parentsUntil(cloneElement.parentElement,"e-grid").id===parentsUntil(element,"e-grid").id&&this.setBorder(element||this.startedRow,e.event,startedRow,targetRow)}setBorder(element,event,startedRow,targetRow){let node=this.parent.element,cloneElement=this.parent.element.querySelector(".e-cloneproperties");if(this.removeFirstRowBorder(element),this.removeLastRowBorder(element),parentsUntil(element,"e-gridcontent")&&parentsUntil(cloneElement.parentElement,"e-grid").id===parentsUntil(element,"e-grid").id){removeClass(node.querySelectorAll(".e-rowcell,.e-rowdragdrop"),["e-dragborder"]);let rowElement=[];if(targetRow&&0===targetRow.rowIndex){let div=this.parent.createElement("div",{className:"e-firstrow-dragborder"}),gridheaderEle=this.parent.getHeaderContent();gridheaderEle.classList.add("e-grid-relative"),div.style.width=node.offsetWidth-this.getScrollWidth()+"px",gridheaderEle.querySelectorAll(".e-firstrow-dragborder").length||gridheaderEle.appendChild(div)}else targetRow&&parseInt(startedRow.getAttribute("aria-rowindex"),10)>targetRow.rowIndex?(element=this.parent.getRowByIndex(targetRow.rowIndex-1),rowElement=[].slice.call(element.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):rowElement=[].slice.call(element.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"));rowElement.length>0&&addRemoveActiveClasses(rowElement,!0,"e-dragborder")}}getScrollWidth(){let scrollElem=this.parent.getContent().firstElementChild;return scrollElem.scrollWidth>scrollElem.offsetWidth?ej2_grids_es2015_Scroll.getScrollBarWidth():0}removeFirstRowBorder(element){this.parent.element.getElementsByClassName("e-firstrow-dragborder").length>0&&element&&0!==element.rowIndex&&this.parent.element.getElementsByClassName("e-firstrow-dragborder")[0].remove()}removeLastRowBorder(element){let islastRowIndex=element&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==element.getAttribute("data-uid");this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&element&&islastRowIndex&&this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0].remove()}removeBorder(element){this.removeFirstRowBorder(element),this.removeLastRowBorder(element),(element=this.parent.getRows().filter(row=>row.querySelector("td.e-dragborder"))[0])&&addRemoveActiveClasses([].slice.call(element.querySelectorAll(".e-dragborder")),!1,"e-dragborder")}getElementFromPosition(element,event){let target,position=getPosition(event);return element.style.display="none",target=document.elementFromPoint(position.x,position.y),element.style.display="",target}onDataBound(e){this.selectedRowColls.length>0&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])}getTargetIdx(targetRow){return targetRow?parseInt(targetRow.getAttribute("aria-rowindex"),10):0}singleRowDrop(e){let currentIndex,srcControl,targetRow=closest(e.target,"tr");this.reorderRow(this.startedRowIndex,currentIndex=targetRow?targetRow.rowIndex:(srcControl=e.droppedElement.parentElement.ej2_instances[0]).currentViewData.length-1)}columnDrop(e){let gObj=this.parent;if("grouping"!==e.droppedElement.getAttribute("action")){let srcControl,currentIndex,targetRow=closest(e.target,"tr");if("true"!==e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id===gObj.element.id||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id!==gObj.element.id)return;if(e.droppedElement.parentElement.id!==gObj.element.id)srcControl=e.droppedElement.parentElement.ej2_instances[0];else if(this.isSingleRowDragDrop||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow"))return void this.singleRowDrop(e);if(srcControl.element.id!==gObj.element.id&&srcControl.rowDropSettings.targetID!==gObj.element.id)return;let records=srcControl.getSelectedRecords(),targetIndex=currentIndex=this.getTargetIdx(targetRow);if(isNaN(targetIndex)&&(targetIndex=currentIndex=0),gObj.allowPaging&&(targetIndex=targetIndex+gObj.pageSettings.currentPage*gObj.pageSettings.pageSize-gObj.pageSettings.pageSize),isBlazor()){let changes={addedRecords:records,deletedRecords:[],changedRecords:[]},dragDropDestinationIndex="dragDropDestinationIndex",query=new ej2_data_es2015_Query;query[dragDropDestinationIndex]=targetIndex,gObj.getDataModule().saveChanges(changes,gObj.getPrimaryKeyFieldNames()[0],{},query).then(()=>{gObj.notify(modelChanged,{type:actionBegin,requestType:"rowdraganddrop"})}).catch(e=>{gObj.trigger(ej2_grids_es2015_actionFailure,{error:e})}),changes.deletedRecords=records,changes.addedRecords=[],srcControl.getDataModule().saveChanges(changes,srcControl.getPrimaryKeyFieldNames()[0],{},query).then(()=>{srcControl.notify(modelChanged,{type:actionBegin,requestType:"rowdraganddrop"})}).catch(e=>{srcControl.trigger(ej2_grids_es2015_actionFailure,{error:e})})}else{gObj.notify(rowsAdded,{toIndex:targetIndex,records:records}),gObj.notify(modelChanged,{type:actionBegin,requestType:"rowdraganddrop"});let selectedRows=srcControl.getSelectedRowIndexes(),skip=srcControl.allowPaging?srcControl.pageSettings.currentPage*srcControl.pageSettings.pageSize-srcControl.pageSettings.pageSize:0;this.selectedRows=[];for(let i=0,len=records.length;i<len;i++)this.selectedRows.push(skip+selectedRows[i]);srcControl.notify(rowsRemoved,{indexes:this.selectedRows,records:records}),srcControl.notify(modelChanged,{type:actionBegin,requestType:"rowdraganddrop"})}}}reorderRow(fromIndexes,toIndex){let gObj=this.parent;if(!gObj.sortSettings.columns.length&&!gObj.groupSettings.columns.length&&!gObj.filterSettings.columns.length){let skip=gObj.allowPaging?gObj.pageSettings.currentPage*gObj.pageSettings.pageSize-gObj.pageSettings.pageSize:0;toIndex+=skip,this.selectedRows=gObj.getSelectedRowIndexes(),gObj.notify(rowPositionChanged,{fromIndex:fromIndexes+skip,toIndex:toIndex})}}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&this.initializeDrag()}destroy(){let gridElement=this.parent.element;!this.parent.isDestroyed&&gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.draggable.destroy(),this.parent.off(initialEnd,this.initializeDrag),this.parent.off(columnDrop,this.columnDrop),this.parent.removeEventListener(dataBound,this.onDataBoundFn),this.parent.off(uiUpdate,this.enableAfterRender))}getModuleName(){return"rowDragAndDrop"}processArgs(target){let gObj=this.parent;gObj.getSelectedRecords().length>0&&!1===this.startedRow.cells[0].classList.contains("e-selectionbackground")||0===gObj.getSelectedRecords().length?(this.rows=[this.startedRow],this.rowData=this.parent.getRowInfo(this.startedRow.querySelector(".e-rowcell")).rowData):(this.rows=gObj.getSelectedRows(),this.rowData=gObj.getSelectedRecords())}}class ej2_grids_es2015_Group{constructor(parent,groupSettings,sortedColumns,serviceLocator){this.isAppliedGroup=!1,this.isAppliedUnGroup=!1,this.visualElement=ej2_base_es2015_createElement("div",{className:"e-cloneproperties e-dragclone e-gdclone",styles:"line-height:23px",attrs:{action:"grouping"}}),this.helper=e=>{let gObj=this.parent,target=e.sender.target,element=target.classList.contains("e-groupheadercell")?target:parentsUntil(target,"e-groupheadercell");return!!element&&(this.column=gObj.getColumnByField(element.firstElementChild.getAttribute("ej-mappingname")),this.visualElement.textContent=element.textContent,this.visualElement.style.width=element.offsetWidth+2+"px",this.visualElement.style.height=element.offsetHeight+2+"px",this.visualElement.setAttribute("e-mappinguid",this.column.uid),gObj.element.appendChild(this.visualElement),this.visualElement)},this.dragStart=()=>{this.parent.element.classList.add("e-ungroupdrag")},this.drag=e=>{let target=e.target,cloneElement=this.parent.element.querySelector(".e-cloneproperties");this.parent.trigger(columnDrag,{target:target,draggableType:"headercell",column:this.column}),ej2_base_es2015_classList(cloneElement,["e-defaultcur"],["e-notallowedcur"]),parentsUntil(target,"e-gridcontent")||parentsUntil(target,"e-headercell")||ej2_base_es2015_classList(cloneElement,["e-notallowedcur"],["e-defaultcur"])},this.dragStop=e=>{this.parent.element.classList.remove("e-ungroupdrag"),parentsUntil(e.target,"e-gridcontent")||parentsUntil(e.target,"e-gridheader")||ej2_base_es2015_remove(e.helper)},this.drop=e=>{let gObj=this.parent,column=gObj.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));this.element.classList.remove("e-hover"),ej2_base_es2015_remove(e.droppedElement),this.aria.setDropTarget(this.parent.element.querySelector(".e-groupdroparea"),!1),this.aria.setGrabbed(this.parent.getHeaderTable().querySelector("[aria-grabbed=true]"),!1),isNullOrUndefined(column)||!1===column.allowGrouping||parentsUntil(gObj.getColumnHeaderByUid(column.uid),"e-grid").getAttribute("id")!==gObj.element.getAttribute("id")?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:column.headerText}):this.groupColumn(column.field)},this.contentRefresh=!0,this.aria=new AriaService,this.parent=parent,this.groupSettings=groupSettings,this.serviceLocator=serviceLocator,this.sortedColumns=sortedColumns,this.focus=serviceLocator.getService("focus"),this.addEventListener(),this.groupGenerator=new ej2_grids_es2015_GroupModelGenerator(this.parent)}columnDrag(e){let cloneElement=this.parent.element.querySelector(".e-cloneproperties");ej2_base_es2015_classList(cloneElement,["e-defaultcur"],["e-notallowedcur"]),parentsUntil(e.target,"e-groupdroparea")||this.parent.allowReordering&&parentsUntil(e.target,"e-headercell")||ej2_base_es2015_classList(cloneElement,["e-notallowedcur"],["e-defaultcur"]),e.target.classList.contains("e-groupdroparea")?this.element.classList.add("e-hover"):this.element.classList.remove("e-hover")}columnDragStart(e){if(e.target.classList.contains("e-stackedheadercell"))return;let dropArea=this.parent.element.querySelector(".e-groupdroparea");this.aria.setDropTarget(dropArea,e.column.allowGrouping);let element=e.target.classList.contains("e-headercell")?e.target:parentsUntil(e.target,"e-headercell");this.aria.setGrabbed(element,!0,!e.column.allowGrouping)}columnDrop(e){let gObj=this.parent;if("grouping"===e.droppedElement.getAttribute("action")){let column=gObj.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));if(isNullOrUndefined(column)||!1===column.allowGrouping||parentsUntil(gObj.getColumnHeaderByUid(column.uid),"e-grid").getAttribute("id")!==gObj.element.getAttribute("id"))return;this.ungroupColumn(column.field)}}addEventListener(){this.parent.isDestroyed||(this.parent.on(uiUpdate,this.enableAfterRender,this),this.parent.on(groupComplete,this.onActionComplete,this),this.parent.on(ungroupComplete,this.onActionComplete,this),this.parent.on(inBoundModelChanged,this.onPropertyChanged,this),this.parent.on(click,this.clickHandler,this),this.parent.on(columnDrag,this.columnDrag,this),this.parent.on(columnDragStart,this.columnDragStart,this),this.parent.on(columnDrop,this.columnDrop,this),this.parent.on(headerRefreshed,this.refreshSortIcons,this),this.parent.on(sortComplete,this.refreshSortIcons,this),this.parent.on(keyPressed,this.keyPressHandler,this),this.parent.on(contentReady,this.initialEnd,this),this.parent.on(onEmpty,this.initialEnd,this),this.parent.on(initialEnd,this.render,this),this.parent.on(groupAggregates,this.onGroupAggregates,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(initialEnd,this.render),this.parent.off(uiUpdate,this.enableAfterRender),this.parent.off(groupComplete,this.onActionComplete),this.parent.off(ungroupComplete,this.onActionComplete),this.parent.off(inBoundModelChanged,this.onPropertyChanged),this.parent.off(click,this.clickHandler),this.parent.off(columnDrag,this.columnDrag),this.parent.off(columnDragStart,this.columnDragStart),this.parent.off(columnDrop,this.columnDrop),this.parent.off(headerRefreshed,this.refreshSortIcons),this.parent.off(sortComplete,this.refreshSortIcons),this.parent.off(keyPressed,this.keyPressHandler),this.parent.off(groupAggregates,this.onGroupAggregates))}initialEnd(){let gObj=this.parent;if(this.parent.off(contentReady,this.initialEnd),this.parent.off(onEmpty,this.initialEnd),this.parent.getColumns().length&&this.groupSettings.columns.length){this.contentRefresh=!1;for(let col of gObj.groupSettings.columns)this.groupColumn(col);this.contentRefresh=!0}}keyPressHandler(e){let gObj=this.parent;if(this.groupSettings.columns.length&&-1!==["altDownArrow","altUpArrow","ctrlDownArrow","ctrlUpArrow","enter"].indexOf(e.action))switch(e.preventDefault(),e.action){case"altDownArrow":case"altUpArrow":let selected=gObj.allowSelection?gObj.getSelectedRowIndexes():[];if(selected.length){let grpRow,rows=gObj.getContentTable().querySelector("tbody").children;for(let i=gObj.getDataRows()[selected[selected.length-1]].rowIndex;i>=0;i--)if(!rows[i].classList.contains("e-row")&&!rows[i].classList.contains("e-detailrow")){grpRow=rows[i];break}this.expandCollapseRows(grpRow.querySelector("altUpArrow"===e.action?".e-recordplusexpand":".e-recordpluscollapse"))}break;case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"enter":if(this.parent.isEdit||null!==closest(e.target,"#"+this.parent.element.id+"_searchbar"))return;let element=this.focus.getFocusedElement(),row=element?element.parentElement.querySelector('[class^="e-record"]'):null;if(!row)break;this.expandCollapseRows(row)}}clickHandler(e){this.expandCollapseRows(e.target),this.applySortFromTarget(e.target),this.unGroupFromTarget(e.target),this.toogleGroupFromHeader(e.target)}unGroupFromTarget(target){target.classList.contains("e-ungroupbutton")&&this.ungroupColumn(target.parentElement.getAttribute("ej-mappingname"))}toogleGroupFromHeader(target){this.groupSettings.showToggleButton&&(target.classList.contains("e-grptogglebtn")?target.classList.contains("e-toggleungroup")?this.ungroupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute("e-mappinguid")).field):this.groupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute("e-mappinguid")).field):target.classList.contains("e-toggleungroup")&&this.ungroupColumn(target.parentElement.getAttribute("ej-mappingname")))}applySortFromTarget(target){let gObj=this.parent,gHeader=closest(target,".e-groupheadercell");if(gObj.allowSorting&&gHeader&&!target.classList.contains("e-ungroupbutton")&&!target.classList.contains("e-toggleungroup")){let field=gHeader.firstElementChild.getAttribute("ej-mappingname");gObj.getColumnHeaderByField(field).querySelectorAll(".e-ascending").length?gObj.sortColumn(field,"Descending",!0):gObj.sortColumn(field,"Ascending",!0)}}expandCollapseRows(target){let trgt=parentsUntil(target,"e-recordplusexpand")||parentsUntil(target,"e-recordpluscollapse");if(trgt){let isHide,expandElem,dataManager,query,cellIdx=trgt.cellIndex,rowIdx=trgt.parentElement.rowIndex,rowNodes=this.parent.getContentTable().querySelector("tbody").children,rows=[].slice.call(rowNodes).slice(rowIdx+1,rowNodes.length),toExpand=[],gObj=this.parent,indent=trgt.parentElement.querySelectorAll(".e-indentcell").length,expand=!1;if(trgt.classList.contains("e-recordpluscollapse")?(addClass([trgt],"e-recordplusexpand"),removeClass([trgt],"e-recordpluscollapse"),trgt.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",expand=!0,isGroupAdaptive(gObj)&&this.updateVirtualRows(gObj,target,expand,query,dataManager)):(isHide=!0,removeClass([trgt],"e-recordplusexpand"),addClass([trgt],"e-recordpluscollapse"),trgt.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",isGroupAdaptive(gObj)&&this.updateVirtualRows(gObj,target,!isHide,query,dataManager)),this.aria.setExpand(trgt,expand),!isGroupAdaptive(gObj))for(let i=0,len=rows.length;i<len&&rows[i].querySelectorAll("td")[cellIdx]&&rows[i].querySelectorAll("td")[cellIdx].classList.contains("e-indentcell")&&rows;i++)isHide?rows[i].style.display="none":rows[i].querySelectorAll(".e-indentcell").length===indent+1&&(rows[i].style.display="",(expandElem=rows[i].querySelector(".e-recordplusexpand"))&&toExpand.push(expandElem),rows[i].classList.contains("e-detailrow")&&rows[i-1].querySelectorAll(".e-detailrowcollapse").length&&(rows[i].style.display="none"));for(let i=0,len=toExpand.length;i<len;i++)removeClass([toExpand[i]],"e-recordplusexpand"),addClass([toExpand[i]],"e-recordpluscollapse"),toExpand[i].firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",this.expandCollapseRows(toExpand[i])}}updateVirtualRows(gObj,target,isExpand,query,dataManager){let rObj=gObj.getRowObjectFromUID(target.closest("tr").getAttribute("data-uid"));rObj.isExpand=isExpand,function(grid){let nRows=[],actualRows=grid.vRows;for(let i=0;i<actualRows.length;i++)actualRows[i].isDataRow?nRows.push(actualRows[i]):actualRows[i].isDataRow||(nRows.push(actualRows[i]),!actualRows[i].isExpand&&actualRows[i].isCaptionRow&&(i+=getCollapsedRowsCount(actualRows[i],grid)));grid.vcRows=nRows}(gObj),(query=gObj.getDataModule().generateQuery(!1)).queries=[];let args={requestType:"virtualscroll",rowObject:rObj};gObj.getDataModule().getData(args,query.requiresCount()).then(e=>gObj.renderModule.dataManagerSuccess(e,args))}expandCollapse(isExpand){let row,rowNodes=this.parent.getContentTable().querySelector("tbody").children;for(let i=0,len=rowNodes.length;i<len;i++)rowNodes[i].querySelectorAll(".e-recordplusexpand, .e-recordpluscollapse").length?((row=rowNodes[i].querySelector(isExpand?".e-recordpluscollapse":".e-recordplusexpand"))&&(row.className=isExpand?"e-recordplusexpand":"e-recordpluscollapse",row.firstElementChild.className=isExpand?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"),rowNodes[i].firstElementChild.classList.contains("e-recordplusexpand")||rowNodes[i].firstElementChild.classList.contains("e-recordpluscollapse")||(rowNodes[i].style.display=isExpand?"":"none")):rowNodes[i].style.display=isExpand?"":"none"}expandAll(){this.expandCollapse(!0)}collapseAll(){this.expandCollapse(!1)}render(){this.l10n=this.serviceLocator.getService("localization"),this.renderGroupDropArea(),this.initDragAndDrop(),this.refreshToggleBtn()}renderGroupDropArea(){let groupElem=this.parent.element.querySelector(".e-groupdroparea");groupElem&&ej2_base_es2015_remove(groupElem),this.element=this.parent.createElement("div",{className:"e-groupdroparea",attrs:{tabindex:"-1"}}),this.updateGroupDropArea(),this.parent.element.insertBefore(this.element,this.parent.element.firstChild),this.groupSettings.showDropArea||(this.element.style.display="none")}updateGroupDropArea(clear){if(this.groupSettings.showDropArea&&!this.groupSettings.columns.length){let dragLabel=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=dragLabel,this.element.classList.remove("e-grouped")}else(this.element.innerHTML===this.l10n.getConstant("GroupDropArea")&&(1===this.groupSettings.columns.length||!this.isAppliedGroup&&!this.isAppliedUnGroup)||clear)&&(this.element.innerHTML=""),this.element.classList.add("e-grouped")}initDragAndDrop(){this.initializeGHeaderDrop(),this.initializeGHeaderDrag()}initializeGHeaderDrag(){new ej2_base_es2015_Draggable(this.element,{dragTarget:".e-groupheadercell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop})}initializeGHeaderDrop(){new ej2_base_es2015_Droppable(this.element,{accept:".e-dragclone",drop:this.drop})}groupColumn(columnName){let gObj=this.parent,column=gObj.getColumnByField(columnName);isNullOrUndefined(column)||!1===column.allowGrouping||this.contentRefresh&&this.groupSettings.columns.indexOf(columnName)>-1?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:column.headerText}):isActionPrevent(gObj)?gObj.notify(preventBatch,{instance:this,handler:this.groupColumn,arg1:columnName}):(column.visible=gObj.groupSettings.showGroupedColumn,this.colName=columnName,this.isAppliedGroup=!0,this.contentRefresh?this.updateModel():this.addColToGroupDrop(columnName),this.updateGroupDropArea(),this.isAppliedGroup=!1)}ungroupColumn(columnName){let gObj=this.parent,column=this.parent.enableColumnVirtualization?this.parent.columns.filter(c=>c.field===columnName)[0]:gObj.getColumnByField(columnName);if(isNullOrUndefined(column)||!1===column.allowGrouping||this.groupSettings.columns.indexOf(columnName)<0)return;if(isActionPrevent(gObj))return void gObj.notify(preventBatch,{instance:this,handler:this.ungroupColumn,arg1:columnName});column.visible=!0,this.colName=column.field;let columns=JSON.parse(JSON.stringify(this.groupSettings.columns));if(columns.splice(columns.indexOf(this.colName),1),this.sortedColumns.indexOf(columnName)<0)for(let i=0,len=gObj.sortSettings.columns.length;i<len;i++)if(columnName===gObj.sortSettings.columns[i].field){gObj.sortSettings.columns.splice(i,1);break}this.groupSettings.columns=columns,gObj.allowGrouping&&(this.isAppliedUnGroup=!0,this.parent.dataBind())}updateModel(){let columns=JSON.parse(JSON.stringify(this.groupSettings.columns));columns.push(this.colName),this.groupSettings.columns=columns,this.groupAddSortingQuery(this.colName),this.parent.dataBind()}onActionComplete(e){"grouping"===e.requestType?this.addColToGroupDrop(this.colName):this.removeColFromGroupDrop(this.colName);let args=this.groupSettings.columns.indexOf(this.colName)>-1?{columnName:this.colName,requestType:"grouping",type:actionComplete}:{requestType:"ungrouping",type:actionComplete};this.parent.trigger(actionComplete,extend(e,args)),this.colName=null}groupAddSortingQuery(colName){let i=0;for(;i<this.parent.sortSettings.columns.length&&this.parent.sortSettings.columns[i].field!==colName;)i++;this.parent.sortSettings.columns.length===i?this.parent.sortSettings.columns.push({field:colName,direction:"Ascending",isFromGroup:!0}):this.parent.allowSorting||(this.parent.sortSettings.columns[i].direction="Ascending")}addColToGroupDrop(field){let gObj=this.parent,direction="Ascending",groupedColumn=this.parent.createElement("div",{className:"e-grid-icon e-groupheadercell"}),childDiv=this.parent.createElement("div",{attrs:{"ej-mappingname":field}}),column=this.parent.getColumnByField(field);if(isNullOrUndefined(column))return;let headerCell=gObj.getColumnHeaderByUid(column.uid);childDiv.appendChild(this.parent.createElement("span",{className:"e-grouptext",innerHTML:column.headerText,attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),this.groupSettings.showToggleButton&&childDiv.appendChild(this.parent.createElement("span",{className:"e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"ungroup button"}})),headerCell.querySelectorAll(".e-ascending,.e-descending").length&&(direction=headerCell.querySelector(".e-ascending")?"Ascending":"Descending"),childDiv.appendChild(this.parent.createElement("span",{className:"e-groupsort e-icons e-"+direction.toLowerCase()+" e-icon-"+direction.toLowerCase(),innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),childDiv.appendChild(this.parent.createElement("span",{className:"e-ungroupbutton e-icons e-icon-hide",innerHTML:"&nbsp;",attrs:{title:this.l10n.getConstant("UnGroup"),tabindex:"-1","aria-label":"ungroup the grouped column"},styles:this.groupSettings.showUngroupButton?"":"display:none"})),groupedColumn.appendChild(childDiv),this.element.appendChild(groupedColumn)}refreshToggleBtn(isRemove){if(this.groupSettings.showToggleButton){let headers=[].slice.call(this.parent.element.getElementsByClassName("e-headercelldiv"));for(let i=0,len=headers.length;i<len;i++)if(!headers[i].classList.contains("e-emptycell")&&!headers[i].classList.contains("e-headerchkcelldiv")){let column=this.parent.getColumnByUid(headers[i].getAttribute("e-mappinguid"));(!this.parent.showColumnMenu||this.parent.showColumnMenu&&!column.showColumnMenu)&&(headers[i].querySelectorAll(".e-grptogglebtn").length&&ej2_base_es2015_remove(headers[i].querySelectorAll(".e-grptogglebtn")[0]),isRemove||headers[i].appendChild(this.parent.createElement("span",{className:"e-grptogglebtn e-icons "+(this.groupSettings.columns.indexOf(column.field)>-1?"e-toggleungroup e-icon-ungroup":"e-togglegroup e-icon-group"),attrs:{tabindex:"-1","aria-label":"Group button"}})))}}}removeColFromGroupDrop(field){isNullOrUndefined(this.getGHeaderCell(field))||(ej2_base_es2015_remove(this.getGHeaderCell(field)),this.updateGroupDropArea()),this.isAppliedUnGroup=!1}onPropertyChanged(e){if(e.module===this.getModuleName())for(let prop of Object.keys(e.properties))switch(prop){case"columns":let args;if(this.contentRefresh){if(this.isAppliedUnGroup)args={requestType:"ungrouping",type:actionBegin};else{if(!this.isAppliedGroup){this.updateGroupDropArea(!0);for(let i=0;i<this.groupSettings.columns.length;i++)this.colName=this.groupSettings.columns[i],this.parent.getColumnByField(this.colName).visible=this.parent.groupSettings.showGroupedColumn,this.groupAddSortingQuery(this.colName),i<this.groupSettings.columns.length-1&&this.addColToGroupDrop(this.groupSettings.columns[i])}args={columnName:this.colName,requestType:e.properties[prop].length?"grouping":"ungrouping",type:actionBegin}}this.groupSettings.showGroupedColumn||e.oldProperties[prop].forEach(column=>{-1===e.properties[prop].indexOf(column)&&(this.parent.getColumnByField(column).visible=!0)}),this.parent.notify(modelChanged,args)}break;case"showDropArea":this.updateGroupDropArea(),this.element.style.display=this.groupSettings.showDropArea?"":"none";break;case"showGroupedColumn":this.updateGroupedColumn(this.groupSettings.showGroupedColumn),this.parent.notify(modelChanged,{requestType:"refresh"});break;case"showUngroupButton":this.updateButtonVisibility(this.groupSettings.showUngroupButton,"e-ungroupbutton");break;case"showToggleButton":this.updateButtonVisibility(this.groupSettings.showToggleButton,"e-togglegroupbutton "),this.parent.refreshHeader()}}updateGroupedColumn(isVisible){for(let i=0;i<this.groupSettings.columns.length;i++)this.parent.getColumnByField(this.groupSettings.columns[i]).visible=isVisible}updateButtonVisibility(isVisible,className){let gHeader=[].slice.call(this.element.querySelectorAll("."+className));for(let i=0;i<gHeader.length;i++)gHeader[i].style.display=isVisible?"":"none"}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&this.render()}destroy(){let gridElement=this.parent.element;gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.parent.isDestroyed||this.parent.refreshing||this.clearGrouping(),this.removeEventListener(),this.refreshToggleBtn(!0),ej2_base_es2015_remove(this.element))}clearGrouping(){let cols=JSON.parse(JSON.stringify(this.groupSettings.columns));this.contentRefresh=!1;for(let i=0,len=cols.length;i<len;i++)i===len-1&&(this.contentRefresh=!0),this.ungroupColumn(cols[i]);this.contentRefresh=!0}getModuleName(){return"group"}refreshSortIcons(e){let header,gObj=this.parent,cols=gObj.sortSettings.columns,gCols=gObj.groupSettings.columns,fieldNames=this.parent.getColumns().map(c=>c.field);this.refreshToggleBtn();for(let i=0,len=cols.length;i<len;i++)-1!==fieldNames.indexOf(cols[i].field)&&(header=gObj.getColumnHeaderByField(cols[i].field),!gObj.allowSorting&&(this.sortedColumns.indexOf(cols[i].field)>-1||this.groupSettings.columns.indexOf(cols[i].field)>-1)?(ej2_base_es2015_classList(header.querySelector(".e-sortfilterdiv"),["e-ascending","e-icon-ascending"],[]),cols.length>1&&header.querySelector(".e-headercelldiv").appendChild(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(i+1).toString()}))):this.getGHeaderCell(cols[i].field)&&this.getGHeaderCell(cols[i].field).querySelectorAll(".e-groupsort").length&&("Ascending"===cols[i].direction?ej2_base_es2015_classList(this.getGHeaderCell(cols[i].field).querySelector(".e-groupsort"),["e-ascending","e-icon-ascending"],["e-descending","e-icon-descending"]):ej2_base_es2015_classList(this.getGHeaderCell(cols[i].field).querySelector(".e-groupsort"),["e-descending","e-icon-descending"],["e-ascending","e-icon-ascending"])));for(let i=0,len=gCols.length;i<len;i++)-1!==fieldNames.indexOf(gCols[i])&&gObj.getColumnHeaderByField(gCols[i]).setAttribute("aria-grouped","true")}getGHeaderCell(field){return this.element&&this.element.querySelector('[ej-mappingname="'+field+'"]')?this.element.querySelector('[ej-mappingname="'+field+'"]').parentElement:null}onGroupAggregates(editedData){let aggregates=this.iterateGroupAggregates(editedData),rowData=this.groupGenerator.generateRows(aggregates,{}),summaryRows=this.parent.getRowsObject().filter(row=>!row.isDataRow);rowData.filter(data=>!data.isDataRow).forEach((row,indx)=>{let cells=row.cells.filter(cell=>cell.isDataCell);this.parent.notify(refreshAggregateCell,{cells:cells,data:row.data,dataUid:summaryRows[indx]?summaryRows[indx].uid:""})})}iterateGroupAggregates(editedData){let updatedData=editedData instanceof Array?editedData:[],rows=this.parent.getRowsObject(),initData=this.parent.getCurrentViewRecords(),deletedCols=[],changeds=rows.map(row=>("delete"===row.edit&&deletedCols.push(row.data),row.changes instanceof Object?row.changes:row.data)),field=this.parent.getPrimaryKeyFieldNames()[0];changeds=0===updatedData.length?changeds:updatedData;let mergeData=initData.map(item=>{let value,pKeyVal=ej2_data_es2015_DataUtil.getObject(field,item);return changeds.some(cItem=>(value=cItem,pKeyVal===ej2_data_es2015_DataUtil.getObject(field,cItem)))?value:item});(!editedData.type||"cancel"!==editedData.type)&&deletedCols.length>0&&deletedCols.forEach(row=>{let index=mergeData.indexOf(row);mergeData.splice(index,1)});let result,aggrds,aggregates=[];return this.parent.aggregates.forEach(row=>{row.columns.forEach(col=>{let aggr={};aggr={type:col.type.toString().toLowerCase(),field:col.field},aggregates.push(aggr)})}),this.parent.groupSettings.columns.forEach(field=>{result=ej2_data_es2015_DataUtil.group(aggrds=result||mergeData,field,aggregates,null,null)}),result}}class ej2_grids_es2015_Toolbar$1{constructor(parent,serviceLocator){this.predefinedItems={},this.items=["Add","Edit","Update","Delete","Cancel","Print","Search","ColumnChooser","PdfExport","ExcelExport","CsvExport","WordExport"],this.parent=parent,this.gridID=parent.element.id,this.serviceLocator=serviceLocator,this.addEventListener()}render(){this.l10n=this.serviceLocator.getService("localization");let preItems=["Add","Edit","Update","Delete","Cancel","Print","PdfExport","ExcelExport","WordExport","CsvExport"];for(let item of preItems){let itemStr=item.toLowerCase(),localeName=itemStr[0].toUpperCase()+itemStr.slice(1);this.predefinedItems[item]={id:this.gridID+"_"+itemStr,prefixIcon:"e-"+itemStr,text:this.l10n.getConstant(localeName),tooltipText:this.l10n.getConstant(localeName)}}this.predefinedItems.Search={id:this.gridID+"_search",template:'<div class="e-input-group e-search" role="search">            <input id="'+this.gridID+'_searchbar" class="e-input" name="input" type="search"             placeholder= "'+this.l10n.getConstant("Search")+'"/>            <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"             tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"></span>             </div>',tooltipText:this.l10n.getConstant("Search"),align:"Right",cssClass:"e-search-wrapper"},this.predefinedItems.ColumnChooser={id:this.gridID+"_columnchooser",cssClass:"e-cc e-ccdiv e-cc-toolbar",suffixIcon:"e-columnchooser-btn",text:this.l10n.getConstant("Columnchooser"),tooltipText:this.l10n.getConstant("Columnchooser"),align:"Right"},this.createToolbar()}getToolbar(){return this.toolbar.element}destroy(){this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.element?this.toolbar.destroy():this.parent.destroyTemplate(["toolbarTemplate"]),this.unWireEvent(),this.removeEventListener(),ej2_base_es2015_remove(this.element))}bindSearchEvents(){this.searchElement=this.element.querySelector("#"+this.gridID+"_searchbar"),this.wireEvent(),this.refreshToolbarItems(),this.parent.searchSettings&&this.updateSearchBox()}createToolbar(){let items=this.getItems();this.toolbar=new ej2_navigations_es2015_Toolbar({items:items,clicked:this.toolbarClickHandler.bind(this),enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,created:this.bindSearchEvents.bind(this)}),this.toolbar.isStringTemplate=!0;let viewStr="viewContainerRef";if(this.parent[viewStr]&&(this.toolbar.registeredTemplate={},this.toolbar[viewStr]=this.parent[viewStr]),this.element=this.parent.createElement("div",{id:this.gridID+"_toolbarItems"}),this.parent.toolbarTemplate)if(isBlazor()||"string"!=typeof this.parent.toolbarTemplate)if(isBlazor()){let tempID=this.parent.element.id+"toolbarTemplate",item=appendChildren(this.element,ej2_grids_es2015_templateCompiler(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",tempID)),items=this.getItem(item);this.toolbar.items.push(items),this.toolbar.appendTo(this.element),updateBlazorTemplate(this.parent.element.id+"toolbarTemplate","ToolbarTemplate",this.parent)}else appendChildren(this.element,ej2_grids_es2015_templateCompiler(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate"));else this.toolbar.appendTo(this.parent.toolbarTemplate),this.element=this.toolbar.element;else this.toolbar.appendTo(this.element);this.parent.element.insertBefore(this.element,this.parent.getHeaderContent()),this.bindSearchEvents()}refreshToolbarItems(args){let gObj=this.parent,enableItems=[],disableItems=[],edit=gObj.editSettings,hasData=gObj.currentViewData&&gObj.currentViewData.length;edit.allowAdding?enableItems.push(this.gridID+"_add"):disableItems.push(this.gridID+"_add"),edit.allowEditing&&hasData?enableItems.push(this.gridID+"_edit"):disableItems.push(this.gridID+"_edit"),edit.allowDeleting&&hasData?enableItems.push(this.gridID+"_delete"):disableItems.push(this.gridID+"_delete"),"Batch"===gObj.editSettings.mode?gObj.element.querySelectorAll(".e-updatedtd").length&&(edit.allowAdding||edit.allowEditing)?(enableItems.push(this.gridID+"_update"),enableItems.push(this.gridID+"_cancel")):(disableItems.push(this.gridID+"_update"),disableItems.push(this.gridID+"_cancel")):gObj.isEdit&&(edit.allowAdding||edit.allowEditing)?(enableItems=[this.gridID+"_update",this.gridID+"_cancel"],disableItems=[this.gridID+"_add",this.gridID+"_edit",this.gridID+"_delete"]):(disableItems.push(this.gridID+"_update"),disableItems.push(this.gridID+"_cancel")),this.enableItems(enableItems,!0),this.enableItems(disableItems,!1)}getItems(){let items=[],toolbarItems=this.parent.toolbar||[];if("string"==typeof this.parent.toolbar)return[];for(let item of toolbarItems)switch(typeof item){case"number":items.push(this.getItemObject(this.items[item]));break;case"string":items.push(this.getItemObject(item));break;default:items.push(this.getItem(item))}return items}getItem(itemObject){let item=this.predefinedItems[itemObject.text];return item?extend(item,item,itemObject):itemObject}getItemObject(itemName){return this.predefinedItems[itemName]||{text:itemName,id:this.gridID+"_"+itemName}}enableItems(items,isEnable){for(let item of items){let element=this.element.querySelector("#"+item);element&&this.toolbar.enableItems(element.parentElement,isEnable)}}toolbarClickHandler(args){let gObj=this.parent,gID=this.gridID;extend(args,{cancel:!1});let newArgs=!isBlazor()||this.parent.isJsComponent?args:{item:args.item,cancel:args.cancel,name:args.name},originalEvent=args.originalEvent;gObj.trigger(toolbarClick,newArgs,toolbarargs=>{if(toolbarargs.originalEvent=toolbarargs.originalEvent?toolbarargs.originalEvent:originalEvent,!toolbarargs.cancel)switch(!isNullOrUndefined(toolbarargs.item)&&toolbarargs.item.id){case gID+"_print":gObj.print();break;case gID+"_edit":gObj.startEdit();break;case gID+"_update":gObj.endEdit();break;case gID+"_cancel":gObj.closeEdit();break;case gID+"_add":gObj.addRecord();break;case gID+"_delete":gObj.deleteRecord();break;case gID+"_search":toolbarargs.originalEvent.target.id===gID+"_searchbutton"&&this.search();break;case gID+"_columnchooser":let tarElement=this.parent.element.querySelector(".e-ccdiv"),y=tarElement.getBoundingClientRect().top,x=tarElement.getBoundingClientRect().left,targetEle=toolbarargs.originalEvent.target;y=tarElement.getBoundingClientRect().top+tarElement.offsetTop,gObj.createColumnchooser(x,y,targetEle)}})}modelChanged(e){"edit"===e.module&&this.refreshToolbarItems()}onPropertyChanged(e){e.module===this.getModuleName()&&this.parent.toolbar&&(this.element&&ej2_base_es2015_remove(this.element),this.render())}keyUpHandler(e){13===e.keyCode&&this.search()}search(){this.parent.search(this.searchElement.value)}updateSearchBox(){this.searchElement&&(this.searchElement.value=this.parent.searchSettings.key)}wireEvent(){this.searchElement&&(this.searchBoxObj=new ej2_grids_es2015_SearchBox(this.searchElement),EventHandler.add(this.searchElement,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent())}unWireEvent(){this.searchElement&&(EventHandler.remove(this.searchElement,"keyup",this.keyUpHandler),this.searchBoxObj.unWireEvent())}addEventListener(){this.parent.isDestroyed||(this.parent.on(initialEnd,this.render,this),this.parent.on(uiUpdate,this.onPropertyChanged,this),this.parent.on(inBoundModelChanged,this.updateSearchBox.bind(this)),this.parent.on(modelChanged,this.refreshToolbarItems,this),this.parent.on(toolbarRefresh,this.refreshToolbarItems,this),this.parent.on(inBoundModelChanged,this.modelChanged,this),this.parent.on(dataBound,this.refreshToolbarItems,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(initialEnd,this.render),this.parent.off(uiUpdate,this.onPropertyChanged),this.parent.off(inBoundModelChanged,this.updateSearchBox),this.parent.off(modelChanged,this.refreshToolbarItems),this.parent.off(toolbarRefresh,this.refreshToolbarItems),this.parent.off(inBoundModelChanged,this.modelChanged),this.parent.off(dataBound,this.refreshToolbarItems))}getModuleName(){return"toolbar"}}class ej2_grids_es2015_InlineEditRender{constructor(parent){this.parent=parent}addNew(elements,args){let mTbody,tbody;if(this.isEdit=!1,tbody=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?this.parent.getHeaderContent().querySelector("tbody"):this.parent.getContentTable().querySelector("tbody"),args.row=this.parent.createElement("tr",{className:"e-row e-addedrow"}),tbody.querySelector(".e-emptyrow")&&tbody.querySelector(".e-emptyrow").remove(),"Top"===this.parent.editSettings.newRowPosition?tbody.insertBefore(args.row,tbody.firstChild):tbody.appendChild(args.row),args.row.appendChild(this.getEditElement(elements,!1,void 0,args,!0)),this.parent.getFrozenColumns()){let mEle=this.renderMovableform(args.row,args);mTbody=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody"),"Top"===this.parent.editSettings.newRowPosition?mTbody.insertBefore(mEle,mTbody.firstChild):mTbody.appendChild(mEle),args.row.querySelector(".e-normaledit").setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),mEle.setAttribute("colspan",""+(this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns())),"auto"===this.parent.height&&this.parent.notify(frozenHeight,{})}}renderMovableform(ele,args){let mEle=ele.cloneNode(!0),form=args.movableForm=mEle.querySelector("form");return this.parent.editSettings.template?(form.innerHTML="",this.appendChildren(form,args.rowData,!1),mEle):(this.renderMovable(ele,mEle),mEle.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,mEle)}updateFreezeEdit(row,td){return td.concat([].slice.call(this.getFreezeRow(row).querySelectorAll("td.e-rowcell")))}getFreezeRow(row){if(this.parent.getFrozenColumns()){let idx=parseInt(row.getAttribute("aria-rowindex"),10),fCont=this.parent.getContent().querySelector(".e-frozencontent").querySelector("tbody"),mCont=this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody"),fHdr=this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody"),mHdr=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody");if(this.parent.frozenRows&&idx>=this.parent.frozenRows&&(idx-=this.parent.frozenRows),fCont.contains(row))return mCont.children[idx];if(mCont.contains(row))return fCont.children[idx];if(fHdr.contains(row))return mHdr.children[idx];if(mHdr.contains(row))return fHdr.children[idx]}return row}update(elements,args){this.isEdit=!0,closest(args.row,".e-movablecontent")&&(args.row=this.getFreezeRow(args.row));let tdElement=[].slice.call(args.row.querySelectorAll("td.e-rowcell"));args.row.innerHTML="",tdElement=this.updateFreezeEdit(args.row,tdElement),args.row.appendChild(this.getEditElement(elements,!0,tdElement,args,!0)),args.row.classList.add("e-editedrow"),this.refreshFreezeEdit(args.row,args)}refreshFreezeEdit(row,args){let fCls,cont,td=row.firstChild,idx=parseInt(row.getAttribute("aria-rowindex"),10);if(this.parent.getFrozenColumns()){idx<this.parent.frozenRows?(cont=this.parent.getHeaderContent(),fCls=".e-frozenheader"):(cont=this.parent.getContent(),fCls=".e-frozencontent");let fRows,mTd=td.cloneNode(!0),form=args.movableForm=mTd.querySelector("form");this.parent.editSettings.template&&(form.innerHTML="",this.appendChildren(form,args.rowData,!1)),cont.querySelector(fCls).contains(row)?(fRows=this.parent.getMovableRowByIndex(idx),this.updateFrozenCont(fRows,td,mTd)):(fRows=this.parent.getRowByIndex(idx),this.updateFrozenCont(fRows,mTd,td)),fRows.appendChild(mTd),fRows.classList.add("e-editedrow")}}updateFrozenCont(row,ele,mEle){row.innerHTML="",this.parent.editSettings.template||(this.renderMovable(ele,mEle),mEle.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML),ele.setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),mEle.setAttribute("colspan",this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns()+"")}renderMovable(ele,mEle){let frzCols=this.parent.getFrozenColumns();for(let i=0;i<frzCols;i++)mEle.querySelector("tr").removeChild(mEle.querySelector("tr").children[0]);for(let i=frzCols,len=ele.querySelector("tr").childElementCount;i<len;i++)ele.querySelector("tr").removeChild(ele.querySelector("tr").children[ele.querySelector("tr").childElementCount-1])}getEditElement(elements,isEdit,tdElement,args,isFrozen){let gObj=this.parent,gLen=0,isDetail=isNullOrUndefined(gObj.detailTemplate)&&isNullOrUndefined(gObj.childGrid)?0:1,isDragable=gObj.isRowDragable()?1:0;gObj.allowGrouping&&(gLen=gObj.groupSettings.columns.length);let td=this.parent.createElement("td",{className:"e-editcell e-normaledit",attrs:{colspan:(gObj.getVisibleColumns().length-gObj.getVisibleFrozenColumns()+gLen+isDetail+isDragable).toString()}}),form=args.form=this.parent.createElement("form",{id:gObj.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template)return this.appendChildren(form,args.rowData,isFrozen),td.appendChild(form),td;let table=this.parent.createElement("table",{className:"e-table e-inline-edit",attrs:{cellspacing:"0.25"}});table.appendChild(gObj.getContentTable().querySelector("colgroup").cloneNode(!0));let tbody=this.parent.createElement("tbody"),tr=this.parent.createElement("tr"),i=0;for(isDetail&&tr.insertBefore(this.parent.createElement("td",{className:"e-detailrowcollapse"}),tr.firstChild),gObj.isRowDragable()&&tr.appendChild(this.parent.createElement("td",{className:"e-dragindentcell"}));i<gLen;)tr.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),i++;let m=0;for(i=0;isEdit&&m<tdElement.length&&i<gObj.getColumns().length||i<gObj.getColumns().length;){let span=isEdit?tdElement[m].getAttribute("colspan"):null,col=gObj.getColumns()[i],td=this.parent.createElement("td",{className:"e-rowcell",attrs:{style:"text-align:"+(col.textAlign?col.textAlign:""),colspan:span||""}});col.visible?(td.appendChild(elements[col.uid]),"booleanedit"===col.editType?td.classList.add("e-boolcell"):(col.commands||col.commandsTemplate)&&addClass([td],"e-unboundcell")):td.classList.add("e-hide"),tr.appendChild(td),i=span?i+parseInt(span,10):i+1,m++}return tbody.appendChild(tr),table.appendChild(tbody),form.appendChild(table),td.appendChild(form),td}removeEventListener(){}appendChildren(form,data,isFrozen){let dummyData=extend({},data,{isAdd:!this.isEdit,isFrozen:isFrozen},!0);appendChildren(form,this.parent.getEditTemplate()(dummyData,this.parent,"editSettingsTemplate"))}}class ej2_grids_es2015_BatchEditRender{constructor(parent){this.parent=parent}update(elements,args){args.cell.innerHTML="",args.cell.appendChild(this.getEditElement(elements,args)),args.cell.classList.remove("e-ellipsistooltip"),args.cell.classList.add("e-editedbatchcell"),ej2_base_es2015_classList(args.row,["e-editedrow","e-batchrow"],[])}getEditElement(elements,args){let form=this.parent.createElement("form",{id:this.parent.element.id+"EditForm",className:"e-gridform"});return form.appendChild(elements[args.columnObject.uid]),"booleanedit"===args.columnObject.editType&&args.cell.classList.add("e-boolcell"),args.columnObject.editType||args.cell.classList.add("e-inputbox"),form}removeEventListener(){}}class ej2_grids_es2015_DialogEditRender{constructor(parent,serviceLocator){this.parent=parent,this.serviceLocator=serviceLocator,this.parent.isDestroyed||(this.parent.on(dialogDestroy,this.destroy,this),this.parent.on(ej2_grids_es2015_destroy,this.destroy,this))}setLocaleObj(){this.l10n=this.serviceLocator.getService("localization")}addNew(elements,args){this.isEdit=!1,this.createDialog(elements,args)}update(elements,args){this.isEdit=!0,this.createDialog(elements,args)}createDialog(elements,args){let gObj=this.parent;this.dialog=this.parent.createElement("div",{id:gObj.element.id+"_dialogEdit_wrapper",styles:"width: auto"}),gObj.element.appendChild(this.dialog),this.setLocaleObj(),this.dialogObj=new ej2_popups_es2015_Dialog(extend({header:this.isEdit?this.l10n.getConstant("EditFormTitle")+args.primaryKeyValue[0]:this.l10n.getConstant("AddFormTitle"),isModal:!0,visible:!0,cssClass:"e-edit-dialog",content:this.getEditElement(elements,args),showCloseIcon:!0,allowDragging:!0,close:this.dialogClose.bind(this),closeOnEscape:!0,width:gObj.editSettings.template?"auto":"330px",target:args.target?args.target:document.body,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.l10n.getConstant("SaveButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}]},gObj.editSettings.dialog.params)),isBlazor()||(args.dialog=this.dialogObj),this.dialogObj.isStringTemplate=!0,this.dialogObj.appendTo(this.dialog),this.parent.applyBiggerTheme(this.dialogObj.element.parentElement)}btnClick(e){this.l10n.getConstant("CancelButton").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialogClose():this.parent.endEdit()}dialogClose(){this.parent.closeEdit(),this.destroy()}destroy(args){updateBlazorTemplate(this.parent.element.id+"editSettingsTemplate","Template",this.parent.editSettings),this.parent.notify(destroyForm,{}),this.parent.isEdit=!1,this.parent.notify(toolbarRefresh,{}),this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),ej2_base_es2015_remove(this.dialog))}getEditElement(elements,args){let gObj=this.parent,div=this.parent.createElement("div",{className:this.isEdit?"e-editedrow":"e-insertedrow"}),form=args.form=this.parent.createElement("form",{id:gObj.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template){let editTemplateID=this.parent.element.id+"editSettingsTemplate",dummyData=extend({},args.rowData,{isAdd:!this.isEdit},!0);return appendChildren(form,this.parent.getEditTemplate()(dummyData,this.parent,"editSettingsTemplate",editTemplateID)),updateBlazorTemplate(editTemplateID,"Template",this.parent.editSettings),div.appendChild(form),div}let table=this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"6px"}}),tbody=this.parent.createElement("tbody"),cols=gObj.getColumns();for(let i=0;i<cols.length;i++){if(this.parent.editModule.checkColumnIsGrouped(cols[i])||cols[i].commands||cols[i].commandsTemplate)continue;let tr=this.parent.createElement("tr"),dataCell=this.parent.createElement("td",{className:"e-rowcell",attrs:{style:"text-align:"+(this.parent.enableRtl?"right":"left")+";width:190px"}});this.parent.createElement("label",{innerHTML:cols[i].field}),elements[cols[i].uid].classList.remove("e-input"),dataCell.appendChild(elements[cols[i].uid]),tr.appendChild(dataCell),tbody.appendChild(tr)}return table.appendChild(tbody),form.appendChild(table),div.appendChild(form),div}removeEventListener(){this.parent.isDestroyed||(this.parent.off(dialogDestroy,this.destroy),this.parent.off(ej2_grids_es2015_destroy,this.destroy))}}class ej2_grids_es2015_EditRender{constructor(parent,serviceLocator){this.editType={Inline:ej2_grids_es2015_InlineEditRender,Normal:ej2_grids_es2015_InlineEditRender,Batch:ej2_grids_es2015_BatchEditRender,Dialog:ej2_grids_es2015_DialogEditRender},this.parent=parent,this.serviceLocator=serviceLocator,this.renderer=new this.editType[this.parent.editSettings.mode](parent,serviceLocator),this.focus=serviceLocator.getService("focus")}addNew(args){this.renderer.addNew(this.getEditElements(args),args),this.convertWidget(args)}update(args){this.renderer.update(this.getEditElements(args),args),this.parent.notify(beforeStartEdit,args),this.convertWidget(args)}convertWidget(args){let isFocused,cell,value,fForm,gObj=this.parent,frzCols=gObj.getFrozenColumns(),form="Dialog"===gObj.editSettings.mode?document.querySelector("#"+gObj.element.id+"_dialogEdit_wrapper").querySelector(".e-gridform"):gObj.element.querySelector(".e-gridform");if(frzCols&&"Normal"===gObj.editSettings.mode){let rowIndex=parseInt(args.row.getAttribute("aria-rowindex"),10);fForm=gObj.frozenRows&&("add"===args.requestType&&"Top"===gObj.editSettings.newRowPosition||rowIndex<gObj.frozenRows)?gObj.element.querySelector(".e-movableheader").querySelector(".e-gridform"):gObj.element.querySelector(".e-movablecontent").querySelector(".e-gridform")}let cols="Batch"!==gObj.editSettings.mode?gObj.getColumns():[gObj.getColumnByField(args.columnName)];for(let col of cols){if(this.parent.editSettings.template&&!isNullOrUndefined(col.field)){let cellArgs=extend({},args);cellArgs.element=form.querySelector("[name="+getComplexFieldID(col.field)+"]"),isNullOrUndefined(cellArgs.element)&&frzCols&&(cellArgs.element=fForm.querySelector("[name="+getComplexFieldID(col.field)+"]")),"string"==typeof col.edit.write?ej2_grids_es2015_getObject(col.edit.write,window)(cellArgs):col.edit.write(cellArgs);continue}if(this.parent.editModule.checkColumnIsGrouped(col)||col.commands)continue;value=col.valueAccessor(col.field,args.rowData,col),cell=frzCols&&cols.indexOf(col)>=frzCols&&"Normal"===gObj.editSettings.mode?fForm.querySelector("[e-mappinguid="+col.uid+"]"):form.querySelector("[e-mappinguid="+col.uid+"]");let temp=col.edit.write;isNullOrUndefined(cell)||("string"==typeof temp?(temp=ej2_grids_es2015_getObject(temp,window))({rowData:args.rowData,element:cell,column:col,requestType:args.requestType,row:args.row,foreignKeyData:col.isForeignColumn()&&ej2_grids_es2015_getObject(col.field,args.foreignKeyData)}):col.edit.write({rowData:args.rowData,element:cell,column:col,requestType:args.requestType,row:args.row,foreignKeyData:col.isForeignColumn()&&ej2_grids_es2015_getObject(col.field,args.foreignKeyData)}),isFocused||cell.getAttribute("disabled")||(this.focusElement(cell,args.type),isFocused=!0))}if(!(0===frzCols||this.parent.allowTextWrap||"add"!==args.requestType&&"beginEdit"!==args.requestType||"Dialog"===this.parent.editSettings.mode||isNullOrUndefined(form)||isNullOrUndefined(fForm))){let mTdElement=fForm.querySelector("tr").children[0],fTdElement=form.querySelector("tr").children[0];fTdElement.offsetHeight>mTdElement.offsetHeight?mTdElement.style.height=fTdElement.offsetHeight+"px":fTdElement.style.height=mTdElement.offsetHeight+"px"}}focusElement(elem,type){let chkBox=this.parent.element.querySelector(".e-edit-checkselect");isNullOrUndefined(chkBox)||chkBox.nextElementSibling.classList.add("e-focus"),"Batch"===this.parent.editSettings.mode?this.focus.onClick({target:closest(elem,"td")},!0):elem.focus(),elem.classList.contains("e-defaultcell")&&elem.setSelectionRange(elem.value.length,elem.value.length)}getEditElements(args){let gObj=this.parent,elements={},cols="Batch"!==gObj.editSettings.mode?gObj.getColumns():[gObj.getColumnByField(args.columnName)];if(this.parent.editSettings.template)return{};for(let i=0,len=cols.length;i<len;i++){let col=cols[i];if(this.parent.editModule.checkColumnIsGrouped(col))continue;if(col.commands||col.commandsTemplate){let cellRendererFact=this.serviceLocator.getService("cellRendererFactory"),model=new ej2_grids_es2015_RowModelGenerator(this.parent),cellRenderer=cellRendererFact.getCellRenderer(CellType.CommandColumn),cell=model.generateRows(args.rowData)[0].cells.filter(cell=>cell.rowID),td=cellRenderer.render(cell[i],args.rowData,{index:args.row?args.row.getAttribute("aria-rowindex"):0}),div=td.firstElementChild;div.setAttribute("textAlign",td.getAttribute("textAlign")),elements[col.uid]=div;continue}let input,value=col.valueAccessor(col.field,args.rowData,col),tArgs={column:col,value:value,type:args.requestType,data:args.rowData},temp=col.edit.create;if(col.editTemplate){input=this.parent.createElement("span",{attrs:{"e-mappinguid":col.uid}});let tempID=this.parent.element.id+col.uid+"editTemplate";appendChildren(input,col.getEditTemplate()(args.rowData,this.parent,"editTemplate",tempID)),isBlazor()&&updateBlazorTemplate(tempID,"EditTemplate",col)}else{if("string"==typeof(input="string"==typeof temp?(temp=ej2_grids_es2015_getObject(temp,window))(tArgs):col.edit.create(tArgs))){let div=this.parent.createElement("div");div.innerHTML=input,input=div.firstChild}let isInput="input"!==input.tagName&&input.querySelectorAll("input").length,complexFieldName=getComplexFieldID(col.field);attributes(isInput?input.querySelector("input"):input,{name:complexFieldName,"e-mappinguid":col.uid,id:gObj.element.id+complexFieldName}),ej2_base_es2015_classList(input,["e-input","e-field"],[]),"Right"===col.textAlign&&input.classList.add("e-ralign"),((col.isPrimaryKey||col.isIdentity)&&"beginEdit"===args.requestType||col.isIdentity&&"add"===args.requestType)&&input.setAttribute("disabled","")}elements[col.uid]=input}return elements}destroy(){this.renderer.removeEventListener()}}class ej2_grids_es2015_BooleanEditCell{constructor(parent){this.activeClasses=["e-selectionbackground","e-active"],this.parent=parent}create(args){let col=args.column,classNames="e-field e-boolcell";"checkbox"===col.type&&(classNames="e-field e-boolcell e-edit-checkselect");let complexFieldName=getComplexFieldID(args.column.field);return this.parent.createElement("input",{className:classNames,attrs:{type:"checkbox",value:args.value,"e-mappinguid":col.uid,id:this.parent.element.id+complexFieldName,name:complexFieldName}})}read(element){return element.checked}write(args){let selectChkBox,chkState;if("add"===args.requestType||args.row.classList.contains("e-addedrow"),isNullOrUndefined(args.row)||(selectChkBox=args.row.querySelector(".e-edit-checkselect")),ej2_grids_es2015_getObject(args.column.field,args.rowData)&&(chkState=JSON.parse(ej2_grids_es2015_getObject(args.column.field,args.rowData).toString().toLowerCase())),!isNullOrUndefined(selectChkBox)){if(this.editType=this.parent.editSettings.mode,this.editRow=args.row,"add"!==args.requestType){let row=this.parent.getRowObjectFromUID(args.row.getAttribute("data-uid"));chkState=!!row&&row.isSelected}addRemoveActiveClasses([].slice.call(args.row.querySelectorAll(".e-rowcell")),chkState,...this.activeClasses)}this.obj=new ej2_buttons_es2015_CheckBox(extend({label:"Dialog"!==this.parent.editSettings.mode?" ":args.column.headerText,checked:chkState,disabled:!isEditable(args.column,args.requestType,args.element),enableRtl:this.parent.enableRtl,change:this.checkBoxChange.bind(this)},args.column.edit.params)),this.obj.appendTo(args.element)}checkBoxChange(args){if(this.editRow&&"Dialog"!==this.editType){let add=!1;args.checked?this.editRow.setAttribute("aria-selected",(add=!0).toString()):this.editRow.removeAttribute("aria-selected"),addRemoveActiveClasses([].slice.call(this.editRow.querySelectorAll(".e-rowcell")),add,...this.activeClasses)}}destroy(){this.obj&&this.obj.destroy()}}class ej2_grids_es2015_DropDownEditCell{constructor(parent){this.parent=parent,this.flag=!1}create(args){let complexFieldName=getComplexFieldID(args.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+complexFieldName,name:complexFieldName,type:"text","e-mappinguid":args.column.uid}})}write(args){this.column=args.column;let isInline="Dialog"!==this.parent.editSettings.mode;this.obj=new ej2_dropdowns_es2015_DropDownList(extend({dataSource:this.parent.dataSource instanceof ej2_data_es2015_DataManager?this.parent.dataSource:new ej2_data_es2015_DataManager(this.parent.dataSource),query:(new ej2_data_es2015_Query).select(args.column.field),enabled:isEditable(args.column,args.requestType,args.element),fields:{value:args.column.field},value:ej2_grids_es2015_getObject(args.column.field,args.rowData),enableRtl:this.parent.enableRtl,filtering:this.ddFiltering.bind(this),actionComplete:this.ddActionComplete.bind(this),placeholder:isInline?"":args.column.headerText,popupHeight:"200px",floatLabelType:isInline?"Never":"Always",open:this.dropDownOpen.bind(this),sortOrder:"Ascending"},args.column.edit.params)),this.obj.appendTo(args.element),args.element.setAttribute("name",getComplexFieldID(args.column.field))}read(element){return element.ej2_instances[0].value}ddFiltering(e){this.flag=!0}ddActionComplete(e){e.result=ej2_data_es2015_DataUtil.distinct(e.result,this.obj.fields.value,!0),!this.flag&&this.column.dataSource&&(this.column.dataSource.dataSource.json=e.result),this.flag=!1}dropDownOpen(args){let dlgElement=parentsUntil(this.obj.element,"e-dialog");if("Dialog"===this.parent.editSettings.mode&&!isNullOrUndefined(dlgElement)){let dlgObj=document.querySelector("#"+dlgElement.id).ej2_instances[0];args.popup.element.style.zIndex=(dlgObj.zIndex+1).toString()}}destroy(){this.obj&&this.obj.destroy()}}class ej2_grids_es2015_NumericEditCell{constructor(parent){this.parent=parent}create(args){let complexFieldName=getComplexFieldID(args.column.field);return this.instances=new Internationalization(this.parent.locale),this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+complexFieldName,name:complexFieldName,"e-mappinguid":args.column.uid}})}read(element){return this.instances.getNumberParser({format:"n"})(element.value)}write(args){let col=args.column,isInline="Dialog"!==this.parent.editSettings.mode;this.obj=new ej2_inputs_es2015_NumericTextBox(extend({value:parseFloat(ej2_grids_es2015_getObject(args.column.field,args.rowData)),enableRtl:this.parent.enableRtl,placeholder:isInline?"":args.column.headerText,enabled:isEditable(args.column,args.requestType,args.element),floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always"},col.edit.params)),args.element.setAttribute("name",getComplexFieldID(args.column.field)),this.obj.appendTo(args.element)}destroy(){this.obj&&!this.obj.isDestroyed&&this.obj.destroy()}}class ej2_grids_es2015_DefaultEditCell{constructor(parent){this.parent=parent}create(args){let col=args.column;return this.parent.createElement("input",{className:"e-field e-input e-defaultcell",attrs:{type:"text",value:isNullOrUndefined(args.value)?"":args.value,"e-mappinguid":col.uid,id:this.parent.element.id+getComplexFieldID(col.field),name:getComplexFieldID(col.field),style:"text-align:"+col.textAlign}})}read(element){return element.value}write(args){let isInline="Dialog"!==this.parent.editSettings.mode,inputargs={element:args.element,floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",properties:{enableRtl:this.parent.enableRtl,enabled:isEditable(args.column,args.requestType,args.element),placeholder:isInline?"":args.column.headerText}};ej2_inputs_es2015_Input.createInput(inputargs,this.parent.createElement)}}class ej2_grids_es2015_NormalEdit{constructor(parent,serviceLocator,renderer){this.args={},this.parent=parent,this.renderer=renderer,this.serviceLocator=serviceLocator,this.addEventListener()}clickHandler(e){let target=e.target,gObj=this.parent;(parentsUntil(target,"e-gridcontent")&&parentsUntil(parentsUntil(target,"e-gridcontent"),"e-grid").id===gObj.element.id||gObj.frozenRows&&parentsUntil(target,"e-headercontent"))&&!parentsUntil(target,"e-unboundcelldiv")&&(this.rowIndex=parentsUntil(target,"e-rowcell")?parseInt(target.parentElement.getAttribute("aria-rowindex"),10):-1,gObj.isEdit&&gObj.editModule.endEdit())}dblClickHandler(e){parentsUntil(e.target,"e-rowcell")&&this.parent.editSettings.allowEditOnDblClick&&this.parent.editModule.startEdit(parentsUntil(e.target,"e-row"))}editComplete(e){switch(this.parent.isEdit=!1,e.requestType){case"save":(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||this.parent.selectRow(0),this.parent.trigger(actionComplete,extend(e,{requestType:"save",type:actionComplete}));break;case"delete":if(isBlazor()&&!this.parent.isJsComponent){let d="data";e[d]=e[d][0]}this.parent.trigger(actionComplete,extend(e,{requestType:"delete",type:actionComplete})),this.parent.selectRow(this.editRowIndex)}}startEdit(tr){let gObj=this.parent,primaryKeys=gObj.getPrimaryKeyFieldNames(),primaryKeyValues=[];if(this.rowIndex=this.editRowIndex=parseInt(tr.getAttribute("aria-rowindex"),10),isBlazor()){let cols=this.parent.getColumns();for(let i=0;i<cols.length;i++){let col=cols[i];col.template&&resetBlazorTemplate(gObj.element.id+col.uid,0,this.rowIndex)}}if(isGroupAdaptive(gObj)){let rObj=gObj.getRowObjectFromUID(tr.getAttribute("data-uid"));this.previousData=rObj.data}else this.previousData=gObj.getCurrentViewRecords()[this.rowIndex];for(let i=0;i<primaryKeys.length;i++)primaryKeyValues.push(this.previousData[primaryKeys[i]]);this.uid=tr.getAttribute("data-uid");let rowObj=gObj.getRowObjectFromUID(this.uid),args={primaryKey:primaryKeys,primaryKeyValue:primaryKeyValues,requestType:"beginEdit",rowData:this.previousData,rowIndex:this.rowIndex,type:"edit",cancel:!1,foreignKeyData:rowObj&&rowObj.foreignKeyData,target:void 0};isBlazor()&&!this.parent.isJsComponent||(args.row=tr),gObj.trigger(beginEdit,args,begineditargs=>{begineditargs.type="actionBegin",gObj.trigger(actionBegin,begineditargs,editargs=>{editargs.cancel||(gObj.isEdit=!0,editargs.row=editargs.row?editargs.row:tr,"Dialog"!==gObj.editSettings.mode&&gObj.clearSelection(),"Dialog"===gObj.editSettings.mode&&gObj.selectionModule&&(gObj.selectionModule.preventFocus=!0,editargs.row.classList.add("e-dlgeditrow")),this.renderer.update(editargs),this.uid=tr.getAttribute("data-uid"),gObj.editModule.applyFormValidation(),editargs.type="actionComplete",gObj.trigger(actionComplete,editargs),this.args=editargs,this.parent.allowTextWrap&&this.parent.notify(freezeRender,{case:"textwrap"}),isBlazor()&&(this.parent.notify(toolbarRefresh,{}),gObj.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{})))})})}updateRow(index,data){let gObj=this.parent,args={requestType:"save",type:actionBegin,data:data,cancel:!1,previousData:gObj.getCurrentViewRecords()[index]};gObj.showSpinner(),gObj.notify(updateData,args),args.promise?args.promise.then(()=>gObj.refresh()).catch(e=>this.edFail(e)):gObj.refresh()}editFormValidate(){let gObj=this.parent,form1=gObj.editModule.formObj.validate(),form2=!gObj.editModule.mFormObj||gObj.editModule.mFormObj.validate();return form1&&form2}endEdit(){let gObj=this.parent;if(!this.parent.isEdit||!this.editFormValidate())return;let editedData=extend({},{},this.previousData,!0),args=extend(this.args,{requestType:"save",type:actionBegin,data:editedData,cancel:!1,previousData:this.previousData,selectedRow:gObj.selectedRowIndex,foreignKeyData:{}}),isDlg="Dialog"===gObj.editSettings.mode,dlgWrapper=document.querySelector("#"+gObj.element.id+"_dialogEdit_wrapper"),dlgForm=isDlg?dlgWrapper.querySelector(".e-gridform"):gObj.element.querySelector(".e-gridform");if(editedData=gObj.editModule.getCurrentEditedData(dlgForm,editedData),gObj.getFrozenColumns()&&"Normal"===gObj.editSettings.mode){let mForm=gObj.element.querySelector(".e-movableheader").querySelector(".e-gridform");editedData=gObj.editModule.getCurrentEditedData(gObj.frozenRows&&mForm?mForm:gObj.element.querySelector(".e-movablecontent").querySelector(".e-gridform"),editedData)}if(isDlg?dlgWrapper.querySelectorAll(".e-editedrow").length:gObj.element.querySelectorAll(".e-editedrow").length)args.action="edit",gObj.trigger(actionBegin,args,endEditArgs=>{endEditArgs.cancel||(gObj.showSpinner(),gObj.notify(updateData,endEditArgs))});else if(args.action="add",args.selectedRow=0,args.index=this.addedRowIndex,gObj.notify(modelChanged,args),this.addedRowIndex=null,args.cancel)return}destroyElements(){let gObj=this.parent;gObj.editModule.destroyWidgets(),gObj.editModule.destroyForm(),this.parent.notify(dialogDestroy,{})}editHandler(args){args.promise?args.promise.then(e=>this.edSucc(e,args)).catch(e=>this.edFail(e)):this.editSuccess(args.data,args)}edSucc(e,args){this.editSuccess(e,args)}edFail(e){this.editFailure(e)}updateCurrentViewData(data){this.parent.getCurrentViewRecords()[this.editRowIndex]=data}requestSuccess(args){this.parent.editModule.formObj&&!this.parent.editModule.formObj.isDestroyed&&(this.destroyElements(),this.stopEditStatus(),"Dialog"===this.parent.editSettings.mode&&"add"!==args.action&&this.parent.element.querySelector(".e-dlgeditrow").classList.remove("e-dlgeditrow"))}editSuccess(e,args){isNullOrUndefined(e)||e instanceof Array||(args.data=extend({},extend({},args.rowData,args.data),e)),this.requestSuccess(args),this.parent.trigger(beforeDataBound,args),args.type=actionComplete,this.parent.isEdit=!1,this.refreshRow(args.data),this.updateCurrentViewData(args.data),this.blazorTemplate(),this.parent.trigger(actionComplete,args),isBlazor()&&this.parent.notify(toolbarRefresh,{}),(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||"Dialog"!==this.parent.editSettings.mode&&this.parent.selectRow(this.rowIndex>-1?this.rowIndex:this.editRowIndex),this.parent.hideSpinner()}blazorTemplate(){let cols=this.parent.getColumns();for(let i=0;i<cols.length;i++){let col=cols[i];col.template&&updateBlazorTemplate(this.parent.element.id+col.uid,"Template",col,!1),col.editTemplate&&updateBlazorTemplate(this.parent.element.id+col.uid+"editTemplate","EditTemplate",col)}}editFailure(e){this.parent.trigger(ej2_grids_es2015_actionFailure,e),this.parent.hideSpinner(),this.parent.log("actionfailure",{error:e})}refreshRow(data){let frzCols=this.parent.getFrozenColumns(),row=new ej2_grids_es2015_RowRenderer(this.serviceLocator,null,this.parent),rowObj=this.parent.getRowObjectFromUID(this.uid);if(rowObj&&(rowObj.changes=data,refreshForeignData(rowObj,this.parent.getForeignKeyColumns(),rowObj.changes),row.refresh(rowObj,this.parent.getColumns(),!0),frzCols)){let uid,tr=this.parent.element.querySelector("[data-uid="+rowObj.uid+"]");uid=parentsUntil(tr,"e-frozencontent")||parentsUntil(tr,"e-frozenheader")?this.parent.getMovableRows()[rowObj.index].getAttribute("data-uid"):this.parent.getRows()[rowObj.index].getAttribute("data-uid"),(rowObj=this.parent.getRowObjectFromUID(uid)).changes=data,row.refresh(rowObj,this.parent.columns,!0)}}closeEdit(){if(!this.parent.isEdit)return;let gObj=this.parent,args=extend(this.args,{requestType:"cancel",type:actionBegin,data:this.previousData,selectedRow:gObj.selectedRowIndex});this.blazorTemplate(),gObj.trigger(actionBegin,args,closeEditArgs=>{"Dialog"===this.parent.editSettings.mode&&this.parent.notify(dialogDestroy,{}),gObj.isEdit=!1,this.stopEditStatus(),closeEditArgs.type=actionComplete,"Dialog"!==gObj.editSettings.mode&&this.refreshRow(closeEditArgs.data),gObj.getContentTable().querySelector("tr.e-emptyrow")||gObj.getContentTable().querySelector("tr.e-row")||gObj.renderModule.emptyRow(),"Dialog"!==gObj.editSettings.mode&&gObj.selectRow(this.rowIndex),gObj.trigger(actionComplete,closeEditArgs),isBlazor()&&(this.parent.notify(toolbarRefresh,{}),this.parent.notify("close-edit",{}))})}addRecord(data,index){let gObj=this.parent;this.addedRowIndex=index=isNullOrUndefined(index)?0:index,data?gObj.notify(modelChanged,{requestType:"save",type:actionBegin,data:data,selectedRow:0,action:"add",index:index}):gObj.isEdit||(this.previousData={},this.uid="",gObj.columnModel.forEach(col=>{col.field&&ej2_data_es2015_DataUtil.setValue(col.field,col.defaultValue,this.previousData)}),gObj.trigger(actionBegin,{cancel:!1,foreignKeyData:{},requestType:"add",data:this.previousData,type:actionBegin,index:index,rowData:this.previousData,target:void 0},addArgs=>{addArgs.cancel||(gObj.isEdit=!0,"Dialog"!==gObj.editSettings.mode&&gObj.clearSelection(),this.renderer.addNew(addArgs),gObj.editModule.applyFormValidation(),addArgs.type=actionComplete,addArgs.row=gObj.element.querySelector(".e-addedrow"),gObj.trigger(actionComplete,addArgs),isBlazor()&&(this.parent.notify(toolbarRefresh,{}),this.parent.notify("start-add",{})),this.args=addArgs)}))}deleteRecord(fieldname,data){if(this.editRowIndex=this.parent.selectedRowIndex,data){data=data instanceof Array?data:[data];let gObj=this.parent,dataLen=Object.keys(data).length;fieldname=fieldname||this.parent.getPrimaryKeyFieldNames()[0];for(let i=0;i<dataLen;i++){let tmpRecord,contained=gObj.currentViewData.some(record=>(tmpRecord=record,data[i]===ej2_grids_es2015_getObject(fieldname,record)||data[i]===record));data[i]=contained?tmpRecord:{[fieldname]:data[i]}}}let args={requestType:"delete",type:actionBegin,foreignKeyData:{},data:data||this.parent.getSelectedRecords(),tr:this.parent.getSelectedRows(),cancel:!1};isBlazor()&&!this.parent.isJsComponent&&(args.data=args.data[0]),this.parent.notify(modelChanged,args)}stopEditStatus(){let mElem,editMElem,gObj=this.parent,elem=gObj.element.querySelector(".e-addedrow");gObj.getFrozenColumns()&&(mElem=gObj.element.querySelectorAll(".e-addedrow")[1],editMElem=gObj.element.querySelectorAll(".e-editedrow")[1],mElem&&ej2_base_es2015_remove(mElem),editMElem&&editMElem.classList.remove("e-editedrow")),elem&&ej2_base_es2015_remove(elem),(elem=gObj.element.querySelector(".e-editedrow"))&&elem.classList.remove("e-editedrow")}addEventListener(){this.parent.isDestroyed||(this.parent.on(crudAction,this.editHandler,this),this.parent.on(doubleTap,this.dblClickHandler,this),this.parent.on(click,this.clickHandler,this),this.parent.on(recordAdded,this.requestSuccess,this),this.parent.on(dblclick,this.dblClickHandler,this),this.parent.on(deleteComplete,this.editComplete,this),this.parent.on(saveComplete,this.editComplete,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(crudAction,this.editHandler),this.parent.off(doubleTap,this.dblClickHandler),this.parent.off(click,this.clickHandler),this.parent.off(recordAdded,this.requestSuccess),this.parent.off(dblclick,this.dblClickHandler),this.parent.off(deleteComplete,this.editComplete),this.parent.off(saveComplete,this.editComplete))}destroy(){this.removeEventListener(),this.renderer.destroy()}}class InlineEdit extends ej2_grids_es2015_NormalEdit{constructor(parent,serviceLocator,renderer){super(parent,serviceLocator),this.parent=parent,this.serviceLocator=serviceLocator,this.renderer=renderer}closeEdit(){super.closeEdit()}addRecord(data,index){super.addRecord(data,index)}endEdit(){super.endEdit()}updateRow(index,data){super.updateRow(index,data)}deleteRecord(fieldname,data){super.deleteRecord(fieldname,data)}startEdit(tr){super.startEdit(tr)}}class ej2_grids_es2015_BatchEdit{constructor(parent,serviceLocator,renderer){this.cellDetails={},this.parent=parent,this.serviceLocator=serviceLocator,this.renderer=renderer,this.focus=serviceLocator.getService("focus"),this.addEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on(click,this.clickHandler,this),this.parent.on(dblclick,this.dblClickHandler,this),this.parent.on(beforeCellFocused,this.onBeforeCellFocused,this),this.parent.on(cellFocused,this.onCellFocused,this),this.dataBoundFunction=this.dataBound.bind(this),this.parent.addEventListener(dataBound,this.dataBoundFunction),this.parent.on(doubleTap,this.dblClickHandler,this),this.parent.on(keyPressed,this.keyDownHandler,this),this.parent.on(editNextValCell,this.editNextValCell,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(click,this.clickHandler),this.parent.off(dblclick,this.dblClickHandler),this.parent.off(beforeCellFocused,this.onBeforeCellFocused),this.parent.off(cellFocused,this.onCellFocused),this.parent.removeEventListener(dataBound,this.dataBoundFunction),this.parent.off(doubleTap,this.dblClickHandler),this.parent.off(keyPressed,this.keyDownHandler),this.parent.off(editNextValCell,this.editNextValCell))}dataBound(){this.parent.notify(toolbarRefresh,{})}destroy(){this.removeEventListener()}clickHandler(e){parentsUntil(e.target,this.parent.element.id+"_add",!0)||(this.parent.isEdit&&(this.saveCell(),this.editNextValCell()),parentsUntil(e.target,"e-rowcell")&&!this.parent.isEdit&&this.setCellIdx(e.target))}dblClickHandler(e){let target=parentsUntil(e.target,"e-rowcell"),tr=parentsUntil(e.target,"e-row");target&&tr&&!isNaN(parseInt(target.getAttribute("aria-colindex"),10))&&!target.parentElement.classList.contains("e-editedrow")&&this.editCell(parseInt(tr.getAttribute("aria-rowindex"),10),this.parent.getColumns()[parseInt(target.getAttribute("aria-colindex"),10)].field,this.isAddRow(parseInt(tr.getAttribute("aria-rowindex"),10)))}onBeforeCellFocused(e){this.parent.isEdit&&this.validateFormObj()&&(e.byClick||["tab","shiftTab","enter","shiftEnter"].indexOf(e.keyArgs.action)>-1)&&(e.cancel=!0,e.byClick?e.clickArgs.preventDefault():e.keyArgs.preventDefault())}onCellFocused(e){let frzCols=this.parent.getFrozenColumns(),mCont=this.parent.getContent().querySelector(".e-movablecontent"),mHdr=this.parent.getHeaderContent().querySelector(".e-movableheader"),clear=!(e.container.isContent&&e.container.isDataCell||this.parent.frozenRows&&e.container.isHeader);if(!e.byKey||clear)return void(this.parent.isEdit&&clear&&this.saveCell());let[rowIndex,cellIndex]=e.container.indexes;frzCols&&(mCont.contains(e.element)||this.parent.frozenRows&&mHdr.contains(e.element))&&(cellIndex+=frzCols),this.parent.frozenRows&&e.container.isContent&&(rowIndex+=this.parent.frozenRows);let isEdit=this.parent.isEdit;if(!this.parent.element.querySelectorAll(".e-popup-open").length)switch(isEdit=isEdit&&!this.validateFormObj(),e.keyArgs.action){case"tab":case"shiftTab":(isEdit||this.parent.isLastCellPrimaryKey)&&this.editCellFromIndex(rowIndex,cellIndex);break;case"enter":case"shiftEnter":e.keyArgs.preventDefault(),isEdit&&this.editCell(rowIndex,this.cellDetails.column.field);break;case"f2":this.editCellFromIndex(rowIndex,cellIndex),this.focus.focus()}}isAddRow(index){return this.parent.getDataRows()[index].classList.contains("e-insertedrow")}editCellFromIndex(rowIdx,cellIdx){this.cellDetails.rowIndex=rowIdx,this.cellDetails.cellIndex=cellIdx,this.editCell(rowIdx,this.parent.getColumns()[cellIdx].field,this.isAddRow(rowIdx))}closeEdit(){let gObj=this.parent,rows=this.parent.getRowsObject(),argument={cancel:!1,batchChanges:this.getBatchChanges()};if(gObj.notify(beforeBatchCancel,argument),argument.cancel)return;gObj.frozenColumns&&rows.length<2*this.parent.currentViewData.length&&rows.push.apply(rows,this.parent.getMovableRowsObject());let cols=this.parent.getColumns();if(isBlazor())for(let i=0;i<cols.length;i++){let col=cols[i];col.template&&updateBlazorTemplate(this.parent.element.id+col.uid,"Template",col,!1)}let tr,mTr,movObj,rowRenderer=new ej2_grids_es2015_RowRenderer(this.serviceLocator,null,this.parent);gObj.isEdit&&this.saveCell(!0),this.isAdded=!1,gObj.clearSelection();for(let i=0;i<rows.length;i++)if(rows[i].isDirty&&(gObj.frozenColumns&&((movObj=gObj.getMovableRowsObject()[rows[i].index]).isDirty=!0),tr=gObj.getContentTable().querySelector("[data-uid="+rows[i].uid+"]"),gObj.frozenRows&&!tr&&(tr=gObj.getHeaderContent().querySelector("[data-uid="+rows[i].uid+"]")),gObj.frozenColumns&&(gObj.frozenRows&&(mTr=gObj.getHeaderContent().querySelector(".e-movableheader").querySelector("[data-uid="+rows[i].uid+"]"))||(mTr=gObj.getContent().querySelector(".e-movablecontent").querySelector("[data-uid="+rows[i].uid+"]"))),tr||mTr))if(tr&&tr.classList.contains("e-insertedrow")||mTr&&mTr.classList.contains("e-insertedrow"))tr&&ej2_base_es2015_remove(tr),mTr&&(gObj.frozenColumns||gObj.frozenRows)&&ej2_base_es2015_remove(mTr),this.removeRowObjectFromUID(rows[i].uid),i--;else if(refreshForeignData(rows[i],this.parent.getForeignKeyColumns(),rows[i].data),delete rows[i].changes,delete rows[i].edit,rows[i].isDirty=!1,ej2_base_es2015_classList(mTr||tr,[],["e-hiddenrow","e-updatedtd"]),rowRenderer.refresh(rows[i],gObj.getColumns(),!1),this.parent.aggregates.length>0){let editType=[];editType.type="cancel",this.parent.notify(refreshFooterRenderer,editType),this.parent.groupSettings.columns.length>0&&this.parent.notify(groupAggregates,editType)}gObj.getContentTable().querySelector("tr.e-row")||gObj.renderModule.renderEmptyRow();let args={requestType:"batchCancel",rows:this.parent.getRowsObject()};gObj.notify(batchCancel,{rows:this.parent.getRowsObject().length?this.parent.getRowsObject():[new ej2_grids_es2015_Row({isDataRow:!0,cells:[new ej2_grids_es2015_Cell({isDataCell:!0,visible:!0})]})]}),gObj.selectRow(this.cellDetails.rowIndex),this.refreshRowIdx(),gObj.notify(toolbarRefresh,{}),this.parent.notify(tooltipDestroy,{}),args={requestType:"batchCancel",rows:this.parent.getRowsObject()},gObj.trigger(batchCancel,args),gObj.frozenColumns&&rows.splice(this.parent.getMovableRowsObject().length,rows.length)}deleteRecord(fieldname,data){this.saveCell(),this.validateFormObj()&&this.saveCell(!0),this.isAdded=!1,this.bulkDelete(fieldname,data),this.parent.aggregates.length>0&&(this.parent.notify(refreshFooterRenderer,{}),this.parent.groupSettings.columns.length>0&&this.parent.notify(groupAggregates,{}))}addRecord(data){this.bulkAddRow(data)}endEdit(data){this.parent.isEdit&&this.validateFormObj()||this.batchSave()}validateFormObj(){return this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate()}batchSave(){let gObj=this.parent;if(gObj.isCheckBoxSelection){let checkAllBox=gObj.element.querySelector(".e-checkselectall").parentElement;checkAllBox.classList.contains("e-checkbox-disabled")&&gObj.pageSettings.totalRecordsCount>gObj.currentViewData.length&&removeClass([checkAllBox],["e-checkbox-disabled"])}let cols=this.parent.getColumns();if(isBlazor())for(let i=0;i<cols.length;i++){let col=cols[i];col.template&&(blazorTemplates[this.parent.element.id+col.uid]=[],resetBlazorTemplate(this.parent.element.id+col.uid))}if(this.saveCell(),gObj.isEdit||this.editNextValCell()||gObj.isEdit)return;let changes=this.getBatchChanges();"Multiple"===this.parent.selectionSettings.type&&changes.deletedRecords.length&&(changes.deletedRecords=changes.deletedRecords.concat(this.removeSelectedData),this.removeSelectedData=[]);let original={changedRecords:this.parent.getRowsObject().filter(row=>row.isDirty&&-1===["add","delete"].indexOf(row.edit)).map(row=>row.data)};gObj.trigger(beforeBatchSave,{batchChanges:changes,cancel:!1},beforeBatchSaveArgs=>{beforeBatchSaveArgs.cancel||(gObj.showSpinner(),gObj.notify(bulkSave,{changes:changes,original:original}))})}getBatchChanges(){let changes={addedRecords:[],deletedRecords:[],changedRecords:[]},rows=this.parent.getRowsObject(),mRows=this.parent.getMovableRowsObject(),frzCols=this.parent.getFrozenColumns();for(let row of rows)if(frzCols&&this.mergeBatchChanges(row,mRows[row.index],frzCols),row.isDirty)switch(row.edit){case"add":changes.addedRecords.push(row.changes);break;case"delete":changes.deletedRecords.push(row.data);break;default:changes.changedRecords.push(row.changes)}return changes}mergeBatchChanges(row,mRow,frzCols){if(row.isDirty){if(mRow.isDirty){let i=0;Object.keys(row.changes).forEach(key=>{i>=frzCols&&(row.changes[key]=mRow.changes[key]),i++})}}else mRow.isDirty&&(row.changes=mRow.changes,row.isDirty=mRow.isDirty)}removeRowObjectFromUID(uid){let rows=this.parent.getRowsObject(),i=0;for(let len=rows.length;i<len&&rows[i].uid!==uid;i++);rows.splice(i,1)}addRowObject(row){let isTop="Top"===this.parent.editSettings.newRowPosition;isTop?this.parent.getRowsObject().unshift(row):this.parent.getRowsObject().push(row);let mRow=this.parent.getMovableRowsObject();this.parent.getFrozenColumns()&&!mRow.length&&(isTop?mRow.unshift(row):mRow.push(row))}bulkDelete(fieldname,data){this.removeSelectedData=[];let gObj=this.parent;data&&gObj.selectRow(this.getIndexFromData(data));let index=gObj.selectedRowIndex,selectedRows=gObj.getSelectedRows(),args={primaryKey:this.parent.getPrimaryKeyFieldNames(),rowIndex:index,rowData:data||gObj.getSelectedRecords()[0],cancel:!1};(isBlazor()&&!this.parent.isJsComponent||(args.row=data?gObj.getRows()[index]:selectedRows[0],args.row))&&gObj.trigger(beforeBatchDelete,args,beforeBatchDeleteArgs=>{if(!beforeBatchDeleteArgs.cancel){if(beforeBatchDeleteArgs.row=beforeBatchDeleteArgs.row?beforeBatchDeleteArgs.row:data?gObj.getRows()[index]:selectedRows[0],this.parent.frozenColumns||1===selectedRows.length){let uid=beforeBatchDeleteArgs.row.getAttribute("data-uid");if(beforeBatchDeleteArgs.row.classList.contains("e-insertedrow"))this.removeRowObjectFromUID(uid),ej2_base_es2015_remove(beforeBatchDeleteArgs.row);else{let rowObj=gObj.getRowObjectFromUID(uid);rowObj.isDirty=!0,rowObj.edit="delete",ej2_base_es2015_classList(beforeBatchDeleteArgs.row,["e-hiddenrow","e-updatedtd"],[]),gObj.getFrozenColumns()?(ej2_base_es2015_classList(data?gObj.getMovableRows()[index]:selectedRows[1],["e-hiddenrow","e-updatedtd"],[]),gObj.frozenRows&&index<gObj.frozenRows&&gObj.getMovableDataRows().length>=gObj.frozenRows&&(gObj.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").appendChild(gObj.getMovableRowByIndex(gObj.frozenRows-1)),gObj.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody").appendChild(gObj.getRowByIndex(gObj.frozenRows-1)))):gObj.frozenRows&&index<gObj.frozenRows&&gObj.getDataRows().length>=gObj.frozenRows&&gObj.getHeaderContent().querySelector("tbody").appendChild(gObj.getRowByIndex(gObj.frozenRows-1))}delete beforeBatchDeleteArgs.row}else for(let i=0;i<selectedRows.length;i++){let uniqueid=selectedRows[i].getAttribute("data-uid");if(selectedRows[i].classList.contains("e-insertedrow"))this.removeRowObjectFromUID(uniqueid),ej2_base_es2015_remove(selectedRows[i]);else{ej2_base_es2015_classList(selectedRows[i],["e-hiddenrow","e-updatedtd"],[]);let selectedRow=gObj.getRowObjectFromUID(uniqueid);selectedRow.isDirty=!0,selectedRow.edit="delete",delete selectedRows[i]}}this.refreshRowIdx(),this.removeSelectedData=gObj.getSelectedRecords(),gObj.clearSelection(),gObj.selectRow(index),gObj.trigger(batchDelete,beforeBatchDeleteArgs),gObj.notify(batchDelete,{rows:this.parent.getRowsObject()}),gObj.notify(toolbarRefresh,{})}})}refreshRowIdx(){let rows=[],mRows=[],nonMovableRows=[],frzCols=this.parent.getFrozenColumns();if(this.parent.frozenRows&&(rows=[].slice.call(this.parent.getHeaderTable().querySelector("tbody").children),frzCols)){mRows=[].slice.call(this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").children);for(let i=0;i<mRows.length;i++)nonMovableRows[i]=this.parent.createElement("tr",{className:"emptynonmv"})}frzCols&&(mRows=mRows.concat([].slice.call(this.parent.getContentTable().querySelector("tbody").children)),nonMovableRows=nonMovableRows.concat([].slice.call(this.parent.element.querySelector(".e-movablecontent").querySelector("tbody").children)));for(let i=0,j=0,len=(rows=rows.concat([].slice.call(this.parent.getContentTable().querySelector("tbody").children))).length;i<len;i++)rows[i].classList.contains("e-row")&&!rows[i].classList.contains("e-hiddenrow")?(rows[i].setAttribute("aria-rowindex",j.toString()),frzCols&&(mRows[i].setAttribute("aria-rowindex",j.toString()),nonMovableRows[i].classList.contains("e-row")&&nonMovableRows[i].setAttribute("aria-rowindex",j.toString())),j++):(rows[i].removeAttribute("aria-rowindex"),frzCols&&mRows[i].removeAttribute("aria-rowindex"))}getIndexFromData(data){return inArray(data,this.parent.getCurrentViewRecords())}bulkAddRow(data){let gObj=this.parent;if(!gObj.editSettings.allowAdding)return;if(gObj.isEdit&&(this.saveCell(),this.parent.notify(editNextValCell,{})),gObj.isEdit)return;let args={defaultData:data||this.getDefaultData(),primaryKey:gObj.getPrimaryKeyFieldNames(),cancel:!1};gObj.trigger(beforeBatchAdd,args,beforeBatchAddArgs=>{if(beforeBatchAddArgs.cancel)return;let mTr,mTbody;this.isAdded=!0,gObj.clearSelection();let col,index,row=new ej2_grids_es2015_RowRenderer(this.serviceLocator,null,this.parent),modelData=new ej2_grids_es2015_RowModelGenerator(this.parent).generateRows([beforeBatchAddArgs.defaultData]),tr=row.render(modelData[0],gObj.getColumns());for(let i=0;i<this.parent.groupSettings.columns.length;i++)tr.insertBefore(this.parent.createElement("td",{className:"e-indentcell"}),tr.firstChild),modelData[0].cells.unshift(new ej2_grids_es2015_Cell({cellType:CellType.Indent}));let tbody=gObj.getContentTable().querySelector("tbody");tr.classList.add("e-insertedrow"),tbody.querySelector(".e-emptyrow")&&tbody.querySelector(".e-emptyrow").remove(),gObj.getFrozenColumns()&&(mTr=this.renderMovable(tr),mTbody=gObj.frozenRows&&"Top"===gObj.editSettings.newRowPosition?gObj.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):gObj.getContent().querySelector(".e-movablecontent").querySelector("tbody"),"Top"===this.parent.editSettings.newRowPosition?mTbody.insertBefore(mTr,mTbody.firstChild):mTbody.appendChild(mTr),addClass(mTr.querySelectorAll(".e-rowcell"),["e-updatedtd"]),"auto"===this.parent.height&&this.parent.notify(frozenHeight,{})),tbody=gObj.frozenRows&&"Top"===gObj.editSettings.newRowPosition?gObj.getHeaderContent().querySelector("tbody"):gObj.getContent().querySelector("tbody"),"Top"===this.parent.editSettings.newRowPosition?tbody.insertBefore(tr,tbody.firstChild):tbody.appendChild(tr),addClass(tr.querySelectorAll(".e-rowcell"),["e-updatedtd"]),modelData[0].isDirty=!0,modelData[0].changes=extend({},{},modelData[0].data,!0),modelData[0].edit="add",this.addRowObject(modelData[0]),this.refreshRowIdx(),this.focus.forgetPrevious(),gObj.notify(batchAdd,{rows:this.parent.getRowsObject(),args:{isFrozen:this.parent.getFrozenColumns()}});let changes=this.getBatchChanges();gObj.selectRow("Top"===this.parent.editSettings.newRowPosition?0:this.parent.getCurrentViewRecords().length+changes.addedRecords.length-1),data||(index=this.findNextEditableCell(0,!0),col=gObj.getColumns()[index],this.editCell("Top"===this.parent.editSettings.newRowPosition?0:this.parent.getCurrentViewRecords().length+changes.addedRecords.length-1,col.field,!0)),this.parent.aggregates.length>0&&data&&this.parent.notify(refreshFooterRenderer,{}),gObj.trigger(batchAdd,{defaultData:beforeBatchAddArgs.defaultData,row:tr,columnObject:col,columnIndex:index,primaryKey:beforeBatchAddArgs.primaryKey,cell:tr.cells[index]}),isBlazor()&&(this.parent.notify(toolbarRefresh,{}),this.parent.notify("start-add",{}))})}renderMovable(ele){let mEle=ele.cloneNode(!0);for(let i=0;i<this.parent.frozenColumns;i++)mEle.removeChild(mEle.children[0]);for(let i=this.parent.frozenColumns,len=ele.childElementCount;i<len;i++)ele.removeChild(ele.children[ele.childElementCount-1]);return mEle}findNextEditableCell(columnIndex,isAdd,isValOnly){let validation,cols=this.parent.getColumns(),endIndex=cols.length;for(let i=columnIndex;i<endIndex;i++){if(validation=!!isValOnly&&isNullOrUndefined(cols[i].validationRules),!isAdd&&this.checkNPCell(cols[i]))return i;if(isAdd&&!cols[i].template&&cols[i].visible&&cols[i].allowEditing&&(!cols[i].isIdentity||!cols[i].isPrimaryKey)&&!validation)return i}return-1}checkNPCell(col){return!col.template&&col.visible&&!col.isPrimaryKey&&!col.isIdentity&&col.allowEditing}getDefaultData(){let gObj=this.parent,data={},dValues={number:0,string:null,boolean:!1,date:null,datetime:null};for(let col of gObj.columnModel)col.field&&setValue(col.field,col.defaultValue?col.defaultValue:dValues[col.type],data);return data}setCellIdx(target){let gLen=0;this.parent.allowGrouping&&(gLen=this.parent.groupSettings.columns.length),this.cellDetails.cellIndex=target.cellIndex-gLen,this.cellDetails.rowIndex=parseInt(target.getAttribute("index"),10)}editCell(index,field,isAdd){let gObj=this.parent,col=gObj.getColumnByField(field),keys=gObj.getPrimaryKeyFieldNames();if(isBlazor()&&col.template&&!isAdd&&resetBlazorTemplate(this.parent.element.id+col.uid,0,index),gObj.editSettings.allowEditing&&col.allowEditing){if(gObj.isEdit&&(this.cellDetails.column.field!==field||this.cellDetails.rowIndex!==index||this.parent.getDataRows().length-1===index)&&(this.saveCell(),this.cellDetails.rowIndex===index&&this.cellDetails.column.field===field))return;if(gObj.isEdit)return;let row,rowData,mRowData,colIdx=gObj.getColumnIndexByField(field),frzCols=gObj.getFrozenColumns();if(frzCols&&colIdx>=frzCols?(row=gObj.getMovableDataRows()[index],mRowData=this.parent.getRowObjectFromUID(this.parent.getMovableDataRows()[index].getAttribute("data-uid")),rowData=extend({},{},mRowData.changes?mRowData.changes:this.getDataByIndex(index),!0)):(row=gObj.getDataRows()[index],rowData=extend({},{},this.getDataByIndex(index),!0)),keys[0]===col.field&&!row.classList.contains("e-insertedrow")||col.columns||col.isPrimaryKey&&col.isIdentity)return void(this.parent.isLastCellPrimaryKey=!0);this.parent.isLastCellPrimaryKey=!1;let rowObj=gObj.getRowObjectFromUID(row.getAttribute("data-uid")),cells=[].slice.apply(row.cells),args={columnName:col.field,columnObject:col,isForeignKey:!isNullOrUndefined(col.foreignKeyValue),primaryKey:keys,rowData:rowData,validationRules:extend({},col.validationRules?col.validationRules:{}),value:ej2_grids_es2015_getObject(col.field,rowData),type:isAdd?"add":"edit",cancel:!1,foreignKeyData:rowObj&&rowObj.foreignKeyData};if((!isBlazor()||this.parent.isJsComponent)&&(args.cell=cells[this.getColIndex(cells,this.getCellIdx(col.uid))],args.row=row,!args.cell))return;gObj.trigger(cellEdit,args,cellEditArgs=>{cellEditArgs.cancel||(cellEditArgs.cell=cellEditArgs.cell?cellEditArgs.cell:cells[this.getColIndex(cells,this.getCellIdx(col.uid))],cellEditArgs.row=cellEditArgs.row?cellEditArgs.row:row,this.cellDetails={rowData:rowData,column:col,value:cellEditArgs.value,isForeignKey:cellEditArgs.isForeignKey,rowIndex:index,cellIndex:parseInt(cellEditArgs.cell.getAttribute("aria-colindex"),10),foreignKeyData:cellEditArgs.foreignKeyData},cellEditArgs.cell.classList.contains("e-updatedtd")&&(this.isColored=!0,cellEditArgs.cell.classList.remove("e-updatedtd")),gObj.isEdit=!0,gObj.clearSelection(),gObj.isCheckBoxSelection&&gObj.isPersistSelection||gObj.selectRow(this.cellDetails.rowIndex,!0),this.renderer.update(cellEditArgs),this.parent.notify(batchEditFormRendered,cellEditArgs),this.form=gObj.element.querySelector("#"+gObj.element.id+"EditForm"),gObj.editModule.applyFormValidation([col]),this.parent.element.querySelector(".e-gridpopup").style.display="none")})}}updateCell(rowIndex,field,value){let col=this.parent.getColumnByField(field),index=this.parent.getColumnIndexByField(field);if(col&&!col.isPrimaryKey){let td=this.parent.getDataRows()[rowIndex].querySelectorAll(".e-rowcell")[index];this.parent.getFrozenColumns()&&(td=[].slice.call(this.parent.getDataRows()[rowIndex].querySelectorAll(".e-rowcell")).concat([].slice.call(this.parent.getMovableDataRows()[rowIndex].querySelectorAll(".e-rowcell")))[index]);let rowObj=this.parent.getRowObjectFromUID(td.parentElement.getAttribute("data-uid"));this.refreshTD(td,col,rowObj,value),this.parent.trigger(queryCellInfo,{cell:td,column:col,data:rowObj.changes})}}setChanges(rowObj,field,value){rowObj.changes||(rowObj.changes=extend({},{},rowObj.data,!0)),isNullOrUndefined(field)||ej2_data_es2015_DataUtil.setValue(field,value,rowObj.changes),rowObj.data[field]!==value&&(rowObj.isDirty=!0)}updateRow(index,data){let keys=Object.keys(data);for(let col of keys)this.updateCell(index,col,data[col])}getCellIdx(uid){let cIdx=this.parent.getColumnIndexByUid(uid)+this.parent.groupSettings.columns.length;return isNullOrUndefined(this.parent.detailTemplate)&&isNullOrUndefined(this.parent.childGrid)||cIdx++,this.parent.isRowDragable()&&cIdx++,cIdx}refreshTD(td,column,rowObj,value){let rowcell,cell=new ej2_grids_es2015_CellRenderer(this.parent,this.serviceLocator);this.setChanges(rowObj,column.field,value);let frzCols=this.parent.getFrozenColumns();refreshForeignData(rowObj,this.parent.getForeignKeyColumns(),rowObj.changes),rowcell=frzCols&&this.getCellIdx(column.uid)>=frzCols&&this.parent.getColumns().length===rowObj.cells.length?rowObj.cells.slice(frzCols,rowObj.cells.length):rowObj.cells,cell.refreshTD(td,rowcell[this.getCellIdx(column.uid)-(this.getCellIdx(column.uid)>=frzCols?frzCols:0)],rowObj.changes,{index:this.getCellIdx(column.uid)}),td.classList.add("e-updatedtd"),this.parent.notify(toolbarRefresh,{})}getColIndex(cells,index){let cIdx=0;this.parent.allowGrouping&&this.parent.groupSettings.columns&&(cIdx=this.parent.groupSettings.columns.length),isNullOrUndefined(this.parent.detailTemplate)&&isNullOrUndefined(this.parent.childGrid)||cIdx++,this.parent.isRowDragable()&&cIdx++;for(let m=0;m<cells.length;m++)if(parseInt(cells[m].getAttribute("aria-colindex"),10)===index-cIdx)return m;return-1}editNextValCell(){let gObj=this.parent;if(this.isAdded&&!gObj.isEdit){for(let i=this.cellDetails.cellIndex;i<gObj.getColumns().length;i++){if(gObj.isEdit)return;let index=this.findNextEditableCell(this.cellDetails.cellIndex+1,!0,!0),col=gObj.getColumns()[index];col&&(this.editCell(0,col.field,!0),this.saveCell())}gObj.isEdit||(this.isAdded=!1)}}saveCell(isForceSave){let gObj=this.parent;if(!isForceSave&&(!gObj.isEdit||this.validateFormObj()))return;let tr=parentsUntil(this.form,"e-row"),column=this.cellDetails.column,obj={};obj[column.field]=this.cellDetails.rowData[column.field];let editedData=gObj.editModule.getCurrentEditedData(this.form,obj),cloneEditedData=extend({},editedData);editedData=extend({},editedData,this.cellDetails.rowData);let value=ej2_grids_es2015_getObject(column.field,cloneEditedData);isNullOrUndefined(column.field)||setValue(column.field,value,editedData);let args={columnName:column.field,value:ej2_grids_es2015_getObject(column.field,editedData),rowData:this.cellDetails.rowData,previousValue:this.cellDetails.value,columnObject:column,isForeignKey:this.cellDetails.isForeignKey,cancel:!1};isBlazor()&&!this.parent.isJsComponent||(args.cell=this.form.parentElement),isForceSave?this.successCallBack(args,tr,column)(args):(gObj.trigger(cellSave,args,this.successCallBack(args,tr,column)),gObj.notify(batchForm,{formObj:this.form}))}successCallBack(cellSaveArgs,tr,column){return cellSaveArgs=>{let gObj=this.parent;cellSaveArgs.cell=cellSaveArgs.cell?cellSaveArgs.cell:this.form.parentElement,cellSaveArgs.cancel||(gObj.editModule.destroyForm(),gObj.isEdit=!1,gObj.editModule.destroyWidgets([column]),isBlazor()&&column.template&&!cellSaveArgs.cell.parentElement.classList.contains("e-insertedrow")&&updateBlazorTemplate(gObj.element.id+column.uid,"Template",column,!1),this.parent.notify(tooltipDestroy,{}),this.refreshTD(cellSaveArgs.cell,column,gObj.getRowObjectFromUID(tr.getAttribute("data-uid")),cellSaveArgs.value),removeClass([tr],["e-editedrow","e-batchrow"]),removeClass([cellSaveArgs.cell],["e-editedbatchcell","e-boolcell"]),(!isNullOrUndefined(cellSaveArgs.value)&&cellSaveArgs.value.toString()===(isNullOrUndefined(this.cellDetails.value)?"":this.cellDetails.value).toString()&&!this.isColored||isNullOrUndefined(cellSaveArgs.value)&&isNullOrUndefined(this.cellDetails.value)&&!cellSaveArgs.cell.parentElement.classList.contains("e-insertedrow"))&&cellSaveArgs.cell.classList.remove("e-updatedtd"),gObj.trigger(cellSaved,cellSaveArgs),gObj.notify(toolbarRefresh,{}),this.isColored=!1,this.parent.aggregates.length>0&&(this.parent.notify(refreshFooterRenderer,{}),this.parent.groupSettings.columns.length>0&&!this.isAddRow(this.cellDetails.rowIndex)&&this.parent.notify(groupAggregates,{})))}}getDataByIndex(index){let row=this.parent.getRowObjectFromUID(this.parent.getDataRows()[index].getAttribute("data-uid"));return row.changes?row.changes:row.data}keyDownHandler(e){if(("tab"===e.action||"shiftTab"===e.action)&&this.parent.isEdit){let gObj=this.parent,rowcell=parentsUntil(e.target,"e-rowcell");if(rowcell){let cell=rowcell.querySelector(".e-field");if(cell){let visibleColumns=this.parent.getVisibleColumns();visibleColumns["tab"===e.action?visibleColumns.length-1:0].field===cell.getAttribute("id").slice(this.parent.element.id.length)&&(this.cellDetails.rowIndex!==gObj.getRows().length-1?this.saveCell():"Top"===gObj.editSettings.newRowPosition?(gObj.editSettings.newRowPosition="Bottom",this.addRecord(),gObj.editSettings.newRowPosition="Top"):this.addRecord())}}}}addCancelWhilePaging(){this.validateFormObj()&&(this.parent.notify(destroyForm,{}),this.parent.isEdit=!1,this.isColored=!1)}}class ej2_grids_es2015_DialogEdit extends ej2_grids_es2015_NormalEdit{constructor(parent,serviceLocator,renderer){super(parent,serviceLocator),this.parent=parent,this.serviceLocator=serviceLocator,this.renderer=renderer}closeEdit(){super.closeEdit()}addRecord(data,index){super.addRecord(data,index)}endEdit(){super.endEdit()}updateRow(index,data){super.updateRow(index,data)}deleteRecord(fieldname,data){super.deleteRecord(fieldname,data)}startEdit(tr){super.startEdit(tr)}}class ej2_grids_es2015_DatePickerEditCell{constructor(parent){this.parent=parent}create(args){let complexFieldName=getComplexFieldID(args.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+complexFieldName,name:complexFieldName,type:"text","e-mappinguid":args.column.uid}})}read(element){return element.ej2_instances[0].value}write(args){"datepickeredit"===args.column.editType?this.obj=new ej2_calendars_es2015_DatePicker(extend(dateanddatetimerender(args,this.parent.editSettings.mode,this.parent.enableRtl),args.column.edit.params)):"datetimepickeredit"===args.column.editType&&(this.obj=new ej2_calendars_es2015_DateTimePicker(extend(dateanddatetimerender(args,this.parent.editSettings.mode,this.parent.enableRtl),args.column.edit.params))),this.obj.appendTo(args.element)}destroy(){this.obj&&this.obj.destroy()}}function dateanddatetimerender(args,mode,rtl){let isInline="Dialog"!==mode,format=getCustomDateFormat(args.column.format,args.column.type),value=ej2_grids_es2015_getObject(args.column.field,args.rowData);return{floatLabelType:isInline?"Never":"Always",value:value=value?new Date(value):null,format:format,placeholder:isInline?"":args.column.headerText,enableRtl:rtl,enabled:isEditable(args.column,args.requestType,args.element)}}class TemplateEditCell{constructor(parent){this.parent=parent}read(element,value){return value}write(){}destroy(){}}let ej2_grids_es2015_Edit=(()=>{class Edit{constructor(parent,serviceLocator){this.editType={Inline:InlineEdit,Normal:InlineEdit,Batch:ej2_grids_es2015_BatchEdit,Dialog:ej2_grids_es2015_DialogEdit},this.parent=parent,this.serviceLocator=serviceLocator,this.l10n=this.serviceLocator.getService("localization"),this.addEventListener(),this.updateEditObj(),this.createAlertDlg(),this.createConfirmDlg()}updateColTypeObj(){this.parent.columnModel.forEach(col=>{col.edit=extend(this.parent.editSettings.template||col.editTemplate?new Edit.editCellType.templateedit(this.parent):new Edit.editCellType[col.editType&&Edit.editCellType[col.editType]?col.editType:"defaultedit"](this.parent,this.serviceLocator),col.edit||{})}),this.parent.log("primary_column_missing")}getModuleName(){return"edit"}onPropertyChanged(e){if(e.module!==this.getModuleName())return;let gObj=this.parent;for(let prop of Object.keys(e.properties))switch(prop){case"allowAdding":case"allowDeleting":case"allowEditing":(gObj.editSettings.allowAdding||gObj.editSettings.allowEditing||gObj.editSettings.allowDeleting)&&this.initialEnd();break;case"mode":this.updateEditObj(),gObj.isEdit=!1,gObj.refresh()}}updateEditObj(){this.editModule&&this.editModule.destroy(),this.renderer=new ej2_grids_es2015_EditRender(this.parent,this.serviceLocator),this.editModule=new this.editType[this.parent.editSettings.mode](this.parent,this.serviceLocator,this.renderer)}initialEnd(){this.updateColTypeObj()}wireEvents(){EventHandler.add(this.parent.getContent(),"touchstart",this.tapEvent,this)}unwireEvents(){EventHandler.remove(this.parent.getContent(),"touchstart",this.tapEvent)}tapEvent(e){this.getUserAgent()&&(Global.timer?(clearTimeout(Global.timer),Global.timer=null,this.parent.notify(doubleTap,e)):Global.timer=setTimeout(()=>{Global.timer=null},300))}getUserAgent(){let userAgent=window.navigator.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(userAgent)}startEdit(tr){let gObj=this.parent;if(gObj.editSettings.allowEditing&&!gObj.isEdit&&"Batch"!==gObj.editSettings.mode){if(gObj.getSelectedRows().length)tr||(tr=gObj.getSelectedRows()[0]);else if(!tr)return void this.showDialog("EditOperationAlert",this.alertDObj);"none"!==tr.style.display&&(this.editModule.startEdit(tr),isBlazor()||(this.refreshToolbar(),gObj.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{})))}}closeEdit(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&this.parent.element.querySelectorAll(".e-updatedtd").length?this.showDialog("CancelEdit",this.dialogObj):(this.editModule.closeEdit(),isBlazor()||(this.refreshToolbar(),this.parent.notify("close-edit",{})))}refreshToolbar(){this.parent.notify(toolbarRefresh,{})}addRecord(data,index){this.parent.editSettings.allowAdding&&(this.editModule.addRecord(data,index),isBlazor()||(this.refreshToolbar(),this.parent.notify("start-add",{})))}deleteRecord(fieldname,data){let gObj=this.parent;gObj.editSettings.allowDeleting&&(data||gObj.getSelectedRecords().length?gObj.editSettings.showDeleteConfirmDialog?this.showDialog("ConfirmDelete",this.dialogObj):this.editModule.deleteRecord(fieldname,data):this.showDialog("DeleteOperationAlert",this.alertDObj))}deleteRow(tr){this.deleteRecord(null,this.parent.getCurrentViewRecords()[parseInt(tr.getAttribute("aria-rowindex"),10)])}endEdit(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&(isNullOrUndefined(this.formObj)||this.formObj.validate())&&(this.parent.editModule.saveCell(),this.parent.notify(editNextValCell,{}),isNullOrUndefined(this.formObj)||this.formObj.validate())?this.showDialog("BatchSaveConfirm",this.dialogObj):this.endEditing()}updateCell(rowIndex,field,value){this.editModule.updateCell(rowIndex,field,value)}updateRow(index,data){this.editModule.updateRow(index,data)}batchCancel(){this.closeEdit()}batchSave(){this.endEdit()}editCell(index,field){this.editModule.editCell(index,field)}editFormValidate(){return!!this.formObj&&this.formObj.validate()}getBatchChanges(){return this.editModule.getBatchChanges?this.editModule.getBatchChanges():{}}getCurrentEditCellData(){let obj=this.getCurrentEditedData(this.formObj.element,{});return obj[Object.keys(obj)[0]]}saveCell(){this.editModule.saveCell()}endEditing(){this.editModule.endEdit(),this.refreshToolbar()}showDialog(content,obj){obj.content="<div>"+this.l10n.getConstant(content)+"</div>",obj.dataBind(),obj.show()}getValueFromType(col,value){let val=value;switch(col.type){case"number":val=isNaN(parseFloat(value))?null:parseFloat(value);break;case"boolean":"booleanedit"!==col.editType&&(val=value===this.l10n.getConstant("True")||!0===value);break;case"date":case"datetime":"datepickeredit"!==col.editType&&"datetimepickeredit"!==col.editType&&value&&value.length?val=new Date(value):""===value&&(val=null)}return val}destroyToolTip(){let elements=[].slice.call(this.parent.element.querySelectorAll(".e-griderror"));for(let elem of elements)ej2_base_es2015_remove(elem);this.parent.getContent().firstElementChild.style.position="relative"}createConfirmDlg(){this.dialogObj=this.dlgWidget([{click:this.dlgOk.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.dlgCancel.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}],"EditConfirm")}createAlertDlg(){this.alertDObj=this.dlgWidget([{click:this.alertClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-flat",isPrimary:!0}}],"EditAlert")}alertClick(){this.alertDObj.hide()}dlgWidget(btnOptions,name){let div=this.parent.createElement("div",{id:this.parent.element.id+name});this.parent.element.appendChild(div);let options={showCloseIcon:!1,isModal:!0,visible:!1,closeOnEscape:!0,target:this.parent.element,width:"320px",animationSettings:{effect:"None"}};options.buttons=btnOptions;let obj=new ej2_popups_es2015_Dialog(options);return obj.isStringTemplate=!0,obj.appendTo(div),obj}dlgCancel(){this.dialogObj.hide()}dlgOk(e){switch(this.dialogObj.element.querySelector(".e-dlg-content").firstElementChild.innerText){case this.l10n.getConstant("ConfirmDelete"):this.editModule.deleteRecord();break;case this.l10n.getConstant("CancelEdit"):this.editModule.closeEdit();break;case this.l10n.getConstant("BatchSaveConfirm"):this.endEditing();break;case this.l10n.getConstant("BatchSaveLostChanges"):"Batch"===this.parent.editSettings.mode&&this.editModule.addCancelWhilePaging(),this.executeAction()}this.dlgCancel()}addEventListener(){this.parent.isDestroyed||(this.parent.on(inBoundModelChanged,this.onPropertyChanged,this),this.parent.on(initialEnd,this.initialEnd,this),this.parent.on(keyPressed,this.keyPressHandler,this),this.parent.on(autoCol,this.updateColTypeObj,this),this.parent.on(tooltipDestroy,this.destroyToolTip,this),this.parent.on(preventBatch,this.preventBatch,this),this.parent.on(destroyForm,this.destroyForm,this),this.actionBeginFunction=this.onActionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(actionBegin,this.actionBeginFunction),this.parent.addEventListener(actionComplete,this.actionCompleteFunction),this.parent.on(initialEnd,this.wireEvents,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(inBoundModelChanged,this.onPropertyChanged),this.parent.off(initialEnd,this.initialEnd),this.parent.off(keyPressed,this.keyPressHandler),this.parent.off(autoCol,this.updateColTypeObj),this.parent.off(tooltipDestroy,this.destroyToolTip),this.parent.off(preventBatch,this.preventBatch),this.parent.off(destroyForm,this.destroyForm),this.parent.removeEventListener(actionComplete,this.actionCompleteFunction),this.parent.removeEventListener(actionBegin,this.actionBeginFunction),this.parent.off(initialEnd,this.unwireEvents))}actionComplete(e){["add","beginEdit","save","delete","cancel"].indexOf(e.requestType)<0&&(this.parent.isEdit=!1),this.refreshToolbar()}getCurrentEditedData(form,editedData){let gObj=this.parent;if(gObj.editSettings.template)return[].slice.call(form.elements).forEach(element=>{if(element.hasAttribute("name")){let value,field=function(field=""){return field.replace(/___/g,".")}(element.getAttribute("name")),column=gObj.getColumnByField(field)||{field:field,type:element.getAttribute("type")};"checkbox"===column.type||"boolean"===column.type?value=element.checked:element.value&&(value=element.value,element.ej2_instances&&element.ej2_instances.length&&!isNullOrUndefined(element.ej2_instances[0].value)&&(element.blur(),value=element.ej2_instances[0].value)),column.edit&&"string"==typeof column.edit.read?value=getValue(column.edit.read,window)(element,value):column.edit&&column.edit.read&&(value=column.edit.read(element,value)),value=gObj.editModule.getValueFromType(column,value),ej2_data_es2015_DataUtil.setValue(column.field,value,editedData)}}),editedData;gObj.columnModel.filter(col=>col.editTemplate).forEach(col=>{if(form[getComplexFieldID(col.field)]){let inputElements=[].slice.call(form[getComplexFieldID(col.field)]);(inputElements=inputElements.length?inputElements:[form[getComplexFieldID(col.field)]]).forEach(input=>{let value=this.getValue(col,input,editedData);ej2_data_es2015_DataUtil.setValue(col.field,value,editedData)})}});let inputs=[].slice.call(form.querySelectorAll(".e-field"));for(let i=0,len=inputs.length;i<len;i++){let col=gObj.getColumnByUid(inputs[i].getAttribute("e-mappinguid"));if(col&&col.field){let value=this.getValue(col,inputs[i],editedData);ej2_data_es2015_DataUtil.setValue(col.field,value,editedData)}}return editedData}getValue(col,input,editedData){let value=input.value,gObj=this.parent,temp=col.edit.read;return"checkbox"!==col.type&&"boolean"!==col.type||(value=input.checked),"string"==typeof temp?(temp=getValue(temp,window),value=gObj.editModule.getValueFromType(col,temp(input,value))):value=gObj.editModule.getValueFromType(col,col.edit.read(input,value)),isNullOrUndefined(editedData[col.field])&&""===value&&(value=editedData[col.field]),value}onActionBegin(e){"Batch"!==this.parent.editSettings.mode&&this.formObj&&!this.formObj.isDestroyed&&-1===["filterafteropen","filterbeforeopen","filterchoicerequest","save"].indexOf(e.requestType)&&(this.destroyWidgets(),this.destroyForm())}destroyWidgets(cols){this.parent.editSettings.template&&this.parent.destroyTemplate(["editSettingsTemplate"]),(cols=cols||this.parent.getColumns()).some(column=>!isNullOrUndefined(column.editTemplate))&&this.parent.destroyTemplate(["editTemplate"]);for(let col of cols){let temp=col.edit.destroy;isBlazor()&&col.editTemplate&&resetBlazorTemplate(this.parent.element.id+col.uid+"editTemplate"),col.edit.destroy&&("string"==typeof temp?(temp=getValue(temp,window))():col.edit.destroy())}[].slice.call(this.formObj.element.elements).forEach(element=>{element.hasAttribute("name")&&element.ej2_instances&&element.ej2_instances.length&&!element.ej2_instances[0].isDestroyed&&element.ej2_instances[0].destroy()})}destroyForm(){this.destroyToolTip(),this.formObj&&!this.formObj.isDestroyed&&this.formObj.destroy(),this.destroyToolTip()}destroy(){let gridElement=this.parent.element;if(!gridElement)return;let hasGridChild=!(!gridElement.querySelector(".e-gridheader")||!gridElement.querySelector(".e-gridcontent"));hasGridChild&&this.destroyForm(),this.removeEventListener();let elem=this.dialogObj.element;elem.childElementCount>0&&(this.dialogObj.destroy(),ej2_base_es2015_remove(elem)),(elem=this.alertDObj.element).childElementCount>0&&(this.alertDObj.destroy(),ej2_base_es2015_remove(elem)),hasGridChild&&(this.unwireEvents(),this.editModule&&this.editModule.destroy())}keyPressHandler(e){switch(e.action){case"insert":this.addRecord();break;case"delete":"INPUT"===e.target.tagName&&!e.target.classList.contains("e-checkselect")||document.querySelector(".e-popup-open")||this.deleteRecord();break;case"f2":this.startEdit();break;case"enter":parentsUntil(e.target,"e-unboundcelldiv")||"Batch"===this.parent.editSettings.mode||!(parentsUntil(e.target,"e-gridcontent")||this.parent.frozenRows&&parentsUntil(e.target,"e-headercontent"))||document.querySelectorAll(".e-popup-open").length||(e.preventDefault(),this.endEdit());break;case"escape":this.closeEdit()}}preventBatch(args){this.preventObj=args,this.showDialog("BatchSaveLostChanges",this.dialogObj)}executeAction(){this.preventObj.handler.call(this.preventObj.instance,this.preventObj.arg1,this.preventObj.arg2,this.preventObj.arg3,this.preventObj.arg4,this.preventObj.arg5,this.preventObj.arg6,this.preventObj.arg7,this.preventObj.arg8)}applyFormValidation(cols){let gObj=this.parent,frzCols=gObj.getFrozenColumns(),form="Dialog"!==this.parent.editSettings.mode?gObj.element.querySelector(".e-gridform"):document.querySelector("#"+gObj.element.id+"_dialogEdit_wrapper").querySelector(".e-gridform"),mForm=gObj.element.querySelectorAll(".e-gridform")[1],rules={},mRules={};(cols=cols||gObj.getColumns()).forEach((col,index)=>{col.visible&&(index<frzCols&&col.validationRules?rules[getComplexFieldID(col.field)]=col.validationRules:index>=frzCols&&col.validationRules&&(mRules[getComplexFieldID(col.field)]=col.validationRules))}),frzCols&&"Dialog"!==this.parent.editSettings.mode?this.parent.editModule.mFormObj=this.createFormObj(mForm,mRules):rules=extend(rules,mRules),this.parent.editModule.formObj=this.createFormObj(form,rules)}createFormObj(form,rules){return new ej2_inputs_es2015_FormValidator(form,{rules:rules,locale:this.parent.locale,validationComplete:args=>{this.validationComplete(args)},customPlacement:(inputElement,error)=>{this.valErrorPlacement(inputElement,error)}})}valErrorPlacement(inputElement,error){if(this.parent.isEdit){let id=error.getAttribute("for"),elem=this.getElemTable(inputElement).querySelector("#"+id+"_Error");elem?elem.querySelector(".e-tip-content").innerHTML=error.outerHTML:this.createTooltip(inputElement,error,id,"")}}getElemTable(inputElement){let isFHdr;return"Dialog"!==this.parent.editSettings.mode&&(isFHdr=this.parent.frozenRows&&this.parent.frozenRows>(parseInt(closest(inputElement,".e-row").getAttribute("aria-rowindex"),10)||0)),"Dialog"!==this.parent.editSettings.mode?isFHdr?this.parent.getHeaderTable():this.parent.getContentTable():document.querySelector("#"+this.parent.element.id+"_dialogEdit_wrapper")}validationComplete(args){if(this.parent.isEdit){let elem=this.getElemTable(args.element).querySelector("#"+args.inputName+"_Error");elem&&(elem.style.display="failure"===args.status?"":"none")}}createTooltip(element,error,name,display){let isFHdr,gcontent=this.parent.getContent().firstElementChild,isScroll=gcontent.scrollHeight>gcontent.clientHeight||gcontent.scrollWidth>gcontent.clientWidth,isInline="Dialog"!==this.parent.editSettings.mode;isInline&&(isFHdr=this.parent.frozenRows&&this.parent.frozenRows>(parseInt(closest(element,".e-row").getAttribute("aria-rowindex"),10)||0));let fCont=this.parent.getContent().querySelector(".e-frozencontent"),table=isInline?isFHdr?this.parent.getHeaderTable():this.parent.getContentTable():document.querySelector("#"+this.parent.element.id+"_dialogEdit_wrapper").querySelector(".e-dlg-content"),client=table.getBoundingClientRect(),left=isInline?this.parent.element.getBoundingClientRect().left:client.left,input=closest(element,"td"),inputClient=input?input.getBoundingClientRect():element.parentElement.getBoundingClientRect(),div=this.parent.createElement("div",{className:"e-tooltip-wrap e-lib e-control e-popup e-griderror",id:name+"_Error",styles:"display:"+display+";top:"+((isFHdr?inputClient.top+inputClient.height:inputClient.bottom-client.top-(this.parent.getFrozenColumns()?fCont.scrollTop:0))+table.scrollTop+9)+"px;left:"+(inputClient.left-left+table.scrollLeft+inputClient.width/2)+"px;max-width:"+inputClient.width+"px;text-align:center;"});isInline&&client.left<left&&(div.style.left=parseInt(div.style.left,10)-client.left+left+"px");let validationForBottomRowPos,arrow,content=this.parent.createElement("div",{className:"e-tip-content"});content.appendChild(error),"Bottom"===this.parent.editSettings.newRowPosition&&"Dialog"!==this.parent.editSettings.mode&&(this.editModule.args&&"add"===this.editModule.args.requestType||this.editModule.isAdded)&&(validationForBottomRowPos=!0),validationForBottomRowPos?((arrow=this.parent.createElement("div",{className:"e-arrow-tip e-tip-bottom"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-bottom"})),arrow.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-bottom"}))):((arrow=this.parent.createElement("div",{className:"e-arrow-tip e-tip-top"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),arrow.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-top"}))),div.appendChild(content),div.appendChild(arrow),this.formObj.element.appendChild(div),isInline&&gcontent.getBoundingClientRect().bottom<inputClient.bottom+inputClient.height&&(gcontent.scrollTop=gcontent.scrollTop+div.offsetHeight+arrow.scrollHeight);let lineHeight=parseInt(document.defaultView.getComputedStyle(div,null).getPropertyValue("font-size"),10);if(div.getBoundingClientRect().width<inputClient.width&&div.querySelector("label").getBoundingClientRect().height/(1.2*lineHeight)>=2&&(div.style.width=div.style.maxWidth),div.style.left=parseInt(div.style.left,10)-div.offsetWidth/2+"px",!isScroll&&isInline&&!this.parent.allowPaging){gcontent.style.position="static";let pos=calculateRelativeBasedPosition(input,div);div.style.top=pos.top+inputClient.height+9+"px"}if(validationForBottomRowPos){if(isScroll){let scrollElem=this.parent.getContent().firstElementChild,scrollWidth=scrollElem.scrollWidth>scrollElem.offsetWidth?getScrollBarWidth():0;div.style.bottom=this.parent.height-this.parent.getContentTable().offsetHeight-scrollWidth+inputClient.height+9+"px"}else div.style.bottom=inputClient.height+9+"px";div.style.top=null}}checkColumnIsGrouped(col){return!(col.visible||this.parent.groupSettings.columns.indexOf(col.field)>-1)}static AddEditors(editors){Edit.editCellType=extend(Edit.editCellType,editors)}}return Edit.editCellType={dropdownedit:ej2_grids_es2015_DropDownEditCell,numericedit:ej2_grids_es2015_NumericEditCell,datepickeredit:ej2_grids_es2015_DatePickerEditCell,datetimepickeredit:ej2_grids_es2015_DatePickerEditCell,booleanedit:ej2_grids_es2015_BooleanEditCell,defaultedit:ej2_grids_es2015_DefaultEditCell,templateedit:TemplateEditCell},Edit})();var Global;!function(Global){Global.timer=null}(Global||(Global={}));class ej2_grids_es2015_ExportHelper{constructor(parent){this.hideColumnInclude=!1,this.foreignKeyData={},this.parent=parent}static getQuery(parent,data){return data.isRemote()?data.generateQuery(!0).requiresCount().take(parent.pageSettings.totalRecordsCount):data.generateQuery(!0).requiresCount()}getFData(value,column){return getForeignData(column,{},value,this.foreignKeyData[column.field])[0]}getGridRowModel(columns,dataSource,gObj,startIndex=0){let rows=[],length=dataSource.length;if(length){for(let i=0;i<length;i++,startIndex++){let options={isExpand:!1};options.data=dataSource[i],options.index=startIndex,gObj.childGrid&&("All"===gObj.hierarchyPrintMode?options.isExpand=!0:"Expanded"===gObj.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[startIndex]&&(options.isExpand=gObj.expandedRows[startIndex].isExpand));let row=new ej2_grids_es2015_Row(options);row.cells=this.generateCells(columns,gObj),rows.push(row)}this.processColumns(rows)}return rows}generateCells(columns,gObj){let cells=[];if(gObj.childGridLevel){let len=gObj.childGridLevel;for(let i=0;len>i;i++)cells.push(this.generateCell({},CellType.Indent))}for(const col of columns)cells.push(this.generateCell(col,CellType.Data));return cells}getColumnData(gridObj){let promise,columnPromise=[],fColumns=gridObj.getForeignKeyColumns();return fColumns.length&&(fColumns.forEach(col=>{columnPromise.push(col.dataSource.executeQuery(new ej2_data_es2015_Query))}),promise=Promise.all(columnPromise).then(e=>{fColumns.forEach((col,index)=>{this.foreignKeyData[col.field]=e[index].result})})),promise}getHeaders(columns,isHideColumnInclude){this.hideColumnInclude=!!isHideColumnInclude,this.colDepth=measureColumnDepth(columns);let rows=[];for(let i=0;i<this.colDepth;i++)rows[i]=new ej2_grids_es2015_Row({}),rows[i].cells=[];return rows=this.processColumns(rows),{rows:rows=this.processHeaderCells(rows),columns:this.generateActualColumns(columns)}}getConvertedWidth(input){let value=parseFloat(input);return-1!==input.indexOf("%")?this.parent.element.getBoundingClientRect().width*value/100:value}generateActualColumns(columns,actualColumns=[]){for(const column of columns)column.commands||(column.columns?(column.visible||this.hideColumnInclude)&&0!==this.getCellCount(column,0)&&this.generateActualColumns(column.columns,actualColumns):(column.visible||this.hideColumnInclude)&&actualColumns.push(column));return actualColumns}processHeaderCells(rows){let columns=this.parent.columns;for(let i=0;i<columns.length;i++)columns[i].commands||(rows=this.appendGridCells(columns[i],rows,0));return rows}appendGridCells(cols,gridRows,index){if(cols.columns||!1===cols.visible&&!this.hideColumnInclude||cols.commands){if(cols.columns){let isIgnoreFirstCell,colSpan=this.getCellCount(cols,0);colSpan&&gridRows[index].cells.push(new ej2_grids_es2015_Cell({cellType:CellType.StackedHeader,column:cols,colSpan:colSpan}));for(let i=0,len=cols.columns.length;i<len;i++)cols.columns[i].visible&&!isIgnoreFirstCell&&(isIgnoreFirstCell=!0),gridRows=this.appendGridCells(cols.columns[i],gridRows,index+1)}}else gridRows[index].cells.push(this.generateCell(cols,CellType.Header,this.colDepth-index,index));return gridRows}generateCell(gridColumn,cellType,rowSpan,rowIndex){let option={visible:gridColumn.visible,isDataCell:cellType===CellType.Data,column:gridColumn,cellType:cellType,rowSpan:rowSpan,index:rowIndex};return(!option.rowSpan||option.rowSpan<2)&&delete option.rowSpan,new ej2_grids_es2015_Cell(option)}processColumns(rows){let gridObj=this.parent,columnIndexes=[];gridObj.enableColumnVirtualization&&(columnIndexes=gridObj.getColumnIndexesInView());for(let i=0,len=rows.length;i<len;i++)if(gridObj.allowGrouping)for(let j=0,len=gridObj.groupSettings.columns.length;j<len;j++)gridObj.enableColumnVirtualization&&-1===columnIndexes.indexOf(j)||rows[i].cells.splice(0,0,this.generateCell({},CellType.HeaderIndent));return rows}getCellCount(column,count){if(column.columns)for(let i=0;i<column.columns.length;i++)count=this.getCellCount(column.columns[i],count);else(column.visible||this.hideColumnInclude)&&count++;return count}checkAndExport(gridPool,globalResolve){Object.keys(gridPool).some(key=>!gridPool[key])||globalResolve()}failureHandler(gridPool,childGridObj,resolve){return()=>{gridPool[childGridObj.id]=!0,this.checkAndExport(gridPool,resolve)}}createChildGrid(gObj,row,exportType,gridPool){let childGridObj=new ej2_grids_es2015_Grid(this.parent.detailRowModule.getGridModel(gObj,row,exportType));gObj.isPrinting=!1,childGridObj.parentDetails={parentID:gObj.element.id,parentPrimaryKeys:gObj.getPrimaryKeyFieldNames(),parentKeyField:gObj.childGrid.queryString,parentKeyFieldValue:getValue(childGridObj.queryString,row.data),parentRowData:row.data};let exportId=getUid("child-grid"),element=ej2_base_es2015_createElement("div",{id:exportId,styles:"display: none"});return document.body.appendChild(element),childGridObj.id=exportId,gridPool[exportId]=!1,{childGrid:childGridObj,element:element}}}class ej2_grids_es2015_ExportValueFormatter{constructor(culture){this.valueFormatter=new ej2_grids_es2015_ValueFormatter(culture),this.internationalization=new Internationalization(culture)}returnFormattedValue(args,customFormat){return!isNullOrUndefined(args.value)&&args.value?this.valueFormatter.getFormatFunction(customFormat)(args.value):""}formatCellValue(args){if(args.isForeignKey&&(args.value=getValue(args.column.foreignKeyValue,getForeignData(args.column,{},args.value)[0])),"number"===args.column.type&&void 0!==args.column.format&&""!==args.column.format)return args.value?this.internationalization.getNumberFormat({format:args.column.format})(args.value):"";if("boolean"===args.column.type)return args.value?"true":"false";if("date"!==args.column.type&&"datetime"!==args.column.type&&"time"!==args.column.type||void 0===args.column.format)return(isNullOrUndefined(args.column.type)||isNullOrUndefined(args.value))&&isNullOrUndefined(args.value)?"":args.value.toString();if("string"==typeof args.value&&(args.value=new Date(args.value)),"string"==typeof args.column.format){let format;return this.returnFormattedValue(args,format="date"===args.column.type?{type:"date",skeleton:args.column.format}:"time"===args.column.type?{type:"time",skeleton:args.column.format}:{type:"dateTime",skeleton:args.column.format})}if(args.column.format instanceof Object&&void 0===args.column.format.type)return args.value.toString();{let customFormat;return this.returnFormattedValue(args,customFormat="date"===args.column.type?{type:args.column.format.type,format:args.column.format.format,skeleton:args.column.format.skeleton}:"time"===args.column.type?{type:"time",format:args.column.format.format,skeleton:args.column.format.skeleton}:{type:"dateTime",format:args.column.format.format,skeleton:args.column.format.skeleton})}}}class ej2_grids_es2015_ExcelExport{constructor(parent,locator){this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.isCsvExport=!1,this.isElementIdChanged=!1,this.foreignKeyData={},this.gridPool={},this.parent=parent,this.helper=new ej2_grids_es2015_ExportHelper(parent),this.locator=locator,this.l10n=this.locator.getService("localization")}getModuleName(){return"ExcelExport"}init(gObj){null!==gObj.element&&""===gObj.element.id&&(gObj.element.id=(new Date).toISOString(),this.isElementIdChanged=!0),this.parent=gObj,this.parent.isDestroyed||(this.isExporting=void 0,this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.footer=void 0,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.exportValueFormatter=new ej2_grids_es2015_ExportValueFormatter(gObj.locale),gObj.id=getUid("main-grid"),this.gridPool[gObj.id]=!1)}Map(grid,exportProperties,isMultipleExport,workbook,isCsv,isBlob){let gObj=grid;this.gridPool={},grid.childGrid&&(isNullOrUndefined(exportProperties)||"None"!==exportProperties.hierarchyExportMode)&&(grid.expandedRows=getPrintGridModel(grid).expandedRows);let args={requestType:"beforeExcelExport",gridObject:gObj,cancel:!1,isMultipleExport:isMultipleExport,workbook:workbook,isCsv:isCsv,isBlob:isBlob};return gObj.trigger(beforeExcelExport,args),args.cancel?new Promise((resolve,reject)=>resolve()):(this.parent.log("exporting_begin",this.getModuleName()),this.data=new ej2_grids_es2015_Data(gObj),this.isExporting=!0,this.isBlob=args.isBlob,this.isCsvExport=!!args.isCsv&&args.isCsv,this.processRecords(gObj,exportProperties,args.isMultipleExport,args.workbook))}exportingSuccess(resolve){this.isExporting=!1,this.parent.trigger(excelExportComplete,this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),resolve(this.book)}processRecords(gObj,exportProperties,isMultipleExport,workbook){if(!isNullOrUndefined(exportProperties)&&!isNullOrUndefined(exportProperties.dataSource)&&exportProperties.dataSource instanceof ej2_data_es2015_DataManager)return new Promise((resolve,reject)=>{exportProperties.dataSource.executeQuery(new ej2_data_es2015_Query).then(r=>{this.init(gObj),this.processInnerRecords(gObj,exportProperties,isMultipleExport,workbook,r).then(()=>{this.exportingSuccess(resolve)})})});if(isNullOrUndefined(exportProperties)||"CurrentPage"!==exportProperties.exportType){let allPromise=[];return allPromise.push(this.data.getData({},ej2_grids_es2015_ExportHelper.getQuery(gObj,this.data))),allPromise.push(this.helper.getColumnData(gObj)),new Promise((resolve,reject)=>{Promise.all(allPromise).then(e=>{this.init(gObj),this.processInnerRecords(gObj,exportProperties,isMultipleExport,workbook,e[0]).then(()=>{this.exportingSuccess(resolve)})}).catch(e=>{reject(this.book),this.parent.trigger(ej2_grids_es2015_actionFailure,e)})})}return new Promise((resolve,reject)=>{this.init(gObj),this.processInnerRecords(gObj,exportProperties,isMultipleExport,workbook,this.parent.getCurrentViewRecords()),this.exportingSuccess(resolve)})}processInnerRecords(gObj,exportProperties,isMultipleExport,workbook,r){this.groupedColLength=gObj.groupSettings.columns.length;let blankRows=5,rows=[];return isNullOrUndefined(exportProperties)||isNullOrUndefined(exportProperties.multipleExport)||(this.expType=isNullOrUndefined(exportProperties.multipleExport.type)?"AppendToSheet":exportProperties.multipleExport.type,isNullOrUndefined(exportProperties.multipleExport.blankRows)||(blankRows=exportProperties.multipleExport.blankRows)),isNullOrUndefined(workbook)?(this.workSheet=[],this.rows=[],this.columns=[],this.styles=[]):"NewSheet"===this.expType?(this.workSheet=workbook.worksheets,this.rows=[],this.columns=[],this.styles=workbook.styles):(this.workSheet=[],this.rows=workbook.worksheets[0].rows,this.columns=workbook.worksheets[0].columns,this.styles=workbook.styles,this.rowLength=this.rows[this.rows.length-1].index+blankRows,this.rowLength++),isNullOrUndefined(exportProperties)||(isNullOrUndefined(isMultipleExport)?(isNullOrUndefined(exportProperties.header)||this.processExcelHeader(JSON.parse(JSON.stringify(exportProperties.header))),isNullOrUndefined(exportProperties.footer)||(this.footer=JSON.parse(JSON.stringify(exportProperties.footer)))):(isNullOrUndefined(exportProperties.header)||!isMultipleExport&&"NewSheet"!==this.expType||this.processExcelHeader(JSON.parse(JSON.stringify(exportProperties.header))),isNullOrUndefined(exportProperties.footer)||"AppendToSheet"===this.expType&&isMultipleExport||(this.footer=JSON.parse(JSON.stringify(exportProperties.footer))))),this.includeHiddenColumn=!isNullOrUndefined(exportProperties)&&exportProperties.includeHiddenColumn,new Promise((resolve,reject)=>{gObj.childGridLevel=0,rows=this.processGridExport(gObj,exportProperties,r),this.globalResolve=resolve,this.gridPool[gObj.id]=!0,this.helper.checkAndExport(this.gridPool,this.globalResolve)}).then(()=>{let organisedRows=[];this.organiseRows(rows,rows[0].index,organisedRows),this.rows=this.rows.concat(organisedRows),isNullOrUndefined(this.footer)||("AppendToSheet"===this.expType&&!isMultipleExport||"NewSheet"===this.expType)&&this.processExcelFooter(this.footer);let sheet={};if(this.columns.length>0&&(sheet.columns=this.columns),sheet.rows=this.rows,this.workSheet.push(sheet),this.book.worksheets=this.workSheet,this.book.styles=this.styles,!isMultipleExport){if(this.isCsvExport){let book=new ej2_excel_export_es2015_Workbook(this.book,"csv",gObj.locale,gObj.currencyCode);this.isBlob?this.blobPromise=book.saveAsBlob("text/csv"):!isNullOrUndefined(exportProperties)&&exportProperties.fileName?book.save(exportProperties.fileName):book.save("Export.csv")}else{let book=new ej2_excel_export_es2015_Workbook(this.book,"xlsx",gObj.locale,gObj.currencyCode);this.isBlob?this.blobPromise=book.saveAsBlob("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):!isNullOrUndefined(exportProperties)&&exportProperties.fileName?book.save(exportProperties.fileName):book.save("Export.xlsx")}this.isElementIdChanged&&(gObj.element.id=""),delete gObj.expandedRows}return workbook})}organiseRows(rows,initialIndex,organisedRows){if(!rows.length)return initialIndex;for(let i=0;i<rows.length;i++){let row=rows[i],childRows=row.childRows;childRows?(row.index=initialIndex++,delete row.childRows,organisedRows.push(row),initialIndex=this.organiseRows(childRows,initialIndex,organisedRows)):(row.index=initialIndex++,organisedRows.push(row))}return initialIndex}processGridExport(gObj,exportProperties,r){let excelRows=[];isNullOrUndefined(exportProperties)||isNullOrUndefined(exportProperties.theme)||(this.theme=exportProperties.theme),gObj.childGrid&&!isNullOrUndefined(exportProperties)&&(gObj.hierarchyPrintMode=exportProperties.hierarchyExportMode||"Expanded");let helper=new ej2_grids_es2015_ExportHelper(gObj),headerRow=helper.getHeaders(gObj.columns,this.includeHiddenColumn);return excelRows=this.processHeaderContent(gObj,headerRow,gObj.groupSettings.columns.length,excelRows),isNullOrUndefined(exportProperties)||isNullOrUndefined(exportProperties.dataSource)||exportProperties.dataSource instanceof ej2_data_es2015_DataManager?isNullOrUndefined(exportProperties)||"CurrentPage"!==exportProperties.exportType?this.processRecordContent(gObj,r,headerRow,exportProperties,void 0,excelRows,helper):this.processRecordContent(gObj,r,headerRow,exportProperties,gObj.currentViewData,excelRows,helper):this.processRecordContent(gObj,r,headerRow,exportProperties,exportProperties.dataSource,excelRows,helper)}processRecordContent(gObj,returnType,headerRow,exportProperties,currentViewRecords,excelRow,helper){let record;return record=isNullOrUndefined(currentViewRecords)?returnType.result:currentViewRecords,isNullOrUndefined(record.level)?this.processRecordRows(gObj,record,headerRow,0,0,exportProperties,excelRow,helper):this.processGroupedRows(gObj,record,headerRow,record.level,0,exportProperties,excelRow,helper),isNullOrUndefined(returnType.aggregates)||(isNullOrUndefined(currentViewRecords)?this.processAggregates(gObj,returnType.result.GroupGuid?returnType.result.records:returnType.result,excelRow):this.processAggregates(gObj,returnType.result,excelRow,currentViewRecords)),excelRow}processGroupedRows(gObj,dataSource,headerRow,level,startIndex,excelExportProperties,excelRows,helper){for(let item of dataSource){let cells=[],cell={};cell.index=1+level;let col=gObj.getColumnByField(item.field),args={value:item.key,column:col,style:void 0,isForeignKey:col.isForeignColumn()};cell.value=gObj.getColumnByField(item.field).headerText+": "+(col.enableGroupByFormat?item.key:this.exportValueFormatter.formatCellValue(args))+" - ",cell.value+=item.count>1?item.count+" items":item.count+" item",cell.style=this.getCaptionThemeStyle(this.theme);let groupCaptionSummaryRows=new CaptionSummaryModelGenerator(gObj).generateRows(item);if(this.fillAggregates(gObj,groupCaptionSummaryRows,dataSource.level+dataSource.childLevels,excelRows,this.rowLength),cells.push(cell),excelRows[excelRows.length-1].cells.length>0){let lIndex=dataSource.level+dataSource.childLevels+groupCaptionSummaryRows[0].cells.length,hIndex=0;for(let tCell of excelRows[excelRows.length-1].cells)tCell.index<lIndex&&(lIndex=tCell.index),tCell.index>hIndex&&(hIndex=tCell.index),cells[cells.length-1].index!==tCell.index&&cells.push(tCell);for(lIndex-cell.index>1&&(cell.colSpan=lIndex-cell.index);hIndex<headerRow.columns.length+level+dataSource.childLevels;){let sCell={};sCell.index=hIndex+1,sCell.style=this.getCaptionThemeStyle(this.theme),cells.push(sCell),hIndex++}}else{let span=0;for(let col of headerRow.columns)col.visible&&span++;cell.colSpan=dataSource.childLevels+span}excelRows[excelRows.length-1].cells=cells,this.rowLength++,this.groupedColLength<8&&level>1&&(excelRows[excelRows.length-1].grouping={outlineLevel:level-1,isCollapsed:!0}),!isNullOrUndefined(dataSource.childLevels)&&dataSource.childLevels>0?this.processGroupedRows(gObj,item.items,headerRow,item.items.level,startIndex,excelExportProperties,excelRows,helper):(startIndex=this.processRecordRows(gObj,item.items,headerRow,level,startIndex,excelExportProperties,excelRows,helper),this.processAggregates(gObj,item,excelRows,void 0,level,!0))}}processRecordRows(gObj,record,headerRow,level,startIndex,excelExportProperties,excelRows,helper){let index=1,cells=[],rows=helper.getGridRowModel(headerRow.columns,record,gObj,startIndex);for(const row of rows){cells=[],startIndex++,index=1;for(let c=0,len=row.cells.length;c<len;c++){let gCell=row.cells[c];if(gCell.cellType!==CellType.Data)continue;let fkData,column=gCell.column,field=column.field,cellValue=isNullOrUndefined(field)?"":column.valueAccessor(field,row.data,column),value=isNullOrUndefined(cellValue)?"":cellValue;if(column.isForeignColumn&&column.isForeignColumn()&&(fkData=helper.getFData(value,column),value=getValue(column.foreignKeyValue,fkData)),!isNullOrUndefined(value)){let cell={},excelCellArgs={data:row.data,column:column,foreignKeyData:fkData,value:value,style:void 0,colSpan:1,cell:cell};if(gObj.trigger(excelQueryCellInfo,excelCellArgs),(cell=excelCellArgs.cell).index=index+level+gObj.childGridLevel,cell.value=excelCellArgs.value,""===excelCellArgs.data&&gObj.childGridLevel&&1===index&&(excelCellArgs={style:{hAlign:"left"}},cell.colSpan=gObj.getVisibleColumns().length,cell.value=this.l10n.getConstant("EmptyRecord")),excelCellArgs.colSpan>1&&(cell.colSpan=excelCellArgs.colSpan),isNullOrUndefined(excelCellArgs.style))cell.style={name:gObj.element.id+"column"+(index+level)};else{let styleIndex=this.getColumnStyle(gObj,index+level);cell.style=this.mergeOptions(this.styles[styleIndex],excelCellArgs.style)}cells.push(cell)}index++}let excelRow={index:this.rowLength++,cells:cells};if(this.groupedColLength<8&&level>0?(excelRow.grouping={outlineLevel:level,isCollapsed:!0},excelRows.push(excelRow)):excelRows.push(excelRow),!isNullOrUndefined(gObj.childGrid)){gObj.isPrinting=!0;let exportType=!isNullOrUndefined(excelExportProperties)&&excelExportProperties.exportType?excelExportProperties.exportType:"AllPages",returnVal=this.helper.createChildGrid(gObj,row,exportType,this.gridPool),childGridObj=returnVal.childGrid,element=returnVal.element;childGridObj.actionFailure=helper.failureHandler(this.gridPool,childGridObj,this.globalResolve),childGridObj.childGridLevel=gObj.childGridLevel+1,this.parent.trigger(exportDetailDataBound,{childGrid:childGridObj,row:row,exportProperties:excelExportProperties}),childGridObj.beforeDataBound=this.childGridCell(excelRow,childGridObj,excelExportProperties,row),childGridObj.appendTo(element)}gObj.notify(exportRowDataBound,{rowObj:row,type:"excel"})}return startIndex}childGridCell(excelRow,childGridObj,excelExportProps,gRow){return result=>{childGridObj.beforeDataBound=null,result.cancel=!0,0===result.result.length&&(result.result=[""]),excelRow.childRows=this.processGridExport(childGridObj,excelExportProps,result);let intent=this.parent.groupSettings.columns.length;return excelRow.childRows.forEach(row=>{row.grouping={outlineLevel:intent+childGridObj.childGridLevel,isCollapsed:!gRow.isExpand,isHidden:!gRow.isExpand}}),childGridObj.destroy(),detach(childGridObj.element),this.gridPool[childGridObj.id]=!0,this.helper.checkAndExport(this.gridPool,this.globalResolve),excelRow}}processAggregates(gObj,rec,excelRows,currentViewRecords,indent,byGroup){let summaryModel=new ej2_grids_es2015_SummaryModelGenerator(gObj),data=void 0;if(data=isNullOrUndefined(currentViewRecords)?rec:currentViewRecords,void 0===indent&&(indent=0),gObj.groupSettings.columns.length>0&&byGroup){let groupSummaryRows=new GroupSummaryModelGenerator(gObj).generateRows(data,{level:data.level});groupSummaryRows.length>0&&(excelRows=this.fillAggregates(gObj,groupSummaryRows,indent,excelRows))}else{indent=gObj.groupSettings.columns.length>0&&!byGroup?gObj.groupSettings.columns.length:indent;let sRows=summaryModel.generateRows(data,rec.aggregates);sRows.length>0&&!byGroup&&(excelRows=this.fillAggregates(gObj,sRows,indent,excelRows))}return excelRows}fillAggregates(gObj,rows,indent,excelRows,customIndex){for(let row of rows){let cells=[],index=0;for(let cell of row.cells){let eCell={};if(cell.cellType!==CellType.DetailFooterIntent&&(cell.visible||this.includeHiddenColumn))if(index++,cell.isDataCell){if(eCell.index=index+indent+gObj.childGridLevel,isNullOrUndefined(cell.column.footerTemplate))if(isNullOrUndefined(cell.column.groupFooterTemplate))if(isNullOrUndefined(cell.column.groupCaptionTemplate))for(let key of Object.keys(row.data[cell.column.field]))key===cell.column.type&&(isNullOrUndefined(row.data[cell.column.field].Sum)?isNullOrUndefined(row.data[cell.column.field].Average)?isNullOrUndefined(row.data[cell.column.field].Max)?isNullOrUndefined(row.data[cell.column.field].Min)?isNullOrUndefined(row.data[cell.column.field].Count)?isNullOrUndefined(row.data[cell.column.field].TrueCount)?isNullOrUndefined(row.data[cell.column.field].FalseCount)?isNullOrUndefined(row.data[cell.column.field].Custom)||(eCell.value=row.data[cell.column.field].Custom):eCell.value=row.data[cell.column.field][`${cell.column.field} - falsecount`]:eCell.value=row.data[cell.column.field][`${cell.column.field} - truecount`]:eCell.value=row.data[cell.column.field][`${cell.column.field} - count`]:eCell.value=row.data[cell.column.field][`${cell.column.field} - min`]:eCell.value=row.data[cell.column.field][`${cell.column.field} - max`]:eCell.value=row.data[cell.column.field][`${cell.column.field} - average`]:eCell.value=row.data[cell.column.field][`${cell.column.field} - sum`]);else eCell.value=this.getAggreateValue(CellType.CaptionSummary,cell.column.groupCaptionTemplate,cell,row);else eCell.value=this.getAggreateValue(CellType.GroupSummary,cell.column.groupFooterTemplate,cell,row);else eCell.value=this.getAggreateValue(CellType.Summary,cell.column.footerTemplate,cell,row);eCell.style=this.getCaptionThemeStyle(this.theme),this.aggregateStyle(cell.column,eCell.style,cell.column.field);let gridCellStyle=cell.attributes.style;gridCellStyle.textAlign&&(eCell.style.hAlign=gridCellStyle.textAlign.toLowerCase()),cells.push(eCell)}else void 0===customIndex&&(eCell.index=index+indent+gObj.childGridLevel,eCell.style=this.getCaptionThemeStyle(this.theme),cells.push(eCell))}if(isNullOrUndefined(customIndex)){let row={};if(this.groupedColLength<8&&this.groupedColLength>0){let grouping={outlineLevel:excelRows[excelRows.length-1].grouping.outlineLevel,isCollapsed:!0};row={index:this.rowLength++,cells:cells,grouping:grouping}}else row={index:this.rowLength++,cells:cells};excelRows.push(row)}else excelRows.push({index:customIndex,cells:cells})}return excelRows}aggregateStyle(col,style,field){if("object"==typeof col.format){let format=col.format;style.numberFormat=isNullOrUndefined(format.format)?format.skeleton:format.format,style.type=isNullOrUndefined(format.type)?this.parent.getColumnByField(field).type.toLowerCase():format.type.toLowerCase()}else style.numberFormat=col.format,style.type=this.parent.getColumnByField(field).type.toLowerCase()}getAggreateValue(cellType,template,cell,row){let templateFn={};return templateFn[getEnumValue(CellType,cell.cellType)]=compile$$1(template),templateFn[getEnumValue(CellType,cell.cellType)](row.data[cell.column.field?cell.column.field:cell.column.columnName])[0].textContent}mergeOptions(JSON1,JSON2){let result={},attrname=Object.keys(JSON1);for(let index=0;index<attrname.length;index++)"name"!==attrname[index]&&(result[attrname[index]]=JSON1[attrname[index]]);attrname=Object.keys(JSON2);for(let index=0;index<attrname.length;index++)"name"!==attrname[index]&&(result[attrname[index]]=JSON2[attrname[index]]);return result}getColumnStyle(gObj,columnIndex){let index=0;for(let style of this.styles){if(style.name===gObj.element.id+"column"+columnIndex)return index;index++}}processHeaderContent(gObj,headerRow,indent,excelRows){let gridRows=headerRow.rows,gridColumns=headerRow.columns,spannedCells=[];if(indent>0){let index=0;for(;index!==indent;)this.columns.push({index:index+1,width:30}),index++}for(let row=0;row<gridRows.length;row++){let currentCellIndex=1+indent,cells=[];for(let column=0;column<gridRows[row].cells.length;column++){let style={},cell={},gridCell=gridRows[row].cells[column];if(gridCell.cellType===CellType.HeaderIndent||gridCell.cellType===CellType.DetailHeader)continue;let result={contains:!0,index:1};for(;result.contains;)if(currentCellIndex=(result=this.getIndex(spannedCells,1,currentCellIndex)).index,!result.contains){cell.index=result.index+gObj.childGridLevel;break}if(!isNullOrUndefined(gridCell.rowSpan)&&1!==gridCell.rowSpan){cell.rowSpan=gridCell.rowSpan;for(let i=1;i<gridCell.rowSpan+1;i++){let spannedCell={rowIndex:0,columnIndex:0};spannedCell.rowIndex=i,spannedCell.columnIndex=currentCellIndex,spannedCells.push(spannedCell)}}isNullOrUndefined(gridCell.colSpan)||1===gridCell.colSpan||(cell.colSpan=gridCell.colSpan,currentCellIndex=currentCellIndex+cell.colSpan-1),cell.value=gridCell.column.headerText,style=this.getHeaderThemeStyle(this.theme),isNullOrUndefined(gridCell.column.textAlign)||(style.hAlign=gridCell.column.textAlign.toLowerCase()),isNullOrUndefined(gridCell.column.headerTextAlign)||(style.hAlign=gridCell.column.headerTextAlign.toLowerCase());let excelHeaderCellArgs={cell:cell,gridCell:gridCell,style:style};gObj.trigger(excelHeaderQueryCellInfo,excelHeaderCellArgs),cell.style=excelHeaderCellArgs.style,cells.push(cell),currentCellIndex++}excelRows.push({index:this.rowLength++,cells:cells})}for(let col=0;col<gridColumns.length;col++)this.parseStyles(gObj,gridColumns[col],this.getRecordThemeStyle(this.theme),indent+col+1);return excelRows}getHeaderThemeStyle(theme){let style={fontSize:12,borders:{color:"#E0E0E0"},bold:!0};return isNullOrUndefined(theme)||isNullOrUndefined(theme.header)||(style=this.updateThemeStyle(theme.header,style)),style}updateThemeStyle(themestyle,style){return extend(style,themestyle)}getCaptionThemeStyle(theme){let style={fontSize:13,backColor:"#F6F6F6"};return isNullOrUndefined(theme)||isNullOrUndefined(theme.caption)||(style=this.updateThemeStyle(theme.caption,style)),style}getRecordThemeStyle(theme){let style={fontSize:13,borders:{color:"#E0E0E0"}};return isNullOrUndefined(theme)||isNullOrUndefined(theme.record)||(style=this.updateThemeStyle(theme.record,style)),style}processExcelHeader(header){if(!isNullOrUndefined(header.rows)&&("NewSheet"===this.expType||1===this.rowLength)){let noRows;this.rowLength=void 0===header.headerRows?header.rows.length:header.headerRows,noRows=this.rowLength<header.rows.length?this.rowLength:header.rows.length,this.rowLength++;for(let row=0;row<noRows;row++){let json=header.rows[row];(null===json.index||isNullOrUndefined(json.index))&&(json.index=row+1),this.updatedCellIndex(json)}}}updatedCellIndex(json){let cellsLength=json.cells.length;for(let cellId=0;cellId<cellsLength;cellId++){let jsonCell=json.cells[cellId];(null===jsonCell.index||isNullOrUndefined(jsonCell.index))&&(jsonCell.index=cellId+1)}this.rows.push(json)}processExcelFooter(footer){if(!isNullOrUndefined(footer.rows)){let noRows;void 0===footer.footerRows?this.rowLength+=footer.rows.length:footer.footerRows>footer.rows.length?(this.rowLength+=footer.footerRows-footer.rows.length,noRows=footer.rows.length):noRows=footer.footerRows;for(let row=0;row<noRows;row++){let json=footer.rows[row];null==json.index?json.index=this.rowLength++:json.index+=this.rowLength,this.updatedCellIndex(json)}}}getIndex(spannedCells,rowIndex,columnIndex){for(let spannedCell of spannedCells)if(spannedCell.rowIndex===rowIndex&&spannedCell.columnIndex===columnIndex)return{contains:!0,index:columnIndex+=1};return{contains:!1,index:columnIndex}}parseStyles(gObj,col,style,index){if(!isNullOrUndefined(col.format))if("object"==typeof col.format){let format=col.format;style.numberFormat=isNullOrUndefined(format.format)?format.skeleton:format.format,isNullOrUndefined(format.type)||(style.type=format.type.toLowerCase())}else style.numberFormat=col.format,style.type=col.type;isNullOrUndefined(col.textAlign)||(style.hAlign=col.textAlign.toLowerCase()),Object.keys(style).length>0&&(style.name=gObj.element.id+"column"+index,this.styles.push(style)),isNullOrUndefined(col.width)||this.columns.push({index:index+gObj.childGridLevel,width:"number"==typeof col.width?col.width:this.helper.getConvertedWidth(col.width)})}destroy(){}}class ej2_grids_es2015_PdfExport{constructor(parent){this.hideColumnInclude=!1,this.currentViewData=!1,this.customDataSource=!1,this.isGrouping=!1,this.parent=parent,this.helper=new ej2_grids_es2015_ExportHelper(parent),this.gridPool={}}getModuleName(){return"PdfExport"}init(parent){this.exportValueFormatter=new ej2_grids_es2015_ExportValueFormatter(parent.locale),this.pdfDocument=void 0,this.hideColumnInclude=!1,this.currentViewData=!1,this.parent=parent,this.isGrouping=!1,this.isExporting=!0,parent.id=getUid("main-grid"),this.gridPool[parent.id]=!1}exportWithData(parent,pdfDoc,resolve,returnType,pdfExportProperties,isMultipleExport){this.init(parent),this.pdfDocument=isNullOrUndefined(pdfDoc)?new PdfDocument:pdfDoc,this.processExport(parent,returnType,pdfExportProperties,isMultipleExport).then(()=>{this.isExporting=!1,parent.trigger(pdfExportComplete,this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),resolve(this.pdfDocument)})}Map(parent,pdfExportProperties,isMultipleExport,pdfDoc,isBlob){this.data=new ej2_grids_es2015_Data(this.parent),this.isBlob=isBlob,this.gridPool={},parent.childGrid&&(isNullOrUndefined(pdfExportProperties)||"None"!==pdfExportProperties.hierarchyExportMode)&&(parent.expandedRows=getPrintGridModel(parent).expandedRows);let args={requestType:"beforePdfExport",cancel:!1};if(isBlazor()||(args.gridObject=parent),parent.trigger(beforePdfExport,args),!0===args.cancel)return new Promise((resolve,reject)=>resolve());if(this.parent.log("exporting_begin",this.getModuleName()),!isNullOrUndefined(pdfExportProperties)&&!isNullOrUndefined(pdfExportProperties.dataSource)&&pdfExportProperties.dataSource instanceof ej2_data_es2015_DataManager)return new Promise((resolve,reject)=>{pdfExportProperties.dataSource.executeQuery(new ej2_data_es2015_Query).then(returnType=>{this.exportWithData(parent,pdfDoc,resolve,returnType,pdfExportProperties,isMultipleExport)})});if(isNullOrUndefined(pdfExportProperties)||"CurrentPage"!==pdfExportProperties.exportType){let allPromise=[];return allPromise.push(this.data.getData({},ej2_grids_es2015_ExportHelper.getQuery(parent,this.data))),allPromise.push(this.helper.getColumnData(parent)),new Promise((resolve,reject)=>{Promise.all(allPromise).then(e=>{this.init(parent),this.pdfDocument=isNullOrUndefined(pdfDoc)?new PdfDocument:pdfDoc,this.processExport(parent,e[0],pdfExportProperties,isMultipleExport).then(()=>{this.isExporting=!1,parent.trigger(pdfExportComplete,this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),resolve(this.pdfDocument)})})})}return new Promise((resolve,reject)=>{this.exportWithData(parent,pdfDoc,resolve,this.parent.getCurrentViewRecords(),pdfExportProperties,isMultipleExport)})}processExport(gObj,returnType,pdfExportProperties,isMultipleExport){let pdfGrid,section=this.pdfDocument.sections.add();this.processSectionExportProperties(section,pdfExportProperties);let pdfPage=section.pages.add();return new Promise((resolve,reject)=>{pdfGrid=this.processGridExport(gObj,returnType,pdfExportProperties),this.globalResolve=resolve,this.gridPool[gObj.id]=!0,this.helper.checkAndExport(this.gridPool,this.globalResolve)}).then(()=>(pdfGrid.draw(pdfPage,0,0),isMultipleExport||(this.isBlob?this.blobPromise=this.pdfDocument.save():!isNullOrUndefined(pdfExportProperties)&&pdfExportProperties.fileName?this.pdfDocument.save(pdfExportProperties.fileName):this.pdfDocument.save("Export.pdf"),this.pdfDocument.destroy(),delete gObj.expandedRows),this.pdfDocument))}processSectionExportProperties(section,pdfExportProperties){if(!(isNullOrUndefined(pdfExportProperties)||isNullOrUndefined(pdfExportProperties.pageOrientation)&&isNullOrUndefined(pdfExportProperties.pageSize))){let pdfPageSettings=new PdfPageSettings;pdfPageSettings.orientation="Landscape"===pdfExportProperties.pageOrientation?PdfPageOrientation.Landscape:PdfPageOrientation.Portrait,pdfPageSettings.size=this.getPageSize(pdfExportProperties.pageSize),section.setPageSettings(pdfPageSettings)}return section}processGridExport(gObj,returnType,pdfExportProperties){isNullOrUndefined(pdfExportProperties)||(this.gridTheme=pdfExportProperties.theme);let helper=new ej2_grids_es2015_ExportHelper(gObj),dataSource=this.processExportProperties(pdfExportProperties,returnType.result),columns=gObj.columns,isGrouping=!1;gObj.groupSettings.columns.length&&(isGrouping=!0),gObj.childGrid&&!isNullOrUndefined(pdfExportProperties)&&(gObj.hierarchyPrintMode=pdfExportProperties.hierarchyExportMode||"Expanded");let pdfGrid=new PdfGrid,headerThemeStyle=this.getHeaderThemeStyle(),border=headerThemeStyle.border,headerFont=headerThemeStyle.font,headerBrush=headerThemeStyle.brush,returnValue=helper.getHeaders(columns,this.hideColumnInclude),gridColumns=returnValue.columns;pdfGrid=this.processGridHeaders(gObj.groupSettings.columns.length,pdfGrid,returnValue.rows,gridColumns,border,headerFont,headerBrush,gObj),this.setColumnProperties(gridColumns,pdfGrid,helper,gObj);let captionThemeStyle=this.getSummaryCaptionThemeStyle();if(!isNullOrUndefined(dataSource)&&dataSource.length){if(isGrouping?(isNullOrUndefined(captionThemeStyle.border)||(border=captionThemeStyle.border),this.processGroupedRecords(pdfGrid,dataSource,gridColumns,gObj,border,0,captionThemeStyle.font,captionThemeStyle.brush,captionThemeStyle.backgroundBrush,returnType,pdfExportProperties,helper,0)):this.processRecord(border,gridColumns,gObj,dataSource,pdfGrid,0,pdfExportProperties,helper,0),!isNullOrUndefined(returnType.aggregates)){let sRows;sRows=new ej2_grids_es2015_SummaryModelGenerator(gObj).generateRows(this.customDataSource?dataSource:this.currentViewData?this.parent.getCurrentViewRecords():isGrouping?dataSource.records:returnType.result,returnType.aggregates),this.processAggregates(sRows,pdfGrid,border,captionThemeStyle.font,captionThemeStyle.brush,captionThemeStyle.backgroundBrush,!1)}}else pdfGrid.rows.addRow().style.setBorder(border);return pdfGrid}getSummaryCaptionThemeStyle(){if(isNullOrUndefined(this.gridTheme)||isNullOrUndefined(this.gridTheme.caption))return{font:new PdfStandardFont(PdfFontFamily.Helvetica,9.75),brush:new PdfSolidBrush(new PdfColor(0,0,0)),backgroundBrush:new PdfSolidBrush(new PdfColor(246,246,246))};{let fontSize=isNullOrUndefined(this.gridTheme.caption.fontSize)?9.75:this.gridTheme.caption.fontSize,fontFamily=isNullOrUndefined(this.gridTheme.caption.fontName)?PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.caption.fontName),fontStyle=this.getFontStyle(this.gridTheme.caption),pdfColor=new PdfColor(0,0,0);if(!isNullOrUndefined(this.gridTheme.caption.fontColor)){let penBrushColor=this.hexToRgb(this.gridTheme.caption.fontColor);pdfColor=new PdfColor(penBrushColor.r,penBrushColor.g,penBrushColor.b)}let borderCaption=this.gridTheme.caption.border?this.getBorderStyle(this.gridTheme.caption.border):null,font=new PdfStandardFont(fontFamily,fontSize,fontStyle);return isNullOrUndefined(this.gridTheme.caption.font)||(font=this.gridTheme.caption.font),{font:font,brush:new PdfSolidBrush(pdfColor),backgroundBrush:new PdfSolidBrush(new PdfColor(246,246,246)),border:borderCaption}}}getHeaderThemeStyle(){let border=new PdfBorders;if(isNullOrUndefined(this.gridTheme)||isNullOrUndefined(this.gridTheme.header))return border.all=new PdfPen(new PdfColor(234,234,234)),{border:border,font:new PdfStandardFont(PdfFontFamily.Helvetica,10.5),brush:new PdfSolidBrush(new PdfColor(102,102,102))};{let fontFamily=isNullOrUndefined(this.gridTheme.header.fontName)?PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.header.fontName),fontStyle=this.getFontStyle(this.gridTheme.header),fontSize=isNullOrUndefined(this.gridTheme.header.fontSize)?10.5:this.gridTheme.header.fontSize,pdfColor=new PdfColor;if(!isNullOrUndefined(this.gridTheme.header.fontColor)){let penBrushColor=this.hexToRgb(this.gridTheme.header.fontColor);pdfColor=new PdfColor(penBrushColor.r,penBrushColor.g,penBrushColor.b)}let font=new PdfStandardFont(fontFamily,fontSize,fontStyle);return isNullOrUndefined(this.gridTheme.header.font)||(font=this.gridTheme.header.font),{border:this.getBorderStyle(this.gridTheme.header.border),font:font,brush:new PdfSolidBrush(pdfColor)}}}processGroupedRecords(pdfGrid,dataSource,gridColumns,gObj,border,level,font,brush,backgroundBrush,returnType,pdfExportProperties,helper,index){let groupIndex=level;for(let dataSourceItems of dataSource){let sRows,row=pdfGrid.rows.addRow(),col=gObj.getColumnByField(dataSourceItems.field),args={value:dataSourceItems.key,column:col,style:void 0,isForeignKey:col.isForeignColumn()},value=this.parent.getColumnByField(dataSourceItems.field).headerText+": "+(col.enableGroupByFormat?dataSourceItems.key:this.exportValueFormatter.formatCellValue(args))+" - "+dataSourceItems.count+(dataSource.count>1?" items":" item");row.cells.getCell(groupIndex).value=value,row.cells.getCell(groupIndex+1).style.stringFormat=new PdfStringFormat(PdfTextAlignment.Left),row.style.setBorder(border),row.style.setFont(font),row.style.setTextBrush(brush),row.style.setBackgroundBrush(backgroundBrush);let captionSummaryModel=new CaptionSummaryModelGenerator(gObj);sRows=isNullOrUndefined(dataSourceItems.items.records)?captionSummaryModel.generateRows(dataSourceItems.items,dataSourceItems):captionSummaryModel.generateRows(dataSourceItems.items.records,dataSourceItems),isNullOrUndefined(sRows)||0!==sRows.length||(row.cells.getCell(groupIndex+1).columnSpan=pdfGrid.columns.count-(groupIndex+1)),!isNullOrUndefined(dataSource.childLevels)&&dataSource.childLevels>0?(this.processAggregates(sRows,pdfGrid,border,font,brush,backgroundBrush,!0,row,groupIndex),this.processGroupedRecords(pdfGrid,dataSourceItems.items,gridColumns,gObj,border,groupIndex+1,font,brush,backgroundBrush,returnType,pdfExportProperties,helper,index),sRows=new GroupSummaryModelGenerator(gObj).generateRows(dataSourceItems.items.records,dataSourceItems),this.processAggregates(sRows,pdfGrid,border,font,brush,backgroundBrush,!1)):(this.processAggregates(sRows,pdfGrid,border,font,brush,backgroundBrush,!0,row,groupIndex),index=this.processRecord(border,gridColumns,gObj,dataSourceItems.items,pdfGrid,groupIndex+1,pdfExportProperties,helper,index),sRows=new GroupSummaryModelGenerator(gObj).generateRows(dataSourceItems.items,dataSourceItems),this.processAggregates(sRows,pdfGrid,border,font,brush,backgroundBrush,!1))}}processGridHeaders(childLevels,pdfGrid,rows,gridColumn,border,headerFont,headerBrush,grid){pdfGrid.columns.add(gridColumn.length+childLevels),pdfGrid.headers.add(rows.length);for(let i=0;i<rows.length;i++){let gridHeader=pdfGrid.headers.getHeader(i);gridHeader.style.setBorder(border),gridHeader.style.setFont(headerFont),gridHeader.style.setTextBrush(headerBrush);let colSpan=0,cellLength=rows[i].cells.length;for(let j=0;j<cellLength;j++){let cell=rows[i].cells[j],pdfCell=gridHeader.cells.getCell(j+colSpan);switch(cell.cellType){case CellType.HeaderIndent:case CellType.DetailHeader:pdfCell.value="",pdfCell.width=20;break;case CellType.Header:case CellType.StackedHeader:if(null!==pdfCell.value){if(isNullOrUndefined(cell.column.headerTextAlign)||(pdfCell.style.stringFormat=this.getHorizontalAlignment(cell.column.headerTextAlign)),!isNullOrUndefined(cell.rowSpan)){pdfCell.rowSpan=cell.rowSpan,pdfCell.style.stringFormat=this.getVerticalAlignment("Bottom",pdfCell.style.stringFormat,cell.column.textAlign);for(let k=1;k<rows[i].cells[j].rowSpan;k++)pdfGrid.headers.getHeader(i+k).cells.getCell(j).value=null}isNullOrUndefined(cell.colSpan)||(pdfCell.columnSpan=cell.colSpan,colSpan+=cell.colSpan-1),pdfCell.value=cell.column.headerText,this.parent.trigger(pdfHeaderQueryCellInfo,{cell:pdfCell,gridCell:cell,style:pdfCell.style})}else colSpan+=pdfCell.columnSpan,j-=1}}}return pdfGrid.columns.count>=6&&(pdfGrid.style.allowHorizontalOverflow=!0),pdfGrid}processExportProperties(pdfExportProperties,dataSource){if(isNullOrUndefined(pdfExportProperties))this.currentViewData=!1,this.customDataSource=!1;else{isNullOrUndefined(pdfExportProperties.theme)||(this.gridTheme=pdfExportProperties.theme);let clientSize=this.pdfDocument.pageSettings.size;if(!isNullOrUndefined(pdfExportProperties.header)){let header=pdfExportProperties.header,position=new PointF(0,header.fromTop),size=new SizeF(clientSize.width-80,.75*header.height),bounds=new RectangleF(position,size);this.pdfDocument.template.top=this.drawPageTemplate(new PdfPageTemplateElement(bounds),header)}if(!isNullOrUndefined(pdfExportProperties.footer)){let footer=pdfExportProperties.footer,position=new PointF(0,clientSize.width-80-.75*footer.fromBottom),size=new SizeF(clientSize.width-80,.75*footer.height),bounds=new RectangleF(position,size);this.pdfDocument.template.bottom=this.drawPageTemplate(new PdfPageTemplateElement(bounds),footer)}isNullOrUndefined(pdfExportProperties.includeHiddenColumn)||this.isGrouping||(this.hideColumnInclude=pdfExportProperties.includeHiddenColumn),isNullOrUndefined(pdfExportProperties.dataSource)?isNullOrUndefined(pdfExportProperties.exportType)?(this.currentViewData=!1,this.customDataSource=!1):"CurrentPage"===pdfExportProperties.exportType?(dataSource=this.parent.currentViewData,this.currentViewData=!0,this.customDataSource=!1):(this.currentViewData=!1,this.customDataSource=!1):(pdfExportProperties.dataSource instanceof ej2_data_es2015_DataManager||(dataSource=pdfExportProperties.dataSource),this.customDataSource=!0,this.currentViewData=!1)}return dataSource}drawPageTemplate(template,element){for(let content of element.contents)switch(this.processContentValidation(content),content.type){case"Text":if(""===content.value||null==content.value||"string"!=typeof content.value)throw new Error("please enter the valid input value in text content...");this.drawText(template,content);break;case"PageNumber":this.drawPageNumber(template,content);break;case"Image":if(null==content.src||""===content.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(template,content);break;case"Line":this.drawLine(template,content);break;default:throw new Error("Please set valid content type...")}return template}processContentValidation(content){if(null==content.type)throw new Error("please set valid content type...");if("Line"===content.type){if(null==content.points)throw new Error("please enter valid points in "+content.type+" content...");if(null==content.points.x1||"number"!=typeof content.points.x1)throw new Error("please enter valid x1 co-ordinate in "+content.type+" points...");if(null==content.points.y1||"number"!=typeof content.points.y1)throw new Error("please enter valid y1 co-ordinate in "+content.type+" points...");if(null==content.points.x2||"number"!=typeof content.points.x2)throw new Error("please enter valid x2 co-ordinate in "+content.type+" points...");if(null==content.points.y2||"number"!=typeof content.points.y2)throw new Error("please enter valid y2 co-ordinate in "+content.type+" points...")}else{if(null==content.position)throw new Error("please enter valid position in "+content.type+" content...");if(null==content.position.x||"number"!=typeof content.position.x)throw new Error("please enter valid x co-ordinate in "+content.type+" position...");if(null==content.position.y||"number"!=typeof content.position.y)throw new Error("please enter valid y co-ordinate in "+content.type+" position...")}}drawText(pageTemplate,content){let font=this.getFont(content),brush=this.getBrushFromContent(content),pen=null;if(!isNullOrUndefined(content.style.textPenColor)){let penColor=this.hexToRgb(content.style.textPenColor);pen=new PdfPen(new PdfColor(penColor.r,penColor.g,penColor.b))}null==brush&&null==pen&&(brush=new PdfSolidBrush(new PdfColor(0,0,0)));let value=content.value.toString(),x=.75*content.position.x,y=.75*content.position.y,result=this.setContentFormat(content,void 0);null===result||isNullOrUndefined(result.format)||isNullOrUndefined(result.size)?pageTemplate.graphics.drawString(value,font,pen,brush,x,y,void 0):pageTemplate.graphics.drawString(value,font,pen,brush,x,y,result.size.width,result.size.height,result.format)}drawPageNumber(documentHeader,content){let font=this.getFont(content),brush=null;if(isNullOrUndefined(content.style.textBrushColor))brush=new PdfSolidBrush(new PdfColor(0,0,0));else{let brushColor=this.hexToRgb(content.style.textBrushColor);brush=new PdfSolidBrush(new PdfColor(brushColor.r,brushColor.g,brushColor.b))}let compositeField,format,pageNumber=new PdfPageNumberField(font,brush);if(pageNumber.numberStyle=this.getPageNumberStyle(content.pageNumberType),isNullOrUndefined(content.format))compositeField=new PdfCompositeField(font,brush,format="{0}",pageNumber);else if(-1!==content.format.indexOf("$total")&&-1!==content.format.indexOf("$current")){let pageCount=new PdfPageCountField(font);format=content.format.indexOf("$total")>content.format.indexOf("$current")?(format=content.format.replace("$current","0")).replace("$total","1"):(format=content.format.replace("$current","1")).replace("$total","0"),compositeField=new PdfCompositeField(font,brush,format,pageNumber,pageCount)}else if(-1!==content.format.indexOf("$current")&&-1===content.format.indexOf("$total"))format=content.format.replace("$current","0"),compositeField=new PdfCompositeField(font,brush,format,pageNumber);else{let pageCount=new PdfPageCountField(font);format=content.format.replace("$total","0"),compositeField=new PdfCompositeField(font,brush,format,pageCount)}let x=.75*content.position.x,y=.75*content.position.y,result=this.setContentFormat(content,compositeField.stringFormat);null===result||isNullOrUndefined(result.format)||isNullOrUndefined(result.size)||(compositeField.stringFormat=result.format,compositeField.bounds=new RectangleF(x,y,result.size.width,result.size.height)),compositeField.draw(documentHeader.graphics,x,y)}drawImage(documentHeader,content){let x=.75*content.position.x,y=.75*content.position.y,width=isNullOrUndefined(content.size)?void 0:.75*content.size.width,height=isNullOrUndefined(content.size)?void 0:.75*content.size.height,image=new PdfBitmap(content.src);isNullOrUndefined(width)?documentHeader.graphics.drawImage(image,x,y):documentHeader.graphics.drawImage(image,x,y,width,height)}drawLine(documentHeader,content){let x1=.75*content.points.x1,y1=.75*content.points.y1,x2=.75*content.points.x2,y2=.75*content.points.y2,pen=this.getPenFromContent(content);isNullOrUndefined(content.style)||null===content.style||(isNullOrUndefined(content.style.penSize)||null===content.style.penSize||"number"!=typeof content.style.penSize||(pen.width=.75*content.style.penSize),pen.dashStyle=this.getDashStyle(content.style.dashStyle)),documentHeader.graphics.drawLine(pen,x1,y1,x2,y2)}processAggregates(sRows,pdfGrid,border,font,brush,backgroundBrush,isCaption,captionRow,groupIndex){for(let row of sRows){let leastCaptionSummaryIndex=-1,index=0,isEmpty=!0,value=[];for(let i=0;i<pdfGrid.columns.count;i++){let cell=row.cells[index];if(cell.cellType!==CellType.DetailFooterIntent){if(!this.hideColumnInclude){for(;void 0===cell.visible;)cell.cellType!==CellType.DetailFooterIntent&&(isNullOrUndefined(captionRow)?value.push(""):isNullOrUndefined(captionRow.cells.getCell(i).value)?value.push(""):(value.push(""),value.push(captionRow.cells.getCell(i).value),isEmpty=!1,i+=1),i+=1,cell=row.cells[index+=1]);for(;!isNullOrUndefined(cell.visible)&&!cell.visible;)cell=row.cells[index+=1]}if(cell.isDataCell){let templateFn={};if(isNullOrUndefined(cell.column.footerTemplate)&&isNullOrUndefined(cell.column.groupCaptionTemplate)&&isNullOrUndefined(cell.column.groupFooterTemplate)){let result=this.getSummaryWithoutTemplate(row.data[cell.column.field]);isNullOrUndefined(result)||value.push(result)}else{let result=this.getTemplateFunction(templateFn,i,leastCaptionSummaryIndex,cell.column);leastCaptionSummaryIndex=result.leastCaptionSummaryIndex;let txt=(templateFn=result.templateFunction)[getEnumValue(CellType,cell.cellType)](row.data[cell.column.field?cell.column.field:cell.column.columnName]);value.push(txt[0].textContent),isEmpty=!1}}else value.push("");isEmpty&&""!==value[i]&&!isNullOrUndefined(value[i])&&null!==value[i]&&(isEmpty=!1),index+=1}else i--,index++}if(!isEmpty)if(isCaption)for(let i=0;i<pdfGrid.columns.count;i++)captionRow.cells.getCell(i).value=value[i].toString(),i===groupIndex+1&&-1!==leastCaptionSummaryIndex?captionRow.cells.getCell(i).columnSpan=leastCaptionSummaryIndex-(groupIndex+1):i===groupIndex+1&&-1===leastCaptionSummaryIndex&&(captionRow.cells.getCell(i).columnSpan=pdfGrid.columns.count-(groupIndex+1));else{let gridRow=pdfGrid.rows.addRow();gridRow.style.setBorder(border),gridRow.style.setFont(font),gridRow.style.setTextBrush(brush),gridRow.style.setBackgroundBrush(backgroundBrush);for(let i=0;i<pdfGrid.columns.count;i++)gridRow.cells.getCell(i).value=value[i].toString()}}}getTemplateFunction(templateFn,index,leastCaptionSummaryIndex,column){return isNullOrUndefined(column.footerTemplate)?isNullOrUndefined(column.groupCaptionTemplate)?templateFn[getEnumValue(CellType,CellType.GroupSummary)]=compile$$1(column.groupFooterTemplate):(-1===leastCaptionSummaryIndex&&(leastCaptionSummaryIndex=index),templateFn[getEnumValue(CellType,CellType.CaptionSummary)]=compile$$1(column.groupCaptionTemplate)):templateFn[getEnumValue(CellType,CellType.Summary)]=compile$$1(column.footerTemplate),{templateFunction:templateFn,leastCaptionSummaryIndex:leastCaptionSummaryIndex}}getSummaryWithoutTemplate(data){return isNullOrUndefined(data.Sum)?isNullOrUndefined(data.Average)?isNullOrUndefined(data.Max)?isNullOrUndefined(data.Min)?isNullOrUndefined(data.Count)?isNullOrUndefined(data.TrueCount)?isNullOrUndefined(data.FalseCount)?isNullOrUndefined(data.Custom)?void 0:data.Custom:data.FalseCount:data.TrueCount:data.Count:data.Min:data.Max:data.Average:data.Sum}setColumnProperties(gridColumns,pdfGrid,helper,gObj){let startIndex=gObj.groupSettings.columns.length;for(let i=0;i<startIndex;i++)pdfGrid.columns.getColumn(i).width=20;for(let i=0;i<gridColumns.length;i++)isNullOrUndefined(gridColumns[i].textAlign)||(pdfGrid.columns.getColumn(i+startIndex).format=this.getHorizontalAlignment(gridColumns[i].textAlign)),pdfGrid.style.allowHorizontalOverflow&&!isNullOrUndefined(gridColumns[i].width)&&(pdfGrid.columns.getColumn(i+startIndex).width="number"==typeof gridColumns[i].width?.75*gridColumns[i].width:.75*helper.getConvertedWidth(gridColumns[i].width))}setRecordThemeStyle(row,border){if(isNullOrUndefined(this.gridTheme)||isNullOrUndefined(this.gridTheme.record))row.style.setTextBrush(new PdfSolidBrush(new PdfColor(0,0,0)));else{let fontFamily=isNullOrUndefined(this.gridTheme.record.fontName)?PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.record.fontName),fontSize=isNullOrUndefined(this.gridTheme.record.fontSize)?9.75:this.gridTheme.record.fontSize,fontStyle=this.getFontStyle(this.gridTheme.record),font=new PdfStandardFont(fontFamily,fontSize,fontStyle);isNullOrUndefined(this.gridTheme.record.font)||(font=this.gridTheme.record.font),row.style.setFont(font);let pdfColor=new PdfColor;if(!isNullOrUndefined(this.gridTheme.record.fontColor)){let penBrushColor=this.hexToRgb(this.gridTheme.record.fontColor);pdfColor=new PdfColor(penBrushColor.r,penBrushColor.g,penBrushColor.b)}row.style.setTextBrush(new PdfSolidBrush(pdfColor))}let borderRecord=this.gridTheme&&this.gridTheme.record&&this.gridTheme.record.border?this.getBorderStyle(this.gridTheme.record.border):border;return row.style.setBorder(borderRecord),row}processRecord(border,columns,gObj,dataSource,pdfGrid,startIndex,pdfExportProperties,helper,rowIndex){let rows=helper.getGridRowModel(columns,dataSource,gObj,rowIndex);for(const row of rows){rowIndex++;let gridRow=this.setRecordThemeStyle(pdfGrid.rows.addRow(),border),cellLength=row.cells.length;for(let j=0;j<cellLength;j++){let gridCell=row.cells[j];if(gridCell.cellType!==CellType.Data)continue;let foreignKeyData$$1,column=gridCell.column,field=column.field,cellValue=isNullOrUndefined(field)?"":column.valueAccessor(field,row.data,column),value=isNullOrUndefined(cellValue)?"":cellValue;column.isForeignColumn&&column.isForeignColumn()&&(foreignKeyData$$1=helper.getFData(value,column),value=getValue(column.foreignKeyValue,foreignKeyData$$1));let data=row.data,cell=gridRow.cells.getCell(j),args={data:data,value:value,column:column,style:void 0,colSpan:1,cell:cell};if(args.value=this.exportValueFormatter.formatCellValue(args),this.parent.trigger(pdfQueryCellInfo,args),cell.value=args.value,isNullOrUndefined(args.style)||this.processCellStyle(cell,args),args.colSpan>1){j+1+args.colSpan>gridRow.cells.count&&(args.colSpan=gridRow.cells.count-(j+1)),cell.columnSpan=args.colSpan;for(let i=1;i<cell.columnSpan;i++)gridRow.cells.getCell(j+i).value="";j+=args.colSpan-1}}if(row.isExpand){let gridRow=this.setRecordThemeStyle(pdfGrid.rows.addRow(),border),cell=gridRow.cells.getCell(startIndex);cell.columnSpan=gridRow.cells.count-startIndex,cell.style.cellPadding=new PdfPaddings(10,10,10,10),gObj.isPrinting=!0;let exportType=!isNullOrUndefined(pdfExportProperties)&&pdfExportProperties.exportType?pdfExportProperties.exportType:"AllPages",returnValue=this.helper.createChildGrid(gObj,row,exportType,this.gridPool),childGridObj=returnValue.childGrid,element=returnValue.element;childGridObj.actionFailure=helper.failureHandler(this.gridPool,childGridObj,this.globalResolve),this.parent.trigger(exportDetailDataBound,{childGrid:childGridObj,row:row,cell:cell,exportProperties:pdfExportProperties}),childGridObj.beforeDataBound=this.childGridCell(cell,childGridObj,pdfExportProperties),childGridObj.appendTo(element)}this.parent.notify(exportRowDataBound,{type:"pdf",rowObj:row})}return rowIndex}childGridCell(cell,childGridObj,pdfExportProperties){return result=>(childGridObj.beforeDataBound=null,result.cancel=!0,cell.value=this.processGridExport(childGridObj,result,pdfExportProperties),childGridObj.destroy(),detach(childGridObj.element),this.gridPool[childGridObj.id]=!0,this.helper.checkAndExport(this.gridPool,this.globalResolve),cell)}processCellStyle(cell,args){if(!isNullOrUndefined(args.style.backgroundColor)){let backColor=this.hexToRgb(args.style.backgroundColor);cell.style.backgroundBrush=new PdfSolidBrush(new PdfColor(backColor.r,backColor.g,backColor.b))}if(isNullOrUndefined(args.style.textAlignment)||(cell.style.stringFormat=this.getHorizontalAlignment(args.style.textAlignment)),isNullOrUndefined(args.style.cellPadding)||(cell.style.cellPadding=args.style.cellPadding),isNullOrUndefined(args.style.verticalAlignment)||(cell.style.stringFormat=this.getVerticalAlignment(args.style.verticalAlignment,cell.style.stringFormat)),!isNullOrUndefined(args.style.textBrushColor)){let textBrushColor=this.hexToRgb(args.style.textBrushColor);cell.style.textBrush=new PdfSolidBrush(new PdfColor(textBrushColor.r,textBrushColor.g,textBrushColor.b))}if(!isNullOrUndefined(args.style.textPenColor)){let textPenColor=this.hexToRgb(args.style.textPenColor);cell.style.textPen=new PdfPen(new PdfColor(textPenColor.r,textPenColor.g,textPenColor.b))}if(isNullOrUndefined(args.style.fontFamily)&&isNullOrUndefined(args.style.fontSize)&&isNullOrUndefined(args.style.bold)&&isNullOrUndefined(args.style.italic)&&isNullOrUndefined(args.style.underline)&&isNullOrUndefined(args.style.strikeout)||(cell.style.font=this.getFont(args)),!isNullOrUndefined(args.style.border)){let border=new PdfBorders,borderWidth=args.style.border.width,width=isNullOrUndefined(borderWidth)||"number"!=typeof borderWidth?void 0:.75*borderWidth,color=new PdfColor(196,196,196);if(!isNullOrUndefined(args.style.border.color)){let borderColor=this.hexToRgb(args.style.border.color);color=new PdfColor(borderColor.r,borderColor.g,borderColor.b)}let pen=new PdfPen(color,width);isNullOrUndefined(args.style.border.dashStyle)||(pen.dashStyle=this.getDashStyle(args.style.border.dashStyle)),border.all=pen,cell.style.borders=border}isNullOrUndefined(args.style.paragraphIndent)||(cell.style.stringFormat=new PdfStringFormat,cell.style.stringFormat.paragraphIndent=args.style.paragraphIndent)}getHorizontalAlignment(textAlign,format){switch(void 0===format&&(format=new PdfStringFormat),textAlign){case"Right":format.alignment=PdfTextAlignment.Right;break;case"Center":format.alignment=PdfTextAlignment.Center;break;case"Justify":format.alignment=PdfTextAlignment.Justify;break;case"Left":format.alignment=PdfTextAlignment.Left}return format}getVerticalAlignment(verticalAlign,format,textAlign){switch(void 0===format&&(format=new PdfStringFormat,format=this.getHorizontalAlignment(textAlign,format)),verticalAlign){case"Bottom":format.lineAlignment=PdfVerticalAlignment.Bottom;break;case"Middle":format.lineAlignment=PdfVerticalAlignment.Middle;break;case"Top":format.lineAlignment=PdfVerticalAlignment.Top}return format}getFontFamily(fontFamily){switch(fontFamily){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}}getFont(content){if(content.style.font)return content.style.font;let fontSize=isNullOrUndefined(content.style.fontSize)?9.75:.75*content.style.fontSize,fontFamily=isNullOrUndefined(content.style.fontFamily)?PdfFontFamily.TimesRoman:this.getFontFamily(content.style.fontFamily),fontStyle=PdfFontStyle.Regular;return!isNullOrUndefined(content.style.bold)&&content.style.bold&&(fontStyle|=PdfFontStyle.Bold),!isNullOrUndefined(content.style.italic)&&content.style.italic&&(fontStyle|=PdfFontStyle.Italic),!isNullOrUndefined(content.style.underline)&&content.style.underline&&(fontStyle|=PdfFontStyle.Underline),!isNullOrUndefined(content.style.strikeout)&&content.style.strikeout&&(fontStyle|=PdfFontStyle.Strikeout),new PdfStandardFont(fontFamily,fontSize,fontStyle)}getPageNumberStyle(pageNumberType){switch(pageNumberType){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}}setContentFormat(content,format){if(!isNullOrUndefined(content.size)){let width=.75*content.size.width,height=.75*content.size.height;if(format=new PdfStringFormat(PdfTextAlignment.Left,PdfVerticalAlignment.Middle),!isNullOrUndefined(content.style.hAlign))switch(content.style.hAlign){case"Right":format.alignment=PdfTextAlignment.Right;break;case"Center":format.alignment=PdfTextAlignment.Center;break;case"Justify":format.alignment=PdfTextAlignment.Justify;break;default:format.alignment=PdfTextAlignment.Left}return isNullOrUndefined(content.style.vAlign)||(format=this.getVerticalAlignment(content.style.vAlign,format)),{format:format,size:new SizeF(width,height)}}return null}getPageSize(pageSize){switch(pageSize){case"Letter":return new SizeF(612,792);case"Note":return new SizeF(540,720);case"Legal":return new SizeF(612,1008);case"A0":return new SizeF(2380,3368);case"A1":return new SizeF(1684,2380);case"A2":return new SizeF(1190,1684);case"A3":return new SizeF(842,1190);case"A5":return new SizeF(421,595);case"A6":return new SizeF(297,421);case"A7":return new SizeF(210,297);case"A8":return new SizeF(148,210);case"A9":return new SizeF(105,148);case"B0":return new SizeF(2836,4008);case"B1":return new SizeF(2004,2836);case"B2":return new SizeF(1418,2004);case"B3":return new SizeF(1002,1418);case"B4":return new SizeF(709,1002);case"B5":return new SizeF(501,709);case"Archa":return new SizeF(648,864);case"Archb":return new SizeF(864,1296);case"Archc":return new SizeF(1296,1728);case"Archd":return new SizeF(1728,2592);case"Arche":return new SizeF(2592,3456);case"Flsa":return new SizeF(612,936);case"HalfLetter":return new SizeF(396,612);case"Letter11x17":return new SizeF(792,1224);case"Ledger":return new SizeF(1224,792);default:return new SizeF(595,842)}}getDashStyle(dashStyle){switch(dashStyle){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}}getPenFromContent(content){let pen=new PdfPen(new PdfColor(0,0,0));if(!isNullOrUndefined(content.style)&&null!==content.style&&!isNullOrUndefined(content.style.penColor)){let penColor=this.hexToRgb(content.style.penColor);pen=new PdfPen(new PdfColor(penColor.r,penColor.g,penColor.b))}return pen}getBrushFromContent(content){let brush=null;if(!isNullOrUndefined(content.style.textBrushColor)){let brushColor=this.hexToRgb(content.style.textBrushColor);brush=new PdfSolidBrush(new PdfColor(brushColor.r,brushColor.g,brushColor.b))}return brush}hexToRgb(hex){if(null===hex||""===hex||7!==hex.length)throw new Error("please set valid hex value for color...");hex=hex.substring(1);let bigint=parseInt(hex,16);return{r:bigint>>16&255,g:bigint>>8&255,b:255&bigint}}getFontStyle(theme){let fontStyle=PdfFontStyle.Regular;return!isNullOrUndefined(theme)&&theme.bold&&(fontStyle|=PdfFontStyle.Bold),!isNullOrUndefined(theme)&&theme.italic&&(fontStyle|=PdfFontStyle.Italic),!isNullOrUndefined(theme)&&theme.underline&&(fontStyle|=PdfFontStyle.Underline),!isNullOrUndefined(theme)&&theme.strikeout&&(fontStyle|=PdfFontStyle.Strikeout),fontStyle}getBorderStyle(border){let borders=new PdfBorders;if(isNullOrUndefined(border))borders.all=new PdfPen(new PdfColor(234,234,234));else{let borderWidth=border.width,width=isNullOrUndefined(borderWidth)||"number"!=typeof borderWidth?void 0:.75*borderWidth,color=new PdfColor(196,196,196);if(!isNullOrUndefined(border.color)){let borderColor=this.hexToRgb(border.color);color=new PdfColor(borderColor.r,borderColor.g,borderColor.b)}let pen=new PdfPen(color,width);isNullOrUndefined(border.dashStyle)||(pen.dashStyle=this.getDashStyle(border.dashStyle)),borders.all=pen}return borders}destroy(){}}const ej2_grids_es2015_menuClass={header:".e-gridheader",content:".e-gridcontent",edit:".e-inline-edit",batchEdit:".e-editedbatchcell",editIcon:"e-edit",pager:".e-gridpager",delete:"e-delete",save:"e-save",cancel:"e-cancel",copy:"e-copy",pdf:"e-pdfexport",group:"e-icon-group",ungroup:"e-icon-ungroup",csv:"e-csvexport",excel:"e-excelexport",fPage:"e-icon-first",nPage:"e-icon-next",lPage:"e-icon-last",pPage:"e-icon-prev",ascending:"e-icon-ascending",descending:"e-icon-descending",groupHeader:"e-groupdroparea",touchPop:"e-gridpopup"};class ej2_grids_es2015_ContextMenu$1{constructor(parent,serviceLocator){this.defaultItems={},this.disableItems=[],this.hiddenItems=[],this.localeText=this.setLocaleKey(),this.parent=parent,this.gridID=parent.element.id,this.serviceLocator=serviceLocator,this.addEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on(uiUpdate,this.enableAfterRenderMenu,this),this.parent.on(initialLoad,this.render,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(initialLoad,this.render),this.parent.off(uiUpdate,this.enableAfterRenderMenu),EventHandler.remove(this.element,"keydown",this.keyDownHandler.bind(this)))}keyDownHandler(e){"Tab"!==e.code&&9!==e.which||this.contextMenu.close()}render(){this.parent.element.classList.add("e-noselect"),this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_cmenu"}),EventHandler.add(this.element,"keydown",this.keyDownHandler.bind(this)),this.parent.element.appendChild(this.element);let target="#"+this.gridID;this.contextMenu=new ej2_navigations_es2015_ContextMenu({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:target,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-grid-menu"}),this.contextMenu.appendTo(this.element)}enableAfterRenderMenu(e){e.module===this.getModuleName()&&e.enable&&(this.contextMenu&&(this.contextMenu.destroy(),ej2_base_es2015_remove(this.element),this.parent.element.classList.remove("e-noselect")),this.render())}getMenuItems(){let menuItems=[],exportItems=[];for(let item of this.parent.contextMenuItems)"string"==typeof item&&-1!==this.getDefaultItems().indexOf(item)?-1!==item.toLocaleLowerCase().indexOf("export")?exportItems.push(this.buildDefaultItems(item)):menuItems.push(this.buildDefaultItems(item)):"string"!=typeof item&&menuItems.push(item);if(exportItems.length>0){let exportGroup=this.buildDefaultItems("export");exportGroup.items=exportItems,menuItems.push(exportGroup)}return menuItems}getLastPage(){let totalpage=Math.floor(this.parent.pageSettings.totalRecordsCount/this.parent.pageSettings.pageSize);return this.parent.pageSettings.totalRecordsCount%this.parent.pageSettings.pageSize&&(totalpage+=1),totalpage}contextMenuOpen(){this.isOpen=!0}contextMenuItemClick(args){switch(this.getKeyFromId(args.item.id)){case"AutoFitAll":this.parent.autoFitColumns([]);break;case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Edit":this.parent.editModule&&("Batch"===this.parent.editSettings.mode?this.row&&this.cell&&!isNaN(parseInt(this.cell.getAttribute("aria-colindex"),10))&&this.parent.editModule.editCell(parseInt(this.row.getAttribute("aria-rowindex"),10),this.parent.getColumns()[parseInt(this.cell.getAttribute("aria-colindex"),10)].field):(this.parent.editModule.endEdit(),this.parent.editModule.startEdit(this.row)));break;case"Delete":this.parent.editModule&&("Batch"!==this.parent.editSettings.mode&&this.parent.editModule.endEdit(),1===this.parent.getSelectedRecords().length?this.parent.editModule.deleteRow(this.row):this.parent.deleteRecord());break;case"Save":this.parent.editModule&&this.parent.editModule.endEdit();break;case"Cancel":this.parent.editModule&&this.parent.editModule.closeEdit();break;case"Copy":this.parent.copy();break;case"PdfExport":this.parent.pdfExport();break;case"ExcelExport":this.parent.excelExport();break;case"CsvExport":this.parent.csvExport();break;case"SortAscending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"FirstPage":this.parent.goToPage(1);break;case"PrevPage":this.parent.goToPage(this.parent.pageSettings.currentPage-1);break;case"LastPage":this.parent.goToPage(this.getLastPage());break;case"NextPage":this.parent.goToPage(this.parent.pageSettings.currentPage+1)}args.column=this.targetColumn,args.rowInfo=this.targetRowdata,this.parent.trigger(contextMenuClick,args)}contextMenuOnClose(args){args.items.length>0&&args.items[0].parentObj instanceof ej2_navigations_es2015_ContextMenu&&this.updateItemStatus()}getLocaleText(item){return this.l10n.getConstant(this.localeText[item])}updateItemStatus(){this.contextMenu.showItems(this.hiddenItems),this.contextMenu.enableItems(this.disableItems),this.hiddenItems=[],this.disableItems=[],this.isOpen=!1}contextMenuBeforeOpen(args){let closestGrid=closest(args.event.target,".e-grid");if(args.event&&closestGrid&&closestGrid!==this.parent.element)args.cancel=!0;else if(args.event&&(closest(args.event.target,"."+ej2_grids_es2015_menuClass.groupHeader)||closest(args.event.target,"."+ej2_grids_es2015_menuClass.touchPop)||closest(args.event.target,".e-summarycell")||closest(args.event.target,".e-groupcaption")||closest(args.event.target,".e-filterbarcell")))args.cancel=!0;else{this.targetColumn=this.getColumn(args.event),this.targetRowdata=this.parent.getRowInfo(args.event.target),isNullOrUndefined(args.parentItem)&&this.targetColumn&&this.selectRow(args.event,!args.event.target.classList.contains("e-selectionbackground")||"Multiple"!==this.parent.selectionSettings.type);let hideSepItems=[],showSepItems=[];for(let item of args.items){let key=this.getKeyFromId(item.id),dItem=this.defaultItems[key];if(-1!==this.getDefaultItems().indexOf(key))if(this.ensureDisabledStatus(key)&&this.disableItems.push(item.text),args.event&&(this.ensureTarget(args.event.target,ej2_grids_es2015_menuClass.edit)||this.ensureTarget(args.event.target,ej2_grids_es2015_menuClass.batchEdit)))"Save"!==key&&"Cancel"!==key&&this.hiddenItems.push(item.text);else{if(this.parent.editModule&&"Batch"===this.parent.editSettings.mode&&(closest(args.event.target,".e-gridform")||this.parent.editModule.getBatchChanges().changedRecords.length||this.parent.editModule.getBatchChanges().addedRecords.length||this.parent.editModule.getBatchChanges().deletedRecords.length)&&("Save"===key||"Cancel"===key))continue;isNullOrUndefined(args.parentItem)&&args.event&&!this.ensureTarget(args.event.target,dItem.target)&&this.hiddenItems.push(item.text)}else item.target&&args.event&&!this.ensureTarget(args.event.target,item.target)?item.separator?hideSepItems.push(item.id):this.hiddenItems.push(item.text):this.ensureTarget(args.event.target,item.target)&&item.separator&&showSepItems.push(item.id)}showSepItems.length>0&&this.contextMenu.showItems(showSepItems,!0),this.contextMenu.enableItems(this.disableItems,!1),this.contextMenu.hideItems(this.hiddenItems),hideSepItems.length>0&&this.contextMenu.hideItems(hideSepItems,!0),this.eventArgs=args.event,args.column=this.targetColumn,args.rowInfo=this.targetRowdata,this.parent.trigger(contextMenuOpen,args),(args.cancel||this.hiddenItems.length===args.items.length&&!args.parentItem)&&(this.updateItemStatus(),args.cancel=!0)}this.parent.applyBiggerTheme(this.contextMenu.element.parentElement)}ensureTarget(targetElement,selector){let target=targetElement;return(target=!this.ensureFrozenHeader(targetElement)||selector!==ej2_grids_es2015_menuClass.header&&selector!==ej2_grids_es2015_menuClass.content?selector===ej2_grids_es2015_menuClass.content||selector===ej2_grids_es2015_menuClass.header?parentsUntil(closest(targetElement,".e-table"),selector.substr(1,selector.length)):closest(targetElement,selector):closest(targetElement,selector===ej2_grids_es2015_menuClass.header?"thead":"tbody"))&&parentsUntil(target,"e-grid")===this.parent.element}ensureFrozenHeader(targetElement){return!(!this.parent.getFrozenColumns()&&!this.parent.frozenRows||!closest(targetElement,ej2_grids_es2015_menuClass.header))}ensureDisabledStatus(item){let status=!1;switch(item){case"AutoFitAll":case"AutoFit":status=!(this.parent.ensureModuleInjected(ej2_grids_es2015_Resize)&&!this.parent.isEdit)||this.targetColumn&&!this.targetColumn.field&&"AutoFit"===item;break;case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(ej2_grids_es2015_Group)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.field)&&(status=!0);break;case"Ungroup":(!this.parent.allowGrouping||!this.parent.ensureModuleInjected(ej2_grids_es2015_Group)||this.parent.ensureModuleInjected(ej2_grids_es2015_Group)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(status=!0);break;case"Edit":case"Delete":case"Save":case"Cancel":this.parent.editModule&&0!==this.parent.getDataRows().length||(status=!0);break;case"Copy":0!==this.parent.getSelectedRowIndexes().length&&0!==this.parent.getCurrentViewRecords().length||(status=!0);break;case"export":this.parent.allowExcelExport&&this.parent.excelExport&&(this.parent.ensureModuleInjected(ej2_grids_es2015_PdfExport)||this.parent.ensureModuleInjected(ej2_grids_es2015_ExcelExport))||(status=!0);break;case"PdfExport":this.parent.allowPdfExport&&this.parent.ensureModuleInjected(ej2_grids_es2015_PdfExport)||(status=!0);break;case"ExcelExport":case"CsvExport":this.parent.allowExcelExport&&this.parent.ensureModuleInjected(ej2_grids_es2015_ExcelExport)||(status=!0);break;case"SortAscending":case"SortDescending":!this.parent.allowSorting||!this.parent.ensureModuleInjected(ej2_grids_es2015_Sort)||this.targetColumn&&!this.targetColumn.field?status=!0:this.parent.ensureModuleInjected(ej2_grids_es2015_Sort)&&this.parent.sortSettings.columns.length>0&&this.targetColumn&&this.parent.sortSettings.columns.forEach(element=>{element.field===this.targetColumn.field&&element.direction.toLowerCase()===item.toLowerCase().replace("sort","").toLocaleLowerCase()&&(status=!0)});break;case"FirstPage":case"PrevPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(ej2_grids_es2015_Page)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(ej2_grids_es2015_Page)&&1===this.parent.pageSettings.currentPage)&&(status=!0);break;case"LastPage":case"NextPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(ej2_grids_es2015_Page)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(ej2_grids_es2015_Page)&&this.parent.pageSettings.currentPage===this.getLastPage())&&(status=!0)}return status}getContextMenu(){return this.element}destroy(){let gridElement=this.parent.element;gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.contextMenu.destroy(),ej2_base_es2015_remove(this.element),this.removeEventListener(),this.parent.element.classList.remove("e-noselect"))}getModuleName(){return"contextMenu"}generateID(item){return this.gridID+"_cmenu_"+item}getKeyFromId(id){return id.replace(this.gridID+"_cmenu_","")}buildDefaultItems(item){let menuItem;switch(item){case"AutoFitAll":case"AutoFit":menuItem={target:ej2_grids_es2015_menuClass.header};break;case"Group":menuItem={target:ej2_grids_es2015_menuClass.header,iconCss:ej2_grids_es2015_menuClass.group};break;case"Ungroup":menuItem={target:ej2_grids_es2015_menuClass.header,iconCss:ej2_grids_es2015_menuClass.ungroup};break;case"Edit":menuItem={target:ej2_grids_es2015_menuClass.content,iconCss:ej2_grids_es2015_menuClass.editIcon};break;case"Delete":menuItem={target:ej2_grids_es2015_menuClass.content,iconCss:ej2_grids_es2015_menuClass.delete};break;case"Save":menuItem={target:ej2_grids_es2015_menuClass.edit,iconCss:ej2_grids_es2015_menuClass.save};break;case"Cancel":menuItem={target:ej2_grids_es2015_menuClass.edit,iconCss:ej2_grids_es2015_menuClass.cancel};break;case"Copy":menuItem={target:ej2_grids_es2015_menuClass.content,iconCss:ej2_grids_es2015_menuClass.copy};break;case"export":menuItem={target:ej2_grids_es2015_menuClass.content};break;case"PdfExport":menuItem={target:ej2_grids_es2015_menuClass.content,iconCss:ej2_grids_es2015_menuClass.pdf};break;case"ExcelExport":menuItem={target:ej2_grids_es2015_menuClass.content,iconCss:ej2_grids_es2015_menuClass.excel};break;case"CsvExport":menuItem={target:ej2_grids_es2015_menuClass.content,iconCss:ej2_grids_es2015_menuClass.csv};break;case"SortAscending":menuItem={target:ej2_grids_es2015_menuClass.header,iconCss:ej2_grids_es2015_menuClass.ascending};break;case"SortDescending":menuItem={target:ej2_grids_es2015_menuClass.header,iconCss:ej2_grids_es2015_menuClass.descending};break;case"FirstPage":menuItem={target:ej2_grids_es2015_menuClass.pager,iconCss:ej2_grids_es2015_menuClass.fPage};break;case"PrevPage":menuItem={target:ej2_grids_es2015_menuClass.pager,iconCss:ej2_grids_es2015_menuClass.pPage};break;case"LastPage":menuItem={target:ej2_grids_es2015_menuClass.pager,iconCss:ej2_grids_es2015_menuClass.lPage};break;case"NextPage":menuItem={target:ej2_grids_es2015_menuClass.pager,iconCss:ej2_grids_es2015_menuClass.nPage}}return this.defaultItems[item]={text:this.getLocaleText(item),id:this.generateID(item),target:menuItem.target,iconCss:menuItem.iconCss?"e-icons "+menuItem.iconCss:""},this.defaultItems[item]}getDefaultItems(){return["AutoFitAll","AutoFit","Group","Ungroup","Edit","Delete","Save","Cancel","Copy","export","PdfExport","ExcelExport","CsvExport","SortAscending","SortDescending","FirstPage","PrevPage","LastPage","NextPage"]}setLocaleKey(){return{AutoFitAll:"autoFitAll",AutoFit:"autoFit",Copy:"Copy",Group:"Group",Ungroup:"Ungroup",Edit:"EditRecord",Delete:"DeleteRecord",Save:"Save",Cancel:"CancelButton",PdfExport:"Pdfexport",ExcelExport:"Excelexport",CsvExport:"Csvexport",export:"Export",SortAscending:"SortAscending",SortDescending:"SortDescending",FirstPage:"FirstPage",LastPage:"LastPage",PrevPage:"PreviousPage",NextPage:"NextPage"}}getColumn(e){let cell=closest(e.target,"th.e-headercell");if(cell){let uid=cell.querySelector(".e-headercelldiv, .e-stackedheadercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(uid)}return this.parent.getRowInfo(e.target).column||null}selectRow(e,isSelectable){this.cell=e.target,this.row=closest(e.target,"tr.e-row")||this.row,this.row&&isSelectable&&!parentsUntil(e.target,"e-gridpager")&&this.parent.selectRow(parseInt(this.row.getAttribute("aria-rowindex"),10))}}class ej2_grids_es2015_ColumnMenu{constructor(parent,serviceLocator){this.defaultItems={},this.localeText=this.setLocaleKey(),this.disableItems=[],this.hiddenItems=[],this.isOpen=!1,this.GROUP="e-icon-group",this.UNGROUP="e-icon-ungroup",this.ASCENDING="e-icon-ascending",this.DESCENDING="e-icon-descending",this.ROOT="e-columnmenu",this.FILTER="e-icon-filter",this.POP="e-filter-popup",this.WRAP="e-col-menu",this.CHOOSER="_chooser_",this.parent=parent,this.gridID=parent.element.id,this.serviceLocator=serviceLocator,this.addEventListener()}wireEvents(){this.getColumnMenuHandlers().forEach(ele=>{EventHandler.add(ele,"mousedown",this.columnMenuHandlerDown,this)})}unwireEvents(){this.getColumnMenuHandlers().forEach(ele=>{EventHandler.remove(ele,"mousedown",this.columnMenuHandlerDown)})}destroy(){let gridElement=this.parent.element;gridElement&&(gridElement.querySelector(".e-gridheader")||gridElement.querySelector(".e-gridcontent"))&&(this.columnMenu.destroy(),this.removeEventListener(),this.unwireFilterEvents(),this.unwireEvents(),ej2_base_es2015_remove(this.element))}columnMenuHandlerClick(e){e.target.classList.contains("e-columnmenu")&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.isOpen&&this.headerCell!==this.getHeaderCell(e)||document.querySelector(".e-grid-menu .e-menu-parent.e-ul")?(this.columnMenu.close(),this.openColumnMenu(e)):this.isOpen?this.columnMenu.close():this.openColumnMenu(e))}openColumnMenu(e){let pos={top:0,left:0};this.element.style.cssText="display:block;visibility:hidden";let elePos=this.element.getBoundingClientRect();this.element.style.cssText="display:none;visibility:visible",this.headerCell=this.getHeaderCell(e),Browser.isDevice?(pos.top=window.innerHeight/2-elePos.height/2,pos.left=window.innerWidth/2-elePos.width/2):this.parent.enableRtl?pos=calculatePosition(this.headerCell,"left","bottom"):(pos=calculatePosition(this.headerCell,"right","bottom")).left-=elePos.width,this.columnMenu.open(pos.top,pos.left),e.preventDefault(),this.parent.applyBiggerTheme(this.columnMenu.element.parentElement)}columnMenuHandlerDown(e){this.isOpen=!("none"===this.element.style.display||""===this.element.style.display)}getColumnMenuHandlers(){return[].slice.call(this.parent.getHeaderTable().querySelectorAll("."+this.ROOT))}addEventListener(){this.parent.isDestroyed||(this.parent.on(headerRefreshed,this.wireEvents,this),this.parent.on(uiUpdate,this.enableAfterRenderMenu,this),this.parent.on(initialEnd,this.render,this),this.isFilterItemAdded()&&this.parent.on(filterDialogCreated,this.filterPosition,this),this.parent.on(click,this.columnMenuHandlerClick,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(headerRefreshed,this.unwireEvents),this.parent.off(uiUpdate,this.enableAfterRenderMenu),this.parent.off(initialEnd,this.render),this.isFilterItemAdded()&&this.parent.off(filterDialogCreated,this.filterPosition),this.parent.off(click,this.columnMenuHandlerClick))}enableAfterRenderMenu(e){e.module===this.getModuleName()&&e.enable&&(this.columnMenu&&(this.columnMenu.destroy(),ej2_base_es2015_remove(this.element)),this.render())}render(){this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_columnmenu",className:"e-colmenu"}),this.parent.element.appendChild(this.element),this.columnMenu=new ej2_navigations_es2015_ContextMenu({cssClass:"e-grid-menu",enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,items:this.getItems(),select:this.columnMenuItemClick.bind(this),beforeOpen:this.columnMenuBeforeOpen.bind(this),onOpen:this.columnMenuOnOpen.bind(this),onClose:this.columnMenuOnClose.bind(this),beforeItemRender:this.beforeMenuItemRender.bind(this),beforeClose:this.columnMenuBeforeClose.bind(this)}),this.columnMenu.appendTo(this.element),this.wireFilterEvents()}wireFilterEvents(){!Browser.isDevice&&this.isFilterItemAdded()&&EventHandler.add(this.element,"mouseover",this.appendFilter,this)}unwireFilterEvents(){!Browser.isDevice&&this.isFilterItemAdded()&&EventHandler.remove(this.element,"mouseover",this.appendFilter)}beforeMenuItemRender(args){if(this.isChooserItem(args.item)){let field=this.getKeyFromId(args.item.id,this.CHOOSER),column=this.parent.columnModel.filter(col=>col.field===field),check=createCheckBox(this.parent.createElement,!1,{label:args.item.text,checked:column[0].visible});this.parent.enableRtl&&check.classList.add("e-rtl"),args.element.innerHTML="",args.element.appendChild(check)}else args.item.id&&"Filter"===this.getKeyFromId(args.item.id)&&(args.element.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),args.element.className+="e-filter-item e-menu-caret-icon")}columnMenuBeforeClose(args){let colChooser=args.event?closest(args.event.target,".e-menu-item"):null;!isNullOrUndefined(args.parentItem)&&"ColumnChooser"===this.getKeyFromId(args.parentItem.id)&&colChooser&&this.isChooserItem(colChooser)?args.cancel=!0:args.event&&(closest(args.event.target,"."+this.POP)||args.event.currentTarget&&args.event.currentTarget.activeElement&&parentsUntil(args.event.currentTarget.activeElement,"e-filter-popup")||parentsUntil(args.event.target,"e-popup")||parentsUntil(args.event.target,"e-popup-wrapper"))&&!Browser.isDevice&&(args.cancel=!0)}isChooserItem(item){return item.id&&item.id.indexOf("_colmenu_")>=0&&-1===this.getKeyFromId(item.id,this.CHOOSER).indexOf("_colmenu_")}columnMenuBeforeOpen(args){args.column=this.targetColumn=this.getColumn(),this.parent.trigger(columnMenuOpen,args);for(let item of args.items){let key=this.getKeyFromId(item.id),dItem=this.defaultItems[key];-1!==this.getDefaultItems().indexOf(key)&&(this.ensureDisabledStatus(key)&&!dItem.hide?this.disableItems.push(item.text):item.hide&&this.hiddenItems.push(item.text))}this.columnMenu.enableItems(this.disableItems,!1),this.columnMenu.hideItems(this.hiddenItems)}columnMenuOnOpen(args){"e-menu-parent e-ul "===args.element.className&&(args.element.offsetHeight>window.innerHeight?(args.element.style.maxHeight=.8*window.innerHeight+"px",args.element.style.overflowY="auto"):this.parent.element.offsetHeight>window.innerHeight&&(args.element.style.maxHeight=.8*window.innerHeight+"px",args.element.style.overflowY="auto"))}ensureDisabledStatus(item){let status=!1;switch(item){case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(ej2_grids_es2015_Group)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.allowGrouping)&&(status=!0);break;case"AutoFitAll":case"AutoFit":status=!this.parent.ensureModuleInjected(ej2_grids_es2015_Resize);break;case"Ungroup":(!this.parent.ensureModuleInjected(ej2_grids_es2015_Group)||this.parent.ensureModuleInjected(ej2_grids_es2015_Group)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(status=!0);break;case"SortDescending":case"SortAscending":this.parent.allowSorting&&this.parent.ensureModuleInjected(ej2_grids_es2015_Sort)&&this.parent.sortSettings.columns.length>0&&this.targetColumn&&this.targetColumn.allowSorting?this.parent.sortSettings.columns.forEach(ele=>{ele.field===this.targetColumn.field&&ele.direction.toLocaleLowerCase()===item.toLocaleLowerCase().replace("sort","")&&(status=!0)}):(!this.parent.allowSorting||!this.parent.ensureModuleInjected(ej2_grids_es2015_Sort)||this.parent.allowSorting&&this.targetColumn&&!this.targetColumn.allowSorting)&&(status=!0);break;case"Filter":this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(ej2_grids_es2015_Filter)&&this.targetColumn&&this.targetColumn.allowFiltering?status=!1:this.parent.ensureModuleInjected(ej2_grids_es2015_Filter)&&this.parent.allowFiltering&&this.targetColumn&&(!this.targetColumn.allowFiltering||"FilterBar"===this.parent.filterSettings.type)&&(status=!0)}return status}columnMenuItemClick(args){switch(this.isChooserItem(args.item)?"ColumnChooser":this.getKeyFromId(args.item.id)){case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"AutoFitAll":this.parent.autoFitColumns([]);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"SortAscending":this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"ColumnChooser":let key=this.getKeyFromId(args.item.id,this.CHOOSER),checkbox=args.element.querySelector(".e-checkbox-wrapper .e-frame");checkbox&&checkbox.classList.contains("e-check")?(checkbox.classList.remove("e-check"),this.parent.hideColumns(key,"field")):checkbox&&(this.parent.showColumns(key,"field"),checkbox.classList.add("e-check"));break;case"Filter":this.getFilter(args.element,args.item.id)}args.column=this.targetColumn,this.parent.trigger(columnMenuClick,args)}columnMenuOnClose(args){args.items.length>0&&args.items[0].parentObj instanceof ej2_navigations_es2015_ContextMenu&&(this.columnMenu.enableItems(this.disableItems,!1),this.disableItems=[],this.columnMenu.showItems(this.hiddenItems),this.hiddenItems=[],this.isFilterPopupOpen()&&this.getFilter(args.element,args.element.id,!0))}getDefaultItems(){return["AutoFitAll","AutoFit","SortAscending","SortDescending","Group","Ungroup","ColumnChooser","Filter"]}getItems(){let items=[],defultItems=this.parent.columnMenuItems?this.parent.columnMenuItems:this.getDefault();for(let item of defultItems)if("string"==typeof item)if("ColumnChooser"===item){let col=this.getDefaultItem(item);col.items=this.createChooserItems(),items.push(col)}else items.push(this.getDefaultItem(item));else items.push(item);return items}getDefaultItem(item){let menuItem={};switch(item){case"SortAscending":menuItem={iconCss:this.ASCENDING};break;case"SortDescending":menuItem={iconCss:this.DESCENDING};break;case"Group":menuItem={iconCss:this.GROUP};break;case"Ungroup":menuItem={iconCss:this.UNGROUP};break;case"Filter":menuItem={iconCss:this.FILTER}}return this.defaultItems[item]={text:this.getLocaleText(item),id:this.generateID(item),iconCss:menuItem.iconCss?"e-icons "+menuItem.iconCss:null},this.defaultItems[item]}getLocaleText(item){return this.l10n.getConstant(this.localeText[item])}generateID(item,append$$1){return this.gridID+"_colmenu_"+(append$$1?append$$1+item:item)}getKeyFromId(id,append$$1){return id.indexOf("_colmenu_")>0&&id.replace(this.gridID+"_colmenu_"+(append$$1||""),"")}getColumnMenu(){return this.element}getModuleName(){return"columnMenu"}setLocaleKey(){return{AutoFitAll:"autoFitAll",AutoFit:"autoFit",Group:"Group",Ungroup:"Ungroup",SortAscending:"SortAscending",SortDescending:"SortDescending",ColumnChooser:"Columnchooser",Filter:"FilterMenu"}}getHeaderCell(e){return closest(e.target,"th.e-headercell")}getColumn(){if(this.headerCell){let uid=this.headerCell.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(uid)}return null}createChooserItems(){let items=[];for(let col of this.parent.columnModel)col.showInColumnChooser&&col.field&&items.push({id:this.generateID(col.field,this.CHOOSER),text:col.headerText?col.headerText:col.field});return items}appendFilter(e){if(this.defaultItems.Filter){let key=this.defaultItems.Filter.id;closest(e.target,"#"+key)&&!this.isFilterPopupOpen()?this.getFilter(e.target,key):!closest(e.target,"#"+key)&&this.isFilterPopupOpen()&&this.getFilter(e.target,key,!0)}}getFilter(target,id,isClose){let filterPopup=this.getFilterPop();filterPopup?filterPopup.style.display=!Browser.isDevice&&isClose?"none":"block":this.parent.notify(filterOpen,{col:this.targetColumn,target:target,isClose:isClose,id:id})}setPosition(li,ul){let gridPos=this.parent.element.getBoundingClientRect(),liPos=li.getBoundingClientRect(),left=liPos.left-gridPos.left,top=liPos.top-gridPos.top;gridPos.height<top?top=top-ul.offsetHeight+liPos.height:gridPos.height<top+ul.offsetHeight&&(top=gridPos.height-ul.offsetHeight),window.innerHeight<ul.offsetHeight+top+gridPos.top&&(top=window.innerHeight-ul.offsetHeight-gridPos.top),gridPos.width<=(left+=this.parent.enableRtl?-ul.offsetWidth:liPos.width)+ul.offsetWidth?left-=liPos.width+ul.offsetWidth:left<0&&(left+=ul.offsetWidth+liPos.width),ul.style.top=top+"px",ul.style.left=left+"px"}filterPosition(e){let filterPopup=this.getFilterPop();if(filterPopup.classList.add(this.WRAP),!Browser.isDevice){let disp=filterPopup.style.display;filterPopup.style.cssText+="display:block;visibility:hidden";let li=this.element.querySelector("."+this.FILTER);li&&(this.setPosition(li.parentElement,filterPopup),filterPopup.style.cssText+="display:"+disp+";visibility:visible")}}getDefault(){let items=[];return this.parent.ensureModuleInjected(ej2_grids_es2015_Resize)&&(items.push("AutoFitAll"),items.push("AutoFit")),this.parent.allowGrouping&&this.parent.ensureModuleInjected(ej2_grids_es2015_Group)&&(items.push("Group"),items.push("Ungroup")),this.parent.allowSorting&&this.parent.ensureModuleInjected(ej2_grids_es2015_Sort)&&(items.push("SortAscending"),items.push("SortDescending")),items.push("ColumnChooser"),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(ej2_grids_es2015_Filter)&&items.push("Filter"),items}isFilterPopupOpen(){let filterPopup=this.getFilterPop();return filterPopup&&"none"!==filterPopup.style.display}getFilterPop(){return Browser.isDevice&&null!==this.targetColumn?document.getElementById(this.targetColumn.uid+"-flmdlg"):this.parent.element.querySelector("."+this.POP)}isFilterItemAdded(){return this.parent.columnMenuItems&&this.parent.columnMenuItems.indexOf("Filter")>=0||!this.parent.columnMenuItems}}class ej2_grids_es2015_ForeignKey extends ej2_grids_es2015_Data{constructor(parent,serviceLocator){super(parent,serviceLocator),this.parent=parent,this.serviceLocator=serviceLocator,this.initEvent()}initEvent(){this.parent.isDestroyed||(this.parent.on(initForeignKeyColumn,this.initForeignKeyColumns,this),this.parent.on(getForeignKeyData,this.getForeignKeyData,this),this.parent.on(generateQuery,this.generateQueryFormData,this))}initForeignKeyColumns(columns){columns.forEach(column=>{column.dataSource=column.dataSource instanceof ej2_data_es2015_DataManager?column.dataSource:isNullOrUndefined(column.dataSource)?new ej2_data_es2015_DataManager:new ej2_data_es2015_DataManager(column.dataSource)})}getForeignKeyData(args){let foreignColumns=args.column?[args.column]:this.parent.getForeignKeyColumns(),allPromise=[];foreignColumns.forEach(col=>{let promise,query=args.isComplex?this.genarateColumnQuery(col):this.genarateQuery(col,args.result.result,!1,!0);query.params=this.parent.query.params;let dataSource=col.dataSource;promise=!dataSource.ready||dataSource.dataSource.offline?dataSource.executeQuery(query):dataSource.ready.then(()=>dataSource.executeQuery(query)),allPromise.push(promise)}),Promise.all(allPromise).then(responses=>{responses.forEach((data,index)=>{foreignColumns[index].columnData=data.result}),args.promise.resolve(args.result)}).catch(e=>(this.parent.log(["actionfailure","foreign_key_failure"]),args.promise&&args.promise.reject&&args.promise.reject(e),e))}generateQueryFormData(args){args.predicate.predicate=this.genarateQuery(args.column,args.column.columnData,!0)}genarateQuery(column,e,fromData,needQuery){let predicate,gObj=this.parent,predicates=[],query=new ej2_data_es2015_Query,field=fromData?column.foreignKeyField:column.field;if(gObj.allowPaging||gObj.enableVirtualization||fromData){e=new ej2_data_es2015_DataManager(gObj.allowGrouping&&gObj.groupSettings.columns.length&&!fromData?e.records:e).executeLocal((new ej2_data_es2015_Query).select(field));let filteredValue=ej2_data_es2015_DataUtil.distinct(e,field,!1);field=fromData?column.field:column.foreignKeyField,filteredValue.forEach(obj=>{predicates.push(obj&&obj.getDay?getDatePredicate({field:field,operator:"equal",value:obj,matchCase:!1}):new ej2_data_es2015_Predicate(field,"equal",obj,!1))})}return needQuery?predicates.length?query.where(ej2_data_es2015_Predicate.or(predicates)):query:predicate=predicates.length?ej2_data_es2015_Predicate.or(predicates):{predicates:[]}}genarateColumnQuery(column){let gObj=this.parent,query=new ej2_data_es2015_Query,queryColumn=this.isFiltered(column);if(queryColumn.isTrue&&(query=this.filterQuery(query,queryColumn.column,!0)),gObj.searchSettings.key.length){let sSettings=gObj.searchSettings;query.search(sSettings.key,column.foreignKeyValue,sSettings.operator,sSettings.ignoreCase)}return query}isFiltered(column){let filterColumn=this.parent.filterSettings.columns.filter(fColumn=>fColumn.field===column.foreignKeyValue&&fColumn.uid===column.uid);return{column:filterColumn,isTrue:!!filterColumn.length}}getModuleName(){return"foreignKey"}destroy(){this.destroyEvent()}destroyEvent(){this.parent.isDestroyed||(this.parent.off(initForeignKeyColumn,this.initForeignKeyColumns),this.parent.off(getForeignKeyData,this.getForeignKeyData),this.parent.off(generateQuery,this.generateQueryFormData))}}class ej2_treegrid_es2015_Column{constructor(options){this.allowEditing=!0,this.edit={},this.allowReordering=!0,this.showColumnMenu=!0,this.allowFiltering=!0,this.allowSorting=!0,this.allowResizing=!0,this.filter={},ej2_base_es2015_merge(this,options)}}let ej2_treegrid_es2015_FilterSettings=(()=>{class FilterSettings extends ChildProperty{}return __decorate([Collection([],ej2_grids_es2015_Predicate$1)],FilterSettings.prototype,"columns",void 0),__decorate([Property("FilterBar")],FilterSettings.prototype,"type",void 0),__decorate([Property()],FilterSettings.prototype,"mode",void 0),__decorate([Property(!0)],FilterSettings.prototype,"showFilterBarStatus",void 0),__decorate([Property(1500)],FilterSettings.prototype,"immediateModeDelay",void 0),__decorate([Property()],FilterSettings.prototype,"operators",void 0),__decorate([Property(!1)],FilterSettings.prototype,"ignoreAccent",void 0),__decorate([Property("Parent")],FilterSettings.prototype,"hierarchyMode",void 0),FilterSettings})(),ej2_treegrid_es2015_TextWrapSettings=(()=>{class TextWrapSettings extends ChildProperty{}return __decorate([Property("Both")],TextWrapSettings.prototype,"wrapMode",void 0),TextWrapSettings})();const ej2_treegrid_es2015_rowDataBound="rowDataBound",ej2_treegrid_es2015_queryCellInfo="queryCellInfo",ej2_treegrid_es2015_beforeDataBound="beforeDataBound",ej2_treegrid_es2015_actionBegin="actionBegin",ej2_treegrid_es2015_actionComplete="actionComplete",checkboxChange="checkboxChange",ej2_treegrid_es2015_expanded="expanded",remoteExpand="remoteExpand",pagingActions="pagingActions",ej2_treegrid_es2015_printGridInit="printGrid-Init",ej2_treegrid_es2015_crudAction="crudAction",ej2_treegrid_es2015_beginEdit="beginEdit",beginAdd="beginAdd",ej2_treegrid_es2015_recordDoubleClick="recordDoubleClick",ej2_treegrid_es2015_cellSave="cellSave",ej2_treegrid_es2015_cellEdit="cellEdit",ej2_treegrid_es2015_batchCancel="batchCancel",ej2_treegrid_es2015_keyPressed="key-pressed",ej2_treegrid_es2015_doubleTap="double-tap",ej2_treegrid_es2015_beforeStartEdit="edit-form",ej2_treegrid_es2015_beforeBatchCancel="before-batch-cancel",ej2_treegrid_es2015_rowDrop="rowDrop",rowsAdd="rows-add",rowsRemove="rows-remove",rowdraging="row-draging",rowDropped="row-dropped";function isRemoteData(parent){if(parent.dataSource instanceof ej2_data_es2015_DataManager){let adaptor=parent.dataSource.adaptor;return adaptor instanceof ej2_data_es2015_ODataAdaptor||adaptor instanceof WebApiAdaptor||adaptor instanceof WebMethodAdaptor||adaptor instanceof ej2_data_es2015_CacheAdaptor||adaptor instanceof ej2_data_es2015_UrlAdaptor}return!1}function getExpandStatus(parent,record,parents){let childParent,parentRecord=isNullOrUndefined(record.parentItem)?null:getParentData(parent,record.parentItem.uniqueID);return null==parentRecord||(!parent.initialRender||isNullOrUndefined(parentRecord[parent.expandStateMapping])||parentRecord[parent.expandStateMapping]?!1!==parentRecord.expanded&&(!parentRecord.parentItem||((childParent=getParentData(parent,parentRecord.parentItem.uniqueID))&&parent.initialRender&&!isNullOrUndefined(childParent[parent.expandStateMapping])&&!childParent[parent.expandStateMapping]?(childParent.expanded=!1,!1):(!childParent||!1!==childParent.expanded)&&(!childParent||getExpandStatus(parent,childParent,parents)))):(parentRecord.expanded=!1,!1))}function findChildrenRecords(records){let datas=[];if(isNullOrUndefined(records)||!records.hasChildRecords)return[];if(!isNullOrUndefined(records.childRecords)){let childRecords=records.childRecords;for(let i=0,len=Object.keys(childRecords).length;i<len;i++)datas.push(childRecords[i]),childRecords[i].hasChildRecords&&(datas=[...datas,...findChildrenRecords(childRecords[i])])}return datas}function isOffline(parent){return!isRemoteData(parent)||!isNullOrUndefined(parent.dataSource.ready)}function extendArray(array){let obj,keys,objArr=[];for(let i=0;i<array.length;i++){keys=Object.keys(array[i]),obj={};for(let j=0;j<keys.length;j++)obj[keys[j]]=array[i][keys[j]];objArr.push(obj)}return objArr}function getParentData(parent,value,requireFilter){return requireFilter?parent.uniqueIDFilterCollection[value]:parent.uniqueIDCollection[value]}class ej2_treegrid_es2015_Selection{constructor(parent){this.parent=parent,this.selectedItems=[],this.selectedIndexes=[],this.addEventListener()}getModuleName(){return"selection"}addEventListener(){this.parent.on("dataBoundArg",this.headerCheckbox,this),this.parent.on("columnCheckbox",this.columnCheckbox,this),this.parent.on("updateGridActions",this.updateGridActions,this),this.parent.on("checkboxSelection",this.checkboxSelection,this)}removeEventListener(){this.parent.isDestroyed||(this.parent.off("dataBoundArg",this.headerCheckbox),this.parent.off("columnCheckbox",this.columnCheckbox),this.parent.off("checkboxSelection",this.checkboxSelection),this.parent.off("updateGridActions",this.updateGridActions))}destroy(){this.removeEventListener()}checkboxSelection(args){let checkBox,target=ej2_grids_es2015_getObject("target",args),checkWrap=parentsUntil(target,"e-checkbox-wrapper");if(checkWrap&&checkWrap.querySelectorAll(".e-treecheckselect").length>0){let rowIndex;checkBox=checkWrap.querySelector('input[type="checkbox"]'),(rowIndex=[]).push(target.closest("tr").rowIndex),this.selectCheckboxes(rowIndex),this.triggerChkChangeEvent(checkBox,checkBox.nextElementSibling.classList.contains("e-check"),target.closest("tr"))}else if(checkWrap&&checkWrap.querySelectorAll(".e-treeselectall").length>0&&this.parent.autoCheckHierarchy){let checkBoxvalue=!checkWrap.querySelector(".e-frame").classList.contains("e-check")&&!checkWrap.querySelector(".e-frame").classList.contains("e-stop");this.headerSelection(checkBoxvalue),checkBox=checkWrap.querySelector('input[type="checkbox"]'),this.triggerChkChangeEvent(checkBox,checkBoxvalue,target.closest("tr"))}}triggerChkChangeEvent(checkBox,checkState,rowElement){let data=this.parent.getCurrentViewRecords()[rowElement.rowIndex],args={checked:checkState,target:checkBox,rowElement:rowElement,rowData:checkBox.classList.contains("e-treeselectall")?this.parent.getCheckedRecords():data};this.parent.trigger(checkboxChange,args)}getCheckboxcolumnIndex(){let mappingUid,columnIndex,columns=this.parent.columns;for(let col=0;col<columns.length;col++)columns[col].showCheckbox&&(mappingUid=this.parent.columns[col].uid);let headerCelllength=this.parent.getHeaderTable().querySelectorAll(".e-headercelldiv").length;for(let j=0;j<headerCelllength;j++)this.parent.getHeaderTable().querySelectorAll(".e-headercelldiv")[j].getAttribute("e-mappinguid")===mappingUid&&(columnIndex=j);return columnIndex}headerCheckbox(){if(this.columnIndex=this.getCheckboxcolumnIndex(),this.columnIndex>-1&&0===this.parent.getHeaderTable().querySelectorAll(".e-treeselectall").length){let checkWrap,headerElement=this.parent.getHeaderTable().querySelectorAll(".e-headercelldiv")[this.columnIndex],value=!1,rowChkBox=this.parent.createElement("input",{className:"e-treeselectall",attrs:{type:"checkbox"}});(checkWrap=createCheckBox(this.parent.createElement,!1,{checked:value,label:" "})).classList.add("e-hierarchycheckbox"),checkWrap.querySelector(".e-frame").style.width="18px",checkWrap.insertBefore(rowChkBox.cloneNode(),checkWrap.firstChild),isNullOrUndefined(headerElement)||headerElement.insertBefore(checkWrap,headerElement.firstChild),this.headerSelection()}}renderColumnCheckbox(args){let checkWrap,rowChkBox=this.parent.createElement("input",{className:"e-treecheckselect",attrs:{type:"checkbox"}}),data=args.data;args.cell.classList.add("e-treegridcheckbox"),args.cell.setAttribute("aria-label","checkbox");let value=!isNullOrUndefined(data.checkboxState)&&"uncheck"!==data.checkboxState;return(checkWrap=createCheckBox(this.parent.createElement,!1,{checked:value,label:" "})).classList.add("e-hierarchycheckbox"),checkWrap.querySelector(".e-frame").style.width="18px","indeterminate"===data.checkboxState&&(removeClass([checkWrap.querySelectorAll(".e-frame")[0]],["e-check","e-stop","e-uncheck"]),checkWrap.querySelector(".e-frame").classList.add("e-stop")),checkWrap.insertBefore(rowChkBox.cloneNode(),checkWrap.firstChild),checkWrap}columnCheckbox(container){let checkWrap=this.renderColumnCheckbox(container),containerELe=container.cell.querySelector(".e-treecolumn-container");if(isNullOrUndefined(containerELe)){let spanEle=checkWrap.querySelector(".e-label"),data=container.cell.innerHTML;container.cell.innerHTML="",spanEle.innerHTML=data,container.cell.appendChild(checkWrap)}else containerELe.insertBefore(checkWrap,containerELe.querySelectorAll(".e-treecell")[0])}selectCheckboxes(rowIndexes){for(let i=0;i<rowIndexes.length;i++){let record=this.parent.getCurrentViewRecords()[rowIndexes[i]],checkboxState="uncheck"===record.checkboxState?"check":"uncheck";record.checkboxState=checkboxState;let keys=Object.keys(record),data=getParentData(this.parent,record.uniqueID);for(let j=0;j<keys.length;j++)data.hasOwnProperty(keys[j])&&(data[keys[j]]=record[keys[j]]);this.traverSelection(record,checkboxState,!1),this.parent.autoCheckHierarchy&&this.headerSelection()}}traverSelection(record,checkboxState,ischildItem){let length=0;if(this.updateSelectedItems(record,checkboxState),!ischildItem&&record.parentItem&&this.parent.autoCheckHierarchy&&this.updateParentSelection(record.parentItem),record.childRecords&&this.parent.autoCheckHierarchy){let childRecords=record.childRecords;!isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.parent.autoCheckHierarchy&&(childRecords=this.getFilteredChildRecords(childRecords)),length=childRecords.length;for(let count=0;count<length;count++)childRecords[count].hasChildRecords?this.traverSelection(childRecords[count],checkboxState,!0):this.updateSelectedItems(childRecords[count],checkboxState)}}getFilteredChildRecords(childRecords){return childRecords.filter(e=>this.parent.filterModule.filteredResult.indexOf(e)>-1)}updateParentSelection(parentRecord){let length=0,childRecords=[],record=getParentData(this.parent,parentRecord.uniqueID);record&&record.childRecords&&(childRecords=record.childRecords),!isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.parent.autoCheckHierarchy&&(childRecords=this.getFilteredChildRecords(childRecords)),length=childRecords&&childRecords.length;let indeter=0,checkChildRecords=0;if(!isNullOrUndefined(record)){for(let i=0;i<childRecords.length;i++)"indeterminate"===childRecords[i].checkboxState?indeter++:"check"===childRecords[i].checkboxState&&checkChildRecords++;record.checkboxState=indeter>0||checkChildRecords>0&&checkChildRecords!==length?"indeterminate":0===checkChildRecords&&0===indeter?"uncheck":"check",this.updateSelectedItems(record,record.checkboxState),record.parentItem&&this.updateParentSelection(record.parentItem)}}headerSelection(checkAll){let index=-1,length=0,data=!isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0?this.parent.filterModule.filteredResult:this.parent.flatData;if(!isNullOrUndefined(checkAll))for(let i=0;i<data.length;i++)if(checkAll){if("check"===data[i].checkboxState)continue;data[i].checkboxState="check",this.updateSelectedItems(data[i],data[i].checkboxState)}else(index=this.selectedItems.indexOf(data[i]))>-1&&(data[i].checkboxState="uncheck",this.updateSelectedItems(data[i],data[i].checkboxState),this.parent.autoCheckHierarchy&&this.updateParentSelection(data[i]));length=this.selectedItems.length;let checkbox=this.parent.getHeaderTable().querySelectorAll(".e-frame")[0];length>0&&data.length>0?length!==data.length?(removeClass([checkbox],["e-check"]),checkbox.classList.add("e-stop")):(removeClass([checkbox],["e-stop"]),checkbox.classList.add("e-check")):removeClass([checkbox],["e-check","e-stop"])}updateSelectedItems(currentRecord,checkState,filter){let checkbox,record=this.parent.getCurrentViewRecords().filter(e=>e.uniqueID===currentRecord.uniqueID),recordIndex=this.parent.getCurrentViewRecords().indexOf(record[0]);if(recordIndex>-1&&(isNullOrUndefined(checkbox=this.parent.getRows()[recordIndex].querySelectorAll(".e-frame")[0])||removeClass([checkbox],["e-check","e-stop","e-uncheck"])),currentRecord.checkboxState=checkState,"check"===checkState&&isNullOrUndefined(currentRecord.isSummaryRow))-1!==recordIndex&&-1===this.selectedIndexes.indexOf(recordIndex)&&this.selectedIndexes.push(recordIndex),-1===this.selectedItems.indexOf(currentRecord)&&-1!==recordIndex&&!isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.selectedItems.push(currentRecord),-1!==this.selectedItems.indexOf(currentRecord)||isNullOrUndefined(this.parent.filterModule)||0!==this.parent.filterModule.filteredResult.length||this.selectedItems.push(currentRecord),-1===this.selectedItems.indexOf(currentRecord)&&isNullOrUndefined(this.parent.filterModule)&&this.selectedItems.push(currentRecord);else if(("uncheck"===checkState||"indeterminate"===checkState)&&isNullOrUndefined(currentRecord.isSummaryRow)){let index=this.selectedItems.indexOf(currentRecord);if(-1!==index&&this.selectedItems.splice(index,1),-1!==this.selectedIndexes.indexOf(recordIndex)){let checkedIndex=this.selectedIndexes.indexOf(recordIndex);this.selectedIndexes.splice(checkedIndex,1)}}let checkBoxclass="indeterminate"===checkState?"e-stop":"e-"+checkState;recordIndex>-1&&(isNullOrUndefined(checkbox)||checkbox.classList.add(checkBoxclass))}updateGridActions(args){let childData,childLength,requestType=args.requestType;if(this.parent.autoCheckHierarchy)if("sorting"===requestType||"paging"===requestType){childLength=(childData=this.parent.getCurrentViewRecords()).length,this.selectedIndexes=[];for(let i=0;i<childLength;i++)this.updateSelectedItems(childData[i],childData[i].checkboxState,!0)}else if("delete"===requestType||"add"===args.action){let updatedData=[];"delete"===requestType?updatedData=args.data:updatedData.push(args.data);for(let i=0;i<updatedData.length;i++){if("delete"===requestType){let index=this.parent.flatData.indexOf(updatedData[i]),checkedIndex=this.selectedIndexes.indexOf(index);this.selectedIndexes.splice(checkedIndex,1),this.updateSelectedItems(updatedData[i],"uncheck")}isNullOrUndefined(updatedData[i].parentItem)||this.updateParentSelection(updatedData[i].parentItem)}}else"add"===args.requestType&&this.parent.autoCheckHierarchy?args.data.checkboxState="uncheck":"filtering"!==requestType&&"searching"!==requestType||(this.selectedItems=[],this.selectedIndexes=[],(childData=this.parent.filterModule.filteredResult.length>0?this.parent.getCurrentViewRecords():this.parent.flatData).forEach(record=>{record.hasChildRecords?this.updateParentSelection(record):this.updateSelectedItems(record,record.checkboxState)}),this.headerSelection())}getCheckedrecords(){return this.selectedItems}getCheckedRowIndexes(){return this.selectedIndexes}}class ej2_treegrid_es2015_ColumnMenu$1{constructor(parent){ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_ColumnMenu),this.parent=parent}getColumnMenu(){return this.parent.grid.columnMenuModule.getColumnMenu()}destroy(){}getModuleName(){return"columnMenu"}}class ej2_treegrid_es2015_Print$1{constructor(parent){this.parent=parent,ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_Print),this.addEventListener()}getModuleName(){return"print"}addEventListener(){this.parent.grid.on(ej2_treegrid_es2015_printGridInit,this.printTreeGrid,this)}removeEventListener(){this.parent.grid.off(ej2_treegrid_es2015_printGridInit,this.printTreeGrid)}printTreeGrid(printGrid){let grid=ej2_grids_es2015_getObject("printgrid",printGrid),gridElement=ej2_grids_es2015_getObject("element",printGrid);grid.addEventListener(ej2_treegrid_es2015_queryCellInfo,this.parent.grid.queryCellInfo),grid.addEventListener(ej2_treegrid_es2015_rowDataBound,this.parent.grid.rowDataBound),grid.addEventListener(ej2_treegrid_es2015_beforeDataBound,this.parent.grid.beforeDataBound),addClass([gridElement],"e-treegrid")}print(){this.parent.grid.print()}destroy(){this.removeEventListener()}}let ej2_treegrid_es2015_SearchSettings=(()=>{class SearchSettings extends ChildProperty{}return __decorate([Property()],SearchSettings.prototype,"fields",void 0),__decorate([Property(!1)],SearchSettings.prototype,"ignoreCase",void 0),__decorate([Property("contains")],SearchSettings.prototype,"operator",void 0),__decorate([Property()],SearchSettings.prototype,"key",void 0),__decorate([Property()],SearchSettings.prototype,"hierarchyMode",void 0),SearchSettings})(),ej2_treegrid_es2015_SelectionSettings=(()=>{class SelectionSettings extends ChildProperty{}return __decorate([Property("Row")],SelectionSettings.prototype,"mode",void 0),__decorate([Property("Flow")],SelectionSettings.prototype,"cellSelectionMode",void 0),__decorate([Property("Single")],SelectionSettings.prototype,"type",void 0),__decorate([Property(!1)],SelectionSettings.prototype,"persistSelection",void 0),__decorate([Property("Default")],SelectionSettings.prototype,"checkboxMode",void 0),__decorate([Property(!1)],SelectionSettings.prototype,"checkboxOnly",void 0),SelectionSettings})();class ej2_treegrid_es2015_Render{constructor(parent){this.parent=parent,this.templateResult=null,this.parent.grid.on("template-result",this.columnTemplateResult,this)}RowModifier(args){if(!args.data)return;let index,data=args.data,parentData=data.parentItem;if(isNullOrUndefined(data.parentItem)||this.parent.allowPaging&&"Root"!==this.parent.pageSettings.pageSizeMode&&(!isRemoteData(this.parent)||isOffline(this.parent))?index=+args.row.getAttribute("aria-rowindex"):(index=data.parentItem.index,(this.parent.initialRender&&(!isNullOrUndefined(parentData[this.parent.expandStateMapping])&&!parentData[this.parent.expandStateMapping]||this.parent.enableCollapseAll)||!getExpandStatus(this.parent,args.data,this.parent.grid.getCurrentViewRecords()))&&(args.row.style.display="none")),isRemoteData(this.parent)&&!isOffline(this.parent)){let proxy=this.parent,parentrec=this.parent.getCurrentViewRecords().filter(rec=>getValue(proxy.idMapping,rec)===getValue(proxy.parentIdMapping,data));parentrec.length>0&&args.row.setAttribute("style","display: "+(parentrec[0].expanded?"table-row":"none")+";")}addClass([args.row],"e-gridrowindex"+index+"level"+args.data.level),ej2_grids_es2015_getObject("isSummaryRow",args.data)&&addClass([args.row],"e-summaryrow"),args.row.querySelector(".e-treegridexpand")?args.row.setAttribute("aria-expanded","true"):args.row.querySelector(".e-treegridcollapse")&&args.row.setAttribute("aria-expanded","false"),this.parent.enableCollapseAll&&this.parent.initialRender&&(isNullOrUndefined(data.parentItem)||(args.row.style.display="none")),this.parent.trigger(ej2_treegrid_es2015_rowDataBound,args)}cellRender(args){if(!args.data)return;let cellElement,grid=this.parent.grid,data=args.data,pad=isNullOrUndefined(data.filterLevel)?data.level:data.filterLevel,totalIconsWidth=0,column=this.parent.getColumnByField(args.column.field),summaryRow=data.isSummaryRow;if(grid.getColumnIndexByUid(args.column.uid)===this.parent.treeColumnIndex){let container=ej2_base_es2015_createElement("div",{className:"e-treecolumn-container"}),emptyExpandIcon=ej2_base_es2015_createElement("span",{className:"e-icons e-none",styles:"width: 10px; display: inline-block"});for(let n=0;n<pad;n++)totalIconsWidth+=10,container.appendChild(emptyExpandIcon.cloneNode());let iconRequired=isNullOrUndefined(data.hasFilteredChildRecords)?data.hasChildRecords:data.hasFilteredChildRecords;if(iconRequired&&!isNullOrUndefined(data.childRecords)&&(iconRequired=!(0===data.childRecords.length)),iconRequired){addClass([args.cell],"e-treerowcell");let expand,expandIcon=ej2_base_es2015_createElement("span",{className:"e-icons"});expand=this.parent.initialRender?data.expanded&&(isNullOrUndefined(data[this.parent.expandStateMapping])||data[this.parent.expandStateMapping])&&!this.parent.enableCollapseAll:!(!data.expanded||!getExpandStatus(this.parent,data,this.parent.grid.getCurrentViewRecords()));let collapsed$$1=!0;isNullOrUndefined(data.parentItem)||isNullOrUndefined(data[this.parent.expandStateMapping])||!data[this.parent.expandStateMapping]||this.parent.allowPaging&&"Root"!==this.parent.pageSettings.pageSizeMode||(collapsed$$1=!getExpandStatus(this.parent,args.data,this.parent.grid.getCurrentViewRecords())),addClass([expandIcon],expand&&collapsed$$1?"e-treegridexpand":"e-treegridcollapse"),totalIconsWidth+=18,container.appendChild(expandIcon),emptyExpandIcon.style.width="7px",totalIconsWidth+=7,container.appendChild(emptyExpandIcon.cloneNode())}else(pad||!pad&&!data.level)&&(totalIconsWidth+=20,container.appendChild(emptyExpandIcon.cloneNode()),container.appendChild(emptyExpandIcon.cloneNode()));cellElement=ej2_base_es2015_createElement("span",{className:"e-treecell"}),this.parent.allowTextWrap&&(cellElement.style.width="Calc(100% - "+totalIconsWidth+"px)"),this.updateTreeCell(args,cellElement,container),container.appendChild(cellElement),args.cell.appendChild(container)}if(!isNullOrUndefined(column)&&column.showCheckbox&&(this.parent.notify("columnCheckbox",args),this.parent.allowTextWrap)){let checkboxElement=args.cell.querySelectorAll(".e-frame")[0],width=parseInt(checkboxElement.style.width,16);cellElement.style.width="Calc(100% - "+(totalIconsWidth+=width)+"px)"}if(summaryRow){addClass([args.cell],"e-summarycell");let summaryData=ej2_grids_es2015_getObject(args.column.field,args.data);null!=args.cell.querySelector(".e-treecell")?args.cell.querySelector(".e-treecell").innerHTML=summaryData:args.cell.innerHTML=summaryData}isNullOrUndefined(this.parent.rowTemplate)&&this.parent.trigger(ej2_treegrid_es2015_queryCellInfo,args)}updateTreeCell(args,cellElement,container){let textContent=null!=args.cell.querySelector(".e-treecell")?args.cell.querySelector(".e-treecell").innerHTML:args.cell.innerHTML;if("object"==typeof args.column.template&&this.templateResult)appendChildren(cellElement,this.templateResult),this.templateResult=null,args.cell.innerHTML="";else if(args.cell.classList.contains("e-templatecell")){let len=args.cell.children.length;for(let i=0;i<len;len=args.cell.children.length)cellElement.appendChild(args.cell.children[i])}else cellElement.innerHTML=textContent,args.cell.innerHTML=""}columnTemplateResult(args){this.templateResult=args.template}destroy(){this.parent.grid.off("template-result",this.columnTemplateResult)}}class ej2_treegrid_es2015_Sort$1{constructor(grid){ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_Sort),this.parent=grid,this.taskIds=[],this.flatSortedData=[],this.storedIndex=-1,this.isSelfReference=!isNullOrUndefined(this.parent.parentIdMapping),this.addEventListener()}getModuleName(){return"sort"}addEventListener(){this.parent.on("updateModel",this.updateModel,this),this.parent.on("createSort",this.createdSortedRecords,this)}removeEventListener(){this.parent.isDestroyed||(this.parent.off("updateModel",this.updateModel),this.parent.off("createSort",this.createdSortedRecords))}createdSortedRecords(sortParams){this.iterateSort(sortParams.modifiedData,sortParams.srtQry),this.storedIndex=-1,sortParams.modifiedData=this.flatSortedData,this.flatSortedData=[]}iterateSort(data,srtQry){for(let d=0;d<data.length;d++)if((this.parent.grid.filterSettings.columns.length>0||""!==this.parent.grid.searchSettings.key)&&isNullOrUndefined(getParentData(this.parent,data[d].uniqueID,!0))||(this.storedIndex++,this.flatSortedData[this.storedIndex]=data[d]),data[d].hasChildRecords){let childSort=new ej2_data_es2015_DataManager(data[d].childRecords).executeLocal(srtQry);this.iterateSort(childSort,srtQry)}}sortColumn(columnName,direction,isMultiSort){this.parent.grid.sortColumn(columnName,direction,isMultiSort)}removeSortColumn(field){this.parent.grid.removeSortColumn(field)}updateModel(){this.parent.setProperties({sortSettings:getActualProperties(this.parent.grid.sortSettings)},!0)}clearSorting(){this.parent.grid.clearSorting(),this.updateModel()}destroy(){this.removeEventListener()}}class ej2_treegrid_es2015_DataManipulation{constructor(grid){this.parent=grid,this.parentItems=[],this.taskIds=[],this.hierarchyData=[],this.storedIndex=-1,this.sortedData=[],this.isSortAction=!1,this.addEventListener(),this.dataResults={},this.isSelfReference=!isNullOrUndefined(this.parent.parentIdMapping)}addEventListener(){this.parent.on("updateRemoteLevel",this.updateParentRemoteData,this),this.parent.grid.on("sorting-begin",this.beginSorting,this),this.parent.on("updateAction",this.updateData,this),this.parent.on(remoteExpand,this.collectExpandingRecs,this),this.parent.on("dataProcessor",this.dataProcessor,this)}removeEventListener(){this.parent.isDestroyed||(this.parent.off(remoteExpand,this.collectExpandingRecs),this.parent.off("updateRemoteLevel",this.updateParentRemoteData),this.parent.off("updateAction",this.updateData),this.parent.off("dataProcessor",this.dataProcessor),this.parent.grid.off("sorting-begin",this.beginSorting))}destroy(){this.removeEventListener()}isRemote(){return this.parent.dataSource instanceof ej2_data_es2015_DataManager}convertToFlatData(data){if(this.parent.flatData=0!==Object.keys(data).length||this.parent.dataSource instanceof ej2_data_es2015_DataManager?[]:this.parent.dataSource,this.parent.parentData=[],isRemoteData(this.parent)&&!isOffline(this.parent)&&data instanceof ej2_data_es2015_DataManager&&!(data instanceof Array)){let dm=this.parent.dataSource;if(this.parent.parentIdMapping&&(this.parent.query=isNullOrUndefined(this.parent.query)?new ej2_data_es2015_Query:this.parent.query,this.parent.parentIdMapping&&this.parent.initialRender&&(this.parent.query.where(this.parent.parentIdMapping,"equal",null),this.parent.query.addParams("IdMapping",this.parent.idMapping)),!this.parent.hasChildMapping&&"BlazorAdaptor"!==this.parent.dataSource.adaptorName)){let qry=this.parent.query.clone();qry.queries=[],(qry=qry.select([this.parent.parentIdMapping])).isCountRequired=!0,dm.executeQuery(qry).then(e=>{this.parentItems=ej2_data_es2015_DataUtil.distinct(e.result,this.parent.parentIdMapping,!1),0===ej2_grids_es2015_getObject("dataSource.requests",this.parent).filter(e=>"OK"!==e.httpRequest.statusText).length&&(setValue("grid.contentModule.isLoaded",!0,this.parent),isNullOrUndefined(this.zerothLevelData)||(setValue("cancel",!1,this.zerothLevelData),getValue("grid.renderModule",this.parent).dataManagerSuccess(this.zerothLevelData),this.zerothLevelData=null),this.parent.grid.hideSpinner())})}}else if(data instanceof Array){this.hierarchyData=[],this.taskIds=[];for(let i=0;i<Object.keys(data).length;i++){let tempData=data[i];this.hierarchyData.push(extend({},tempData)),isNullOrUndefined(tempData[this.parent.idMapping])||this.taskIds.push(tempData[this.parent.idMapping])}if(this.isSelfReference){let selfData=[],mappingData=new ej2_data_es2015_DataManager(this.hierarchyData).executeLocal((new ej2_data_es2015_Query).group(this.parent.parentIdMapping));for(let i=0;i<mappingData.length;i++){let groupData=mappingData[i],index=this.taskIds.indexOf(groupData.key);!isNullOrUndefined(groupData.key)&&index>-1?this.hierarchyData[index][this.parent.childMapping]=groupData.items:selfData.push.apply(selfData,groupData.items)}this.hierarchyData=this.selfReferenceUpdate(selfData)}Object.keys(this.hierarchyData).length?this.createRecords(this.hierarchyData):this.parent.flatData=this.parent.dataSource instanceof ej2_data_es2015_DataManager?[]:this.parent.dataSource,this.storedIndex=-1}}selfReferenceUpdate(selfData){let result=[];for(;this.hierarchyData.length>0&&selfData.length>0;){let index=selfData.indexOf(this.hierarchyData[0]);-1===index?this.hierarchyData.shift():(result.push(this.hierarchyData.shift()),selfData.splice(index,1))}return result}updateParentRemoteData(args){let records=args.result;if(this.parent.hasChildMapping||this.parentItems.length||"BlazorAdaptor"===this.parent.dataSource.adaptorName||this.parent.loadChildOnDemand)if("BlazorAdaptor"===this.parent.dataSource.adaptorName||this.parent.loadChildOnDemand)this.convertToFlatData(records);else for(let rec=0;rec<records.length;rec++)(records[rec][this.parent.hasChildMapping]||-1!==this.parentItems.indexOf(records[rec][this.parent.idMapping]))&&isNullOrUndefined(records[rec].index)&&(records[rec].level=0,records[rec].index=Math.ceil(1e3*Math.random()),records[rec].hasChildRecords=!0);else this.zerothLevelData=args,setValue("cancel",!0,args);args.result="BlazorAdaptor"===this.parent.dataSource.adaptorName||this.parent.loadChildOnDemand?this.parent.flatData:records,this.parent.notify("updateResults",args)}collectExpandingRecs(rowDetails){let gridRows=this.parent.getRows(),args={row:rowDetails.parentRow,data:rowDetails.record};if(rowDetails.rows.length>0){rowDetails.record.expanded=!0;for(let i=0;i<rowDetails.rows.length;i++){if(rowDetails.rows[i].style.display="table-row",isBlazor()&&"BlazorAdaptor"===this.parent.dataSource.adaptorName||!this.parent.loadChildOnDemand){let targetEle=rowDetails.rows[i].getElementsByClassName("e-treegridcollapse")[0];isNullOrUndefined(targetEle)||(addClass([targetEle],"e-treegridexpand"),removeClass([targetEle],"e-treegridcollapse"));let childRecord=this.parent.grid.getRowObjectFromUID(rowDetails.rows[i].getAttribute("data-Uid")).data,childRows=gridRows.filter(r=>r.classList.contains("e-gridrowindex"+childRecord.index+"level"+(childRecord.level+1)));childRows.length&&this.collectExpandingRecs({record:childRecord,rows:childRows,parentRow:rowDetails.parentRow})}let expandingTd=rowDetails.rows[i].querySelector(".e-detailrowcollapse");isNullOrUndefined(expandingTd)||this.parent.grid.detailRowModule.expand(expandingTd)}}else{let dm=this.parent.dataSource,qry=this.parent.grid.getDataModule().generateQuery(),clonequries=qry.queries.filter(e=>"onPage"!==e.fn&&"onWhere"!==e.fn);qry.queries=clonequries,qry.isCountRequired=!0,qry.where(this.parent.parentIdMapping,"equal",rowDetails.record[this.parent.idMapping]),showSpinner(this.parent.element),dm.executeQuery(qry).then(e=>{let datas=this.parent.grid.currentViewData,inx=datas.indexOf(rowDetails.record),haveChild=ej2_grids_es2015_getObject("actual.nextLevel",e),result=e.result;rowDetails.record.childRecords=result;for(let r=0;r<result.length;r++)result[r].level=rowDetails.record.level+1,result[r].index=Math.ceil(1e3*Math.random()),result[r].parentItem=rowDetails.record,delete result[r].parentItem.childRecords,!result[r][this.parent.hasChildMapping]&&-1===this.parentItems.indexOf(result[r][this.parent.idMapping])||haveChild&&!haveChild[r]||(result[r].hasChildRecords=!0,result[r].expanded=!1,result[r].uniqueID=getUid(this.parent.element.id+"_data_"),setValue("uniqueIDCollection."+result[r].uniqueID,result[r],this.parent)),datas.splice(inx+r+1,0,result[r]);setValue("result",datas,e),setValue("action","beforecontentrender",e),this.parent.trigger(ej2_treegrid_es2015_actionComplete,e),hideSpinner(this.parent.element),e.count=this.parent.grid.pageSettings.totalRecordsCount,getValue("grid.renderModule",this.parent).dataManagerSuccess(e),this.parent.trigger(ej2_treegrid_es2015_expanded,args)})}}beginSorting(){this.isSortAction=!0}createRecords(data,parentRecords){let treeGridData=[];for(let i=0,len=Object.keys(data).length;i<len;i++){let currentData=extend({},data[i]);currentData.taskData=data[i];let level=0;if(this.storedIndex++,currentData.index=this.storedIndex,isNullOrUndefined(currentData[this.parent.childMapping])||(currentData.hasChildRecords=!0,currentData.expanded=!this.parent.enableCollapseAll&&(!!isNullOrUndefined(currentData[this.parent.expandStateMapping])||currentData[this.parent.expandStateMapping])),currentData.index=this.storedIndex,this.isSelfReference&&isNullOrUndefined(currentData[this.parent.parentIdMapping])&&this.parent.parentData.push(currentData),currentData.uniqueID=getUid(this.parent.element.id+"_data_"),setValue("uniqueIDCollection."+currentData.uniqueID,currentData,this.parent),!isNullOrUndefined(parentRecords)){let parentData=extend({},parentRecords);delete parentData.childRecords,delete parentData[this.parent.childMapping],this.isSelfReference&&delete parentData.taskData[this.parent.childMapping],currentData.parentItem=parentData,currentData.parentUniqueID=parentData.uniqueID,level=parentRecords.level+1}if(currentData.level=level,currentData.checkboxState="uncheck",(isNullOrUndefined(currentData[this.parent.parentIdMapping])||currentData.parentItem)&&this.parent.flatData.push(currentData),this.isSelfReference||0!==currentData.level||this.parent.parentData.push(currentData),!isNullOrUndefined(currentData[this.parent.childMapping]&&currentData[this.parent.childMapping].length)){let record=this.createRecords(currentData[this.parent.childMapping],currentData);currentData.childRecords=record}treeGridData.push(currentData)}return treeGridData}dataProcessor(args){let dataObj,isExport=ej2_grids_es2015_getObject("isExport",args),expresults=ej2_grids_es2015_getObject("expresults",args),exportType=ej2_grids_es2015_getObject("exportType",args),isPrinting=ej2_grids_es2015_getObject("isPrinting",args),actionArgs=ej2_grids_es2015_getObject("actionArgs",args),requestType=ej2_grids_es2015_getObject("requestType",args),actionData=ej2_grids_es2015_getObject("data",args),action=ej2_grids_es2015_getObject("action",args);(!isNullOrUndefined(actionArgs)&&Object.keys(actionArgs).length||"save"===requestType)&&(requestType=requestType||actionArgs.requestType.toString(),actionData=actionData||ej2_grids_es2015_getObject("data",actionArgs),"add"===(action=action||ej2_grids_es2015_getObject("action",actionArgs))&&(this.parent.grid.currentViewData=args.result),this.parent.isLocalData&&("delete"!==requestType&&"save"!==requestType||this.parent.notify(ej2_treegrid_es2015_crudAction,{value:actionData,action:action||requestType})));let results=(dataObj=isExport&&!isNullOrUndefined(expresults)?expresults:this.parent.grid.dataSource)instanceof ej2_data_es2015_DataManager?dataObj.dataSource.json:dataObj,count=results.length;if(this.parent.grid.allowFiltering&&this.parent.grid.filterSettings.columns.length||this.parent.grid.searchSettings.key.length>0){let qry=new ej2_data_es2015_Query,gridQuery=ej2_grids_es2015_getObject("query",args);isNullOrUndefined(gridQuery)&&(gridQuery=new ej2_data_es2015_Query,gridQuery=getValue("grid.renderModule.data",this.parent).filterQuery(gridQuery),gridQuery=getValue("grid.renderModule.data",this.parent).searchQuery(gridQuery));let fltrQuery=gridQuery.queries.filter(q=>"onWhere"===q.fn),srchQuery=gridQuery.queries.filter(q=>"onSearch"===q.fn);qry.queries=fltrQuery.concat(srchQuery);let filteredData=new ej2_data_es2015_DataManager(results).executeLocal(qry);if(this.parent.notify("updateFilterRecs",{data:filteredData}),results=this.dataResults.result,this.dataResults.result=null,this.parent.grid.aggregates.length>0){let query=ej2_grids_es2015_getObject("query",args);if(isNullOrUndefined(gridQuery)&&(gridQuery=getValue("grid.renderModule.data",this.parent).aggregateQuery(new ej2_data_es2015_Query)),!isNullOrUndefined(query)){let summaryQuery=query.queries.filter(q=>"onAggregates"===q.fn);results=this.parent.summaryModule.calculateSummaryValue(summaryQuery,results,!0)}}}if(this.parent.grid.aggregates.length&&0===this.parent.grid.sortSettings.columns.length&&0===this.parent.grid.filterSettings.columns.length&&!this.parent.grid.searchSettings.key.length){let gridQuery=ej2_grids_es2015_getObject("query",args);isNullOrUndefined(gridQuery)&&(gridQuery=getValue("grid.renderModule.data",this.parent).aggregateQuery(new ej2_data_es2015_Query));let summaryQuery=gridQuery.queries.filter(q=>"onAggregates"===q.fn);results=this.parent.summaryModule.calculateSummaryValue(summaryQuery,this.parent.flatData,!0)}if(this.parent.grid.sortSettings.columns.length>0||this.isSortAction){let parentData;this.isSortAction=!1,parentData=this.parent.parentData;let query=ej2_grids_es2015_getObject("query",args);this.parent.sortModule=new ej2_treegrid_es2015_Sort$1(this.parent);let srtQry=new ej2_data_es2015_Query;for(let srt=this.parent.grid.sortSettings.columns.length-1;srt>=0;srt--){let col=this.parent.getColumnByField(this.parent.grid.sortSettings.columns[srt].field),compFun=col.sortComparer&&!this.isRemote()?col.sortComparer.bind(col):this.parent.grid.sortSettings.columns[srt].direction;srtQry.sortBy(this.parent.grid.sortSettings.columns[srt].field,compFun)}let sortArgs={modifiedData:new ej2_data_es2015_DataManager(parentData).executeLocal(srtQry),filteredData:results,srtQry:srtQry};if(this.parent.notify("createSort",sortArgs),results=sortArgs.modifiedData,this.dataResults.result=null,this.sortedData=results,this.parent.notify("updateModel",{}),this.parent.grid.aggregates.length>0&&!isNullOrUndefined(query)){let isSort=!1,summaryQuery=ej2_grids_es2015_getObject("query",args).queries.filter(q=>"onAggregates"===q.fn);results=this.parent.summaryModule.calculateSummaryValue(summaryQuery,this.sortedData,isSort)}}let temp=this.paging(results,count=results.length,isExport,isPrinting,exportType,args);count=temp.count,args.result=results=temp.result,args.count=count,this.parent.notify("updateResults",args)}paging(results,count,isExport,isPrinting,exportType,args){return!this.parent.allowPaging||isExport&&"CurrentPage"!==exportType||isPrinting&&"CurrentPage"!==this.parent.printMode?!this.parent.enableVirtualization||isExport&&"CurrentPage"!==exportType||(this.parent.notify(pagingActions,{result:results,count:count,actionArgs:getValue("actionArgs",args)}),results=this.dataResults.result,count=this.dataResults.count):(this.parent.notify(pagingActions,{result:results,count:count}),results=this.dataResults.result,count=this.dataResults.count),{result:results,count:count}}updateData(dataResult){this.dataResults=dataResult}}function editAction(details,control,isSelfReference,addRowIndex,selectedIndex,columnName,addRowRecord){let i,j,value=details.value,action=details.action,key=control.grid.getPrimaryKeyFieldNames()[0],treeData=control.dataSource instanceof ej2_data_es2015_DataManager?control.dataSource.dataSource.json:control.dataSource,modifiedData=[],originalData=value,isSkip=!1;if(control.grid.getCurrentViewRecords(),"add"===action){let addAct=function(details,treeData,control,isSelfReference,addRowIndex,selectedIndex,addRowRecord){let value,isSkip=!1,currentViewRecords=control.grid.getCurrentViewRecords();switch(value=function(value){return delete value.hasChildRecords,delete value.childRecords,delete value.index,delete value.parentItem,delete value.level,value}(value=extend({},details.value)),control.editSettings.newRowPosition){case"Top":treeData.unshift(value),isSkip=!0;break;case"Bottom":treeData.push(value),isSkip=!0;break;case"Above":value=isNullOrUndefined(addRowRecord)?currentViewRecords[addRowIndex+1]:addRowRecord;break;case"Below":case"Child":value=isNullOrUndefined(addRowRecord)?currentViewRecords[addRowIndex]:addRowRecord,-1===selectedIndex&&(treeData.unshift(value),isSkip=!0)}return{value:value,isSkip:isSkip}}(details,treeData,control,0,addRowIndex,selectedIndex,addRowRecord);value=addAct.value,isSkip=addAct.isSkip}if(value instanceof Array?modifiedData=extendArray(value):modifiedData.push(extend({},value)),!isSkip&&("add"!==action||"Top"!==control.editSettings.newRowPosition&&"Bottom"!==control.editSettings.newRowPosition))for(let k=0;k<modifiedData.length;k++){let keys=Object.keys(modifiedData[k].taskData);for(i=treeData.length;i--&&i>=0;)if(treeData[i][key]===modifiedData[k][key]){if("delete"!==action){if("edit"===action)for(j=0;j<keys.length;j++)!treeData[i].hasOwnProperty(keys[j])||"Cell"===control.editSettings.mode&&keys[j]!==columnName||(getParentData(control,modifiedData[k].uniqueID).taskData[keys[j]]=treeData[i][keys[j]]=modifiedData[k][keys[j]]);else if("add"===action){let index;"Child"===control.editSettings.newRowPosition?isSelfReference?(originalData.taskData[control.parentIdMapping]=treeData[i][control.idMapping],treeData.splice(i+1,0,originalData.taskData)):(treeData[i].hasOwnProperty(control.childMapping)||(treeData[i][control.childMapping]=[]),treeData[i][control.childMapping].push(originalData.taskData),updateParentRow(key,treeData[i],action,control,isSelfReference,originalData)):"Below"===control.editSettings.newRowPosition?(treeData.splice(i+1,0,originalData.taskData),updateParentRow(key,treeData[i],action,control,isSelfReference,originalData)):addRowIndex?"Above"===control.editSettings.newRowPosition&&(treeData.splice(i,0,originalData.taskData),updateParentRow(key,treeData[i],action,control,isSelfReference,originalData)):treeData.splice(index=0,0,originalData.taskData)}break}{let currentData=treeData[i];if(treeData.splice(i,1),isSelfReference){if(!isNullOrUndefined(currentData[control.parentIdMapping])){let parentData=control.flatData.filter(e=>e[control.idMapping]===currentData[control.parentIdMapping])[0],childRecords=parentData?parentData[control.childMapping]:[];for(let p=childRecords.length-1;p>=0;p--)if(childRecords[p][control.idMapping]===currentData[control.idMapping]){childRecords.splice(p,1),childRecords.length||(parentData.hasChildRecords=!1,updateParentRow(key,parentData,action,control,isSelfReference));break}}break}}}else isNullOrUndefined(treeData[i][control.childMapping])||removeChildRecords(treeData[i][control.childMapping],modifiedData[k],action,key,control,isSelfReference,originalData,columnName)&&updateParentRow(key,treeData[i],action,control,isSelfReference)}}function removeChildRecords(childRecords,modifiedData,action,key,control,isSelfReference,originalData,columnName){let isChildAll=!1,j=childRecords.length;for(;j--&&j>=0;)if(childRecords[j][key]===modifiedData[key]||isSelfReference&&childRecords[j][control.parentIdMapping]===modifiedData[control.idMapping]){if("edit"===action){let keys=Object.keys(modifiedData),editedData=getParentData(control,modifiedData.uniqueID);for(let i=0;i<keys.length;i++)!childRecords[j].hasOwnProperty(keys[i])||"Cell"===control.editSettings.mode&&keys[i]!==columnName||(editedData[keys[i]]=editedData.taskData[keys[i]]=childRecords[j][keys[i]]=modifiedData[keys[i]]);break}"add"===action?"Child"===control.editSettings.newRowPosition?isSelfReference?(originalData[control.parentIdMapping]=childRecords[j][control.idMapping],childRecords.splice(j+1,0,originalData),updateParentRow(key,childRecords[j],action,control,isSelfReference,originalData)):(childRecords[j].hasOwnProperty(control.childMapping)||(childRecords[j][control.childMapping]=[]),childRecords[j][control.childMapping].push(originalData.taskData),updateParentRow(key,childRecords[j],action,control,isSelfReference,originalData)):"Above"===control.editSettings.newRowPosition?(childRecords.splice(j,0,originalData.taskData),updateParentRow(key,childRecords[j],action,control,isSelfReference,originalData)):"Below"===control.editSettings.newRowPosition&&(childRecords.splice(j+1,0,originalData.taskData),updateParentRow(key,childRecords[j],action,control,isSelfReference,originalData)):(childRecords.splice(j,1),childRecords.length||(isChildAll=!0))}else isNullOrUndefined(childRecords[j][control.childMapping])||removeChildRecords(childRecords[j][control.childMapping],modifiedData,action,key,control,isSelfReference,originalData,columnName)&&updateParentRow(key,childRecords[j],action,control,isSelfReference);return isChildAll}function updateParentRow(key,record,action,control,isSelfReference,child){if("Above"!==control.editSettings.newRowPosition&&"Below"!==control.editSettings.newRowPosition||"add"!==action||isNullOrUndefined(child.parentItem)){let index,currentRecords=control.grid.getCurrentViewRecords();if(currentRecords.map((e,i)=>{e[key]!==record[key]||(index=i)}),(record=currentRecords[index]).hasChildRecords=!1,"add"===action){record.expanded=!0,record.hasChildRecords=!0,control.sortSettings.columns.length&&isNullOrUndefined(child)&&(child=currentRecords.filter(e=>e.parentUniqueID===record.uniqueID?e:null));let childRecords=child?child instanceof Array?child[0]:child:currentRecords[index+1];record.hasOwnProperty("childRecords")?isNullOrUndefined(child)||record.childRecords.push(child):record.childRecords=[],-1===record.childRecords.indexOf(childRecords)&&record.childRecords.unshift(childRecords),isSelfReference&&(record.hasOwnProperty(control.childMapping)||(record[control.childMapping]=[]),-1===record[control.childMapping].indexOf(childRecords)&&record[control.childMapping].unshift(childRecords))}let primaryKeys=control.grid.getPrimaryKeyFieldNames()[0],data=control.grid.dataSource instanceof ej2_data_es2015_DataManager?control.grid.dataSource.dataSource.json:control.grid.dataSource;for(let i=0;i<data.length;i++)if(data[i][primaryKeys]===record[primaryKeys]){data[i]=record;break}control.grid.setRowData(key,record);let row=control.getRowByIndex(index);control.renderModule.cellRender({data:record,cell:row.cells[control.treeColumnIndex],column:control.grid.getColumns()[control.treeColumnIndex]})}else getParentData(control,child.parentItem.uniqueID).childRecords.push(child)}class ej2_treegrid_es2015_RowDD$1{constructor(parent){this.canDrop=!0,this.isDraggedWithChild=!1,this.isaddtoBottom=!1,ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_RowDD),this.parent=parent,this.addEventListener()}getChildrecordsByParentID(id){let treeGridDataSource;return this.parent.dataSource instanceof ej2_data_es2015_DataManager?this.parent.dataSource.dataSource.offline&&this.parent.dataSource.dataSource.json&&(treeGridDataSource=this.parent.dataSource.dataSource.json):treeGridDataSource=this.parent.grid.dataSource,treeGridDataSource.filter(e=>e.uniqueID===id)}addEventListener(){this.parent.on(rowdraging,this.Rowdraging,this),this.parent.on(rowDropped,this.rowDropped,this),this.parent.on(rowsAdd,this.rowsAdded,this),this.parent.on(rowsRemove,this.rowsRemoved,this)}reorderRows(fromIndexes,toIndex,position){{"above"===position&&(this.dropPosition="topSegment"),"below"===position&&(this.dropPosition="bottomSegment"),"child"===position&&(this.dropPosition="middleSegment");let data=[];for(let i=0;i<fromIndexes.length;i++)data[i]=this.parent.getCurrentViewRecords()[fromIndexes[i]];this.dropRows({data:data,dropIndex:toIndex},!0),this.parent.refresh()}}rowsAdded(e){let draggedRecord,dragRecords=e.records;for(let i=e.records.length-1;i>-1;i--)if((draggedRecord=dragRecords[i]).parentUniqueID){let record=dragRecords.filter(data=>data.uniqueID===draggedRecord.parentUniqueID);if(record.length){let index=record[0].childRecords.indexOf(draggedRecord),parentRecord=record[0];-1!==index&&(parentRecord.childRecords.splice(index,1),parentRecord.childRecords.length||(parentRecord.hasChildRecords=!1,parentRecord.hasFilteredChildRecords=!1),this.isDraggedWithChild=!0)}}if(this.parent.dataSource.length){for(let i=0;i<dragRecords.length;i++)setValue("uniqueIDCollection."+dragRecords[i].uniqueID,dragRecords[i],this.parent);let args={data:e.records,dropIndex:e.toIndex};this.treeGridData=this.parent.dataSource instanceof ej2_data_es2015_DataManager?this.parent.dataSource.dataSource.json:this.parent.grid.dataSource,this.dropRows(args)}else{let draggedRecord,tObj=this.parent,dragRecords=e.records;for(let i=e.records.length-1;i>-1;i--){let recordIndex1=0;(draggedRecord=dragRecords[i]).taskData.hasOwnProperty(tObj.childMapping)||(draggedRecord.taskData[tObj.childMapping]=[]),tObj.dataSource.splice(recordIndex1,0,draggedRecord.taskData),tObj.setProperties({dataSource:tObj.dataSource},!1)}}}rowsRemoved(e){for(let i=0;i<e.records.length;i++)this.draggedRecord=e.records[i],(this.draggedRecord.hasChildRecords||this.draggedRecord.parentItem&&-1!==this.parent.grid.dataSource.indexOf(this.getChildrecordsByParentID(this.draggedRecord.parentUniqueID)[0])||0===this.draggedRecord.level)&&this.deleteDragRow()}refreshGridDataSource(){let tempDataSource,idx,draggedRecord=this.draggedRecord,droppedRecord=this.droppedRecord,proxy=this.parent;if(proxy.dataSource instanceof ej2_data_es2015_DataManager?proxy.dataSource.dataSource.offline&&proxy.dataSource.dataSource.json&&(tempDataSource=proxy.dataSource.dataSource.json):tempDataSource=proxy.dataSource,!tempDataSource||isNullOrUndefined(droppedRecord)||droppedRecord.parentItem){if(!this.parent.parentIdMapping&&!isNullOrUndefined(droppedRecord)&&droppedRecord.parentItem&&("topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition)){let childRecords=this.getChildrecordsByParentID(droppedRecord.parentUniqueID)[0].childRecords;for(let i=0;i<childRecords.length;i++)droppedRecord.parentItem.taskData[this.parent.childMapping][i]=childRecords[i].taskData}}else{for(let i=0;i<Object.keys(tempDataSource).length;i++)tempDataSource[i][this.parent.childMapping]===droppedRecord.taskData[this.parent.childMapping]&&(idx=i);"topSegment"===this.dropPosition?this.parent.idMapping||tempDataSource.splice(idx,0,draggedRecord.taskData):"bottomSegment"===this.dropPosition&&(this.parent.idMapping||tempDataSource.splice(idx+1,0,draggedRecord.taskData))}this.parent.parentIdMapping&&(draggedRecord.parentItem?"topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition?(draggedRecord[this.parent.parentIdMapping]=droppedRecord[this.parent.parentIdMapping],draggedRecord.taskData[this.parent.parentIdMapping]=droppedRecord[this.parent.parentIdMapping]):(draggedRecord[this.parent.parentIdMapping]=droppedRecord[this.parent.idMapping],draggedRecord.taskData[this.parent.parentIdMapping]=droppedRecord[this.parent.idMapping]):(draggedRecord.taskData[this.parent.parentIdMapping]=null,draggedRecord[this.parent.parentIdMapping]=null))}removeFirstrowBorder(element,isRemove){let canremove="bottomSegment"===this.dropPosition;this.parent.element.getElementsByClassName("e-firstrow-border").length>0&&element&&(0!==element.rowIndex||canremove)&&this.parent.element.getElementsByClassName("e-firstrow-border")[0].remove()}removeLastrowBorder(element,isRemove){let isEmptyRow=element&&(element.classList.contains("e-emptyrow")||element.classList.contains("e-columnheader")),islastRowIndex=element&&!isEmptyRow&&this.parent.getRowByIndex(this.parent.getRows().length-1).getAttribute("data-uid")!==element.getAttribute("data-uid"),canremove=islastRowIndex||"topSegment"===this.dropPosition;this.parent.element.getElementsByClassName("e-lastrow-border").length>0&&element&&(islastRowIndex||canremove)&&this.parent.element.getElementsByClassName("e-lastrow-border")[0].remove()}updateIcon(row,index,args){let rowEle=args.target?closest(args.target,"tr"):null;this.dropPosition=void 0,this.removeFirstrowBorder(rowEle),this.removeLastrowBorder(rowEle);for(let i=0;i<args.rows.length;i++)(isNullOrUndefined(rowEle)||rowEle.getAttribute("data-uid")!==args.rows[i].getAttribute("data-uid"))&&parentsUntil(args.target,"e-gridcontent")||(this.dropPosition="Invalid",this.addErrorElem());let tObj=this.parent,rowHeight=row[0].offsetHeight,rowTop=0,roundOff=0,toolHeight=tObj.toolbar&&tObj.toolbar.length?document.getElementById(tObj.element.id+"_gridcontrol_toolbarItems").offsetHeight:0,positionOffSet=this.getOffset(tObj.element),contentHeight=tObj.getHeaderContent().offsetHeight+positionOffSet.top+toolHeight,scrollTop=tObj.getContent().scrollTop,divide=((rowTop=tObj.allowTextWrap?row[0].offsetHeight:0!==scrollTop?index*rowHeight+contentHeight+(roundOff=rowHeight-scrollTop%rowHeight):index*rowHeight+contentHeight+roundOff)+row[0].offsetHeight-rowTop)/3,topRowSegment=rowTop+divide,middleRowSegment=topRowSegment+divide,bottomRowSegment=middleRowSegment+divide,posy=ej2_grids_es2015_getObject("originalEvent.event",args).pageY,isTopSegment=posy<=topRowSegment,isMiddleRowSegment=posy>topRowSegment&&posy<=middleRowSegment,isBottomRowSegment=posy>middleRowSegment&&posy<=bottomRowSegment;if(isTopSegment||isMiddleRowSegment||isBottomRowSegment){if(isTopSegment&&"Invalid"!==this.dropPosition&&(this.removeChildBorder(),this.dropPosition="topSegment",this.removetopOrBottomBorder(),this.addFirstrowBorder(rowEle),this.removeErrorElem(),this.removeLastrowBorder(rowEle),this.topOrBottomBorder(args.target)),isMiddleRowSegment&&"Invalid"!==this.dropPosition){let element;this.removetopOrBottomBorder();let rowElement=[];element=closest(args.target,"tr"),(rowElement=[].slice.call(element.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))).length>0&&this.addRemoveClasses(rowElement,!0,"e-childborder"),this.addLastRowborder(rowEle),this.addFirstrowBorder(rowEle),this.dropPosition="middleSegment"}isBottomRowSegment&&"Invalid"!==this.dropPosition&&(this.removeErrorElem(),this.removetopOrBottomBorder(),this.removeChildBorder(),this.dropPosition="bottomSegment",this.addLastRowborder(rowEle),this.removeFirstrowBorder(rowEle),this.topOrBottomBorder(args.target))}return this.dropPosition}removeChildBorder(){let borderElem=[];(borderElem=[].slice.call(this.parent.element.querySelectorAll(".e-childborder"))).length>0&&this.addRemoveClasses(borderElem,!1,"e-childborder")}addFirstrowBorder(targetRow){let node=this.parent.element,tObj=this.parent;if(targetRow&&0===targetRow.rowIndex&&!targetRow.classList.contains("e-emptyrow")){let div=this.parent.createElement("div",{className:"e-firstrow-border"}),gridheaderEle=this.parent.getHeaderContent(),toolbarHeight=0;tObj.toolbar&&(toolbarHeight=tObj.toolbarModule.getToolbar().offsetHeight);let multiplegrid=!isNullOrUndefined(this.parent.rowDropSettings.targetID);multiplegrid&&(div.style.top=this.parent.grid.element.getElementsByClassName("e-gridheader")[0].offsetHeight+toolbarHeight+"px"),div.style.width=multiplegrid?node.offsetWidth+"px":node.offsetWidth-this.getScrollWidth()+"px",gridheaderEle.querySelectorAll(".e-firstrow-border").length||gridheaderEle.appendChild(div)}}addLastRowborder(trElement){let isEmptyRow=trElement&&(trElement.classList.contains("e-emptyrow")||trElement.classList.contains("e-columnheader"));if(trElement&&!isEmptyRow&&this.parent.getRowByIndex(this.parent.getRows().length-1).getAttribute("data-uid")===trElement.getAttribute("data-uid")){let bottomborder=this.parent.createElement("div",{className:"e-lastrow-border"}),gridcontentEle=this.parent.getContent();bottomborder.style.width=this.parent.element.offsetWidth-this.getScrollWidth()+"px",gridcontentEle.querySelectorAll(".e-lastrow-border").length||(gridcontentEle.classList.add("e-treegrid-relative"),gridcontentEle.appendChild(bottomborder),bottomborder.style.bottom=this.getScrollWidth()+"px")}}getScrollWidth(){let scrollElem=this.parent.getContent().firstElementChild;return scrollElem.scrollWidth>scrollElem.offsetWidth?ej2_grids_es2015_Scroll.getScrollBarWidth():0}addErrorElem(){let dragelem=document.getElementsByClassName("e-cloneproperties")[0];if(!dragelem.querySelectorAll(".e-errorelem").length&&!this.parent.rowDropSettings.targetID){let ele=document.createElement("div");ej2_base_es2015_classList(ele,["e-errorcontainer"],[]),ej2_base_es2015_classList(ele,["e-icons","e-errorelem"],[]);let errorVal=dragelem.querySelector(".errorValue"),content=dragelem.querySelector(".e-rowcell").innerHTML;errorVal&&(content=errorVal.innerHTML,errorVal.parentNode.removeChild(errorVal)),dragelem.querySelector(".e-rowcell").innerHTML="";let spanContent=document.createElement("span");spanContent.className="errorValue",spanContent.style.paddingLeft="16px",spanContent.innerHTML=content,dragelem.querySelector(".e-rowcell").appendChild(ele),dragelem.querySelector(".e-rowcell").appendChild(spanContent)}}removeErrorElem(){let errorelem=document.querySelector(".e-errorelem");errorelem&&errorelem.remove()}topOrBottomBorder(target){isNullOrUndefined(this.parent.rowDropSettings.targetID);let element,rowElement=[];(rowElement=(element=closest(target,"tr"))?[].slice.call(element.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")):[]).length&&("topSegment"===this.dropPosition&&(this.addRemoveClasses(rowElement,!0,"e-droptop"),this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0].remove()),"bottomSegment"===this.dropPosition&&this.addRemoveClasses(rowElement,!0,"e-dropbottom"))}removetopOrBottomBorder(){let border=[];(border=[].slice.call(this.parent.element.querySelectorAll(".e-dropbottom, .e-droptop"))).length&&(this.addRemoveClasses(border,!1,"e-dropbottom"),this.addRemoveClasses(border,!1,"e-droptop"))}addRemoveClasses(cells,add,className){for(let i=0,len=cells.length;i<len;i++)add?cells[i].classList.add(className):cells[i].classList.remove(className)}getOffset(element){let box=element.getBoundingClientRect(),body=document.body,docElem=document.documentElement,scrollTop=window.pageYOffset||docElem.scrollTop||body.scrollTop,scrollLeft=window.pageXOffset||docElem.scrollLeft||body.scrollLeft,left=box.left+scrollLeft-(docElem.clientLeft||body.clientLeft||0);return{top:Math.round(box.top+scrollTop-(docElem.clientTop||body.clientTop||0)),left:Math.round(left)}}Rowdraging(args){let tObj=this.parent,cloneElement=this.parent.element.querySelector(".e-cloneproperties");cloneElement.style.cursor="";let rowEle=args.target?closest(args.target,"tr"):null,rowIdx=rowEle?rowEle.rowIndex:-1,dragRecords=[],droppedRecord=tObj.getCurrentViewRecords()[rowIdx];if(this.removeErrorElem(),this.canDrop=!0,args.data[0]?dragRecords=args.data:dragRecords.push(args.data),-1!==rowIdx?this.ensuredropPosition(dragRecords,droppedRecord):(this.canDrop=!1,this.addErrorElem()),!tObj.rowDropSettings.targetID&&this.canDrop&&tObj.rowDragAndDropModule.updateIcon(args.rows,rowIdx,args),tObj.rowDropSettings.targetID){let dropElement=parentsUntil(args.target,"e-treegrid");dropElement&&dropElement.id===this.parent.rowDropSettings.targetID&&dropElement.ej2_instances[0].rowDragAndDropModule.updateIcon(args.rows,rowIdx,args)}args.target&&closest(args.target,"#"+tObj.rowDropSettings.targetID)&&(parentsUntil(args.target,"e-treegrid")||(cloneElement.style.cursor="default"))}rowDropped(args){let tObj=this.parent;tObj.rowDropSettings.targetID?(args.target&&closest(args.target,"#"+tObj.rowDropSettings.targetID)||parentsUntil(args.target,"e-treegrid")&&parentsUntil(args.target,"e-treegrid").id===tObj.rowDropSettings.targetID)&&(setValue("dropPosition",this.dropPosition,args),tObj.trigger(ej2_treegrid_es2015_rowDrop,args),!args.cancel&&tObj.rowDropSettings.targetID&&this.dragDropGrid(args)):parentsUntil(args.target,"e-content")&&(setValue("dropPosition",this.dropPosition,args),tObj.trigger(ej2_treegrid_es2015_rowDrop,args),args.cancel||(this.dropRows(args),tObj.refresh(),isNullOrUndefined(tObj.getHeaderContent().querySelector(".e-firstrow-border"))||tObj.getHeaderContent().querySelector(".e-firstrow-border").remove())),this.removetopOrBottomBorder(),this.removeChildBorder(),isNullOrUndefined(this.parent.element.getElementsByClassName("e-firstrow-border")[0])||this.parent.element.getElementsByClassName("e-firstrow-border")[0].remove()}dragDropGrid(args){let tObj=this.parent,targetRow=closest(args.target,"tr"),targetIndex=isNaN(this.getTargetIdx(targetRow))?0:this.getTargetIdx(targetRow),dropElement=parentsUntil(args.target,"e-treegrid");if(dropElement&&dropElement.id===this.parent.rowDropSettings.targetID){let srcControl=dropElement.ej2_instances[0],records=tObj.getSelectedRecords(),indexes=[];for(let i=0;i<records.length;i++)indexes[i]=records[i].index;tObj.notify(rowsRemove,{indexes:indexes,records:records}),srcControl.notify(rowsAdd,{toIndex:targetIndex,records:records}),tObj.refresh(),srcControl.refresh(),srcControl.grid.dataSource.length>1&&(srcControl.refresh(),isNullOrUndefined(srcControl.getHeaderContent().querySelector(".e-firstrow-border"))||srcControl.getHeaderContent().querySelector(".e-firstrow-border").remove(),isNullOrUndefined(srcControl.getContent().querySelector(".e-lastrow-border"))||srcControl.getContent().querySelector(".e-lastrow-border").remove())}}getTargetIdx(targetRow){return targetRow?parseInt(targetRow.getAttribute("aria-rowindex"),10):0}getParentData(record){let parentItem=record.parentItem;if("bottomSegment"===this.dropPosition){let selectedRecord=this.parent.getSelectedRecords()[0];this.droppedRecord=getParentData(this.parent,selectedRecord.parentItem.uniqueID)}"middleSegment"===this.dropPosition&&(this.parent.getSelectedRecords()[0].level===parentItem.level?this.droppedRecord=getParentData(this.parent,parentItem.uniqueID):this.getParentData(parentItem))}dropRows(args,isByMethod){if("Invalid"!==this.dropPosition){let draggedRecord,droppedRecord,tObj=this.parent;if(isNullOrUndefined(args.dropIndex)){let rowIndex=tObj.getSelectedRowIndexes()[0]-1,record=tObj.getCurrentViewRecords()[rowIndex];this.getParentData(record)}else this.droppedRecord=tObj.getCurrentViewRecords()[args.dropIndex];let dragRecords=[];droppedRecord=this.droppedRecord,args.data[0]?dragRecords=args.data:dragRecords.push(args.data);let count=0,multiplegrid=this.parent.rowDropSettings.targetID;this.isMultipleGrid=multiplegrid;let addToBottom=!1;multiplegrid?this.isaddtoBottom=addToBottom=multiplegrid&&this.isDraggedWithChild:this.ensuredropPosition(dragRecords,droppedRecord);let dragLength=dragRecords.length;for(let i=0;i<dragLength;i++){this.draggedRecord=draggedRecord=dragRecords[i];let recordIndex=args.dropIndex,isSelfReference=!isNullOrUndefined(tObj.parentIdMapping);if("Invalid"!==this.dropPosition){tObj.rowDropSettings.targetID&&!isByMethod||this.deleteDragRow();let recordIndex1=this.treeGridData.indexOf(droppedRecord);if(this.dropAtTop(recordIndex1,isSelfReference,i),"bottomSegment"===this.dropPosition&&(droppedRecord.hasChildRecords?(count=this.getChildCount(droppedRecord,0),this.parent.parentIdMapping&&this.parent.dataSource.splice(recordIndex1+count+1,0,this.draggedRecord.taskData),this.treeGridData.splice(recordIndex1+count+1,0,this.draggedRecord)):(this.parent.parentIdMapping&&this.parent.dataSource.splice(recordIndex1+1,0,this.draggedRecord.taskData),this.treeGridData.splice(recordIndex1+1,0,this.draggedRecord)),draggedRecord.parentItem=this.treeGridData[recordIndex1].parentItem,draggedRecord.parentUniqueID=tObj.grid.dataSource[recordIndex1].parentUniqueID,draggedRecord.level=this.treeGridData[recordIndex1].level,draggedRecord.hasChildRecords&&(this.updateChildRecordLevel(draggedRecord,1),this.updateChildRecord(draggedRecord,recordIndex1+count+1)),droppedRecord.parentItem)){let childRecords=this.getChildrecordsByParentID(droppedRecord.parentUniqueID)[0].childRecords,droppedRecordIndex=childRecords.indexOf(droppedRecord)+1;childRecords.splice(droppedRecordIndex,0,draggedRecord)}this.dropMiddle(recordIndex,recordIndex1,args,isByMethod,isSelfReference,i)}if(isNullOrUndefined(draggedRecord.parentItem)){let parentRecords=tObj.parentData,newParentIndex=parentRecords.indexOf(this.droppedRecord);"bottomSegment"===this.dropPosition?parentRecords.splice(newParentIndex+1,0,draggedRecord):"topSegment"===this.dropPosition&&parentRecords.splice(newParentIndex,0,draggedRecord)}tObj.rowDragAndDropModule.refreshGridDataSource()}}}dropMiddle(recordIndex,recordIndex1,args,isSelfReference,isByMethod,i){let tObj=this.parent,childRecords=findChildrenRecords(this.droppedRecord),childRecordsLength=isNullOrUndefined(childRecords)||0===childRecords.length?recordIndex1+1:childRecords.length+recordIndex1+1;"middleSegment"===this.dropPosition&&(tObj.parentIdMapping?(this.parent.dataSource.splice(childRecordsLength,0,this.draggedRecord.taskData),this.treeGridData.splice(childRecordsLength,0,this.draggedRecord)):this.treeGridData.splice(childRecordsLength,0,this.draggedRecord),this.recordLevel(),this.draggedRecord.hasChildRecords&&this.updateChildRecord(this.draggedRecord,childRecordsLength,this.droppedRecord.expanded))}dropAtTop(recordIndex1,isSelfReference,i){if("topSegment"===this.dropPosition){if(this.parent.parentIdMapping&&(this.parent.dataSource.splice(recordIndex1,0,this.draggedRecord.taskData),this.treeGridData.splice(recordIndex1,0,this.draggedRecord)),this.draggedRecord.parentItem=this.treeGridData[recordIndex1].parentItem,this.draggedRecord.parentUniqueID=this.treeGridData[recordIndex1].parentUniqueID,this.draggedRecord.level=this.treeGridData[recordIndex1].level,this.treeGridData.splice(recordIndex1,0,this.draggedRecord),this.draggedRecord.hasChildRecords){let level=1;this.updateChildRecord(this.draggedRecord,recordIndex1),this.updateChildRecordLevel(this.draggedRecord,level)}if(this.droppedRecord.parentItem){let childRecords=this.getChildrecordsByParentID(this.droppedRecord.parentUniqueID)[0].childRecords,droppedRecordIndex=childRecords.indexOf(this.droppedRecord);childRecords.splice(droppedRecordIndex,0,this.draggedRecord)}}}recordLevel(){let tObj=this.parent,draggedRecord=this.draggedRecord,droppedRecord=this.droppedRecord,childItem=tObj.childMapping;if(droppedRecord.hasChildRecords||(droppedRecord.hasChildRecords=!0,droppedRecord.hasFilteredChildRecords=!0,isNullOrUndefined(droppedRecord.childRecords)&&(droppedRecord.childRecords=[],!tObj.parentIdMapping&&isNullOrUndefined(droppedRecord.taskData[childItem])&&(droppedRecord.taskData[childItem]=[]))),"middleSegment"===this.dropPosition){let parentItem=extend({},droppedRecord);if(delete parentItem.childRecords,draggedRecord.parentItem=parentItem,draggedRecord.parentUniqueID=droppedRecord.uniqueID,droppedRecord.childRecords.splice(droppedRecord.childRecords.length,0,draggedRecord),isNullOrUndefined(draggedRecord)||tObj.parentIdMapping||isNullOrUndefined(droppedRecord.taskData[childItem])||droppedRecord.taskData[tObj.childMapping].splice(droppedRecord.childRecords.length,0,draggedRecord.taskData),draggedRecord.hasChildRecords){let level=1;draggedRecord.level=droppedRecord.level+1,this.updateChildRecordLevel(draggedRecord,level)}else draggedRecord.level=droppedRecord.level+1;droppedRecord.expanded=!0}}deleteDragRow(){let deletedRow;this.treeGridData=this.parent.dataSource instanceof ej2_data_es2015_DataManager?this.parent.dataSource.dataSource.json:this.parent.grid.dataSource,deletedRow=getParentData(this.parent,this.draggedRecord.uniqueID),this.removeRecords(deletedRow)}updateChildRecord(record,count,expanded$$1){let currentRecord,tObj=this.parent,length=0;if(!record.hasChildRecords)return 0;length=record.childRecords.length;for(let i=0;i<length;i++)tObj.flatData.splice(++count,0,currentRecord=record.childRecords[i]),tObj.parentIdMapping&&tObj.dataSource.splice(count,0,currentRecord.taskData),currentRecord.hasChildRecords&&(count=this.updateChildRecord(currentRecord,count));return count}updateChildRecordLevel(record,level){let currentRecord,length=0;if(level++,!record.hasChildRecords)return 0;length=record.childRecords.length;for(let i=0;i<length;i++){let parentData;currentRecord=record.childRecords[i],record.parentItem&&(parentData=getParentData(this.parent,record.parentItem.uniqueID)),currentRecord.level=record.parentItem?parentData.level+level:record.level+1,currentRecord.hasChildRecords&&(level=this.updateChildRecordLevel(currentRecord,--level))}return level}removeRecords(record){let tObj=this.parent,dataSource=tObj.dataSource,deletedRow=record,isSelfReference=!isNullOrUndefined(tObj.parentIdMapping),flatParentData=this.getChildrecordsByParentID(deletedRow.parentUniqueID)[0];if(deletedRow){if(deletedRow.parentItem){let childRecords=flatParentData?flatParentData.childRecords:[],childIndex=0;childRecords&&childRecords.length>0&&(childIndex=childRecords.indexOf(deletedRow),flatParentData.childRecords.splice(childIndex,1),this.parent.parentIdMapping||editAction({value:deletedRow,action:"delete"},this.parent,isSelfReference,deletedRow.index,deletedRow.index))}if(tObj.parentIdMapping){let idx;deletedRow.hasChildRecords&&deletedRow.childRecords.length>0&&this.removeChildItem(deletedRow);let treeGridData=dataSource;for(let i=0;i<treeGridData.length;i++)treeGridData[i][this.parent.idMapping]===deletedRow.taskData[this.parent.idMapping]&&(idx=i);-1!==idx&&(dataSource.splice(idx,1),this.treeGridData.splice(idx,1))}let recordIndex=this.treeGridData.indexOf(deletedRow);if(!tObj.parentIdMapping){let parentIndex=this.parent.parentData.indexOf(deletedRow);-1!==parentIndex&&(tObj.parentData.splice(parentIndex,1),dataSource.splice(parentIndex,1))}if(-1===recordIndex&&!tObj.parentIdMapping){let primaryKeyField=tObj.getPrimaryKeyFieldNames()[0];for(let j=0;j<this.treeGridData.length;j++)this.treeGridData[j][primaryKeyField]===deletedRow[primaryKeyField]&&(recordIndex=j)}if(!tObj.parentIdMapping){let deletedRecordCount=this.getChildCount(deletedRow,0);this.treeGridData.splice(recordIndex,deletedRecordCount+1)}deletedRow.parentItem&&flatParentData&&flatParentData.childRecords&&!flatParentData.childRecords.length&&(flatParentData.expanded=!1,flatParentData.hasChildRecords=!1,flatParentData.hasFilteredChildRecords=!1)}}removeChildItem(record){let currentRecord,idx,tObj=this.parent;for(let i=0;i<record.childRecords.length;i++){currentRecord=record.childRecords[i];let treeGridData=tObj.dataSource;for(let i=0;i<treeGridData.length;i++)treeGridData[i][this.parent.idMapping]===currentRecord.taskData[this.parent.idMapping]&&(idx=i);-1!==idx&&(tObj.dataSource.splice(idx,1),this.treeGridData.splice(idx,1)),currentRecord.hasChildRecords&&this.removeChildItem(currentRecord)}}getChildCount(record,count){let currentRecord;if(!record.hasChildRecords)return 0;for(let i=0;i<record.childRecords.length;i++)count++,(currentRecord=record.childRecords[i]).hasChildRecords&&(count=this.getChildCount(currentRecord,count));return count}ensuredropPosition(draggedRecords,currentRecord){let rowDragMoudule=this;draggedRecords.filter(e=>{if(e.hasChildRecords){if(-1!==e.childRecords.indexOf(currentRecord))return rowDragMoudule.dropPosition="Invalid",rowDragMoudule.addErrorElem(),void(rowDragMoudule.canDrop=!1);rowDragMoudule.ensuredropPosition(e.childRecords,currentRecord)}})}destroy(){this.removeEventListener()}removeEventListener(){this.parent.isDestroyed||(this.parent.off(rowdraging,this.Rowdraging),this.parent.off(rowDropped,this.rowDropped),this.parent.off(rowsAdd,this.rowsAdded),this.parent.off(rowsRemove,this.rowsRemoved))}getModuleName(){return"rowDragandDrop"}}var ej2_treegrid_es2015_ToolbarItem=function(ToolbarItem){return ToolbarItem[ToolbarItem.Add=0]="Add",ToolbarItem[ToolbarItem.Edit=1]="Edit",ToolbarItem[ToolbarItem.Update=2]="Update",ToolbarItem[ToolbarItem.Delete=3]="Delete",ToolbarItem[ToolbarItem.Cancel=4]="Cancel",ToolbarItem[ToolbarItem.Search=5]="Search",ToolbarItem[ToolbarItem.ExpandAll=6]="ExpandAll",ToolbarItem[ToolbarItem.CollapseAll=7]="CollapseAll",ToolbarItem[ToolbarItem.ExcelExport=8]="ExcelExport",ToolbarItem[ToolbarItem.PdfExport=9]="PdfExport",ToolbarItem[ToolbarItem.CsvExport=10]="CsvExport",ToolbarItem[ToolbarItem.Print=11]="Print",ToolbarItem[ToolbarItem.RowIndent=12]="RowIndent",ToolbarItem[ToolbarItem.RowOutdent=13]="RowOutdent",ToolbarItem}({}),ContextMenuItems=function(ContextMenuItems){return ContextMenuItems[ContextMenuItems.AutoFit=0]="AutoFit",ContextMenuItems[ContextMenuItems.AutoFitAll=1]="AutoFitAll",ContextMenuItems[ContextMenuItems.SortAscending=2]="SortAscending",ContextMenuItems[ContextMenuItems.SortDescending=3]="SortDescending",ContextMenuItems[ContextMenuItems.Edit=4]="Edit",ContextMenuItems[ContextMenuItems.Delete=5]="Delete",ContextMenuItems[ContextMenuItems.Save=6]="Save",ContextMenuItems[ContextMenuItems.Cancel=7]="Cancel",ContextMenuItems[ContextMenuItems.PdfExport=8]="PdfExport",ContextMenuItems[ContextMenuItems.ExcelExport=9]="ExcelExport",ContextMenuItems[ContextMenuItems.CsvExport=10]="CsvExport",ContextMenuItems[ContextMenuItems.FirstPage=11]="FirstPage",ContextMenuItems[ContextMenuItems.PrevPage=12]="PrevPage",ContextMenuItems[ContextMenuItems.LastPage=13]="LastPage",ContextMenuItems[ContextMenuItems.NextPage=14]="NextPage",ContextMenuItems[ContextMenuItems.AddRow=15]="AddRow",ContextMenuItems}({});let ej2_treegrid_es2015_PageSettings=(()=>{class PageSettings extends ChildProperty{}return __decorate([Property(12)],PageSettings.prototype,"pageSize",void 0),__decorate([Property(8)],PageSettings.prototype,"pageCount",void 0),__decorate([Property(1)],PageSettings.prototype,"currentPage",void 0),__decorate([Property()],PageSettings.prototype,"totalRecordsCount",void 0),__decorate([Property(!1)],PageSettings.prototype,"enableQueryString",void 0),__decorate([Property(!1)],PageSettings.prototype,"pageSizes",void 0),__decorate([Property(null)],PageSettings.prototype,"template",void 0),__decorate([Property("All")],PageSettings.prototype,"pageSizeMode",void 0),PageSettings})(),ej2_treegrid_es2015_AggregateColumn=(()=>{class AggregateColumn extends ChildProperty{constructor(){super(...arguments),this.intl=new Internationalization,this.templateFn={}}setFormatter(cultureName){this.format&&(this.format.skeleton||this.format.format)&&(this.formatFn=this.getFormatFunction(this.format))}getFormatFunction(format){return format.type?this.intl.getDateFormat(format):this.intl.getNumberFormat(format)}getFormatter(){return this.formatFn}setTemplate(helper={}){void 0!==this.footerTemplate&&(this.templateFn[getEnumValue(CellType,CellType.Summary)]={fn:compile$$1(this.footerTemplate,helper),property:"footerTemplate"})}getTemplate(type){return this.templateFn[getEnumValue(CellType,type)]}setPropertiesSilent(prop){this.setProperties(prop,!0)}}return __decorate([Property()],AggregateColumn.prototype,"type",void 0),__decorate([Property()],AggregateColumn.prototype,"footerTemplate",void 0),__decorate([Property()],AggregateColumn.prototype,"field",void 0),__decorate([Property()],AggregateColumn.prototype,"format",void 0),__decorate([Property()],AggregateColumn.prototype,"columnName",void 0),__decorate([Property()],AggregateColumn.prototype,"customAggregate",void 0),AggregateColumn})(),ej2_treegrid_es2015_AggregateRow=(()=>{class AggregateRow extends ChildProperty{}return __decorate([Collection([],ej2_treegrid_es2015_AggregateColumn)],AggregateRow.prototype,"columns",void 0),__decorate([Property(!0)],AggregateRow.prototype,"showChildSummary",void 0),AggregateRow})(),ej2_treegrid_es2015_EditSettings=(()=>{class EditSettings extends ChildProperty{}return __decorate([Property(!1)],EditSettings.prototype,"allowAdding",void 0),__decorate([Property(!1)],EditSettings.prototype,"allowEditing",void 0),__decorate([Property(!1)],EditSettings.prototype,"allowDeleting",void 0),__decorate([Property("Cell")],EditSettings.prototype,"mode",void 0),__decorate([Property("Top")],EditSettings.prototype,"newRowPosition",void 0),__decorate([Property(!0)],EditSettings.prototype,"allowEditOnDblClick",void 0),__decorate([Property(!0)],EditSettings.prototype,"showConfirmDialog",void 0),__decorate([Property(!1)],EditSettings.prototype,"showDeleteConfirmDialog",void 0),__decorate([Property("")],EditSettings.prototype,"template",void 0),EditSettings})(),ej2_treegrid_es2015_SortDescriptor=(()=>{class SortDescriptor extends ChildProperty{}return __decorate([Property()],SortDescriptor.prototype,"field",void 0),__decorate([Property()],SortDescriptor.prototype,"direction",void 0),SortDescriptor})(),ej2_treegrid_es2015_SortSettings=(()=>{class SortSettings extends ChildProperty{}return __decorate([Collection([],ej2_treegrid_es2015_SortDescriptor)],SortSettings.prototype,"columns",void 0),__decorate([Property(!0)],SortSettings.prototype,"allowUnsort",void 0),SortSettings})();var TreeGrid_1;let ej2_treegrid_es2015_TreeGrid=(()=>{let TreeGrid=TreeGrid_1=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.dataResults={},this.uniqueIDCollection={},this.uniqueIDFilterCollection={},TreeGrid_1.Inject(ej2_treegrid_es2015_Selection),this.grid=new ej2_grids_es2015_Grid}excelExport(excelExportProperties,isMultipleExport,workbook,isBlob){return this.excelExportModule.Map(excelExportProperties,isMultipleExport,workbook,isBlob,!1)}csvExport(excelExportProperties,isMultipleExport,workbook,isBlob){return this.excelExportModule.Map(excelExportProperties,isMultipleExport,workbook,isBlob,!0)}pdfExport(pdfExportProperties,isMultipleExport,pdfDoc,isBlob){return this.pdfExportModule.Map(pdfExportProperties,isMultipleExport,pdfDoc,isBlob)}getModuleName(){return"treegrid"}preRender(){this.TreeGridLocale(),this.initProperties(),this.defaultLocale={Above:"Above",Below:"Below",AddRow:"Add Row",ExpandAll:"Expand All",CollapseAll:"Collapse All",RowIndent:"Indent",RowOutdent:"Outdent"},this.isSelfReference&&isNullOrUndefined(this.childMapping)&&(this.childMapping="Children")}sortByColumn(columnName,direction,isMultiSort){this.sortModule.sortColumn(columnName,direction,isMultiSort)}clearSorting(){this.sortModule&&this.sortModule.clearSorting()}removeSortColumn(field){this.sortModule.removeSortColumn(field)}search(searchString){this.grid.search(searchString)}autoFitColumns(fieldNames){this.resizeModule.autoFitColumns(fieldNames),this.updateColumnModel()}reorderColumns(fromFName,toFName){this.grid.reorderColumns(fromFName,toFName)}TreeGridLocale(){let localeObject,gridLocale,treeGridLocale,locale=L10n.locale;setValue(this.locale,{},localeObject={}),gridLocale={},gridLocale=ej2_grids_es2015_getObject(this.locale,locale),treeGridLocale={},setValue("grid",treeGridLocale=ej2_grids_es2015_getObject(this.getModuleName(),gridLocale),ej2_grids_es2015_getObject(this.locale,localeObject)),L10n.load(localeObject)}print(){this.printModule.print()}treeGridkeyActionHandler(e){if(this.allowKeyboard)switch(e.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"ctrlShiftUpArrow":let collapserow=e.target.closest(".e-rowcell").closest("tr");this.expandCollapseRequest(collapserow.querySelector(".e-treegridexpand"));break;case"ctrlShiftDownArrow":let expandrow=e.target.closest(".e-rowcell").closest("tr");this.expandCollapseRequest(expandrow.querySelector(".e-treegridcollapse"));break;case"downArrow":let summaryElement=this.findnextRowElement(e.target.parentElement);if(null!==summaryElement){this.selectRow(summaryElement.rowIndex);let row=summaryElement.children[e.target.cellIndex];addClass([row],"e-focused"),addClass([row],"e-focus")}else this.clearSelection();break;case"upArrow":let summaryRowElement=this.findPreviousRowElement(e.target.parentElement);if(null!==summaryRowElement){this.selectRow(summaryRowElement.rowIndex);let rows=summaryRowElement.children[e.target.cellIndex];addClass([rows],"e-focused"),addClass([rows],"e-focus")}else this.clearSelection()}}findnextRowElement(summaryRowElement){let rowElement=summaryRowElement.nextSibling;return null===rowElement||-1===rowElement.className.indexOf("e-summaryrow")&&"none"!==rowElement.style.display||(rowElement=this.findnextRowElement(rowElement)),rowElement}findPreviousRowElement(summaryRowElement){let rowElement=summaryRowElement.previousSibling;return null===rowElement||-1===rowElement.className.indexOf("e-summaryrow")&&"none"!==rowElement.style.display||(rowElement=this.findPreviousRowElement(rowElement)),rowElement}initProperties(){this.defaultLocale={},this.flatData=[],this.parentData=[],this.columnModel=[],this.isExpandAll=!1,this.keyConfigs={ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlShiftUpArrow:"ctrl+shift+uparrow",ctrlShiftDownArrow:"ctrl+shift+downarrow",downArrow:"downArrow",upArrow:"upArrow"},this.isLocalData=!(this.dataSource instanceof ej2_data_es2015_DataManager)||this.dataSource.dataSource.offline||!isNullOrUndefined(this.dataSource.ready)||this.dataSource.adaptor instanceof ej2_data_es2015_RemoteSaveAdaptor,this.isSelfReference=!isNullOrUndefined(this.parentIdMapping)}wireEvents(){EventHandler.add(this.element,"click",this.mouseClickHandler,this),EventHandler.add(this.element,"touchend",this.mouseClickHandler,this),this.keyboardModule=new ej2_base_es2015_KeyboardEvents(this.element,{keyAction:this.treeGridkeyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex)}requiredModules(){let modules=[];return this.isDestroyed?modules:(modules.push({member:"filter",args:[this,this.filterSettings]}),isNullOrUndefined(this.toolbar)||modules.push({member:"toolbar",args:[this]}),this.contextMenuItems&&modules.push({member:"contextMenu",args:[this]}),this.allowPaging&&modules.push({member:"pager",args:[this,this.pageSettings]}),this.allowReordering&&modules.push({member:"reorder",args:[this]}),this.allowSorting&&modules.push({member:"sort",args:[this]}),this.aggregates.length>0&&modules.push({member:"summary",args:[this]}),modules.push({member:"resize",args:[this]}),this.allowExcelExport&&modules.push({member:"ExcelExport",args:[this]}),this.detailTemplate&&modules.push({member:"detailRow",args:[this]}),this.allowPdfExport&&modules.push({member:"PdfExport",args:[this]}),this.showColumnMenu&&modules.push({member:"columnMenu",args:[this]}),this.allowRowDragAndDrop&&modules.push({member:"RowDD",args:[this]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&modules.push({member:"edit",args:[this]}),this.isCommandColumn(this.columns)&&modules.push({member:"commandColumn",args:[this]}),this.allowSelection&&modules.push({member:"selection",args:[this]}),this.enableVirtualization&&modules.push({member:"virtualScroll",args:[this]}),modules)}isCommandColumn(columns){return columns.some(col=>col.columns?this.isCommandColumn(col.columns):!(!col.commands&&!col.commandsTemplate))}unwireEvents(){EventHandler.remove(this.element,"click",this.mouseClickHandler)}render(){createSpinner({target:this.element},this.createElement),this.renderModule=new ej2_treegrid_es2015_Render(this),this.dataModule=new ej2_treegrid_es2015_DataManipulation(this),this.printModule=new ej2_treegrid_es2015_Print$1(this),this.columnMenuModule=new ej2_treegrid_es2015_ColumnMenu$1(this),this.rowDragAndDropModule=new ej2_treegrid_es2015_RowDD$1(this),this.trigger("load"),this.autoGenerateColumns(),this.initialRender=!0,this.convertTreeData(this.dataSource),this.loadGrid(),this.element.classList.contains("e-treegrid")&&this.rowDropSettings.targetID&&(this.grid.rowDropSettings.targetID+="_gridcontrol"),this.addListener();let gridContainer=ej2_base_es2015_createElement("div",{id:this.element.id+"_gridcontrol"});addClass([this.element],"e-treegrid"),isNullOrUndefined(this.height)||"string"!=typeof this.height||-1===this.height.indexOf("%")||(this.element.style.height=this.height),isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(this.element.style.width=this.width),this.element.appendChild(gridContainer),this.grid.appendTo(gridContainer),this.wireEvents(),this.renderComplete()}convertTreeData(data){data instanceof Array&&data.length>0&&data[0].hasOwnProperty("level")?(this.flatData=data,this.flatData.filter(e=>{setValue("uniqueIDCollection."+e.uniqueID,e,this),0===e.level&&this.parentData.push(e)})):this.dataModule.convertToFlatData(data)}bindGridProperties(){this.bindedDataSource(),this.grid.enableRtl=this.enableRtl,this.grid.allowKeyboard=this.allowKeyboard,this.grid.enablePersistence=this.enablePersistence,this.grid.columns=this.getGridColumns(this.columns),this.grid.allowExcelExport=this.allowExcelExport,this.grid.allowPdfExport=this.allowPdfExport,this.grid.query=this.query,this.grid.columnQueryMode=this.columnQueryMode,this.grid.allowPaging=this.allowPaging,this.grid.pageSettings=getActualProperties(this.pageSettings),this.grid.pagerTemplate=this.pagerTemplate,this.grid.showColumnMenu=this.showColumnMenu,this.grid.allowSorting=this.allowSorting,this.grid.allowFiltering=this.allowFiltering,this.grid.enableVirtualization=this.enableVirtualization,this.grid.width=this.width,this.grid.height=this.height,this.grid.enableAltRow=this.enableAltRow,this.grid.allowReordering=this.allowReordering,this.grid.allowTextWrap=this.allowTextWrap,this.grid.allowResizing=this.allowResizing,this.grid.enableHover=this.enableHover,this.grid.allowRowDragAndDrop=this.allowRowDragAndDrop,this.grid.rowDropSettings=getActualProperties(this.rowDropSettings),this.grid.rowHeight=this.rowHeight,this.grid.gridLines=this.gridLines,this.grid.allowSelection=this.allowSelection,this.grid.toolbar=getActualProperties(this.getGridToolbar()),this.grid.toolbarTemplate=this.toolbarTemplate,this.grid.filterSettings=getActualProperties(this.filterSettings),this.grid.selectionSettings=getActualProperties(this.selectionSettings),this.grid.sortSettings=getActualProperties(this.sortSettings),this.grid.searchSettings=getActualProperties(this.searchSettings),this.grid.aggregates=getActualProperties(this.aggregates),this.grid.textWrapSettings=getActualProperties(this.textWrapSettings),this.grid.printMode=getActualProperties(this.printMode),this.grid.locale=getActualProperties(this.locale),this.grid.selectedRowIndex=this.selectedRowIndex,this.grid.contextMenuItems=getActualProperties(this.getContextMenu()),this.grid.columnMenuItems=getActualProperties(this.columnMenuItems),this.grid.editSettings=this.getGridEditSettings(),this.grid.rowTemplate=getActualProperties(this.rowTemplate),this.grid.detailTemplate=getActualProperties(this.detailTemplate),this.grid.templateDotnetInstance=this.templateDotnetInstance,this.grid.isJsComponent=!0}triggerEvents(args){this.trigger(ej2_grids_es2015_getObject("name",args),args)}bindGridEvents(){let treeGrid=this;this.grid.rowSelecting=this.triggerEvents.bind(this),this.grid.rowSelected=args=>{this.selectedRowIndex=this.grid.selectedRowIndex,treeGrid.notify("rowSelected",args),this.trigger("rowSelected",args)},this.grid.rowDeselected=args=>{if(this.selectedRowIndex=this.grid.selectedRowIndex,isBlazor()){let data="data",rowIndex="rowIndex",row="row";args[data]=args[data][args[data].length-1],args[rowIndex]=args[rowIndex][args[rowIndex].length-1],args[row]=args[row][args[row].length-1]}this.trigger("rowDeselected",args)},this.grid.resizeStop=args=>{this.updateColumnModel(),this.trigger("resizeStop",args)},this.grid.excelQueryCellInfo=args=>{this.notify("excelCellInfo",args),args=this.dataResults},this.grid.pdfQueryCellInfo=args=>{this.notify("pdfCellInfo",args),args=this.dataResults},this.grid.checkBoxChange=args=>{this.trigger(checkboxChange,args)},this.grid.pdfExportComplete=this.triggerEvents.bind(this),this.grid.excelExportComplete=this.triggerEvents.bind(this),this.grid.excelHeaderQueryCellInfo=this.triggerEvents.bind(this),this.grid.pdfHeaderQueryCellInfo=this.triggerEvents.bind(this),this.grid.dataSourceChanged=this.triggerEvents.bind(this),this.grid.dataStateChange=this.triggerEvents.bind(this),this.grid.recordDoubleClick=this.triggerEvents.bind(this),this.grid.rowDeselecting=this.triggerEvents.bind(this),this.grid.cellDeselected=this.triggerEvents.bind(this),this.grid.cellDeselecting=this.triggerEvents.bind(this),this.grid.columnMenuOpen=this.triggerEvents.bind(this),this.grid.columnMenuClick=this.triggerEvents.bind(this),this.grid.cellSelected=this.triggerEvents.bind(this),this.grid.headerCellInfo=this.triggerEvents.bind(this),this.grid.resizeStart=this.triggerEvents.bind(this),this.grid.resizing=this.triggerEvents.bind(this),this.grid.columnDrag=this.triggerEvents.bind(this),this.grid.columnDragStart=this.triggerEvents.bind(this),this.grid.columnDrop=this.triggerEvents.bind(this),this.grid.beforePrint=this.triggerEvents.bind(this),this.grid.printComplete=this.triggerEvents.bind(this),this.grid.cellEdit=this.triggerEvents.bind(this),this.grid.actionFailure=this.triggerEvents.bind(this),this.grid.dataBound=args=>{this.updateRowTemplate(args),this.updateColumnModel(),this.updateAltRow(this.getRows()),this.notify("dataBoundArg",args),this.trigger("dataBound",args),!isRemoteData(this)||isOffline(this)||this.hasChildMapping||setValue("grid.contentModule.isLoaded",!(ej2_grids_es2015_getObject("dataSource.requests",this).filter(e=>"OK"!==e.httpRequest.statusText).length>0),this),this.initialRender=!1},this.grid.beforeDataBound=function(args){let requestType=ej2_grids_es2015_getObject("action",args);if(isRemoteData(treeGrid)&&!isOffline(treeGrid)&&"edit"!==requestType?(treeGrid.notify("updateRemoteLevel",args),args=treeGrid.dataResults):0===treeGrid.flatData.length&&isOffline(treeGrid)&&treeGrid.dataSource instanceof ej2_data_es2015_DataManager&&(treeGrid.dataModule.convertToFlatData(treeGrid.dataSource.dataSource.json),args.result=treeGrid.grid.dataSource.dataSource.json=treeGrid.flatData),isRemoteData(treeGrid)||(this.isPrinting&&setValue("isPrinting",!0,args),treeGrid.notify("dataProcessor",args)),extend(args,treeGrid.dataResults),!this.isPrinting){let callBackPromise=new Deferred;return treeGrid.trigger(ej2_treegrid_es2015_beforeDataBound,args,beforeDataBoundArgs=>{callBackPromise.resolve(beforeDataBoundArgs)}),callBackPromise}},this.extendedGridEvents(),this.extendedGridEditEvents(),this.bindCallBackEvents()}bindCallBackEvents(){this.grid.toolbarClick=args=>{let callBackPromise=new Deferred;return this.trigger("toolbarClick",args,toolbarargs=>{toolbarargs.cancel||this.notify("toolbarClick",args),callBackPromise.resolve(toolbarargs)}),callBackPromise},this.grid.cellSelecting=args=>{let callBackPromise=new Deferred;return this.trigger(ej2_grids_es2015_getObject("name",args),args,cellselectingArgs=>{callBackPromise.resolve(cellselectingArgs)}),callBackPromise},this.grid.beginEdit=args=>{let callBackPromise=new Deferred;return this.trigger(ej2_treegrid_es2015_beginEdit,args,begineditArgs=>{callBackPromise.resolve(begineditArgs)}),callBackPromise}}extendedGridEditEvents(){this.grid.cellSave=args=>{if(this.grid.isContextMenuOpen()){let contextitems;(isNullOrUndefined(contextitems=this.grid.contextMenuModule.contextMenu.element.getElementsByClassName("e-selected")[0])||contextitems.id!==this.element.id+"_gridcontrol_cmenu_Save")&&(args.cancel=!0)}let callBackPromise=new Deferred;return this.trigger(ej2_treegrid_es2015_cellSave,args,cellsaveArgs=>{isBlazor()&&(cellsaveArgs.cell=getElement(cellsaveArgs.cell)),cellsaveArgs.cancel||this.notify(ej2_treegrid_es2015_cellSave,cellsaveArgs),callBackPromise.resolve(cellsaveArgs)}),callBackPromise},this.grid.cellEdit=args=>{let promise=new Deferred;return args.promise=promise,this.notify(ej2_treegrid_es2015_cellEdit,args),promise},this.grid.batchCancel=args=>{"Cell"!==this.editSettings.mode&&this.trigger(ej2_treegrid_es2015_batchCancel,args),this.notify(ej2_treegrid_es2015_batchCancel,args)}}updateRowTemplate(args){isBlazor()?setTimeout(()=>{this.treeColumnRowTemplate(args)},1e3):this.treeColumnRowTemplate(args)}bindedDataSource(){if(this.grid.dataSource=this.dataSource instanceof ej2_data_es2015_DataManager?new ej2_data_es2015_DataManager(this.dataSource.dataSource,this.dataSource.defaultQuery,this.dataSource.adaptor):this.flatData,isBlazor()&&this.dataSource instanceof ej2_data_es2015_DataManager&&(this.grid.dataSource.adaptorName=this.dataSource.adaptorName,this.grid.dataSource.dotnetInstance=this.dataSource.dotnetInstance,this.grid.dataSource.key=this.dataSource.key),this.dataSource instanceof ej2_data_es2015_DataManager&&(this.dataSource.dataSource.offline||this.dataSource.ready)){this.grid.dataSource.dataSource.json=extendArray(this.dataSource.dataSource.json),this.grid.dataSource.ready=this.dataSource.ready;let dm=this.grid.dataSource;isNullOrUndefined(this.grid.dataSource.ready)||this.grid.dataSource.ready.then(e=>{dm.dataSource.offline=!0,dm.isDataAvailable=!0,dm.dataSource.json=e.result,dm.adaptor=new ej2_data_es2015_JsonAdaptor})}}extendedGridEvents(){let treeGrid=this;this.grid.recordDoubleClick=args=>{this.trigger(ej2_treegrid_es2015_recordDoubleClick,args),this.notify(ej2_treegrid_es2015_recordDoubleClick,args)},this.grid.detailDataBound=args=>{this.notify("detaildataBound",args),this.trigger("detailDataBound",args)},this.grid.actionBegin=args=>{"reorder"===ej2_grids_es2015_getObject("requestType",args)&&this.notify("getColumnIndex",{}),isRemoteData(this)||isNullOrUndefined(this.filterModule)||0!==this.grid.filterSettings.columns.length&&0!==this.grid.searchSettings.key.length||(this.notify("clearFilters",{flatData:this.grid.dataSource}),this.grid.dataSource=this.dataResults.result);let callBackPromise=new Deferred;if(isBlazor()&&"delete"===args.requestType){let data="data";args[data]=args[data][0]}return this.trigger(ej2_treegrid_es2015_actionBegin,args,actionArgs=>{actionArgs.cancel||this.notify(ej2_treegrid_es2015_beginEdit,actionArgs),isBlazor()&&"delete"===actionArgs.requestType&&(actionArgs.data=this.getSelectedRecords()),isBlazor()&&"beginEdit"===actionArgs.requestType&&(actionArgs.row=getElement(actionArgs.row)),callBackPromise.resolve(actionArgs)}),callBackPromise},this.grid.actionComplete=args=>{this.notify("actioncomplete",args),this.updateColumnModel(),this.updateTreeGridModel(),"reorder"===args.requestType&&this.notify("setColumnIndex",{}),"add"===args.requestType&&"Top"!==this.editSettings.newRowPosition&&"Bottom"!==this.editSettings.newRowPosition&&this.notify(beginAdd,args),"batchsave"===args.requestType&&this.notify("batchSave",args),this.notify("updateGridActions",args),this.trigger(ej2_treegrid_es2015_actionComplete,args)},this.grid.rowDataBound=function(args){isNullOrUndefined(this.isPrinting)?setValue("isPrinting",!1,args):setValue("isPrinting",this.isPrinting,args),treeGrid.renderModule.RowModifier(args)},this.grid.queryCellInfo=function(args){isNullOrUndefined(this.isPrinting)?setValue("isPrinting",!1,args):setValue("isPrinting",this.isPrinting,args),treeGrid.renderModule.cellRender(args)},this.grid.contextMenuClick=args=>{this.notify("contextMenuClick",args),this.trigger("contextMenuClick",args)},this.grid.contextMenuOpen=args=>{this.notify("contextMenuOpen",args),this.trigger("contextMenuOpen",args)},this.grid.queryCellInfo=args=>{this.renderModule.cellRender(args)},this.grid.rowDragStartHelper=args=>{treeGrid.trigger("rowDragStartHelper",args)},this.grid.rowDragStart=args=>{treeGrid.trigger("rowDragStart",args)},this.grid.rowDrag=args=>{treeGrid.notify(rowdraging,args),treeGrid.trigger("rowDrag",args)},this.grid.rowDrop=args=>{treeGrid.notify(rowDropped,args),args.cancel=!0}}loadGrid(){this.bindGridProperties(),this.bindGridEvents(),setValue("registeredTemplate",this.registeredTemplate,this.grid),setValue("viewContainerRef",this.viewContainerRef,this.grid)}autoGenerateColumns(){if(!this.columns.length&&!this.dataModule.isRemote()&&Object.keys(this.dataSource).length){let record,keys=Object.keys(record=this.dataSource[0]);for(let i=0;i<keys.length;i++)-1===[this.childMapping,this.parentIdMapping].indexOf(keys[i])&&this.columns.push(keys[i])}}getGridEditSettings(){let edit={};switch(edit.allowAdding=this.editSettings.allowAdding,edit.allowEditing=this.editSettings.allowEditing,edit.allowDeleting=this.editSettings.allowDeleting,edit.newRowPosition="Bottom"===this.editSettings.newRowPosition?"Bottom":"Top",edit.allowEditOnDblClick=this.editSettings.allowEditOnDblClick,edit.showConfirmDialog=this.editSettings.showConfirmDialog,edit.template=this.editSettings.template,edit.showDeleteConfirmDialog=this.editSettings.showDeleteConfirmDialog,edit.guid=this.editSettings.guid,this.editSettings.mode){case"Dialog":edit.mode=this.editSettings.mode;break;case"Row":edit.mode="Normal";break;case"Cell":edit.mode="Normal",edit.showConfirmDialog=!1}return edit}getContextMenu(){if(this.contextMenuItems){let items=[];for(let i=0;i<this.contextMenuItems.length;i++)switch(this.contextMenuItems[i]){case"AddRow":case ContextMenuItems.AddRow:items.push({text:"AddRow",target:".e-content",id:this.element.id+"_gridcontrol_cmenu_AddRow",items:[{text:"Above",id:"Above"},{text:"Below",id:"Below"}]});break;default:items.push(this.contextMenuItems[i])}return items}return null}getGridToolbar(){if(this.toolbar){this.l10n=new L10n("treegrid",this.defaultLocale,this.locale);let items=[];for(let i=0;i<this.toolbar.length;i++)switch(this.toolbar[i]){case"Search":case ej2_treegrid_es2015_ToolbarItem.Search:items.push("Search");break;case"Print":case ej2_treegrid_es2015_ToolbarItem.Print:items.push("Print");break;case"ExpandAll":case ej2_treegrid_es2015_ToolbarItem.ExpandAll:let tooltipText=this.l10n.getConstant("ExpandAll");items.push({text:tooltipText,tooltipText:tooltipText,prefixIcon:"e-expand",id:this.element.id+"_gridcontrol_expandall"});break;case"CollapseAll":case ej2_treegrid_es2015_ToolbarItem.CollapseAll:let tooltip=this.l10n.getConstant("CollapseAll");items.push({text:tooltip,tooltipText:tooltip,prefixIcon:"e-collapse",id:this.element.id+"_gridcontrol_collapseall"});break;case"Indent":case ej2_treegrid_es2015_ToolbarItem.RowIndent:let tooltipindent=this.l10n.getConstant("RowIndent");items.push({text:tooltipindent,tooltipText:tooltipindent,prefixIcon:"e-indent",id:this.element.id+"_gridcontrol_indent"});break;case"Outdent":case ej2_treegrid_es2015_ToolbarItem.RowOutdent:let tooltipoutdent=this.l10n.getConstant("RowOutdent");items.push({text:tooltipoutdent,tooltipText:tooltipoutdent,prefixIcon:"e-outdent",id:this.element.id+"_gridcontrol_outdent"});break;default:items.push(this.toolbar[i])}return items}return null}getGridColumns(columns){let treeGridColumn,gridColumn,column=columns;this.columnModel=[];let gridColumnCollection=[];for(let i=0;i<column.length;i++){if(gridColumn={},treeGridColumn={},"string"==typeof this.columns[i])gridColumn.field=treeGridColumn.field=this.columns[i];else for(let prop of Object.keys(column[i]))gridColumn[prop]=treeGridColumn[prop]=column[i][prop];column[i].columns?this.getGridColumns(columns[i].columns):this.columnModel.push(new ej2_treegrid_es2015_Column(treeGridColumn)),gridColumnCollection.push(gridColumn)}return gridColumnCollection}onPropertyChanged(newProp,oldProp){let properties=Object.keys(newProp),requireRefresh=!1;for(let prop of properties){switch(prop){case"columns":this.grid.columns=this.getGridColumns(this.columns);break;case"treeColumnIndex":this.grid.refreshColumns();break;case"allowPaging":this.grid.allowPaging=this.allowPaging;break;case"pageSettings":this.grid.pageSettings=getActualProperties(this.pageSettings),requireRefresh=!0;break;case"enableVirtualization":this.grid.enableVirtualization=this.enableVirtualization;break;case"toolbar":this.grid.toolbar=this.getGridToolbar();break;case"allowSelection":this.grid.allowSelection=this.allowSelection;break;case"selectionSettings":this.grid.selectionSettings=getActualProperties(this.selectionSettings);break;case"allowSorting":this.grid.allowSorting=this.allowSorting;break;case"allowMultiSorting":this.grid.allowMultiSorting=this.allowMultiSorting;break;case"sortSettings":this.grid.sortSettings=getActualProperties(this.sortSettings);break;case"searchSettings":this.grid.searchSettings=getActualProperties(this.searchSettings);break;case"allowFiltering":this.grid.allowFiltering=this.allowFiltering;break;case"filterSettings":this.grid.filterSettings=getActualProperties(this.filterSettings);break;case"showColumnMenu":this.grid.showColumnMenu=this.showColumnMenu;break;case"allowRowDragAndDrop":this.grid.allowRowDragAndDrop=this.allowRowDragAndDrop;break;case"aggregates":this.grid.aggregates=getActualProperties(this.aggregates);break;case"dataSource":this.isLocalData=!(this.dataSource instanceof ej2_data_es2015_DataManager)||!isNullOrUndefined(this.dataSource.ready)||this.dataSource.adaptor instanceof ej2_data_es2015_RemoteSaveAdaptor,this.convertTreeData(this.dataSource),this.isLocalData?this.grid.dataSource=this.flatData:this.bindedDataSource();break;case"query":this.grid.query=this.query;break;case"enableCollapseAll":newProp[prop]?this.collapseAll():this.expandAll();break;case"expandStateMapping":this.refresh();break;case"gridLines":this.grid.gridLines=this.gridLines;break;case"rowTemplate":this.grid.rowTemplate=getActualProperties(this.rowTemplate);break;case"rowHeight":this.grid.rowHeight=this.rowHeight;break;case"height":isNullOrUndefined(this.height)||"string"!=typeof this.height||-1===this.height.indexOf("%")||(this.element.style.height=this.height),this.grid.height=this.height;break;case"width":isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(this.element.style.width=this.width),this.grid.width=this.width;break;case"locale":this.grid.locale=this.locale;break;case"selectedRowIndex":this.grid.selectedRowIndex=this.selectedRowIndex;break;case"enableAltRow":this.grid.enableAltRow=this.enableAltRow;break;case"enableHover":this.grid.enableHover=this.enableHover;break;case"allowExcelExport":this.grid.allowExcelExport=this.allowExcelExport;break;case"allowPdfExport":this.grid.allowPdfExport=this.allowPdfExport;break;case"enableRtl":this.grid.enableRtl=this.enableRtl;break;case"allowReordering":this.grid.allowReordering=this.allowReordering;break;case"allowResizing":this.grid.allowResizing=this.allowResizing;break;case"textWrapSettings":this.grid.textWrapSettings=getActualProperties(this.textWrapSettings);break;case"allowTextWrap":this.grid.allowTextWrap=getActualProperties(this.allowTextWrap),this.refresh();break;case"contextMenuItems":this.grid.contextMenuItems=this.getContextMenu();break;case"detailTemplate":this.grid.detailTemplate=getActualProperties(this.detailTemplate);break;case"columnMenuItems":this.grid.columnMenuItems=getActualProperties(this.columnMenuItems);break;case"editSettings":this.grid.isEdit&&"Normal"===this.grid.editSettings.mode&&newProp[prop].mode&&("Cell"===newProp[prop].mode||"Row"===newProp[prop].mode)&&this.grid.closeEdit(),this.grid.editSettings=this.getGridEditSettings()}requireRefresh&&this.refresh()}}destroy(){this.removeListener(),this.unwireEvents(),super.destroy(),this.grid.destroy(),this.dataModule.destroy();let modules=["dataModule","sortModule","renderModule","filterModule","printModule","excelExportModule","pdfExportModule","toolbarModule","summaryModule","reorderModule","resizeModule","pagerModule","keyboardModule","columnMenuModule","contextMenuModule","editModule","virtualScrollModule","selectionModule","detailRow","rowDragAndDropModule"];for(let i=0;i<modules.length;i++)this[modules[i]]&&(this[modules[i]]=null);this.element.innerHTML="",this.grid=null}dataBind(){super.dataBind(),this.grid.dataBind()}getPersistData(){let keyEntity=["pageSettings","sortSettings","filterSettings","columns","searchSettings","selectedRowIndex"],ignoreOnPersist={pageSettings:["template","pageSizes","pageSizeMode","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent","hierarchyMode"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[]};return keyEntity.forEach(value=>{let currentObject=this[value];for(let val of ignoreOnPersist[value])delete currentObject[val]}),this.ignoreInArrays(["filter","edit","filterBarTemplate","headerTemplate","template","commandTemplate","commands","dataSource"],this.columns),this.addOnPersist(keyEntity)}ignoreInArrays(ignoreOnColumn,columns){columns.forEach(column=>{column.columns?(this.ignoreInColumn(ignoreOnColumn,column),this.ignoreInArrays(ignoreOnColumn,column.columns)):this.ignoreInColumn(ignoreOnColumn,column)})}ignoreInColumn(ignoreOnColumn,column){ignoreOnColumn.forEach(val=>{delete column[val],column.filter={}})}mouseClickHandler(e){if(!isNullOrUndefined(e.touches))return;let target=e.target;(target.classList.contains("e-treegridexpand")||target.classList.contains("e-treegridcollapse"))&&this.expandCollapseRequest(target),this.notify("checkboxSelection",{target:target})}getRows(){return this.grid.getRows()}getPager(){return this.grid.getPager()}addRecord(data,index,position){this.editModule.addRecord(data,index,position)}closeEdit(){this.grid.editModule.closeEdit()}deleteRecord(fieldName,data){this.grid.editModule.deleteRecord(fieldName,data)}startEdit(){this.grid.editModule.startEdit()}editCell(rowIndex,field){this.editModule.editCell(rowIndex,field)}endEdit(){this.grid.editModule.endEdit()}deleteRow(tr){this.grid.editModule.deleteRow(tr)}getPrimaryKeyFieldNames(){return this.grid.getPrimaryKeyFieldNames()}setCellValue(key,field,value){this.grid.setCellValue(key,field,value)}setRowData(key,rowData){this.grid.setRowData(key,rowData)}goToPage(pageNo){this.grid.pagerModule.goToPage(pageNo)}updateExternalMessage(message){this.pagerModule&&this.grid.pagerModule.updateExternalMessage(message)}getCellFromIndex(rowIndex,columnIndex){return this.grid.getCellFromIndex(rowIndex,columnIndex)}getColumnByField(field){return iterateArrayOrObject(this.columnModel,(item,index)=>{if(item.field===field)return item})[0]}getColumnByUid(uid){return iterateArrayOrObject(this.columnModel,(item,index)=>{if(item.uid===uid)return item})[0]}getColumnFieldNames(){return this.grid.getColumnFieldNames()}getFooterContent(){return this.grid.getFooterContent()}getFooterContentTable(){return this.grid.getFooterContentTable()}showColumns(keys,showBy){return this.grid.showColumns(keys,showBy)}hideColumns(keys,hideBy){return this.grid.hideColumns(keys,hideBy)}getColumnHeaderByField(field){return this.grid.getColumnHeaderByField(field)}getColumnHeaderByIndex(index){return this.grid.getColumnHeaderByIndex(index)}getColumnHeaderByUid(uid){return this.grid.getColumnHeaderByUid(uid)}getColumnIndexByField(field){return this.grid.getColumnIndexByField(field)}getColumnIndexByUid(uid){return this.grid.getColumnIndexByUid(uid)}getColumns(isRefresh){return this.updateColumnModel(this.grid.getColumns(isRefresh)),this.columnModel}updateColumnModel(column){let gridColumn,gridColumns=isNullOrUndefined(column)?this.grid.getColumns():column;this.columnModel=[];for(let i=0;i<gridColumns.length;i++){gridColumn={};for(let prop of Object.keys(gridColumns[i]))gridColumn[prop]=gridColumns[i][prop];this.columnModel.push(new ej2_treegrid_es2015_Column(gridColumn))}return this.deepMerge=["columns"],this.setProperties({columns:this.columnModel},!0),this.deepMerge=void 0,this.columnModel}getContent(){return this.grid.getContent()}updateTreeGridModel(){this.setProperties({filterSettings:ej2_grids_es2015_getObject("properties",this.grid.filterSettings)},!0),this.setProperties({pageSettings:ej2_grids_es2015_getObject("properties",this.grid.pageSettings)},!0),this.setProperties({searchSettings:ej2_grids_es2015_getObject("properties",this.grid.searchSettings)},!0),this.setProperties({sortSettings:ej2_grids_es2015_getObject("properties",this.grid.sortSettings)},!0)}getContentTable(){return this.grid.getContentTable()}getDataRows(){let dRows=[],rows=this.grid.getDataRows();for(let i=0,len=rows.length;i<len;i++)rows[i].classList.contains("e-summaryrow")||dRows.push(rows[i]);return dRows}getCurrentViewRecords(){return this.grid.currentViewData}getHeaderContent(){return this.grid.getHeaderContent()}getHeaderTable(){return this.grid.getHeaderTable()}getRowByIndex(index){return this.grid.getRowByIndex(index)}getRowInfo(target){return this.grid.getRowInfo(target)}getUidByColumnField(field){return this.grid.getUidByColumnField(field)}getVisibleColumns(){let cols=[];for(let col of this.columnModel)col.visible&&cols.push(col);return cols}showSpinner(){showSpinner(this.element)}hideSpinner(){hideSpinner(this.element)}refresh(){this.grid.refresh()}getCheckedRecords(){return this.selectionModule.getCheckedrecords()}getCheckedRowIndexes(){return this.selectionModule.getCheckedRowIndexes()}selectCheckboxes(indexes){this.selectionModule.selectCheckboxes(indexes)}refreshColumns(){this.grid.columns=this.getGridColumns(this.columns),this.grid.refreshColumns()}refreshHeader(){this.grid.refreshHeader()}expandCollapseRequest(target){if(this.rowTemplate){let rowInfo=target.closest(".e-treerowcell").parentElement,record=this.getCurrentViewRecords()[rowInfo.rowIndex];target.classList.contains("e-treegridexpand")?this.collapseRow(rowInfo,record):this.expandRow(rowInfo,record)}else{let rowInfo=this.grid.getRowInfo(target),record=rowInfo.rowData;target.classList.contains("e-treegridexpand")?this.collapseRow(rowInfo.row,record):this.expandRow(rowInfo.row,record)}}expandRow(row,record){record=this.getCollapseExpandRecords(row,record),this.trigger("expanding",{data:record,row:row,cancel:!1},expandingArgs=>{expandingArgs.cancel||(this.expandCollapse("expand",row,record),isRemoteData(this)&&!isOffline(this))||this.trigger(ej2_treegrid_es2015_expanded,{data:record,row:row})})}getCollapseExpandRecords(row,record){return this.allowPaging&&"All"===this.pageSettings.pageSizeMode&&this.isExpandAll&&isNullOrUndefined(record)&&!isRemoteData(this)?record=this.flatData.filter(e=>e.hasChildRecords):isNullOrUndefined(record)&&(record=this.grid.getCurrentViewRecords()[row.rowIndex]),record}collapseRow(row,record){record=this.getCollapseExpandRecords(row,record),this.trigger("collapsing",{data:record,row:row,cancel:!1},collapsingArgs=>{collapsingArgs.cancel||(this.expandCollapse("collapse",row,record),this.trigger("collapsed",{data:record,row:row}))})}expandAtLevel(level){if((this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization)&&!isRemoteData(this)){let rec=this.grid.dataSource.filter(e=>(e.hasChildRecords&&e.level===level&&(e.expanded=!0),e.hasChildRecords&&e.level===level));this.expandRow(null,rec)}else{let rec=this.getRecordDetails(level),row=ej2_grids_es2015_getObject("rows",rec),record=ej2_grids_es2015_getObject("records",rec);for(let i=0;i<record.length;i++)this.expandRow(row[i],record[i])}}getRecordDetails(level){let rows=this.getRows().filter(e=>-1!==e.className.indexOf("level"+level)&&(e.querySelector(".e-treegridcollapse")||e.querySelector(".e-treegridexpand")));return{records:this.getCurrentViewRecords().filter(e=>e.level===level&&e.hasChildRecords),rows:rows}}collapseAtLevel(level){if((this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization)&&!isRemoteData(this)){let record=this.grid.dataSource.filter(e=>(e.hasChildRecords&&e.level===level&&(e.expanded=!1),e.hasChildRecords&&e.level===level));this.collapseRow(null,record)}else{let rec=this.getRecordDetails(level),rows=ej2_grids_es2015_getObject("rows",rec),records=ej2_grids_es2015_getObject("records",rec);for(let i=0;i<records.length;i++)this.collapseRow(rows[i],records[i])}}expandAll(){this.expandCollapseAll("expand")}collapseAll(){this.expandCollapseAll("collapse")}expandCollapseAll(action){let rows=this.getRows().filter(e=>e.querySelector(".e-treegrid"+("expand"===action?"collapse":"expand")));if(this.isExpandAll=!0,(this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization)&&!isRemoteData(this))this.flatData.filter(e=>{e.hasChildRecords&&(e.expanded="collapse"!==action)}),rows.length&&("collapse"===action?this.collapseRow(rows[0]):this.expandRow(rows[0]));else for(let i=0;i<rows.length;i++)"collapse"===action?this.collapseRow(rows[i]):this.expandRow(rows[i]);this.isExpandAll=!1}expandCollapse(action,row,record,isChild){let rowIndex,gridRows=this.getRows();if(this.rowTemplate){let rows=this.getContentTable().rows;gridRows=[].slice.call(rows)}if(isNullOrUndefined(row)?row=gridRows[rowIndex=this.getCurrentViewRecords().indexOf(record)]:rowIndex=+row.getAttribute("aria-rowindex"),isNullOrUndefined(row)||row.setAttribute("aria-expanded","expand"===action?"true":"false"),(this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization)&&!isRemoteData(this))this.notify("localPagedExpandCollapse",{action:action,row:row,record:record});else{let displayAction;if("expand"===action){displayAction="table-row",isChild||(record.expanded=!0);let targetEle=row.getElementsByClassName("e-treegridcollapse")[0];if(isNullOrUndefined(targetEle))return;addClass([targetEle],"e-treegridexpand"),removeClass([targetEle],"e-treegridcollapse")}else{displayAction="none",isChild||(record.expanded=!1);let targetEle=row.getElementsByClassName("e-treegridexpand")[0];if(isNullOrUndefined(targetEle))return;addClass([targetEle],"e-treegridcollapse"),removeClass([targetEle],"e-treegridexpand")}let args={data:record,row:row};if(isRemoteData(this)&&!isOffline(this)){let rows=gridRows.filter(r=>r.classList.contains("e-gridrowindex"+record.index+"level"+(record.level+1)));if(gridRows.filter(r=>r.classList.contains("e-griddetailrowindex"+record.index+"level"+(record.level+1))),"expand"===action){this.notify(remoteExpand,{record:record,rows:rows,parentRow:row});let args={row:row,data:record};rows.length>0&&this.trigger(ej2_treegrid_es2015_expanded,args)}else this.collapseRemoteChild(rows),this.trigger("collapsed",args)}else{let childRecords=this.getCurrentViewRecords().filter(e=>e.parentUniqueID===record.uniqueID),rows=gridRows.filter(r=>r.classList.contains("e-gridrowindex"+record.index+"level"+(record.level+1))),detailrows=gridRows.filter(detailRowes=>detailRowes.classList.contains("e-griddetailrowindex"+record.index+"level"+(record.level+1)));for(let i=0;i<rows.length;i++)rows[i].style.display=displayAction,this.notify("childRowExpand",{row:rows[i]}),isNullOrUndefined(childRecords[i].childRecords)||"expand"===action&&!isNullOrUndefined(childRecords[i].expanded)&&!childRecords[i].expanded||this.expandCollapse(action,rows[i],childRecords[i],!0);this.notify("rowExpandCollapse",{detailrows:detailrows,action:displayAction})}this.updateAltRow(gridRows)}}updateAltRow(rows){if(this.enableAltRow&&!this.rowTemplate){let visibleRowCount=0;for(let i=0;rows&&i<rows.length;i++){let gridRow=rows[i];"none"!==gridRow.style.display&&(gridRow.classList.contains("e-altrow")&&removeClass([gridRow],"e-altrow"),visibleRowCount%2==0||gridRow.classList.contains("e-summaryrow")||gridRow.classList.contains("e-detailrow")||addClass([gridRow],"e-altrow"),gridRow.classList.contains("e-summaryrow")||gridRow.classList.contains("e-detailrow")||visibleRowCount++)}}}treeColumnRowTemplate(args){if(this.rowTemplate){let rows=this.getContentTable().rows;rows=[].slice.call(rows);for(let i=0;i<rows.length;i++){let rcell=this.grid.getContentTable().rows[i].cells[this.treeColumnIndex],row=rows[i],arg={data:this.grid.getRowsObject()[i].data,row:row,cell:rcell,column:this.getColumns()[this.treeColumnIndex]};this.renderModule.cellRender(arg)}}}collapseRemoteChild(rows){let rData;for(let i=0;i<rows.length;i++){(rData=this.rowTemplate?this.grid.getCurrentViewRecords()[rows[i].rowIndex]:this.grid.getRowObjectFromUID(rows[i].getAttribute("data-Uid")).data).expanded=!1,rows[i].style.display="none";let collapsingTd=rows[i].querySelector(".e-detailrowexpand");if(isNullOrUndefined(collapsingTd)||this.grid.detailRowModule.collapse(collapsingTd),rows[i].querySelector(".e-treecolumn-container .e-treegridexpand")){let expandElement=rows[i].querySelector(".e-treecolumn-container .e-treegridexpand");removeClass([expandElement],"e-treegridexpand"),addClass([expandElement],"e-treegridcollapse");let cRow=[],eRows=this.getRows();for(let i=0;i<eRows.length;i++)eRows[i].classList.contains("e-gridrowindex"+rData.index+"level"+(rData.level+1))&&cRow.push(eRows[i]);this.collapseRemoteChild(cRow)}}}addListener(){this.on("updateResults",this.updateResultModel,this)}updateResultModel(returnResult){this.dataResults=returnResult}removeListener(){this.isDestroyed||this.off("updateResults",this.updateResultModel)}filterByColumn(fieldName,filterOperator,filterValue,predicate,matchCase,ignoreAccent,actualFilterValue,actualOperator){this.grid.filterByColumn(fieldName,filterOperator,filterValue,predicate,matchCase,ignoreAccent,actualFilterValue,actualOperator)}clearFiltering(){this.grid.clearFiltering()}removeFilteredColsByField(field,isClearFilterBar){this.grid.removeFilteredColsByField(field,isClearFilterBar)}selectRow(index,isToggle){this.grid.selectRow(index,isToggle)}selectRows(rowIndexes){this.grid.selectRows(rowIndexes)}clearSelection(){this.grid.clearSelection()}selectCell(cellIndex,isToggle){this.grid.selectCell(cellIndex,isToggle)}getSelectedRows(){return this.grid.getSelectedRows()}getSelectedRowIndexes(){return this.grid.getSelectedRowIndexes()}getSelectedRowCellIndexes(){return this.grid.getSelectedRowCellIndexes()}getSelectedRecords(){return this.grid.getSelectedRecords()}getDataModule(){return{baseModule:this.grid.getDataModule(),treeModule:this.dataModule}}reorderRows(fromIndexes,toIndex,position){this.rowDragAndDropModule.reorderRows(fromIndexes,toIndex,position)}};return __decorate([Property([])],TreeGrid.prototype,"columns",void 0),__decorate([Property(null)],TreeGrid.prototype,"childMapping",void 0),__decorate([Property(null)],TreeGrid.prototype,"hasChildMapping",void 0),__decorate([Property(0)],TreeGrid.prototype,"treeColumnIndex",void 0),__decorate([Property(null)],TreeGrid.prototype,"idMapping",void 0),__decorate([Property(null)],TreeGrid.prototype,"parentIdMapping",void 0),__decorate([Property(!1)],TreeGrid.prototype,"enableCollapseAll",void 0),__decorate([Property(null)],TreeGrid.prototype,"expandStateMapping",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowRowDragAndDrop",void 0),__decorate([Property([])],TreeGrid.prototype,"dataSource",void 0),__decorate([Property()],TreeGrid.prototype,"query",void 0),__decorate([Property()],TreeGrid.prototype,"cloneQuery",void 0),__decorate([Property("AllPages")],TreeGrid.prototype,"printMode",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowPaging",void 0),__decorate([Property(!1)],TreeGrid.prototype,"loadChildOnDemand",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowTextWrap",void 0),__decorate([Complex({},ej2_treegrid_es2015_TextWrapSettings)],TreeGrid.prototype,"textWrapSettings",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowReordering",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowResizing",void 0),__decorate([Property(!1)],TreeGrid.prototype,"autoCheckHierarchy",void 0),__decorate([Complex({},ej2_treegrid_es2015_PageSettings)],TreeGrid.prototype,"pageSettings",void 0),__decorate([Complex({},ej2_grids_es2015_RowDropSettings)],TreeGrid.prototype,"rowDropSettings",void 0),__decorate([Property()],TreeGrid.prototype,"pagerTemplate",void 0),__decorate([Property(!1)],TreeGrid.prototype,"showColumnMenu",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowSorting",void 0),__decorate([Property(!0)],TreeGrid.prototype,"allowMultiSorting",void 0),__decorate([Complex({},ej2_treegrid_es2015_SortSettings)],TreeGrid.prototype,"sortSettings",void 0),__decorate([Collection([],ej2_treegrid_es2015_AggregateRow)],TreeGrid.prototype,"aggregates",void 0),__decorate([Complex({},ej2_treegrid_es2015_EditSettings)],TreeGrid.prototype,"editSettings",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowFiltering",void 0),__decorate([Property()],TreeGrid.prototype,"detailTemplate",void 0),__decorate([Complex({},ej2_treegrid_es2015_FilterSettings)],TreeGrid.prototype,"filterSettings",void 0),__decorate([Complex({},ej2_treegrid_es2015_SearchSettings)],TreeGrid.prototype,"searchSettings",void 0),__decorate([Property()],TreeGrid.prototype,"toolbar",void 0),__decorate([Property()],TreeGrid.prototype,"toolbarTemplate",void 0),__decorate([Property("Default")],TreeGrid.prototype,"gridLines",void 0),__decorate([Property()],TreeGrid.prototype,"contextMenuItems",void 0),__decorate([Property()],TreeGrid.prototype,"columnMenuItems",void 0),__decorate([Property()],TreeGrid.prototype,"rowTemplate",void 0),__decorate([Property(null)],TreeGrid.prototype,"rowHeight",void 0),__decorate([Property(!0)],TreeGrid.prototype,"enableAltRow",void 0),__decorate([Property(!0)],TreeGrid.prototype,"allowKeyboard",void 0),__decorate([Property(!1)],TreeGrid.prototype,"enableHover",void 0),__decorate([Property("auto")],TreeGrid.prototype,"height",void 0),__decorate([Property("auto")],TreeGrid.prototype,"width",void 0),__decorate([Property(!1)],TreeGrid.prototype,"enableVirtualization",void 0),__decorate([Property("All")],TreeGrid.prototype,"columnQueryMode",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"load",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"expanding",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"expanded",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"collapsing",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"collapsed",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"cellSave",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"actionBegin",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"actionComplete",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"beginEdit",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"cellEdit",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"actionFailure",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"dataBound",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"dataSourceChanged",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"dataStateChange",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"recordDoubleClick",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowDataBound",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"detailDataBound",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"queryCellInfo",void 0),__decorate([Property(!0)],TreeGrid.prototype,"allowSelection",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowSelecting",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowSelected",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowDeselecting",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowDeselected",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"headerCellInfo",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"cellSelecting",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"columnMenuOpen",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"columnMenuClick",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"cellSelected",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"cellDeselecting",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"cellDeselected",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"resizeStart",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"resizing",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"resizeStop",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"columnDragStart",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"columnDrag",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"columnDrop",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"checkboxChange",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"printComplete",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"beforePrint",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"toolbarClick",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"beforeDataBound",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"contextMenuOpen",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"contextMenuClick",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowDrag",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowDragStart",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowDragStartHelper",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"rowDrop",void 0),__decorate([Property(-1)],TreeGrid.prototype,"selectedRowIndex",void 0),__decorate([Complex({},ej2_treegrid_es2015_SelectionSettings)],TreeGrid.prototype,"selectionSettings",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowExcelExport",void 0),__decorate([Property(!1)],TreeGrid.prototype,"allowPdfExport",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"pdfQueryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"pdfHeaderQueryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"excelQueryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"excelHeaderQueryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"beforeExcelExport",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"excelExportComplete",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"beforePdfExport",void 0),__decorate([ej2_base_es2015_Event()],TreeGrid.prototype,"pdfExportComplete",void 0),TreeGrid_1=__decorate([NotifyPropertyChanges],TreeGrid)})();class ej2_treegrid_es2015_Reorder$1{constructor(parent,treeColumn){ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_Reorder),this.parent=parent,this.addEventListener()}getModuleName(){return"reorder"}addEventListener(){this.parent.on("getColumnIndex",this.getTreeColumn,this)}removeEventListener(){this.parent.isDestroyed||this.parent.off("getColumnIndex",this.getTreeColumn)}destroy(){this.removeEventListener()}getTreeColumn(){let treeIndex,treeColumn=this.parent.columns[this.parent.treeColumnIndex],updatedCols=this.parent.getColumns();for(let f=0;f<updatedCols.length;f++)if(ej2_grids_es2015_getObject("field",treeColumn)===ej2_grids_es2015_getObject("field",updatedCols[f])){treeIndex=f;break}this.parent.setProperties({treeColumnIndex:treeIndex},!0)}}class ej2_treegrid_es2015_Resize$1{constructor(parent){ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_Resize),this.parent=parent}autoFitColumns(fName){this.parent.grid.autoFitColumns(fName)}getModuleName(){return"resize"}destroy(){this.parent.isDestroyed||this.parent.grid.resizeModule.destroy()}}class ej2_treegrid_es2015_Filter$1{constructor(parent){ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_Filter),this.parent=parent,this.isHierarchyFilter=!1,this.filteredResult=[],this.flatFilteredData=[],this.filteredParentRecs=[],this.addEventListener()}getModuleName(){return"filter"}destroy(){this.removeEventListener()}addEventListener(){this.parent.on("updateFilterRecs",this.updatedFilteredRecord,this),this.parent.on("clearFilters",this.clearFilterLevel,this)}removeEventListener(){this.parent.isDestroyed||(this.parent.off("updateFilterRecs",this.updatedFilteredRecord),this.parent.off("clearFilters",this.clearFilterLevel))}updatedFilteredRecord(dataDetails){setValue("uniqueIDFilterCollection",{},this.parent),this.flatFilteredData=dataDetails.data,this.filteredParentRecs=[],this.filteredResult=[],this.isHierarchyFilter=!1;for(let f=0;f<this.flatFilteredData.length;f++){let rec=this.flatFilteredData[f];this.addParentRecord(rec);let hierarchyMode=""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode;"Child"!==hierarchyMode&&"None"!==hierarchyMode||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key||(this.isHierarchyFilter=!0);let ischild=ej2_grids_es2015_getObject("childRecords",rec);!isNullOrUndefined(ischild)&&ischild.length&&setValue("hasFilteredChildRecords",this.checkChildExsist(rec),rec),isNullOrUndefined(ej2_grids_es2015_getObject("parentItem",rec))||setValue("hasFilteredChildRecords",!0,getParentData(this.parent,rec.parentItem.uniqueID,!0))}this.flatFilteredData.length>0&&this.isHierarchyFilter&&this.updateFilterLevel(),this.parent.notify("updateAction",{result:this.filteredResult})}addParentRecord(record){let parent=getParentData(this.parent,record.parentUniqueID);if("None"!==(""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode)||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key)isNullOrUndefined(parent)||("Child"!==(""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode)||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key?this.addParentRecord(parent):-1!==this.flatFilteredData.indexOf(parent)&&this.addParentRecord(parent)),-1===this.filteredResult.indexOf(record)&&(this.filteredResult.push(record),setValue("uniqueIDFilterCollection."+record.uniqueID,record,this.parent));else if(isNullOrUndefined(parent)){if(-1!==this.flatFilteredData.indexOf(record))return void(-1===this.filteredResult.indexOf(record)&&(this.filteredResult.push(record),setValue("uniqueIDFilterCollection."+record.uniqueID,record,this.parent),record.hasFilteredChildRecords=!0))}else this.addParentRecord(parent),-1!==this.flatFilteredData.indexOf(parent)||-1!==this.filteredResult.indexOf(parent)?-1===this.filteredResult.indexOf(record)&&(this.filteredResult.push(record),setValue("uniqueIDFilterCollection."+record.uniqueID,record,this.parent)):-1===this.filteredResult.indexOf(record)&&-1!==this.flatFilteredData.indexOf(record)&&(this.filteredResult.push(record),setValue("uniqueIDFilterCollection."+record.uniqueID,record,this.parent))}checkChildExsist(records){let childRec=ej2_grids_es2015_getObject("childRecords",records),isExist=!1;for(let count=0;count<childRec.length;count++){let ischild=childRec[count].childRecords,hierarchyMode=""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode;if("Child"!==hierarchyMode&&"Both"!==hierarchyMode||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key||getValue("uniqueIDFilterCollection",this.parent).hasOwnProperty(childRec[count].uniqueID)||(this.filteredResult.push(childRec[count]),setValue("uniqueIDFilterCollection."+childRec[count].uniqueID,childRec[count],this.parent),isExist=!0),"None"===hierarchyMode&&(0!==this.parent.grid.filterSettings.columns.length||""!==this.parent.grid.searchSettings.key)&&-1!==this.flatFilteredData.indexOf(childRec[count])){isExist=!0;break}!isNullOrUndefined(ischild)&&ischild.length&&(isExist=this.checkChildExsist(childRec[count]))}return isExist}updateFilterLevel(){let record=this.filteredResult,len=this.filteredResult.length;for(let c=0;c<len;c++){let parent=getParentData(this.parent,record[c].parentUniqueID);if(-1!==record.indexOf(parent)){let parent=getParentData(this.parent,record[c].parentUniqueID,!0);record[c].filterLevel=parent.filterLevel+1}else record[c].filterLevel=0,this.filteredParentRecs.push(record[c])}}clearFilterLevel(data){let currentRecord,count=0,flatData=data.flatData,len=flatData.length;for(;count<len;count++){let fLevel=(currentRecord=flatData[count]).filterLevel;!fLevel&&0!==fLevel&&isNullOrUndefined(currentRecord.hasFilteredChildRecords)||(currentRecord.hasFilteredChildRecords=null,currentRecord.filterLevel=null)}this.filteredResult=[],this.parent.notify("updateResults",{result:flatData,count:flatData.length})}}class ej2_treegrid_es2015_ContextMenu$1{constructor(parent){ej2_grids_es2015_Grid.Inject(ej2_treegrid_es2015_TreeGridMenu),this.parent=parent,this.addEventListener()}addEventListener(){this.parent.on("contextMenuOpen",this.contextMenuOpen,this),this.parent.on("contextMenuClick",this.contextMenuClick,this)}removeEventListener(){this.parent.isDestroyed||(this.parent.off("contextMenuOpen",this.contextMenuOpen),this.parent.off("contextMenuClick",this.contextMenuClick))}contextMenuOpen(args){this.parent.grid.notify("collectTreeGrid",{tree:this.parent});let addRow=args.element.querySelector("#"+this.parent.element.id+"_gridcontrol_cmenu_AddRow"),editRecord=args.element.querySelector("#"+this.parent.element.id+"_gridcontrol_cmenu_Edit");addRow&&(addRow.style.display=!1===this.parent.grid.editSettings.allowAdding?"none":"block"),"Cell"!==this.parent.editSettings.mode||isNullOrUndefined(editRecord)||editRecord.classList.contains("e-menu-hide")||(editRecord.style.display="none")}contextMenuClick(args){"Above"!==args.item.id&&"Below"!==args.item.id||(this.parent.notify("savePreviousRowPosition",args),this.parent.setProperties({editSettings:{newRowPosition:args.item.id}},!0),this.parent.addRecord())}getModuleName(){return"contextMenu"}destroy(){this.removeEventListener()}getContextMenu(){return this.parent.grid.contextMenuModule.getContextMenu()}}class ej2_treegrid_es2015_TreeGridMenu extends ej2_grids_es2015_ContextMenu$1{addEventListener(){getValue("parent",this).on("collectTreeGrid",this.collectTreeGrid,this),super.addEventListener()}collectTreeGrid(args){this.treegrid=args.tree}contextMenuItemClick(args){let isPrevent=!1;switch(getValue("getKeyFromId",this).apply(this,[args.item.id])){case"PdfExport":this.treegrid.pdfExport(),isPrevent=!0;break;case"ExcelExport":this.treegrid.excelExport(),isPrevent=!0;break;case"CsvExport":this.treegrid.csvExport(),isPrevent=!0;break;case"Save":"Cell"===this.treegrid.editSettings.mode&&"Batch"===this.treegrid.grid.editSettings.mode&&(isPrevent=!0,this.treegrid.grid.editModule.saveCell())}isPrevent?(args.column=getValue("targetColumn",this),args.rowInfo=getValue("targetRowdata",this),getValue("parent",this).trigger("contextMenuClick",args)):super.contextMenuItemClick(args)}}class ej2_treegrid_es2015_Edit$1{constructor(parent){ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_Edit),this.parent=parent,this.isSelfReference=!isNullOrUndefined(parent.parentIdMapping),this.previousNewRowPosition=null,this.internalProperties={},this.addEventListener()}getModuleName(){return"edit"}addEventListener(){this.parent.on(ej2_treegrid_es2015_crudAction,this.crudAction,this),this.parent.on(ej2_treegrid_es2015_beginEdit,this.beginEdit,this),this.parent.on(beginAdd,this.beginAdd,this),this.parent.on(ej2_treegrid_es2015_recordDoubleClick,this.recordDoubleClick,this),this.parent.on(ej2_treegrid_es2015_cellSave,this.cellSave,this),this.parent.on(ej2_treegrid_es2015_batchCancel,this.batchCancel,this),this.parent.grid.on(ej2_treegrid_es2015_keyPressed,this.keyPressed,this),this.parent.grid.on("content-ready",this.contentready,this),this.parent.on(ej2_treegrid_es2015_cellEdit,this.cellEdit,this),this.parent.grid.on(ej2_treegrid_es2015_doubleTap,this.recordDoubleClick,this),this.parent.on("savePreviousRowPosition",this.savePreviousRowPosition,this),this.parent.grid.on(ej2_treegrid_es2015_beforeStartEdit,this.beforeStartEdit,this),this.parent.grid.on(ej2_treegrid_es2015_beforeBatchCancel,this.beforeBatchCancel,this)}beforeStartEdit(args){this.parent.trigger(ej2_treegrid_es2015_actionBegin,args)}beforeBatchCancel(args){this.parent.trigger(ej2_treegrid_es2015_actionComplete,args)}removeEventListener(){this.parent.isDestroyed||(this.parent.off(ej2_treegrid_es2015_crudAction,this.crudAction),this.parent.off(ej2_treegrid_es2015_beginEdit,this.beginEdit),this.parent.off(beginAdd,this.beginAdd),this.parent.off(ej2_treegrid_es2015_recordDoubleClick,this.recordDoubleClick),this.parent.off(ej2_treegrid_es2015_cellSave,this.cellSave),this.parent.off(ej2_treegrid_es2015_batchCancel,this.batchCancel),this.parent.grid.off(ej2_treegrid_es2015_keyPressed,this.keyPressed),this.parent.grid.off("content-ready",this.contentready),this.parent.off(ej2_treegrid_es2015_cellEdit,this.cellEdit),this.parent.grid.off(ej2_treegrid_es2015_doubleTap,this.recordDoubleClick),this.parent.off("savePreviousRowPosition",this.savePreviousRowPosition),this.parent.grid.off(ej2_treegrid_es2015_beforeStartEdit,this.beforeStartEdit),this.parent.grid.off(ej2_treegrid_es2015_beforeBatchCancel,this.beforeBatchCancel))}destroy(){this.removeEventListener()}applyFormValidation(cols){this.parent.grid.editModule.applyFormValidation(cols)}recordDoubleClick(args){let target=args.target;if(this.doubleClickTarget=target,isNullOrUndefined(target.closest("td.e-rowcell")))return;let column=this.parent.grid.getColumnByIndex(+target.closest("td.e-rowcell").getAttribute("aria-colindex"));"Cell"!==this.parent.editSettings.mode||this.isOnBatch||!column||column.isPrimaryKey||!column.allowEditing||target.classList.contains("e-treegridexpand")||target.classList.contains("e-treegridcollapse")||!this.parent.editSettings.allowEditOnDblClick||(this.isOnBatch=!0,this.parent.grid.setProperties({selectedRowIndex:args.rowIndex},!0),this.updateGridEditMode("Batch"))}updateGridEditMode(mode){this.parent.grid.setProperties({editSettings:{mode:mode}},!0),ej2_grids_es2015_getObject("updateEditObj",this.parent.grid.editModule).apply(this.parent.grid.editModule),this.parent.grid.isEdit=!1}keyPressed(args){this.isOnBatch&&(this.keyPress=args.action),"f2"===args.action&&this.recordDoubleClick(args)}deleteUniqueID(value){delete this.parent.uniqueIDFilterCollection[value],delete this.parent.uniqueIDCollection[value]}cellEdit(args){let prom=args.promise;if(delete args.promise,"enter"!==this.keyPress&&this.parent.trigger(ej2_treegrid_es2015_cellEdit,args,celleditArgs=>{celleditArgs.cancel||"Cell"!==this.parent.editSettings.mode||this.enableToolbarItems("edit"),isNullOrUndefined(prom)||prom.resolve(celleditArgs)}),this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")))return args.cancel=!0,void(this.doubleClickTarget=null);"Cell"===this.parent.editSettings.mode&&("tab"===this.keyPress||"shiftTab"===this.keyPress?this.keyPress=null:"enter"===this.keyPress&&(args.cancel=!0,this.keyPress=null))}enableToolbarItems(request){if(!isNullOrUndefined(this.parent.grid.toolbarModule)){let toolbarID=this.parent.element.id+"_gridcontrol_";this.parent.grid.toolbarModule.enableItems([toolbarID+"add",toolbarID+"edit",toolbarID+"delete"],"save"===request),this.parent.grid.toolbarModule.enableItems([toolbarID+"update",toolbarID+"cancel"],"edit"===request)}}batchCancel(e){if("Cell"===this.parent.editSettings.mode){let cellDetails=getValue("editModule.cellDetails",this.parent.grid.editModule),selectRowIndex=cellDetails.rowIndex;this.parent.renderModule.cellRender({data:cellDetails.rowData,cell:this.parent.getRows()[selectRowIndex].cells[this.parent.treeColumnIndex],column:this.parent.grid.getColumns()[this.parent.treeColumnIndex]}),this.updateGridEditMode("Normal"),this.isOnBatch=!1}}cellSave(args){if("Cell"===this.parent.editSettings.mode&&this.parent.element.querySelector("form")){args.cancel=!0,setValue("isEdit",!1,this.parent.grid),args.rowData[args.columnName]=args.value;let rowIndex,row=args.cell.parentNode,primaryKeys=this.parent.getPrimaryKeyFieldNames();isNullOrUndefined(row)?this.parent.grid.getCurrentViewRecords().filter((e,i)=>{e[primaryKeys[0]]!==args.rowData[primaryKeys[0]]||(rowIndex=i)}):rowIndex=this.parent.getDataRows().indexOf(row);let arg={};if(extend(arg,args),arg.cancel=!1,arg.type="save",row=this.parent.grid.getRows()[row.rowIndex],this.parent.trigger(ej2_treegrid_es2015_actionBegin,arg),arg.cancel)this.parent.grid.isEdit=!0;else{this.updateCell(args,rowIndex),this.parent.grid.aggregateModule&&this.parent.grid.aggregateModule.refresh(args.rowData),this.parent.grid.editModule.formObj.destroy(),"tab"!==this.keyPress&&"shiftTab"!==this.keyPress&&(this.updateGridEditMode("Normal"),this.isOnBatch=!1),this.enableToolbarItems("save"),removeClass([row],["e-editedrow","e-batchrow"]),removeClass(row.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"]),editAction({value:args.rowData,action:"edit"},this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,args.columnName);let saveArgs={type:"save",column:this.parent.getColumnByField(args.columnName),data:args.rowData,previousData:args.previousValue,row:row,target:args.cell};this.parent.trigger(ej2_treegrid_es2015_actionComplete,saveArgs)}}}updateCell(args,rowIndex){this.parent.grid.editModule.updateRow(rowIndex,args.rowData),this.parent.grid.getRowsObject()[rowIndex].data=args.rowData}crudAction(details,columnName){editAction(details,this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,columnName,this.addRowRecord),this.parent.parentData=[];let data=this.parent.grid.dataSource instanceof ej2_data_es2015_DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource;for(let i=0;i<data.length;i++){data[i].index=i;let key=this.parent.grid.getPrimaryKeyFieldNames()[0];details.value[key]===data[i][key]&&"add"===details.action&&(data[i].level=this.internalProperties.level,data[i].parentItem=this.internalProperties.parentItem),setValue("uniqueIDCollection."+data[i].uniqueID+".index",i,this.parent),data[i].level||this.parent.parentData.push(data[i])}"add"===details.action&&null!=this.previousNewRowPosition&&(this.parent.setProperties({editSettings:{newRowPosition:this.previousNewRowPosition}},!0),this.previousNewRowPosition=null)}updateIndex(data,rows,records){for(let j=0;j<this.parent.getDataRows().length;j++){let data1=records[j],index=getValue("uniqueIDCollection."+data1.uniqueID+".index",this.parent);if(data1.index=index,!isNullOrUndefined(data1.parentItem)){let parentIndex=getValue("uniqueIDCollection."+data1.parentItem.uniqueID+".index",this.parent);data1.parentItem.index=parentIndex}}let count=-1;for(let k=0;k<this.parent.getRows().length;k++){rows[k].classList.contains("e-detailrow")||count++;let data2=records[count],index=data2.index,level=data2.level,row=rows[k];isNullOrUndefined(data2.parentItem)||(index=getValue("uniqueIDCollection."+data2.parentItem.uniqueID+".index",this.parent));for(let l=0;l<row.classList.length;l++){let value=row.classList[l],removed=/e-griddetailrowindex/i,result=value.match(/e-gridrowindex/i),results=value.match(removed);null!=result&&removeClass([row],value),null!=results&&removeClass([row],value)}rows[k].classList.contains("e-detailrow")?addClass([row],"e-griddetailrowindex"+index+"level"+level):addClass([row],"e-gridrowindex"+index+"level"+level)}}beginAdd(args){let position,index=this.addRowIndex,records=this.parent.grid.getCurrentViewRecords(),rows=this.parent.grid.getDataRows();if("Dialog"!==this.parent.editSettings.mode&&("Child"===this.parent.editSettings.newRowPosition&&!records[index].expanded&&records[index][this.parent.childMapping]&&records[index][this.parent.childMapping].length&&this.parent.expandRow(rows[index+1],records[index]),"Above"===this.parent.editSettings.newRowPosition?position="before":("Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&this.selectedIndex>-1&&(position="after",index+=findChildrenRecords(records[index]).length),this.selectedIndex>-1&&(index||"Child"===this.parent.editSettings.newRowPosition||"Below"===this.parent.editSettings.newRowPosition))){index>=rows.length&&(index=rows.length-2);let focussedElement=document.activeElement;if(rows[index+1][position](rows[0]),"Row"===this.parent.editSettings.mode||"Cell"===this.parent.editSettings.mode){let errors=this.parent.grid.getContentTable().querySelectorAll(".e-griderror");for(let i=0;i<errors.length;i++)errors[i].remove();setValue("errorRules",[],this.parent.grid.editModule.formObj)}focussedElement.focus()}}beginEdit(args){if("refresh"===args.requestType&&this.isOnBatch)args.cancel=!0;else if("Cell"!==this.parent.editSettings.mode||"beginEdit"!==args.requestType){if(this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")||this.doubleClickTarget.classList.contains("e-frame")))return args.cancel=!0,void(this.doubleClickTarget=null);if("delete"===args.requestType){let data=args.data;for(let i=0;i<data.length;i++){this.deleteUniqueID(data[i].uniqueID);let childs=findChildrenRecords(data[i]);for(let c=0;c<childs.length;c++)this.deleteUniqueID(childs[c].uniqueID);args.data=[...data,...childs]}}"add"===args.requestType&&(this.selectedIndex=this.parent.grid.selectedRowIndex,this.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0,this.addRowRecord=this.parent.getSelectedRecords()[0]),args=this.beginAddEdit(args)}else args.cancel=!0}savePreviousRowPosition(args){null===this.previousNewRowPosition&&(this.previousNewRowPosition=this.parent.editSettings.newRowPosition)}beginAddEdit(args){let value=args.data;if("add"===args.action){let key=this.parent.grid.getPrimaryKeyFieldNames()[0],position=null;value.taskData=isNullOrUndefined(value.taskData)?extend({},args.data):value.taskData;let level,dataIndex,idMapping,parentUniqueID,parentItem,parentIdMapping,currentData=this.parent.grid.getCurrentViewRecords(),index=this.addRowIndex;if(value.uniqueID=getUid(this.parent.element.id+"_data_"),setValue("uniqueIDCollection."+value.uniqueID,value,this.parent),currentData.length&&(level=currentData[this.addRowIndex].level,dataIndex=currentData[this.addRowIndex].index,idMapping=currentData[this.addRowIndex][this.parent.idMapping],parentIdMapping=currentData[this.addRowIndex][this.parent.parentIdMapping],currentData[this.addRowIndex].parentItem&&(parentUniqueID=currentData[this.addRowIndex].parentItem.uniqueID),parentItem=currentData[this.addRowIndex].parentItem),"Top"!==this.parent.editSettings.newRowPosition&&currentData.length){if("Above"===this.parent.editSettings.newRowPosition)position="before",index=currentData[this.addRowIndex].index;else if("Below"===this.parent.editSettings.newRowPosition){position="after";let childRecordCount=findChildrenRecords(currentData[this.addRowIndex]).length,currentDataIndex=currentData[this.addRowIndex].index;index=childRecordCount>0?currentDataIndex+childRecordCount:currentDataIndex}else if("Child"===this.parent.editSettings.newRowPosition){position="after",this.selectedIndex>-1&&(value.parentItem=extend({},currentData[this.addRowIndex]),value.parentUniqueID=value.parentItem.uniqueID,delete value.parentItem.childRecords,delete value.parentItem[this.parent.childMapping]);let childRecordCount1=findChildrenRecords(currentData[this.addRowIndex]).length,currentDataIndex1=currentData[this.addRowIndex].index;index=childRecordCount1>0?currentDataIndex1+childRecordCount1:currentDataIndex1,value.level=level+1,this.isSelfReference&&(value.taskData[this.parent.parentIdMapping]=value[this.parent.parentIdMapping]=idMapping,isNullOrUndefined(value.parentItem)||updateParentRow(key,value.parentItem,"add",this.parent,this.isSelfReference,value))}"Above"!==this.parent.editSettings.newRowPosition&&"Below"!==this.parent.editSettings.newRowPosition||(this.selectedIndex>-1&&level&&(value.parentUniqueID=parentUniqueID,value.parentItem=extend({},parentItem),delete value.parentItem.childRecords,delete value.parentItem[this.parent.childMapping]),value.level=level,this.isSelfReference&&(value.taskData[this.parent.parentIdMapping]=value[this.parent.parentIdMapping]=parentIdMapping,isNullOrUndefined(value.parentItem)||updateParentRow(key,value.parentItem,"add",this.parent,this.isSelfReference,value))),null!=position&&this.selectedIndex>-1&&(args.index="before"===position?index:index+1),"Bottom"===this.parent.editSettings.newRowPosition&&(args.index=(this.parent.grid.dataSource instanceof ej2_data_es2015_DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource).length)}isNullOrUndefined(value.level)&&(value.level=level),value.hasChildRecords=!1,value.childRecords=[],value.index=0}if("add"===args.action&&(this.internalProperties={level:value.level,parentItem:value.parentItem}),"delete"===args.requestType){let deletedValues=args.data;for(let i=0;i<deletedValues.length;i++)if(deletedValues[i].parentItem){let parentItem=getParentData(this.parent,deletedValues[i].parentItem.uniqueID);if(!isNullOrUndefined(parentItem)&&parentItem.hasChildRecords){let childIndex=parentItem.childRecords.indexOf(deletedValues[i]);parentItem.childRecords.splice(childIndex,1)}}}return args}addRecord(data,index,position){this.previousNewRowPosition=this.parent.editSettings.newRowPosition,data?(index>-1?(this.selectedIndex=index,this.addRowIndex=index):(this.selectedIndex=this.parent.selectedRowIndex,this.addRowIndex=this.parent.selectedRowIndex),position&&this.parent.setProperties({editSettings:{newRowPosition:position}},!0),this.parent.grid.editModule.addRecord(data,index)):this.parent.grid.editModule.addRecord(data,index)}editFormValidate(){return this.parent.grid.editModule.editFormValidate()}destroyForm(){this.parent.grid.editModule.destroyForm()}contentready(e){isNullOrUndefined(e.args.requestType)||"delete"!==e.args.requestType.toString()&&"save"!==e.args.requestType.toString()||this.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords())}editCell(rowIndex,field){"Cell"===this.parent.editSettings.mode&&(this.isOnBatch=!0,this.updateGridEditMode("Batch"),this.parent.grid.editModule.editCell(rowIndex,field))}}const PANE="e-pane",SPLIT_H_PANE="e-pane-horizontal",SPLIT_V_PANE="e-pane-vertical",STATIC_PANE="e-static-pane",RESIZE_BAR="e-resize-handler",ARROW_LEFT="e-arrow-left",ARROW_UP="e-arrow-up",HIDE_ICON="e-icon-hidden";let ej2_layouts_es2015_PaneProperties=(()=>{class PaneProperties extends ChildProperty{}return __decorate([Property()],PaneProperties.prototype,"size",void 0),__decorate([Property(!1)],PaneProperties.prototype,"collapsible",void 0),__decorate([Property(!1)],PaneProperties.prototype,"collapsed",void 0),__decorate([Property(!0)],PaneProperties.prototype,"resizable",void 0),__decorate([Property(null)],PaneProperties.prototype,"min",void 0),__decorate([Property(null)],PaneProperties.prototype,"max",void 0),__decorate([Property()],PaneProperties.prototype,"content",void 0),PaneProperties})(),ej2_layouts_es2015_Splitter=(()=>{let Splitter=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.allPanes=[],this.paneOrder=[],this.separatorOrder=[],this.allBars=[],this.previousCoordinates={},this.currentCoordinates={},this.updatePrePaneInPercentage=!1,this.updateNextPaneInPercentage=!1,this.panesDimensions=[],this.border=0,this.validDataAttributes=["data-size","data-min","data-max","data-collapsible","data-resizable","data-content","data-collapsed"],this.validElementAttributes=["data-orientation","data-width","data-height"],this.iconsDelay=300}onPropertyChanged(newProp,oldProp){if(this.element.classList.contains("e-splitter"))for(let prop of Object.keys(newProp))switch(prop){case"height":this.setSplitterSize(this.element,newProp.height,"height");break;case"width":this.setSplitterSize(this.element,newProp.width,"width");break;case"cssClass":this.setCssClass(newProp.cssClass);break;case"enabled":this.isEnabled(this.enabled);break;case"separatorSize":this.setSeparatorSize(newProp.separatorSize);break;case"orientation":this.changeOrientation(newProp.orientation);break;case"paneSettings":if(newProp.paneSettings instanceof Array&&oldProp.paneSettings instanceof Array)this.destroyPaneSettings(),this.allBars=[],this.allPanes=[],this.createSplitPane(this.element),this.addSeparator(this.element),this.getPanesDimensions(),this.setRTL(this.enableRtl),this.isCollapsed();else{let paneCounts=Object.keys(newProp.paneSettings);for(let i=0;i<paneCounts.length;i++){let index=parseInt(Object.keys(newProp.paneSettings)[i],10),changedPropsCount=Object.keys(newProp.paneSettings[index]).length;for(let j=0;j<changedPropsCount;j++){let property=Object.keys(newProp.paneSettings[index])[j];switch(property){case"content":let newValue=Object(newProp.paneSettings[index])[property];isNullOrUndefined(newValue)||(this.allPanes[index].innerHTML="",this.setTemplate(newValue,this.allPanes[index]));break;case"resizable":let newVal=Object(newProp.paneSettings[index])[property];this.resizableModel(index,newVal);break;case"collapsible":this.collapsibleModelUpdate(index);break;case"collapsed":newProp.paneSettings[index].collapsed?this.isCollapsed():this.collapsedOnchange(index);break;case"size":let newValSize=Object(newProp.paneSettings[index])[property];""===newValSize||isNullOrUndefined(newValSize)||(this.allPanes[index].style.flexBasis=newValSize,this.allPanes[index].classList.add(STATIC_PANE))}}}}break;case"enableRtl":this.setRTL(newProp.enableRtl)}}preRender(){this.wrapper=this.element.cloneNode(!0),this.wrapperParent=this.element.parentElement,removeClass([this.wrapper],["e-control","e-lib","e-splitter"]),addClass([this.element],"Horizontal"===this.orientation?"e-splitter-horizontal":"e-splitter-vertical"),Browser.isDevice&&addClass([this.element],"e-splitter-touch")}getPersistData(){return this.addOnPersist([])}getModuleName(){return"splitter"}render(){this.checkDataAttributes(),this.setCssClass(this.cssClass),this.isEnabled(this.enabled),this.setDimension(this.getHeight(this.element),this.getWidth(this.element)),this.createSplitPane(this.element),this.addSeparator(this.element),this.getPanesDimensions(),this.setPaneSettings(),this.setRTL(this.enableRtl),this.isCollapsed(),EventHandler.add(document,"touchstart click",this.onDocumentClick,this),this.renderComplete()}onDocumentClick(e){e.target.classList.contains("e-split-bar")||isNullOrUndefined(this.currentSeparator)||(this.currentSeparator.classList.remove("e-split-bar-hover"),this.currentSeparator.classList.remove("e-split-bar-active"))}checkDataAttributes(){let api,value;for(let dataIndex=0;dataIndex<this.validElementAttributes.length;dataIndex++)isNullOrUndefined(value=this.element.getAttribute(this.validElementAttributes[dataIndex]))||(this[api=this.removeDataPrefix(this.validElementAttributes[dataIndex])]=value);for(let paneIndex=0;paneIndex<this.element.children.length;paneIndex++)for(let dataAttr=0;dataAttr<this.validDataAttributes.length;dataAttr++)if(!isNullOrUndefined(value=this.element.children[paneIndex].getAttribute(this.validDataAttributes[dataAttr]))){value="collapsible"===(api=this.removeDataPrefix(this.validDataAttributes[dataAttr]))||"resizable"===api?"true"===value:value,isNullOrUndefined(this.paneSettings[paneIndex])&&(this.paneSettings[paneIndex]={size:"",min:null,max:null,content:"",resizable:!0,collapsible:!1,collapsed:!1});let paneAPI=this.paneSettings[paneIndex][api];"resizable"!==api&&"collapsible"!==api&&"collapsed"!==api||(this.paneSettings[paneIndex][api]=value),(isNullOrUndefined(paneAPI)||""===paneAPI)&&(this.paneSettings[paneIndex][api]=value)}}destroyPaneSettings(){[].slice.call(this.element.children).forEach(el=>{detach(el)})}setPaneSettings(){let childCount=this.allPanes.length,paneCollection=[],paneValue={size:"",min:null,max:null,content:"",resizable:!0,collapsed:!1,collapsible:!1};for(let i=0;i<childCount;i++)paneCollection[i]=isNullOrUndefined(this.paneSettings[i])?paneValue:this.paneSettings[i];this.setProperties({paneSettings:paneCollection},!0)}checkArrow(paneIndex,targetArrow){return this.allBars[paneIndex].querySelector(".e-navigate-arrow."+targetArrow)}removeDataPrefix(attribute){return attribute.slice(attribute.lastIndexOf("-")+1)}setRTL(rtl){rtl?addClass([this.element],"e-rtl"):removeClass([this.element],"e-rtl")}setSplitterSize(element,size,property){setStyleAttribute(element,"width"===property?{width:formatUnit(size)}:{height:formatUnit(size)})}getPanesDimensions(){for(let index=0;index<this.allPanes.length;index++)this.panesDimensions.push("Horizontal"===this.orientation?this.allPanes[index].getBoundingClientRect().width:this.allPanes[index].getBoundingClientRect().height)}setCssClass(className){className&&addClass([this.element],className.split(className.indexOf(",")>-1?",":" "))}hideResizer(target){addClass([ej2_base_es2015_select("."+RESIZE_BAR,target)],"e-hide-handler")}showResizer(target){!isNullOrUndefined(this.previousPane)&&this.previousPane.classList.contains("e-resizable")&&!isNullOrUndefined(this.nextPane)&&this.nextPane.classList.contains("e-resizable")&&removeClass([ej2_base_es2015_select("."+RESIZE_BAR,target)],"e-hide-handler")}resizableModel(index,newVal){let paneIndex,i=index;EventHandler.remove(this.allBars[paneIndex=index===this.allBars.length?index-1:index],"mousedown",this.onMouseDown),newVal?(EventHandler.add(this.allBars[paneIndex],"mousedown",this.onMouseDown,this),this.isResizable()&&(this.showResizer(this.allBars[paneIndex]),removeClass([ej2_base_es2015_select("."+RESIZE_BAR,this.allBars[paneIndex])],"e-hide-handler"),this.allBars[paneIndex].classList.add("e-resizable-split-bar"),index===this.allBars.length?this.allPanes[index].classList.add("e-resizable"):this.allPanes[paneIndex].classList.add("e-resizable"),this.updateResizablePanes(i))):(this.updateResizablePanes(i),this.hideResizer(this.allBars[paneIndex]),this.allBars[paneIndex].classList.remove("e-resizable-split-bar"),index===this.allBars.length?this.allPanes[index].classList.remove("e-resizable"):this.allPanes[paneIndex].classList.remove("e-resizable"))}collapsibleModelUpdate(index){let arrow2,arrow1,paneIndex;arrow2=this.checkArrow(paneIndex=index===this.allBars.length?index-1:index,"Horizontal"===this.orientation?ARROW_LEFT:ARROW_UP),arrow1=this.checkArrow(paneIndex,"Horizontal"===this.orientation?"e-arrow-right":"e-arrow-down"),this.paneCollapsible(this.allPanes[index],index),this.updateCollapseIcons(paneIndex,arrow1,arrow2)}collapseArrow(barIndex,arrow){return ej2_base_es2015_selectAll("."+arrow,this.allBars[barIndex])[0]}updateIsCollapsed(index,collapseArrow,lastBarArrow){if(!isNullOrUndefined(index)){let targetEle,lastBarIndex=index===this.allBars.length;(targetEle=this.collapseArrow(lastBarIndex?index-1:index,lastBarIndex?lastBarArrow:collapseArrow)).click()}}isCollapsed(index){if(isNullOrUndefined(index))for(let m=0;m<this.allPanes.length;m++)!isNullOrUndefined(this.paneSettings[m])&&this.paneSettings[m].collapsed&&this.updateIsCollapsed(m,this.targetArrows().collapseArrow,this.targetArrows().lastBarArrow);else this.updateIsCollapsed(index,this.targetArrows().collapseArrow,this.targetArrows().lastBarArrow)}targetArrows(){return this.splitterProperty(),{collapseArrow:"Horizontal"===this.orientation?ARROW_LEFT:ARROW_UP,lastBarArrow:"Vertical"===this.orientation?"e-arrow-down":"e-arrow-right"}}collapsedOnchange(index){isNullOrUndefined(this.paneSettings[index])||isNullOrUndefined(this.paneSettings[index].collapsed)||this.paneSettings[index].collapsed||this.updateIsCollapsed(index,this.targetArrows().lastBarArrow,this.targetArrows().collapseArrow)}isEnabled(enabled){enabled?removeClass([this.element],"e-disabled"):addClass([this.element],"e-disabled")}setSeparatorSize(size){let sizeValue=isNullOrUndefined(size)?"auto":size+"px",seaprator="Horizontal"===this.orientation?"e-split-bar-horizontal":"e-split-bar-vertical";for(let index=0;index<this.allBars.length;index++){let splitBar=ej2_base_es2015_selectAll("."+seaprator,this.element)[index],resizeBar=ej2_base_es2015_selectAll("."+RESIZE_BAR,splitBar)[0];"Horizontal"===this.orientation?(splitBar.style.width=sizeValue,isNullOrUndefined(resizeBar)||(resizeBar.style.width=sizeValue)):(splitBar.style.height=sizeValue,isNullOrUndefined(resizeBar)||(resizeBar.style.height=sizeValue))}}changeOrientation(orientation){let isVertical="Vertical"===orientation;this.element.classList.remove(isVertical?"e-splitter-horizontal":"e-splitter-vertical"),this.element.classList.add(isVertical?"e-splitter-vertical":"e-splitter-horizontal");for(let index=0;index<this.allPanes.length;index++)this.allPanes[index].classList.remove(isVertical?SPLIT_H_PANE:SPLIT_V_PANE),this.allPanes[index].classList.add(isVertical?SPLIT_V_PANE:SPLIT_H_PANE);for(let index=0;index<this.allBars.length;index++)detach(this.allBars[index]);this.allBars=[],this.addSeparator(this.element)}checkSplitPane(currentBar,elementIndex){return this.collectPanes(currentBar.parentElement.children)[elementIndex]}collectPanes(childNodes){let elements=[];for(let i=0;i<childNodes.length;i++)childNodes[i].classList.contains("e-pane")&&elements.push(childNodes[i]);return elements}getPrevPane(currentBar,order){return this.checkSplitPane(currentBar,(order-1)/2)}getNextPane(currentBar,order){return this.checkSplitPane(currentBar,(order-1)/2+1)}addResizeHandler(currentBar){let resizeHanlder=this.createElement("div");addClass([resizeHanlder],[RESIZE_BAR,"e-icons"]);let sizeValue=isNullOrUndefined(this.separatorSize)?"1px":this.separatorSize+"px";"Horizontal"===this.orientation?resizeHanlder.style.width=sizeValue:resizeHanlder.style.height=sizeValue,currentBar.appendChild(resizeHanlder)}getHeight(target){return""!==target.style.height&&"100%"===this.height?target.style.height:this.height}getWidth(target){return""!==target.style.width&&"100%"===this.width?target.style.width:this.width}setDimension(height,width){setStyleAttribute(this.element,{height:height,width:width})}updateCollapseIcons(index,arrow1,arrow2){isNullOrUndefined(this.paneSettings[index])||isNullOrUndefined(this.paneSettings[index].collapsible)||(this.paneSettings[index].collapsible?removeClass([arrow2],[HIDE_ICON]):addClass([arrow2],[HIDE_ICON]),isNullOrUndefined(this.paneSettings[index+1])||(this.paneSettings[index+1].collapsible?removeClass([arrow1],[HIDE_ICON]):addClass([arrow1],[HIDE_ICON])),isNullOrUndefined(this.paneSettings[index+1])||this.paneSettings[index+1].collapsible&&(this.paneSettings[index+1].collapsible?removeClass([arrow1],[HIDE_ICON]):addClass([arrow1],[HIDE_ICON])))}createSeparator(i){let separator=this.createElement("div");this.allBars.push(separator);let size,arrow1=this.createElement("button"),arrow2=this.createElement("button");return size=isNullOrUndefined(this.separatorSize)?"1px":this.separatorSize+"px","Horizontal"===this.orientation?(this.leftArrow=ARROW_LEFT,this.rightArrow="e-arrow-right",addClass([arrow2],["e-navigate-arrow",ARROW_LEFT,HIDE_ICON]),addClass([arrow1],["e-navigate-arrow","e-arrow-right",HIDE_ICON]),addClass([separator],["e-split-bar","e-split-bar-horizontal"]),separator.style.width=size):(addClass([arrow1],["e-navigate-arrow","e-arrow-down",HIDE_ICON]),addClass([arrow2],["e-navigate-arrow",ARROW_UP,HIDE_ICON]),addClass([separator],["e-split-bar","e-split-bar-vertical"]),this.leftArrow=ARROW_UP,this.rightArrow="e-arrow-down",separator.style.height=size),this.addMouseActions(separator),separator.appendChild(arrow2),this.addResizeHandler(separator),separator.appendChild(arrow1),this.updateCollapseIcons(i,arrow1,arrow2),separator}updateResizablePanes(index){this.getPaneDetails(),this.isResizable()?this.allPanes[index].classList.add("e-resizable"):this.allPanes[index].classList.remove("e-resizable")}addSeparator(target){let separator,childCount=this.allPanes.length,clonedEle=target.children;for(let i=0;i<childCount;i++)i<childCount-1?(setStyleAttribute(separator=this.createSeparator(i),{order:2*i+1}),this.separatorOrder.push(2*i+1),clonedEle[i].parentNode.appendChild(separator),this.currentSeparator=separator,separator.setAttribute("role","separator"),separator.setAttribute("aria-orientation",this.orientation.toLowerCase()),this.wireClickEvents(),this.isResizable()?(EventHandler.add(separator,"mousedown",this.onMouseDown,this),EventHandler.add(separator,"msie"===Browser.info.name?"pointerdown":"touchstart",this.onMouseDown,this),separator.classList.add("e-resizable-split-bar"),this.updateResizablePanes(i)):addClass([ej2_base_es2015_select("."+RESIZE_BAR,separator)],"e-hide-handler")):(this.updateResizablePanes(i),addClass([separator],"e-last-bar"))}isResizable(){let resizable=!1;return(!isNullOrUndefined(this.paneSettings[this.getPreviousPaneIndex()])&&this.paneSettings[this.getPreviousPaneIndex()].resizable&&!isNullOrUndefined(this.paneSettings[this.getNextPaneIndex()])&&this.paneSettings[this.getNextPaneIndex()].resizable||isNullOrUndefined(this.paneSettings[this.getNextPaneIndex()]))&&(resizable=!0),resizable}addMouseActions(separator){let sTout,hoverTimeOut;separator.addEventListener("mouseenter",()=>{sTout=setTimeout(()=>{addClass([separator],["e-split-bar-hover"])},this.iconsDelay)}),separator.addEventListener("mouseleave",()=>{clearTimeout(sTout),removeClass([separator],["e-split-bar-hover"])}),separator.addEventListener("mouseout",()=>{clearTimeout(hoverTimeOut)}),separator.addEventListener("mouseover",()=>{hoverTimeOut=setTimeout(()=>{addClass([separator],["e-split-bar-hover"])},this.iconsDelay)})}getEventType(e){return e.indexOf("mouse")>-1?"mouse":"touch"}updateCurrentSeparator(target){this.currentSeparator=this.isSeparator(target)?target.parentElement:target}isSeparator(target){return!target.classList.contains(RESIZE_BAR)&&!target.classList.contains("e-split-bar")}isMouseEvent(e){let isMouse=!1;return("mouse"===this.getEventType(e.type)||!isNullOrUndefined(e.pointerType)&&"mouse"===this.getEventType(e.pointerType))&&(isMouse=!0),isMouse}updateCursorPosition(e,type){if(this.isMouseEvent(e))this.changeCoordinates({x:e.pageX,y:e.pageY},type);else{let eventType="msie"!==Browser.info.name?e.touches[0]:e;this.changeCoordinates({x:eventType.pageX,y:eventType.pageY},type)}}changeCoordinates(coordinates,type){"previous"===type?this.previousCoordinates=coordinates:this.currentCoordinates=coordinates}reportWindowSize(){let paneCount=this.allPanes.length;for(let i=0;i<paneCount;i++)isNullOrUndefined(this.paneSettings[i].size)&&this.allPanes[i].classList.remove(STATIC_PANE),paneCount-1===i&&this.element.querySelectorAll("."+STATIC_PANE).length===paneCount&&removeClass([this.allPanes[i]],STATIC_PANE)}wireResizeEvents(){EventHandler.add(document,"mousemove",this.onMouseMove,this),window.addEventListener("resize",this.reportWindowSize.bind(this)),EventHandler.add(document,"mouseup",this.onMouseUp,this);let touchEndEvent="msie"===Browser.info.name?"pointerup":"touchend";EventHandler.add(document,"msie"===Browser.info.name?"pointermove":"touchmove",this.onMouseMove,this),EventHandler.add(document,touchEndEvent,this.onMouseUp,this)}unwireResizeEvents(){window.removeEventListener("resize",this.reportWindowSize.bind(this));let touchMoveEvent="msie"===Browser.info.name?"pointermove":"touchmove",touchEndEvent="msie"===Browser.info.name?"pointerup":"touchend";EventHandler.remove(document,"mousemove",this.onMouseMove),EventHandler.remove(document,"mouseup",this.onMouseUp),EventHandler.remove(document,touchMoveEvent,this.onMouseMove),EventHandler.remove(document,touchEndEvent,this.onMouseUp)}wireClickEvents(){EventHandler.add(this.currentSeparator,"touchstart click",this.clickHandler,this)}clickHandler(e){if(!e.target.classList.contains("e-navigate-arrow")){let hoverBars=ej2_base_es2015_selectAll(".e-splitter > .e-split-bar.e-split-bar-hover");hoverBars.length>0&&removeClass(hoverBars,"e-split-bar-hover"),e.target.classList.add("e-split-bar-hover")}let icon=e.target;(icon.classList.contains(ARROW_LEFT)||icon.classList.contains(ARROW_UP))&&this.collapseAction(e),(icon.classList.contains("e-arrow-right")||icon.classList.contains("e-arrow-down"))&&this.expandAction(e)}expandAction(e){this.splitterDetails(e);let collapseClass=["e-collapsed","e-pane-hidden"],eventArgs=this.beforeAction(e);this.trigger("beforeExpand",eventArgs,beforeExpandArgs=>{if(!beforeExpandArgs.cancel){this.nextPane.style.flexGrow="0",this.previousPane.style.flexGrow=this.previousPane.classList.contains("e-collapsed")&&"0"===this.previousPane.style.flexGrow?"0":"1",this.previousPane.classList.contains("e-collapsed")?(0!==this.currentBarIndex?this.previousPane.previousElementSibling.style.flexGrow="":this.nextPane.style.flexGrow="",removeClass([this.previousPane],collapseClass),removeClass([this.nextPane],"e-expanded")):(removeClass([this.nextPane],"e-expanded"),removeClass([this.previousPane],collapseClass),addClass([this.previousPane],"e-expanded"),addClass([this.nextPane],collapseClass)),this.updateIconsOnExpand(e),this.previousPane.setAttribute("aria-expanded","true"),this.nextPane.setAttribute("aria-expanded","false");let expandEventArgs=this.afterAction(e);this.trigger("expanded",expandEventArgs)}})}hideTargetBarIcon(targetBar,targetArrow){addClass([ej2_base_es2015_select("."+targetArrow,targetBar)],HIDE_ICON)}showTargetBarIcon(targetBar,targetArrow){removeClass([ej2_base_es2015_select("."+targetArrow,targetBar)],HIDE_ICON)}updateIconsOnCollapse(e){this.splitterProperty(),this.splitInstance.prevPaneCollapsed&&this.splitInstance.nextPaneExpanded?(addClass([e.target],HIDE_ICON),this.showCurrentBarIcon(),this.resizableModel(this.currentBarIndex,!1),isNullOrUndefined(this.prevBar)||(this.resizableModel(this.currentBarIndex-1,!1),this.hideTargetBarIcon(this.prevBar,this.arrow),this.showTargetBarIcon(this.prevBar,this.leftArrow))):this.splitInstance.prevPaneCollapsed||this.splitInstance.nextPaneExpanded||(this.resizableModel(this.currentBarIndex,!0),this.splitInstance.nextPaneNextEle.classList.contains("e-collapsed")||this.resizableModel(this.currentBarIndex+1,!0),this.showCurrentBarIcon(),this.paneSettings[this.currentBarIndex].collapsible||addClass([e.target],HIDE_ICON),isNullOrUndefined(this.nextBar)||(this.showTargetBarIcon(this.nextBar,this.leftArrow),!this.paneSettings[this.currentBarIndex].collapsible&&this.paneSettings[this.currentBarIndex+1].collapsible?this.hideTargetBarIcon(this.nextBar,this.arrow):!this.paneSettings[this.splitInstance.nextPaneIndex+1].collapsible&&this.paneSettings[this.currentBarIndex]&&this.hideTargetBarIcon(this.nextBar,this.arrow)))}collapseAction(e){this.splitterDetails(e);let collapseClass=["e-collapsed","e-pane-hidden"];this.previousPane.style.flexGrow="0",this.nextPane.style.flexGrow="1";let eventArgs=this.beforeAction(e);this.trigger("beforeCollapse",eventArgs,beforeCollapseArgs=>{if(!beforeCollapseArgs.cancel){this.nextPane.classList.contains("e-collapsed")?(removeClass([this.previousPane],"e-expanded"),removeClass([this.nextPane],collapseClass)):(removeClass([this.previousPane],"e-expanded"),removeClass([this.nextPane],collapseClass),addClass([this.nextPane],"e-expanded"),addClass([this.previousPane],collapseClass)),this.updateIconsOnCollapse(e),this.previousPane.setAttribute("aria-expanded","false"),this.nextPane.setAttribute("aria-expanded","true");let collapseEventArgs=this.afterAction(e);this.trigger("collapsed",collapseEventArgs)}})}beforeAction(e){return isBlazor()?{element:this.element,event:e,index:[this.prevPaneIndex,this.nextPaneIndex],separator:this.currentSeparator,cancel:!1}:{element:this.element,event:e,pane:[this.previousPane,this.nextPane],index:[this.prevPaneIndex,this.nextPaneIndex],separator:this.currentSeparator,cancel:!1}}splitterProperty(){this.splitInstance={currentBarIndex:this.currentBarIndex,nextPaneCollapsible:this.nextPane.classList.contains("e-collapsible"),prevPaneCollapsible:this.previousPane.classList.contains("e-collapsible"),prevPaneExpanded:this.previousPane.classList.contains("e-expanded"),nextPaneExpanded:this.nextPane.classList.contains("e-expanded"),nextPaneCollapsed:this.nextPane.classList.contains("e-collapsed"),prevPaneCollapsed:this.previousPane.classList.contains("e-collapsed"),nextPaneIndex:this.getNextPaneIndex(),prevPaneIndex:this.getPreviousPaneIndex(),nextPaneNextEle:this.nextPane.nextElementSibling,prevPanePreEle:this.previousPane.previousElementSibling}}showCurrentBarIcon(){removeClass([ej2_base_es2015_select("."+this.arrow,this.currentSeparator)],HIDE_ICON)}updateIconsOnExpand(e){this.splitterProperty(),addClass([e.target],HIDE_ICON),this.splitInstance.prevPaneExpanded||this.splitInstance.nextPaneCollapsed?this.splitInstance.prevPaneExpanded&&this.splitInstance.nextPaneCollapsed&&(this.resizableModel(this.currentBarIndex,!1),this.resizableModel(this.currentBarIndex+1,!1),this.showCurrentBarIcon(),isNullOrUndefined(this.nextBar)||(this.hideTargetBarIcon(this.nextBar,this.arrow),this.showTargetBarIcon(this.nextBar,this.rightArrow))):(this.showCurrentBarIcon(),removeClass([e.target],HIDE_ICON),this.resizableModel(this.currentBarIndex,!0),isNullOrUndefined(this.prevBar)||this.splitInstance.prevPanePreEle.classList.contains("e-collapsed")?this.paneSettings[this.currentBarIndex].collapsible&&!this.paneSettings[this.currentBarIndex+1].collapsible?this.hideTargetBarIcon(this.currentSeparator,this.rightArrow):this.showTargetBarIcon(this.prevBar,this.rightArrow):(this.resizableModel(this.currentBarIndex-1,!0),this.showTargetBarIcon(this.prevBar,this.rightArrow),this.paneSettings[this.currentBarIndex-1].collapsible?this.paneSettings[this.currentBarIndex].collapsible&&!this.paneSettings[this.currentBarIndex+1].collapsible&&this.hideTargetBarIcon(this.currentSeparator,this.rightArrow):(this.hideTargetBarIcon(this.prevBar,this.arrow),this.paneSettings[this.currentBarIndex].collapsible&&!this.paneSettings[this.currentBarIndex+1].collapsible&&this.hideTargetBarIcon(this.currentSeparator,this.rightArrow))))}afterAction(e){return isBlazor()?{element:this.element,event:e,index:[this.prevPaneIndex,this.nextPaneIndex],separator:this.currentSeparator}:{element:this.element,event:e,pane:[this.previousPane,this.nextPane],index:[this.prevPaneIndex,this.nextPaneIndex],separator:this.currentSeparator}}currentIndex(e){this.currentBarIndex=this.getSeparatorIndex(e.target.parentElement)}getSeparatorIndex(target){return[].slice.call(this.allBars).indexOf(target)}getPrevBar(currentBar){return this.allBars[currentBar-1]}getNextBar(currentBar){return this.allBars[currentBar+1]}updateBars(index){this.prevBar=this.getPrevBar(index),this.nextBar=this.getNextBar(index)}splitterDetails(e){this.arrow="Horizontal"===this.orientation?e.target.classList.contains(ARROW_LEFT)?"e-arrow-right":ARROW_LEFT:e.target.classList.contains(ARROW_UP)?"e-arrow-down":ARROW_UP,this.updateCurrentSeparator(e.target),this.currentIndex(e),this.updateBars(this.currentBarIndex),this.getPaneDetails()}onMouseDown(e){e.preventDefault();let target=e.target;if(target.classList.contains("e-navigate-arrow"))return;this.updateCurrentSeparator(target),addClass([this.currentSeparator],"e-split-bar-active"),this.updateCursorPosition(e,"previous"),this.getPaneDetails();let eventArgs=isBlazor()?{element:this.element,event:e,index:[this.getPreviousPaneIndex(),this.getNextPaneIndex()],separator:this.currentSeparator,cancel:!1}:{element:this.element,event:e,pane:[this.previousPane,this.nextPane],index:[this.getPreviousPaneIndex(),this.getNextPaneIndex()],separator:this.currentSeparator,cancel:!1};this.trigger("resizeStart",eventArgs,resizeStartArgs=>{if(!resizeStartArgs.cancel)if(this.wireResizeEvents(),this.previousPane.style.flexBasis.indexOf("%")>0||this.nextPane.style.flexBasis.indexOf("%")>0){let previousFlexBasis=this.updatePaneFlexBasis(this.previousPane),nextFlexBasis=this.updatePaneFlexBasis(this.nextPane);this.totalPercent=previousFlexBasis+nextFlexBasis,this.totalWidth=this.convertPercentageToPixel(this.totalPercent+"%")}else this.totalWidth="Horizontal"===this.orientation?this.previousPane.offsetWidth+this.nextPane.offsetWidth:this.previousPane.offsetHeight+this.nextPane.offsetHeight})}updatePaneFlexBasis(pane){return pane.style.flexBasis.indexOf("%")>0?this.removePercentageUnit(pane.style.flexBasis):this.convertPixelToPercentage(""!==pane.style.flexBasis?this.convertPixelToNumber(pane.style.flexBasis):"Horizontal"===this.orientation?pane.offsetWidth+this.currentSeparator.offsetWidth:pane.offsetHeight+this.currentSeparator.offsetHeight)}removePercentageUnit(value){return parseFloat(value.slice(0,value.indexOf("%")))}convertPercentageToPixel(value,targetElement){let convertedValue,percentage=value.toString();if(percentage.indexOf("%")>-1){let offsetValue;convertedValue=parseFloat(percentage.slice(0,percentage.indexOf("%"))),offsetValue=isNullOrUndefined(targetElement)?"Horizontal"===this.orientation?this.element.offsetWidth:this.element.offsetHeight:this.panesDimensions[this.allPanes.indexOf(targetElement)],convertedValue=Math.ceil(offsetValue*(convertedValue/100))}else convertedValue=parseInt(percentage,10);return convertedValue}convertPixelToPercentage(value){return value/("Horizontal"===this.orientation?this.element.offsetWidth:this.element.offsetHeight)*100}convertPixelToNumber(value){return value.indexOf("p")>-1?parseFloat(value.slice(0,value.indexOf("p"))):parseFloat(value)}calcDragPosition(rectValue,offsetValue){let separatorPosition,separator;return(separator=(separator=(separatorPosition="Horizontal"===this.orientation?this.currentCoordinates.x-rectValue:this.currentCoordinates.y-rectValue)/offsetValue)>1?1:separator<0?0:separator)*offsetValue}getSeparatorPosition(e){this.updateCursorPosition(e,"current");let rectBound="Horizontal"===this.orientation?this.element.getBoundingClientRect().left:this.element.getBoundingClientRect().top;return this.calcDragPosition(rectBound,"Horizontal"===this.orientation?this.element.offsetWidth:this.element.offsetHeight)}getMinMax(paneIndex,target,selection){let defaultVal="min"===selection?0:null,paneValue=null;return"min"===selection?isNullOrUndefined(this.paneSettings[paneIndex])||isNullOrUndefined(this.paneSettings[paneIndex].min)||(paneValue=this.paneSettings[paneIndex].min):isNullOrUndefined(this.paneSettings[paneIndex])||isNullOrUndefined(this.paneSettings[paneIndex].max)||(paneValue=this.paneSettings[paneIndex].max),this.paneSettings.length>0&&!isNullOrUndefined(this.paneSettings[paneIndex])&&!isNullOrUndefined(paneValue)?(paneValue.indexOf("%")>0&&(paneValue=this.convertPercentageToPixel(paneValue).toString()),this.convertPixelToNumber(paneValue)):defaultVal}getPreviousPaneIndex(){return(parseInt(this.currentSeparator.style.order,10)-1)/2}getNextPaneIndex(){return(parseInt(this.currentSeparator.style.order,10)-1)/2+1}getPaneDetails(){this.order=parseInt(this.currentSeparator.style.order,10);let prevPane=this.getPrevPane(this.currentSeparator,this.order),nextPane=this.getNextPane(this.currentSeparator,this.order);prevPane&&nextPane&&(this.previousPane=prevPane,this.nextPane=nextPane,this.prevPaneIndex=this.getPreviousPaneIndex(),this.nextPaneIndex=this.getNextPaneIndex())}getPaneHeight(pane){return"Horizontal"===this.orientation?pane.offsetWidth.toString():pane.offsetHeight.toString()}isValidSize(paneIndex){let isValid=!1;return!isNullOrUndefined(this.paneSettings[paneIndex])&&!isNullOrUndefined(this.paneSettings[paneIndex].size)&&this.paneSettings[paneIndex].size.indexOf("%")>-1&&(isValid=!0),isValid}getPaneDimensions(){this.previousPaneHeightWidth=""===this.previousPane.style.flexBasis?this.getPaneHeight(this.previousPane):this.previousPane.style.flexBasis,this.nextPaneHeightWidth=""===this.nextPane.style.flexBasis?this.getPaneHeight(this.nextPane):this.nextPane.style.flexBasis,this.isValidSize(this.prevPaneIndex)&&(this.previousPaneHeightWidth=this.convertPercentageToPixel(this.previousPaneHeightWidth).toString(),this.updatePrePaneInPercentage=!0),this.isValidSize(this.nextPaneIndex)&&(this.nextPaneHeightWidth=this.convertPercentageToPixel(this.nextPaneHeightWidth).toString(),this.updateNextPaneInPercentage=!0),this.prePaneDimenson=this.convertPixelToNumber(this.previousPaneHeightWidth.toString()),this.nextPaneDimension=this.convertPixelToNumber(this.nextPaneHeightWidth.toString())}checkCoordinates(pageX,pageY){let coordinatesChanged=!0;return pageX!==this.previousCoordinates.x&&pageY!==this.previousCoordinates.y||(coordinatesChanged=!1),coordinatesChanged}isCursorMoved(e){return"mouse"===this.getEventType(e.type)||!isNullOrUndefined(e.pointerType)&&"mouse"===this.getEventType(e.pointerType)?this.checkCoordinates(e.pageX,e.pageY):"msie"!==Browser.info.name?this.checkCoordinates(e.touches[0].pageX,e.touches[0].pageY):this.checkCoordinates(e.pageX,e.pageY)}getBorder(){this.border=0,this.border="chrome"!==Browser.info.name?this.border:"Horizontal"===this.orientation?(this.element.offsetWidth-this.element.clientWidth)/2:(this.element.offsetHeight-this.element.clientHeight)/2}onMouseMove(e){if(!this.isCursorMoved(e))return;this.getPaneDetails(),this.getPaneDimensions();let eventArgs=isBlazor()?{element:this.element,event:e,index:[this.prevPaneIndex,this.nextPaneIndex],paneSize:[this.prePaneDimenson,this.nextPaneDimension],separator:this.currentSeparator}:{element:this.element,event:e,pane:[this.previousPane,this.nextPane],index:[this.prevPaneIndex,this.nextPaneIndex],paneSize:[this.prePaneDimenson,this.nextPaneDimension],separator:this.currentSeparator};this.trigger("resizing",eventArgs);let separatorNewPosition,left=this.validateDraggedPosition(this.getSeparatorPosition(e),this.prePaneDimenson,this.nextPaneDimension);this.getBorder(),separatorNewPosition="Horizontal"===this.orientation?this.element.getBoundingClientRect().left+left-this.currentSeparator.getBoundingClientRect().left+this.border:this.element.getBoundingClientRect().top+left-this.currentSeparator.getBoundingClientRect().top+this.border,this.nextPaneHeightWidth="string"==typeof this.nextPaneHeightWidth&&this.nextPaneHeightWidth.indexOf("p")>-1?this.convertPixelToNumber(this.nextPaneHeightWidth):parseInt(this.nextPaneHeightWidth,10),this.prevPaneCurrentWidth=separatorNewPosition+this.convertPixelToNumber(this.previousPaneHeightWidth),this.nextPaneCurrentWidth=this.nextPaneHeightWidth-separatorNewPosition,this.validateMinMaxValues(),this.nextPaneCurrentWidth<0&&(this.nextPaneCurrentWidth=0),this.prevPaneCurrentWidth<0&&(this.prevPaneCurrentWidth=0),this.nextPaneCurrentWidth+this.prevPaneCurrentWidth>this.totalWidth&&(this.nextPaneCurrentWidth<this.prevPaneCurrentWidth?this.prevPaneCurrentWidth=this.prevPaneCurrentWidth-(this.nextPaneCurrentWidth+this.prevPaneCurrentWidth-this.totalWidth):this.nextPaneCurrentWidth=this.nextPaneCurrentWidth-(this.nextPaneCurrentWidth+this.prevPaneCurrentWidth-this.totalWidth)),this.nextPaneCurrentWidth+this.prevPaneCurrentWidth<this.totalWidth&&(this.nextPaneCurrentWidth=this.nextPaneCurrentWidth+(this.totalWidth-(this.nextPaneCurrentWidth+this.prevPaneCurrentWidth))),this.calculateCurrentDimensions(),this.addStaticPaneClass(),this.previousPane.style.flexBasis=this.prevPaneCurrentWidth,this.nextPane.style.flexBasis=this.nextPaneCurrentWidth}validateMinRange(paneIndex,paneCurrentWidth,pane){let paneMinDimensions,validatedVal,paneMinRange=null;return isNullOrUndefined(this.paneSettings[paneIndex])||isNullOrUndefined(this.paneSettings[paneIndex].min)||(paneMinRange=this.paneSettings[paneIndex].min.toString()),isNullOrUndefined(paneMinRange)||(paneMinRange.indexOf("%")>0&&(paneMinRange=this.convertPercentageToPixel(paneMinRange).toString()),paneCurrentWidth<(paneMinDimensions=this.convertPixelToNumber(paneMinRange))&&(this.totalWidth=this.totalWidth-(paneCurrentWidth-paneMinDimensions<=0?0:paneCurrentWidth-paneMinDimensions),this.totalPercent=this.convertPixelToPercentage(this.totalWidth),validatedVal=paneMinDimensions)),isNullOrUndefined(validatedVal)?paneCurrentWidth:validatedVal}validateMaxRange(paneIndex,paneCurrentWidth,pane){let paneMaxDimensions,validatedVal,paneMaxRange=null;return isNullOrUndefined(this.paneSettings[paneIndex])||isNullOrUndefined(this.paneSettings[paneIndex].max)||(paneMaxRange=this.paneSettings[paneIndex].max.toString()),isNullOrUndefined(paneMaxRange)||(paneMaxRange.indexOf("%")>0&&(paneMaxRange=this.convertPercentageToPixel(paneMaxRange).toString()),paneCurrentWidth>(paneMaxDimensions=this.convertPixelToNumber(paneMaxRange))&&(this.totalWidth=this.totalWidth-(paneCurrentWidth-paneMaxDimensions),this.totalPercent=this.convertPixelToPercentage(this.totalWidth),validatedVal=paneMaxDimensions)),isNullOrUndefined(validatedVal)?paneCurrentWidth:validatedVal}validateMinMaxValues(){this.prevPaneCurrentWidth=this.validateMinRange(this.prevPaneIndex,this.prevPaneCurrentWidth,this.previousPane),this.nextPaneCurrentWidth=this.validateMinRange(this.nextPaneIndex,this.nextPaneCurrentWidth,this.nextPane),this.prevPaneCurrentWidth=this.validateMaxRange(this.prevPaneIndex,this.prevPaneCurrentWidth,this.previousPane),this.nextPaneCurrentWidth=this.validateMaxRange(this.nextPaneIndex,this.nextPaneCurrentWidth,this.nextPane)}equatePaneWidths(){let difference;this.prevPaneCurrentWidth+this.nextPaneCurrentWidth>this.totalPercent&&(this.prevPaneCurrentWidth=this.prevPaneCurrentWidth-(difference=this.prevPaneCurrentWidth+this.nextPaneCurrentWidth-this.totalPercent)/2+"%",this.nextPaneCurrentWidth=this.nextPaneCurrentWidth-difference/2+"%"),this.prevPaneCurrentWidth+this.nextPaneCurrentWidth<this.totalPercent&&(this.prevPaneCurrentWidth=this.prevPaneCurrentWidth+(difference=this.totalPercent-(this.prevPaneCurrentWidth+this.nextPaneCurrentWidth))/2+"%",this.nextPaneCurrentWidth=this.nextPaneCurrentWidth+difference/2+"%")}calculateCurrentDimensions(){this.updatePrePaneInPercentage||this.updateNextPaneInPercentage?(this.prevPaneCurrentWidth=Math.round(Number(Math.round(10*this.convertPixelToPercentage(this.prevPaneCurrentWidth))/10)),this.nextPaneCurrentWidth=Math.round(Number(Math.round(10*this.convertPixelToPercentage(this.nextPaneCurrentWidth))/10)),0===this.prevPaneCurrentWidth&&(this.nextPaneCurrentWidth=this.totalPercent),0===this.nextPaneCurrentWidth&&(this.prevPaneCurrentWidth=this.totalPercent),this.prevPaneCurrentWidth+this.nextPaneCurrentWidth!==this.totalPercent?this.equatePaneWidths():(this.prevPaneCurrentWidth=this.prevPaneCurrentWidth+"%",this.nextPaneCurrentWidth=this.nextPaneCurrentWidth+"%"),this.prevPaneCurrentWidth=this.updatePrePaneInPercentage?this.prevPaneCurrentWidth:this.convertPercentageToPixel(this.prevPaneCurrentWidth)+"px",this.nextPaneCurrentWidth=this.updateNextPaneInPercentage?this.nextPaneCurrentWidth:this.convertPercentageToPixel(this.nextPaneCurrentWidth)+"px",this.updatePrePaneInPercentage=!1,this.updateNextPaneInPercentage=!1):(this.prevPaneCurrentWidth=this.prevPaneCurrentWidth+"px",this.nextPaneCurrentWidth=this.nextPaneCurrentWidth+"px")}addStaticPaneClass(){this.previousPane.classList.contains(STATIC_PANE)||this.previousPane.classList.add(STATIC_PANE),this.nextPane.classList.contains(STATIC_PANE)||this.nextPane.classList.add(STATIC_PANE)}validateDraggedPosition(draggedPos,prevPaneHeightWidth,nextPaneHeightWidth){let separatorTopLeft="Horizontal"===this.orientation?this.currentSeparator.offsetLeft:this.currentSeparator.offsetTop,prePaneRange=separatorTopLeft-prevPaneHeightWidth,nextPaneRange=nextPaneHeightWidth+separatorTopLeft,pane1MinSize=this.getMinMax(this.prevPaneIndex,this.previousPane,"min"),pane2MinSize=this.getMinMax(this.nextPaneIndex,this.nextPane,"min"),pane1MaxSize=this.getMinMax(this.prevPaneIndex,this.previousPane,"max"),pane2MaxSize=this.getMinMax(this.nextPaneIndex,this.nextPane,"max"),validatedSize=draggedPos;return draggedPos>nextPaneRange-pane2MinSize?validatedSize=nextPaneRange-pane2MinSize:draggedPos<prePaneRange+pane1MinSize&&(validatedSize=prePaneRange+pane1MinSize),isNullOrUndefined(pane1MaxSize)?isNullOrUndefined(pane2MaxSize)||draggedPos<nextPaneRange-pane2MaxSize&&(validatedSize=nextPaneRange-pane2MaxSize):draggedPos>prePaneRange+pane1MaxSize&&(validatedSize=prePaneRange+pane1MaxSize),validatedSize}onMouseUp(e){removeClass([this.currentSeparator],"e-split-bar-active"),this.unwireResizeEvents();let eventArgs=isBlazor()?{event:e,element:this.element,index:[this.prevPaneIndex,this.nextPaneIndex],separator:this.currentSeparator,paneSize:[this.prePaneDimenson,this.nextPaneDimension]}:{event:e,element:this.element,pane:[this.previousPane,this.nextPane],index:[this.prevPaneIndex,this.nextPaneIndex],separator:this.currentSeparator,paneSize:[this.prePaneDimenson,this.nextPaneDimension]};this.trigger("resizeStop",eventArgs)}panesDimension(index,child){let size,childCount=child.length;parseInt(this.getHeight(this.element),10),isNullOrUndefined(this.paneSettings[index])?setStyleAttribute(child[index],{order:2*index}):isNullOrUndefined(this.paneSettings[index].size)?(this.sizeFlag=!0,setStyleAttribute(child[index],{order:2*index})):index<childCount&&(setStyleAttribute(child[index],{"flex-basis":size=this.paneSettings[index].size,order:2*index}),index<childCount-1&&""!==this.paneSettings[index].size?addClass([child[index]],STATIC_PANE):this.sizeFlag||(child[index].style.flexBasis=null),index===childCount-1&&this.sizeFlag&&""!==this.paneSettings[index].size&&addClass([child[index]],STATIC_PANE)),this.paneOrder.push(2*index)}setTemplate(template,toElement){toElement.innerHTML="",this.templateCompile(toElement,template)}templateCompile(ele,cnt){let blazorContain=Object.keys(window),tempEle=this.createElement("div");this.compileElement(tempEle,cnt,"content"),0!==tempEle.childNodes.length&&([].slice.call(tempEle.childNodes).forEach(childEle=>{ele.appendChild(childEle)}),-1===blazorContain.indexOf("ejsInterop")||this.isStringTemplate||0!==cnt.indexOf("<div>Blazor")||updateBlazorTemplate(this.element.id+"content"+this.allPanes.length.toString(),"ContentTemplate",this.paneSettings[this.allPanes.length-1]))}compileElement(ele,val,prop){let templateFn,templateFUN,blazorContain=Object.keys(window);"string"==typeof val&&(val=val.trim()),templateFn=isNullOrUndefined(val.outerHTML)?compile$$1(val):compile$$1(val.outerHTML),isNullOrUndefined(templateFn)||(templateFUN=-1===blazorContain.indexOf("ejsInterop")||this.isStringTemplate||0!==val.indexOf("<div>Blazor")?templateFn({},this,prop,this.element.id+"content"+this.allPanes.length.toString(),!0):templateFn({},this,prop,this.element.id+"content"+this.allPanes.length.toString(),this.isStringTemplate)),!isNullOrUndefined(templateFn)&&templateFUN.length>0&&[].slice.call(templateFUN).forEach(el=>{ele.appendChild(el)})}paneCollapsible(pane,index){this.paneSettings[index].collapsible?addClass([pane],"e-collapsible"):removeClass([pane],"e-collapsible")}createSplitPane(target){let childCount=target.children.length;for(let i=0;i<this.paneSettings.length;i++)if(childCount<this.paneSettings.length){let childElement=this.createElement("div");this.element.appendChild(childElement),childCount+=1}childCount=target.children.length;let child=[].slice.call(target.children);if(this.sizeFlag=!1,childCount>1)for(let i=0;i<childCount;i++)"DIV"!==child[i].nodeName&&"SPAN"!==child[i].nodeName||(this.allPanes.push(child[i]),"Horizontal"===this.orientation?(addClass([child[i]],[PANE,SPLIT_H_PANE,"e-scrollable"]),this.panesDimension(i,child)):(addClass([child[i]],[PANE,SPLIT_V_PANE,"e-scrollable"]),this.panesDimension(i,child)),isNullOrUndefined(this.paneSettings[i])||isNullOrUndefined(this.paneSettings[i].content)||this.setTemplate(this.paneSettings[i].content,child[i]),isNullOrUndefined(this.paneSettings[i])||this.paneCollapsible(child[i],i))}expand(index){this.collapsedOnchange(index)}collapse(index){this.isCollapsed(index)}destroy(){this.isDestroyed||(super.destroy(),EventHandler.remove(document,"touchstart click",this.onDocumentClick),detach(this.element),this.element=this.wrapper,this.wrapperParent.appendChild(this.wrapper))}addPaneClass(pane){return addClass([pane],"Horizontal"===this.orientation?[PANE,SPLIT_H_PANE,"e-scrollable"]:[PANE,SPLIT_V_PANE,"e-scrollable"]),pane}removePaneOrders(paneClass){let panes=document.querySelectorAll("."+paneClass);for(let i=0;i<panes.length;i++)panes[i].style.removeProperty("order")}setPaneOrder(){for(let i=0;i<this.allPanes.length;i++)this.panesDimension(i,this.allPanes)}removeSeparator(){for(let i=0;i<this.allBars.length;i++)detach(this.allBars[i]);this.allBars=[]}updatePanes(){this.setPaneOrder(),this.removeSeparator(),this.addSeparator(this.element)}addPane(paneProperties,index){let newPane=this.createElement("div");newPane=this.addPaneClass(newPane),index=index>this.allPanes.length+1?this.allPanes.length:index;let paneDetails={size:isNullOrUndefined(paneProperties.size)?"":paneProperties.size,min:isNullOrUndefined(paneProperties.min)?null:paneProperties.min,max:isNullOrUndefined(paneProperties.max)?null:paneProperties.max,content:isNullOrUndefined(paneProperties.content)?"":paneProperties.content,resizable:!!isNullOrUndefined(paneProperties.resizable)||paneProperties.resizable,collapsible:!isNullOrUndefined(paneProperties.collapsible)&&paneProperties.collapsible,collapsed:!isNullOrUndefined(paneProperties.collapsed)&&paneProperties.collapsed};this.paneSettings.splice(index,0,paneDetails),"Horizontal"===this.orientation?(this.element.insertBefore(newPane,this.element.querySelectorAll("."+SPLIT_H_PANE)[index]),this.removePaneOrders(SPLIT_H_PANE)):(this.element.insertBefore(newPane,this.element.querySelectorAll("."+SPLIT_V_PANE)[index]),this.removePaneOrders(SPLIT_V_PANE)),this.allPanes.splice(index,0,newPane),this.updatePanes(),this.setTemplate(this.paneSettings[index].content,newPane),this.allPanes[this.allPanes.length-1].classList.remove(STATIC_PANE)}removePane(index){index=index>this.allPanes.length+1?this.allPanes.length:index;let elementClass="Horizontal"===this.orientation?SPLIT_H_PANE:SPLIT_V_PANE;isNullOrUndefined(this.element.querySelectorAll("."+elementClass)[index])||(detach(this.element.querySelectorAll("."+elementClass)[index]),this.allPanes.splice(index,1),this.removePaneOrders(elementClass),this.updatePanes(),this.allPanes[this.allPanes.length-1].classList.remove(STATIC_PANE))}};return __decorate([Property("100%")],Splitter.prototype,"height",void 0),__decorate([Property("100%")],Splitter.prototype,"width",void 0),__decorate([Collection([],ej2_layouts_es2015_PaneProperties)],Splitter.prototype,"paneSettings",void 0),__decorate([Property("Horizontal")],Splitter.prototype,"orientation",void 0),__decorate([Property("")],Splitter.prototype,"cssClass",void 0),__decorate([Property(!0)],Splitter.prototype,"enabled",void 0),__decorate([Property(null)],Splitter.prototype,"separatorSize",void 0),__decorate([ej2_base_es2015_Event()],Splitter.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],Splitter.prototype,"resizeStart",void 0),__decorate([ej2_base_es2015_Event()],Splitter.prototype,"resizing",void 0),__decorate([ej2_base_es2015_Event()],Splitter.prototype,"resizeStop",void 0),__decorate([ej2_base_es2015_Event()],Splitter.prototype,"beforeCollapse",void 0),__decorate([ej2_base_es2015_Event()],Splitter.prototype,"beforeExpand",void 0),__decorate([ej2_base_es2015_Event()],Splitter.prototype,"collapsed",void 0),__decorate([ej2_base_es2015_Event()],Splitter.prototype,"expanded",void 0),__decorate([NotifyPropertyChanges],Splitter)})();const ej2_richtexteditor_es2015_initialLoad="initial-load",ej2_richtexteditor_es2015_initialEnd="initial-end",iframeMouseDown="iframe-click",ej2_richtexteditor_es2015_destroy="destroy",ej2_richtexteditor_es2015_toolbarClick="toolbarClick",ej2_richtexteditor_es2015_toolbarRefresh="toolbar-refresh",refreshBegin="refresh-begin",toolbarUpdated="toolbar-updated",bindOnEnd="bind-on-end",renderColorPicker="render-color-picker",htmlToolbarClick="html-toolbar-click",markdownToolbarClick="markdown-toolbar-click",destroyColorPicker="destroy-color-picker",ej2_richtexteditor_es2015_modelChanged="model-changed",keyUp="keyUp",keyDown="keyDown",ej2_richtexteditor_es2015_mouseUp="mouseUp",toolbarCreated="toolbarCreated",toolbarRenderComplete="toolbarRenderComplete",enableFullScreen="enableFullScreen",disableFullScreen="disableFullScreen",dropDownSelect="dropDownSelect",beforeDropDownItemRender="beforeDropDownItemRender",execCommandCallBack="execCommandCallBack",imageToolbarAction="image-toolbar-action",linkToolbarAction="link-toolbar-action",insertLink="insertLink",unLink="unLink",editLink="editLink",openLink="openLink",ej2_richtexteditor_es2015_actionBegin="actionBegin",ej2_richtexteditor_es2015_actionComplete="actionComplete",toolbarStatusUpdate="toolbarStatusUpdate",updateToolbarItem="updateToolbarItem",insertImage="insertImage",insertCompleted="insertCompleted",sourceCode="sourceCode",updateSource="updateSource",beforeDropDownOpen="beforeDropDownOpen",selectionSave="selection-save",selectionRestore="selection-restore",expandPopupClick="expandPopupClick",ej2_richtexteditor_es2015_count="count",ej2_richtexteditor_es2015_mouseDown="mouseDown",sourceCodeMouseDown="sourceCodeMouseDown",editAreaClick="editAreaClick",ej2_richtexteditor_es2015_scroll="scroll",colorPickerChanged="colorPickerChanged",tableColorPickerChanged="tableColorPickerChanged",focusChange="focusChange",selectAll$1="selectAll",selectRange="selectRange",getSelectedHtml="getSelectedHtml",renderInlineToolbar="renderInlineToolbar",ej2_richtexteditor_es2015_paste="paste-content",rtlMode="rtl-mode",createTable="createTable",tableToolbarAction="table-toolbar-action",checkUndo="checkUndoStack",readOnlyMode="readOnlyMode",beforeDialogOpen="beforeDialogOpen",dialogOpen="dialogOpen",dialogClose="dialogClose",beforeQuickToolbarOpen="beforeQuickToolbarOpen",quickToolbarOpen="quickToolbarOpen",quickToolbarClose="quickToolbarClose",CLS_TOOLBAR="e-rte-toolbar",CLS_TB_FIXED="e-rte-tb-fixed",CLS_TB_FLOAT="e-rte-tb-float",CLS_TB_ABS_FLOAT="e-rte-tb-abs-float",CLS_INLINE="e-rte-inline",CLS_RTE_EXPAND_TB="e-rte-tb-expand",CLS_FULL_SCREEN="e-rte-full-screen",CLS_QUICK_TB="e-rte-quick-toolbar",CLS_POP="e-rte-pop",CLS_QUICK_POP="e-rte-quick-popup",CLS_QUICK_DROPDOWN="e-quick-dropdown",CLS_IMAGE_POP="e-rte-image-popup",CLS_INLINE_POP="e-rte-inline-popup",CLS_INLINE_DROPDOWN="e-rte-inline-dropdown",CLS_DROPDOWN_POPUP="e-rte-dropdown-popup",CLS_DROPDOWN_ICONS="e-rte-dropdown-icons",CLS_DROPDOWN_ITEMS="e-rte-dropdown-items",CLS_DROPDOWN_BTN="e-rte-dropdown-btn",CLS_RTE_CONTENT="e-rte-content",ej2_richtexteditor_es2015_CLS_TB_ITEM="e-toolbar-item",CLS_TB_WRAP="e-toolbar-wrapper",CLS_SHOW="e-show",CLS_HIDE="e-hide",CLS_VISIBLE="e-visible",CLS_RM_WHITE_SPACE="e-remove-white-space",CLS_COUNT="e-rte-character-count",CLS_WARNING="e-warning",CLS_ERROR="e-error",ej2_richtexteditor_es2015_CLS_ICONS="e-icons",ej2_richtexteditor_es2015_CLS_ACTIVE="e-active",CLS_EXPAND_OPEN="e-expand-open",CLS_RTE_ELEMENTS="e-rte-elements",CLS_TB_BTN="e-tbar-btn",CLS_HR_SEPARATOR="e-rte-horizontal-separator",CLS_TB_IOS_FIX="e-tbar-ios-fixed",CLS_TB_STATIC="e-tb-static",CLS_FORMATS_TB_BTN="e-formats-tbar-btn",CLS_FONT_NAME_TB_BTN="e-font-name-tbar-btn",CLS_FONT_SIZE_TB_BTN="e-font-size-tbar-btn",CLS_FONT_COLOR_TARGET="e-rte-fontcolor-element",CLS_BACKGROUND_COLOR_TARGET="e-rte-backgroundcolor-element",CLS_COLOR_CONTENT="e-rte-color-content",CLS_FONT_COLOR_DROPDOWN="e-rte-fontcolor-dropdown",CLS_BACKGROUND_COLOR_DROPDOWN="e-rte-backgroundcolor-dropdown",CLS_COLOR_PALETTE="e-rte-square-palette",CLS_FONT_COLOR_PICKER="e-rte-fontcolor-colorpicker",CLS_BACKGROUND_COLOR_PICKER="e-rte-backgroundcolor-colorpicker",CLS_RTE_READONLY="e-rte-readonly";var ej2_richtexteditor_es2015_RenderType=function(RenderType){return RenderType[RenderType.Toolbar=0]="Toolbar",RenderType[RenderType.Content=1]="Content",RenderType[RenderType.Popup=2]="Popup",RenderType[RenderType.LinkToolbar=3]="LinkToolbar",RenderType[RenderType.TextToolbar=4]="TextToolbar",RenderType[RenderType.ImageToolbar=5]="ImageToolbar",RenderType[RenderType.InlineToolbar=6]="InlineToolbar",RenderType[RenderType.TableToolbar=7]="TableToolbar",RenderType}({}),ToolbarType=function(ToolbarType){return ToolbarType.Expand="Expand",ToolbarType.MultiRow="MultiRow",ToolbarType}({});let templateItems=["alignments","formats","fontname","fontsize","fontcolor","backgroundcolor","align","display","tablerows","tablecolumns","tablecellhorizontalalign","tablecellverticalalign","styles"],tools={alignments:{id:"Alignments",icon:"e-alignments",tooltip:"Alignments",command:"Alignments",subCommand:"Alignments"},justifyleft:{id:"JustifyLeft",icon:"e-justify-left",tooltip:"JustifyLeft",command:"Alignments",subCommand:"JustifyLeft"},justifycenter:{id:"JustifyCenter",icon:"e-justify-center",tooltip:"JustifyCenter",command:"Alignments",subCommand:"JustifyCenter"},justifyright:{id:"JustifyRight",icon:"e-justify-right",tooltip:"JustifyRight",command:"Alignments",subCommand:"JustifyRight"},justifyfull:{id:"JustifyFull",icon:"e-justify-full",tooltip:"JustifyFull",command:"Alignments",subCommand:"JustifyFull"},fontname:{id:"FontName",icon:"e-font-name",tooltip:"Font Name",command:"Font",subCommand:"FontName"},fontsize:{id:"FontSize",icon:"e-font-size",tooltip:"Font Size",command:"Font",subCommand:"FontSize"},fontcolor:{id:"FontColor",icon:"e-font-color",tooltip:"Font Color",command:"Font",subCommand:"FontColor",value:"#ff0000ff"},backgroundcolor:{id:"BackgroundColor",icon:"e-background-color",tooltip:"Background Color",command:"Font",subCommand:"BackgroundColor",value:"#ffff00ff"},bold:{id:"Bold",icon:"e-bold",tooltip:"Bold",command:"Style",subCommand:"Bold"},italic:{id:"Italic",icon:"e-italic",tooltip:"Italic",command:"Style",subCommand:"Italic"},underline:{id:"Underline",icon:"e-underline",tooltip:"Underline",command:"Style",subCommand:"Underline"},strikethrough:{id:"StrikeThrough",icon:"e-strike-through",tooltip:"StrikeThrough",command:"Style",subCommand:"StrikeThrough"},clearformat:{id:"ClearFormat",icon:"e-clear-format",tooltip:"Clear Format",command:"Clear",subCommand:"ClearFormat"},clearall:{id:"ClearAll",icon:"e-clear-all",tooltip:"Clear All",command:"Clear",subCommand:"ClearAll"},cut:{id:"Cut",icon:"e-cut",tooltip:"Cut",command:"ClipBoard",subCommand:"Cut"},copy:{id:"Copy",icon:"e-copy",tooltip:"Copy",command:"ClipBoard",subCommand:"Copy"},paste:{id:"Paste",icon:"e-paste",tooltip:"Paste",command:"ClipBoard",subCommand:"Paste"},unorderedlist:{id:"UnorderedList",icon:"e-unorder-list",tooltip:"Bulleted List",command:"Lists",subCommand:"UL"},orderedlist:{id:"OrderedList",icon:"e-order-list",tooltip:"Numbered List",command:"Lists",subCommand:"OL"},indent:{id:"Indent",icon:"e-indent",tooltip:"Increase Indent",command:"Indents",subCommand:"Indent"},outdent:{id:"Outdent",icon:"e-outdent",tooltip:"Decrease Indent",command:"Indents",subCommand:"Outdent"},undo:{id:"Undo",icon:"e-undo",tooltip:"Undo",command:"Actions",subCommand:"Undo"},redo:{id:"Redo",icon:"e-redo",tooltip:"Redo",command:"Actions",subCommand:"Redo"},superscript:{id:"SuperScript",icon:"e-super-script",tooltip:"Superscript",command:"Effects",subCommand:"SuperScript"},subscript:{id:"SubScript",icon:"e-sub-script",tooltip:"Subscript",command:"Effects",subCommand:"SubScript"},createlink:{id:"CreateLink",icon:"e-create-link",tooltip:"Insert Hyperlink",command:"Links",subCommand:"CreateLink"},openlink:{id:"OpenLink",icon:"e-open-link",tooltip:"Open Link",command:"Links",subCommand:"OpenLink"},editlink:{id:"EditLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Links",subCommand:"EditLink"},removelink:{id:"RemoveLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Links",subCommand:"RemoveLink"},image:{id:"Image",icon:"e-image",tooltip:"Insert Image",command:"Images",subCommand:"Image"},createtable:{id:"CreateTable",icon:"e-create-table",tooltip:"Create Table",command:"Table",subCommand:"CreateTable"},removetable:{id:"removeTable",icon:"e-remove-table",tooltip:"Remove Table",command:"removeTable",subCommand:"removeTable"},replace:{id:"Replace",icon:"e-replace",tooltip:"Replace",command:"Images",subCommand:"Replace"},align:{id:"Align",icon:"e-align",tooltip:"Align",command:"Images",subCommand:"Align"},caption:{id:"Caption",icon:"e-caption",tooltip:"Image Caption",command:"Images",subCommand:"Caption"},remove:{id:"Remove",icon:"e-remove",tooltip:"Remove",command:"Images",subCommand:"Remove"},openimagelink:{id:"OpenImageLink",icon:"e-open-link",tooltip:"Open Link",command:"Images",subCommand:"OpenImageLink"},editimagelink:{id:"EditImageLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Images",subCommand:"EditImageLink"},removeimagelink:{id:"RemoveImageLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Images",subCommand:"RemoveImageLink"},insertlink:{id:"InsertLink",icon:"e-insert-link",tooltip:"Insert Link",command:"Images",subCommand:"InsertLink"},display:{id:"Display",icon:"e-display",tooltip:"Display",command:"Images",subCommand:"Display"},alttext:{id:"AltText",icon:"e-alt-text",tooltip:"Alternative Text",command:"Images",subCommand:"AltText"},dimension:{id:"Dimension",icon:"e-dimension",tooltip:"Change Size",command:"Images",subCommand:"Dimension"},fullscreen:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"View",subCommand:"Maximize"},maximize:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"FullScreen",subCommand:"Maximize"},minimize:{id:"Minimize",icon:"e-minimize",tooltip:"Minimize",command:"FullScreen",subCommand:"Minimize"},lowercase:{id:"LowerCase",icon:"e-lower-case",tooltip:"Lower Case",command:"Casing",subCommand:"LowerCase"},uppercase:{id:"UpperCase",icon:"e-upper-case",tooltip:"Upper Case",command:"Casing",subCommand:"UpperCase"},print:{id:"Print",icon:"e-print",tooltip:"Print",command:"Print",subCommand:"Print"},formats:{id:"Formats",icon:"e-formats",tooltip:"Formats",command:"Formats",subCommand:"Formats"},sourcecode:{id:"SourceCode",icon:"e-source-code",tooltip:"Source Code",command:"SourceCode",subCommand:"SourceCode"},preview:{id:"Preview",icon:"e-preview",tooltip:"Preview",command:"Preview",subCommand:"Preview"},viewside:{id:"ViewSide",icon:"e-view-side",tooltip:"ViewSide",command:"ViewSide",subCommand:"ViewSide"},insertcode:{id:"InsertCode",icon:"e-insert-code",tooltip:"Insert Code",command:"InsertCode",subCommand:"InsertCode"},tableheader:{id:"TableHeader",icon:"e-table-header",tooltip:"Table Header",command:"Table",subCommand:"TableHeader"},tableremove:{id:"TableRemove",icon:"e-table-remove",tooltip:"Table Remove",command:"Table",subCommand:"TableRemove"},tablerows:{id:"TableRows",icon:"e-table-rows",tooltip:"Table Rows",command:"Table",subCommand:"TableRows"},tablecolumns:{id:"TableColumns",icon:"e-table-columns",tooltip:"Table Columns",command:"Table",subCommand:"TableColumns"},tablecellbackground:{id:"TableCellBackground",icon:"e-table-cell-background",tooltip:"Table Cell Background",command:"Table",subCommand:"TableCellBackground"},tablecellhorizontalalign:{id:"TableCellHorizontalAlign",icon:"e-table-cell-horizontalAlign",tooltip:"Table Cell HorizontalAlign",command:"Table",subCommand:"TableCellHorizontalAlign"},tablecellverticalalign:{id:"TableCellVerticalAlign",icon:"e-table-cell-verticalAlign",tooltip:"Table Cell VerticalAlign",command:"Table",subCommand:"TableCellVerticalAlign"},tableeditproperties:{id:"TableEditProperties",icon:"e-table-edit-properties",tooltip:"Table Edit Properties",command:"Table",subCommand:"TableEditProperties"},styles:{id:"Styles",icon:"e-table-styles",tooltip:"Styles",command:"Table",subCommand:"Styles"}},alignmentLocale=[{locale:"alignmentsDropDownLeft",value:"JustifyLeft"},{locale:"alignmentsDropDownCenter",value:"JustifyCenter"},{locale:"alignmentsDropDownRight",value:"JustifyRight"},{locale:"alignmentsDropDownJustify",value:"JustifyFull"}],alignmentItems=[{iconCss:"e-icons e-justify-left",text:"Align Left",command:"Alignments",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",text:"Align Center",command:"Alignments",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",text:"Align Right",command:"Alignments",subCommand:"JustifyRight"},{iconCss:"e-icons e-justify-full",text:"Align Justify",command:"Alignments",subCommand:"JustifyFull"}],imageAlignItems=[{iconCss:"e-icons e-justify-left",command:"Images",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Images",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Images",subCommand:"JustifyRight"}],displayLocale=[{locale:"imageDisplayDropDownInline",value:"Inline"},{locale:"imageDisplayDropDownBreak",value:"Break"}],imageDisplayItems=[{text:"Inline",cssClass:"e-inline",command:"Images",subCommand:"Inline"},{text:"Break",cssClass:"e-break",command:"Images",subCommand:"Break"}],tableRowLocale=[{locale:"tableInsertRowDropDownBefore",value:"InsertRowBefore"},{locale:"tableInsertRowDropDownAfter",value:"InsertRowAfter"},{locale:"tableInsertRowDropDownDelete",value:"DeleteRow"}],tableRowsItems=[{iconCss:"e-icons e-insert-row-before",text:"Insert row before",command:"Table",subCommand:"InsertRowBefore"},{iconCss:"e-icons e-insert-row-after",text:"Insert row after",command:"Table",subCommand:"InsertRowAfter"},{iconCss:"e-icons e-delete-row",text:"Delete row",command:"Table",subCommand:"DeleteRow"}],tableColumnLocale=[{locale:"tableInsertColumnDropDownLeft",value:"InsertColumnLeft"},{locale:"tableInsertColumnDropDownRight",value:"InsertColumnRight"},{locale:"tableInsertColumnDropDownDelete",value:"DeleteColumn"}],tableColumnsItems=[{iconCss:"e-icons e-insert-column-left",text:"Insert column left",command:"Table",subCommand:"InsertColumnLeft"},{iconCss:"e-icons e-insert-column-right",text:"Insert column right",command:"Table",subCommand:"InsertColumnRight"},{iconCss:"e-icons e-delete-column",text:"Delete column",command:"Table",subCommand:"DeleteColumn"}],tableVerticalLocale=[{locale:"tableVerticalAlignDropDownTop",value:"AlignTop"},{locale:"tableVerticalAlignDropDownMiddle",value:"AlignMiddle"},{locale:"tableVerticalAlignDropDownBottom",value:"AlignBottom"}],TableCellVerticalAlignItems=[{iconCss:"e-icons e-align-top",text:"Align Top",command:"Table",subCommand:"AlignTop"},{iconCss:"e-icons e-align-middle",text:"Align Middle",command:"Table",subCommand:"AlignMiddle"},{iconCss:"e-icons e-align-bottom",text:"Align Bottom",command:"Table",subCommand:"AlignBottom"}],tableStyleLocale=[{locale:"tableStylesDropDownDashedBorder",value:"Dashed"},{locale:"tableStylesDropDownAlternateRows",value:"Alternate"}],TableStyleItems=[{text:"Dashed Borders",cssClass:"e-dashed-borders",command:"Table",subCommand:"Dashed"},{text:"Alternate Rows",cssClass:"e-alternate-rows",command:"Table",subCommand:"Alternate"}];function getLocale(self,localeItems,item){for(let i=0;localeItems.length>i;i++)if(localeItems[i].value===item.subCommand)return self.localeObj.getConstant(localeItems[i].locale);return item.text}let defaultLocale={alignments:"Alignments",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",fontName:"Font Name",fontSize:"Font Size",fontColor:"Font Color",backgroundColor:"Background Color",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",clearFormat:"Clear Format",clearAll:"Clear All",cut:"Cut",copy:"Copy",paste:"Paste",unorderedList:"Bulleted List",orderedList:"Numbered List",indent:"Increase Indent",outdent:"Decrease Indent",undo:"Undo",redo:"Redo",superscript:"Superscript",subscript:"Subscript",createLink:"Insert Hyperlink",openLink:"Open Link",editLink:"Edit Link",removeLink:"Remove Link",image:"Insert Image",replace:"Replace",align:"Align",caption:"Image Caption",remove:"Remove",insertLink:"Insert Link",display:"Display",altText:"Alternative Text",dimension:"Change Size",fullscreen:"Maximize",maximize:"Maximize",minimize:"Minimize",lowerCase:"Lower Case",upperCase:"Upper Case",print:"Print",formats:"Formats",sourcecode:"Code View",preview:"Preview",viewside:"ViewSide",insertCode:"Insert Code",linkText:"Display Text",linkTooltipLabel:"Title",linkWebUrl:"Web Address",linkTitle:"Enter a title",linkurl:"http://example.com",linkOpenInNewWindow:"Open Link in New Window",linkHeader:"Insert Link",dialogInsert:"Insert",dialogCancel:"Cancel",dialogUpdate:"Update",imageHeader:"Insert Image",imageLinkHeader:"You can also provide a link from the web",mdimageLink:"Please provide a URL for your image",imageUploadMessage:"Drop image here or browse to upload",imageDeviceUploadMessage:"Click here to upload",imageAlternateText:"Alternate Text",alternateHeader:"Alternative Text",browse:"Browse",imageUrl:"http://example.com/image.png",imageCaption:"Caption",imageSizeHeader:"Image Size",imageHeight:"Height",imageWidth:"Width",textPlaceholder:"Enter Text",inserttablebtn:"Insert Table",tabledialogHeader:"Insert Table",tableWidth:"Width",cellpadding:"Cell Padding",cellspacing:"Cell Spacing",columns:"Number of columns",rows:"Number of rows",tableRows:"Table Rows",tableColumns:"Table Columns",tableCellHorizontalAlign:"Table Cell Horizontal Align",tableCellVerticalAlign:"Table Cell Vertical Align",createTable:"Create Table",removeTable:"Remove Table",tableHeader:"Table Header",tableRemove:"Table Remove",tableCellBackground:"Table Cell Background",tableEditProperties:"Table Edit Properties",styles:"Styles",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",insertRowBefore:"Insert Row Before",insertRowAfter:"Insert Row After",deleteRow:"Delete Row",tableEditHeader:"Edit Table",TableHeadingText:"Heading",TableColText:"Col",imageInsertLinkHeader:"Insert Link",editImageHeader:"Edit Image",alignmentsDropDownLeft:"Align Left",alignmentsDropDownCenter:"Align Center",alignmentsDropDownRight:"Align Right",alignmentsDropDownJustify:"Align Justify",imageDisplayDropDownInline:"Inline",imageDisplayDropDownBreak:"Break",tableInsertRowDropDownBefore:"Insert row before",tableInsertRowDropDownAfter:"Insert row after",tableInsertRowDropDownDelete:"Delete row",tableInsertColumnDropDownLeft:"Insert column left",tableInsertColumnDropDownRight:"Insert column right",tableInsertColumnDropDownDelete:"Delete column",tableVerticalAlignDropDownTop:"Align Top",tableVerticalAlignDropDownMiddle:"Align Middle",tableVerticalAlignDropDownBottom:"Align Bottom",tableStylesDropDownDashedBorder:"Dashed Borders",tableStylesDropDownAlternateRows:"Alternate Rows",pasteFormat:"Paste Format",pasteFormatContent:"Choose the formatting action",plainText:"Plain Text",cleanFormat:"Clean",keepFormat:"Keep",pasteDialogOk:"OK",pasteDialogCancel:"Cancel"},toolsLocale={alignments:"alignments",justifyleft:"justifyLeft",justifycenter:"justifyCenter",justifyright:"justifyRight",justifyfull:"justifyFull",fontname:"fontName",fontsize:"fontSize",fontcolor:"fontColor",backgroundcolor:"backgroundColor",bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",clearformat:"clearFormat",clearall:"clearAll",cut:"cut",copy:"copy",paste:"paste",unorderedlist:"unorderedList",orderedlist:"orderedList",indent:"indent",outdent:"outdent",undo:"undo",redo:"redo",superscript:"superscript",subscript:"subscript",createlink:"createLink",openlink:"openLink",editlink:"editLink",removelink:"removeLink",openimagelink:"openLink",editimagelink:"editLink",removeimagelink:"removeLink",image:"image",replace:"replace",align:"align",caption:"caption",remove:"remove",insertlink:"insertLink",display:"display",alttext:"altText",dimension:"dimension",fullscreen:"fullscreen",maximize:"maximize",minimize:"minimize",lowercase:"lowerCase",uppercase:"upperCase",print:"print",formats:"formats",sourcecode:"sourcecode",preview:"preview",viewside:"viewside",insertcode:"insertCode",tablerows:"tableRows",tablecolumns:"tableColumns",tablecellhorizontalalign:"tableCellHorizontalAlign",tablecellverticalalign:"tableCellVerticalAlign",createtable:"createTable",removetable:"removeTable",tableheader:"tableHeader",tableremove:"tableRemove",tablecellbackground:"tableCellBackground",tableeditproperties:"tableEditProperties",styles:"styles",insertcolumnleft:"insertColumnLeft",insertcolumnright:"insertColumnRight",deletecolumn:"deleteColumn",aligntop:"AlignTop",alignmiddle:"AlignMiddle",alignbottom:"AlignBottom",insertrowbefore:"insertRowBefore",insertrowafter:"insertRowAfter",deleterow:"deleteRow"},undoRedoItems=["Undo","Redo"];function getIndex(val,items){let index=-1;return items.some((item,i)=>"string"==typeof item&&val===item.toLocaleLowerCase()&&(index=i,!0)),index}function hasClass(element,className){let hasClass=!1;return element.classList.contains(className)&&(hasClass=!0),hasClass}function getDropDownValue(items,value,type,returnType){let data,result;for(let k=0;k<items.length;k++){if("value"===type&&items[k].value.toLocaleLowerCase()===value.toLocaleLowerCase()){data=items[k];break}if("text"===type&&items[k].text.toLocaleLowerCase()===value.toLocaleLowerCase()){data=items[k];break}if("subCommand"===type&&items[k].subCommand.toLocaleLowerCase()===value.toLocaleLowerCase()){data=items[k];break}}if(!isNullOrUndefined(data))switch(returnType){case"text":result=data.text;break;case"value":result=data.value;break;case"iconCss":result=data.iconCss}return result}function isIDevice(){let result=!1;return Browser.isDevice&&Browser.isIos&&(result=!0),result}function getFormattedFontSize(value){return isNullOrUndefined(value)?"":value}function getTooltipText(item,serviceLocator){return serviceLocator.getService("rteLocale").getConstant(toolsLocale[item])}function setToolbarStatus(e,isPopToolbar){let dropDown=e.dropDownModule,data=e.args,keys=Object.keys(e.args);for(let key of keys)for(let j=0;j<e.tbItems.length;j++){let item=e.tbItems[j].subCommand,itemStr=item&&item.toLocaleLowerCase();if(item&&itemStr===key||"UL"===item&&"unorderedlist"===key||"OL"===item&&"orderedlist"===key)if("boolean"==typeof data[key])!0===data[key]?addClass([e.tbElements[j]],[ej2_richtexteditor_es2015_CLS_ACTIVE]):removeClass([e.tbElements[j]],[ej2_richtexteditor_es2015_CLS_ACTIVE]);else if(("string"==typeof data[key]||null===data[key])&&getIndex(key,e.parent.toolbarSettings.items)>-1){let value=data[key]?data[key]:"",result="";switch(key){case"formats":if(isNullOrUndefined(dropDown.formatDropDown)||isPopToolbar||!isNullOrUndefined(dropDown.formatDropDown)&&dropDown.formatDropDown.isDestroyed)return;let formatItems=e.parent.format.types;result=getDropDownValue(formatItems,value,"subCommand","text");let formatContent=isNullOrUndefined(e.parent.format.default)?formatItems[0].text:e.parent.format.default;dropDown.formatDropDown.content='<span style="display: inline-flex;width:'+e.parent.format.width+'" ><span class="e-rte-dropdown-btn-text">'+(isNullOrUndefined(result)?formatContent:result)+"</span></span>",dropDown.formatDropDown.dataBind();break;case"alignments":if(isNullOrUndefined(dropDown.alignDropDown)||!isNullOrUndefined(dropDown.alignDropDown)&&dropDown.alignDropDown.isDestroyed)return;result=getDropDownValue(alignmentItems,value,"subCommand","iconCss"),dropDown.alignDropDown.iconCss=isNullOrUndefined(result)?"e-icons e-justify-left":result,dropDown.alignDropDown.dataBind();break;case"fontname":if(isNullOrUndefined(dropDown.fontNameDropDown)||isPopToolbar||!isNullOrUndefined(dropDown.fontNameDropDown)&&dropDown.fontNameDropDown.isDestroyed)return;let fontNameItems=e.parent.fontFamily.items;result=getDropDownValue(fontNameItems,value,"value","text");let fontNameContent=isNullOrUndefined(e.parent.fontFamily.default)?fontNameItems[0].text:e.parent.fontFamily.default,name=isNullOrUndefined(result)?fontNameContent:result;e.tbElements[j].title=name,dropDown.fontNameDropDown.content='<span style="display: inline-flex;width:'+e.parent.fontFamily.width+'" ><span class="e-rte-dropdown-btn-text">'+name+"</span></span>",dropDown.fontNameDropDown.dataBind();break;case"fontsize":if(isNullOrUndefined(dropDown.fontSizeDropDown)||!isNullOrUndefined(dropDown.fontSizeDropDown)&&dropDown.fontSizeDropDown.isDestroyed)return;let fontSizeItems=e.parent.fontSize.items,fontSizeContent=isNullOrUndefined(e.parent.fontSize.default)?fontSizeItems[1].text:e.parent.fontSize.default;result=getDropDownValue(fontSizeItems,""===value?fontSizeContent.replace(/\s/g,""):value,"value","text"),dropDown.fontSizeDropDown.content='<span style="display: inline-flex;width:'+e.parent.fontSize.width+'" ><span class="e-rte-dropdown-btn-text">'+getFormattedFontSize(result)+"</span></span>",dropDown.fontSizeDropDown.dataBind()}}}}function getCollection(items){return"object"==typeof items?items:[items]}function getTBarItemsIndex(items,toolbarItems){let itemsIndex=[];for(let i=0;i<items.length;i++)for(let j=0;j<toolbarItems.length;j++)if("Separator"!==toolbarItems[j].type){if("OrderedList"===items[i]&&"OL"===toolbarItems[j].subCommand){itemsIndex.push(j);break}if("UnorderedList"===items[i]&&"UL"===toolbarItems[j].subCommand){itemsIndex.push(j);break}if(items[i]===toolbarItems[j].subCommand){itemsIndex.push(j);break}}return itemsIndex}function updateUndoRedoStatus(baseToolbar,undoRedoStatus){let i=0,trgItems=getTBarItemsIndex(getCollection(undoRedoItems),baseToolbar.toolbarObj.items),tbItems=ej2_base_es2015_selectAll("."+ej2_richtexteditor_es2015_CLS_TB_ITEM,baseToolbar.toolbarObj.element),keys=Object.keys(undoRedoStatus);for(let key of keys){let target=tbItems[trgItems[i]];target&&baseToolbar.toolbarObj.enableItems(target,undoRedoStatus[key]),i++}}function ej2_richtexteditor_es2015_dispatchEvent(element,type){let evt=document.createEvent("HTMLEvents");evt.initEvent(type,!1,!0),element.dispatchEvent(evt)}function toObjectLowerCase(obj){let convertedValue={},keys=Object.keys(obj);for(let i=0;i<Object.keys(obj).length;i++)convertedValue[keys[i].toLocaleLowerCase()]=obj[keys[i]];return convertedValue}function getEditValue(value,rteObj){let val;return null!==value&&""!==value?(val=function(value){let tempNode=document.createElement("div");tempNode.innerHTML=value;let childNodes=tempNode.childNodes;return childNodes.length>0&&[].slice.call(childNodes).forEach(childNode=>{if(childNode.nodeType===Node.TEXT_NODE&&childNode.parentNode===tempNode&&""!==childNode.textContent.trim()){let defaultTag=document.createElement("p");childNode.parentNode.insertBefore(defaultTag,childNode),defaultTag.appendChild(childNode)}}),tempNode.innerHTML}(rteObj.enableHtmlEncode?ej2_richtexteditor_es2015_decode(value):value),rteObj.setProperties({value:val},!0)):val=rteObj.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/></p>",val}function isEditableValueEmpty(value){return"<p><br></p>"===value||"&lt;p&gt;&lt;br&gt;&lt;/p&gt;"===value||""===value}function ej2_richtexteditor_es2015_decode(value){return value.replace(/&amp;/g,"&").replace(/&amp;lt;/g,"<").replace(/&lt;/g,"<").replace(/&amp;gt;/g,">").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;nbsp;/g," ").replace(/&quot;/g,"")}class ej2_richtexteditor_es2015_ToolbarRenderer{constructor(parent){this.parent=parent,this.wireEvent()}wireEvent(){this.parent.on(ej2_richtexteditor_es2015_destroy,this.unWireEvent,this)}unWireEvent(){this.parent.off(ej2_richtexteditor_es2015_destroy,this.unWireEvent),this.popupOverlay&&EventHandler.remove(this.popupOverlay,"click touchmove",this.onPopupOverlay)}toolbarBeforeCreate(e){"Extended"===this.mode&&(e.enableCollision=!1)}toolbarCreated(){this.parent.notify(toolbarCreated,this)}toolbarClicked(args){!this.parent.readonly&&this.parent.enabled&&(this.parent.notify(ej2_richtexteditor_es2015_toolbarClick,args),this.parent.trigger("toolbarClick",args))}dropDownSelected(args){this.parent.notify(dropDownSelect,args),this.onPopupOverlay()}beforeDropDownItemRender(args){!this.parent.readonly&&this.parent.enabled&&this.parent.notify(beforeDropDownItemRender,args)}dropDownOpen(args){Browser.isDevice&&!args.element.parentElement.classList.contains(CLS_QUICK_DROPDOWN)&&this.popupModal(args.element.parentElement),this.parent.notify(selectionSave,args)}dropDownClose(args){this.parent.notify(selectionRestore,args)}renderToolbar(args){this.setPanel(args.target),this.renderPanel(),this.mode=args.overflowMode,args.rteToolbarObj.toolbarObj=new ej2_navigations_es2015_Toolbar({items:args.items,width:"100%",overflowMode:args.overflowMode,beforeCreate:this.toolbarBeforeCreate.bind(this),created:this.toolbarCreated.bind(this),clicked:this.toolbarClicked.bind(this),enablePersistence:args.enablePersistence,enableRtl:args.enableRtl}),args.rteToolbarObj.toolbarObj.isStringTemplate=!0,args.rteToolbarObj.toolbarObj.createElement=this.parent.createElement,args.rteToolbarObj.toolbarObj.appendTo(args.target)}renderDropDownButton(args){let css;args.element.classList.add(CLS_DROPDOWN_BTN),css=args.cssClass+" "+CLS_RTE_ELEMENTS+" "+CLS_TB_BTN,this.parent.inlineMode.enable&&Browser.isDevice&&(css=css+" "+CLS_INLINE_DROPDOWN);let proxy=this,dropDown=new ej2_splitbuttons_es2015_DropDownButton({items:args.items,iconCss:args.iconCss,cssClass:css,content:args.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:args=>{if(!proxy.parent.readonly&&proxy.parent.enabled){for(let index=0;index<args.element.childNodes.length;index++){let divNode=this.parent.createElement("div");divNode.innerHTML=dropDown.content.trim(),""!==divNode.textContent.trim()&&args.element.childNodes[index].textContent.trim()===divNode.textContent.trim()?args.element.childNodes[index].classList.contains("e-active")||addClass([args.element.childNodes[index]],"e-active"):removeClass([args.element.childNodes[index]],"e-active")}proxy.parent.notify(beforeDropDownOpen,args)}else args.cancel=!0},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});return dropDown.isStringTemplate=!0,dropDown.createElement=proxy.parent.createElement,dropDown.appendTo(args.element),args.element.tabIndex=-1,document.getElementById(dropDown.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),dropDown}onPopupOverlay(args){isNullOrUndefined(this.popupOverlay)||(closest(this.popupOverlay,".e-popup-container").style.display="none",this.popupOverlay.style.display="none",removeClass([this.popupOverlay],"e-popup-overlay"))}setIsModel(element){if(closest(element,".e-popup-container"))element.parentElement.style.display="flex",this.popupOverlay=element.nextElementSibling,this.popupOverlay.style.display="block",addClass([this.popupOverlay],"e-popup-overlay");else{let popupContainer=this.parent.createElement("div",{className:"e-rte-modal-popup e-popup-container e-center"});element.parentNode.insertBefore(popupContainer,element),popupContainer.appendChild(element),popupContainer.style.zIndex=element.style.zIndex,popupContainer.style.display="flex",element.style.position="relative",addClass([element],"e-popup-modal"),this.popupOverlay=this.parent.createElement("div",{className:"e-popup-overlay"}),this.popupOverlay.style.zIndex=(parseInt(element.style.zIndex,null)-1).toString(),this.popupOverlay.style.display="block",popupContainer.appendChild(this.popupOverlay),EventHandler.add(this.popupOverlay,"click touchmove",this.onPopupOverlay,this)}}paletteSelection(dropDownArgs,currentElement){let ele=dropDownArgs.element.querySelector(".e-control.e-colorpicker"),colorbox=[].slice.call(ej2_base_es2015_selectAll(".e-tile",ele.parentElement));removeClass(colorbox,"e-selected");let style=currentElement.querySelector("."+CLS_RTE_ELEMENTS).style.borderBottomColor;colorbox.filter(colorbox=>{colorbox.style.backgroundColor===style&&addClass([colorbox],"e-selected")})}renderColorPickerDropDown(args,item,colorPicker){let proxy=this,css=CLS_RTE_ELEMENTS+" "+CLS_TB_BTN+(this.parent.inlineMode?" "+CLS_INLINE_DROPDOWN:"");css+=" "+("backgroundcolor"===item?CLS_BACKGROUND_COLOR_DROPDOWN:CLS_FONT_COLOR_DROPDOWN);let range,content=proxy.parent.createElement("span",{className:CLS_COLOR_CONTENT}),inlineEle=proxy.parent.createElement("span",{className:args.cssClass});inlineEle.style.borderBottomColor="backgroundcolor"===item?proxy.parent.backgroundColor.default:proxy.parent.fontColor.default,content.appendChild(inlineEle);let dropDown=new ej2_splitbuttons_es2015_DropDownButton({target:colorPicker.element.parentElement,cssClass:css,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,beforeOpen:dropDownArgs=>{if(proxy.parent.readonly||!proxy.parent.enabled)return void(dropDownArgs.cancel=!0);let element=dropDownArgs.event?dropDownArgs.event.target:null;if(proxy.currentElement=dropDown.element,proxy.currentDropdown=dropDown,proxy.paletteSelection(dropDownArgs,proxy.currentElement),dropDownArgs.event&&"click"===dropDownArgs.event.type&&(element.classList.contains(CLS_COLOR_CONTENT)||element.parentElement.classList.contains(CLS_COLOR_CONTENT))){dropDownArgs.cancel=!0;let colorpickerValue=element.classList.contains(CLS_RTE_ELEMENTS)?element.style.borderBottomColor:element.querySelector("."+CLS_RTE_ELEMENTS).style.borderBottomColor;proxy.parent.notify(selectionRestore,{});let parentNode=(range=proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.parent.contentModule.getDocument())).startContainer.parentNode;("TD"===range.startContainer.nodeName||"TH"===range.startContainer.nodeName||closest(range.startContainer.parentNode,"td,th")||proxy.parent.iframeSettings.enable&&!hasClass(parentNode.ownerDocument.querySelector("body"),"e-lib"))&&range.collapsed?proxy.parent.notify(tableColorPickerChanged,{item:{command:args.command,subCommand:args.subCommand,value:colorpickerValue}}):proxy.parent.notify(colorPickerChanged,{item:{command:args.command,subCommand:args.subCommand,value:colorpickerValue}})}else{{let inst=getInstance(dropDownArgs.element.querySelector(".e-control.e-colorpicker"),ej2_inputs_es2015_ColorPicker);inst.showButtons=!dropDownArgs.element.querySelector(".e-color-palette"),inst.dataBind()}dropDownArgs.element.onclick=args=>{args.target.classList.contains("e-cancel")&&dropDown.toggle()}}},open:dropDownArgs=>{this.setColorPickerContentWidth(colorPicker);let focusEle,ele=dropDownArgs.element.querySelector(".e-control.e-colorpicker");(focusEle=dropDownArgs.element.querySelector(".e-color-palette")?ele.parentElement.querySelector(".e-palette"):ele.parentElement.querySelector("e-handler"))&&focusEle.focus(),Browser.isDevice&&this.popupModal(dropDownArgs.element.parentElement),this.pickerRefresh(dropDownArgs)},beforeClose:dropDownArgs=>{let element=dropDownArgs.event?dropDownArgs.event.target:null;if(dropDownArgs.event&&"click"===dropDownArgs.event.type&&(element.classList.contains(CLS_COLOR_CONTENT)||element.parentElement.classList.contains(CLS_COLOR_CONTENT))){let colorpickerValue=element.classList.contains(CLS_RTE_ELEMENTS)?element.style.borderBottomColor:element.querySelector("."+CLS_RTE_ELEMENTS).style.borderBottomColor;("TD"===(range=proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.parent.contentModule.getDocument())).startContainer.nodeName||"TH"===range.startContainer.nodeName||closest(range.startContainer.parentNode,"td,th"))&&range.collapsed?proxy.parent.notify(tableColorPickerChanged,{item:{command:args.command,subCommand:args.subCommand,value:colorpickerValue}}):proxy.parent.notify(colorPickerChanged,{item:{command:args.command,subCommand:args.subCommand,value:colorpickerValue}})}},close:dropDownArgs=>{proxy.parent.notify(selectionRestore,{});let dropElement=closest(dropDownArgs.element.parentElement,".e-popup-container");dropElement&&(dropElement.style.display="none",dropElement.lastElementChild.style.display="none",removeClass([dropElement.lastElementChild],"e-popup-overlay"))}});return dropDown.isStringTemplate=!0,dropDown.createElement=proxy.parent.createElement,dropDown.appendTo(args.element),document.getElementById(dropDown.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),dropDown.element.insertBefore(content,dropDown.element.querySelector(".e-caret")),args.element.tabIndex=-1,dropDown.element.removeAttribute("type"),dropDown.element.onmousedown=()=>{proxy.parent.notify(selectionSave,{})},dropDown}pickerRefresh(dropDownArgs){if("Picker"===this.parent.backgroundColor.mode){let popupElem=dropDownArgs.element.parentElement;popupElem.style.width=(popupElem.offsetWidth+5).toString()+"px",getInstance(popupElem,ej2_popups_es2015_Popup).refreshPosition(popupElem),popupElem.style.width=(popupElem.offsetWidth-5).toString()+"px"}}popupModal(element){let popupInst=getInstance(element,ej2_popups_es2015_Popup);popupInst.relateTo=document.body,popupInst.position={X:0,Y:0},popupInst.targetType="container",popupInst.collision={X:"fit",Y:"fit"},popupInst.offsetY=4,popupInst.dataBind(),this.setIsModel(element)}setColorPickerContentWidth(colorPicker){let colorPickerContent=colorPicker.element.nextSibling;if("0px"===colorPickerContent.style.width){colorPickerContent.style.width="";let borderWidth=parseInt(getComputedStyle(colorPickerContent).borderBottomWidth,10);colorPickerContent.style.width=formatUnit(colorPickerContent.children[0].offsetWidth+borderWidth+borderWidth)}}renderColorPicker(args,item){let proxy=this;return this.colorPicker=new ej2_inputs_es2015_ColorPicker({enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,inline:!0,created:()=>{this.colorPicker.setProperties({value:"backgroundcolor"===item?proxy.parent.backgroundColor.default:proxy.parent.fontColor.default})},mode:"backgroundcolor"===item?proxy.parent.backgroundColor.mode:proxy.parent.fontColor.mode,modeSwitcher:"backgroundcolor"===item?proxy.parent.backgroundColor.modeSwitcher:proxy.parent.fontColor.modeSwitcher,beforeTileRender:args=>{args.element.classList.add(CLS_COLOR_PALETTE)},change:colorPickerArgs=>{let colorpickerValue=colorPickerArgs.currentValue.rgba;colorPickerArgs.item={command:args.command,subCommand:args.subCommand,value:colorpickerValue},proxy.parent.notify(selectionRestore,{}),proxy.currentElement.querySelector("."+CLS_RTE_ELEMENTS).style.borderBottomColor=colorpickerValue;let range=proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.parent.contentModule.getDocument());("TD"===range.startContainer.nodeName||"TH"===range.startContainer.nodeName||closest(range.startContainer.parentNode,"td,th"))&&range.collapsed?proxy.parent.notify(tableColorPickerChanged,colorPickerArgs):proxy.parent.notify(colorPickerChanged,colorPickerArgs),proxy.currentDropdown.toggle()},beforeModeSwitch:args=>{this.colorPicker.showButtons="Palette"!==args.mode}}),this.colorPicker.isStringTemplate=!0,this.colorPicker.columns="backgroundcolor"===item?this.parent.backgroundColor.columns:this.parent.fontColor.columns,this.colorPicker.presetColors="backgroundcolor"===item?this.parent.backgroundColor.colorCode:this.parent.fontColor.colorCode,this.colorPicker.cssClass="backgroundcolor"===item?CLS_BACKGROUND_COLOR_PICKER:CLS_FONT_COLOR_PICKER,this.colorPicker.createElement=this.parent.createElement,this.colorPicker.appendTo(document.body.querySelector(args.target)),this.colorPicker}renderPanel(){this.getPanel().classList.add(CLS_TOOLBAR)}getPanel(){return this.toolbarPanel}setPanel(panel){this.toolbarPanel=panel}}class ej2_richtexteditor_es2015_BaseToolbar{constructor(parent,serviceLocator){this.tools={},this.parent=parent,this.locator=serviceLocator,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?extend(this.tools,tools,toObjectLowerCase(this.parent.toolbarSettings.itemConfigs),!0):this.tools=tools}addEventListener(){this.parent.on(rtlMode,this.setRtl,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.removeEventListener,this)}removeEventListener(){this.parent.off(rtlMode,this.setRtl),this.parent.off(ej2_richtexteditor_es2015_destroy,this.removeEventListener)}setRtl(args){isNullOrUndefined(this.toolbarObj)||this.toolbarObj.setProperties({enableRtl:args.enableRtl})}getTemplateObject(itemStr,container){let tagName;switch(itemStr){case"fontcolor":case"backgroundcolor":tagName="span";break;default:tagName="button"}return{command:this.tools[itemStr.toLocaleLowerCase()].command,subCommand:this.tools[itemStr.toLocaleLowerCase()].subCommand,template:this.parent.createElement(tagName,{id:this.parent.getID()+"_"+container+"_"+this.tools[itemStr.toLocaleLowerCase()].id}).outerHTML,tooltipText:getTooltipText(itemStr,this.locator)}}getObject(item,container){let itemStr=item.toLowerCase();if(-1!==templateItems.indexOf(itemStr))return this.getTemplateObject(itemStr,container);switch(itemStr){case"|":return{type:"Separator"};case"-":return{type:"Separator",cssClass:CLS_HR_SEPARATOR};default:return{id:this.parent.getID()+"_"+container+"_"+this.tools[itemStr.toLocaleLowerCase()].id,prefixIcon:this.tools[itemStr.toLocaleLowerCase()].icon,tooltipText:getTooltipText(itemStr,this.locator),command:this.tools[itemStr.toLocaleLowerCase()].command,subCommand:this.tools[itemStr.toLocaleLowerCase()].subCommand}}}getItems(tbItems,container){if(this.parent.toolbarSettings.items.length<1)return[];let items=[];for(let item of tbItems)switch(typeof item){case"string":items.push(this.getObject(item,container));break;default:items.push(item)}return items}getToolbarOptions(args){return{target:args.target,rteToolbarObj:this,items:this.getItems(args.items,args.container),overflowMode:args.mode,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl}}render(args){this.toolbarRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Toolbar),this.toolbarRenderer.renderToolbar(this.getToolbarOptions(args))}}class ej2_richtexteditor_es2015_DropDownButtons{constructor(parent,serviceLocator){this.parent=parent,this.locator=serviceLocator,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener()}initializeInstance(){this.toolbarRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Toolbar)}beforeRender(args){let item=args.item;item.cssClass&&addClass([args.element],item.cssClass),"Alignments"!==item.command&&"JustifyLeft"!==item.subCommand&&"JustifyRight"!==item.subCommand&&"JustifyCenter"!==item.subCommand||args.element.setAttribute("title",getTooltipText(item.subCommand.toLocaleLowerCase(),this.locator))}dropdownContent(width,type,content){return'<span style="display: inline-flex;width:'+("quick"===type?"auto":width)+'" ><span class="e-rte-dropdown-btn-text">'+content+"</span></span>"}renderDropDowns(args){this.initializeInstance();let type=args.containerType,tbElement=args.container;templateItems.forEach(item=>{let targetElement=void 0;if(-1!==getIndex(item,args.items))switch(item){case"formats":if(isNullOrUndefined(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_Formats",tbElement))||targetElement.classList.contains(CLS_DROPDOWN_BTN))return;let formatItem=this.parent.format.types.slice();formatItem.forEach(item=>{Object.defineProperties(item,{command:{value:"Formats",enumerable:!0},subCommand:{value:item.value,enumerable:!0}})});let formatContent=isNullOrUndefined(this.parent.format.default)?formatItem[0].text:this.parent.format.default;this.formatDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"quick"===type?"e-formats e-icons":"",content:this.dropdownContent(this.parent.format.width,type,"quick"===type?"":getDropDownValue(formatItem,formatContent,"text","text")),cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ITEMS+" "+CLS_FORMATS_TB_BTN,itemName:"Formats",items:formatItem,element:targetElement});break;case"fontname":if(isNullOrUndefined(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_FontName",tbElement))||targetElement.classList.contains(CLS_DROPDOWN_BTN))return;let fontItem=this.parent.fontFamily.items.slice();fontItem.forEach(item=>{Object.defineProperties(item,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontName",enumerable:!0}})});let fontNameContent=isNullOrUndefined(this.parent.fontFamily.default)?fontItem[0].text:this.parent.fontFamily.default;this.fontNameDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"quick"===type?"e-font-name e-icons":"",content:this.dropdownContent(this.parent.fontFamily.width,type,"quick"===type?"":getDropDownValue(fontItem,fontNameContent,"text","text")),cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ITEMS+" "+CLS_FONT_NAME_TB_BTN,itemName:"FontName",items:fontItem,element:targetElement}),isNullOrUndefined(this.parent.fontFamily.default)||(this.getEditNode().style.fontFamily=this.parent.fontFamily.default);break;case"fontsize":if(isNullOrUndefined(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_FontSize",tbElement))||targetElement.classList.contains(CLS_DROPDOWN_BTN))return;let fontsize=this.parent.fontSize.items.slice();fontsize.forEach(item=>{Object.defineProperties(item,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontSize",enumerable:!0}})});let fontSizeContent=isNullOrUndefined(this.parent.fontSize.default)?fontsize[1].text:this.parent.fontSize.default;this.fontSizeDropDown=this.toolbarRenderer.renderDropDownButton({content:this.dropdownContent(this.parent.fontSize.width,type,getFormattedFontSize(getDropDownValue(fontsize,fontSizeContent.replace(/\s/g,""),"value","text"))),cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ITEMS+" "+CLS_FONT_SIZE_TB_BTN,itemName:"FontSize",items:fontsize,element:targetElement}),isNullOrUndefined(this.parent.fontSize.default)||(this.getEditNode().style.fontSize=this.parent.fontSize.default);break;case"alignments":if(isNullOrUndefined(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_Alignments",tbElement))||targetElement.classList.contains(CLS_DROPDOWN_BTN))return;this.alignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ITEMS,itemName:"Alignments",items:alignmentItems,element:targetElement});break;case"align":this.imageAlignmentDropDown(type,tbElement,targetElement);break;case"display":this.imageDisplayDropDown(type,tbElement,targetElement);break;case"tablerows":this.rowDropDown(type,tbElement,targetElement);break;case"tablecolumns":this.columnDropDown(type,tbElement,targetElement);break;case"tablecellverticalalign":this.verticalAlignDropDown(type,tbElement,targetElement);break;case"styles":this.tableStylesDropDown(type,tbElement,targetElement)}})}getUpdateItems(items,value){let dropDownItems=items.slice();return dropDownItems.forEach(item=>{Object.defineProperties(item,{command:{value:"Format"===value?"Formats":"Font",enumerable:!0},subCommand:{value:"Format"===value?item.value:value,enumerable:!0}})}),dropDownItems}onPropertyChanged(model){let type,content,newProp=model.newProp;for(let prop of Object.keys(newProp))switch(prop){case"fontFamily":if(this.fontNameDropDown)for(let fontFamily of Object.keys(newProp.fontFamily))switch(fontFamily){case"default":case"width":let fontItems=this.fontNameDropDown.items;type=isNullOrUndefined(closest(this.fontNameDropDown.element,"."+CLS_QUICK_TB))?"toolbar":"quick";let fontNameContent=isNullOrUndefined(this.parent.fontFamily.default)?fontItems[0].text:this.parent.fontFamily.default;content=this.dropdownContent(this.parent.fontFamily.width,type,"quick"===type?"":getDropDownValue(fontItems,fontNameContent,"text","text")),this.fontNameDropDown.setProperties({content:content}),isNullOrUndefined(this.parent.fontFamily.default)?this.getEditNode().style.removeProperty("font-family"):this.getEditNode().style.fontFamily=this.parent.fontFamily.default;break;case"items":this.fontNameDropDown.setProperties({items:this.getUpdateItems(newProp.fontFamily.items,"FontSize")})}break;case"fontSize":if(this.fontSizeDropDown)for(let fontSize of Object.keys(newProp.fontSize))switch(fontSize){case"default":case"width":let fontsize=this.fontSizeDropDown.items;type=isNullOrUndefined(closest(this.fontSizeDropDown.element,"."+CLS_QUICK_TB))?"toolbar":"quick";let fontSizeContent=isNullOrUndefined(this.parent.fontSize.default)?fontsize[1].text:this.parent.fontSize.default;content=this.dropdownContent(this.parent.fontSize.width,type,getFormattedFontSize(getDropDownValue(fontsize,fontSizeContent.replace(/\s/g,""),"value","text"))),this.fontSizeDropDown.setProperties({content:content}),isNullOrUndefined(this.parent.fontSize.default)?this.getEditNode().style.removeProperty("font-size"):this.getEditNode().style.fontSize=this.parent.fontSize.default;break;case"items":this.fontSizeDropDown.setProperties({items:this.getUpdateItems(newProp.fontSize.items,"FontSize")})}break;case"format":if(this.formatDropDown)for(let format of Object.keys(newProp.format))switch(format){case"default":case"width":let formatItems=this.formatDropDown.items;type=isNullOrUndefined(closest(this.formatDropDown.element,"."+CLS_QUICK_TB))?"toolbar":"quick";let formatContent=isNullOrUndefined(this.parent.format.default)?formatItems[0].text:this.parent.format.default;content=this.dropdownContent(this.parent.format.width,type,"quick"===type?"":getDropDownValue(formatItems,formatContent,"text","text")),this.formatDropDown.setProperties({content:content});break;case"types":this.formatDropDown.setProperties({items:this.getUpdateItems(newProp.format.types,"Format")})}}}getEditNode(){return this.parent.contentModule.getEditPanel()}rowDropDown(type,tbElement,targetElement){(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_TableRows",tbElement)).classList.contains(CLS_DROPDOWN_BTN)||(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-rows e-icons",cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ITEMS+" "+CLS_QUICK_DROPDOWN,itemName:"TableRows",items:tableRowsItems,element:targetElement}))}columnDropDown(type,tbElement,targetElement){(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_TableColumns",tbElement)).classList.contains(CLS_DROPDOWN_BTN)||(this.tableColumnsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-columns e-icons",cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ITEMS+" "+CLS_QUICK_DROPDOWN,itemName:"TableColumns",items:tableColumnsItems,element:targetElement}))}verticalAlignDropDown(type,tbElement,targetElement){(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_TableCellVerticalAlign",tbElement)).classList.contains(CLS_DROPDOWN_BTN)||(this.tableCellVerticalAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell-ver-align e-icons",cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ITEMS+" "+CLS_QUICK_DROPDOWN,itemName:"TableCellVerticalAlign",items:TableCellVerticalAlignItems,element:targetElement}))}imageDisplayDropDown(type,tbElement,targetElement){(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_Display",tbElement)).classList.contains(CLS_DROPDOWN_BTN)||(this.displayDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-display e-icons",cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ITEMS+" "+CLS_QUICK_DROPDOWN,itemName:"Display",items:imageDisplayItems,element:targetElement}))}imageAlignmentDropDown(type,tbElement,targetElement){(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_Align",tbElement)).classList.contains(CLS_DROPDOWN_BTN)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ICONS+" "+CLS_QUICK_DROPDOWN,itemName:"Align",items:imageAlignItems,element:targetElement}))}tableStylesDropDown(type,tbElement,targetElement){(targetElement=ej2_base_es2015_select("#"+this.parent.getID()+"_"+type+"_Styles",tbElement)).classList.contains(CLS_DROPDOWN_BTN)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-style e-icons",cssClass:CLS_DROPDOWN_POPUP+" "+CLS_DROPDOWN_ICONS+" "+CLS_QUICK_DROPDOWN,itemName:"Styles",items:this.parent.tableSettings.styles,element:targetElement}))}removeDropDownClasses(target){removeClass([target],[CLS_DROPDOWN_BTN,CLS_DROPDOWN_POPUP,CLS_DROPDOWN_ICONS,CLS_DROPDOWN_ITEMS])}destroyDropDowns(){this.formatDropDown&&(this.removeDropDownClasses(this.formatDropDown.element),this.formatDropDown.destroy()),this.fontNameDropDown&&(this.removeDropDownClasses(this.fontNameDropDown.element),this.fontNameDropDown.destroy()),this.fontSizeDropDown&&(this.removeDropDownClasses(this.fontSizeDropDown.element),this.fontSizeDropDown.destroy()),this.alignDropDown&&(this.removeDropDownClasses(this.alignDropDown.element),this.alignDropDown.destroy()),this.imageAlignDropDown&&(this.removeDropDownClasses(this.imageAlignDropDown.element),this.imageAlignDropDown.destroy()),this.displayDropDown&&(this.removeDropDownClasses(this.displayDropDown.element),this.displayDropDown.destroy()),this.tableRowsDropDown&&(this.removeDropDownClasses(this.tableRowsDropDown.element),this.tableRowsDropDown.destroy()),this.tableColumnsDropDown&&(this.removeDropDownClasses(this.tableColumnsDropDown.element),this.tableColumnsDropDown.destroy()),this.tableCellVerticalAlignDropDown&&(this.removeDropDownClasses(this.tableCellVerticalAlignDropDown.element),this.tableCellVerticalAlignDropDown.destroy())}setRtl(args){this.formatDropDown&&this.formatDropDown.setProperties({enableRtl:args.enableRtl}),this.fontNameDropDown&&this.fontNameDropDown.setProperties({enableRtl:args.enableRtl}),this.fontSizeDropDown&&this.fontSizeDropDown.setProperties({enableRtl:args.enableRtl}),this.alignDropDown&&this.alignDropDown.setProperties({enableRtl:args.enableRtl}),this.imageAlignDropDown&&this.imageAlignDropDown.setProperties({enableRtl:args.enableRtl}),this.displayDropDown&&this.displayDropDown.setProperties({enableRtl:args.enableRtl})}addEventListener(){this.parent.isDestroyed||(this.parent.on(beforeDropDownItemRender,this.beforeRender,this),this.parent.on(iframeMouseDown,this.onIframeMouseDown,this),this.parent.on(rtlMode,this.setRtl,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.removeEventListener,this),this.parent.on(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged,this))}onIframeMouseDown(){ej2_richtexteditor_es2015_dispatchEvent(document,"mousedown")}removeEventListener(){this.parent.isDestroyed||(this.parent.off(iframeMouseDown,this.onIframeMouseDown),this.parent.off(rtlMode,this.setRtl),this.parent.off(beforeDropDownItemRender,this.beforeRender),this.parent.off(ej2_richtexteditor_es2015_destroy,this.removeEventListener),this.parent.off(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged))}}class ej2_richtexteditor_es2015_ServiceLocator{constructor(){this.services={}}register(name,type){isNullOrUndefined(this.services[name])&&(this.services[name]=type)}getService(name){if(isNullOrUndefined(this.services[name]))throw`The service ${name} is not registered`;return this.services[name]}}class ej2_richtexteditor_es2015_RendererFactory{constructor(){this.rendererMap={}}addRenderer(name,type){let rName=getEnumValue(ej2_richtexteditor_es2015_RenderType,name);isNullOrUndefined(this.rendererMap[rName])&&(this.rendererMap[rName]=type)}getRenderer(name){let rName=getEnumValue(ej2_richtexteditor_es2015_RenderType,name);if(isNullOrUndefined(this.rendererMap[rName]))throw`The renderer ${rName} is not found`;return this.rendererMap[rName]}}class ej2_richtexteditor_es2015_ToolbarAction{constructor(parent){this.parent=parent,this.addEventListener(),this.serviceLocator=new ej2_richtexteditor_es2015_ServiceLocator,this.serviceLocator.register("rendererFactory",new ej2_richtexteditor_es2015_RendererFactory)}addEventListener(){this.parent.on(ej2_richtexteditor_es2015_toolbarClick,this.toolbarClick,this),this.parent.on(dropDownSelect,this.dropDownSelect,this),this.parent.on(colorPickerChanged,this.renderSelection,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.removeEventListener,this)}toolbarClick(args){if(!isNullOrUndefined(args.item)){if(!isNullOrUndefined(args.item.controlParent)){let activeEle=args.item.controlParent.activeEle;activeEle&&(activeEle.tabIndex=-1)}this.parent.notify(htmlToolbarClick,args),this.parent.notify(markdownToolbarClick,args)}}dropDownSelect(e){if(this.parent.notify(selectionRestore,{}),!document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))||!e.item||"Images"!==e.item.command&&"Display"!==e.item.command&&"Table"!==e.item.command){let value=e.item.controlParent&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar&&this.parent.quickToolbarModule.tableQTBar.element.contains(e.item.controlParent.element)?"Table":null;this.parent.formatter.process(this.parent,e,e.originalEvent,value)}this.parent.notify(selectionSave,{})}renderSelection(args){this.parent.notify(selectionRestore,{}),this.parent.formatter.process(this.parent,args,args.originalEvent,null),this.parent.notify(selectionSave,{})}removeEventListener(){this.parent.off(ej2_richtexteditor_es2015_toolbarClick,this.toolbarClick),this.parent.off(dropDownSelect,this.dropDownSelect),this.parent.off(colorPickerChanged,this.renderSelection),this.parent.off(ej2_richtexteditor_es2015_destroy,this.removeEventListener)}}class ej2_richtexteditor_es2015_Toolbar$1{constructor(parent,serviceLocator){this.parent=parent,this.isToolbar=!1,this.locator=serviceLocator,this.isTransformChild=!1,this.renderFactory=this.locator.getService("rendererFactory"),function(self){alignmentItems.forEach((item,i)=>{alignmentItems[i].text=getLocale(self,alignmentLocale,alignmentItems[i])}),imageDisplayItems.forEach((item,i)=>{imageDisplayItems[i].text=getLocale(self,displayLocale,imageDisplayItems[i])}),tableRowsItems.forEach((item,i)=>{tableRowsItems[i].text=getLocale(self,tableRowLocale,tableRowsItems[i])}),tableColumnsItems.forEach((item,i)=>{tableColumnsItems[i].text=getLocale(self,tableColumnLocale,tableColumnsItems[i])}),TableCellVerticalAlignItems.forEach((item,i)=>{TableCellVerticalAlignItems[i].text=getLocale(self,tableVerticalLocale,TableCellVerticalAlignItems[i])}),TableStyleItems.forEach((item,i)=>{TableStyleItems[i].text=getLocale(self,tableStyleLocale,TableStyleItems[i])})}(this.parent),this.renderFactory.addRenderer(ej2_richtexteditor_es2015_RenderType.Toolbar,new ej2_richtexteditor_es2015_ToolbarRenderer(this.parent)),this.toolbarRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Toolbar),this.baseToolbar=new ej2_richtexteditor_es2015_BaseToolbar(this.parent,this.locator),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?extend(this.tools,tools,toObjectLowerCase(this.parent.toolbarSettings.itemConfigs),!0):this.tools=tools}initializeInstance(){this.contentRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Content),this.editableElement=this.contentRenderer.getEditPanel(),this.editPanel=this.contentRenderer.getPanel()}toolbarBindEvent(){this.parent.inlineMode.enable||(this.keyBoardModule=new ej2_base_es2015_KeyboardEvents(this.getToolbarElement(),{keyAction:this.toolBarKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}))}toolBarKeyDown(e){switch(e.action){case"escape":this.parent.contentModule.getEditPanel().focus()}}createToolbarElement(){this.tbElement=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar"}),!Browser.isDevice&&this.parent.inlineMode.enable&&isIDevice()||(this.parent.toolbarSettings.enableFloating&&!this.parent.inlineMode.enable?(this.tbWrapper=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar_wrapper",innerHTML:this.tbElement.outerHTML,className:CLS_TB_WRAP}),this.tbElement=this.tbWrapper.firstElementChild,this.parent.element.insertBefore(this.tbWrapper,this.editPanel)):this.parent.element.insertBefore(this.tbElement,this.editPanel))}getToolbarMode(){let tbMode;switch(this.parent.toolbarSettings.type){case ToolbarType.Expand:tbMode="Extended";break;default:tbMode="MultiRow"}return tbMode}checkToolbarResponsive(ele){return!(!Browser.isDevice||isIDevice()||(this.baseToolbar.render({container:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items,mode:"MultiRow",target:ele}),addClass([ele],["e-rte-tb-mobile"]),this.parent.inlineMode.enable?this.addFixedTBarClass():addClass([ele],[CLS_TB_STATIC]),this.wireEvents(),this.dropDownModule.renderDropDowns({container:ele,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(renderColorPicker,{container:this.tbElement,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),0))}checkIsTransformChild(){this.isTransformChild=!1;let transformElements=ej2_base_es2015_selectAll('[style*="transform"]',document);for(let i=0;i<transformElements.length;i++)if(!isNullOrUndefined(transformElements[i].contains)&&transformElements[i].contains(this.parent.element)){this.isTransformChild=!0;break}}toggleFloatClass(e){let topValue,scrollParent,isBody=!1,isFloat=!1,floatOffset=this.parent.floatingToolbarOffset;e&&this.parent.iframeSettings.enable&&this.parent.inputElement.ownerDocument===e.target?scrollParent=e.target.body:e&&e.target!==document?scrollParent=e.target:(isBody=!0,scrollParent=document.body);let tbHeight=this.getToolbarHeight()+this.getExpandTBarPopHeight();if(this.isTransformChild){topValue=0;let scrollParentRelativeTop=0,trgHeight=this.parent.element.offsetHeight;if(isBody){let bodyStyle=window.getComputedStyle(scrollParent);scrollParentRelativeTop=parseFloat(bodyStyle.marginTop.split("px")[0])+parseFloat(bodyStyle.paddingTop.split("px")[0])}let targetTop=this.parent.element.getBoundingClientRect().top,scrollParentYOffset=Browser.isMSPointer&&isBody?window.pageYOffset:scrollParent.parentElement.scrollTop,scrollParentRect=scrollParent.getBoundingClientRect(),scrollParentTop=isBody?scrollParentRect.top+scrollParentYOffset:scrollParentRect.top,outOfRange=!(targetTop-(isBody?0:scrollParentTop)+trgHeight>tbHeight+floatOffset);targetTop>scrollParentTop+floatOffset||targetTop<-trgHeight||targetTop<0&&outOfRange?(isFloat=!1,removeClass([this.tbElement],[CLS_TB_ABS_FLOAT])):targetTop<scrollParentTop+floatOffset&&(topValue=targetTop<0?-targetTop+scrollParentTop:scrollParentTop-targetTop,topValue=isBody?topValue-scrollParentRelativeTop:topValue,addClass([this.tbElement],[CLS_TB_ABS_FLOAT]),isFloat=!0)}else{let parent=this.parent.element.getBoundingClientRect();if(window.innerHeight<parent.top)return;topValue=e&&e.target!==document?scrollParent.getBoundingClientRect().top:0,parent.bottom<floatOffset+tbHeight+topValue||parent.bottom<0||parent.top>floatOffset+topValue?isFloat=!1:parent.top<floatOffset&&(isFloat=!0)}isFloat?(addClass([this.tbElement],[CLS_TB_FLOAT]),setStyleAttribute(this.tbElement,{width:this.parent.element.offsetWidth+"px",top:floatOffset+topValue+"px"})):(removeClass([this.tbElement],[CLS_TB_FLOAT]),setStyleAttribute(this.tbElement,{top:"0px",width:"100%"}))}renderToolbar(){if(this.initializeInstance(),this.createToolbarElement(),this.checkToolbarResponsive(this.tbElement))return;this.parent.inlineMode.enable?this.parent.notify(renderInlineToolbar,{}):(this.baseToolbar.render({container:"toolbar",items:this.parent.toolbarSettings.items,mode:this.getToolbarMode(),target:this.tbElement}),this.parent.inlineMode.enable||(this.parent.toolbarSettings.enableFloating&&(this.checkIsTransformChild(),this.toggleFloatClass()),this.parent.toolbarSettings.type===ToolbarType.Expand&&addClass([this.parent.element],[CLS_RTE_EXPAND_TB]))),this.wireEvents(),this.parent.inlineMode.enable&&!isIDevice()&&this.addFixedTBarClass(),this.parent.inlineMode.enable||(this.dropDownModule.renderDropDowns({container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(renderColorPicker,{container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.refreshToolbarOverflow());let divEle=this.parent.element.querySelector(".e-rte-srctextarea"),iframeEle=this.parent.element.querySelector(".e-source-content");(!this.parent.iframeSettings.enable&&!isNullOrUndefined(divEle)&&"block"===divEle.style.display||this.parent.iframeSettings.enable&&!isNullOrUndefined(iframeEle)&&"block"===iframeEle.style.display)&&(this.parent.notify(updateToolbarItem,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),this.parent.disableToolbarItem(this.parent.toolbarSettings.items))}addFixedTBarClass(){addClass([this.tbElement],[CLS_TB_FIXED])}removeFixedTBarClass(){removeClass([this.tbElement],[CLS_TB_FIXED])}showFixedTBar(){addClass([this.tbElement],[CLS_SHOW]),Browser.isIos&&addClass([this.tbElement],[CLS_TB_IOS_FIX])}hideFixedTBar(){this.isToolbar?this.isToolbar=!1:removeClass([this.tbElement],[CLS_SHOW,CLS_TB_IOS_FIX])}updateItem(args){let item=this.tools[args.updateItem.toLocaleLowerCase()],index=getTBarItemsIndex(getCollection(this.tools[args.targetItem.toLocaleLowerCase()].subCommand),args.baseToolbar.toolbarObj.items)[0];if(isNullOrUndefined(index))this.addTBarItem(args,0);else{let prefixId=this.parent.inlineMode.enable?"_quick_":"_toolbar_";args.baseToolbar.toolbarObj.items[index].id=this.parent.getID()+prefixId+item.id,args.baseToolbar.toolbarObj.items[index].prefixIcon=item.icon,args.baseToolbar.toolbarObj.items[index].tooltipText=item.tooltip,args.baseToolbar.toolbarObj.items[index].subCommand=item.subCommand,args.baseToolbar.toolbarObj.dataBind()}}updateToolbarStatus(args){this.tbElement&&(!this.parent.inlineMode.enable||!isIDevice()&&Browser.isDevice)&&setToolbarStatus({args:args,dropDownModule:this.dropDownModule,parent:this.parent,tbElements:ej2_base_es2015_selectAll("."+ej2_richtexteditor_es2015_CLS_TB_ITEM,this.tbElement),tbItems:this.baseToolbar.toolbarObj.items},!!this.parent.inlineMode.enable)}fullScreen(e){this.parent.fullScreenModule.showFullScreen(e)}hideScreen(e){this.parent.fullScreenModule.hideFullScreen(e)}getBaseToolbar(){return this.baseToolbar}addTBarItem(args,index){args.baseToolbar.toolbarObj.addItems([args.baseToolbar.getObject(args.updateItem,"toolbar")],index)}enableTBarItems(baseToolbar,items,isEnable,muteToolbarUpdate){let trgItems=getTBarItemsIndex(getCollection(items),baseToolbar.toolbarObj.items);this.tbItems=ej2_base_es2015_selectAll("."+ej2_richtexteditor_es2015_CLS_TB_ITEM,baseToolbar.toolbarObj.element);for(let i=0;i<trgItems.length;i++){let item=this.tbItems[trgItems[i]];item&&baseToolbar.toolbarObj.enableItems(item,isEnable)}ej2_base_es2015_select(".e-rte-srctextarea",this.parent.element)||muteToolbarUpdate||updateUndoRedoStatus(baseToolbar,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())}removeTBarItems(items){isNullOrUndefined(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());let trgItems=getTBarItemsIndex(getCollection(items),this.baseToolbar.toolbarObj.items);this.tbItems=ej2_base_es2015_selectAll("."+ej2_richtexteditor_es2015_CLS_TB_ITEM,this.parent.inlineMode.enable?this.baseToolbar.toolbarObj.element:this.parent.element);for(let i=0;i<trgItems.length;i++)this.baseToolbar.toolbarObj.removeItems(this.tbItems[trgItems[i]])}getExpandTBarPopHeight(){let popHeight=0;if(this.parent.toolbarSettings.type===ToolbarType.Expand&&this.tbElement.classList.contains("e-extended-toolbar")){let expandPopup=ej2_base_es2015_select(".e-toolbar-extended",this.tbElement);expandPopup&&this.tbElement.classList.contains("e-expand-open")||expandPopup&&expandPopup.classList.contains("e-popup-open")?(addClass([expandPopup],[CLS_VISIBLE]),popHeight+=expandPopup.offsetHeight,removeClass([expandPopup],[CLS_VISIBLE])):removeClass([this.tbElement],[CLS_EXPAND_OPEN])}return popHeight}getToolbarHeight(){return this.tbElement.offsetHeight}getToolbarElement(){return ej2_base_es2015_select("."+CLS_TOOLBAR,this.parent.element)}refreshToolbarOverflow(){this.baseToolbar.toolbarObj.refreshOverflow()}isToolbarDestroyed(){return this.baseToolbar.toolbarObj&&!this.baseToolbar.toolbarObj.isDestroyed}destroyToolbar(){if(this.isToolbarDestroyed()){this.parent.unWireScrollElementsEvents(),this.unWireEvents(),this.parent.notify(destroyColorPicker,{}),this.dropDownModule.destroyDropDowns(),this.baseToolbar.toolbarObj.destroy(),this.removeEventListener(),removeClass([this.parent.element],[CLS_RTE_EXPAND_TB]);let tbWrapper=ej2_base_es2015_select("."+CLS_TB_WRAP,this.parent.element),tbElement=ej2_base_es2015_select("."+CLS_TOOLBAR,this.parent.element);isNullOrUndefined(tbWrapper)?isNullOrUndefined(tbElement)||detach(tbElement):detach(tbWrapper)}}destroy(){this.isToolbarDestroyed()&&(this.destroyToolbar(),this.keyBoardModule&&this.keyBoardModule.destroy())}scrollHandler(e){this.parent.inlineMode.enable||this.parent.toolbarSettings.enableFloating&&this.getDOMVisibility(this.tbElement)&&this.toggleFloatClass(e.args)}getDOMVisibility(el){return!(!el.offsetParent&&0===el.offsetWidth&&0===el.offsetHeight)}mouseDownHandler(){Browser.isDevice&&this.parent.inlineMode.enable&&!isIDevice()&&this.showFixedTBar()}focusChangeHandler(){Browser.isDevice&&this.parent.inlineMode.enable&&!isIDevice()&&(this.isToolbar=!1,this.hideFixedTBar())}dropDownBeforeOpenHandler(){this.isToolbar=!0}toolbarMouseDownHandler(e){let trg=closest(e.target,".e-hor-nav");trg&&this.parent.toolbarSettings.type===ToolbarType.Expand&&!isNullOrUndefined(trg)?trg.classList.contains("e-nav-active")?(addClass([this.tbElement],[CLS_EXPAND_OPEN]),this.parent.setContentHeight("toolbar",!0)):(removeClass([this.tbElement],[CLS_EXPAND_OPEN]),this.parent.setContentHeight("toolbar",!1)):(Browser.isDevice||this.parent.inlineMode.enable)&&(this.isToolbar=!0),isNullOrUndefined(trg)&&this.parent.toolbarSettings.type===ToolbarType.Expand&&removeClass([this.tbElement],[CLS_EXPAND_OPEN])}wireEvents(){this.parent.inlineMode.enable&&isIDevice()||EventHandler.add(this.tbElement,"click mousedown",this.toolbarMouseDownHandler,this)}unWireEvents(){EventHandler.remove(this.tbElement,"click mousedown",this.toolbarMouseDownHandler)}addEventListener(){this.parent.isDestroyed||(this.dropDownModule=new ej2_richtexteditor_es2015_DropDownButtons(this.parent,this.locator),this.toolbarActionModule=new ej2_richtexteditor_es2015_ToolbarAction(this.parent),this.parent.on(ej2_richtexteditor_es2015_initialEnd,this.renderToolbar,this),this.parent.on(ej2_richtexteditor_es2015_scroll,this.scrollHandler,this),this.parent.on(bindOnEnd,this.toolbarBindEvent,this),this.parent.on(toolbarUpdated,this.updateToolbarStatus,this),this.parent.on(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged,this),this.parent.on(refreshBegin,this.onRefresh,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.destroy,this),this.parent.on(enableFullScreen,this.fullScreen,this),this.parent.on(disableFullScreen,this.hideScreen,this),this.parent.on(updateToolbarItem,this.updateItem,this),this.parent.on(beforeDropDownOpen,this.dropDownBeforeOpenHandler,this),this.parent.on(expandPopupClick,this.parent.setContentHeight,this.parent),this.parent.on(focusChange,this.focusChangeHandler,this),this.parent.on(ej2_richtexteditor_es2015_mouseDown,this.mouseDownHandler,this),this.parent.on(sourceCodeMouseDown,this.mouseDownHandler,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(ej2_richtexteditor_es2015_initialEnd,this.renderToolbar),this.parent.off(ej2_richtexteditor_es2015_scroll,this.scrollHandler),this.parent.off(bindOnEnd,this.toolbarBindEvent),this.parent.off(toolbarUpdated,this.updateToolbarStatus),this.parent.off(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged),this.parent.off(ej2_richtexteditor_es2015_destroy,this.destroy),this.parent.off(enableFullScreen,this.parent.fullScreenModule.showFullScreen),this.parent.off(disableFullScreen,this.parent.fullScreenModule.hideFullScreen),this.parent.off(updateToolbarItem,this.updateItem),this.parent.off(beforeDropDownOpen,this.dropDownBeforeOpenHandler),this.parent.off(expandPopupClick,this.parent.setContentHeight),this.parent.off(focusChange,this.focusChangeHandler),this.parent.off(ej2_richtexteditor_es2015_mouseDown,this.mouseDownHandler),this.parent.off(sourceCodeMouseDown,this.mouseDownHandler))}onRefresh(){this.refreshToolbarOverflow(),this.parent.setContentHeight("",!0)}onPropertyChanged(e){if(!isNullOrUndefined(e.newProp.inlineMode))for(let prop of Object.keys(e.newProp.inlineMode))switch(prop){case"enable":this.refreshToolbar()}e.module===this.getModuleName()&&this.refreshToolbar()}refreshToolbar(){isNullOrUndefined(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());let tbWrapper=ej2_base_es2015_select("."+CLS_TB_WRAP,this.parent.element);(ej2_base_es2015_select("."+CLS_TOOLBAR,this.parent.element)||tbWrapper)&&this.destroyToolbar(),this.parent.toolbarSettings.enable&&(this.addEventListener(),this.renderToolbar(),this.parent.wireScrollElementsEvents(),ej2_base_es2015_select(".e-rte-srctextarea",this.parent.element)||updateUndoRedoStatus(this.baseToolbar,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus()))}getModuleName(){return"toolbar"}}var ej2_richtexteditor_es2015_KeyboardEvents_1;let ej2_richtexteditor_es2015_keyCode={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222,"]":221,"[":219,"=":187},ej2_richtexteditor_es2015_KeyboardEvents$1=(()=>{let KeyboardEvents$1=ej2_richtexteditor_es2015_KeyboardEvents_1=class extends Base{constructor(element,options){super(options,element),this.keyPressHandler=e=>{let isAltKey=e.altKey,isCtrlKey=e.ctrlKey,isShiftKey=e.shiftKey,curkeyCode=e.which,keys=Object.keys(this.keyConfigs);for(let key of keys){let configCollection=this.keyConfigs[key].split(",");for(let rconfig of configCollection){let rKeyObj=ej2_richtexteditor_es2015_KeyboardEvents_1.getKeyConfigData(rconfig.trim());isAltKey===rKeyObj.altKey&&isCtrlKey===rKeyObj.ctrlKey&&isShiftKey===rKeyObj.shiftKey&&curkeyCode===rKeyObj.keyCode&&(e.action=key)}}this.keyAction&&this.keyAction(e)},this.bind()}destroy(){this.unwireEvents(),super.destroy()}onPropertyChanged(newProp,oldProp){}bind(){this.wireEvents()}getModuleName(){return"keyboard"}wireEvents(){this.element.addEventListener(this.eventName,this.keyPressHandler)}unwireEvents(){this.element.removeEventListener(this.eventName,this.keyPressHandler)}static getKeyConfigData(config){if(config in this.configCache)return this.configCache[config];let keys=config.toLowerCase().split("+"),keyData={altKey:-1!==keys.indexOf("alt"),ctrlKey:-1!==keys.indexOf("ctrl"),shiftKey:-1!==keys.indexOf("shift"),keyCode:null};return keyData.keyCode=keys[keys.length-1].length>1&&Number(keys[keys.length-1])?Number(keys[keys.length-1]):ej2_richtexteditor_es2015_KeyboardEvents_1.getKeyCode(keys[keys.length-1]),ej2_richtexteditor_es2015_KeyboardEvents_1.configCache[config]=keyData,keyData}static getKeyCode(keyVal){return ej2_richtexteditor_es2015_keyCode[keyVal]||keyVal.toUpperCase().charCodeAt(0)}};return KeyboardEvents$1.configCache={},__decorate([Property({})],KeyboardEvents$1.prototype,"keyConfigs",void 0),__decorate([Property("keyup")],KeyboardEvents$1.prototype,"eventName",void 0),__decorate([ej2_base_es2015_Event()],KeyboardEvents$1.prototype,"keyAction",void 0),ej2_richtexteditor_es2015_KeyboardEvents_1=__decorate([NotifyPropertyChanges],KeyboardEvents$1)})();class ej2_richtexteditor_es2015_ColorPickerInput{constructor(parent,serviceLocator){this.tools={},this.parent=parent,this.locator=serviceLocator,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?extend(this.tools,tools,toObjectLowerCase(this.parent.toolbarSettings.itemConfigs),!0):this.tools=tools}initializeInstance(){this.toolbarRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Toolbar)}renderColorPickerInput(args){this.initializeInstance();let targetID,options,suffixID=args.containerType,tbElement=args.container;templateItems.forEach(item=>{if(-1!==getIndex(item,args.items))switch(item){case"fontcolor":targetID=this.parent.getID()+"_"+suffixID+"_FontColor_Target";let fontNode=this.parent.createElement("input");fontNode.id=targetID,fontNode.classList.add(CLS_FONT_COLOR_TARGET),document.body.appendChild(fontNode),options={cssClass:this.tools[item.toLocaleLowerCase()].icon+" "+CLS_RTE_ELEMENTS+" "+ej2_richtexteditor_es2015_CLS_ICONS,value:this.tools[item.toLocaleLowerCase()].value,command:this.tools[item.toLocaleLowerCase()].command,subCommand:this.tools[item.toLocaleLowerCase()].subCommand,element:ej2_base_es2015_select("#"+this.parent.getID()+"_"+suffixID+"_FontColor",tbElement),target:"#"+targetID},this.fontColorPicker=this.toolbarRenderer.renderColorPicker(options,"fontcolor"),this.fontColorDropDown=this.toolbarRenderer.renderColorPickerDropDown(options,"fontcolor",this.fontColorPicker);break;case"backgroundcolor":targetID=this.parent.getID()+"_"+suffixID+"_BackgroundColor_Target";let backNode=this.parent.createElement("input");backNode.id=targetID,backNode.classList.add(CLS_BACKGROUND_COLOR_TARGET),document.body.appendChild(backNode),options={cssClass:this.tools[item.toLocaleLowerCase()].icon+" "+CLS_RTE_ELEMENTS+" "+ej2_richtexteditor_es2015_CLS_ICONS,value:this.tools[item.toLocaleLowerCase()].value,command:this.tools[item.toLocaleLowerCase()].command,subCommand:this.tools[item.toLocaleLowerCase()].subCommand,element:ej2_base_es2015_select("#"+this.parent.getID()+"_"+suffixID+"_BackgroundColor",tbElement),target:"#"+targetID},this.backgroundColorPicker=this.toolbarRenderer.renderColorPicker(options,"backgroundcolor"),this.backgroundColorDropDown=this.toolbarRenderer.renderColorPickerDropDown(options,"backgroundcolor",this.backgroundColorPicker)}})}destroy(){this.removeEventListener(),this.destroyColorPicker()}destroyColorPicker(){if(this.fontColorPicker&&!this.fontColorPicker.isDestroyed&&this.fontColorPicker.destroy(),this.backgroundColorPicker&&!this.backgroundColorPicker.isDestroyed&&this.backgroundColorPicker.destroy(),this.fontColorDropDown&&!this.fontColorDropDown.isDestroyed){let innerEle=this.fontColorDropDown.element.querySelector(".e-rte-color-content");innerEle&&detach(innerEle),this.fontColorDropDown.destroy()}if(this.backgroundColorDropDown&&!this.backgroundColorDropDown.isDestroyed){let innerEle=this.backgroundColorDropDown.element.querySelector(".e-rte-color-content");innerEle&&detach(innerEle),this.backgroundColorDropDown.destroy()}}setRtl(args){this.fontColorPicker&&(this.fontColorPicker.setProperties({enableRtl:args.enableRtl}),this.fontColorDropDown.setProperties({enableRtl:args.enableRtl})),this.backgroundColorPicker&&(this.backgroundColorPicker.setProperties({enableRtl:args.enableRtl}),this.backgroundColorDropDown.setProperties({enableRtl:args.enableRtl}))}addEventListener(){this.parent.on(toolbarRenderComplete,this.renderColorPickerInput,this),this.parent.on(rtlMode,this.setRtl,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.destroy,this),this.parent.on(destroyColorPicker,this.destroyColorPicker,this),this.parent.on(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged,this)}onPropertyChanged(model){let element,newProp=model.newProp;for(let prop of Object.keys(newProp))switch(prop){case"fontColor":if(this.fontColorPicker)for(let font of Object.keys(newProp.fontColor))switch(font){case"default":this.fontColorPicker.setProperties({value:newProp.fontColor.default}),(element=this.fontColorDropDown.element).querySelector("."+this.tools.fontcolor.icon).style.borderBottomColor=newProp.fontColor.default;break;case"mode":this.fontColorPicker.setProperties({mode:newProp.fontColor.mode});break;case"columns":this.fontColorPicker.setProperties({columns:newProp.fontColor.columns});break;case"colorCode":this.fontColorPicker.setProperties({presetColors:newProp.fontColor.colorCode});break;case"modeSwitcher":this.fontColorPicker.setProperties({modeSwitcher:newProp.fontColor.modeSwitcher})}break;case"backgroundColor":if(this.backgroundColorPicker)for(let background of Object.keys(newProp.backgroundColor))switch(background){case"default":this.backgroundColorPicker.setProperties({value:newProp.backgroundColor.default}),(element=this.backgroundColorDropDown.element).querySelector("."+this.tools.backgroundcolor.icon).style.borderBottomColor=newProp.backgroundColor.default;break;case"mode":this.backgroundColorPicker.setProperties({mode:newProp.backgroundColor.mode});break;case"columns":this.backgroundColorPicker.setProperties({columns:newProp.backgroundColor.columns});break;case"colorCode":this.backgroundColorPicker.setProperties({presetColors:newProp.backgroundColor.colorCode});break;case"modeSwitcher":this.backgroundColorPicker.setProperties({modeSwitcher:newProp.backgroundColor.modeSwitcher})}}}removeEventListener(){this.parent.off(toolbarRenderComplete,this.renderColorPickerInput),this.parent.off(ej2_richtexteditor_es2015_destroy,this.destroy),this.parent.off(rtlMode,this.setRtl),this.parent.off(destroyColorPicker,this.destroyColorPicker),this.parent.off(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged)}}class ej2_richtexteditor_es2015_BaseQuickToolbar{constructor(parent,locator){this.parent=parent,this.locator=locator,this.isDOMElement=!1,this.renderFactory=this.locator.getService("rendererFactory"),this.contentRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Content),this.popupRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Popup),this.dropDownButtons=new ej2_richtexteditor_es2015_DropDownButtons(this.parent,this.locator),this.colorPickerObj=new ej2_richtexteditor_es2015_ColorPickerInput(this.parent,this.locator)}appendPopupContent(){this.toolbarElement=this.parent.createElement("div",{className:CLS_QUICK_TB}),this.element.appendChild(this.toolbarElement)}render(args){let className;className="Image"===args.popupType?CLS_IMAGE_POP:"Inline"===args.popupType?CLS_INLINE_POP:"";let popupId=getUniqueID(args.popupType+"_Quick_Popup");this.stringItems=args.toolbarItems,this.element=this.parent.createElement("div",{id:popupId,className:className+" "+CLS_RTE_ELEMENTS}),this.element.setAttribute("aria-owns",this.parent.getID()),this.appendPopupContent(),this.createToolbar(args.toolbarItems,args.mode),this.popupRenderer.renderPopup(this),this.addEventListener()}createToolbar(items,mode){this.quickTBarObj=new ej2_richtexteditor_es2015_BaseToolbar(this.parent,this.locator),this.quickTBarObj.render({container:"quick",target:this.toolbarElement,items:items,mode:mode}),this.quickTBarObj.toolbarObj.refresh()}setPosition(e){let x,y,imgWrapper=closest(e.target,".e-img-caption"),target=isNullOrUndefined(imgWrapper)?e.target:imgWrapper;addClass([this.toolbarElement],[CLS_RM_WHITE_SPACE]);let targetOffsetTop=target.offsetTop,parentOffsetTop=window.pageYOffset+e.parentData.top;y=targetOffsetTop-e.editTop>e.popHeight?parentOffsetTop+e.tBarElementHeight+(targetOffsetTop-e.editTop)-e.popHeight-5:e.editTop+e.editHeight-(targetOffsetTop+target.offsetHeight)>e.popHeight?parentOffsetTop+e.tBarElementHeight+(targetOffsetTop-e.editTop)+target.offsetHeight+5:e.y,this.popupObj.position.X=(x=target.offsetWidth>e.popWidth?target.offsetWidth/2-e.popWidth/2+e.parentData.left+target.offsetLeft:e.parentData.left+target.offsetLeft)+e.popWidth>e.parentData.right?e.parentData.right-e.popWidth:x,this.popupObj.position.Y=y,this.popupObj.dataBind(),removeClass([this.toolbarElement],[CLS_RM_WHITE_SPACE])}checkCollision(e,viewPort,type){let x,y,parentTop=e.parentData.top,contentTop=e.windowY+parentTop+e.tBarElementHeight,collision=[];collision="document"===viewPort?isCollide(e.popup):isCollide(e.popup,e.parentElement);for(let i=0;i<collision.length;i++)switch(collision[i]){case"top":y="document"===viewPort?e.windowY:window.pageYOffset+parentTop+e.tBarElementHeight;break;case"bottom":let posY;y=posY="document"===viewPort?"inline"===type?e.y-e.popHeight-10:e.windowHeight-(parentTop+e.tBarElementHeight)>e.popHeight?contentTop-e.windowHeight>e.popHeight?contentTop+(e.windowHeight-parentTop)-e.popHeight:contentTop:e.windowY+(parentTop+e.tBarElementHeight):"IMG"!==e.target.tagName?e.parentData.bottom+window.pageYOffset-e.popHeight-10:e.parentData.bottom+window.pageYOffset-e.popHeight-5;break;case"right":x="inline"===type?e.windowWidth-(e.popWidth+e.bodyRightSpace+10):e.x-e.popWidth;break;case"left":x="inline"===type?0:e.parentData.left}this.popupObj.position.X=x||this.popupObj.position.X,this.popupObj.position.Y=y||this.popupObj.position.Y,this.popupObj.dataBind()}showPopup(x,y,target){let eventArgs=isBlazor()?{cancel:!1,targetElement:target}:{popup:this.popupObj,cancel:!1,targetElement:target};this.parent.trigger(beforeQuickToolbarOpen,eventArgs,beforeQuickToolbarArgs=>{if(!beforeQuickToolbarArgs.cancel){let editPanelTop,editPanelHeight,bodyStyle=window.getComputedStyle(document.body),bodyRight=parseFloat(bodyStyle.marginRight.split("px")[0])+parseFloat(bodyStyle.paddingRight.split("px")[0]),windowHeight=window.innerHeight,windowWidth=window.innerWidth,parent=this.parent.element,toolbarAvail=!isNullOrUndefined(this.parent.getToolbar()),tbHeight=toolbarAvail&&this.parent.toolbarModule.getToolbarHeight(),expTBHeight=toolbarAvail&&this.parent.toolbarModule.getExpandTBarPopHeight(),tBarHeight=toolbarAvail?tbHeight+expTBHeight:0;if(addClass([this.element],[CLS_HIDE]),Browser.isDevice&&!isIDevice()&&addClass([this.parent.getToolbar()],[CLS_HIDE]),this.parent.iframeSettings.enable){let cntEle=this.contentRenderer.getPanel().contentWindow;editPanelTop=cntEle.pageYOffset,editPanelHeight=cntEle.innerHeight}else{let cntEle=closest(target,"."+CLS_RTE_CONTENT);editPanelTop=cntEle?cntEle.scrollTop:0,editPanelHeight=cntEle?cntEle.offsetHeight:0}this.parent.inlineMode.enable||closest(target,"table")||(this.parent.disableToolbarItem(this.parent.toolbarSettings.items),this.parent.enableToolbarItem(["Undo","Redo"])),append([this.element],document.body),this.popupObj.position.X=x+20,this.popupObj.position.Y=y+(this.parent.iframeSettings.enable?35:20),this.popupObj.dataBind(),this.popupObj.element.classList.add("e-popup-open"),this.dropDownButtons.renderDropDowns({container:this.toolbarElement,containerType:"quick",items:this.stringItems}),this.colorPickerObj.renderColorPickerInput({container:this.toolbarElement,containerType:"quick",items:this.stringItems});let showPopupData={x:x,y:y,target:target,editTop:editPanelTop,editHeight:editPanelHeight,popup:this.popupObj.element,popHeight:this.popupObj.element.offsetHeight,popWidth:this.popupObj.element.offsetWidth,parentElement:parent,bodyRightSpace:bodyRight,windowY:window.pageYOffset,windowHeight:windowHeight,windowWidth:windowWidth,parentData:parent.getBoundingClientRect(),tBarElementHeight:tBarHeight};"IMG"===target.tagName&&this.setPosition(showPopupData),this.parent.inlineMode.enable||this.checkCollision(showPopupData,"parent",""),this.checkCollision(showPopupData,"document",this.parent.inlineMode.enable?"inline":""),this.popupObj.element.classList.remove("e-popup-open"),removeClass([this.element],[CLS_HIDE]),this.popupObj.show({name:"ZoomIn",duration:Browser.isIE?250:400}),setStyleAttribute(this.element,{maxWidth:this.parent.element.offsetWidth+"px"}),addClass([this.element],[CLS_POP]),this.isDOMElement=!0}})}hidePopup(){let viewSourcePanel=this.parent.sourceCodeModule.getViewPanel();Browser.isDevice&&!isIDevice()&&removeClass([this.parent.getToolbar()],[CLS_HIDE]),isNullOrUndefined(this.parent.getToolbar())||this.parent.inlineMode.enable||(isNullOrUndefined(viewSourcePanel)||"none"===viewSourcePanel.style.display)&&this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.removeEleFromDOM(),this.isDOMElement=!1}addQTBarItem(item,index){this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(item,"toolbar"),index)}removeQTBarItem(index){this.quickTBarObj.toolbarObj.removeItems(index)}removeEleFromDOM(){let element=this.popupObj.element;if(this.isDOMElement){this.dropDownButtons.destroyDropDowns(),this.colorPickerObj.destroyColorPicker(),removeClass([this.element],[CLS_POP]),detach(element);let args=isBlazor()?null:this.popupObj;this.parent.trigger(quickToolbarClose,args)}}updateStatus(args){setToolbarStatus({args:args,dropDownModule:this.dropDownButtons,parent:this.parent,tbElements:ej2_base_es2015_selectAll("."+ej2_richtexteditor_es2015_CLS_TB_ITEM,this.element),tbItems:this.quickTBarObj.toolbarObj.items},!0),ej2_base_es2015_select(".e-rte-srctextarea",this.parent.element)||updateUndoRedoStatus(this.parent.getBaseToolbarObject(),this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())}destroy(){this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),this.removeEleFromDOM()),this.removeEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on(ej2_richtexteditor_es2015_destroy,this.destroy,this),this.parent.on(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged,this),this.parent.inlineMode.enable&&this.parent.on(toolbarUpdated,this.updateStatus,this))}onPropertyChanged(e){if(!isNullOrUndefined(e.newProp.inlineMode))for(let prop of Object.keys(e.newProp.inlineMode))switch(prop){case"enable":e.newProp.inlineMode.enable?this.parent.on(toolbarUpdated,this.updateStatus,this):this.parent.off(toolbarUpdated,this.updateStatus)}}removeEventListener(){this.parent.isDestroyed||(this.parent.off(ej2_richtexteditor_es2015_destroy,this.destroy),this.parent.off(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged),this.parent.inlineMode.enable&&this.parent.off(toolbarUpdated,this.updateStatus))}}class ej2_richtexteditor_es2015_PopupRenderer{constructor(parent){this.parent=parent}quickToolbarOpen(){let args=isBlazor()?null:this.popupObj;this.parent.trigger(quickToolbarOpen,args)}renderPopup(args){this.setPanel(args.element),this.renderPanel(),args.popupObj=new ej2_popups_es2015_Popup(args.element,{targetType:"relative",relateTo:this.parent.element,open:this.quickToolbarOpen.bind(this)}),this.popupObj=args.popupObj,args.popupObj.hide()}renderPanel(){this.getPanel().classList.add(CLS_QUICK_POP)}getPanel(){return this.popupPanel}setPanel(panel){this.popupPanel=panel}}class ej2_richtexteditor_es2015_QuickToolbar{constructor(parent,locator){this.parent=parent,this.locator=locator,this.renderFactory=this.locator.getService("rendererFactory"),this.renderFactory.addRenderer(ej2_richtexteditor_es2015_RenderType.Popup,new ej2_richtexteditor_es2015_PopupRenderer(this.parent)),this.addEventListener()}formatItems(items){let formattedItems=[];return items.forEach(item=>{if("string"==typeof item)switch(item.toLocaleLowerCase()){case"open":formattedItems.push("openLink");break;case"edit":formattedItems.push("editLink");break;case"unlink":formattedItems.push("removeLink");break;default:formattedItems.push(item)}else formattedItems.push(item)}),formattedItems}getQTBarOptions(popType,mode,items,type){return{popupType:popType,toolbarItems:items,mode:mode,renderType:type}}createQTBar(popupType,mode,items,type){if(items.length<1)return null;let qTBar=new ej2_richtexteditor_es2015_BaseQuickToolbar(this.parent,this.locator);return qTBar.render(this.getQTBarOptions(popupType,mode,this.formatItems(items),type)),qTBar}initializeQuickToolbars(){this.parent.quickToolbarModule=this,this.contentRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Content),this.parent.inlineMode.enable&&this.parent.inlineMode.onSelection&&isIDevice()&&EventHandler.add(this.contentRenderer.getDocument(),"selectionchange",this.selectionChangeHandler,this)}onMouseDown(e){this.parent.isBlur=!1,this.parent.isRTE=!0}renderQuickToolbars(){this.linkQTBar||this.imageQTBar||this.textQTBar||this.tableQTBar||(this.linkQTBar=this.createQTBar("Link","Scrollable",this.parent.quickToolbarSettings.link,ej2_richtexteditor_es2015_RenderType.LinkToolbar),this.renderFactory.addRenderer(ej2_richtexteditor_es2015_RenderType.LinkToolbar,this.linkQTBar),this.textQTBar=this.createQTBar("Text","Scrollable",this.parent.quickToolbarSettings.text,ej2_richtexteditor_es2015_RenderType.TextToolbar),this.renderFactory.addRenderer(ej2_richtexteditor_es2015_RenderType.TextToolbar,this.textQTBar),this.imageQTBar=this.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,ej2_richtexteditor_es2015_RenderType.ImageToolbar),this.renderFactory.addRenderer(ej2_richtexteditor_es2015_RenderType.ImageToolbar,this.imageQTBar),this.tableQTBar=this.createQTBar("Table","MultiRow",this.parent.quickToolbarSettings.table,ej2_richtexteditor_es2015_RenderType.TableToolbar),this.renderFactory.addRenderer(ej2_richtexteditor_es2015_RenderType.TableToolbar,this.tableQTBar),this.linkQTBar&&EventHandler.add(this.linkQTBar.element,"mousedown",this.onMouseDown,this),this.imageQTBar&&EventHandler.add(this.imageQTBar.element,"mousedown",this.onMouseDown,this),this.textQTBar&&EventHandler.add(this.textQTBar.element,"mousedown",this.onMouseDown,this),this.tableQTBar&&EventHandler.add(this.tableQTBar.element,"mousedown",this.onMouseDown,this))}renderInlineQuickToolbar(){!this.parent.inlineMode.enable||Browser.isDevice&&!isIDevice()||(addClass([this.parent.element],[CLS_INLINE]),this.inlineQTBar=this.createQTBar("Inline","MultiRow",this.parent.toolbarSettings.items,ej2_richtexteditor_es2015_RenderType.InlineToolbar),this.renderFactory.addRenderer(ej2_richtexteditor_es2015_RenderType.InlineToolbar,this.inlineQTBar),EventHandler.add(this.inlineQTBar.element,"mousedown",this.onMouseDown,this))}showInlineQTBar(x,y,target){this.inlineQTBar.showPopup(x,y,target)}hideInlineQTBar(){this.inlineQTBar&&!hasClass(this.inlineQTBar.element,"e-popup-close")&&this.inlineQTBar.hidePopup()}hideQuickToolbars(){this.linkQTBar&&!hasClass(this.linkQTBar.element,"e-popup-close")&&document.body.contains(this.linkQTBar.element)&&this.linkQTBar.hidePopup(),this.textQTBar&&!hasClass(this.textQTBar.element,"e-popup-close")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup(),this.imageQTBar&&!hasClass(this.imageQTBar.element,"e-popup-close")&&document.body.contains(this.imageQTBar.element)&&this.imageQTBar.hidePopup(),this.tableQTBar&&!hasClass(this.tableQTBar.element,"e-popup-close")&&document.body.contains(this.tableQTBar.element)&&this.tableQTBar.hidePopup(),!this.parent.inlineMode.enable||Browser.isDevice&&!isIDevice()||this.hideInlineQTBar()}deBounce(x,y,target){clearTimeout(this.deBouncer),this.deBouncer=window.setTimeout(()=>{this.showInlineQTBar(x,y,target)},1e3)}mouseUpHandler(e){if(this.parent.inlineMode.enable&&(!Browser.isDevice||isIDevice())){let coordinates;coordinates=e.args.touches?e.args.changedTouches[0]:e.args;let range=this.parent.getRange(),target=e.args.target;if(isNullOrUndefined(ej2_base_es2015_select("."+CLS_INLINE_POP,document.body))){if(isIDevice()&&e.touchData&&e.touchData.prevClientX!==e.touchData.clientX&&e.touchData.prevClientY!==e.touchData.clientY)return;if(this.hideInlineQTBar(),this.offsetX=coordinates.pageX,this.offsetY=function(e,parentElement,isIFrame){return isIFrame?window.pageYOffset+parentElement.getBoundingClientRect().top+e.clientY:e.pageY}(coordinates,this.parent.element,this.parent.iframeSettings.enable),"TEXTAREA"===target.nodeName)this.showInlineQTBar(this.offsetX,this.offsetY,target);else if(!("IMG"===(target=closest(target,"a")||target).tagName||"A"===target.tagName||closest(target,"td,th")&&range.collapsed)){if(this.parent.inlineMode.onSelection&&range.collapsed)return;this.target=target,this.showInlineQTBar(this.offsetX,this.offsetY,target)}}}}keyDownHandler(){!this.parent.inlineMode.enable||Browser.isDevice&&!isIDevice()||isNullOrUndefined(ej2_base_es2015_select("."+CLS_INLINE_POP,document))||this.hideInlineQTBar()}inlineQTBarMouseDownHandler(){!this.parent.inlineMode.enable||Browser.isDevice&&!isIDevice()||isNullOrUndefined(ej2_base_es2015_select("."+CLS_INLINE_POP,document))||this.hideInlineQTBar()}keyUpHandler(e){if(this.parent.inlineMode.enable&&!Browser.isDevice){if(this.parent.inlineMode.onSelection)return;this.deBounce(this.offsetX,this.offsetY,e.args.target)}}selectionChangeHandler(e){clearTimeout(this.deBouncer),this.deBouncer=window.setTimeout(()=>{this.onSelectionChange(e)},1e3)}onSelectionChange(e){isNullOrUndefined(ej2_base_es2015_select("."+CLS_INLINE_POP,document.body))&&(this.contentRenderer.getDocument().getSelection().isCollapsed||this.mouseUpHandler({args:e}))}getInlineBaseToolbar(){return this.inlineQTBar&&this.inlineQTBar.quickTBarObj}destroy(){this.linkQTBar&&(EventHandler.remove(this.linkQTBar.element,"mousedown",this.onMouseDown),this.linkQTBar.destroy()),this.textQTBar&&(EventHandler.remove(this.textQTBar.element,"mousedown",this.onMouseDown),this.textQTBar.destroy()),this.imageQTBar&&(EventHandler.remove(this.imageQTBar.element,"mousedown",this.onMouseDown),this.imageQTBar.destroy()),this.tableQTBar&&(EventHandler.remove(this.tableQTBar.element,"mousedown",this.onMouseDown),this.tableQTBar.destroy()),this.inlineQTBar&&(EventHandler.remove(this.inlineQTBar.element,"mousedown",this.onMouseDown),isIDevice()&&EventHandler.remove(document,"selectionchange",this.selectionChangeHandler),this.inlineQTBar.destroy()),this.removeEventListener()}wireInlineQTBarEvents(){this.parent.on(ej2_richtexteditor_es2015_mouseUp,this.mouseUpHandler,this),this.parent.on(ej2_richtexteditor_es2015_mouseDown,this.inlineQTBarMouseDownHandler,this),this.parent.on(keyDown,this.keyDownHandler,this),this.parent.on(keyUp,this.keyUpHandler,this),this.parent.on(sourceCodeMouseDown,this.mouseUpHandler,this),this.parent.on(renderInlineToolbar,this.renderInlineQuickToolbar,this)}unWireInlineQTBarEvents(){this.parent.off(ej2_richtexteditor_es2015_mouseUp,this.mouseUpHandler),this.parent.off(ej2_richtexteditor_es2015_mouseDown,this.inlineQTBarMouseDownHandler),this.parent.off(keyDown,this.keyDownHandler),this.parent.off(keyUp,this.keyUpHandler),this.parent.off(sourceCodeMouseDown,this.mouseUpHandler),this.parent.off(renderInlineToolbar,this.renderInlineQuickToolbar)}toolbarUpdated(args){this.linkQTBar&&!hasClass(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup(),this.imageQTBar&&!hasClass(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup(),this.tableQTBar&&!hasClass(this.tableQTBar.element,"e-popup-close")&&this.tableQTBar.hidePopup()}addEventListener(){this.parent.isDestroyed||(this.parent.on(ej2_richtexteditor_es2015_initialEnd,this.initializeQuickToolbars,this),this.parent.on(ej2_richtexteditor_es2015_mouseDown,this.renderQuickToolbars,this),this.parent.on(toolbarUpdated,this.toolbarUpdated,this),this.wireInlineQTBarEvents(),this.parent.on(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged,this),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&this.parent.on(ej2_richtexteditor_es2015_scroll,this.hideQuickToolbars,this),this.parent.on(focusChange,this.hideQuickToolbars,this),this.parent.on(iframeMouseDown,this.onIframeMouseDown,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.destroy,this),this.parent.on(keyDown,this.onKeyDown,this),this.parent.on(rtlMode,this.setRtl,this))}onKeyDown(e){let args=e.args;8!==args.which&&46!==args.which||this.imageQTBar&&!hasClass(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup()}onIframeMouseDown(){this.hideQuickToolbars(),this.hideInlineQTBar()}setRtl(args){this.inlineQTBar&&this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:args.enableRtl}),this.imageQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:args.enableRtl}),this.linkQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:args.enableRtl})}removeEventListener(){this.parent.isDestroyed||(this.parent.off(ej2_richtexteditor_es2015_initialEnd,this.initializeQuickToolbars),this.parent.off(ej2_richtexteditor_es2015_mouseDown,this.renderQuickToolbars),this.parent.off(toolbarUpdated,this.toolbarUpdated),this.unWireInlineQTBarEvents(),this.parent.off(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&this.parent.off(ej2_richtexteditor_es2015_scroll,this.hideQuickToolbars),this.parent.off(focusChange,this.hideQuickToolbars),this.parent.off(ej2_richtexteditor_es2015_destroy,this.destroy),this.parent.off(iframeMouseDown,this.onIframeMouseDown),this.parent.off(keyDown,this.onKeyDown),this.parent.off(rtlMode,this.setRtl))}onPropertyChanged(e){if(!isNullOrUndefined(e.newProp.quickToolbarSettings))for(let prop of Object.keys(e.newProp.quickToolbarSettings))switch(prop){case"actionOnScroll":"none"===e.newProp.quickToolbarSettings.actionOnScroll?this.parent.off(ej2_richtexteditor_es2015_scroll,this.hideQuickToolbars):this.parent.on(ej2_richtexteditor_es2015_scroll,this.hideQuickToolbars,this)}e.module===this.getModuleName()&&(this.inlineQTBar&&(removeClass([this.parent.element],[CLS_INLINE]),this.unWireInlineQTBarEvents(),this.hideInlineQTBar()),!this.parent.inlineMode.enable||Browser.isDevice&&!isIDevice()||(addClass([this.parent.element],[CLS_INLINE]),this.wireInlineQTBarEvents()))}getModuleName(){return"quickToolbar"}}class ej2_richtexteditor_es2015_Count{constructor(parent,serviceLocator){this.parent=parent,this.locator=serviceLocator,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener()}initializeInstance(){this.contentRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Content),this.editPanel=this.contentRenderer.getEditPanel()}renderCount(){this.initializeInstance(),this.element=this.parent.createElement("span",{className:CLS_COUNT}),this.contentRenderer.getPanel().parentElement.appendChild(this.element),this.appendCount(),-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength)}appendCount(){let htmlText="Markdown"===this.parent.editorMode?this.editPanel.value.trim():this.editPanel.textContent.trim();this.htmlLength=htmlText.length,this.element.innerHTML=-1===this.parent.maxLength?this.htmlLength:this.htmlLength+" / "+this.parent.maxLength}charCountBackground(htmlLength){let percentage=htmlLength/this.parent.maxLength*100;percentage<85?(this.element.classList.remove(CLS_WARNING),this.element.classList.remove(CLS_ERROR)):percentage>85&&percentage<=90?(this.element.classList.remove(CLS_ERROR),this.element.classList.add(CLS_WARNING)):percentage>90&&(this.element.classList.remove(CLS_WARNING),this.element.classList.add(CLS_ERROR))}refresh(){isNullOrUndefined(this.editPanel)||(this.appendCount(),-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength))}destroy(){this.removeEventListener()}toggle(e){this.element.style.display="viewSource"===e.member?"none":"block"}addEventListener(){this.parent.isDestroyed||this.parent.showCharCount&&(this.parent.on(ej2_richtexteditor_es2015_initialEnd,this.renderCount,this),this.parent.on(keyUp,this.refresh,this),this.parent.on(ej2_richtexteditor_es2015_count,this.refresh,this),this.parent.on(refreshBegin,this.refresh,this),this.parent.on(ej2_richtexteditor_es2015_mouseDown,this.refresh,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.destroy,this),this.parent.on(sourceCode,this.toggle,this),this.parent.on(updateSource,this.toggle,this))}removeEventListener(){this.parent.isDestroyed||(this.element&&detach(this.element),this.parent.off(ej2_richtexteditor_es2015_initialEnd,this.renderCount),this.parent.off(keyUp,this.refresh),this.parent.off(refreshBegin,this.refresh),this.parent.off(ej2_richtexteditor_es2015_count,this.refresh),this.parent.off(ej2_richtexteditor_es2015_mouseDown,this.refresh),this.parent.off(ej2_richtexteditor_es2015_destroy,this.destroy),this.parent.off(sourceCode,this.toggle),this.parent.off(updateSource,this.toggle))}getModuleName(){return"count"}}class ExecCommandCallBack{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.on(execCommandCallBack,this.commandCallBack,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.removeEventListener,this)}commandCallBack(args){"Undo"!==args.requestType&&"Redo"!==args.requestType&&this.parent.formatter.saveData(),this.parent.notify(ej2_richtexteditor_es2015_toolbarRefresh,{args:args}),this.parent.notify(ej2_richtexteditor_es2015_count,{})}removeEventListener(){this.parent.off(execCommandCallBack,this.commandCallBack),this.parent.off(ej2_richtexteditor_es2015_destroy,this.removeEventListener)}}const KEY_DOWN="keydown",ACTION="action",FORMAT_TYPE="format-type",KEY_DOWN_HANDLER="keydown-handler",LIST_TYPE="list-type",KEY_UP_HANDLER="keyup-handler",KEY_UP="keyup",MODEL_CHANGED_PLUGIN="model_changed_plugin",MODEL_CHANGED="model_changed",MS_WORD_CLEANUP_PLUGIN="ms_word_cleanup_plugin",MS_WORD_CLEANUP="ms_word_cleanup";class ej2_richtexteditor_es2015_Formatter{process(self,args,event,value){let saveSelection,selection=self.contentModule.getDocument().getSelection(),range=selection.rangeCount>0?selection.getRangeAt(selection.rangeCount-1):null;if("HTML"===self.editorMode&&(saveSelection=this.editorManager.nodeSelection.save(range,self.contentModule.getDocument())),isNullOrUndefined(args)||!args.item.command||"Table"===args.item.command||"Actions"===args.item.command||"Links"===args.item.command||"Images"===args.item.command||!range||self.contentModule.getEditPanel().contains(this.getAncestorNode(range.commonAncestorContainer))||self.contentModule.getEditPanel()===range.commonAncestorContainer||self.contentModule.getPanel()===range.commonAncestorContainer){if(isNullOrUndefined(args)){let action=event.action;"tab"!==action&&"enter"!==action&&"space"!==action&&"escape"!==action&&(args={},"Markdown"===self.editorMode&&"insert-table"===action&&(value={headingText:self.localeObj.getConstant("TableHeadingText"),colText:self.localeObj.getConstant("TableColText")}),extend(args,args,{originalEvent:event,cancel:!1,requestType:action||event.key+"Key",itemCollection:value},!0),isBlazor()&&(delete args.item,delete args.itemCollection),self.trigger(ej2_richtexteditor_es2015_actionBegin,args,actionBeginArgs=>{actionBeginArgs.cancel&&("paste"!==action&&"cut"!==action&&"copy"!==action||event.preventDefault())})),(9===event.which&&self.tableModule&&self.tableModule.ensureInsideTableList||9!==event.which)&&this.editorManager.observer.notify("keydown"===event.type?KEY_DOWN:KEY_UP,{event:event,callBack:this.onSuccess.bind(this,self),value:value})}else!isNullOrUndefined(args)&&args.item.command&&args.item.subCommand&&(args.item.command!==args.item.subCommand&&"Font"!==args.item.command||("FontName"===args.item.subCommand||"FontSize"===args.item.subCommand)&&"dropDownSelect"===args.name||("BackgroundColor"===args.item.subCommand||"FontColor"===args.item.subCommand)&&"colorPickerChanged"===args.name)&&(extend(args,args,{requestType:args.item.subCommand,cancel:!1,itemCollection:value},!0),self.trigger(ej2_richtexteditor_es2015_actionBegin,args,actionBeginArgs=>{if(!actionBeginArgs.cancel){0===this.getUndoRedoStack().length&&"Links"!==actionBeginArgs.item.command&&"Images"!==actionBeginArgs.item.command&&this.saveData(),self.isBlur=!1,self.contentModule.getEditPanel().focus(),"HTML"===self.editorMode&&saveSelection.restore();let command=actionBeginArgs.item.subCommand.toLocaleLowerCase();"paste"===command||"cut"===command||"copy"===command?self.clipboardAction(command,event):(this.editorManager.observer.notify(checkUndo,{subCommand:actionBeginArgs.item.subCommand}),this.editorManager.execCommand(actionBeginArgs.item.command,actionBeginArgs.item.subCommand,event,this.onSuccess.bind(this,self),actionBeginArgs.item.value,value,"#"+self.getID()+" iframe"))}}));(isNullOrUndefined(event)||event&&"copy"!==event.action)&&this.enableUndo(self)}}getAncestorNode(node){return 3===node.nodeType?node.parentNode:node}onKeyHandler(self,e){this.editorManager.observer.notify(KEY_UP,{event:e,callBack:()=>{this.enableUndo(self)}})}onSuccess(self,events){(isNullOrUndefined(events.event)||events&&"copy"!==events.event.action)&&(this.enableUndo(self),self.notify(execCommandCallBack,events)),isBlazor()&&delete events.elements,self.trigger(ej2_richtexteditor_es2015_actionComplete,events,callbackArgs=>{if(self.setPlaceHolder(),"Images"===callbackArgs.requestType||"Links"===callbackArgs.requestType&&"HTML"===self.editorMode){if("Links"===callbackArgs.requestType&&callbackArgs.event&&"keydown"===callbackArgs.event.type&&32===callbackArgs.event.keyCode)return;self.notify(insertCompleted,{args:callbackArgs.event,type:callbackArgs.requestType,isNotify:!0,elements:callbackArgs.elements})}self.autoResize()})}saveData(e){this.editorManager.undoRedoManager.saveData(e)}getUndoStatus(){return this.editorManager.undoRedoManager.getUndoStatus()}getUndoRedoStack(){return this.editorManager.undoRedoManager.undoRedoStack}enableUndo(self){let status=this.getUndoStatus();!self.inlineMode.enable||Browser.isDevice&&!isIDevice()?self.toolbarModule&&(updateUndoRedoStatus(self.toolbarModule.baseToolbar,status),self.trigger(toolbarStatusUpdate,status)):(updateUndoRedoStatus(self.quickToolbarModule.inlineQTBar.quickTBarObj,status),self.trigger(toolbarStatusUpdate,status))}}const htmlKeyConfig={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",underline:"ctrl+u",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=",indents:"ctrl+]",outdents:"ctrl+[","html-source":"ctrl+shift+h","full-screen":"ctrl+shift+f","decrease-fontsize":"ctrl+shift+<","increase-fontsize":"ctrl+shift+>","justify-center":"ctrl+e","justify-full":"ctrl+j","justify-left":"ctrl+l","justify-right":"ctrl+r","clear-format":"ctrl+shift+r","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o",space:"32",enter:"13",tab:"tab",delete:"46"},selfClosingTags=["BR","IMG"],ej2_richtexteditor_es2015_IMAGE="INSERT-IMAGE",TABLE="INSERT-TABLE",ej2_richtexteditor_es2015_LINK="INSERT-LINK",INSERT_ROW="INSERT-ROW",INSERT_COLUMN="INSERT-COLUMN",DELETEROW="DELETE-ROW",DELETECOLUMN="DELETE-COLUMN",REMOVETABLE="REMOVE-TABLE",TABLEHEADER="TABLE-HEADER",TABLE_VERTICAL_ALIGN="TABLE_VERTICAL_ALIGN",ALIGNMENT_TYPE="alignment-type",INDENT_TYPE="indent-type",DEFAULT_TAG="p",BLOCK_TAGS=["address","article","aside","audio","blockquote","canvas","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video"],IGNORE_BLOCK_TAGS=["td","th"],TABLE_BLOCK_TAGS=["table","tbody","td","tfoot","th","thead","tr"],SELECTION_TYPE="selection-type",INSERTHTML_TYPE="inserthtml-type",INSERT_TEXT_TYPE="insert-text-type",CLEAR_TYPE="clear-type";class NodeSelection{constructor(){this.startNodeName=[],this.endNodeName=[]}saveInstance(range,body){return this.range=range.cloneRange(),this.rootNode=this.documentFromRange(range),this.body=body,this.startContainer=this.getNodeArray(range.startContainer,!0),this.endContainer=this.getNodeArray(range.endContainer,!1),this.startOffset=range.startOffset,this.endOffset=range.endOffset,this.html=this.body.innerHTML,this}documentFromRange(range){return 9===range.startContainer.nodeType?range.startContainer:range.startContainer.ownerDocument}getRange(docElement){let select$$1=this.get(docElement),range=select$$1&&select$$1.rangeCount>0?select$$1.getRangeAt(select$$1.rangeCount-1):docElement.createRange();return range.startContainer!==docElement||range.endContainer!==docElement||range.startOffset||range.endOffset||(range.setStart(docElement.body,0),range.collapse(!0)),range}get(docElement){return docElement.defaultView.getSelection()}save(range,docElement){return range=range?range.cloneRange():this.getRange(docElement),this.saveInstance(range,docElement.body)}getIndex(node){let index,num=0;if(node=node.previousSibling||"BR"!==node.tagName?node.previousSibling:node)for(let type=node.nodeType;node;null)num++,type=index=node.nodeType,node=node.previousSibling;return num}isChildNode(nodeCollection,parentNode){for(let index=0;index<parentNode.childNodes.length;index++)if(nodeCollection.indexOf(parentNode.childNodes[index])>-1)return!0;return!1}getNode(startNode,endNode,nodeCollection){return endNode!==startNode||3!==startNode.nodeType&&startNode.firstChild&&-1===nodeCollection.indexOf(startNode.firstChild)&&!this.isChildNode(nodeCollection,startNode)?-1===nodeCollection.indexOf(startNode.firstChild)&&startNode.firstChild&&!this.isChildNode(nodeCollection,startNode)?startNode.firstChild:startNode.nextSibling?startNode.nextSibling:startNode.parentNode?startNode.parentNode:null:null}getNodeCollection(range){let startNode=range.startContainer.childNodes[range.startOffset]||range.startContainer,endNode=range.endContainer.childNodes[range.endOffset>0?range.endOffset-1:range.endOffset]||range.endContainer;if(startNode===endNode&&0===startNode.childNodes.length)return[startNode];let nodeCollection=[];do{-1===nodeCollection.indexOf(startNode)&&nodeCollection.push(startNode),startNode=this.getNode(startNode,endNode,nodeCollection)}while(startNode);return nodeCollection}getParentNodeCollection(range){return this.getParentNodes(this.getNodeCollection(range),range)}getParentNodes(nodeCollection,range){nodeCollection=nodeCollection.reverse();for(let index=0;index<nodeCollection.length;index++)-1!==nodeCollection.indexOf(nodeCollection[index].parentNode)||3===nodeCollection[index].nodeType&&range.startContainer!==range.endContainer&&range.startContainer.parentNode!==range.endContainer.parentNode?(nodeCollection.splice(index,1),index--):3===nodeCollection[index].nodeType&&(nodeCollection[index]=nodeCollection[index].parentNode);return nodeCollection}getSelectionNodeCollection(range){return this.getSelectionNodes(this.getNodeCollection(range))}getSelectionNodes(nodeCollection){nodeCollection=nodeCollection.reverse();for(let index=0;index<nodeCollection.length;index++)3===nodeCollection[index].nodeType&&""!==nodeCollection[index].textContent.trim()||(nodeCollection.splice(index,1),index--);return nodeCollection.reverse()}getInsertNodeCollection(range){return this.getInsertNodes(this.getNodeCollection(range))}getInsertNodes(nodeCollection){nodeCollection=nodeCollection.reverse();for(let index=0;index<nodeCollection.length;index++)(0!==nodeCollection[index].childNodes.length&&3!==nodeCollection[index].nodeType||3===nodeCollection[index].nodeType&&""===nodeCollection[index].textContent)&&(nodeCollection.splice(index,1),index--);return nodeCollection.reverse()}getNodeArray(node,isStart,root){let array=[];for(isStart?this.startNodeName=[]:this.endNodeName=[];node!==(root||this.rootNode);null)isStart?this.startNodeName.push(node.nodeName.toLowerCase()):this.endNodeName.push(node.nodeName.toLowerCase()),array.push(this.getIndex(node)),node=node.parentNode;return array}setRangePoint(range,isvalid,num,size){let node=this.rootNode,index=num.length,constant=size;for(;index--;null)node=node&&node.childNodes[num[index]];return node&&constant>=0&&range[isvalid?"setStart":"setEnd"](node,constant),range}restore(){let range=this.range.cloneRange();return range=this.setRangePoint(range,!0,this.startContainer,this.startOffset),range=this.setRangePoint(range,!1,this.endContainer,this.endOffset),this.selectRange(this.rootNode,range),range}selectRange(docElement,range){this.setRange(docElement,range),this.save(range,docElement)}setRange(docElement,range){let selection=this.get(docElement);selection.removeAllRanges(),selection.addRange(range)}setSelectionText(docElement,startNode,endNode,startIndex,endIndex){let range=docElement.createRange();range.setStart(startNode,startIndex),range.setEnd(endNode,endIndex),this.setRange(docElement,range)}setSelectionContents(docElement,element){let range=docElement.createRange();range.selectNode(element),this.setRange(docElement,range)}setSelectionNode(docElement,element){let range=docElement.createRange();range.selectNodeContents(element),this.setRange(docElement,range)}getSelectedNodes(docElement){return this.getNodeCollection(this.getRange(docElement))}Clear(docElement){this.get(docElement).removeAllRanges()}insertParentNode(docElement,newNode,range){range.surroundContents(newNode),this.selectRange(docElement,range)}setCursorPoint(docElement,element,point){let range=docElement.createRange(),selection=docElement.defaultView.getSelection();range.setStart(element,point),range.collapse(!0),selection.removeAllRanges(),selection.addRange(range)}}const markerClassName={startSelection:"e-editor-select-start",endSelection:"e-editor-select-end"};class ej2_richtexteditor_es2015_DOMNode{constructor(parent,currentDocument){this.parent=parent,this.nodeSelection=new NodeSelection,this.currentDocument=currentDocument}contents(element){return element&&"IFRAME"!==element.tagName?Array.prototype.slice.call(element.childNodes||[]):[]}isBlockNode(element){return!!element&&element.nodeType===Node.ELEMENT_NODE&&BLOCK_TAGS.indexOf(element.tagName.toLowerCase())>=0}isLink(element){return!!element&&element.nodeType===Node.ELEMENT_NODE&&"a"===element.tagName.toLowerCase()}blockParentNode(element){for(;element&&element.parentNode!==this.parent&&(!element.parentNode||!this.hasClass(element.parentNode,"e-node-inner"));null)if(this.isBlockNode(element=element.parentNode))return element;return element}rawAttributes(element){let rawAttr={},attributes$$1=element.attributes;if(attributes$$1.length>0)for(let d=0;d<attributes$$1.length;d++){let e=attributes$$1[d];rawAttr[e.nodeName]=e.value}return rawAttr}attributes(element){if(!element)return"";let attr="",rawAttr=this.rawAttributes(element),orderRawAttr=Object.keys(rawAttr).sort();for(let e=0;e<orderRawAttr.length;e++){let attrKey=orderRawAttr[e],attrValue=rawAttr[attrKey];attrValue.indexOf("'")<0&&attrValue.indexOf('"')>=0?attr+=" "+attrKey+"='"+attrValue+"'":attrValue.indexOf('"')>=0&&attrValue.indexOf("'")>=0?attr+=" "+attrKey+'="'+(attrValue=attrValue.replace(/"/g,"&quot;"))+'"':attr+=" "+attrKey+'="'+attrValue+'"'}return attr}clearAttributes(element){for(let attr=element.attributes,c=attr.length-1;c>=0;c--)element.removeAttribute(attr[c].nodeName)}openTagString(element){return"<"+element.tagName.toLowerCase()+this.attributes(element)+">"}closeTagString(element){return"</"+element.tagName.toLowerCase()+">"}createTagString(tagName,relativeElement,innerHTML){return"<"+tagName.toLowerCase()+this.attributes(relativeElement)+">"+innerHTML+"</"+tagName.toLowerCase()+">"}isList(element){return!!element&&["UL","OL"].indexOf(element.tagName)>=0}isElement(element){return element===this.parent}isEditable(element){return(!element.getAttribute||"true"===element.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(element.tagName)<0}hasClass(element,className){return element&&element.classList&&element.classList.contains(className)}replaceWith(element,value){element.parentNode.insertBefore(this.parseHTMLFragment(value),element),detach(element)}parseHTMLFragment(value){let temp=ej2_base_es2015_createElement("template");return temp.innerHTML=value,temp.content instanceof DocumentFragment?temp.content:document.createRange().createContextualFragment(value)}wrap(element,wrapper){return element.parentNode.insertBefore(wrapper,element),(wrapper=element.previousSibling).appendChild(element),wrapper}insertAfter(newNode,referenceNode){referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling)}wrapInner(parent,wrapper){for(parent.appendChild(wrapper),(wrapper=parent.querySelector(".e-rte-wrap-inner")).classList.remove("e-rte-wrap-inner"),0===wrapper.classList.length&&wrapper.removeAttribute("class");parent.firstChild!==wrapper;)wrapper.appendChild(parent.firstChild);return wrapper}unWrap(element){let parent=element.parentNode,unWrapNode=[];for(;element.firstChild;)unWrapNode.push(element.firstChild),parent.insertBefore(element.firstChild,element);return unWrapNode=unWrapNode.length>0?unWrapNode:[element.parentNode],parent.removeChild(element),unWrapNode}getSelectedNode(element,index){return element.nodeType===Node.ELEMENT_NODE&&element.childNodes.length>0&&element.childNodes[index-1]&&element.childNodes[index-1].nodeType===Node.ELEMENT_NODE&&(element.childNodes[index-1].classList.contains(markerClassName.startSelection)||element.childNodes[index-1].classList.contains(markerClassName.endSelection))?element=element.childNodes[index-1]:element.nodeType===Node.ELEMENT_NODE&&element.childNodes.length>0&&element.childNodes[index]&&(element=element.childNodes[index]),element.nodeType===Node.TEXT_NODE&&(element=element.parentNode),element}nodeFinds(element,elements){let existNodes=[];for(let i=0;i<elements.length;i++)element.contains(elements[i])&&element!==elements[i]&&existNodes.push(elements[i]);return existNodes}isEditorArea(){let element;for(element=this.getRangePoint(0).commonAncestorContainer;element&&!this.isElement(element);null)element=element.parentNode;return!!this.isElement(element)}getRangePoint(point){let selection=this.getSelection(),ranges=[];if(selection&&selection.getRangeAt&&selection.rangeCount){ranges=[];for(let f=0;f<selection.rangeCount;f++)ranges.push(selection.getRangeAt(f))}else ranges=[this.currentDocument.createRange()];return void 0!==point?ranges[point]:ranges}getSelection(){return this.nodeSelection.get(this.currentDocument)}getPreviousNode(element){for(element=element.previousElementSibling;element&&"\n"===element.textContent;null)element=element.previousElementSibling;return element}encode(value){let divNode=document.createElement("div");return divNode.innerText=value,divNode.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")}saveMarker(save,action){let startTextNode,endTextNode,start=this.parent.querySelector("."+markerClassName.startSelection),end=this.parent.querySelector("."+markerClassName.endSelection);if(""===start.textContent&&isNullOrUndefined(end)&&"tab"!==action&&(start.innerHTML=1===start.childNodes.length&&"BR"===start.childNodes[0].nodeName?"&#65279;&#65279;<br>":"&#65279;&#65279;"),this.hasClass(start,markerClassName.startSelection)&&start.classList.length>1){let replace=this.createTagString(DEFAULT_TAG,start,this.encode(start.textContent));this.replaceWith(start,replace),(start=this.parent.querySelector("."+markerClassName.startSelection)).classList.remove(markerClassName.startSelection),startTextNode=start.childNodes[0]}else startTextNode=this.unWrap(start)[0];if(this.hasClass(end,markerClassName.endSelection)&&end.classList.length>1){let replace=this.createTagString(DEFAULT_TAG,end,this.encode(end.textContent));this.replaceWith(end,replace),(end=this.parent.querySelector("."+markerClassName.endSelection)).classList.remove(markerClassName.endSelection),endTextNode=end.childNodes[0]}else endTextNode=end?this.unWrap(end)[0]:startTextNode;return save.startContainer=save.getNodeArray(startTextNode,!0),save.endContainer=save.getNodeArray(endTextNode,!1),save}marker(className,textContent){return'<span class="'+className+'">'+textContent+"</span>"}setMarker(save){let range=save.range,start=range.startContainer.childNodes[range.startOffset]||range.startContainer,end=range.endContainer.childNodes[range.endOffset>0?range.endOffset-1:range.endOffset]||range.endContainer;if(start.nodeType===Node.ELEMENT_NODE&&end.nodeType===Node.ELEMENT_NODE&&(start.contains(end)||end.contains(start))){let existNode=start.contains(end)?start:end;if(existNode.nodeType!==Node.TEXT_NODE){let nodes=[],textNodes=[];for(let node=existNode;existNode.contains(node);null)nodes.indexOf(node)<0&&node.childNodes&&node.childNodes.length?(nodes.push(node),node=node.childNodes[0]):node.nextSibling?node=node.nextSibling:node.parentNode&&nodes.push(node=node.parentNode),textNodes.indexOf(node)<0&&(node.nodeType===Node.TEXT_NODE||IGNORE_BLOCK_TAGS.indexOf(node.parentNode.tagName.toLocaleLowerCase())>=0&&"BR"===node.tagName)&&textNodes.push(node);textNodes.length&&(start=start.contains(end)?textNodes[0]:start,end=textNodes[textNodes.length-1])}}start!==end?(start.nodeType!==Node.TEXT_NODE&&"BR"===start.tagName&&IGNORE_BLOCK_TAGS.indexOf(start.parentNode.tagName.toLocaleLowerCase())>=0?(this.replaceWith(start,this.marker(markerClassName.startSelection,this.encode(start.textContent))),range.startContainer.querySelector("."+markerClassName.startSelection).appendChild(start)):this.replaceWith(start,this.marker(markerClassName.startSelection,this.encode(start.textContent))),end.nodeType!==Node.TEXT_NODE&&"BR"===end.tagName&&IGNORE_BLOCK_TAGS.indexOf(end.parentNode.tagName.toLocaleLowerCase())>=0?(this.replaceWith(end,this.marker(markerClassName.endSelection,this.encode(end.textContent))),range.endContainer.querySelector("."+markerClassName.endSelection).appendChild(end)):this.ensureSelfClosingTag(end,markerClassName.endSelection,range)):this.ensureSelfClosingTag(start,markerClassName.startSelection,range)}ensureSelfClosingTag(start,className,range){if(3===start.nodeType)this.replaceWith(start,this.marker(className,this.encode(start.textContent)));else if("BR"===start.tagName)this.replaceWith(start,this.marker(markerClassName.startSelection,this.encode(start.textContent))),range.startContainer.querySelector("."+markerClassName.startSelection).appendChild(start);else{if("IMG"===start.tagName){let parNode=document.createElement("p");start.parentElement.insertBefore(parNode,start),parNode.appendChild(start),start=parNode.children[0]}for(let i=0;i<selfClosingTags.length;i++)start=start.tagName===selfClosingTags[i]?start.parentNode:start;let marker=this.marker(className,"");append([this.parseHTMLFragment(marker)],start)}}createTempNode(element){let textContent=element.textContent;if("BR"===element.tagName){let wrapper="<"+DEFAULT_TAG+"></"+DEFAULT_TAG+">";IGNORE_BLOCK_TAGS.indexOf(element.parentNode.tagName.toLocaleLowerCase())>=0&&(element=this.wrap(element,this.parseHTMLFragment(wrapper)))}else if(element.nodeType!==Node.TEXT_NODE&&(element.classList.contains(markerClassName.startSelection)||element.classList.contains(markerClassName.endSelection))||textContent.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length>0||textContent.length&&textContent.indexOf("\n")<0){let target=element;element=this.wrap(element,this.parseHTMLFragment("<"+DEFAULT_TAG+"></"+DEFAULT_TAG+">")),(target.nodeType!==Node.ELEMENT_NODE||!target.firstChild||"BR"!==target.firstChild.nodeName||!target.classList.contains(markerClassName.startSelection)&&!target.classList.contains(markerClassName.endSelection))&&element.nextElementSibling&&"BR"===element.nextElementSibling.tagName&&element.appendChild(element.nextElementSibling)}return element}getImageTagInSelection(){let selection=this.getSelection();return this.isEditorArea()&&selection.rangeCount?selection.focusNode.querySelectorAll("img"):null}blockNodes(){let collectionNodes=[],selection=this.getSelection();if(this.isEditorArea()&&selection.rangeCount){let ranges=this.getRangePoint();for(let j=0;j<ranges.length;j++){let parentNode,range=ranges[j],startNode=this.getSelectedNode(range.startContainer,range.startOffset),endNode=this.getSelectedNode(range.endContainer,range.endOffset);if(this.isBlockNode(startNode)&&collectionNodes.indexOf(startNode)<0&&collectionNodes.push(startNode),(parentNode=this.blockParentNode(startNode))&&collectionNodes.indexOf(parentNode)<0)if(IGNORE_BLOCK_TAGS.indexOf(parentNode.tagName.toLocaleLowerCase())>=0&&("BR"===startNode.tagName||startNode.nodeType===Node.TEXT_NODE||startNode.classList.contains(markerClassName.startSelection)||startNode.classList.contains(markerClassName.endSelection))){let tempNode=startNode.previousSibling&&startNode.previousSibling.nodeType===Node.TEXT_NODE?startNode.previousSibling:startNode;collectionNodes.push(startNode.nextSibling||startNode.previousSibling||"BR"!==startNode.tagName?this.createTempNode(tempNode):tempNode)}else collectionNodes.push(parentNode);let nodes=[];for(let node=startNode;node!==endNode&&node!==this.parent;null)nodes.indexOf(node)<0&&node.childNodes&&node.childNodes.length?(nodes.push(node),node=node.childNodes[0]):node&&("BR"===node.tagName||node.nodeType===Node.TEXT_NODE&&""!==node.textContent.trim()||node.nodeType!==Node.TEXT_NODE&&(node.classList.contains(markerClassName.startSelection)||node.classList.contains(markerClassName.endSelection)))&&IGNORE_BLOCK_TAGS.indexOf(node.parentNode.tagName.toLocaleLowerCase())>=0?node=this.createTempNode(node):node.nextSibling&&("BR"===node.nextSibling.tagName||node.nextSibling.nodeType===Node.TEXT_NODE||node.nextSibling.classList.contains(markerClassName.startSelection)||node.nextSibling.classList.contains(markerClassName.endSelection))&&IGNORE_BLOCK_TAGS.indexOf(node.nextSibling.parentNode.tagName.toLocaleLowerCase())>=0?node=this.createTempNode(node.nextSibling):node.nextSibling?node=node.nextSibling:node.parentNode&&nodes.push(node=node.parentNode),collectionNodes.indexOf(node)<0&&node.nodeType===Node.ELEMENT_NODE&&IGNORE_BLOCK_TAGS.indexOf(node.parentNode.tagName.toLocaleLowerCase())>=0&&(node.classList.contains(markerClassName.startSelection)||node.classList.contains(markerClassName.endSelection))&&collectionNodes.push(this.createTempNode(node)),this.isBlockNode(node)&&this.ignoreTableTag(node)&&nodes.indexOf(node)<0&&collectionNodes.indexOf(node)<0&&(node!==endNode||range.endOffset>0)&&collectionNodes.push(node),"IMG"===node.nodeName&&"true"===node.parentElement.contentEditable&&collectionNodes.push(node);(parentNode=this.blockParentNode(endNode))&&this.ignoreTableTag(parentNode)&&collectionNodes.indexOf(parentNode)<0&&"IMG"!==parentNode.previousElementSibling.tagName&&collectionNodes.push(parentNode)}}for(let i=collectionNodes.length-1;i>0;i--)if(this.nodeFinds(collectionNodes[i],collectionNodes).length){let listNodes=collectionNodes[i].querySelectorAll("ul, ol");if("LI"===collectionNodes[i].tagName&&listNodes.length>0)continue;collectionNodes.splice(i,1)}return collectionNodes}ignoreTableTag(element){return!(TABLE_BLOCK_TAGS.indexOf(element.tagName.toLocaleLowerCase())>=0)}}function isIDevice$1(){let result=!1;return Browser.isDevice&&Browser.isIos&&(result=!0),result}function setEditFrameFocus(editableElement,selector){if("BODY"===editableElement.nodeName&&!isNullOrUndefined(selector)){let iframe=top.window.document.querySelector(selector);isNullOrUndefined(iframe)||iframe.contentWindow.focus()}}class ej2_richtexteditor_es2015_Lists{constructor(parent){this.parent=parent,this.domNode=this.parent.domNode,this.addEventListener()}addEventListener(){this.parent.observer.on(LIST_TYPE,this.applyListsHandler,this),this.parent.observer.on(KEY_DOWN_HANDLER,this.keyDownHandler,this)}testList(elem){let olListRegex=[/^[\d]+[.]+$/,/^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,/^[a-zA-Z][.]+$/],elementStart=isNullOrUndefined(elem)?null:elem.innerText.trim().split(".")[0]+".";if(!isNullOrUndefined(elementStart))for(let i=0;i<olListRegex.length;i++)if(olListRegex[i].test(elementStart))return!0;return!1}testCurrentList(range){let olListStartRegex=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/];if(!isNullOrUndefined(range.startContainer.textContent.slice(0,range.startOffset)))for(let i=0;i<olListStartRegex.length;i++)if(olListStartRegex[i].test(range.startContainer.textContent.slice(0,range.startOffset)))return!0;return!1}spaceList(e){let range=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.saveSelection=this.parent.nodeSelection.save(range,this.parent.currentDocument);let startNode=this.parent.domNode.getSelectedNode(range.startContainer,range.startOffset),preElement=(this.parent.domNode.getSelectedNode(range.endContainer,range.endOffset),startNode.previousElementSibling),nextElement=startNode.nextElementSibling,preElemULStart=isNullOrUndefined(preElement)?null:preElement.innerText.trim().substring(0,1),nextElemULStart=isNullOrUndefined(nextElement)?null:nextElement.innerText.trim().substring(0,1),startElementOLTest=this.testCurrentList(range),preElementOLTest=this.testList(preElement),nextElementOLTest=this.testList(nextElement);preElementOLTest||nextElementOLTest||"*"===preElemULStart||"*"===nextElemULStart||(startElementOLTest?(range.startContainer.textContent=range.startContainer.textContent.slice(range.startOffset,range.startContainer.textContent.length),this.applyListsHandler({subCommand:"OL",callBack:e.callBack}),e.event.preventDefault()):"*"===range.startContainer.textContent.slice(0,range.startOffset)&&(range.startContainer.textContent=range.startContainer.textContent.slice(range.startOffset,range.startContainer.textContent.length),this.applyListsHandler({subCommand:"UL",callBack:e.callBack}),e.event.preventDefault()))}keyDownHandler(e){if(32===e.event.which&&this.spaceList(e),9===e.event.which){let blockNodes,range=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.saveSelection=this.parent.nodeSelection.save(range,this.parent.currentDocument);let startOffset=range.startOffset,endOffset=range.endOffset,startNode=this.parent.domNode.getSelectedNode(range.startContainer,range.startOffset);if(startNode===this.parent.domNode.getSelectedNode(range.endContainer,range.endOffset)&&("BR"===startNode.nodeName||"#text"===startNode.nodeName)&&IGNORE_BLOCK_TAGS.indexOf(startNode.parentNode.tagName.toLocaleLowerCase())>=0)return;e.event.action&&"indent"===e.event.action||this.domNode.setMarker(this.saveSelection),blockNodes=this.domNode.blockNodes();let nodes=[],isNested=!0;for(let i=0;i<blockNodes.length;i++)"LI"===blockNodes[i].parentNode.tagName?nodes.push(blockNodes[i].parentNode):"LI"===blockNodes[i].tagName&&"P"!==blockNodes[i].childNodes[0].tagName&&"OL"!==blockNodes[i].childNodes[0].tagName&&"UL"!==blockNodes[i].childNodes[0].tagName&&nodes.push(blockNodes[i]);nodes.length>1||nodes.length&&(0===startOffset&&0===endOffset||e.ignoreDefault)?(e.event.preventDefault(),e.event.stopPropagation(),this.currentAction=this.getAction(nodes[0]),e.event.shiftKey?(this.revertList(nodes),this.revertClean()):isNested=this.nestedList(nodes),isNested&&(this.cleanNode(),this.parent.editableElement.focus()),e.event.action&&"indent"===e.event.action||(this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore(),e.callBack&&e.callBack({requestType:this.currentAction,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(),event:e.event}))):e.event.action&&"indent"===e.event.action||(e.event&&e.event.shiftKey&&"Tab"===e.event.key&&(e.event.action="tab"),this.saveSelection=this.domNode.saveMarker(this.saveSelection,e.event.action),this.saveSelection.restore())}else switch(e.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:e.callBack}),e.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:e.callBack}),e.event.preventDefault()}}getAction(element){return"OL"===element.parentNode.nodeName?"OL":"UL"}revertClean(){let collectionNodes=this.parent.editableElement.querySelectorAll("ul, ol");for(let i=0;i<collectionNodes.length;i++){let listNodes=collectionNodes[i].querySelectorAll("ul, ol");if(listNodes.length>0)for(let j=0;j<listNodes.length;j++){let prevSibling=listNodes[j].previousSibling;prevSibling&&"LI"===prevSibling.tagName&&prevSibling.appendChild(listNodes[j])}}}noPreviousElement(elements){let firstNode,firstNodeOL,siblingListOL=elements.querySelectorAll("ol, ul"),siblingListLI=elements.querySelectorAll("li"),siblingListLIFirst=this.domNode.contents(siblingListLI[0])[0];if(siblingListLI.length>0&&("OL"===siblingListLIFirst.nodeName||"UL"===siblingListLIFirst.nodeName)?firstNode=siblingListLI[0]:firstNodeOL=siblingListOL[0],firstNode)for(let h=this.domNode.contents(elements)[0];h&&!this.domNode.isList(h);null){let nextSibling=h.nextSibling;prepend([h],firstNode),setStyleAttribute(elements,{"list-style-type":"none"}),setStyleAttribute(firstNode,{"list-style-type":""}),h=nextSibling}else if(firstNodeOL){let nestedElement=ej2_base_es2015_createElement("li");prepend([nestedElement],firstNodeOL);for(let h=this.domNode.contents(elements)[0];h&&!this.domNode.isList(h);null){let nextSibling=h.nextSibling;nestedElement.appendChild(h),h=nextSibling}prepend([firstNodeOL],elements.parentNode),detach(elements);let nestedElementLI=ej2_base_es2015_createElement("li",{styles:"list-style-type: none;"});prepend([nestedElementLI],firstNodeOL.parentNode),append([firstNodeOL],nestedElementLI)}else{let nestedElementLI=ej2_base_es2015_createElement("li",{styles:"list-style-type: none;"});prepend([nestedElementLI],elements.parentNode);let nestedElement=ej2_base_es2015_createElement(elements.parentNode.tagName);prepend([nestedElement],nestedElementLI),append([elements],nestedElement)}}nestedList(elements){let isNested=!1;for(let i=0;i<elements.length;i++){let prevSibling=this.domNode.getPreviousNode(elements[i]);if(prevSibling){let firstNode,firstNodeLI;isNested=!0;let siblingListOL=elements[i].querySelectorAll("ol, ul"),siblingListLI=elements[i].querySelectorAll("li"),siblingListLIFirst=this.domNode.contents(siblingListLI[0])[0];if(siblingListLI.length>0&&("OL"===siblingListLIFirst.nodeName||"UL"===siblingListLIFirst.nodeName)?firstNodeLI=siblingListLI[0]:firstNode=siblingListOL[0],firstNode){let nestedElement=ej2_base_es2015_createElement("li");prepend([nestedElement],firstNode);for(let h=this.domNode.contents(elements[i])[0];h&&!this.domNode.isList(h);null){let nextSibling=h.nextSibling;nestedElement.appendChild(h),h=nextSibling}append([firstNode],prevSibling),detach(elements[i])}else if(firstNodeLI){if("LI"===prevSibling.tagName){for(let h=this.domNode.contents(elements[i])[0];h&&!this.domNode.isList(h);null){let nextSibling=h.nextSibling;prepend([h],firstNodeLI),setStyleAttribute(elements[i],{"list-style-type":"none"}),setStyleAttribute(firstNodeLI,{"list-style-type":""}),h=nextSibling}append([firstNodeLI.parentNode],prevSibling),detach(elements[i])}}else if("LI"===prevSibling.tagName){let nestedElement=ej2_base_es2015_createElement(elements[i].parentNode.tagName);append([nestedElement],prevSibling),append([elements[i]],nestedElement)}}else isNested=!0,this.noPreviousElement(elements[i])}return isNested}applyListsHandler(e){let range=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.saveSelection=this.parent.nodeSelection.save(range,this.parent.currentDocument),this.currentAction=e.subCommand,this.domNode.setMarker(this.saveSelection);let listsNodes=this.domNode.blockNodes();for(let i=0;i<listsNodes.length;i++)"LI"!==listsNodes[i].tagName&&"LI"===listsNodes[i].parentNode.tagName&&(listsNodes[i]=listsNodes[i].parentNode);this.applyLists(listsNodes,this.currentAction,e.selector),e.callBack&&e.callBack({requestType:this.currentAction,event:e.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})}applyLists(elements,type,selector){if(this.isRevert(elements,type))this.revertList(elements),this.removeEmptyListElements();else{this.checkLists(elements,type);for(let i=0;i<elements.length;i++)if("LI"!==elements[i].tagName){let openTag="<"+type+">",closeTag="</"+type+">",newTag="li"+("IMG"===elements[i].tagName?"":this.domNode.attributes(elements[i])),replaceHTML=elements[i].tagName.toLowerCase()===DEFAULT_TAG?elements[i].innerHTML:elements[i].outerHTML,innerHTML=this.domNode.createTagString(newTag,null,replaceHTML);this.domNode.replaceWith(elements[i],openTag+innerHTML+closeTag)}}this.cleanNode(),this.parent.editableElement.focus(),isIDevice$1()&&setEditFrameFocus(this.parent.editableElement,selector),this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore()}removeEmptyListElements(){let listElem=this.parent.editableElement.querySelectorAll("ol, ul");for(let i=0;i<listElem.length;i++)""===listElem[i].textContent.trim()&&detach(listElem[i])}isRevert(nodes,tagName){let isRevert=!0;for(let i=0;i<nodes.length;i++){if("LI"!==nodes[i].tagName)return!1;nodes[i].parentNode.tagName!==tagName&&(isRevert=!1)}return isRevert}checkLists(nodes,tagName){let nodesTemp=[];for(let i=0;i<nodes.length;i++){let node=nodes[i].parentNode;"LI"===nodes[i].tagName&&node.tagName!==tagName&&nodesTemp.indexOf(node)<0&&nodesTemp.push(node)}for(let j=nodesTemp.length-1;j>=0;j--){let h=nodesTemp[j],replace="<"+tagName.toLowerCase()+" "+this.domNode.attributes(h)+">"+h.innerHTML+"</"+tagName.toLowerCase()+">";this.domNode.replaceWith(nodesTemp[j],replace)}}cleanNode(){let liParents=this.parent.editableElement.querySelectorAll("ol + ol, ul + ul");for(let c=0;c<liParents.length;c++){let node=liParents[c];if(this.domNode.isList(node.previousElementSibling)&&this.domNode.openTagString(node)===this.domNode.openTagString(node.previousElementSibling)){let contentNodes=this.domNode.contents(node);for(let f=0;f<contentNodes.length;f++)node.previousElementSibling.appendChild(contentNodes[f]);node.parentNode.removeChild(node)}}}findUnSelected(temp,elements){if((temp=temp.slice().reverse()).length>0){let rightIndent=[],indentElements=[],lastElementChild=[],childElements=[];lastElementChild=elements[elements.length-1].childNodes;for(let z=0;z<lastElementChild.length;z++)if("OL"===lastElementChild[z].tagName||"UL"===lastElementChild[z].tagName){let childLI=lastElementChild[z].querySelectorAll("li");if(childLI.length>0)for(let y=0;y<childLI.length;y++)childElements.push(childLI[y])}for(let i=0;i<childElements.length;i++){let count=0;for(let j=0;j<temp.length;j++)childElements[i].contains(temp[j])||(count+=1);count===temp.length&&indentElements.push(childElements[i])}if(indentElements.length>0)for(let x=0;x<indentElements.length;x++)"OL"!==this.domNode.contents(indentElements[x])[0].nodeName&&"UL"!==this.domNode.contents(indentElements[x])[0].nodeName&&rightIndent.push(indentElements[x]);rightIndent.length>0&&this.nestedList(rightIndent)}}revertList(elements){let temp=[];for(let i=elements.length-1;i>=0;i--)for(let j=i-1;j>=0;j--)if(elements[j].contains(elements[i])||elements[j]===elements[i]){temp.push(elements[i]),elements.splice(i,1);break}this.findUnSelected(temp,elements);let viewNode=[];for(let i=0;i<elements.length;i++){let element=elements[i],parentNode=elements[i].parentNode,className=element.getAttribute("class");if(0===temp.length){let firstNode=elements[i].querySelectorAll("ul, ol")[0];if(firstNode&&firstNode.querySelectorAll("li")){let nestedElement=ej2_base_es2015_createElement(firstNode.tagName);append([nestedElement],firstNode.parentNode);let nestedElementLI=ej2_base_es2015_createElement("li",{styles:"list-style-type: none;"});append([nestedElementLI],nestedElement),append([firstNode],nestedElementLI)}}if(element.parentNode.insertBefore(this.closeTag(parentNode.tagName),element),"LI"===parentNode.parentNode.tagName)element.parentNode.insertBefore(this.closeTag("LI"),element);else{if(DEFAULT_TAG&&0===element.querySelectorAll(BLOCK_TAGS.join(", ")).length){let wrapperclass=isNullOrUndefined(className)?' class="e-rte-wrap-inner"':' class="'+className+' e-rte-wrap-inner"',wrapper="<"+DEFAULT_TAG+wrapperclass+this.domNode.attributes(parentNode)+"></"+DEFAULT_TAG+">";this.domNode.wrapInner(element,this.domNode.parseHTMLFragment(wrapper))}else if(3===this.domNode.contents(element)[0].nodeType){let replace=this.domNode.createTagString(DEFAULT_TAG,parentNode,this.parent.domNode.encode(this.domNode.contents(element)[0].textContent));this.domNode.replaceWith(this.domNode.contents(element)[0],replace)}else if(this.domNode.contents(element)[0].classList.contains(markerClassName.startSelection)||this.domNode.contents(element)[0].classList.contains(markerClassName.endSelection)){let replace=this.domNode.createTagString(DEFAULT_TAG,parentNode,this.domNode.contents(element)[0].outerHTML);this.domNode.replaceWith(this.domNode.contents(element)[0],replace)}else{let childNode=element.firstChild;className=childNode.getAttribute("class"),attributes(childNode,this.domNode.rawAttributes(parentNode)),className&&childNode.getAttribute("class")&&attributes(childNode,{class:className+" "+childNode.getAttribute("class")})}append([this.openTag("LI")],element),prepend([this.closeTag("LI")],element)}this.domNode.insertAfter(this.openTag(parentNode.tagName),element),"LI"===parentNode.parentNode.tagName&&(parentNode=parentNode.parentNode.parentNode),viewNode.indexOf(parentNode)<0&&viewNode.push(parentNode)}for(let i=0;i<viewNode.length;i++){let node=viewNode[i],nodeInnerHtml=node.innerHTML,openTag=/<span class="e-rte-list-open-([a-z]*)"><\/span>/g;nodeInnerHtml=(nodeInnerHtml=nodeInnerHtml.replace(/<span class="e-rte-list-close-([a-z]*)"><\/span>/g,"</$1>")).replace(openTag,"<$1 "+this.domNode.attributes(node)+">"),this.domNode.replaceWith(node,this.domNode.openTagString(node)+nodeInnerHtml.trim()+this.domNode.closeTagString(node))}let emptyUl=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty");for(let i=0;i<emptyUl.length;i++)detach(emptyUl[i]);let emptyLi=this.parent.editableElement.querySelectorAll("li:empty");for(let i=0;i<emptyLi.length;i++)detach(emptyLi[i])}openTag(type){return this.domNode.parseHTMLFragment('<span class="e-rte-list-open-'+type.toLowerCase()+'"></span>')}closeTag(type){return this.domNode.parseHTMLFragment('<span class="e-rte-list-close-'+type.toLowerCase()+'"></span>')}}class ej2_richtexteditor_es2015_Formats{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(FORMAT_TYPE,this.applyFormats,this)}getParentNode(node){for(;node.parentNode&&node.parentNode!==this.parent.editableElement;null)node=node.parentNode;return node}applyFormats(e){let range=this.parent.nodeSelection.getRange(this.parent.currentDocument),save=this.parent.nodeSelection.save(range,this.parent.currentDocument);this.parent.domNode.setMarker(save);let formatsNodes=this.parent.domNode.blockNodes();for(let i=0;i<formatsNodes.length;i++){let parentNode,replaceHTML;if("blockquote"===e.subCommand.toLowerCase()?(parentNode=this.getParentNode(formatsNodes[i]),replaceHTML=this.parent.domNode.isList(parentNode)||"TABLE"===parentNode.tagName?parentNode.outerHTML:parentNode.innerHTML):replaceHTML=(parentNode=formatsNodes[i]).innerHTML,e.subCommand.toLowerCase()===parentNode.tagName.toLowerCase()||isNullOrUndefined(parentNode.parentNode)||"LI"===parentNode.tagName)continue;this.cleanFormats(parentNode,e.subCommand);let replaceTag=this.parent.domNode.createTagString(e.subCommand,parentNode,replaceHTML.replace(/>\s+</g,"><"));this.parent.domNode.replaceWith(parentNode,replaceTag)}this.parent.editableElement.focus(),save=this.parent.domNode.saveMarker(save),isIDevice$1()&&setEditFrameFocus(this.parent.editableElement,e.selector),save.restore(),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})}cleanFormats(element,tagName){let ignoreAttr=["display","font-size","margin-top","margin-bottom","margin-left","margin-right","font-weight"];tagName=tagName.toLowerCase();for(let i=0;i<ignoreAttr.length&&"p"!==tagName&&"blockquote"!==tagName&&"pre"!==tagName;i++)element.style.removeProperty(ignoreAttr[i])}}class InsertMethods{static WrapBefore(textNode,parentNode,isAfter){return parentNode.innerText=textNode.textContent,isAfter?this.AppendBefore(parentNode,textNode,!0):this.AppendBefore(parentNode,textNode),textNode.parentNode&&textNode.parentNode.removeChild(textNode),parentNode.childNodes[0]}static Wrap(childNode,parentNode){return this.AppendBefore(parentNode,childNode),parentNode.appendChild(childNode),childNode}static unwrap(node){let parent=node.parentNode,child=[];for(;node.firstChild;null)child.push(parent.insertBefore(node.firstChild,node));return parent.removeChild(node),child}static AppendBefore(textNode,parentNode,isAfter){return parentNode.parentNode?parentNode.parentNode.insertBefore(textNode,isAfter?parentNode.nextSibling:parentNode):parentNode}}class ej2_richtexteditor_es2015_NodeCutter{constructor(){this.position=-1,this.nodeSelection=new NodeSelection}GetSpliceNode(range,node){return node=this.SplitNode(range,node,!0),this.SplitNode(range,node,!1)}SplitNode(range,node,isCollapsed){if(node){let clone=range.cloneRange(),parent=node.parentNode,index=this.nodeSelection.getIndex(node);clone.collapse(isCollapsed),isCollapsed?clone.setStartBefore(node):clone.setEndAfter(node);let fragment=clone.extractContents();if(isCollapsed){if(node=parent.childNodes[index],(fragment=this.spliceEmptyNode(fragment,!1))&&fragment.childNodes.length>0&&(1!==fragment.childNodes.length||"IMG"===fragment.childNodes[0].nodeName||!isNullOrUndefined(fragment.querySelector("img"))||""!==fragment.textContent))if(node)InsertMethods.AppendBefore(fragment,node);else{parent.appendChild(fragment);let divNode=document.createElement("div");divNode.innerHTML="&#65279;&#65279;",parent.appendChild(node=divNode.firstChild)}}else if(node=parent.childNodes.length>1?parent.childNodes[index]:parent.childNodes[0],(fragment=this.spliceEmptyNode(fragment,!0))&&fragment.childNodes.length>0&&(1!==fragment.childNodes.length||"IMG"===fragment.childNodes[0].nodeName||!isNullOrUndefined(fragment.querySelector("img"))||""!==fragment.textContent))if(node)InsertMethods.AppendBefore(fragment,node,!0);else{parent.appendChild(fragment);let divNode=document.createElement("div");divNode.innerHTML="&#65279;&#65279;",parent.insertBefore(divNode.firstChild,parent.firstChild),node=parent.firstChild}return node}return null}spliceEmptyNode(fragment,isStart){let len;return(len=1===fragment.childNodes.length&&"#text"===fragment.childNodes[0].nodeName&&""===fragment.childNodes[0].textContent||""===fragment.textContent?-1:fragment.childNodes.length-1)>-1&&!isStart?this.spliceEmptyNode(fragment.childNodes[len],isStart):len>-1?this.spliceEmptyNode(fragment.childNodes[0],isStart):3!==fragment.nodeType&&11!==fragment.nodeType&&fragment.parentNode.removeChild(fragment),fragment}GetCursorStart(indexes,index,isStart){let position=(indexes=isStart?indexes:indexes.reverse())[0];for(let num=0;num<indexes.length&&(isStart?indexes[num]<index:indexes[num]>=index);num++)position=indexes[num];return position}GetCursorRange(docElement,range,node){let cursorRange=docElement.createRange(),indexes=[];indexes.push(0);let str=this.TrimLineBreak(node.data),index=str.indexOf(" ",0);for(;-1!==index;)indexes.indexOf(index)<0&&indexes.push(index),new RegExp("\\s").test(str[index-1])&&indexes.indexOf(index-1)<0&&indexes.push(index-1),new RegExp("\\s").test(str[index+1])&&indexes.push(index+1),index=str.indexOf(" ",index+1);if(indexes.push(str.length),indexes.indexOf(range.startOffset)>=0||indexes.indexOf(range.startOffset-1)>=0&&(1!==range.startOffset||1===range.startOffset&&new RegExp("\\s").test(str[0]))||indexes[indexes.length-1]-1===range.startOffset)cursorRange=range,this.position=1;else{let startOffset=this.GetCursorStart(indexes,range.startOffset,!0);this.position=range.startOffset-startOffset,cursorRange.setStart(range.startContainer,startOffset),cursorRange.setEnd(range.startContainer,this.GetCursorStart(indexes,range.startOffset,!1))}return cursorRange}GetCursorNode(docElement,range,node){return this.GetSpliceNode(this.GetCursorRange(docElement,range,node),node)}TrimLineBreak(line){return line.replace(/(\r\n\t|\n|\r\t)/gm," ")}}class ej2_richtexteditor_es2015_InsertHtml{static Insert(docElement,insertNode,editNode){let node;if("string"==typeof insertNode){let divNode=document.createElement("div");divNode.innerHTML=insertNode,node=divNode.firstChild}else node=insertNode;let nodeSelection=new NodeSelection,nodeCutter=new ej2_richtexteditor_es2015_NodeCutter,range=nodeSelection.getRange(docElement),isCollapsed=range.collapsed,nodes=nodeSelection.getInsertNodeCollection(range),closestParentNode="table"===node.nodeName.toLowerCase()?this.closestEle(nodes[0].parentNode,editNode):nodes[0];if(editNode!==range.startContainer&&(!isCollapsed&&(closestParentNode.nodeType!==Node.ELEMENT_NODE||-1===TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()))||"table"===node.nodeName.toLowerCase()&&closestParentNode&&-1===TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()))){let preNode=nodeCutter.GetSpliceNode(range,closestParentNode),sibNode=preNode.previousSibling,parentNode=preNode.parentNode;if(1===nodes.length)nodeSelection.setSelectionContents(docElement,preNode),range=nodeSelection.getRange(docElement);else{let lasNode=nodeCutter.GetSpliceNode(range,nodes[nodes.length-1].parentElement);lasNode=isNullOrUndefined(lasNode)?preNode:lasNode,nodeSelection.setSelectionText(docElement,preNode,lasNode,0,3===lasNode.nodeType?lasNode.textContent.length:lasNode.childNodes.length),range=nodeSelection.getRange(docElement)}range.extractContents(),"TABLE"===insertNode.tagName&&this.removeEmptyElements(editNode);for(let index=0;index<nodes.length;index++)if(3!==nodes[index].nodeType&&null!=nodes[index].parentNode){if("IMG"===nodes[index].nodeName)continue;nodes[index].parentNode.removeChild(nodes[index])}if(sibNode)InsertMethods.AppendBefore(node,sibNode,!0);else{let previousNode=null;for(;parentNode!==editNode&&parentNode.firstChild&&""===parentNode.textContent.trim();)previousNode=parentNode,parentNode=parentNode.parentNode;null!==previousNode&&(parentNode=previousNode),parentNode.firstChild&&"true"!==parentNode.contentEditable?""===parentNode.textContent.trim()?(InsertMethods.AppendBefore(node,parentNode,!1),detach(parentNode)):InsertMethods.AppendBefore(node,parentNode.firstChild,!1):parentNode.appendChild(node)}nodeSelection.setSelectionText(docElement,node,node,0,3!==node.nodeType?node.childNodes.length:node.textContent.length)}else{if(range.deleteContents(),Browser.isIE){let frag=docElement.createDocumentFragment();frag.appendChild(node),range.insertNode(frag)}else range.insertNode(node);3!==node.nodeType&&node.childNodes.length>0?nodeSelection.setSelectionText(docElement,node,node,1,1):3!==node.nodeType?nodeSelection.setSelectionContents(docElement,node):nodeSelection.setSelectionText(docElement,node,node,node.textContent.length,node.textContent.length)}}static findDetachEmptyElem(element){return isNullOrUndefined(element.parentElement)?null:""===element.parentElement.textContent.trim()&&"true"!==element.parentElement.contentEditable?this.findDetachEmptyElem(element.parentElement):element}static removeEmptyElements(element){let emptyElements=element.querySelectorAll(":empty");for(let i=0;i<emptyElements.length;i++)if("IMG"!==emptyElements[i].tagName&&"BR"!==emptyElements[i].tagName){let detachableElement=this.findDetachEmptyElem(emptyElements[i]);isNullOrUndefined(detachableElement)||detach(detachableElement)}}static closestEle(element,editNode){let el=element;for(;el&&1===el.nodeType;){if(el.parentNode===editNode||!isNullOrUndefined(el.parentNode.tagName)&&-1!==IGNORE_BLOCK_TAGS.indexOf(el.parentNode.tagName.toLocaleLowerCase()))return el;el=el.parentNode}return null}}class ej2_richtexteditor_es2015_LinkCommand{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(ej2_richtexteditor_es2015_LINK,this.linkCommand,this)}linkCommand(e){switch(e.value.toString().toLocaleLowerCase()){case"createlink":case"editlink":this.createLink(e);break;case"openlink":this.openLink(e);break;case"removelink":this.removeLink(e)}}createLink(e){let closestAnchor=!isNullOrUndefined(e.item.selectParent)&&e.item.selectParent.length>0&&closest(e.item.selectParent[0],"a");if(closestAnchor=isNullOrUndefined(closestAnchor)?!isNullOrUndefined(e.item.selectParent)&&e.item.selectParent.length>0?e.item.selectParent[0]:null:closestAnchor,isNullOrUndefined(closestAnchor)||"A"!==closestAnchor.tagName){let anchor=ej2_base_es2015_createElement("a",{className:"e-rte-anchor",attrs:{href:e.item.url,title:isNullOrUndefined(e.item.title)||""===e.item.title?e.item.url:e.item.title}});if(isNullOrUndefined(e.item.target)||anchor.setAttribute("target",e.item.target),anchor.innerText=""===e.item.text?e.item.url:e.item.text,e.item.selection.restore(),ej2_richtexteditor_es2015_InsertHtml.Insert(this.parent.currentDocument,anchor,this.parent.editableElement),!e.event||"keydown"!==e.event.type||32!==e.event.keyCode&&13!==e.event.keyCode)e.item.selection.setSelectionText(this.parent.currentDocument,anchor.childNodes[0],anchor.childNodes[0],"Paste"===e.item.action?anchor.childNodes[0].textContent.length:0,anchor.childNodes[0].textContent.length);else{let startContainer=e.item.selection.range.startContainer;startContainer.textContent=this.removeText(startContainer.textContent,e.item.text)}}else{let anchorEle=closestAnchor;anchorEle.setAttribute("href",e.item.url),anchorEle.setAttribute("title",e.item.title),anchorEle.innerText=e.item.text,isNullOrUndefined(e.item.target)?anchorEle.removeAttribute("target"):anchorEle.setAttribute("target",e.item.target),e.item.selection.setSelectionText(this.parent.currentDocument,anchorEle,anchorEle,1,1),e.item.selection.restore()}e.callBack&&e.callBack({requestType:"Links",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}removeText(text,val){let arr=text.split(" ");for(let i=0;i<arr.length;i++)arr[i]===val&&(arr.splice(i,1),i--);return arr.join(" ")+" "}openLink(e){document.defaultView.open(e.item.url,e.item.target),this.callBack(e)}removeLink(e){this.parent.domNode.setMarker(e.item.selection);let selectParent=closest(e.item.selectParent[0],"a")||e.item.selectParent[0],parent=selectParent.parentNode,child=[];for(;selectParent.firstChild;null)child.push(parent.insertBefore(selectParent.firstChild,selectParent));parent.removeChild(selectParent),child&&1===child.length&&(e.item.selection.startContainer=e.item.selection.getNodeArray(child[child.length-1],!0),e.item.selection.endContainer=e.item.selection.startContainer),e.item.selection=this.parent.domNode.saveMarker(e.item.selection),e.item.selection.restore(),this.callBack(e)}callBack(e){e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}}class ej2_richtexteditor_es2015_Alignments{constructor(parent){this.alignments={JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",JustifyFull:"justify"},this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(ALIGNMENT_TYPE,this.applyAlignment,this),this.parent.observer.on(KEY_DOWN_HANDLER,this.onKeyDown,this)}onKeyDown(e){switch(e.event.action){case"justify-center":this.applyAlignment({subCommand:"JustifyCenter",callBack:e.callBack}),e.event.preventDefault();break;case"justify-full":this.applyAlignment({subCommand:"JustifyFull",callBack:e.callBack}),e.event.preventDefault();break;case"justify-left":this.applyAlignment({subCommand:"JustifyLeft",callBack:e.callBack}),e.event.preventDefault();break;case"justify-right":this.applyAlignment({subCommand:"JustifyRight",callBack:e.callBack}),e.event.preventDefault()}}getTableNode(range){return[closest(range.startContainer.nodeType===Node.ELEMENT_NODE?range.startContainer:range.startContainer.parentNode,"td,th")]}applyAlignment(e){let isTableAlign="Table"===e.value,range=this.parent.nodeSelection.getRange(this.parent.currentDocument),save=this.parent.nodeSelection.save(range,this.parent.currentDocument);if(isTableAlign)setStyleAttribute(this.getTableNode(range)[0],{"text-align":this.alignments[e.subCommand]});else{this.parent.domNode.setMarker(save);let alignmentNodes=this.parent.domNode.blockNodes();for(let i=0;i<alignmentNodes.length;i++)setStyleAttribute(alignmentNodes[i],{"text-align":this.alignments[e.subCommand]});let imageTags=this.parent.domNode.getImageTagInSelection();for(let i=0;i<imageTags.length;i++){let elementNode=[];elementNode.push(imageTags[i]),this.parent.imgObj.imageCommand({item:{selectNode:elementNode},subCommand:e.subCommand,value:e.subCommand,callBack:e.callBack,selector:e.selector})}this.parent.editableElement.focus(),save=this.parent.domNode.saveMarker(save),isIDevice$1()&&setEditFrameFocus(this.parent.editableElement,e.selector),save.restore()}e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:isTableAlign?this.getTableNode(range):this.parent.domNode.blockNodes()})}}class Indents{constructor(parent){this.indentValue=20,this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(INDENT_TYPE,this.applyIndents,this),this.parent.observer.on(KEY_DOWN_HANDLER,this.onKeyDown,this)}onKeyDown(e){switch(e.event.action){case"indents":this.applyIndents({subCommand:"Indent",callBack:e.callBack}),e.event.preventDefault();break;case"outdents":this.applyIndents({subCommand:"Outdent",callBack:e.callBack}),e.event.preventDefault()}}applyIndents(e){let range=this.parent.nodeSelection.getRange(this.parent.currentDocument),save=this.parent.nodeSelection.save(range,this.parent.currentDocument);this.parent.domNode.setMarker(save);let indentsNodes=this.parent.domNode.blockNodes(),parentNodes=indentsNodes.slice(),listsNodes=[];for(let i=0;i<parentNodes.length;i++)"LI"!==parentNodes[i].tagName&&"LI"===parentNodes[i].parentNode.tagName?(indentsNodes.splice(indentsNodes.indexOf(parentNodes[i]),1),listsNodes.push(parentNodes[i].parentNode)):"LI"===parentNodes[i].tagName&&(indentsNodes.splice(indentsNodes.indexOf(parentNodes[i]),1),listsNodes.push(parentNodes[i]));listsNodes.length>0&&this.parent.observer.notify(KEY_DOWN_HANDLER,{event:{preventDefault:()=>{},stopPropagation:()=>{},shiftKey:"Indent"!==e.subCommand,which:9,action:"indent"},ignoreDefault:!0});for(let i=0;i<indentsNodes.length;i++){let indentsValue,parentNode=indentsNodes[i],marginLeft=parentNode.style.marginLeft;"Indent"===e.subCommand?(indentsValue=""===marginLeft?this.indentValue+"px":parseInt(marginLeft,null)+this.indentValue+"px",parentNode.style.marginLeft=indentsValue):(indentsValue=""===marginLeft||"0px"===marginLeft?"":parseInt(marginLeft,null)-this.indentValue+"px",parentNode.style.marginLeft=indentsValue)}this.parent.editableElement.focus(),isIDevice$1()&&setEditFrameFocus(this.parent.editableElement,e.selector),(save=this.parent.domNode.saveMarker(save)).restore(),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})}}const CLASS_IMAGE_RIGHT="e-imgright",CLASS_IMAGE_LEFT="e-imgleft",CLASS_IMAGE_CENTER="e-imgcenter",CLASS_IMAGE_BREAK="e-imgbreak",CLASS_CAPTION="e-img-caption",CLASS_CAPTION_INLINE="e-caption-inline",CLASS_IMAGE_INLINE="e-imginline";class ej2_richtexteditor_es2015_ImageCommand{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(ej2_richtexteditor_es2015_IMAGE,this.imageCommand,this)}imageCommand(e){switch(e.value.toString().toLocaleLowerCase()){case"image":case"replace":this.createImage(e);break;case"insertlink":this.insertImageLink(e);break;case"openimagelink":this.openImageLink(e);break;case"editimagelink":this.editImageLink(e);break;case"removeimagelink":this.removeImageLink(e);break;case"remove":this.removeImage(e);break;case"alttext":this.insertAltTextImage(e);break;case"dimension":this.imageDimension(e);break;case"caption":this.imageCaption(e);break;case"justifyleft":this.imageJustifyLeft(e);break;case"justifycenter":this.imageJustifyCenter(e);break;case"justifyright":this.imageJustifyRight(e);break;case"inline":this.imageInline(e);break;case"break":this.imageBreak(e)}}createImage(e){if(isNullOrUndefined(e.item.selectParent)||"IMG"!==e.item.selectParent[0].tagName){let imgElement=ej2_base_es2015_createElement("img",{className:"e-rte-image "+e.item.cssClass,attrs:{width:isNullOrUndefined(e.item.width)||isNullOrUndefined(e.item.width.width)?"auto":e.item.width.width,height:isNullOrUndefined(e.item.height)||isNullOrUndefined(e.item.height.height)?"auto":e.item.height.height,alt:""!==e.item.altText?e.item.altText:""}});imgElement.setAttribute("src",isNullOrUndefined(e.item.url)?"":e.item.url),imgElement.style.minWidth=isNullOrUndefined(e.item.width)||isNullOrUndefined(e.item.width.minWidth)?"0px":e.item.width.minWidth+"px",imgElement.style.maxWidth=isNullOrUndefined(e.item.width)||isNullOrUndefined(e.item.width.maxWidth)?null:e.item.width.maxWidth+"px",imgElement.style.minHeight=isNullOrUndefined(e.item.height)||isNullOrUndefined(e.item.height.minHeight)?"0px":e.item.height.minHeight+"px",imgElement.style.maxHeight=isNullOrUndefined(e.item.height)||isNullOrUndefined(e.item.height.maxHeight)?null:e.item.height.maxHeight+"px",isNullOrUndefined(e.item.selection)||e.item.selection.restore(),isNullOrUndefined(e.selector)||"pasteCleanupModule"!==e.selector?ej2_richtexteditor_es2015_InsertHtml.Insert(this.parent.currentDocument,imgElement,this.parent.editableElement):e.callBack({requestType:"Image",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[imgElement]})}else{let imgEle=e.item.selectParent[0];imgEle.setAttribute("src",e.item.url),imgEle.setAttribute("alt",e.item.altText)}e.callBack&&(isNullOrUndefined(e.selector)||!isNullOrUndefined(e.selector)&&"pasteCleanupModule"!==e.selector)&&e.callBack({requestType:"Image",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}insertImageLink(e){let anchor=ej2_base_es2015_createElement("a",{attrs:{href:e.item.url}});e.item.selectNode[0].parentElement.classList.contains("e-img-wrap")&&(e.item.selection.restore(),anchor.setAttribute("contenteditable","true")),anchor.appendChild(e.item.selectNode[0]),isNullOrUndefined(e.item.target)||anchor.setAttribute("target",e.item.target),ej2_richtexteditor_es2015_InsertHtml.Insert(this.parent.currentDocument,anchor,this.parent.editableElement),this.callBack(e)}openImageLink(e){document.defaultView.open(e.item.url,e.item.target),this.callBack(e)}removeImageLink(e){let selectParent=e.item.selectParent[0];if(selectParent.classList.contains("e-img-caption")){let capImgWrap=ej2_base_es2015_select(".e-img-wrap",selectParent),textEle=ej2_base_es2015_select(".e-img-inner",selectParent),newTextEle=textEle.cloneNode(!0);detach(ej2_base_es2015_select("a",selectParent)),detach(textEle),capImgWrap.appendChild(e.item.insertElement),capImgWrap.appendChild(newTextEle)}else detach(selectParent),Browser.isIE&&e.item.selection.restore(),ej2_richtexteditor_es2015_InsertHtml.Insert(this.parent.currentDocument,e.item.insertElement,this.parent.editableElement);this.callBack(e)}editImageLink(e){e.item.selectNode[0].parentElement.href=e.item.url,isNullOrUndefined(e.item.target)?e.item.selectNode[0].parentElement.removeAttribute("target"):e.item.selectNode[0].parentElement.target=e.item.target,this.callBack(e)}removeImage(e){closest(e.item.selectNode[0],"a")?detach(closest(e.item.selectNode[0],"a")):isNullOrUndefined(closest(e.item.selectNode[0],"."+CLASS_CAPTION))?detach(e.item.selectNode[0]):detach(closest(e.item.selectNode[0],"."+CLASS_CAPTION)),this.callBack(e)}insertAltTextImage(e){e.item.selectNode[0].setAttribute("alt",e.item.altText),this.callBack(e)}imageDimension(e){let selectNode=e.item.selectNode[0];selectNode.style.height="",selectNode.style.width="",selectNode.width=e.item.width,selectNode.height=e.item.height,this.callBack(e)}imageCaption(e){ej2_richtexteditor_es2015_InsertHtml.Insert(this.parent.currentDocument,e.item.insertElement,this.parent.editableElement),this.callBack(e)}imageJustifyLeft(e){let selectNode=e.item.selectNode[0];selectNode.removeAttribute("class"),addClass([selectNode],"e-rte-image"),isNullOrUndefined(closest(selectNode,"."+CLASS_CAPTION))||(removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_RIGHT),addClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_LEFT)),"A"===selectNode.parentElement.nodeName?(removeClass([selectNode.parentElement],CLASS_IMAGE_RIGHT),addClass([selectNode.parentElement],CLASS_IMAGE_LEFT)):addClass([selectNode],CLASS_IMAGE_LEFT),this.callBack(e)}imageJustifyCenter(e){let selectNode=e.item.selectNode[0];selectNode.removeAttribute("class"),addClass([selectNode],"e-rte-image"),isNullOrUndefined(closest(selectNode,"."+CLASS_CAPTION))||(removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_LEFT),removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_RIGHT),addClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_CENTER)),"A"===selectNode.parentElement.nodeName?(removeClass([selectNode.parentElement],CLASS_IMAGE_LEFT),removeClass([selectNode.parentElement],CLASS_IMAGE_RIGHT),addClass([selectNode.parentElement],CLASS_IMAGE_CENTER)):addClass([selectNode],CLASS_IMAGE_CENTER),this.callBack(e)}imageJustifyRight(e){let selectNode=e.item.selectNode[0];selectNode.removeAttribute("class"),addClass([selectNode],"e-rte-image"),isNullOrUndefined(closest(selectNode,"."+CLASS_CAPTION))||(removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_LEFT),addClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_RIGHT)),"A"===selectNode.parentElement.nodeName?(removeClass([selectNode.parentElement],CLASS_IMAGE_LEFT),addClass([selectNode.parentElement],CLASS_IMAGE_RIGHT)):addClass([selectNode],CLASS_IMAGE_RIGHT),this.callBack(e)}imageInline(e){let selectNode=e.item.selectNode[0];selectNode.removeAttribute("class"),addClass([selectNode],"e-rte-image"),addClass([selectNode],CLASS_IMAGE_INLINE),isNullOrUndefined(closest(selectNode,"."+CLASS_CAPTION))||(removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_BREAK),removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_CENTER),removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_LEFT),removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_RIGHT),addClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_CAPTION_INLINE)),this.callBack(e)}imageBreak(e){let selectNode=e.item.selectNode[0];selectNode.removeAttribute("class"),addClass([selectNode],CLASS_IMAGE_BREAK),addClass([selectNode],"e-rte-image"),isNullOrUndefined(closest(selectNode,"."+CLASS_CAPTION))||(removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_CAPTION_INLINE),removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_CENTER),removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_LEFT),removeClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_RIGHT),addClass([closest(selectNode,"."+CLASS_CAPTION)],CLASS_IMAGE_BREAK)),this.callBack(e)}callBack(e){e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}}class ej2_richtexteditor_es2015_TableCommand{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(TABLE,this.createTable,this),this.parent.observer.on(INSERT_ROW,this.insertRow,this),this.parent.observer.on(INSERT_COLUMN,this.insertColumn,this),this.parent.observer.on(DELETEROW,this.deleteRow,this),this.parent.observer.on(DELETECOLUMN,this.deleteColumn,this),this.parent.observer.on(REMOVETABLE,this.removeTable,this),this.parent.observer.on(TABLEHEADER,this.tableHeader,this),this.parent.observer.on(TABLE_VERTICAL_ALIGN,this.tableVerticalAlign,this)}createTable(e){let table=ej2_base_es2015_createElement("table",{className:"e-rte-table"}),tblBody=ej2_base_es2015_createElement("tbody");table.style.width=e.item.width.width;let tdWid=parseInt(e.item.width.width,10)/e.item.columns;for(let i=0;i<e.item.row;i++){let row=ej2_base_es2015_createElement("tr");for(let j=0;j<e.item.columns;j++){let cell=ej2_base_es2015_createElement("td");cell.appendChild(ej2_base_es2015_createElement("br")),cell.style.width=tdWid+"%",row.appendChild(cell)}tblBody.appendChild(row)}return table.appendChild(tblBody),e.item.selection.restore(),ej2_richtexteditor_es2015_InsertHtml.Insert(this.parent.currentDocument,table,this.parent.editableElement),this.removeEmptyNode(),e.item.selection.setSelectionText(this.parent.currentDocument,table.querySelector("td"),table.querySelector("td"),0,0),table.querySelector("td").classList.add("e-cell-select"),e.callBack&&e.callBack({requestType:"Table",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[table]}),table}removeEmptyNode(){let emptyUl=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty");for(let i=0;i<emptyUl.length;i++)detach(emptyUl[i]);let emptyLiChild=this.parent.editableElement.querySelectorAll("li *:empty");for(let i=0;i<emptyLiChild.length;i++)detach(emptyLiChild[i]),emptyLiChild.length===i+1&&(emptyLiChild=this.parent.editableElement.querySelectorAll("li *:empty"),i=-1);let emptyLi=this.parent.editableElement.querySelectorAll("li:empty");for(let i=0;i<emptyLi.length;i++)detach(emptyLi[i])}insertAfter(newNode,referenceNode){referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling)}insertRow(e){let selectedCell=e.item.selection.range.startContainer;if("th"===(selectedCell=3===selectedCell.nodeType?selectedCell.parentNode:selectedCell).nodeName.toLowerCase()&&"InsertRowBefore"===e.item.subCommand)return;let newRow,curRow=closest(selectedCell,"tr");if("th"!==selectedCell.nodeName.toLowerCase()){newRow=closest(selectedCell,"tr").cloneNode(!0);let tabCell=Array.prototype.slice.call(newRow.querySelectorAll("td"));Array.prototype.forEach.call(tabCell,cell=>{cell.innerHTML="",cell.appendChild(ej2_base_es2015_createElement("br")),cell.removeAttribute("class")})}else{let childNodes=curRow.childNodes;newRow=ej2_base_es2015_createElement("tr");for(let i=0;i<childNodes.length;i++){let tdElement=ej2_base_es2015_createElement("td");tdElement.appendChild(ej2_base_es2015_createElement("br")),newRow.appendChild(tdElement)}}"InsertRowBefore"===e.item.subCommand?curRow.parentElement.insertBefore(newRow,curRow):this.insertAfter(newRow,curRow),e.item.selection.setSelectionText(this.parent.currentDocument,e.item.selection.range.startContainer,e.item.selection.range.startContainer,0,0),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}insertColumn(e){let selectedCell=e.item.selection.range.startContainer;selectedCell="TD"!==(selectedCell=3===selectedCell.nodeType?selectedCell.parentNode:selectedCell).nodeName?closest(selectedCell,"td,th"):selectedCell;let curCell,curRow=closest(selectedCell,"tr"),allRows=closest(curRow,"table").rows,colIndex=Array.prototype.slice.call(curRow.querySelectorAll("th,td")).indexOf(selectedCell),width=parseInt(e.item.width,10)/(curRow.querySelectorAll("td,th").length+1);for(let j=0;j<closest(curRow,"table").querySelectorAll("th,td").length;j++)closest(curRow,"table").querySelectorAll("th,td")[j].style.width=width+"%";for(let i=0;i<allRows.length;i++){let colTemplate=(curCell=allRows[i].querySelectorAll("th,td")[colIndex]).cloneNode(!0);colTemplate.innerHTML="",colTemplate.appendChild(ej2_base_es2015_createElement("br")),colTemplate.removeAttribute("class"),"InsertColumnLeft"===e.item.subCommand?curCell.parentElement.insertBefore(colTemplate,curCell):this.insertAfter(colTemplate,curCell)}e.item.selection.setSelectionText(this.parent.currentDocument,selectedCell,selectedCell,0,0),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}deleteColumn(e){let selectedCell=e.item.selection.range.startContainer,selectedCellIndex=(selectedCell=3===selectedCell.nodeType?selectedCell.parentNode:selectedCell).cellIndex,parentTable=closest(selectedCell,"table"),curRow=closest(selectedCell,"tr"),allRows=closest(curRow,"table").rows;if(1===curRow.querySelectorAll("th,td").length)e.item.selection.restore(),detach(closest(selectedCell.parentElement,"table"));else for(let i=0;i<allRows.length;i++)allRows[i].deleteCell(selectedCellIndex),Browser.isIE&&(e.item.selection.setSelectionText(this.parent.currentDocument,parentTable.querySelector("td"),parentTable.querySelector("td"),0,0),parentTable.querySelector("td, th").classList.add("e-cell-select"));e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}deleteRow(e){let selectedCell=e.item.selection.range.startContainer,selectedRowIndex=(selectedCell=3===selectedCell.nodeType?selectedCell.parentNode:selectedCell).parentNode.rowIndex,parentTable=closest(selectedCell,"table");1===parentTable.rows.length?(e.item.selection.restore(),detach(closest(selectedCell.parentElement,"table"))):("TH"===selectedCell.tagName?detach(parentTable.querySelector("thead")):parentTable.deleteRow(selectedRowIndex),e.item.selection.setSelectionText(this.parent.currentDocument,parentTable.querySelector("td"),parentTable.querySelector("td"),0,0),parentTable.querySelector("td, th").classList.add("e-cell-select")),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}removeTable(e){let selectedCell=e.item.selection.range.startContainer,seletedTable=closest((selectedCell=3===selectedCell.nodeType?selectedCell.parentNode:selectedCell).parentElement,"table");seletedTable&&(e.item.selection.restore(),detach(seletedTable)),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}tableHeader(e){let headerExit=!1,selectedCell=e.item.selection.range.startContainer,table=closest((selectedCell=3===selectedCell.nodeType?selectedCell.parentNode:selectedCell).parentElement,"table");if([].slice.call(table.childNodes).forEach(el=>{"THEAD"===el.nodeName&&(headerExit=!0)}),table&&!headerExit){let cellCount=table.querySelector("tr").childElementCount,row=table.createTHead().insertRow(0);for(let i=0;i<cellCount;i++){let th=ej2_base_es2015_createElement("th");th.appendChild(ej2_base_es2015_createElement("br")),row.appendChild(th)}}else table.deleteTHead();e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}tableVerticalAlign(e){e.item.tableCell.style.verticalAlign="AlignTop"===e.item.subCommand?"top":"AlignMiddle"===e.item.subCommand?"middle":"bottom",e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}}let IsFormatted=(()=>{class IsFormatted{getFormattedNode(node,format,endNode){let parentNode=this.getFormatParent(node,format,endNode);return null!==parentNode&&parentNode!==endNode?parentNode:null}getFormatParent(node,format,endNode){do{node=node.parentNode}while(node&&node!==endNode&&!this.isFormattedNode(node,format));return node}isFormattedNode(node,format){switch(format){case"bold":return IsFormatted.isBold(node);case"italic":return IsFormatted.isItalic(node);case"underline":return IsFormatted.isUnderline(node);case"strikethrough":return IsFormatted.isStrikethrough(node);case"superscript":return IsFormatted.isSuperscript(node);case"subscript":return IsFormatted.isSubscript(node);case"fontcolor":return this.isFontColor(node);case"fontname":return this.isFontName(node);case"fontsize":return this.isFontSize(node);case"backgroundcolor":return this.isBackgroundColor(node);default:return!1}}static isBold(node){return-1!==["strong","b"].indexOf(node.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(node.nodeName.toLowerCase())||!node.style||"bold"!==node.style.fontWeight)}static isItalic(node){return-1!==["em","i"].indexOf(node.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(node.nodeName.toLowerCase())||!node.style||"italic"!==node.style.fontStyle)}static isUnderline(node){return-1!==["u"].indexOf(node.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(node.nodeName.toLowerCase())||!node.style||"underline"!==node.style.textDecoration)}static isStrikethrough(node){return-1!==["del","strike"].indexOf(node.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(node.nodeName.toLowerCase())||!node.style||"line-through"!==node.style.textDecoration)}static isSuperscript(node){return-1!==["sup"].indexOf(node.nodeName.toLowerCase())}static isSubscript(node){return-1!==["sub"].indexOf(node.nodeName.toLowerCase())}isFontColor(node){let color=node.style&&node.style.color;return-1!==IsFormatted.inlineTags.indexOf(node.nodeName.toLowerCase())&&null!==color&&""!==color&&void 0!==color}isBackgroundColor(node){let backColor=node.style&&node.style.backgroundColor;return-1!==IsFormatted.inlineTags.indexOf(node.nodeName.toLowerCase())&&null!==backColor&&""!==backColor&&void 0!==backColor}isFontSize(node){let size=node.style&&node.style.fontSize;return-1!==IsFormatted.inlineTags.indexOf(node.nodeName.toLowerCase())&&null!==size&&""!==size&&void 0!==size}isFontName(node){let name=node.style&&node.style.fontFamily;return-1!==IsFormatted.inlineTags.indexOf(node.nodeName.toLowerCase())&&null!==name&&""!==name&&void 0!==name}}return IsFormatted.inlineTags=["a","abbr","acronym","b","bdo","big","cite","code","dfn","em","i","kbd","label","q","samp","small","span","strong","sub","sup","tt","u","var"],IsFormatted})();class ej2_richtexteditor_es2015_SelectionCommands{static applyFormat(docElement,format,endNode,value,selector){if(["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase","fontcolor","fontname","fontsize","backgroundcolor"].indexOf(format)>-1){let domSelection=new NodeSelection,nodeCutter=new ej2_richtexteditor_es2015_NodeCutter,isFormatted=new IsFormatted,range=domSelection.getRange(docElement),save=domSelection.save(range,docElement),nodes=domSelection.getSelectionNodeCollection(range),isCollapsed=!1,isFormat=!1,isCursor=!1,isFontStyle=["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(format)>-1;if(range.collapsed)if(nodes.length>0)isCollapsed=!0,range=nodeCutter.GetCursorRange(docElement,range,nodes[0]);else if("td"!==range.startContainer.nodeName.toLowerCase()){let cursorNode=this.insertCursorNode(docElement,domSelection,range,isFormatted,nodeCutter,format,value,endNode);domSelection.endContainer=domSelection.startContainer=domSelection.getNodeArray(cursorNode,!0),domSelection.endOffset=domSelection.startOffset=1}isCursor=range.collapsed;for(let index=0;index<nodes.length;index++){let formatNode=isFormatted.getFormattedNode(nodes[index],format,endNode);0===index&&null===formatNode&&(isFormat=!0),nodes[index]=null===formatNode||isFormat&&!isFontStyle?this.insertFormat(docElement,nodes,index,formatNode,isCursor,isFormat,isFontStyle,range,nodeCutter,format,value):this.removeFormat(nodes,index,formatNode,isCursor,isFormat,isFontStyle,range,nodeCutter,format,value,domSelection),domSelection=this.applySelection(nodes,domSelection,nodeCutter,index,isCollapsed)}isIDevice$1()&&setEditFrameFocus(endNode,selector),save.restore()}}static insertCursorNode(docElement,domSelection,range,isFormatted,nodeCutter,format,value,endNode){let cursorNodes=domSelection.getNodeCollection(range),cursorFormat=cursorNodes.length>0?isFormatted.getFormattedNode(cursorNodes[0],format,endNode):null,cursorNode=null;return cursorFormat?(cursorNode=cursorNodes[0],InsertMethods.unwrap(cursorFormat),cursorNodes[0]=InsertMethods.Wrap(cursorNodes[0],this.GetFormatNode(format,value))):cursorNode=this.getInsertNode(docElement,range,format,value).firstChild,cursorNode}static removeFormat(nodes,index,formatNode,isCursor,isFormat,isFontStyle,range,nodeCutter,format,value,domSelection){let splitNode=null;if(range.startContainer!==range.endContainer||0!==range.startOffset||range.endOffset!==range.startContainer.length){let nodeIndex=[],cloneNode=nodes[index];do{nodeIndex.push(domSelection.getIndex(cloneNode)),cloneNode=cloneNode.parentNode}while(cloneNode&&cloneNode!==formatNode);if(cloneNode=splitNode=nodeCutter.GetSpliceNode(range,formatNode),isCursor){let lastNode=splitNode;for(;null!==lastNode.firstChild&&3!==lastNode.firstChild.nodeType;null)lastNode=lastNode.firstChild;lastNode.innerHTML="&#65279;&#65279;",nodes[index]=lastNode.firstChild}else{for(;cloneNode&&cloneNode.childNodes.length>0&&nodeIndex.length-1>=0&&cloneNode.childNodes.length>nodeIndex[nodeIndex.length-1];)cloneNode=cloneNode.childNodes[nodeIndex[nodeIndex.length-1]],nodeIndex.pop();if(3!==cloneNode.nodeType||isCursor&&""===cloneNode.nodeValue){let divNode=document.createElement("div");divNode.innerHTML="&#65279;&#65279;",3!==cloneNode.nodeType?(cloneNode.insertBefore(divNode.firstChild,cloneNode.firstChild),nodes[index]=cloneNode.firstChild):(cloneNode.parentNode.insertBefore(divNode.firstChild,cloneNode),nodes[index]=cloneNode.previousSibling,cloneNode.parentNode.removeChild(cloneNode))}else nodes[index]=cloneNode}}let child=InsertMethods.unwrap(formatNode);if(child.length>0&&isFontStyle){for(let num=0;num<child.length;num++)child[num]=InsertMethods.Wrap(child[num],this.GetFormatNode(format,value));if("fontsize"===format){let liElement=nodes[index].parentElement,parentElement=nodes[index].parentElement;for(;!isNullOrUndefined(parentElement)&&"li"!==parentElement.tagName.toLowerCase();)liElement=parentElement=parentElement.parentElement;isNullOrUndefined(liElement)||"li"!==liElement.tagName.toLowerCase()||liElement.textContent.trim()!==nodes[index].textContent.trim()||(liElement.style.fontSize=value)}}return nodes[index]}static insertFormat(docElement,nodes,index,formatNode,isCursor,isFormat,isFontStyle,range,nodeCutter,format,value){if(isCursor)if("uppercase"!==format&&"lowercase"!==format){let element=this.getInsertNode(docElement,range,format,value);nodes[index]=element.firstChild,nodeCutter.position=1}else nodeCutter.position=range.startOffset;else if(null===formatNode&&isFormat||isFontStyle){if(nodes[index]=nodeCutter.GetSpliceNode(range,nodes[index]),nodes[index].textContent=nodeCutter.TrimLineBreak(nodes[index].textContent),"uppercase"===format||"lowercase"===format)nodes[index].textContent="uppercase"===format?nodes[index].textContent.toLocaleUpperCase():nodes[index].textContent.toLocaleLowerCase();else if(!0!==isFontStyle||""!==value){let element=this.GetFormatNode(format,value);if("fontsize"===format){let liElement=nodes[index].parentElement,parentElement=nodes[index].parentElement;for(;!isNullOrUndefined(parentElement)&&"li"!==parentElement.tagName.toLowerCase();)liElement=parentElement=parentElement.parentElement;isNullOrUndefined(liElement)||"li"!==liElement.tagName.toLowerCase()||liElement.textContent.trim()!==nodes[index].textContent.trim()||(liElement.style.fontSize=value),nodes[index]=this.applyStyles(nodes,index,element)}else nodes[index]=this.applyStyles(nodes,index,element)}}else nodes[index]=nodeCutter.GetSpliceNode(range,nodes[index]);return nodes[index]}static applyStyles(nodes,index,element){return nodes[index]=index===nodes.length-1?InsertMethods.Wrap(nodes[index],element):InsertMethods.WrapBefore(nodes[index],element,!0),nodes[index]=this.getChildNode(nodes[index],element),nodes[index]}static getInsertNode(docElement,range,format,value){let element=this.GetFormatNode(format,value);if(element.innerHTML="&#65279;&#65279;",Browser.isIE){let frag=docElement.createDocumentFragment();frag.appendChild(element),range.insertNode(frag)}else range.insertNode(element);return element}static getChildNode(node,element){return null==node&&(element.innerHTML="&#65279;",node=element.firstChild),node}static applySelection(nodes,domSelection,nodeCutter,index,isCollapsed){return 1!==nodes.length||isCollapsed?1===nodes.length&&isCollapsed?(domSelection.startContainer=domSelection.getNodeArray(nodes[index],!0),domSelection.endContainer=domSelection.startContainer,domSelection.startOffset=nodeCutter.position,domSelection.endOffset=nodeCutter.position):0===index?(domSelection.startContainer=domSelection.getNodeArray(nodes[index],!0),domSelection.startOffset=0):index===nodes.length-1&&(domSelection.endContainer=domSelection.getNodeArray(nodes[index],!1),domSelection.endOffset=nodes[index].textContent.length):(domSelection.startContainer=domSelection.getNodeArray(nodes[index],!0),domSelection.endContainer=domSelection.startContainer,domSelection.startOffset=0,domSelection.endOffset=nodes[index].textContent.length),domSelection}static GetFormatNode(format,value){let node;switch(format){case"bold":return document.createElement("strong");case"italic":return document.createElement("em");case"underline":return(node=document.createElement("span")).style.textDecoration="underline",node;case"strikethrough":return(node=document.createElement("span")).style.textDecoration="line-through",node;case"superscript":return document.createElement("sup");case"subscript":return document.createElement("sub");case"fontcolor":return(node=document.createElement("span")).style.color=value,node.style.textDecoration="inherit",node;case"fontname":return(node=document.createElement("span")).style.fontFamily=value,node;case"fontsize":return(node=document.createElement("span")).style.fontSize=value,node;default:return(node=document.createElement("span")).style.backgroundColor=value,node}}}class SelectionBasedExec{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(SELECTION_TYPE,this.applySelection,this),this.parent.observer.on(KEY_DOWN_HANDLER,this.keyDownHandler,this)}keyDownHandler(e){e.event.ctrlKey&&["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase"].indexOf(e.event.action)>-1&&(e.event.preventDefault(),ej2_richtexteditor_es2015_SelectionCommands.applyFormat(this.parent.currentDocument,e.event.action,this.parent.editableElement),this.callBack(e,e.event.action))}applySelection(e){ej2_richtexteditor_es2015_SelectionCommands.applyFormat(this.parent.currentDocument,e.subCommand.toLocaleLowerCase(),this.parent.editableElement,e.value,e.selector),this.callBack(e,e.subCommand)}callBack(event,action){event.callBack&&event.callBack({requestType:action,event:event.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}}class InsertHtmlExec{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(INSERTHTML_TYPE,this.applyHtml,this)}applyHtml(e){ej2_richtexteditor_es2015_InsertHtml.Insert(this.parent.currentDocument,e.value,this.parent.editableElement),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}}let ClearFormat$1=(()=>{class ClearFormat$1{static clear(docElement,endNode,selector){let nodeSelection=new NodeSelection,nodeCutter=new ej2_richtexteditor_es2015_NodeCutter,range=nodeSelection.getRange(docElement),isCollapsed=range.collapsed,nodes=nodeSelection.getInsertNodeCollection(range),save=nodeSelection.save(range,docElement);if(!isCollapsed){let preNode=nodeCutter.GetSpliceNode(range,nodes[0]);if(1===nodes.length)nodeSelection.setSelectionContents(docElement,preNode),range=nodeSelection.getRange(docElement);else{let lasNode=nodeCutter.GetSpliceNode(range,nodes[nodes.length-1]);nodeSelection.setSelectionText(docElement,preNode,lasNode,0,3===lasNode.nodeType?lasNode.textContent.length:lasNode.childNodes.length),range=nodeSelection.getRange(docElement)}let exactNodes=nodeSelection.getNodeCollection(range),cloneSelectNodes=exactNodes.slice();this.clearInlines(nodeSelection.getSelectionNodes(cloneSelectNodes),cloneSelectNodes,nodeSelection.getRange(docElement),nodeCutter,endNode),this.reSelection(docElement,save,exactNodes),range=nodeSelection.getRange(docElement);let cloneParentNodes=(exactNodes=nodeSelection.getNodeCollection(range)).slice();this.clearBlocks(docElement,cloneParentNodes,endNode,nodeCutter,nodeSelection),isIDevice$1()&&setEditFrameFocus(endNode,selector),this.reSelection(docElement,save,exactNodes)}}static reSelection(docElement,save,exactNodes){let selectionNodes=save.getInsertNodes(exactNodes);save.startContainer=save.getNodeArray(selectionNodes[0],!0,docElement),save.startOffset=0,save.endContainer=save.getNodeArray(selectionNodes[selectionNodes.length-1],!1,docElement);let endIndexNode=selectionNodes[selectionNodes.length-1];save.endOffset=3===endIndexNode.nodeType?endIndexNode.textContent.length:endIndexNode.childNodes.length,save.restore()}static clearBlocks(docElement,nodes,endNode,nodeCutter,nodeSelection){let parentNodes=[];for(let index=0;index<nodes.length;index++)this.BLOCK_TAGS.indexOf(nodes[index].nodeName.toLocaleLowerCase())>-1&&-1===parentNodes.indexOf(nodes[index])?parentNodes.push(nodes[index]):this.BLOCK_TAGS.indexOf(nodes[index].parentNode.nodeName.toLocaleLowerCase())>-1&&-1===parentNodes.indexOf(nodes[index].parentNode)&&endNode!==nodes[index].parentNode&&parentNodes.push(nodes[index].parentNode);parentNodes=this.spliceParent(parentNodes,nodes)[0],parentNodes=this.removeParent(parentNodes),this.unWrap(docElement,parentNodes,nodeCutter,nodeSelection)}static spliceParent(parentNodes,nodes){for(let index1=0;index1<parentNodes.length;index1++){let len=parentNodes[index1].childNodes.length;for(let index2=0;index2<len;index2++)if(nodes.indexOf(parentNodes[index1].childNodes[index2])>0&&parentNodes[index1].childNodes[index2].childNodes.length>0&&(nodes=this.spliceParent([parentNodes[index1].childNodes[index2]],nodes)[1]),nodes.indexOf(parentNodes[index1].childNodes[index2])<=-1&&""!==parentNodes[index1].childNodes[index2].textContent.trim()){for(let index3=0;index3<len;index3++)nodes.indexOf(parentNodes[index1].childNodes[index3])>-1&&nodes.splice(nodes.indexOf(parentNodes[index1].childNodes[index3]),1);index2=parentNodes[index1].childNodes.length;let parentIndex=parentNodes.indexOf(parentNodes[index1].parentNode),nodeIndex=nodes.indexOf(parentNodes[index1].parentNode);parentIndex>-1&&parentNodes.splice(parentIndex,1),nodeIndex>-1&&nodes.splice(nodeIndex,1);let elementIndex=nodes.indexOf(parentNodes[index1]);elementIndex>-1&&nodes.splice(elementIndex,1),parentNodes.splice(index1,1),index1--}}return[parentNodes,nodes]}static removeChild(parentNodes,parentNode){let count=parentNode.childNodes.length;if(count>0)for(let index=0;index<count;index++)parentNodes.indexOf(parentNode.childNodes[index])>-1&&(parentNodes=this.removeChild(parentNodes,parentNode.childNodes[index])).splice(parentNodes.indexOf(parentNode.childNodes[index]),1);return parentNodes}static removeParent(parentNodes){for(let index=0;index<parentNodes.length;index++)parentNodes.indexOf(parentNodes[index].parentNode)>-1&&((parentNodes=this.removeChild(parentNodes,parentNodes[index])).splice(index,1),index--);return parentNodes}static unWrap(docElement,parentNodes,nodeCutter,nodeSelection){for(let index1=0;index1<parentNodes.length;index1++)if(this.NONVALID_TAGS.indexOf(parentNodes[index1].nodeName.toLowerCase())>-1&&parentNodes[index1].parentNode&&this.NONVALID_PARENT_TAGS.indexOf(parentNodes[index1].parentNode.nodeName.toLowerCase())>-1&&(nodeSelection.setSelectionText(docElement,parentNodes[index1],parentNodes[index1],0,parentNodes[index1].childNodes.length),InsertMethods.unwrap(nodeCutter.GetSpliceNode(nodeSelection.getRange(docElement),parentNodes[index1].parentNode))),"p"!==parentNodes[index1].nodeName.toLocaleLowerCase()){!(this.NONVALID_PARENT_TAGS.indexOf(parentNodes[index1].nodeName.toLowerCase())<0&&"p"!==parentNodes[index1].parentNode.nodeName.toLocaleLowerCase())||("blockquote"===parentNodes[index1].nodeName.toLocaleLowerCase()||"li"===parentNodes[index1].nodeName.toLocaleLowerCase())&&this.IGNORE_PARENT_TAGS.indexOf(parentNodes[index1].childNodes[0].nodeName.toLocaleLowerCase())>-1||1===parentNodes[index1].childNodes.length&&"p"===parentNodes[index1].childNodes[0].nodeName.toLocaleLowerCase()||InsertMethods.Wrap(parentNodes[index1],docElement.createElement("p"));let childNodes=InsertMethods.unwrap(parentNodes[index1]);1===childNodes.length&&"p"===childNodes[0].parentNode.nodeName.toLocaleLowerCase()&&(InsertMethods.Wrap(parentNodes[index1],docElement.createElement("p")),InsertMethods.unwrap(parentNodes[index1]));for(let index2=0;index2<childNodes.length;index2++)if(this.NONVALID_TAGS.indexOf(childNodes[index2].nodeName.toLowerCase())>-1)this.unWrap(docElement,[childNodes[index2]],nodeCutter,nodeSelection);else if(this.BLOCK_TAGS.indexOf(childNodes[index2].nodeName.toLocaleLowerCase())>-1&&"p"!==childNodes[index2].nodeName.toLocaleLowerCase()){let blockNodes=this.removeParent([childNodes[index2]]);this.unWrap(docElement,blockNodes,nodeCutter,nodeSelection)}else this.BLOCK_TAGS.indexOf(childNodes[index2].nodeName.toLocaleLowerCase())>-1&&childNodes[index2].parentNode.nodeName.toLocaleLowerCase()===childNodes[index2].nodeName.toLocaleLowerCase()?InsertMethods.unwrap(childNodes[index2]):this.BLOCK_TAGS.indexOf(childNodes[index2].nodeName.toLocaleLowerCase())>-1&&"p"===childNodes[index2].nodeName.toLocaleLowerCase()&&(InsertMethods.Wrap(childNodes[index2],docElement.createElement("p")),InsertMethods.unwrap(childNodes[index2]))}else InsertMethods.Wrap(parentNodes[index1],docElement.createElement("p")),InsertMethods.unwrap(parentNodes[index1])}static clearInlines(textNodes,nodes,range,nodeCutter,endNode){for(let index=0;index<textNodes.length;index++)textNodes[index].parentNode&&IsFormatted.inlineTags.indexOf(textNodes[index].parentNode.nodeName.toLocaleLowerCase())>-1&&(nodeCutter.GetSpliceNode(range,textNodes[index].parentNode),this.removeInlineParent(textNodes[index].parentNode))}static removeInlineParent(textNodes){let nodes=InsertMethods.unwrap(textNodes);for(let index=0;index<nodes.length;index++)1===nodes[index].parentNode.childNodes.length&&IsFormatted.inlineTags.indexOf(nodes[index].parentNode.nodeName.toLocaleLowerCase())>-1?this.removeInlineParent(nodes[index].parentNode):IsFormatted.inlineTags.indexOf(nodes[index].nodeName.toLocaleLowerCase())>-1&&this.removeInlineParent(nodes[index])}}return ClearFormat$1.BLOCK_TAGS=["address","article","aside","blockquote","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","li","main","nav","noscript","ol","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul"],ClearFormat$1.NONVALID_PARENT_TAGS=["thead","tbody","ul","ol","table","tfoot","tr"],ClearFormat$1.IGNORE_PARENT_TAGS=["ul","ol","table"],ClearFormat$1.NONVALID_TAGS=["thead","tbody","figcaption","td","tr","th","tfoot","figcaption","li"],ClearFormat$1})();class ClearFormatExec{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(CLEAR_TYPE,this.applyClear,this),this.parent.observer.on(KEY_DOWN_HANDLER,this.onKeyDown,this)}onKeyDown(e){switch(e.event.action){case"clear-format":this.applyClear({subCommand:"ClearFormat",callBack:e.callBack}),e.event.preventDefault()}}applyClear(e){"ClearFormat"===e.subCommand&&(ClearFormat$1.clear(this.parent.currentDocument,this.parent.editableElement,e.selector),e.callBack&&e.callBack({requestType:e.subCommand,event:e.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))}}class ej2_richtexteditor_es2015_UndoRedoManager{constructor(parent,options){this.undoRedoStack=[],this.parent=parent,this.undoRedoSteps=isNullOrUndefined(options)?30:options.undoRedoSteps,this.undoRedoTimer=isNullOrUndefined(options)?300:options.undoRedoTimer,this.addEventListener()}addEventListener(){let debounceListener=debounce(this.keyUp,this.undoRedoTimer);this.parent.observer.on(KEY_UP_HANDLER,debounceListener,this),this.parent.observer.on(KEY_DOWN_HANDLER,this.keyDown,this),this.parent.observer.on(ACTION,this.onAction,this),this.parent.observer.on(MODEL_CHANGED_PLUGIN,this.onPropertyChanged,this)}onPropertyChanged(props){for(let prop of Object.keys(props.newProp))switch(prop){case"undoRedoSteps":this.undoRedoSteps=props.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=props.newProp.undoRedoTimer}}removeEventListener(){this.parent.observer.off(KEY_UP_HANDLER,this.keyUp),this.parent.observer.off(KEY_DOWN_HANDLER,this.keyDown),this.parent.observer.off(ACTION,this.onAction)}onAction(e){"Undo"===e.subCommand?this.undo(e):this.redo(e)}destroy(){this.removeEventListener()}keyDown(e){let event=e.event,proxy=this;switch(event.action){case"undo":event.preventDefault(),proxy.undo(e);break;case"redo":event.preventDefault(),proxy.redo(e)}}keyUp(e){17===e.event.keyCode||e.event.ctrlKey||this.saveData(e)}saveData(e){let range=(new NodeSelection).getRange(this.parent.currentDocument),save=(new NodeSelection).save(range,this.parent.currentDocument),changEle={text:this.parent.editableElement.innerHTML,range:save};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1)),this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.collapsed===range.collapsed&&this.undoRedoStack[this.undoRedoStack.length-1].range.startOffset===save.range.startOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.endOffset===save.range.endOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.startContainer===save.range.startContainer&&this.undoRedoStack[this.undoRedoStack.length-1].text.trim()===changEle.text.trim()||(this.undoRedoStack.push(changEle),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),e&&e.callBack&&e.callBack())}undo(e){if(this.steps>0){let range=this.undoRedoStack[this.steps-1].range;this.parent.editableElement.innerHTML=this.undoRedoStack[this.steps-1].text,this.parent.editableElement.focus(),isIDevice$1()&&setEditFrameFocus(this.parent.editableElement,e.selector),range.restore(),this.steps--,e.callBack&&e.callBack({requestType:"Undo",editorMode:"HTML",range:range,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:e.event})}}redo(e){if(null!=this.undoRedoStack[this.steps+1]){let range=this.undoRedoStack[this.steps+1].range;this.parent.editableElement.innerHTML=this.undoRedoStack[this.steps+1].text,this.parent.editableElement.focus(),isIDevice$1()&&setEditFrameFocus(this.parent.editableElement,e.selector),range.restore(),this.steps++,e.callBack&&e.callBack({requestType:"Redo",editorMode:"HTML",range:range,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:e.event})}}getUndoStatus(){let status={undo:!1,redo:!1};return this.steps>0&&(status.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(status.redo=!0),status}}class ej2_richtexteditor_es2015_MsWordPaste{constructor(parent){this.olData=["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman","lower-greek"],this.ulData=["disc","square","circle","disc","square","circle"],this.ignorableNodes=["A","APPLET","B","BLOCKQUOTE","BR","BUTTON","CENTER","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HR","I","IMG","IFRAME","INPUT","INS","LABEL","LI","OL","OPTION","P","PARAM","PRE","Q","S","SELECT","SPAN","STRIKE","STRONG","SUB","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL"],this.blockNode=["div","p","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","table","tbody","td","tfoot","th","thead","tr","ul","header","article","nav","footer","section","aside","main","figure","figcaption"],this.removableElements=["o:p","style"],this.listContents=[],this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(MS_WORD_CLEANUP_PLUGIN,this.wordCleanup,this)}wordCleanup(e){let wordPasteStyleConfig=e.allowedStylePropertiesArray,listNodes=[],tempHTMLContent=e.args.clipboardData.getData("text/HTML"),elm=ej2_base_es2015_createElement("p");elm.innerHTML=tempHTMLContent,/class='?Mso|style='[^ ]*\bmso-/i.test(tempHTMLContent)||/class="?Mso|style="[^ ]*\bmso-/i.test(tempHTMLContent)?(tempHTMLContent=tempHTMLContent.replace(/<img[^>]+>/i,""),listNodes=this.cleanUp(elm,listNodes),this.listConverter(listNodes),this.styleCorrection(elm,wordPasteStyleConfig),this.removingComments(elm),this.removeUnwantedElements(elm),this.removeEmptyElements(elm),this.breakLineAddition(elm),this.removeClassName(elm),e.callBack(elm.innerHTML)):e.callBack(elm.innerHTML)}removeClassName(elm){let elmWithClass=elm.querySelectorAll("*[class]");for(let i=0;i<elmWithClass.length;i++)elmWithClass[i].removeAttribute("class")}breakLineAddition(elm){let allElements=elm.querySelectorAll("*");for(let i=0;i<allElements.length;i++)if(0===allElements[i].children.length&&"&nbsp;"===allElements[i].innerHTML){let detachableElement=this.findDetachElem(allElements[i]),brElement=ej2_base_es2015_createElement("br");detachableElement.parentElement.insertBefore(brElement,detachableElement),detach(detachableElement)}}findDetachElem(element){return""===element.parentElement.textContent.trim()&&"TD"!==element.parentElement.tagName?this.findDetachElem(element.parentElement):element}removeUnwantedElements(elm){let innerElement=elm.innerHTML;for(let i=0;i<this.removableElements.length;i++){let regExpStartElem=new RegExp("<"+this.removableElements[i]+">","g"),regExpEndElem=new RegExp("</"+this.removableElements[i]+">","g");innerElement=(innerElement=innerElement.replace(regExpStartElem,"")).replace(regExpEndElem,"")}elm.innerHTML=innerElement,elm.querySelectorAll(":empty")}findDetachEmptyElem(element){return isNullOrUndefined(element.parentElement)?null:""===element.parentElement.textContent.trim()?this.findDetachEmptyElem(element.parentElement):element}removeEmptyElements(element){let emptyElements=element.querySelectorAll(":empty");for(let i=0;i<emptyElements.length;i++)"IMG"!==emptyElements[i].tagName&&"BR"!==emptyElements[i].tagName&&detach(this.findDetachEmptyElem(emptyElements[i]))}styleCorrection(elm,wordPasteStyleConfig){let styleElement=elm.querySelectorAll("style");if(styleElement.length>0){let resultElem,styles=styleElement[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi),styleClassObject=isNullOrUndefined(styles)?null:this.findStyleObject(styles),keys=Object.keys(styleClassObject),values=keys.map(key=>styleClassObject[key]);values=this.removeUnwantedStyle(values,wordPasteStyleConfig),this.filterStyles(elm,wordPasteStyleConfig);for(let i=0;i<keys.length;i++){if(""===keys[i].split(".")[0])resultElem=elm.getElementsByClassName(keys[i].split(".")[1]);else{if(1===keys[i].split(".").length&&keys[i].split(".")[0].indexOf("@")>=0)continue;resultElem=1===keys[i].split(".").length&&keys[i].split(".")[0].indexOf("@")<0?elm.getElementsByTagName(keys[i]):elm.querySelectorAll(keys[i])}for(let j=0;j<resultElem.length;j++){let styleProperty=resultElem[j].getAttribute("style");if(isNullOrUndefined(styleProperty)||""===styleProperty.trim())resultElem[j].setAttribute("style",values[i]);else{let valueSplit=values[i].split(";");for(let k=0;k<valueSplit.length;k++)styleProperty.indexOf(valueSplit[k].split(":")[0])>=0&&(valueSplit.splice(k,1),k--);values[i]=valueSplit.join(";")+";",resultElem[j].setAttribute("style",values[i]+styleProperty)}}}}}filterStyles(elm,wordPasteStyleConfig){let elmWithStyles=elm.querySelectorAll("*[style]");for(let i=0;i<elmWithStyles.length;i++){let elemStyleProperty=elmWithStyles[i].getAttribute("style").split(";"),styleValue="";for(let j=0;j<elemStyleProperty.length;j++)wordPasteStyleConfig.indexOf(elemStyleProperty[j].split(":")[0].trim())>=0&&(styleValue+=elemStyleProperty[j]+";");elmWithStyles[i].setAttribute("style",styleValue)}}removeUnwantedStyle(values,wordPasteStyleConfig){for(let i=0;i<values.length;i++){let styleValues=values[i].split(";");values[i]="";for(let j=0;j<styleValues.length;j++)wordPasteStyleConfig.indexOf(styleValues[j].split(":")[0])>=0&&(values[i]+=styleValues[j]+";")}return values}findStyleObject(styles){let styleClassObject={};for(let i=0;i<styles.length;i++){let tempStyle=styles[i],classNameCollection=tempStyle.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),stylesCollection=tempStyle.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");classNameCollection=classNameCollection.replace(/^[\s]|[\s]$/gm,""),stylesCollection=stylesCollection.replace(/^[\s]|[\s]$/gm,""),classNameCollection=classNameCollection.replace(/\n|\r|\n\r/g,""),stylesCollection=stylesCollection.replace(/\n|\r|\n\r/g,"");for(let classNames=classNameCollection.split(", "),j=0;j<classNames.length;j++)styleClassObject[classNames[j]]=stylesCollection}return styleClassObject}removingComments(elm){let innerElement=elm.innerHTML;innerElement=innerElement.replace(/<!--[\s\S]*?-->/g,""),elm.innerHTML=innerElement}cleanUp(node,listNodes){let prevflagState,tempCleaner=[],allNodes=node.querySelectorAll("*");for(let index=0;index<allNodes.length;index++)-1===this.ignorableNodes.indexOf(allNodes[index].nodeName)||3===allNodes[index].nodeType&&""===allNodes[index].textContent.trim()?tempCleaner.push(allNodes[index]):(allNodes[index].className&&-1!==allNodes[index].className.toLowerCase().indexOf("msolistparagraph")&&listNodes.push(allNodes[index]),!prevflagState||-1===this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase())||allNodes[index].className&&-1!==allNodes[index].className.toLowerCase().indexOf("msolistparagraph")||listNodes.push(null),-1!==this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase())&&(prevflagState=!(!allNodes[index].className||-1===allNodes[index].className.toLowerCase().indexOf("msolistparagraph"))));return listNodes.length&&null!==listNodes[listNodes.length-1]&&listNodes.push(null),listNodes}listConverter(listNodes){let level,stNode,data=[],collection=[],content="";for(let i=0;i<listNodes.length;i++){if(null===listNodes[i]){data.push({content:this.makeConversion(collection),node:listNodes[i-1]}),collection=[];continue}let type;if(level=(content=listNodes[i].getAttribute("style"))&&-1!==content.indexOf("level")?parseInt(content.charAt(content.indexOf("level")+5),null):1,this.listContents=[],this.getListContent(listNodes[i]),!isNullOrUndefined(this.listContents[0])){type=this.listContents[0].trim().length>1?"ol":"ul";let tempNode=[];for(let j=1;j<this.listContents.length;j++)tempNode.push(this.listContents[j]);collection.push({listType:type,content:tempNode,nestedLevel:level})}}for(stNode=listNodes.shift();stNode;){let elemColl=[];for(let temp1=0;temp1<data.length;temp1++)if(data[temp1].node===stNode){for(let index=0;index<data[temp1].content.childNodes.length;index++)elemColl.push(data[temp1].content.childNodes[index]);for(let index=0;index<elemColl.length;index++)stNode.parentElement.insertBefore(elemColl[index],stNode);break}stNode.remove(),(stNode=listNodes.shift())||(stNode=listNodes.shift())}}makeConversion(collection){let temp,prevList,elem,root=ej2_base_es2015_createElement("div"),pLevel=1,listCount=0;for(let index=0;index<collection.length;index++){let pElement=ej2_base_es2015_createElement("p");if(pElement.innerHTML=collection[index].content.join(" "),1===collection[index].nestedLevel&&0===listCount&&collection[index].content)root.appendChild(temp=ej2_base_es2015_createElement(collection[index].listType)),(prevList=ej2_base_es2015_createElement("li")).appendChild(pElement),temp.appendChild(prevList),temp.setAttribute("level",collection[index].nestedLevel.toString()),temp.style.listStyle=this.getListStyle(collection[index].listType,collection[index].nestedLevel);else if(collection[index].nestedLevel===pLevel)prevList.parentElement.tagName.toLowerCase()===collection[index].listType?(prevList.parentElement.appendChild(prevList=ej2_base_es2015_createElement("li")),prevList.appendChild(pElement)):(temp=ej2_base_es2015_createElement(collection[index].listType),prevList.parentElement.parentElement.appendChild(temp),(prevList=ej2_base_es2015_createElement("li")).appendChild(pElement),temp.appendChild(prevList),temp.setAttribute("level",collection[index].nestedLevel.toString()));else if(collection[index].nestedLevel>pLevel){for(let j=0;j<collection[index].nestedLevel-pLevel;j++)prevList.appendChild(temp=ej2_base_es2015_createElement(collection[index].listType)),prevList=ej2_base_es2015_createElement("li",{styles:"list-style-type: none;"}),temp.appendChild(prevList);prevList.appendChild(pElement),temp.setAttribute("level",collection[index].nestedLevel.toString()),temp.style.listStyle=this.getListStyle(collection[index].listType,collection[index].nestedLevel),temp.childNodes[0].style.listStyle=this.getListStyle(collection[index].listType,collection[index].nestedLevel)}else if(1===collection[index].nestedLevel)root.lastChild.tagName.toLowerCase()===collection[index].listType?temp=root.lastChild:root.appendChild(temp=ej2_base_es2015_createElement(collection[index].listType)),(prevList=ej2_base_es2015_createElement("li")).appendChild(pElement),temp.appendChild(prevList),temp.setAttribute("level",collection[index].nestedLevel.toString()),temp.style.listStyle=this.getListStyle(collection[index].listType,collection[index].nestedLevel);else for(elem=prevList;elem.parentElement;)if((elem=elem.parentElement).attributes.getNamedItem("level")){if(parseInt(elem.attributes.getNamedItem("level").textContent,null)===collection[index].nestedLevel){(prevList=ej2_base_es2015_createElement("li")).appendChild(pElement),elem.appendChild(prevList);break}if(collection[index].nestedLevel>parseInt(elem.attributes.getNamedItem("level").textContent,null)){elem.appendChild(temp=ej2_base_es2015_createElement(collection[index].listType)),(prevList=ej2_base_es2015_createElement("li")).appendChild(pElement),temp.appendChild(prevList),temp.setAttribute("level",collection[index].nestedLevel.toString()),temp.style.listStyle=this.getListStyle(collection[index].listType,collection[index].nestedLevel);break}}pLevel=collection[index].nestedLevel,listCount++}return root}getListStyle(listType,nestedLevel){return nestedLevel=nestedLevel>0?nestedLevel-1:nestedLevel,"ol"===listType?nestedLevel<this.olData.length?this.olData[nestedLevel]:this.olData[0]:nestedLevel<this.ulData.length?this.ulData[nestedLevel]:this.ulData[0]}getListContent(elem){this.listContents.push(elem.firstElementChild.textContent.trim()),detach(elem.firstElementChild),this.listContents.push(elem.innerHTML)}}class InsertTextExec{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.observer.on(INSERT_TEXT_TYPE,this.insertText,this)}insertText(e){let node=document.createTextNode(e.value);ej2_richtexteditor_es2015_InsertHtml.Insert(this.parent.currentDocument,node),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}}class ej2_richtexteditor_es2015_EditorManager{constructor(options){this.currentDocument=options.document,this.editableElement=options.editableElement,this.nodeSelection=new NodeSelection,this.domNode=new ej2_richtexteditor_es2015_DOMNode(this.editableElement,this.currentDocument),this.observer=new Observer(this),this.listObj=new ej2_richtexteditor_es2015_Lists(this),this.formatObj=new ej2_richtexteditor_es2015_Formats(this),this.alignmentObj=new ej2_richtexteditor_es2015_Alignments(this),this.indentsObj=new Indents(this),this.linkObj=new ej2_richtexteditor_es2015_LinkCommand(this),this.imgObj=new ej2_richtexteditor_es2015_ImageCommand(this),this.selectionObj=new SelectionBasedExec(this),this.inserthtmlObj=new InsertHtmlExec(this),this.insertTextObj=new InsertTextExec(this),this.clearObj=new ClearFormatExec(this),this.tableObj=new ej2_richtexteditor_es2015_TableCommand(this),this.undoRedoManager=new ej2_richtexteditor_es2015_UndoRedoManager(this,options.options),this.msWordPaste=new ej2_richtexteditor_es2015_MsWordPaste(this),this.wireEvents()}wireEvents(){this.observer.on(KEY_DOWN,this.editorKeyDown,this),this.observer.on(KEY_UP,this.editorKeyUp,this),this.observer.on(KEY_UP,this.editorKeyUp,this),this.observer.on(MODEL_CHANGED,this.onPropertyChanged,this),this.observer.on(MS_WORD_CLEANUP,this.onWordPaste,this)}onWordPaste(e){this.observer.notify(MS_WORD_CLEANUP_PLUGIN,e)}onPropertyChanged(props){this.observer.notify(MODEL_CHANGED_PLUGIN,props)}editorKeyDown(e){this.observer.notify(KEY_DOWN_HANDLER,e)}editorKeyUp(e){this.observer.notify(KEY_UP_HANDLER,e)}execCommand(command,value,event,callBack,text,exeValue,selector){switch(command.toLocaleLowerCase()){case"lists":this.observer.notify(LIST_TYPE,{subCommand:value,event:event,callBack:callBack,selector:selector});break;case"formats":this.observer.notify(FORMAT_TYPE,{subCommand:value,event:event,callBack:callBack,selector:selector});break;case"alignments":this.observer.notify(ALIGNMENT_TYPE,{subCommand:value,event:event,callBack:callBack,selector:selector,value:exeValue});break;case"indents":this.observer.notify(INDENT_TYPE,{subCommand:value,event:event,callBack:callBack,selector:selector});break;case"links":this.observer.notify(ej2_richtexteditor_es2015_LINK,{command:command,value:value,item:exeValue,event:event,callBack:callBack});break;case"images":this.observer.notify(ej2_richtexteditor_es2015_IMAGE,{command:command,value:value,item:exeValue,event:event,callBack:callBack,selector:selector});break;case"table":switch(value.toString().toLocaleLowerCase()){case"createtable":this.observer.notify(TABLE,{item:exeValue,event:event,callBack:callBack});break;case"insertrowbefore":case"insertrowafter":this.observer.notify(INSERT_ROW,{item:exeValue,event:event,callBack:callBack});break;case"insertcolumnleft":case"insertcolumnright":this.observer.notify(INSERT_COLUMN,{item:exeValue,event:event,callBack:callBack});break;case"deleterow":this.observer.notify(DELETEROW,{item:exeValue,event:event,callBack:callBack});break;case"deletecolumn":this.observer.notify(DELETECOLUMN,{item:exeValue,event:event,callBack:callBack});break;case"tableremove":this.observer.notify(REMOVETABLE,{item:exeValue,event:event,callBack:callBack});break;case"tableheader":this.observer.notify(TABLEHEADER,{item:exeValue,event:event,callBack:callBack});break;case"aligntop":case"alignmiddle":case"alignbottom":this.observer.notify(TABLE_VERTICAL_ALIGN,{item:exeValue,event:event,callBack:callBack})}break;case"font":case"style":case"effects":case"casing":this.observer.notify(SELECTION_TYPE,{subCommand:value,event:event,callBack:callBack,value:text,selector:selector});break;case"inserthtml":this.observer.notify(INSERTHTML_TYPE,{subCommand:value,callBack:callBack,value:text});break;case"inserttext":this.observer.notify(INSERT_TEXT_TYPE,{subCommand:value,callBack:callBack,value:text});break;case"clear":this.observer.notify(CLEAR_TYPE,{subCommand:value,event:event,callBack:callBack,selector:selector});break;case"actions":this.observer.notify(ACTION,{subCommand:value,event:event,callBack:callBack,selector:selector})}}}class ej2_richtexteditor_es2015_HTMLFormatter extends ej2_richtexteditor_es2015_Formatter{constructor(options){super(),this.initialize(),extend(this,this,options,!0),this.currentDocument&&this.element&&this.updateFormatter(this.element,this.currentDocument,options.options)}initialize(){this.keyConfig=htmlKeyConfig}updateFormatter(editElement,doc,options){editElement&&doc&&(this.editorManager=new ej2_richtexteditor_es2015_EditorManager({document:doc,editableElement:editElement,options:options}))}}const statusCollection={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1};class ToolbarStatus{static get(docElement,targetNode,formatNode,fontSize,fontName,documentNode){let formatCollection=JSON.parse(JSON.stringify(statusCollection)),nodeCollection=JSON.parse(JSON.stringify(statusCollection)),nodeSelection=new NodeSelection,nodes=documentNode?[documentNode]:nodeSelection.getNodeCollection(nodeSelection.getRange(docElement)),nodesLength=nodes.length;for(let index=0;index<nodes.length;index++)(3!==nodes[index].nodeType||nodesLength>1&&3===nodes[index].nodeType&&""===nodes[index].textContent.trim())&&(nodes.splice(index,1),index--);for(let index=0;index<nodes.length;index++)formatCollection=this.getFormatParent(docElement,formatCollection,nodes[index],targetNode,formatNode,fontSize,fontName),(0===index&&formatCollection.bold||!formatCollection.bold)&&(nodeCollection.bold=formatCollection.bold),(0===index&&formatCollection.italic||!formatCollection.italic)&&(nodeCollection.italic=formatCollection.italic),(0===index&&formatCollection.underline||!formatCollection.underline)&&(nodeCollection.underline=formatCollection.underline),(0===index&&formatCollection.strikethrough||!formatCollection.strikethrough)&&(nodeCollection.strikethrough=formatCollection.strikethrough),(0===index&&formatCollection.superscript||!formatCollection.superscript)&&(nodeCollection.superscript=formatCollection.superscript),(0===index&&formatCollection.subscript||!formatCollection.subscript)&&(nodeCollection.subscript=formatCollection.subscript),(0===index&&formatCollection.fontcolor||!formatCollection.fontcolor)&&(nodeCollection.fontcolor=formatCollection.fontcolor),(0===index&&formatCollection.fontname||!formatCollection.fontname)&&(nodeCollection.fontname=formatCollection.fontname),(0===index&&formatCollection.fontsize||!formatCollection.fontsize)&&(nodeCollection.fontsize=formatCollection.fontsize),(0===index&&formatCollection.backgroundcolor||!formatCollection.backgroundcolor)&&(nodeCollection.backgroundcolor=formatCollection.backgroundcolor),(0===index&&formatCollection.orderedlist||!formatCollection.orderedlist)&&(nodeCollection.orderedlist=formatCollection.orderedlist),(0===index&&formatCollection.unorderedlist||!formatCollection.unorderedlist)&&(nodeCollection.unorderedlist=formatCollection.unorderedlist),(0===index&&formatCollection.alignments||!formatCollection.alignments)&&(nodeCollection.alignments=formatCollection.alignments),(0===index&&formatCollection.formats||!formatCollection.formats)&&(nodeCollection.formats=formatCollection.formats),(0===index&&formatCollection.createlink||!formatCollection.createlink)&&(nodeCollection.createlink=formatCollection.createlink),formatCollection=JSON.parse(JSON.stringify(statusCollection));return nodeCollection}static getFormatParent(docElement,formatCollection,node,targetNode,formatNode,fontSize,fontName){if(targetNode.contains(node)||3===node.nodeType&&3!==targetNode.nodeType&&targetNode.contains(node.parentNode))do{formatCollection=this.isFormattedNode(docElement,formatCollection,node,formatNode,fontSize,fontName),node=node.parentNode}while(node&&node!==targetNode);return formatCollection}static isFormattedNode(docElement,formatCollection,node,formatNode,fontSize,fontName){return formatCollection.bold||(formatCollection.bold=IsFormatted.isBold(node)),formatCollection.italic||(formatCollection.italic=IsFormatted.isItalic(node)),formatCollection.underline||(formatCollection.underline=IsFormatted.isUnderline(node)),formatCollection.strikethrough||(formatCollection.strikethrough=IsFormatted.isStrikethrough(node)),formatCollection.superscript||(formatCollection.superscript=IsFormatted.isSuperscript(node)),formatCollection.subscript||(formatCollection.subscript=IsFormatted.isSubscript(node)),formatCollection.fontcolor||(formatCollection.fontcolor=this.isFontColor(docElement,node)),formatCollection.fontname||(formatCollection.fontname=this.isFontName(docElement,node,fontName)),formatCollection.fontsize||(formatCollection.fontsize=this.isFontSize(node,fontSize)),formatCollection.backgroundcolor||(formatCollection.backgroundcolor=this.isBackgroundColor(node)),formatCollection.orderedlist||(formatCollection.orderedlist=this.isOrderedList(node)),formatCollection.unorderedlist||(formatCollection.unorderedlist=this.isUnorderedList(node)),formatCollection.alignments||(formatCollection.alignments=this.isAlignment(node)),formatCollection.formats||(formatCollection.formats=this.isFormats(node,formatNode)),formatCollection.createlink||(formatCollection.createlink=this.isLink(node)),formatCollection}static isFontColor(docElement,node){let color=node.style&&node.style.color;return null!=color&&""!==color||3===node.nodeType||(color=this.getComputedStyle(docElement,node,"color")),null!==color&&""!==color&&void 0!==color?color:null}static isLink(node){return"a"===node.nodeName.toLocaleLowerCase()}static isBackgroundColor(node){let backColor=node.style&&node.style.backgroundColor;return null!==backColor&&""!==backColor&&void 0!==backColor?backColor:null}static isFontSize(node,fontSize){let size=node.style&&node.style.fontSize;return null!==size&&""!==size&&void 0!==size&&(null==fontSize||fontSize.indexOf(size)>-1)?size:null}static isFontName(docElement,node,fontName){let name=node.style&&node.style.fontFamily;null!=name&&""!==name||3===node.nodeType||(name=this.getComputedStyle(docElement,node,"font-family"));let index=null;return null!==name&&""!==name&&void 0!==name&&(null==fontName||fontName.filter((value,pos)=>{let pattern=new RegExp(name,"i");(value.replace(/"/g,"").replace(/ /g,"")===name.replace(/"/g,"").replace(/ /g,"")||value.search(pattern)>-1)&&(index=pos)})&&null!==index)?null!==index?fontName[index]:name.replace(/"/g,""):null}static isOrderedList(node){return"ol"===node.nodeName.toLocaleLowerCase()}static isUnorderedList(node){return"ul"===node.nodeName.toLocaleLowerCase()}static isAlignment(node){let align=node.style&&node.style.textAlign;return"left"===align?"justifyleft":"center"===align?"justifycenter":"right"===align?"justifyright":"justify"===align?"justifyfull":null}static isFormats(node,formatNode){return null==formatNode&&BLOCK_TAGS.indexOf(node.nodeName.toLocaleLowerCase())>-1||null!=formatNode&&formatNode.indexOf(node.nodeName.toLocaleLowerCase())>-1?node.nodeName.toLocaleLowerCase():null}static getComputedStyle(docElement,node,prop){return docElement.defaultView.getComputedStyle(node,null).getPropertyValue(prop)}}class HtmlToolbarStatus{constructor(parent){this.parent=parent,this.addEventListener()}addEventListener(){this.parent.on(ej2_richtexteditor_es2015_toolbarRefresh,this.onRefreshHandler,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.removeEventListener,this)}removeEventListener(){this.parent.off(ej2_richtexteditor_es2015_toolbarRefresh,this.onRefreshHandler)}onRefreshHandler(args){let fontsize=[],fontName=[],formats=[];this.parent.fontSize.items.forEach(item=>{fontsize.push(item.value)}),this.parent.fontFamily.items.forEach(item=>{fontName.push(item.value)}),this.parent.format.types.forEach(item=>{formats.push(item.value.toLocaleLowerCase())}),this.toolbarStatus=ToolbarStatus.get(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel(),formats,fontsize,fontName,args.documentNode),this.parent.notify(toolbarUpdated,this.toolbarStatus)}}class ej2_richtexteditor_es2015_ContentRender{constructor(parent,serviceLocator){this.parent=parent,this.serviceLocator=serviceLocator}renderPanel(){let rteObj=this.parent,div=this.parent.createElement("div",{className:"e-rte-content",id:this.parent.getID()+"rte-view"}),rteContent=getEditValue(rteObj.value,rteObj);this.editableElement=this.parent.createElement("div",{className:"e-content",id:this.parent.getID()+"_rte-edit-view",attrs:{contenteditable:"true"},innerHTML:rteContent}),div.appendChild(this.editableElement),this.setPanel(div),rteObj.element.appendChild(div)}getPanel(){return this.contentPanel}getEditPanel(){return this.editableElement}getText(){return this.getEditPanel().textContent}setPanel(panel){this.contentPanel=panel}getDocument(){return this.getEditPanel().ownerDocument}}const IFRAMEHEADER="\n<!DOCTYPE html> \n    <html>\n         <head>\n            <meta charset='utf-8' /> \n            <style>\n                @charset \"UTF-8\";\n                body {\n                    font-family: \"Roboto\", sans-serif;\n                    font-size: 14px;\n                }\n                html, body{height: 100%;margin: 0;}\n                body.e-cursor{cursor:default}\n                span.e-selected-node\t{background-color: #939393;color: white;}\n                span.e-selected-node.e-highlight {background-color: #1d9dd8;}\n                body{color:#333;word-wrap:break-word;padding: 8px;box-sizing: border-box;}\n                .e-rte-image {border: 0;cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-img-caption { display: inline-block; float: none; margin: 5px auto; max-width: 100%;position: relative;}\n                .e-img-caption.e-caption-inline {display: inline-block;float: none;margin: 5px auto;margin-left: 5px;margin-right: 5px;max-width: calc(100% - (2 * 5px));position: relativetext-align: center;vertical-align: bottom;}\n                .e-img-inner {box-sizing: border-box;display: block;font-size: 16px;font-weight: initial;margin: auto;opacity: .9;text-align: center;width: 100%;}\n                .e-img-wrap {display: inline-block;margin: auto;padding: 0;text-align: center;width: 100%;}\n                .e-imgleft {float: left;margin: 0 5px 0 0;text-align: left;}\n                .e-imgright {float: right;margin: 0 0 0 5px;text-align: right;}\n                .e-imgcenter {cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-control img:not(.e-resize) {border: 2px solid transparent; z-index: 1000}\n                .e-imginline {display: inline-block;float: none;margin-left: 5px;margin-right: 5px;max-width: calc(100% - (2 * 5px));vertical-align: bottom;}\n                .e-imgbreak {border: 0;cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-rte-image.e-img-focus:not(.e-resize) {border: solid 2px #4a90e2;}\n                img::selection { background: transparent;color: transparent;}\n                span.e-rte-imageboxmark {  width: 10px; height: 10px; position: absolute; display: block; background: #4a90e2; border: 1px solid #fff; z-index: 1000;}\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-mob-rte span.e-rte-imageboxmark { background: #fff; border: 1px solid #4a90e2; border-radius: 15px; height: 20px; width: 20px; }\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-rte-content .e-content img.e-resize { z-index: 1000; }\n                .e-img-caption .e-img-inner { outline: 0; }\n                .e-img-caption .e-rte-image.e-imgright, .e-img-caption .e-rte-image.e-imgleft { float: none; margin: 0;}\n                body{box-sizing: border-box;min-height: 100px;outline: 0 solid transparent;overflow-x: auto;padding: 16px;position: relative;text-align: inherit;z-index: 2;}\n                p{margin: 0 0 10px;margin-bottom: 10px;}\n                li{margin-bottom: 10px;}\n                h1{font-size: 2.17em;font-weight: 400;line-height: 1;margin: 10px 0;}\n                h2{font-size: 1.74em;font-weight: 400;margin: 10px 0;}\n                h3{font-size: 1.31em;font-weight: 400;margin: 10px 0;}\n                h4{font-size: 1em;font-weight: 400;margin: 0;}\n                h5{font-size: 00.8em;font-weight: 400;margin: 0;}\n                h6{font-size: 00.65em;font-weight: 400;margin: 0;}\n                blockquote{margin: 10px 0;margin-left: 0;padding-left: 5px;border-left: solid 2px #5c5c5c;}\n                pre{background-color: inherit;border: 0;border-radius: 0;color: #333;font-size: inherit;line-height: inherit;margin: 0 0 10px;overflow: visible;padding: 0;white-space: pre-wrap;word-break: inherit;word-wrap: break-word;}\n                strong, b{font-weight: 700;}\n                a{text-decoration: none;user-select: auto;}\n                a:hover{text-decoration: underline;};\n                p:last-child, pre:last-child, blockquote:last-child{margin-bottom: 0;}\n                h3+h4, h4+h5, h5+h6{margin-top: 00.6em;}\n                ul:last-child{margin-bottom: 0;}\n                table { border-collapse: collapse; empty-cells: show;}\n                table td,table th {border: 1px solid #BDBDBD; height: 20px; vertical-align: middle;}\n                table.e-alternate-border tbody tr:nth-child(2n) {background-color: #F5F5F5;}\n                table th {background-color: #E0E0E0;}\n                table.e-dashed-border td,table.e-dashed-border th { border: 1px dashed #BDBDBD} \n                table .e-cell-select {border: 1px double #4a90e2;}\n                span.e-table-box { cursor: nwse-resize; display: block; height: 10px; position: absolute; width: 10px; }\n                span.e-table-box.e-rmob {height: 14px;width: 14px;}\n                .e-row-resize, .e-column-resize { background-color: transparent; background-repeat: repeat; bottom: 0;cursor: col-resize;height: 1px;overflow: visible;position: absolute;width: 1px; }\n                .e-row-resize { cursor: row-resize; height: 1px;}\n                .e-table-rhelper { cursor: col-resize; opacity: .87;position: absolute;}\n                .e-table-rhelper.e-column-helper { width: 1px; }\n                .e-table-rhelper.e-row-helper {height: 1px;}\n                .e-reicon::before { border-bottom: 6px solid transparent; border-right: 6px solid; border-top: 6px solid transparent; content: ''; display: block; height: 0; position: absolute; right: 4px; top: 4px; width: 20px; }\n                .e-reicon::after { border-bottom: 6px solid transparent; border-left: 6px solid; border-top: 6px solid transparent; content: ''; display: block; height: 0; left: 4px; position: absolute; top: 4px; width: 20px; z-index: 3; }\n                .e-row-helper.e-reicon::after { top: 10px; transform: rotate(90deg); }\n                .e-row-helper.e-reicon::before { left: 4px; top: -20px; transform: rotate(90deg); }\n                span.e-table-box { background-color: #ffffff; border: 1px solid #BDBDBD; }\n                span.e-table-box.e-rbox-select { background-color: #BDBDBD; border: 1px solid #BDBDBD; }\n                .e-table-rhelper { background-color: #4a90e2;}\n            </style>\n        </head>";class ej2_richtexteditor_es2015_IframeContentRender extends ej2_richtexteditor_es2015_ContentRender{renderPanel(){let rteObj=this.parent,rteContent=getEditValue(rteObj.value,rteObj),iFrameContent=IFRAMEHEADER+'<body spellcheck="false" autocorrect="off" contenteditable="true">'+rteContent+"</body></html>",iframe=this.parent.createElement("iframe",{innerHTML:iFrameContent,id:this.parent.getID()+"_rte-view",className:"e-rte-content",styles:"display:block;"});this.setPanel(iframe),rteObj.element.appendChild(iframe),iframe.contentDocument.body.id=this.parent.getID()+"_rte-edit-view",iframe.contentDocument.body.setAttribute("aria-owns",this.parent.getID()),iframe.contentDocument.open(),iFrameContent=this.setThemeColor(iFrameContent,{color:"#333"}),iframe.contentDocument.write(iFrameContent),iframe.contentDocument.close()}setThemeColor(content,styles){let fontColor=getComputedStyle(this.parent.element,".e-richtexteditor").getPropertyValue("color");return content.replace(styles.color,fontColor)}getEditPanel(){return isNullOrUndefined(this.contentPanel.contentDocument)?this.parent.inputElement:this.contentPanel.contentDocument.body}getDocument(){return this.getEditPanel().ownerDocument}}const removeTags=["script","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],removeAttrs=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],jsEvents=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","onblur","oncanplay","oncanplaythrough","onchange","onclick","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onerror","onfocus","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onmousewheel","onstart","onpropertychange"];class ej2_richtexteditor_es2015_SanitizeHtmlHelper{initialize(value,parent){let item={selectors:{tags:removeTags,attributes:removeAttrs},helper:null};return parent.trigger("beforeSanitizeHtml",item),item.helper&&(value=item.helper(value)),item.cancel||(value=this.serializeValue(item,value)),value}serializeValue(item,value){return this.removeAttrs=item.selectors.attributes,this.removeTags=item.selectors.tags,this.wrapElement=document.createElement("div"),this.wrapElement.innerHTML=value,this.removeXssTags(),this.removeJsEvents(),this.removeXssAttrs(),this.wrapElement.innerHTML}removeXssTags(){let elements=this.wrapElement.querySelectorAll(this.removeTags.join(","));elements.length>0&&elements.forEach(element=>{detach(element)})}removeJsEvents(){let elements=this.wrapElement.querySelectorAll("["+jsEvents.join("],[")+"]");elements.length>0&&elements.forEach(element=>{jsEvents.forEach(attr=>{element.hasAttribute(attr)&&element.removeAttribute(attr)})})}removeXssAttrs(){this.removeAttrs.forEach((item,index)=>{let elements=this.wrapElement.querySelectorAll(item.selector);elements.length>0&&elements.forEach(element=>{element.removeAttribute(item.attribute)})})}}class ej2_richtexteditor_es2015_HtmlEditor{constructor(parent,serviceLocator){this.rangeCollection=[],this.parent=parent,this.locator=serviceLocator,this.renderFactory=this.locator.getService("rendererFactory"),this.sanitize=new ej2_richtexteditor_es2015_SanitizeHtmlHelper,this.addEventListener()}destroy(){this.removeEventListener()}sanitizeHelper(value){return this.sanitize.initialize(value,this.parent)}addEventListener(){this.parent.isDestroyed||(this.nodeSelectionObj=new NodeSelection,this.colorPickerModule=new ej2_richtexteditor_es2015_ColorPickerInput(this.parent,this.locator),this.parent.on(ej2_richtexteditor_es2015_initialLoad,this.instantiateRenderer,this),this.parent.on(htmlToolbarClick,this.onToolbarClick,this),this.parent.on(keyDown,this.onKeyDown,this),this.parent.on(renderColorPicker,this.renderColorPicker,this),this.parent.on(ej2_richtexteditor_es2015_initialEnd,this.render,this),this.parent.on(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.destroy,this),this.parent.on(selectAll$1,this.selectAll,this),this.parent.on(selectRange,this.selectRange,this),this.parent.on(getSelectedHtml,this.getSelectedHtml,this),this.parent.on(selectionSave,this.onSelectionSave,this),this.parent.on(selectionRestore,this.onSelectionRestore,this),this.parent.on(readOnlyMode,this.updateReadOnly,this),this.parent.on(ej2_richtexteditor_es2015_paste,this.onPaste,this))}updateReadOnly(){this.parent.readonly?(attributes(this.parent.contentModule.getEditPanel(),{contenteditable:"false"}),addClass([this.parent.element],CLS_RTE_READONLY)):(attributes(this.parent.contentModule.getEditPanel(),{contenteditable:"true"}),removeClass([this.parent.element],CLS_RTE_READONLY))}onSelectionSave(){let currentDocument=this.contentRenderer.getDocument(),range=this.nodeSelectionObj.getRange(currentDocument);this.saveSelection=this.nodeSelectionObj.save(range,currentDocument)}onSelectionRestore(e){this.parent.isBlur=!1,this.contentRenderer.getEditPanel().focus(),(isNullOrUndefined(e.items)||e.items)&&this.saveSelection.restore()}onKeyDown(e){if(9===e.args.keyCode&&this.parent.enableTabKey){let range=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),parentNode=this.nodeSelectionObj.getParentNodeCollection(range);if("LI"!==parentNode[0].nodeName&&!closest(parentNode[0],"li")&&!closest(parentNode[0],"table")||0!==range.startOffset)if(e.args.preventDefault(),e.args.shiftKey){if(this.rangeCollection.length>0&&4===this.rangeCollection[this.rangeCollection.length-1].startContainer.textContent.length){let textCont=this.rangeCollection[this.rangeCollection.length-1].startContainer;this.nodeSelectionObj.setSelectionText(this.contentRenderer.getDocument(),textCont,textCont,0,textCont.textContent.length),ej2_richtexteditor_es2015_InsertHtml.Insert(this.contentRenderer.getDocument(),document.createTextNode("")),this.rangeCollection.pop()}}else ej2_richtexteditor_es2015_InsertHtml.Insert(this.contentRenderer.getDocument(),"&nbsp;&nbsp;&nbsp;&nbsp;"),this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()))}"space"!==e.args.action&&"enter"!==e.args.action||this.spaceLink(e.args)}onPaste(e){let regex=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(e.text.match(regex)){e.args.preventDefault();let range=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),httpRegex=(this.parent.formatter.editorManager.nodeSelection.save(range,this.parent.contentModule.getDocument()),new RegExp(/([^\S]|^)(((https?\:\/\/)))/gi)),wwwRegex=new RegExp(/([^\S]|^)(((www\.))(\S+))/gi),enterSplitText=e.text.split("\n"),contentInnerElem="";for(let i=0;i<enterSplitText.length;i++)if(""===enterSplitText[i].trim())contentInnerElem+="<p><br></p>";else{let contentWithSpace="",spaceBetweenContent=!0,spaceSplit=enterSplitText[i].split(" ");for(let j=0;j<spaceSplit.length;j++)""===spaceSplit[j].trim()?contentWithSpace+=spaceBetweenContent?"&nbsp;":" ":(spaceBetweenContent=!1,contentWithSpace+=spaceSplit[j]+" ");contentInnerElem+="<p>"+contentWithSpace.trim()+"</p>"}let divElement=this.parent.createElement("div");divElement.innerHTML=contentInnerElem;let paraElem=divElement.querySelectorAll("p");for(let i=0;i<paraElem.length;i++){let splitTextContent=paraElem[i].innerHTML.split(" "),resultSplitContent="";for(let j=0;j<splitTextContent.length;j++)splitTextContent[j].match(httpRegex)||splitTextContent[j].match(wwwRegex)?resultSplitContent+='<a className="e-rte-anchor" href="'+splitTextContent[j]+'" title="'+splitTextContent[j]+'">'+splitTextContent[j]+" </a>":resultSplitContent+=splitTextContent[j]+" ";paraElem[i].innerHTML=resultSplitContent.trim()}isNullOrUndefined(this.parent.pasteCleanupModule)?this.parent.executeCommand("insertHTML",divElement):e.callBack(divElement.innerHTML)}}spaceLink(e){let range=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),selectNodeEle=this.nodeSelectionObj.getParentNodeCollection(range),text=range.startContainer.textContent.substr(0,range.endOffset),splitText=text.split(" "),urlText=splitText[splitText.length-1];urlText=urlText.slice(0,range.startOffset-(text.length-splitText[splitText.length-1].length));let regex=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if("A"!==selectNodeEle[0].nodeName&&urlText.match(regex)){let selection=this.nodeSelectionObj.save(range,this.parent.contentModule.getDocument()),url=urlText.indexOf("http")>-1?urlText:"http://"+urlText,selectParent=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);this.parent.formatter.process(this.parent,{item:{command:"Links",subCommand:"CreateLink"}},e,{url:url,selection:selection,selectParent:selectParent,text:urlText,title:"",target:"_blank"})}}onToolbarClick(args){let save,selectNodeEle,selectParentEle,item=args.item,closestElement=closest(args.originalEvent.target,".e-rte-quick-popup");if(closestElement&&!closestElement.classList.contains("e-rte-inline-popup")){if("SourceCode"!==item.subCommand&&"Preview"!==item.subCommand&&"FontColor"!==item.subCommand&&"BackgroundColor"!==item.subCommand){isIDevice$1()&&"Images"===item.command&&this.nodeSelectionObj.restore();let range=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());save=this.nodeSelectionObj.save(range,this.parent.contentModule.getDocument()),selectNodeEle=this.nodeSelectionObj.getNodeCollection(range),selectParentEle=this.nodeSelectionObj.getParentNodeCollection(range)}"Images"===item.command&&this.parent.notify(imageToolbarAction,{member:"image",args:args,selectNode:selectNodeEle,selection:save,selectParent:selectParentEle}),"Links"===item.command&&this.parent.notify(linkToolbarAction,{member:"link",args:args,selectNode:selectNodeEle,selection:save,selectParent:selectParentEle}),"Table"===item.command&&this.parent.notify(tableToolbarAction,{member:"table",args:args,selectNode:selectNodeEle,selection:save,selectParent:selectParentEle})}else{let linkDialog=this.parent.element.querySelector("#"+this.parent.getID()+"_rtelink"),imageDialog=this.parent.element.querySelector("#"+this.parent.getID()+"_image");if("SourceCode"!==item.subCommand&&"Preview"!==item.subCommand&&"FontColor"!==item.subCommand&&"BackgroundColor"!==item.subCommand){let range=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());isNullOrUndefined(linkDialog)&&isNullOrUndefined(imageDialog)&&(save=this.nodeSelectionObj.save(range,this.parent.contentModule.getDocument())),selectNodeEle=this.nodeSelectionObj.getNodeCollection(range),selectParentEle=this.nodeSelectionObj.getParentNodeCollection(range)}switch(item.subCommand){case"Maximize":this.parent.notify(enableFullScreen,{args:args});break;case"Minimize":this.parent.notify(disableFullScreen,{args:args});break;case"CreateLink":this.parent.notify(insertLink,{member:"link",args:args,selectNode:selectNodeEle,selection:save,selectParent:selectParentEle});break;case"Print":this.parent.print();break;case"Image":this.parent.notify(insertImage,{member:"image",args:args,selectNode:selectNodeEle,selection:save,selectParent:selectParentEle});break;case"CreateTable":this.parent.notify(createTable,{member:"table",args:args,selection:save});break;case"SourceCode":this.parent.notify(sourceCode,{member:"viewSource",args:args});break;case"Preview":this.parent.notify(updateSource,{member:"updateSource",args:args});break;case"FontColor":case"BackgroundColor":break;default:this.parent.formatter.process(this.parent,args,args.originalEvent,null)}}}renderColorPicker(args){this.colorPickerModule.renderColorPickerInput(args)}instantiateRenderer(){this.renderFactory.addRenderer(ej2_richtexteditor_es2015_RenderType.Content,this.parent.iframeSettings.enable?new ej2_richtexteditor_es2015_IframeContentRender(this.parent,this.locator):new ej2_richtexteditor_es2015_ContentRender(this.parent,this.locator))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(ej2_richtexteditor_es2015_initialEnd,this.render),this.parent.off(ej2_richtexteditor_es2015_modelChanged,this.onPropertyChanged),this.parent.off(htmlToolbarClick,this.onToolbarClick),this.parent.off(renderColorPicker,this.renderColorPicker),this.parent.off(ej2_richtexteditor_es2015_destroy,this.destroy),this.parent.off(keyDown,this.onKeyDown),this.parent.off(ej2_richtexteditor_es2015_initialLoad,this.instantiateRenderer),this.parent.off(selectAll$1,this.selectAll),this.parent.off(selectRange,this.selectRange),this.parent.off(getSelectedHtml,this.getSelectedHtml),this.parent.off(selectionSave,this.onSelectionSave),this.parent.off(selectionRestore,this.onSelectionRestore),this.parent.off(readOnlyMode,this.updateReadOnly),this.parent.off(ej2_richtexteditor_es2015_paste,this.onPaste))}render(){this.contentRenderer=this.renderFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Content);let editElement=this.contentRenderer.getEditPanel(),option={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};if(isNullOrUndefined(this.parent.formatter)){let formatterClass=new ej2_richtexteditor_es2015_HTMLFormatter({currentDocument:this.contentRenderer.getDocument(),element:editElement,options:option});this.parent.setProperties({formatter:formatterClass},!0)}else this.parent.formatter.updateFormatter(editElement,this.contentRenderer.getDocument(),option);this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new HtmlToolbarStatus(this.parent)),this.parent.notify(bindOnEnd,{})}onPropertyChanged(e){if(!isNullOrUndefined(e.newProp.formatter)){let editElement=this.contentRenderer.getEditPanel(),option={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(editElement,this.contentRenderer.getDocument(),option)}}getModuleName(){return"htmlEditor"}selectAll(){let nodes=function getTextNodesUnder(docElement,node){let nodes=[];for(node=node.firstChild;node;node=node.nextSibling)3===node.nodeType?nodes.push(node):nodes=nodes.concat(getTextNodesUnder(docElement,node));return nodes}(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel());this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),nodes[0],nodes[nodes.length-1],0,nodes[nodes.length-1].textContent.length)}selectRange(e){this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(),e.range)}getSelectedHtml(e){e.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString())}}class ej2_richtexteditor_es2015_Render{constructor(parent,locator){this.parent=parent,this.locator=locator,this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}render(){this.contentRenderer=this.renderer.getRenderer(ej2_richtexteditor_es2015_RenderType.Content),this.contentRenderer.renderPanel()}refresh(e={requestType:"refresh"}){this.parent.notify(`${e.requestType}-begin`,e)}destroy(){this.removeEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on(ej2_richtexteditor_es2015_modelChanged,this.refresh,this),this.parent.on(keyUp,this.keyUp,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(ej2_richtexteditor_es2015_modelChanged,this.refresh),this.parent.off(keyUp,this.keyUp))}keyUp(e){if("HTML"===this.parent.editorMode)switch(e.args.which){case 46:case 8:let childNodes=this.parent.contentModule.getEditPanel().childNodes;if(0===childNodes.length||1===childNodes.length&&("BR"===childNodes[0].tagName||"P"===childNodes[0].tagName&&(0===childNodes[0].childNodes.length||""===childNodes[0].textContent))){let node=this.parent.contentModule.getEditPanel();node.innerHTML="<p><br/></p>",this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),node.childNodes[0],0)}}}}class ej2_richtexteditor_es2015_Link{constructor(parent,serviceLocator){this.parent=parent,this.rteID=parent.element.id,this.i10n=serviceLocator.getService("rteLocale"),this.addEventListener(),this.serviceLocator=serviceLocator,this.rendererFactory=serviceLocator.getService("rendererFactory"),this.dialogRenderObj=serviceLocator.getService("dialogRenderObject")}addEventListener(){this.parent.isDestroyed||(this.parent.on(insertLink,this.linkDialog,this),this.parent.on(keyDown,this.onKeyDown,this),this.parent.on(insertCompleted,this.showLinkQuickToolbar,this),this.parent.on(linkToolbarAction,this.onToolbarAction,this),this.parent.on(iframeMouseDown,this.onIframeMouseDown,this),this.parent.on(unLink,this.removeLink,this),this.parent.on(editLink,this.editLink,this),this.parent.on(openLink,this.openLink,this),this.parent.on(editAreaClick,this.editAreaClickHandler,this))}onToolbarAction(args){switch(args.args.item.subCommand){case"OpenLink":this.parent.notify(openLink,args);break;case"EditLink":this.parent.notify(editLink,args);break;case"RemoveLink":this.parent.notify(unLink,args)}}removeEventListener(){this.parent.isDestroyed||(this.parent.off(insertLink,this.linkDialog),this.parent.off(keyDown,this.onKeyDown),this.parent.off(insertCompleted,this.showLinkQuickToolbar),this.parent.off(linkToolbarAction,this.onToolbarAction),this.parent.off(unLink,this.removeLink),this.parent.off(iframeMouseDown,this.onIframeMouseDown),this.parent.off(editLink,this.editLink),this.parent.off(openLink,this.openLink),this.parent.off(editAreaClick,this.editAreaClickHandler))}onIframeMouseDown(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})}showLinkQuickToolbar(e){if("enter"!==e.args.action&&"space"!==e.args.action){let pageX,pageY;if("Links"!==e.type||isNullOrUndefined(this.parent.quickToolbarModule)||isNullOrUndefined(this.parent.quickToolbarModule.linkQTBar))return;this.quickToolObj=this.parent.quickToolbarModule;let target,parentTop=this.parent.element.getBoundingClientRect().top,parentLeft=this.parent.element.getBoundingClientRect().left,range=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());if([].forEach.call(e.elements,(element,index)=>{0===index&&(target="#text"===element.nodeName?element.parentNode:element)}),e.isNotify){let tbElement=this.parent.toolbarModule.getToolbarElement(),linkTop=target.getBoundingClientRect().top,linkLeft=target.getBoundingClientRect().left,linkPos=linkTop-parentTop,tbHeight=tbElement?tbElement.offsetHeight+this.parent.toolbarModule.getExpandTBarPopHeight():0;pageX=this.parent.iframeSettings.enable?parentLeft+linkLeft:target.getBoundingClientRect().left,pageY=window.pageYOffset+(this.parent.iframeSettings.enable?parentTop+tbHeight+linkTop:parentTop+linkPos)}else{let args;args=e.args.touches?e.args.changedTouches[0]:args=e.args,pageX=this.parent.iframeSettings.enable?window.pageXOffset+parentLeft+args.clientX:args.pageX,pageY=this.parent.iframeSettings.enable?window.pageYOffset+parentTop+args.clientY:args.pageY}this.quickToolObj.linkQTBar&&this.quickToolObj.linkQTBar.showPopup(pageX,pageY,range.endContainer)}}hideLinkQuickToolbar(){this.quickToolObj&&this.quickToolObj.linkQTBar&&document.body.contains(this.quickToolObj.linkQTBar.element)&&this.quickToolObj.linkQTBar.hidePopup()}editAreaClickHandler(e){let args=e.args,showOnRightClick=this.parent.quickToolbarSettings.showOnRightClick;if(!(2===args.which||showOnRightClick&&1===args.which||!showOnRightClick&&3===args.which)&&"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.linkQTBar){this.quickToolObj=this.parent.quickToolbarModule;let target=args.target;target=this.getAnchorNode(target),this.contentModule=this.rendererFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Content);let isPopupOpen=this.quickToolObj.linkQTBar.element.classList.contains("e-rte-pop");if("A"!==target.nodeName||target.contains(target.querySelector("img")))this.hideLinkQuickToolbar();else{if(isPopupOpen)return;this.showLinkQuickToolbar({args:args,isNotify:!1,type:"Links",elements:[args.target]})}}}onKeyDown(event){let originalEvent=event.args;switch(originalEvent.action){case"escape":isNullOrUndefined(this.dialogObj)||this.dialogObj.close();break;case"insert-link":if("HTML"===this.parent.editorMode){let range=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),save=this.parent.formatter.editorManager.nodeSelection.save(range,this.parent.contentModule.getDocument()),selectNodeEle=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range),selectParentEle=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);this.linkDialog({args:event.args,selectNode:selectNodeEle,selection:save,selectParent:selectParentEle})}else{let textArea=this.parent.contentModule.getEditPanel();this.parent.formatter.editorManager.markdownSelection.save(textArea.selectionStart,textArea.selectionEnd),this.linkDialog({args:{item:{command:"Links",subCommand:"Link"},originalEvent:originalEvent},member:"link",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertLink"})}originalEvent.preventDefault()}}linkDialog(e,inputDetails){if(this.dialogObj)return void this.dialogObj.hide({returnValue:!0});if("HTML"===this.parent.editorMode&&e.selectParent.length>0&&!isNullOrUndefined(e.selectParent[0].classList)&&e.selectParent[0].classList.contains("e-rte-anchor")&&isNullOrUndefined(inputDetails))return void this.editLink(e);let selectText,linkWebAddress=this.i10n.getConstant("linkWebUrl"),linkDisplayText=this.i10n.getConstant("linkText"),linkTooltip=this.i10n.getConstant("linkTooltipLabel"),urlPlace=this.i10n.getConstant("linkurl"),textPlace=this.i10n.getConstant("textPlaceholder"),title=this.i10n.getConstant("linkTitle"),linkDialogEle=this.parent.createElement("div",{className:"e-rte-link-dialog",id:this.rteID+"_rtelink"});this.parent.element.appendChild(linkDialogEle);let linkContent=this.parent.createElement("div",{className:"e-rte-linkcontent",id:this.rteID+"_linkContent"}),contentElem=function(value){let tempNode=ej2_base_es2015_createElement("template");return tempNode.innerHTML=value,tempNode.content instanceof DocumentFragment?tempNode.content:document.createRange().createContextualFragment(value)}('<div class="e-rte-label"><label>'+linkWebAddress+'</label></div><div class="e-rte-field"><input type="text" data-role ="none" spellcheck="false" placeholder="'+urlPlace+'" class="e-input e-rte-linkurl"/></div><div class="e-rte-label"><label>'+linkDisplayText+'</label></div><div class="e-rte-field"> <input type="text" data-role ="none" spellcheck="false" class="e-input e-rte-linkText" placeholder="'+textPlace+'"></div><div class="e-rte-label">'+("HTML"===this.parent.editorMode?"<label>"+linkTooltip+'</label></div><div class="e-rte-field"><input type="text" data-role ="none" spellcheck="false" placeholder = "'+title+'" class="e-input e-rte-linkTitle"></div><div class="e-rte-label"></div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget"  data-role ="none"></div>':""));linkContent.appendChild(contentElem);let linkTarget=linkContent.querySelector(".e-rte-linkTarget"),linkUrl=linkContent.querySelector(".e-rte-linkurl"),linkText=linkContent.querySelector(".e-rte-linkText"),linkTitle=linkContent.querySelector(".e-rte-linkTitle"),linkOpenLabel=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new ej2_buttons_es2015_CheckBox({label:linkOpenLabel,checked:!0,enableRtl:this.parent.enableRtl}),this.checkBoxObj.isStringTemplate=!0,this.checkBoxObj.createElement=this.parent.createElement,this.checkBoxObj.appendTo(linkTarget),selectText="HTML"===this.parent.editorMode?e.selection.getRange(this.parent.contentModule.getDocument()).toString():e.text;let linkInsert=this.i10n.getConstant("dialogInsert"),linkCancel=this.i10n.getConstant("dialogCancel"),selection=e.selection,selectObj={selfLink:this,selection:e.selection,selectParent:e.selectParent,args:e.args},dialogModel={header:this.i10n.getConstant("linkHeader"),content:linkContent,cssClass:CLS_RTE_ELEMENTS,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:Browser.isDevice?"290px":"310px",height:"inherit",isModal:Browser.isDevice,buttons:[{click:this.insertlink.bind(selectObj),buttonModel:{content:linkInsert,cssClass:"e-flat e-insertLink",isPrimary:!0}},{click:this.cancelDialog.bind(selectObj),buttonModel:{cssClass:"e-flat",content:linkCancel}}],target:Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:event=>{this.parent.isBlur=!1,event&&event.event.returnValue&&("HTML"===this.parent.editorMode?selection.restore():this.parent.formatter.editorManager.markdownSelection.restore(this.parent.contentModule.getEditPanel())),this.dialogObj.destroy(),detach(this.dialogObj.element);let args=isBlazor()?null:this.dialogObj;this.dialogRenderObj.close(args),this.dialogObj=null}};this.dialogObj=this.dialogRenderObj.render(dialogModel),this.dialogObj.createElement=this.parent.createElement,this.dialogObj.appendTo(linkDialogEle),linkDialogEle.style.maxHeight="inherit",isNullOrUndefined(inputDetails)||(linkUrl.value=inputDetails.url,linkText.value=inputDetails.text,linkTitle.value=inputDetails.title,this.checkBoxObj.checked=!!inputDetails.target,this.dialogObj.header=inputDetails.header,this.dialogObj.element.querySelector(".e-insertLink").textContent=inputDetails.btnText),this.checkUrl(!1),("HTML"===this.parent.editorMode&&(!isNullOrUndefined(selectText)&&""!==selectText&&0===e.selection.range.startOffset||e.selection.range.startOffset!==e.selection.range.endOffset)||"Markdown"===e.module)&&(linkText.value=selectText),EventHandler.add(document,"mousedown",this.onDocumentClick,this),this.quickToolObj&&(this.hideLinkQuickToolbar(),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup())}insertlink(e){let linkTitle,linkEle=this.selfLink.dialogObj.element,linkUrl=linkEle.querySelector(".e-rte-linkurl").value,linkText=linkEle.querySelector(".e-rte-linkText").value;"HTML"===this.selfLink.parent.editorMode&&(linkTitle=linkEle.querySelector(".e-rte-linkTitle").value);let target=this.selfLink.checkBoxObj.checked?"_blank":null;if(""===linkUrl)return void this.selfLink.checkUrl(!0);this.selfLink.isUrl(linkUrl)?this.selfLink.checkUrl(!1):(linkText=""===linkText?linkUrl:linkText,linkUrl=this.selfLink.parent.enableAutoUrl?linkUrl:linkUrl.indexOf("http")>-1?linkUrl:"http://"+linkUrl);let proxy=this.selfLink;if("HTML"===proxy.parent.editorMode&&isNullOrUndefined(closest(this.selection.range.startContainer.parentNode,"#"+proxy.parent.contentModule.getPanel().id))){proxy.parent.contentModule.getEditPanel().focus(),Browser.isIE&&proxy.parent.iframeSettings.enable&&this.selection.restore();let range=proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.parent.contentModule.getDocument());this.selection=proxy.parent.formatter.editorManager.nodeSelection.save(range,proxy.parent.contentModule.getDocument()),this.selectParent=proxy.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range)}let value={url:linkUrl,text:linkText,title:linkTitle,target:target,selection:this.selection,selectParent:this.selectParent};document.body.contains(proxy.dialogObj.element)&&this.selfLink.dialogObj.hide({returnValue:!1}),isIDevice$1()&&proxy.parent.iframeSettings.enable&&ej2_base_es2015_select("iframe",proxy.parent.element).contentWindow.focus(),"HTML"===proxy.parent.editorMode&&this.selection.restore(),0===proxy.parent.formatter.getUndoRedoStack().length&&proxy.parent.formatter.saveData(),this.selfLink.parent.formatter.process(this.selfLink.parent,this.args,this.args.originalEvent,value),this.selfLink.parent.contentModule.getEditPanel().focus()}isUrl(url){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi.test(url)}checkUrl(e){let linkUrl=this.dialogObj.element.querySelector(".e-rte-linkurl");e?(addClass([linkUrl],"e-error"),linkUrl.setSelectionRange(0,linkUrl.value.length),linkUrl.focus()):removeClass([linkUrl],"e-error")}removeLink(e){0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.parent.formatter.process(this.parent,e.args,e.args,{selectNode:e.selectNode,selectParent:e.selectParent,selection:e.selection,subCommand:e.args.item.subCommand}),isIDevice$1()&&this.parent.iframeSettings.enable?ej2_base_es2015_select("iframe",this.parent.element).contentWindow.focus():this.parent.contentModule.getEditPanel().focus(),this.hideLinkQuickToolbar()}openLink(e){let selectParentEle=this.getAnchorNode(e.selectParent[0]);(selectParentEle.classList.contains("e-rte-anchor")||"A"===selectParentEle.tagName)&&this.parent.formatter.process(this.parent,e.args,e.args,{url:selectParentEle.href,target:""===selectParentEle.target?"_self":"_blank",selectNode:e.selectNode,subCommand:e.args.item.subCommand})}getAnchorNode(element){return closest(element,"a")||element}editLink(e){let selectParentEle=this.getAnchorNode(e.selectParent[0]);if(selectParentEle.classList.contains("e-rte-anchor")||"A"===selectParentEle.tagName){let linkUpdate=this.i10n.getConstant("dialogUpdate"),inputDetails={url:selectParentEle.getAttribute("href"),text:selectParentEle.innerText,title:selectParentEle.title,target:selectParentEle.target,header:this.i10n.getConstant("editLink"),btnText:linkUpdate};this.linkDialog(e,inputDetails)}}cancelDialog(e){this.selfLink.parent.isBlur=!1,this.selfLink.dialogObj.hide({returnValue:!0}),isIDevice$1()?this.selection.restore():this.selfLink.parent.contentModule.getEditPanel().focus()}onDocumentClick(e){let target=e.target;!isNullOrUndefined(this.dialogObj)&&(!closest(target,"#"+this.dialogObj.element.id)&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(e.target)||(this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(e.target)||this.parent.inlineMode.enable)&&!closest(target,"#"+this.parent.getID()+"_toolbar_CreateLink")&&!target.querySelector("#"+this.parent.getID()+"_toolbar_CreateLink"))&&(this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,ej2_richtexteditor_es2015_dispatchEvent(this.parent.element,"focusout"))}destroy(){this.removeEventListener()}getModuleName(){return"link"}}class ej2_richtexteditor_es2015_ViewSource{constructor(parent,locator){this.parent=parent,this.rendererFactory=locator.getService("rendererFactory"),this.addEventListener()}addEventListener(){this.parent.on(sourceCode,this.sourceCode,this),this.parent.on(ej2_richtexteditor_es2015_initialEnd,this.onInitialEnd,this),this.parent.on(updateSource,this.updateSourceCode,this)}onInitialEnd(){this.parent.formatter.editorManager.observer.on(KEY_DOWN_HANDLER,this.onKeyDown,this)}removeEventListener(){this.unWireEvent(),this.parent.off(sourceCode,this.sourceCode),this.parent.off(updateSource,this.updateSourceCode),this.parent.off(ej2_richtexteditor_es2015_initialEnd,this.onInitialEnd),this.parent.formatter.editorManager.observer.off(KEY_DOWN_HANDLER,this.onKeyDown)}getSourceCode(){return this.parent.createElement("textarea",{className:"e-rte-srctextarea"})}wireEvent(element){this.keyboardModule=new ej2_richtexteditor_es2015_KeyboardEvents$1(element,{keyAction:this.previewKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}),EventHandler.add(this.previewElement,"mousedown",this.mouseDownHandler,this)}unWireEvent(){this.keyboardModule&&this.keyboardModule.destroy(),this.previewElement&&EventHandler.remove(this.previewElement,"mousedown",this.mouseDownHandler)}wireBaseKeyDown(){this.parent.keyboardModule=new ej2_richtexteditor_es2015_KeyboardEvents$1(this.contentModule.getEditPanel(),{keyAction:this.parent.keyDown.bind(this.parent),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"})}unWireBaseKeyDown(){this.parent.keyboardModule.destroy()}mouseDownHandler(e){this.parent.notify(sourceCodeMouseDown,{args:e})}previewKeyDown(event){switch(event.action){case"html-source":this.updateSourceCode(event),event.preventDefault()}}onKeyDown(e){switch(e.event.action){case"html-source":e.event.preventDefault(),this.sourceCode(e),e.callBack({requestType:"SourceCode",editorMode:"HTML",event:e.event})}}sourceCode(args){this.parent.isBlur=!1,this.parent.trigger(ej2_richtexteditor_es2015_actionBegin,{requestType:"SourceCode",targetItem:"SourceCode",args:args});let tbItems=ej2_base_es2015_selectAll("."+ej2_richtexteditor_es2015_CLS_TB_ITEM,this.parent.element);if(this.contentModule=this.rendererFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Content),this.parent.notify(updateToolbarItem,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),isNullOrUndefined(this.previewElement)&&(this.previewElement=this.getSourceCode()),this.parent.updateValueData(),this.parent.iframeSettings.enable){let rteContent;(rteContent=isNullOrUndefined(this.parent.element.querySelector("#"+this.parent.element.id+"_source-view"))?this.parent.createElement("div",{className:"e-source-content",id:this.parent.element.id+"_source-view"}):this.parent.element.querySelector("#"+this.parent.element.id+"_source-view")).appendChild(this.previewElement),this.parent.element.appendChild(rteContent),rteContent.style.height=this.contentModule.getPanel().style.height,rteContent.style.marginTop=this.contentModule.getPanel().style.marginTop,this.getPanel().value=this.getTextAreaValue(),this.contentModule.getPanel().style.display="none",rteContent.style.display="block"}else this.contentModule.getPanel().appendChild(this.previewElement),this.getPanel().value=this.getTextAreaValue(),this.contentModule.getEditPanel().style.display="none",this.previewElement.style.display="block";this.parent.isBlur=!1,this.parent.disableToolbarItem(this.parent.toolbarSettings.items),this.parent.enableToolbarItem("SourceCode"),this.parent.getToolbar()&&removeClass([this.parent.getToolbar()],[CLS_EXPAND_OPEN]),removeClass(tbItems,[ej2_richtexteditor_es2015_CLS_ACTIVE]),this.parent.setContentHeight("sourceCode",!0),this.wireEvent(this.previewElement),this.unWireBaseKeyDown(),this.previewElement.focus(),this.parent.updateValue(),isNullOrUndefined(this.parent.placeholder)||this.parent.iframeSettings.enable||(this.parent.element.querySelector(".rte-placeholder").style.display="none"),this.parent.trigger(ej2_richtexteditor_es2015_actionComplete,{requestType:"SourceCode",targetItem:"SourceCode",args:args}),this.parent.invokeChangeEvent()}updateSourceCode(args){this.parent.isBlur=!1,this.parent.trigger(ej2_richtexteditor_es2015_actionBegin,{requestType:"Preview",targetItem:"Preview",args:args});let editHTML=this.getPanel();this.parent.notify(updateToolbarItem,{targetItem:"Preview",updateItem:"SourceCode",baseToolbar:this.parent.getBaseToolbarObject()});let serializeValue=this.parent.serializeValue(editHTML.value),value=null===serializeValue||""===serializeValue?"<p><br/></p>":serializeValue;this.parent.iframeSettings.enable?(editHTML.parentElement.style.display="none",this.contentModule.getPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=value):(editHTML.style.display="none",this.contentModule.getEditPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=value),this.parent.isBlur=!1,this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.parent.getToolbar()&&removeClass([this.parent.getToolbar()],[CLS_EXPAND_OPEN]),this.parent.setContentHeight("preview",!0),this.unWireEvent(),this.wireBaseKeyDown(),this.contentModule.getEditPanel().focus(),this.parent.updateValue(),isNullOrUndefined(this.parent.placeholder)||0!==this.contentModule.getEditPanel().innerText.length||(this.parent.element.querySelector(".rte-placeholder").style.display="block"),this.parent.trigger(ej2_richtexteditor_es2015_actionComplete,{requestType:"Preview",targetItem:"Preview",args:args}),this.parent.formatter.enableUndo(this.parent),this.parent.invokeChangeEvent()}getTextAreaValue(){return"<p><br></p>"===this.contentModule.getEditPanel().innerHTML||12===this.contentModule.getEditPanel().innerHTML.length||1===this.contentModule.getEditPanel().childNodes.length&&"P"===this.contentModule.getEditPanel().childNodes[0].tagName&&7===this.contentModule.getEditPanel().innerHTML.length?"":this.parent.value}getPanel(){return this.parent.element.querySelector(".e-rte-srctextarea")}getViewPanel(){return this.parent.iframeSettings.enable&&this.getPanel()?this.getPanel().parentElement:this.getPanel()}destroy(){this.removeEventListener()}}const executeGroup={bold:{command:"Style",subCommand:"Bold",value:"strong"},italic:{command:"Style",subCommand:"Italic",value:"em"},underline:{command:"Style",subCommand:"Underline",value:"span"},strikeThrough:{command:"Style",subCommand:"StrikeThrough",value:"span"},superscript:{command:"Effects",subCommand:"SuperScript",value:"sup"},subscript:{command:"Effects",subCommand:"SubScript",value:"sub"},uppercase:{command:"Casing",subCommand:"UpperCase"},lowercase:{command:"Casing",subCommand:"LowerCase"},fontColor:{command:"font",subCommand:"fontcolor",value:"#ff0000"},fontName:{command:"font",subCommand:"fontname",value:"Segoe UI"},fontSize:{command:"font",subCommand:"fontsize",value:"10pt"},backColor:{command:"font",subCommand:"backgroundcolor",value:"#ffff00"},justifyCenter:{command:"Alignments",subCommand:"JustifyCenter"},justifyFull:{command:"Alignments",subCommand:"JustifyFull"},justifyLeft:{command:"Alignments",subCommand:"JustifyLeft"},justifyRight:{command:"Alignments",subCommand:"JustifyRight"},undo:{command:"Actions",subCommand:"Undo"},redo:{command:"Actions",subCommand:"Redo"},createLink:{command:"Links",subCommand:"createLink"},createImage:{command:"Images",subCommand:"Images"},formatBlock:{command:"Formats",value:"P"},heading:{command:"Formats",value:"H1"},indent:{command:"Indents",subCommand:"Indent"},outdent:{command:"Indents",subCommand:"Outdent"},insertHTML:{command:"InsertHTML",subCommand:"InsertHTML",value:""},insertText:{command:"InsertText",subCommand:"InsertText",value:""},insertHorizontalRule:{command:"InsertHTML",subCommand:"InsertHTML",value:"<hr/>"},insertImage:{command:"Images",subCommand:"Image"},insertBrOnReturn:{command:"InsertHTML",subCommand:"InsertHTML",value:"<br/>"},insertOrderedList:{command:"Lists",value:"OL"},insertUnorderedList:{command:"Lists",value:"UL"},insertParagraph:{command:"Formats",value:"P"},removeFormat:{command:"Clear",subCommand:"ClearFormat"}},predefinedItems=["Bold","Italic","Underline","|","Formats","Alignments","OrderedList","UnorderedList","|","CreateLink","Image","|","SourceCode","Undo","Redo"],ej2_richtexteditor_es2015_fontFamily=[{text:"Segoe UI",value:"Segoe UI",cssClass:"e-segoe-ui"},{text:"Arial",value:"Arial,Helvetica,sans-serif",cssClass:"e-arial"},{text:"Georgia",value:"Georgia,serif",cssClass:"e-georgia"},{text:"Impact",value:"Impact,Charcoal,sans-serif",cssClass:"e-impact"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif",cssClass:"e-tahoma"},{text:"Times New Roman",value:"Times New Roman,Times,serif",cssClass:"e-times-new-roman"},{text:"Verdana",value:"Verdana,Geneva,sans-serif",cssClass:"e-verdana"}],ej2_richtexteditor_es2015_fontSize=[{text:"8 pt",value:"8pt"},{text:"10 pt",value:"10pt"},{text:"12 pt",value:"12pt"},{text:"14 pt",value:"14pt"},{text:"18 pt",value:"18pt"},{text:"24 pt",value:"24pt"},{text:"36 pt",value:"36pt"}],ej2_richtexteditor_es2015_formatItems=[{text:"Paragraph",value:"P",cssClass:"e-paragraph"},{text:"Code",value:"Pre",cssClass:"e-code"},{text:"Quotation",value:"BlockQuote",cssClass:"e-quote"},{text:"Heading 1",value:"H1",cssClass:"e-h1"},{text:"Heading 2",value:"H2",cssClass:"e-h2"},{text:"Heading 3",value:"H3",cssClass:"e-h3"},{text:"Heading 4",value:"H4",cssClass:"e-h4"}],fontColor={Custom:["","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},backgroundColor={Custom:["","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]};let ej2_richtexteditor_es2015_ToolbarSettings=(()=>{class ToolbarSettings extends ChildProperty{}return __decorate([Property(!0)],ToolbarSettings.prototype,"enable",void 0),__decorate([Property(!0)],ToolbarSettings.prototype,"enableFloating",void 0),__decorate([Property(ToolbarType.Expand)],ToolbarSettings.prototype,"type",void 0),__decorate([Property(predefinedItems)],ToolbarSettings.prototype,"items",void 0),__decorate([Property({})],ToolbarSettings.prototype,"itemConfigs",void 0),ToolbarSettings})(),ej2_richtexteditor_es2015_ImageSettings=(()=>{class ImageSettings extends ChildProperty{}return __decorate([Property([".jpeg",".jpg",".png"])],ImageSettings.prototype,"allowedTypes",void 0),__decorate([Property("inline")],ImageSettings.prototype,"display",void 0),__decorate([Property("Blob")],ImageSettings.prototype,"saveFormat",void 0),__decorate([Property("auto")],ImageSettings.prototype,"width",void 0),__decorate([Property("auto")],ImageSettings.prototype,"height",void 0),__decorate([Property(null)],ImageSettings.prototype,"saveUrl",void 0),__decorate([Property(null)],ImageSettings.prototype,"path",void 0),__decorate([Property(!0)],ImageSettings.prototype,"resize",void 0),__decorate([Property(0)],ImageSettings.prototype,"minWidth",void 0),__decorate([Property(null)],ImageSettings.prototype,"maxWidth",void 0),__decorate([Property(0)],ImageSettings.prototype,"minHeight",void 0),__decorate([Property(null)],ImageSettings.prototype,"maxHeight",void 0),__decorate([Property(!1)],ImageSettings.prototype,"resizeByPercent",void 0),ImageSettings})(),ej2_richtexteditor_es2015_TableSettings=(()=>{class TableSettings extends ChildProperty{}return __decorate([Property("100%")],TableSettings.prototype,"width",void 0),__decorate([Property(TableStyleItems)],TableSettings.prototype,"styles",void 0),__decorate([Property(!0)],TableSettings.prototype,"resize",void 0),__decorate([Property(0)],TableSettings.prototype,"minWidth",void 0),__decorate([Property(null)],TableSettings.prototype,"maxWidth",void 0),TableSettings})(),ej2_richtexteditor_es2015_QuickToolbarSettings=(()=>{class QuickToolbarSettings extends ChildProperty{}return __decorate([Property(!0)],QuickToolbarSettings.prototype,"enable",void 0),__decorate([Property(!1)],QuickToolbarSettings.prototype,"showOnRightClick",void 0),__decorate([Property("hide")],QuickToolbarSettings.prototype,"actionOnScroll",void 0),__decorate([Property(["Open","Edit","UnLink"])],QuickToolbarSettings.prototype,"link",void 0),__decorate([Property(["Replace","Align","Caption","Remove","-","InsertLink","OpenImageLink","EditImageLink","RemoveImageLink","Display","AltText","Dimension"])],QuickToolbarSettings.prototype,"image",void 0),__decorate([Property(["Cut","Copy","Paste"])],QuickToolbarSettings.prototype,"text",void 0),__decorate([Property(["TableHeader","TableRows","TableColumns","BackgroundColor","-","TableRemove","Alignments","TableCellVerticalAlign","Styles"])],QuickToolbarSettings.prototype,"table",void 0),QuickToolbarSettings})(),ej2_richtexteditor_es2015_PasteCleanupSettings=(()=>{class PasteCleanupSettings extends ChildProperty{}return __decorate([Property(!1)],PasteCleanupSettings.prototype,"prompt",void 0),__decorate([Property(null)],PasteCleanupSettings.prototype,"deniedAttrs",void 0),__decorate([Property(["background","background-color","border","border-bottom","border-left","border-radius","border-right","border-style","border-top","border-width","clear","color","cursor","direction","display","float","font","font-family","font-size","font-weight","font-style","height","left","line-height","margin","margin-top","margin-left","margin-right","margin-bottom","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","table-layout","text-align","text-decoration","text-indent","top","vertical-align","visibility","white-space","width"])],PasteCleanupSettings.prototype,"allowedStyleProps",void 0),__decorate([Property(null)],PasteCleanupSettings.prototype,"deniedTags",void 0),__decorate([Property(!0)],PasteCleanupSettings.prototype,"keepFormat",void 0),__decorate([Property(!1)],PasteCleanupSettings.prototype,"plainText",void 0),PasteCleanupSettings})(),ej2_richtexteditor_es2015_FontFamily=(()=>{class FontFamily extends ChildProperty{}return __decorate([Property(null)],FontFamily.prototype,"default",void 0),__decorate([Property("65px")],FontFamily.prototype,"width",void 0),__decorate([Property(ej2_richtexteditor_es2015_fontFamily)],FontFamily.prototype,"items",void 0),FontFamily})(),ej2_richtexteditor_es2015_FontSize=(()=>{class FontSize extends ChildProperty{}return __decorate([Property(null)],FontSize.prototype,"default",void 0),__decorate([Property("35px")],FontSize.prototype,"width",void 0),__decorate([Property(ej2_richtexteditor_es2015_fontSize)],FontSize.prototype,"items",void 0),FontSize})(),ej2_richtexteditor_es2015_Format=(()=>{class Format extends ChildProperty{}return __decorate([Property(null)],Format.prototype,"default",void 0),__decorate([Property("65px")],Format.prototype,"width",void 0),__decorate([Property(ej2_richtexteditor_es2015_formatItems)],Format.prototype,"types",void 0),Format})(),ej2_richtexteditor_es2015_FontColor=(()=>{class FontColor extends ChildProperty{}return __decorate([Property("#ff0000")],FontColor.prototype,"default",void 0),__decorate([Property("Palette")],FontColor.prototype,"mode",void 0),__decorate([Property(10)],FontColor.prototype,"columns",void 0),__decorate([Property(fontColor)],FontColor.prototype,"colorCode",void 0),__decorate([Property(!1)],FontColor.prototype,"modeSwitcher",void 0),FontColor})(),ej2_richtexteditor_es2015_BackgroundColor=(()=>{class BackgroundColor extends ChildProperty{}return __decorate([Property("#ffff00")],BackgroundColor.prototype,"default",void 0),__decorate([Property("Palette")],BackgroundColor.prototype,"mode",void 0),__decorate([Property(10)],BackgroundColor.prototype,"columns",void 0),__decorate([Property(backgroundColor)],BackgroundColor.prototype,"colorCode",void 0),__decorate([Property(!1)],BackgroundColor.prototype,"modeSwitcher",void 0),BackgroundColor})(),ej2_richtexteditor_es2015_Resources=(()=>{class Resources extends ChildProperty{}return __decorate([Property([])],Resources.prototype,"styles",void 0),__decorate([Property([])],Resources.prototype,"scripts",void 0),Resources})(),ej2_richtexteditor_es2015_IFrameSettings=(()=>{class IFrameSettings extends ChildProperty{}return __decorate([Property(!1)],IFrameSettings.prototype,"enable",void 0),__decorate([Property(null)],IFrameSettings.prototype,"attributes",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_Resources)],IFrameSettings.prototype,"resources",void 0),IFrameSettings})(),ej2_richtexteditor_es2015_InlineMode=(()=>{class InlineMode extends ChildProperty{}return __decorate([Property(!1)],InlineMode.prototype,"enable",void 0),__decorate([Property(!0)],InlineMode.prototype,"onSelection",void 0),InlineMode})();function setAttributes(htmlAttributes,rte,isFrame,initial){let target;if(target=isFrame?rte.contentModule.getDocument().querySelector("body"):rte.element,Object.keys(htmlAttributes).length)for(let htmlAttr of Object.keys(htmlAttributes))"class"===htmlAttr?target.classList.add(htmlAttributes[htmlAttr]):"disabled"===htmlAttr&&"disabled"===htmlAttributes[htmlAttr]?(rte.enabled=!1,rte.setEnable()):"readonly"===htmlAttr&&"readonly"===htmlAttributes[htmlAttr]?(rte.readonly=!0,rte.setReadOnly(initial)):"style"===htmlAttr?target.setAttribute("style",htmlAttributes[htmlAttr]):"tabindex"===htmlAttr?rte.inputElement.setAttribute("tabindex",htmlAttributes[htmlAttr]):"placeholder"===htmlAttr?(rte.placeholder=htmlAttributes[htmlAttr],rte.setPlaceHolder()):["name","required"].indexOf(htmlAttr)>-1?rte.valueContainer.setAttribute(htmlAttr,htmlAttributes[htmlAttr]):target.setAttribute(htmlAttr,htmlAttributes[htmlAttr])}class ej2_richtexteditor_es2015_FullScreen{constructor(parent){this.parent=parent,this.addEventListener()}showFullScreen(event){!0===this.parent.toolbarSettings.enable&&"Markdown"!==this.parent.editorMode&&this.parent.quickToolbarModule.hideQuickToolbars(),this.scrollableParent=getScrollableParent(this.parent.element),this.parent.element.classList.contains(CLS_FULL_SCREEN)||(this.parent.trigger(ej2_richtexteditor_es2015_actionBegin,{requestType:"Maximize",targetItem:"Maximize",args:event}),this.parent.toolbarSettings.enableFloating&&!this.parent.inlineMode.enable&&this.parent.toolbarSettings.enable&&(this.parent.getToolbarElement().style.width="100%",this.parent.getToolbarElement().style.top="0px"),this.parent.element.classList.add(CLS_FULL_SCREEN),this.toggleParentOverflow(!0),this.parent.setContentHeight(),this.parent.toolbarModule&&(this.parent.getBaseToolbarObject().toolbarObj.items[0].properties||this.parent.getBaseToolbarObject().toolbarObj.removeItems(0),Browser.isDevice&&this.parent.toolbarModule.removeFixedTBarClass(),this.parent.toolbarModule.updateItem({targetItem:"Maximize",updateItem:"Minimize",baseToolbar:this.parent.getBaseToolbarObject()})),this.parent.trigger(ej2_richtexteditor_es2015_actionComplete,{requestType:"Maximize",targetItem:"Maximize",args:event}))}hideFullScreen(event){if(!0===this.parent.toolbarSettings.enable&&"Markdown"!==this.parent.editorMode&&this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.element.classList.contains(CLS_FULL_SCREEN)){this.parent.element.classList.remove(CLS_FULL_SCREEN);let elem=document.querySelectorAll(".e-rte-overflow");for(let i=0;i<elem.length;i++)removeClass([elem[i]],["e-rte-overflow"]);this.parent.trigger(ej2_richtexteditor_es2015_actionBegin,{requestType:"Minimize",targetItem:"Minimize",args:event}),this.parent.setContentHeight(),this.parent.toolbarModule&&(this.parent.getBaseToolbarObject().toolbarObj.items[0].properties||this.parent.getBaseToolbarObject().toolbarObj.removeItems(0),this.parent.toolbarModule.updateItem({targetItem:"Minimize",updateItem:"Maximize",baseToolbar:this.parent.getBaseToolbarObject()}),Browser.isDevice&&this.parent.inlineMode.enable&&this.parent.toolbarModule.addFixedTBarClass()),this.parent.trigger(ej2_richtexteditor_es2015_actionComplete,{requestType:"Minimize",targetItem:"Minimize",args:event})}}toggleParentOverflow(isAdd){if(!isNullOrUndefined(this.scrollableParent))for(let i=0;i<this.scrollableParent.length;i++)addClass("#document"===this.scrollableParent[i].nodeName?[document.querySelector("body")]:[this.scrollableParent[i]],["e-rte-overflow"])}onKeyDown(event){let originalEvent=event.args;switch(originalEvent.action){case"full-screen":this.showFullScreen(event.args),originalEvent.preventDefault();break;case"escape":this.hideFullScreen(event.args),originalEvent.preventDefault()}}addEventListener(){this.parent.on(keyDown,this.onKeyDown,this),this.parent.on(ej2_richtexteditor_es2015_destroy,this.destroy,this)}removeEventListener(){this.parent.on(keyDown,this.onKeyDown,this),this.parent.off(ej2_richtexteditor_es2015_destroy,this.removeEventListener)}destroy(){this.parent.element.classList.contains(CLS_FULL_SCREEN)&&this.toggleParentOverflow(!1),this.removeEventListener()}}class ej2_richtexteditor_es2015_DialogRenderer{constructor(parent){this.parent=parent}render(e){let dlgObj;return isNullOrUndefined(e.beforeOpen)&&(e.beforeOpen=this.beforeOpen.bind(this)),isNullOrUndefined(e.open)&&(e.open=this.open.bind(this)),isNullOrUndefined(e.close)&&(e.close=this.close.bind(this)),(dlgObj=new ej2_popups_es2015_Dialog(e)).isStringTemplate=!0,dlgObj}beforeOpen(args){this.parent.trigger(beforeDialogOpen,args)}open(args){this.parent.trigger(dialogOpen,args)}close(args){this.parent.trigger(dialogClose,args)}}let ej2_richtexteditor_es2015_RichTextEditor=(()=>{let RichTextEditor=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.defaultResetValue=null,this.isFocusOut=!1,this.isRTE=!1,this.isBlur=!0,this.needsID=!0}requiredModules(){let modules=[];return this.toolbarSettings.enable&&(modules.push({member:"toolbar",args:[this,this.serviceLocator]}),modules.push({member:"link",args:[this,this.serviceLocator]}),modules.push({member:"table",args:[this,this.serviceLocator]}),modules.push({member:"image",args:[this,this.serviceLocator]}),this.quickToolbarSettings.enable&&modules.push({member:"quickToolbar",args:[this,this.serviceLocator]})),this.showCharCount&&modules.push({member:"count",args:[this,this.serviceLocator]}),"Markdown"===this.editorMode&&modules.push({member:"markdownEditor",args:[this,this.serviceLocator]}),"HTML"===this.editorMode&&(modules.push({member:"htmlEditor",args:[this,this.serviceLocator]}),modules.push({member:"pasteCleanup",args:[this,this.serviceLocator]})),modules}updateEnable(){this.enabled?(removeClass([this.element],"e-disabled"),this.element.setAttribute("aria-disabled","false"),isNullOrUndefined(this.htmlAttributes.tabindex)?this.inputElement.setAttribute("tabindex","0"):this.inputElement.setAttribute("tabindex",this.htmlAttributes.tabindex)):(this.getToolbar()&&(removeClass(this.getToolbar().querySelectorAll("."+ej2_richtexteditor_es2015_CLS_ACTIVE),ej2_richtexteditor_es2015_CLS_ACTIVE),removeClass([this.getToolbar()],[CLS_TB_FLOAT,CLS_TB_ABS_FLOAT])),addClass([this.element],"e-disabled"),this.element.tabIndex=-1,this.element.setAttribute("aria-disabled","true"),this.inputElement.setAttribute("tabindex","-1"))}setEnable(){this.updateEnable(),this.enabled?this.eventInitializer():this.unWireEvents()}preRender(){this.onBlurHandler=this.blurHandler.bind(this),this.onFocusHandler=this.focusHandler.bind(this),this.onResizeHandler=this.resizeHandler.bind(this),this.clickPoints={clientX:0,clientY:0},this.initialValue=this.value,this.serviceLocator=new ej2_richtexteditor_es2015_ServiceLocator,this.initializeServices(),this.setContainer(),this.persistData(),setStyleAttribute(this.element,{width:formatUnit(this.width)}),attributes(this.element,{role:"application"})}persistData(){if(this.enablePersistence&&"TEXTAREA"===this.originalElement.tagName){let data=window.localStorage.getItem(this.getModuleName()+this.element.id);isNullOrUndefined(data)||""===data||this.setProperties(JSON.parse(data),!0)}}setContainer(){this.originalElement=this.element.cloneNode(!0),null!==this.value&&null===this.valueTemplate||this.setValue(),this.element.hasAttribute("tabindex")&&(this.htmlAttributes={tabindex:this.element.getAttribute("tabindex")},this.element.removeAttribute("tabindex")),this.isBlazor()||(this.element.innerHTML="");let invalidAttr=["class","style","id","ejs-for"],htmlAttr={};for(let a=0;a<this.element.attributes.length;a++)-1!==invalidAttr.indexOf(this.element.attributes[a].name)||/^data-val/.test(this.element.attributes[a].name)||(htmlAttr[this.element.attributes[a].name]=this.element.getAttribute(this.element.attributes[a].name));if(extend(htmlAttr,this.htmlAttributes,htmlAttr),this.setProperties({htmlAttributes:htmlAttr},!0),isNullOrUndefined(this.htmlAttributes.id)||(this.element.id=this.htmlAttributes.id),"TEXTAREA"===this.element.tagName){let rteOuterWrapper=this.createElement("div",{className:this.element.getAttribute("class")});this.isBlazor()||(this.element.innerHTML=""),this.element.parentElement.insertBefore(rteOuterWrapper,this.element),this.valueContainer=this.element,removeClass([this.valueContainer],this.element.getAttribute("class").split(" ")),this.element=rteOuterWrapper}else this.valueContainer=this.createElement("textarea",{id:this.getID()+"-value"});this.valueContainer.name=this.getID(),addClass([this.valueContainer],"e-rte-hidden"),this.element.appendChild(this.valueContainer)}getPersistData(){return this.addOnPersist(["value"])}focusIn(){this.enabled&&(this.inputElement.focus(),this.focusHandler({}))}focusOut(){this.enabled&&(this.inputElement.blur(),this.blurHandler({}))}selectAll(){this.notify(selectAll$1,{})}selectRange(range){this.notify(selectRange,{range:range})}getSelection(){let str="";return this.notify(getSelectedHtml,{callBack:txt=>{str=txt}}),str}executeCommand(commandName,value){if(value=this.htmlPurifier(commandName,value),"HTML"===this.editorMode){let range=this.getRange();this.iframeSettings.enable&&this.formatter.editorManager.nodeSelection.Clear(this.element.ownerDocument),(this.iframeSettings.enable&&range.startContainer===this.inputElement||!this.inputElement.contains(range.startContainer))&&this.focusIn()}let tool=executeGroup[commandName];this.formatter.editorManager.execCommand(tool.command,tool.subCommand?tool.subCommand:value||tool.value,null,null,value||tool.value,value||tool.value)}htmlPurifier(command,value){if("HTML"===this.editorMode)switch(command){case"insertHTML":value=this.htmlEditorModule.sanitizeHelper("string"==typeof value?value:value.outerHTML);break;case"insertImage":let temp=this.createElement("img",{attrs:{src:value.url}}),imageValue=this.htmlEditorModule.sanitizeHelper(temp.outerHTML),url=""!==imageValue&&this.createElement("div",{innerHTML:imageValue}).firstElementChild.getAttribute("src")||null;url=isNullOrUndefined(url)?"":url,value.url=url;break;case"createLink":let tempNode=this.createElement("a",{attrs:{href:value.url}}),linkValue=this.htmlEditorModule.sanitizeHelper(tempNode.outerHTML),href=""!==linkValue&&this.createElement("div",{innerHTML:linkValue}).firstElementChild.getAttribute("href")||null;href=isNullOrUndefined(href)?"":href,value.url=href}return value}encode(value){let divNode=this.createElement("div");return divNode.innerText=value.trim(),divNode.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")}render(){this.value&&!this.valueTemplate&&this.setProperties({value:this.serializeValue(this.value)},!0),this.renderModule=new ej2_richtexteditor_es2015_Render(this,this.serviceLocator),this.sourceCodeModule=new ej2_richtexteditor_es2015_ViewSource(this,this.serviceLocator),this.notify(ej2_richtexteditor_es2015_initialLoad,{}),this.trigger("load"),this.RTERender(),new ExecCommandCallBack(this),this.notify(ej2_richtexteditor_es2015_initialEnd,{}),this.toolbarSettings.enable&&"Expand"===this.toolbarSettings.type&&!isNullOrUndefined(this.getToolbar())&&this.toolbarSettings.items.indexOf("Undo")>-1&&this.toolbarSettings.items.indexOf("Redo")>-1&&this.disableToolbarItem(["Undo","Redo"]),this.setContentHeight(),null!==this.value&&(this.isBlazor()?this.defaultResetValue=this.value:this.valueContainer.defaultValue=this.value),this.enabled?this.eventInitializer():this.unWireEvents(),this.renderComplete()}eventInitializer(){this.wireEvents()}keyDown(e){if(this.notify(keyDown,{member:"keydown",args:e}),this.restrict(e),0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData(),e.action&&"paste"!==e.action||9===e.which)switch(this.formatter.process(this,null,e),e.action){case"toolbar-focus":this.toolbarSettings.enable&&this.toolbarModule.baseToolbar.toolbarObj.element.querySelector('.e-toolbar-item[aria-disabled="false"][title] [tabindex]').focus();break;case"escape":this.contentModule.getEditPanel().focus()}isNullOrUndefined(this.placeholder)||this.setPlaceHolder(),this.autoResize()}keyUp(e){this.notify(keyUp,{member:"keyup",args:e});let allowedKeys=32===e.which||13===e.which||8===e.which||46===e.which;("shift"!==e.key&&!e.ctrlKey&&e.key&&1===e.key.length||allowedKeys||"Markdown"===this.editorMode&&("shift"!==e.key&&!e.ctrlKey&&e.key&&1===e.key.length||allowedKeys)&&!this.inlineMode.enable)&&this.formatter.onKeyHandler(this,e),this.inputElement&&0!==this.inputElement.textContent.length&&this.notify(ej2_richtexteditor_es2015_toolbarRefresh,{args:e}),isNullOrUndefined(this.placeholder)||this.setPlaceHolder()}serializeValue(value){return"HTML"!==this.editorMode||isNullOrUndefined(value)||(this.enableHtmlEncode?(value=this.htmlEditorModule.sanitizeHelper(ej2_richtexteditor_es2015_decode(value)),value=this.encode(value)):value=this.htmlEditorModule.sanitizeHelper(value)),value}sanitizeHtml(value){return this.serializeValue(value)}updateValue(value){if(isNullOrUndefined(value)){let inputVal=this.inputElement.innerHTML;this.setProperties({value:isEditableValueEmpty(inputVal)?null:inputVal})}else this.setProperties({value:value})}triggerEditArea(e){if(isIDevice()){let touch=e.touches?e.changedTouches[0]:e;this.clickPoints.clientX===touch.clientX&&this.clickPoints.clientY===touch.clientY&&this.notify(editAreaClick,{member:"editAreaClick",args:e})}else this.notify(editAreaClick,{member:"editAreaClick",args:e})}notifyMouseUp(e){let touch=e.touches?e.changedTouches[0]:e;this.notify(ej2_richtexteditor_es2015_mouseUp,{member:"mouseUp",args:e,touchData:{prevClientX:this.clickPoints.clientX,prevClientY:this.clickPoints.clientY,clientX:touch.clientX,clientY:touch.clientY}}),this.inputElement&&("HTML"===this.editorMode&&0!==this.inputElement.textContent.length||"Markdown"===this.editorMode&&0!==this.inputElement.value.length)&&this.notify(ej2_richtexteditor_es2015_toolbarRefresh,{args:e}),this.triggerEditArea(e)}mouseUp(e){if(this.quickToolbarSettings.showOnRightClick&&Browser.isDevice){let target=e.target,closestTable=closest(target,"table");if(target&&"A"===target.nodeName||"IMG"===target.nodeName||"TD"===target.nodeName||"TH"===target.nodeName||"TABLE"===target.nodeName||closestTable&&this.contentModule.getEditPanel().contains(closestTable))return}this.notifyMouseUp(e)}ensureModuleInjected(module){return this.getInjectedModules().indexOf(module)>=0}onCopy(){this.contentModule.getDocument().execCommand("copy",!1,null)}onCut(){this.contentModule.getDocument().execCommand("cut",!1,null)}onPaste(e){this.trigger(ej2_richtexteditor_es2015_actionBegin,{originalEvent:e,cancel:!1,requestType:"Paste"},pasteArgs=>{let currentLength=this.getText().length,selectionLength=this.getSelection().length,pastedContentLength=isNullOrUndefined(e)||isNullOrUndefined(e.clipboardData)?0:e.clipboardData.getData("text/plain").length;if(!pasteArgs.cancel&&(-1===this.maxLength||currentLength-selectionLength+pastedContentLength<this.maxLength))if(isNullOrUndefined(this.pasteCleanupModule)){let args={requestType:"Paste",editorMode:this.editorMode,event:e},value=null;e&&!isNullOrUndefined(e.clipboardData)&&(value=e.clipboardData.getData("text/plain"));let file=e&&e.clipboardData&&e.clipboardData.items.length>0?e.clipboardData.items[0].getAsFile():null;null!==value&&this.notify(ej2_richtexteditor_es2015_paste,{file:file,args:e,text:value}),setTimeout(()=>{this.formatter.onSuccess(this,args)},0)}else this.notify("pasteClean",{args:e});else e.preventDefault()})}clipboardAction(action,event){switch(action.toLowerCase()){case"cut":this.onCut(),this.formatter.onSuccess(this,{requestType:"Cut",editorMode:this.editorMode,event:event});break;case"copy":this.onCopy(),this.formatter.onSuccess(this,{requestType:"Copy",editorMode:this.editorMode,event:event});break;case"paste":this.onPaste(event)}}destroy(){if(this.notify(ej2_richtexteditor_es2015_destroy,{}),this.destroyDependentModules(),isNullOrUndefined(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),this.unWireEvents(),"TEXTAREA"===this.originalElement.tagName){this.element.parentElement.insertBefore(this.valueContainer,this.element),this.valueContainer.id=this.getID(),this.valueContainer.removeAttribute("name"),detach(this.element),""!==this.originalElement.innerHTML.trim()?(this.valueContainer.value=this.originalElement.innerHTML.trim(),this.setProperties({value:isNullOrUndefined(this.initialValue)?null:this.initialValue},!0)):this.valueContainer.value=this.isBlazor()?this.defaultResetValue:this.valueContainer.defaultValue,this.element=this.valueContainer;for(let i=0;i<this.originalElement.classList.length;i++)addClass([this.element],this.originalElement.classList[i]);removeClass([this.element],"e-rte-hidden")}else""!==this.originalElement.innerHTML.trim()?(this.element.innerHTML=this.originalElement.innerHTML.trim(),this.setProperties({value:isNullOrUndefined(this.initialValue)?null:this.initialValue},!0)):this.element.innerHTML="";this.placeholder&&this.placeHolderWrapper&&(this.placeHolderWrapper=null),isNullOrUndefined(this.cssClass)||removeClass([this.element],this.cssClass),this.removeHtmlAttributes(),this.removeAttributes(),super.destroy()}removeHtmlAttributes(){if(this.htmlAttributes){let keys=Object.keys(this.htmlAttributes);for(let i=0;i<keys.length&&this.element.hasAttribute(keys[i]);i++)this.element.removeAttribute(keys[i])}}removeAttributes(){this.enabled||removeClass([this.element],"e-disabled"),this.enableRtl&&removeClass([this.element],"e-rtl"),this.readonly&&removeClass([this.element],CLS_RTE_READONLY),""!==this.element.style.width&&""===this.originalElement.style.width&&this.element.style.removeProperty("width"),""!==this.element.style.height&&""===this.originalElement.style.height&&this.element.style.removeProperty("height"),this.element.removeAttribute("aria-disabled"),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex")}destroyDependentModules(){this.renderModule.destroy(),this.formatter.editorManager.undoRedoManager.destroy(),this.sourceCodeModule.destroy()}getContent(){return this.iframeSettings.enable&&isBlazor()?this.inputElement:this.contentModule.getPanel()}getText(){return this.contentModule.getText()}getModuleName(){return"richtexteditor"}onPropertyChanged(newProp,oldProp){for(let prop of Object.keys(newProp))switch(prop){case"value":let val,nVal=newProp[prop];val="HTML"===this.editorMode?getEditValue(nVal,this):nVal,isNullOrUndefined(nVal)||""===nVal||(this.value=this.serializeValue(this.enableHtmlEncode?this.encode(ej2_richtexteditor_es2015_decode(val)):val)),this.updatePanelValue(),this.setPlaceHolder(),this.showCharCount&&this.countModule.refresh();break;case"valueTemplate":this.setValue(),this.showCharCount&&this.countModule.refresh();break;case"width":this.setWidth(newProp[prop]),this.toolbarSettings.enable&&(this.toolbarModule.refreshToolbarOverflow(),this.resizeHandler());break;case"height":this.setHeight(newProp[prop]),this.setContentHeight(),this.autoResize();break;case"readonly":this.setReadOnly(!1);break;case"cssClass":this.element.classList.remove(oldProp[prop]),this.setCssClass(newProp[prop]);break;case"enabled":this.setEnable();break;case"enableRtl":this.updateRTL();break;case"placeholder":this.placeholder=newProp[prop],this.setPlaceHolder();break;case"htmlAttributes":setAttributes(this.htmlAttributes,this,!1,!1);break;case"iframeSettings":let frameSetting=oldProp[prop];if(frameSetting.resources){let files,header=this.contentModule.getDocument().querySelector("head");frameSetting.resources.scripts&&(files=header.querySelectorAll(".rte-iframe-script-sheet"),this.removeSheets(files)),frameSetting.resources.styles&&(files=header.querySelectorAll(".rte-iframe-style-sheet"),this.removeSheets(files))}this.setIframeSettings();break;case"locale":super.refresh();break;case"inlineMode":this.notify(ej2_richtexteditor_es2015_modelChanged,{module:"quickToolbar",newProp:newProp,oldProp:oldProp}),this.setContentHeight();break;case"toolbarSettings":this.notify(ej2_richtexteditor_es2015_modelChanged,{module:"toolbar",newProp:newProp,oldProp:oldProp}),this.setContentHeight();break;case"maxLength":this.showCharCount&&this.countModule.refresh();break;case"showCharCount":newProp[prop]&&this.countModule?this.countModule.renderCount():!1===newProp[prop]&&this.countModule&&this.countModule.destroy();break;case"enableHtmlEncode":this.updateValueData(),this.updatePanelValue(),this.setPlaceHolder(),this.showCharCount&&this.countModule.refresh();break;case"undoRedoSteps":case"undoRedoTimer":this.formatter.editorManager.observer.notify(MODEL_CHANGED,{newProp:newProp,oldProp:oldProp});break;case"quickToolbarSettings":newProp.quickToolbarSettings.showOnRightClick?this.wireContextEvent():this.unWireContextEvent(),this.notify(ej2_richtexteditor_es2015_modelChanged,{newProp:newProp,oldProp:oldProp});break;default:this.notify(ej2_richtexteditor_es2015_modelChanged,{newProp:newProp,oldProp:oldProp})}}updateValueData(){this.enableHtmlEncode?this.setProperties({value:this.encode(ej2_richtexteditor_es2015_decode(this.inputElement.innerHTML))},!0):this.setProperties({value:/<[a-z][\s\S]*>/i.test(this.inputElement.innerHTML)?this.inputElement.innerHTML:ej2_richtexteditor_es2015_decode(this.inputElement.innerHTML)})}removeSheets(srcList){let i;for(i=0;i<srcList.length;i++)detach(srcList[i])}updatePanelValue(){let value=this.value;(value=this.enableHtmlEncode&&this.value?ej2_richtexteditor_es2015_decode(value):value)?(this.valueContainer&&(this.valueContainer.value=this.enableHtmlEncode?this.value:value),"HTML"===this.editorMode&&this.inputElement&&this.inputElement.innerHTML.trim()!==value.trim()?this.inputElement.innerHTML=value:"Markdown"===this.editorMode&&this.inputElement&&this.inputElement.value.trim()!==value.trim()&&(this.inputElement.value=value)):("HTML"===this.editorMode?this.inputElement.innerHTML="<p><br/></p>":this.inputElement.value="",this.valueContainer&&(this.valueContainer.value="")),this.showCharCount&&this.countModule.refresh()}setHeight(height){this.element.style.height="auto"!==height?formatUnit(height):"auto"}setPlaceHolder(){this.inputElement&&this.placeholder&&!0!==this.iframeSettings.enable&&("Markdown"!==this.editorMode?(this.placeHolderWrapper||(this.placeHolderWrapper=this.createElement("span",{className:"rte-placeholder"}),this.inputElement&&this.inputElement.parentElement.insertBefore(this.placeHolderWrapper,this.inputElement),attributes(this.placeHolderWrapper,{style:"font-size: 16px; padding: 16px; margin-left: 0px; margin-right: 0px;"})),this.placeHolderWrapper.innerHTML=this.placeholder,this.placeHolderWrapper.style.display=0!==this.inputElement.textContent.length?"none":"block"):this.inputElement.setAttribute("placeholder",this.placeholder))}setWidth(width){"auto"!==width?setStyleAttribute(this.element,{width:formatUnit(this.width)}):this.element.style.width="auto"}setCssClass(cssClass){isNullOrUndefined(cssClass)||this.element.classList.add(cssClass)}updateRTL(){this.notify(rtlMode,{enableRtl:this.enableRtl}),this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}updateReadOnly(){this.notify(readOnlyMode,{editPanel:this.inputElement,mode:this.readonly})}setReadOnly(initial){this.updateReadOnly(),initial||(this.readonly&&this.enabled?this.unbindEvents():this.enabled&&this.bindEvents())}print(){let printWind;this.trigger(ej2_richtexteditor_es2015_actionBegin,{element:this.inputElement,requestType:"print",cancel:!1},printingArgs=>{printWind=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth),"msie"===Browser.info.name&&printWind.resizeTo(screen.availWidth,screen.availHeight),printWind=print(this.inputElement,printWind),printingArgs.cancel||this.trigger(ej2_richtexteditor_es2015_actionComplete,{requestType:"print"})})}refreshUI(){this.renderModule.refresh()}showFullScreen(){this.readonly||this.fullScreenModule.showFullScreen()}enableToolbarItem(items,muteToolbarUpdate){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),items,!0,muteToolbarUpdate)}disableToolbarItem(items,muteToolbarUpdate){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),items,!1,muteToolbarUpdate)}removeToolbarItem(items){this.toolbarModule.removeTBarItems(items)}getRange(){return this.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument())}initializeServices(){this.serviceLocator.register("rendererFactory",new ej2_richtexteditor_es2015_RendererFactory),this.serviceLocator.register("rteLocale",this.localeObj=new L10n(this.getModuleName(),defaultLocale,this.locale)),this.serviceLocator.register("dialogRenderObject",new ej2_richtexteditor_es2015_DialogRenderer(this))}RTERender(){let rendererFactory=this.serviceLocator.getService("rendererFactory");this.contentModule=rendererFactory.getRenderer(ej2_richtexteditor_es2015_RenderType.Content),this.fullScreenModule=new ej2_richtexteditor_es2015_FullScreen(this),this.renderModule.render(),this.inputElement=this.contentModule.getEditPanel(),this.setHeight(this.height),setAttributes(this.htmlAttributes,this,!1,!0),this.iframeSettings&&this.setIframeSettings(),this.setCssClass(this.cssClass),this.updateEnable(),this.setPlaceHolder(),this.updateRTL(),this.updateReadOnly(),this.updatePanelValue(),this.enableHtmlEncode&&!isNullOrUndefined(this.value)&&this.setProperties({value:this.encode(ej2_richtexteditor_es2015_decode(this.value))})}setIframeSettings(){if(this.iframeSettings.resources){let styleSrc=this.iframeSettings.resources.styles,scriptSrc=this.iframeSettings.resources.scripts;this.iframeSettings.resources.scripts.length>0&&this.InjectSheet(!0,scriptSrc),this.iframeSettings.resources.styles.length>0&&this.InjectSheet(!1,styleSrc)}this.iframeSettings.attributes&&setAttributes(this.iframeSettings.attributes,this,!0,!1)}InjectSheet(scriptSheet,srcList){try{if(srcList&&srcList.length>0){let target=this.contentModule.getDocument().querySelector("head");for(let i=0;i<srcList.length;i++)if(scriptSheet){let scriptEle=this.createScriptElement();scriptEle.src=srcList[i],target.appendChild(scriptEle)}else{let styleEle=this.createStyleElement();styleEle.href=srcList[i],target.appendChild(styleEle)}}}catch(e){return}}createScriptElement(){let scriptEle=this.createElement("script",{className:"rte-iframe-script-sheet"});return scriptEle.type="text/javascript",scriptEle}createStyleElement(){let styleEle=this.createElement("link",{className:"rte-iframe-style-sheet"});return styleEle.rel="stylesheet",styleEle}isBlazor(){return-1!==Object.keys(window).indexOf("ejsInterop")}setValue(){if(this.valueTemplate)if("string"==typeof this.valueTemplate)this.setProperties({value:this.valueTemplate});else{let compiledString,compiledTemplate=(compiledString=compile$$1(this.valueTemplate))({});for(let i=0;i<compiledTemplate.length;i++)append([compiledTemplate[i]],this.element);this.setProperties({value:this.element.innerHTML.trim()})}else{let innerHtml=!isNullOrUndefined(this.element.innerHTML)&&this.element.innerHTML.replace(/<(\/?|\!?)(!--!--)>/g,"").trim();""!==innerHtml&&this.setProperties("TEXTAREA"===this.element.tagName?{value:ej2_richtexteditor_es2015_decode(innerHtml)}:{value:innerHtml})}}setContentHeight(target,isExpand){let heightValue,topValue=0,cntEle=this.sourceCodeModule.getPanel()&&"block"===this.sourceCodeModule.getPanel().parentElement.style.display?this.sourceCodeModule.getPanel().parentElement:this.contentModule.getPanel(),rteHeight=this.element.offsetHeight,tbHeight=this.getToolbar()?this.toolbarModule.getToolbarHeight():0,expandPopHeight=this.getToolbar()?this.toolbarModule.getExpandTBarPopHeight():0;this.toolbarSettings.type===ToolbarType.Expand&&isExpand&&"preview"!==target?(heightValue="auto"===this.height?"auto":rteHeight-(tbHeight+expandPopHeight)+"px",topValue=this.toolbarSettings.enableFloating?0:expandPopHeight):heightValue="auto"!==this.height||this.element.classList.contains("e-rte-full-screen")?rteHeight-tbHeight+"px":"auto",setStyleAttribute(cntEle,{height:heightValue,marginTop:topValue+"px"}),this.iframeSettings.enable&&"sourceCode"===target&&setStyleAttribute(ej2_base_es2015_select("."+CLS_RTE_CONTENT,this.element),{height:heightValue,marginTop:topValue+"px"}),this.toolbarSettings.enableFloating&&this.getToolbar()&&!this.inlineMode.enable&&setStyleAttribute(this.getToolbar().parentElement,isExpand?{height:tbHeight+expandPopHeight+"px"}:{height:tbHeight+"px"}),this.autoResize()}getHtml(){return this.value}showSourceCode(){this.readonly||this.notify(sourceCode,{})}getCharCount(){return("Markdown"===this.editorMode?this.inputElement.value.trim():this.inputElement.textContent.trim()).length}getBaseToolbarObject(){return!this.inlineMode.enable||Browser.isDevice&&!isIDevice()?this.toolbarModule&&this.toolbarModule.getBaseToolbar():this.quickToolbarModule&&this.quickToolbarModule.getInlineBaseToolbar()}getToolbar(){return this.toolbarModule?this.toolbarModule.getToolbarElement():null}getToolbarElement(){return this.toolbarModule&&this.toolbarModule.getToolbarElement()}getID(){return"TEXTAREA"===this.originalElement.tagName?this.valueContainer.id:this.element.id}mouseDownHandler(e){let touch=e.touches?e.changedTouches[0]:e;addClass([this.element],["e-focused"]),this.preventDefaultResize(e),this.notify(ej2_richtexteditor_es2015_mouseDown,{args:e}),this.clickPoints={clientX:touch.clientX,clientY:touch.clientY}}preventImgResize(e){"img"===e.target.nodeName.toLocaleLowerCase()&&e.preventDefault()}preventDefaultResize(e){"msie"===Browser.info.name?this.contentModule.getEditPanel().addEventListener("mscontrolselect",this.preventImgResize):"mozilla"===Browser.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!1,"false"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!1,"false"))}defaultResize(e){"msie"===Browser.info.name?this.contentModule.getEditPanel().removeEventListener("mscontrolselect",this.preventImgResize):"mozilla"===Browser.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!0,"true"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!0,"true"))}resizeHandler(){let isExpand=!1;this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),isExpand=this.toolbarModule.baseToolbar.toolbarObj.element.classList.contains(CLS_EXPAND_OPEN)),this.setContentHeight("",isExpand)}scrollHandler(e){this.notify(ej2_richtexteditor_es2015_scroll,{args:e})}focusHandler(e){if((!this.isRTE||this.isFocusOut)&&!this.readonly){this.isRTE=!this.isFocusOut,this.isFocusOut=!1,addClass([this.element],["e-focused"]),this.cloneValue="HTML"===this.editorMode?"<p><br></p>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(ej2_richtexteditor_es2015_decode(this.inputElement.innerHTML)):this.inputElement.innerHTML:""===this.inputElement.value?null:this.inputElement.value;let active=document.activeElement;if((active===this.element||active===this.getToolbarElement()||active===this.contentModule.getEditPanel()||this.iframeSettings.enable&&active===this.contentModule.getPanel()||active.closest(".e-rte-toolbar")===this.getToolbarElement())&&(this.contentModule.getEditPanel().focus(),!isNullOrUndefined(this.getToolbarElement()))){this.getToolbarElement().setAttribute("tabindex","-1");let items=this.getToolbarElement().querySelectorAll('[tabindex="0"]');0!==items.length&&items.forEach(element=>{element.setAttribute("tabindex","-1")})}this.preventDefaultResize(e),this.trigger("focus",{event:e,isInteracted:0!==Object.keys(e).length}),!isNullOrUndefined(this.saveInterval)&&this.saveInterval>0&&(this.timeInterval=setInterval(this.updateIntervalValue.bind(this),this.saveInterval)),EventHandler.add(document,"mousedown",this.onDocumentClick,this)}isNullOrUndefined(this.getToolbarElement())||this.getToolbarElement().querySelectorAll("input,select,button,a,[tabindex]").forEach(item=>{item.hasAttribute("tabindex")&&"-1"===item.getAttribute("tabindex")||item.setAttribute("tabindex","-1")})}getUpdatedValue(){return"HTML"===this.editorMode?"<p><br></p>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(ej2_richtexteditor_es2015_decode(this.inputElement.innerHTML)):this.inputElement.innerHTML:""===this.inputElement.value?null:this.inputElement.value}updateIntervalValue(){this.setProperties({value:this.getUpdatedValue()},!0),this.valueContainer.value=this.value,this.invokeChangeEvent()}onDocumentClick(e){let target=e.target,rteElement=closest(target,".e-richtexteditor");this.element.contains(e.target)||document===e.target||rteElement===this.element||closest(target,'[aria-owns="'+this.getID()+'"]')||(this.isBlur=!0,this.isRTE=!1),this.notify("docClick",{args:e})}blurHandler(e){let trg=e.relatedTarget;if(trg){let rteElement=closest(trg,".e-richtexteditor");rteElement&&rteElement===this.element?(this.isBlur=!1,trg===this.getToolbarElement()&&trg.setAttribute("tabindex","-1")):closest(trg,'[aria-owns="'+this.getID()+'"]')?this.isBlur=!1:(this.isBlur=!0,trg=null)}if(this.isBlur&&isNullOrUndefined(trg)){removeClass([this.element],["e-focused"]),this.notify(focusChange,{});let value=this.getUpdatedValue();this.setProperties({value:value}),this.notify(ej2_richtexteditor_es2015_toolbarRefresh,{args:e,documentNode:document}),this.invokeChangeEvent(),this.isFocusOut=!0,this.isBlur=!1,ej2_richtexteditor_es2015_dispatchEvent(this.valueContainer,"focusout"),this.defaultResize(e),this.trigger("blur",{event:e,isInteracted:0!==Object.keys(e).length}),isNullOrUndefined(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),EventHandler.remove(document,"mousedown",this.onDocumentClick)}else this.isRTE=!0}invokeChangeEvent(){this.value!==this.cloneValue&&(this.trigger("change",{value:this.value}),this.cloneValue=this.value)}wireScrollElementsEvents(){this.scrollParentElements=getScrollableParent(this.element);for(let element of this.scrollParentElements)EventHandler.add(element,"scroll",this.scrollHandler,this);this.iframeSettings.enable||EventHandler.add(this.contentModule.getPanel(),"scroll",this.scrollHandler,this)}wireContextEvent(){this.quickToolbarSettings.showOnRightClick&&(EventHandler.add(this.inputElement,"contextmenu",this.contextHandler,this),Browser.isDevice&&(this.touchModule=new ej2_base_es2015_Touch(this.inputElement,{tapHold:this.touchHandler.bind(this),tapHoldThreshold:500})))}unWireContextEvent(){EventHandler.remove(this.inputElement,"contextmenu",this.contextHandler),Browser.isDevice&&this.touchModule&&this.touchModule.destroy()}unWireScrollElementsEvents(){this.scrollParentElements=getScrollableParent(this.element);for(let element of this.scrollParentElements)EventHandler.remove(element,"scroll",this.scrollHandler);this.iframeSettings.enable||EventHandler.remove(this.contentModule.getPanel(),"scroll",this.scrollHandler)}touchHandler(e){this.notifyMouseUp(e.originalEvent),this.triggerEditArea(e.originalEvent)}contextHandler(e){let closestElem=closest(e.target,"a, table, img");!1!==this.inlineMode.onSelection&&(isNullOrUndefined(closestElem)||!this.inputElement.contains(closestElem)||"IMG"!==closestElem.tagName&&"TABLE"!==closestElem.tagName&&"A"!==closestElem.tagName)||e.preventDefault()}resetHandler(){let defaultValue=this.valueContainer.defaultValue.trim();this.setProperties({value:""===defaultValue?null:this.isBlazor()?this.defaultResetValue:defaultValue})}autoResize(){if("auto"===this.height){if("Markdown"===this.editorMode)setTimeout(()=>{this.setAutoHeight(this.inputElement)},0);else if(this.iframeSettings.enable){let iframeElement=this.element.querySelector("#"+this.getID()+"_rte-view");setTimeout(()=>{this.setAutoHeight(iframeElement)},0)}}else this.inputElement.style.overflow=null}setAutoHeight(element){element.style.height="",element.style.height=this.inputElement.scrollHeight+"px",element.style.overflow="hidden"}wireEvents(){this.element.addEventListener("focusin",this.onFocusHandler,!0),this.element.addEventListener("focusout",this.onBlurHandler,!0),this.readonly&&this.enabled||this.bindEvents()}restrict(e){if(this.maxLength>=0){let arrayKey,element=e.currentTarget.textContent.trim(),array=[8,16,17,37,38,39,40,46,65];for(let i=0;i<=array.length-1;i++)if(e.which===array[i]){if(e.ctrlKey&&65===e.which)return;if(65!==e.which)return void(arrayKey=array[i])}element.length>=this.maxLength&&-1!==this.maxLength&&e.which!==arrayKey&&e.preventDefault()}}bindEvents(){this.keyboardModule=new ej2_richtexteditor_es2015_KeyboardEvents$1(this.inputElement,{keyAction:this.keyDown.bind(this),keyConfigs:Object.assign({},this.formatter.keyConfig,this.keyConfig),eventName:"keydown"});let formElement=closest(this.valueContainer,"form");formElement&&EventHandler.add(formElement,"reset",this.resetHandler,this),EventHandler.add(this.inputElement,"keyup",this.keyUp,this),EventHandler.add(this.inputElement,"paste",this.onPaste,this),EventHandler.add(this.inputElement,Browser.touchEndEvent,debounce(this.mouseUp,30),this),EventHandler.add(this.inputElement,Browser.touchStartEvent,this.mouseDownHandler,this),this.wireContextEvent(),this.formatter.editorManager.observer.on(KEY_DOWN_HANDLER,this.editorKeyDown,this),this.element.ownerDocument.defaultView.addEventListener("resize",this.onResizeHandler,!0),this.iframeSettings.enable&&(EventHandler.add(this.inputElement,"focusin",this.focusHandler,this),EventHandler.add(this.inputElement,"focusout",this.blurHandler,this),EventHandler.add(this.inputElement.ownerDocument,"scroll",this.scrollHandler,this),EventHandler.add(this.inputElement.ownerDocument,Browser.touchStartEvent,this.onIframeMouseDown,this)),this.wireScrollElementsEvents()}onIframeMouseDown(e){this.isBlur=!1,this.notify(iframeMouseDown,e)}editorKeyDown(e){switch(e.event.action){case"copy":this.onCopy();break;case"cut":this.onCut()}!e.callBack||"copy"!==e.event.action&&"cut"!==e.event.action&&"delete"!==e.event.action||e.callBack({requestType:e.event.action,editorMode:"HTML",event:e.event})}unWireEvents(){this.element.removeEventListener("focusin",this.onFocusHandler,!0),this.element.removeEventListener("focusout",this.onBlurHandler,!0),this.readonly&&this.enabled||this.unbindEvents()}unbindEvents(){this.keyboardModule&&this.keyboardModule.destroy();let formElement=closest(this.valueContainer,"form");formElement&&EventHandler.remove(formElement,"reset",this.resetHandler),EventHandler.remove(this.inputElement,"keyup",this.keyUp),EventHandler.remove(this.inputElement,"paste",this.onPaste),EventHandler.remove(this.inputElement,Browser.touchEndEvent,debounce(this.mouseUp,30)),EventHandler.remove(this.inputElement,Browser.touchStartEvent,this.mouseDownHandler),this.unWireContextEvent(),this.formatter&&this.formatter.editorManager.observer.off(KEY_DOWN_HANDLER,this.editorKeyDown),this.element.ownerDocument.defaultView.removeEventListener("resize",this.onResizeHandler,!0),this.iframeSettings.enable&&(EventHandler.remove(this.inputElement,"focusin",this.focusHandler),EventHandler.remove(this.inputElement,"focusout",this.blurHandler),EventHandler.remove(this.inputElement.ownerDocument,"scroll",this.scrollHandler),EventHandler.remove(this.inputElement.ownerDocument,Browser.touchStartEvent,this.onIframeMouseDown)),this.unWireScrollElementsEvents()}};return __decorate([Complex({},ej2_richtexteditor_es2015_ToolbarSettings)],RichTextEditor.prototype,"toolbarSettings",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_QuickToolbarSettings)],RichTextEditor.prototype,"quickToolbarSettings",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_PasteCleanupSettings)],RichTextEditor.prototype,"pasteCleanupSettings",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_IFrameSettings)],RichTextEditor.prototype,"iframeSettings",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_ImageSettings)],RichTextEditor.prototype,"insertImageSettings",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_TableSettings)],RichTextEditor.prototype,"tableSettings",void 0),__decorate([Property(0)],RichTextEditor.prototype,"floatingToolbarOffset",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_InlineMode)],RichTextEditor.prototype,"inlineMode",void 0),__decorate([Property("100%")],RichTextEditor.prototype,"width",void 0),__decorate([Property(!1)],RichTextEditor.prototype,"enablePersistence",void 0),__decorate([Property({})],RichTextEditor.prototype,"htmlAttributes",void 0),__decorate([Property(null)],RichTextEditor.prototype,"placeholder",void 0),__decorate([Property(!1)],RichTextEditor.prototype,"readonly",void 0),__decorate([Property(!0)],RichTextEditor.prototype,"enabled",void 0),__decorate([Property(!1)],RichTextEditor.prototype,"enableHtmlEncode",void 0),__decorate([Property("auto")],RichTextEditor.prototype,"height",void 0),__decorate([Property(null)],RichTextEditor.prototype,"cssClass",void 0),__decorate([Property(null)],RichTextEditor.prototype,"value",void 0),__decorate([Property(30)],RichTextEditor.prototype,"undoRedoSteps",void 0),__decorate([Property(300)],RichTextEditor.prototype,"undoRedoTimer",void 0),__decorate([Property("HTML")],RichTextEditor.prototype,"editorMode",void 0),__decorate([Property(null)],RichTextEditor.prototype,"keyConfig",void 0),__decorate([Property(!1)],RichTextEditor.prototype,"showCharCount",void 0),__decorate([Property(!1)],RichTextEditor.prototype,"enableTabKey",void 0),__decorate([Property(!1)],RichTextEditor.prototype,"enableAutoUrl",void 0),__decorate([Property(-1)],RichTextEditor.prototype,"maxLength",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_Format)],RichTextEditor.prototype,"format",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_FontFamily)],RichTextEditor.prototype,"fontFamily",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_FontSize)],RichTextEditor.prototype,"fontSize",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_FontColor)],RichTextEditor.prototype,"fontColor",void 0),__decorate([Complex({},ej2_richtexteditor_es2015_BackgroundColor)],RichTextEditor.prototype,"backgroundColor",void 0),__decorate([Property(null)],RichTextEditor.prototype,"valueTemplate",void 0),__decorate([Property(1e4)],RichTextEditor.prototype,"saveInterval",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"actionBegin",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"actionComplete",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"beforeDialogOpen",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"dialogOpen",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"dialogClose",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"beforeQuickToolbarOpen",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"quickToolbarOpen",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"quickToolbarClose",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"toolbarStatusUpdate",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"imageSelected",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"imageUploading",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"imageUploadSuccess",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"imageUploadFailed",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"imageRemoving",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"created",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"destroyed",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"beforeSanitizeHtml",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"blur",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"toolbarClick",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"focus",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"change",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"resizing",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"resizeStart",void 0),__decorate([ej2_base_es2015_Event()],RichTextEditor.prototype,"resizeStop",void 0),__decorate([Property(null)],RichTextEditor.prototype,"formatter",void 0),__decorate([NotifyPropertyChanges],RichTextEditor)})();function parentsUntil$1(elem,selector,isID){let parent=elem;for(;parent&&(isID?parent.id!==selector:!parent.classList.contains(selector));)parent=parent.parentElement;return parent}function isScheduledTask(ganttProp){return isNullOrUndefined(ganttProp.startDate)&&isNullOrUndefined(ganttProp.endDate)&&isNullOrUndefined(ganttProp.duration)?null:!(isNullOrUndefined(ganttProp.startDate)||isNullOrUndefined(ganttProp.endDate)||isNullOrUndefined(ganttProp.duration))}function ej2_gantt_es2015_isRemoteData(dataSource){if(dataSource instanceof ej2_data_es2015_DataManager){let adaptor=dataSource.adaptor;return adaptor instanceof ej2_data_es2015_ODataAdaptor||adaptor instanceof WebApiAdaptor||adaptor instanceof WebMethodAdaptor||adaptor instanceof ej2_data_es2015_CacheAdaptor||adaptor instanceof ej2_data_es2015_UrlAdaptor}return!1}function getTaskData(records){let result=[];for(let i=0;i<records.length;i++){let data=extend({},records[i].taskData,{},!0);result.push(data)}return result}function ej2_gantt_es2015_getIndex(value,key1,collection,key2){let index=-1;for(let i=0;i<collection.length;i++)if(getValue(key1,collection[i])===getValue(key1,value)&&isNullOrUndefined(key2)||!isNullOrUndefined(key2)&&getValue(key1,collection[i])===getValue(key1,value)&&getValue(key2,collection[i])===getValue(key2,value)){index=i;break}return index}class ej2_gantt_es2015_DateProcessor{constructor(parent){this.parent=parent}isValidateNonWorkDays(ganttProp){return!isNullOrUndefined(ganttProp)&&ganttProp.isAutoSchedule&&(!this.parent.includeWeekend||this.parent.totalHolidayDates.length>0)||isNullOrUndefined(ganttProp)&&(!this.parent.includeWeekend||this.parent.totalHolidayDates.length>0)}checkStartDate(date,ganttProp,validateAsMilestone){if(isNullOrUndefined(date))return null;let tStartDate,cloneStartDate=new Date(date.getTime()),hour=this.getSecondsInDecimal(cloneStartDate);if(validateAsMilestone=isNullOrUndefined(validateAsMilestone)?!isNullOrUndefined(ganttProp)&&ganttProp.isMilestone:validateAsMilestone,hour<this.parent.defaultStartTime)this.setTime(this.parent.defaultStartTime,cloneStartDate);else if(hour!==this.parent.defaultEndTime||ganttProp&&validateAsMilestone){if(hour>this.parent.defaultEndTime)cloneStartDate.setDate(cloneStartDate.getDate()+1),this.setTime(this.parent.defaultStartTime,cloneStartDate);else if(hour>this.parent.defaultStartTime&&hour<this.parent.defaultEndTime)for(let index=0;index<this.parent.workingTimeRanges.length;index++){let value=this.parent.workingTimeRanges[index];if(hour>=value.to&&this.parent.workingTimeRanges[index+1]&&hour<this.parent.workingTimeRanges[index+1].from){hour!==value.to||ganttProp&&validateAsMilestone?hour!==value.to&&this.setTime(this.parent.workingTimeRanges[index+1].from,cloneStartDate):this.setTime(this.parent.workingTimeRanges[index+1].from,cloneStartDate);break}}}else cloneStartDate.setDate(cloneStartDate.getDate()+1),this.setTime(this.parent.defaultStartTime,cloneStartDate);do{tStartDate=new Date(cloneStartDate.getTime());let holidayLength=this.parent.totalHolidayDates.length;if(this.isValidateNonWorkDays(ganttProp)){if(!this.parent.includeWeekend){let tempDate=new Date(cloneStartDate.getTime());cloneStartDate=this.getNextWorkingDay(cloneStartDate),tempDate.getTime()!==cloneStartDate.getTime()&&this.setTime(this.parent.defaultStartTime,cloneStartDate)}for(let count=0;count<holidayLength;count++){let holidayFrom=this.getDateFromFormat(new Date(this.parent.totalHolidayDates[count])),holidayTo=new Date(holidayFrom.getTime());holidayFrom.setHours(0,0,0,0),holidayTo.setHours(23,59,59,59),cloneStartDate.getTime()>=holidayFrom.getTime()&&cloneStartDate.getTime()<holidayTo.getTime()&&(cloneStartDate.setDate(cloneStartDate.getDate()+1),this.setTime(this.parent.defaultStartTime,cloneStartDate))}}}while(tStartDate.getTime()!==cloneStartDate.getTime());return new Date(cloneStartDate.getTime())}checkEndDate(date,ganttProp){if(isNullOrUndefined(date))return null;let tempCheckDate,cloneEndDate=new Date(date.getTime()),hour=this.getSecondsInDecimal(cloneEndDate);if(hour>this.parent.defaultEndTime)this.setTime(this.parent.defaultEndTime,cloneEndDate);else if(hour<=this.parent.defaultStartTime)cloneEndDate.setDate(cloneEndDate.getDate()-1),this.setTime(this.parent.defaultEndTime,cloneEndDate);else if(hour>this.parent.defaultStartTime&&hour<this.parent.defaultEndTime)for(let index=0;index<this.parent.workingTimeRanges.length;index++)if(hour>this.parent.workingTimeRanges[index].to&&this.parent.workingTimeRanges[index+1]&&hour<=this.parent.workingTimeRanges[index+1].from){this.setTime(this.parent.workingTimeRanges[index].to,cloneEndDate);break}do{tempCheckDate=new Date(cloneEndDate.getTime());let holidayLength=this.parent.totalHolidayDates.length;if(this.isValidateNonWorkDays(ganttProp)){if(!this.parent.includeWeekend){let tempDate=new Date(cloneEndDate.getTime());cloneEndDate=this.getPreviousWorkingDay(cloneEndDate),tempDate.getTime()!==cloneEndDate.getTime()&&this.setTime(this.parent.defaultEndTime,cloneEndDate)}for(let count=0;count<holidayLength;count++){let holidayFrom=this.getDateFromFormat(new Date(this.parent.totalHolidayDates[count])),holidayTo=new Date(holidayFrom.getTime()),tempHoliday=new Date(cloneEndDate.getTime());tempHoliday.setMinutes(cloneEndDate.getMilliseconds()-2),holidayFrom.setHours(0,0,0,0),holidayTo.setHours(23,59,59,59),(cloneEndDate.getTime()>=holidayFrom.getTime()&&cloneEndDate.getTime()<holidayTo.getTime()||tempHoliday.getTime()>=holidayFrom.getTime()&&tempHoliday.getTime()<holidayTo.getTime())&&(cloneEndDate.setDate(cloneEndDate.getDate()-1),cloneEndDate.getTime()===holidayFrom.getTime()&&86400===this.parent.defaultEndTime&&0===this.getSecondsInDecimal(cloneEndDate)||this.setTime(this.parent.defaultEndTime,cloneEndDate))}}}while(tempCheckDate.getTime()!==cloneEndDate.getTime());return new Date(cloneEndDate.getTime())}checkBaselineStartDate(date){if(isNullOrUndefined(date))return null;{let cloneDate=new Date(date.getTime()),hour=this.getSecondsInDecimal(cloneDate);if(hour<this.parent.defaultStartTime)this.setTime(this.parent.defaultStartTime,cloneDate);else if(hour>=this.parent.defaultEndTime)cloneDate.setDate(cloneDate.getDate()+1),this.setTime(this.parent.defaultStartTime,cloneDate);else if(hour>this.parent.defaultStartTime&&hour<this.parent.defaultEndTime)for(let i=0;i<this.parent.workingTimeRanges.length;i++)if(hour>=this.parent.workingTimeRanges[i].to&&this.parent.workingTimeRanges[i+1]&&hour<this.parent.workingTimeRanges[i+1].from){this.setTime(this.parent.workingTimeRanges[i+1].from,cloneDate);break}return cloneDate}}checkBaselineEndDate(date){if(isNullOrUndefined(date))return null;{let cloneDate=new Date(date.getTime()),hour=this.getSecondsInDecimal(cloneDate);if(hour>this.parent.defaultEndTime)this.setTime(this.parent.defaultEndTime,cloneDate);else if(hour<=this.parent.defaultStartTime)cloneDate.setDate(cloneDate.getDate()-1),this.setTime(this.parent.defaultEndTime,cloneDate);else if(hour>this.parent.defaultStartTime&&hour<this.parent.defaultEndTime)for(let i=0;i<this.parent.workingTimeRanges.length;i++)if(hour>this.parent.workingTimeRanges[i].to&&this.parent.workingTimeRanges[i+1]&&hour<=this.parent.workingTimeRanges[i+1].from){this.setTime(this.parent.workingTimeRanges[i].to,cloneDate);break}return cloneDate}}calculateStartDate(ganttData){let ganttProp=ganttData.ganttProperties,tempStartDate=null;isNullOrUndefined(ganttProp.endDate)||isNullOrUndefined(ganttProp.duration)||(tempStartDate=this.getStartDate(ganttProp.endDate,ganttProp.duration,ganttProp.durationUnit,ganttProp)),this.parent.setRecordValue("startDate",tempStartDate,ganttProp,!0),this.parent.taskFields.startDate&&this.parent.dataOperation.updateMappingData(ganttData,"startDate")}calculateEndDate(ganttData){let ganttProp=ganttData.ganttProperties,tempEndDate=null;isNullOrUndefined(ganttProp.startDate)||(!isNullOrUndefined(ganttProp.endDate)&&isNullOrUndefined(ganttProp.duration)&&(1===this.compareDates(ganttProp.startDate,ganttProp.endDate)&&(this.parent.setRecordValue("startDate",new Date(ganttProp.endDate.getTime()),ganttProp,!0),this.setTime(this.parent.defaultStartTime,ganttProp.startDate)),this.calculateDuration(ganttData)),isNullOrUndefined(ganttProp.duration)||(tempEndDate=this.getEndDate(ganttProp.startDate,ganttProp.duration,ganttProp.durationUnit,ganttProp,!1)),this.parent.setRecordValue("endDate",tempEndDate,ganttProp,!0)),this.parent.taskFields.endDate&&this.parent.dataOperation.updateMappingData(ganttData,"endDate")}calculateDuration(ganttData){let ganttProperties=ganttData.ganttProperties,tDuration=this.getDuration(ganttProperties.startDate,ganttProperties.endDate,ganttProperties.durationUnit,ganttProperties.isAutoSchedule);this.parent.setRecordValue("duration",tDuration,ganttProperties,!0),this.parent.taskFields.duration&&(this.parent.dataOperation.updateMappingData(ganttData,"duration"),this.parent.taskFields.durationUnit&&this.parent.dataOperation.updateMappingData(ganttData,"durationUnit"))}getNonworkingTime(sDate,eDate,isAutoSchedule,isCheckTimeZone){isCheckTimeZone=!!isNullOrUndefined(isCheckTimeZone)||isCheckTimeZone,this.getTimeDifference(sDate,eDate,isCheckTimeZone);let weekendCount=!this.parent.includeWeekend&&isAutoSchedule?this.getWeekendCount(sDate,eDate):0,totalHours=this.getNumberOfSeconds(sDate,eDate,isCheckTimeZone),holidaysCount=isAutoSchedule?this.getHolidaysCount(sDate,eDate):0,totWorkDays=(totalHours-86400*weekendCount-86400*holidaysCount)/86400,nonWorkHours=this.getNonWorkingSecondsOnDate(sDate,eDate);return totWorkDays*(86400-this.parent.secondsPerDay)+86400*weekendCount+86400*holidaysCount+nonWorkHours}getDuration(startDate,endDate,durationUnit,isAutoSchedule,isCheckTimeZone){if(isNullOrUndefined(startDate)||isNullOrUndefined(endDate))return null;isCheckTimeZone=!!isNullOrUndefined(isCheckTimeZone)||isCheckTimeZone;let durationValue=0,durationHours=this.getTimeDifference(startDate,endDate,isCheckTimeZone)/1e3-this.getNonworkingTime(startDate,endDate,isAutoSchedule,isCheckTimeZone);return parseFloat((durationUnit&&"day"!==durationUnit?"minute"===durationUnit?durationHours/60:durationHours/3600:durationHours/this.parent.secondsPerDay).toString())}getDurationAsSeconds(duration,durationUnit){return durationUnit&&"day"!==durationUnit?"hour"===durationUnit?3600*duration:60*duration:this.parent.secondsPerDay*duration}getEndDate(startDate,duration,durationUnit,ganttProp,validateAsMilestone){let tempStart=new Date(startDate.getTime()),endDate=new Date(startDate.getTime()),secondDuration=this.getDurationAsSeconds(duration,durationUnit),nonWork=0,workHours=0;for(;secondDuration>0;)endDate.setSeconds(endDate.getSeconds()+secondDuration),(secondDuration-=workHours=secondDuration-(nonWork=this.getNonworkingTime(tempStart,endDate,ganttProp.isAutoSchedule,!0)))>0&&(endDate=this.checkStartDate(endDate,ganttProp,validateAsMilestone)),tempStart=new Date(endDate.getTime());return endDate}getStartDate(endDate,duration,durationUnit,ganttProp){let tempEnd=new Date(endDate.getTime()),startDate=new Date(endDate.getTime()),secondDuration=this.getDurationAsSeconds(duration,durationUnit),nonWork=0,workHours=0;for(;secondDuration>0;)startDate.setSeconds(startDate.getSeconds()-secondDuration),(secondDuration-=workHours=secondDuration-(nonWork=this.getNonworkingTime(startDate,tempEnd,ganttProp.isAutoSchedule,!0)))>0&&(tempEnd=this.checkEndDate(startDate,ganttProp)),tempEnd=new Date(startDate.getTime());return startDate}getProjectStartDate(ganttProp,isLoad){if(!isNullOrUndefined(this.parent.cloneProjectStartDate)){let cloneStartDate=this.checkStartDate(this.parent.cloneProjectStartDate);return this.parent.cloneProjectStartDate=cloneStartDate,new Date(cloneStartDate.getTime())}if(isNullOrUndefined(this.parent.projectStartDate)){if(isNullOrUndefined(isLoad))return null;{let flatData=this.parent.flatData,minStartDate=flatData[0].ganttProperties.startDate;for(let index=1;index<flatData.length;index++){let startDate=flatData[index].ganttProperties.startDate;isNullOrUndefined(startDate)||-1!==this.compareDates(startDate,minStartDate)||(minStartDate=startDate)}this.parent.cloneProjectStartDate=this.checkStartDate(minStartDate,ganttProp)}}else{let cloneStartDate=this.getDateFromFormat(this.parent.projectStartDate);this.parent.cloneProjectStartDate=this.checkStartDate(cloneStartDate)}return new Date(this.parent.cloneProjectStartDate.getTime())}getValidStartDate(ganttProp){let sDate=null;return isNullOrUndefined(ganttProp.startDate)?isNullOrUndefined(ganttProp.endDate)?isNullOrUndefined(ganttProp.duration)||(sDate=this.getProjectStartDate(ganttProp)):(sDate=new Date(ganttProp.endDate.getTime()),this.setTime(this.parent.defaultStartTime,sDate)):sDate=new Date(ganttProp.startDate.getTime()),sDate}getValidEndDate(ganttProp){let eDate=null;if(isNullOrUndefined(ganttProp.endDate))if(isNullOrUndefined(ganttProp.startDate)){if(!isNullOrUndefined(ganttProp.duration)){let sDate=this.getValidStartDate(ganttProp);sDate&&(eDate=this.getEndDate(sDate,ganttProp.duration,ganttProp.durationUnit,ganttProp,!1))}}else ganttProp.isMilestone?eDate=this.checkStartDate(ganttProp.startDate):(eDate=new Date(ganttProp.startDate.getTime()),this.setTime(this.parent.defaultEndTime,eDate));else eDate=new Date(ganttProp.endDate.getTime());return eDate}getSecondsPerDay(){let dayWorkingTime=this.parent.dayWorkingTime,length=dayWorkingTime.length,totalSeconds=0,startDate=new Date("10/11/2018"),endDate=new Date("10/12/2018");this.parent.nonWorkingHours=[];let nonWorkingHours=this.parent.nonWorkingHours;this.parent.workingTimeRanges=[];let workingTimeRanges=this.parent.workingTimeRanges;this.parent.nonWorkingTimeRanges=[];let nonWorkingTimeRanges=this.parent.nonWorkingTimeRanges;for(let count=0;count<length;count++){let currentRange=dayWorkingTime[count];if(!isNullOrUndefined(currentRange.from)&&!isNullOrUndefined(currentRange.to)){startDate.setHours(currentRange.from);let startHour=new Date(startDate.getTime()),tempDate=0!==currentRange.to?startDate:endDate;tempDate.setHours(currentRange.to);let endHour=new Date(tempDate.getTime()),timeDiff=endHour.getTime()-startHour.getTime(),sdSeconds=this.getSecondsInDecimal(startHour),edSeconds=this.getSecondsInDecimal(endHour);0===edSeconds&&(edSeconds=86400),totalSeconds+=timeDiff/1e3,0===count&&(this.parent.defaultStartTime=sdSeconds),count===length-1&&(this.parent.defaultEndTime=edSeconds),count>0?(nonWorkingHours.push(nonWorkingHours[nonWorkingHours.length-1]+sdSeconds-workingTimeRanges[count-1].to),workingTimeRanges[count-1].to<sdSeconds&&nonWorkingTimeRanges.push({from:workingTimeRanges[count-1].to,to:sdSeconds,isWorking:!1,interval:sdSeconds-workingTimeRanges[count-1].to})):(nonWorkingHours.push(0),nonWorkingTimeRanges.push({from:0,to:sdSeconds,isWorking:!1,interval:sdSeconds})),workingTimeRanges.push({from:sdSeconds,to:edSeconds}),nonWorkingTimeRanges.push({from:sdSeconds,to:edSeconds,isWorking:!0,interval:edSeconds-sdSeconds})}}return this.parent.defaultEndTime/3600!=24&&nonWorkingTimeRanges.push({from:this.parent.defaultEndTime,to:86400,isWorking:!1,interval:86400-this.parent.defaultEndTime}),totalSeconds}getDurationValue(value,isFromDialog){let durationUnit=null,duration=null;if("string"==typeof value){let values=value.match(/(\d*\.*\d+|.+$)/g);if(values&&values.length<=2){duration=parseFloat(values[0].toString().trim());let unit=values[1]?values[1].toString().trim().toLowerCase():null;-1!==getValue("minute",this.parent.durationUnitEditText).indexOf(unit)?durationUnit="minute":-1!==getValue("hour",this.parent.durationUnitEditText).indexOf(unit)?durationUnit="hour":-1!==getValue("day",this.parent.durationUnitEditText).indexOf(unit)&&(durationUnit="day")}}else duration=value,durationUnit=null;return{duration:duration,durationUnit:durationUnit}}getNextWorkingDay(date){let dayIndex=date.getDay();return-1!==this.parent.nonWorkingDayIndex.indexOf(dayIndex)?(date.setDate(date.getDate()+1),date=this.getNextWorkingDay(date)):date}getWeekendCount(startDate,endDate){let weekendCount=0,sDate=new Date(startDate.getTime()),eDate=new Date(endDate.getTime());for(sDate.setHours(0,0,0,0),sDate.setDate(sDate.getDate()+1),eDate.setHours(0,0,0,0);sDate.getTime()<eDate.getTime();)-1!==this.parent.nonWorkingDayIndex.indexOf(sDate.getDay())&&(weekendCount+=1),sDate.setDate(sDate.getDate()+1);return weekendCount}getNumberOfSeconds(startDate,endDate,isCheckTimeZone){let sDate=new Date(startDate.getTime()),eDate=new Date(endDate.getTime()),timeDiff=0;return sDate.setDate(sDate.getDate()+1),sDate.setHours(0,0,0,0),eDate.setHours(0,0,0,0),sDate.getTime()<eDate.getTime()&&(timeDiff=this.getTimeDifference(sDate,eDate,isCheckTimeZone)/1e3),timeDiff%86400!=0&&(timeDiff=timeDiff-timeDiff%86400+86400),timeDiff}getHolidaysCount(startDate,endDate){let holidaysCount=0,holidays=this.parent.totalHolidayDates,sDate=new Date(startDate.getTime()),eDate=new Date(endDate.getTime());if(sDate.setDate(sDate.getDate()+1),sDate.setHours(0,0,0,0),eDate.setHours(0,0,0,0),sDate.getTime()<eDate.getTime())for(let i=0;i<holidays.length;i++){let currentHoliday=this.getDateFromFormat(new Date(holidays[i]));sDate.getTime()<=currentHoliday.getTime()&&eDate.getTime()>=currentHoliday.getTime()&&(this.parent.includeWeekend||-1!==this.parent.nonWorkingDayIndex.indexOf(currentHoliday.getDay())?this.parent.includeWeekend&&(holidaysCount+=1):holidaysCount+=1)}return holidaysCount}getHolidayDates(){let holidays=this.parent.holidays,holidayDates=[];for(let i=0;i<holidays.length;i++){let from=this.getDateFromFormat(holidays[i].from),to=this.getDateFromFormat(holidays[i].to);if(!isNullOrUndefined(from)||!isNullOrUndefined(to))if(isNullOrUndefined(from)||isNullOrUndefined(to)){let tempDate=from||to;tempDate.setHours(0,0,0,0),-1===holidayDates.indexOf(tempDate.getTime())&&holidayDates.push(tempDate.getTime())}else for(;from<=to;)from.setHours(0,0,0,0),-1===holidayDates.indexOf(from.getTime())&&holidayDates.push(from.getTime()),from.setDate(from.getDate()+1)}return holidayDates}isOnHolidayOrWeekEnd(date,checkWeekEnd){if(!(checkWeekEnd=isNullOrUndefined(checkWeekEnd)?this.parent.includeWeekend:checkWeekEnd)&&-1!==this.parent.nonWorkingDayIndex.indexOf(date.getDay()))return!0;let holidays=this.parent.totalHolidayDates;for(let count=0;count<holidays.length;count++){let holidayFrom=this.getDateFromFormat(new Date(holidays[count])),holidayTo=new Date(holidayFrom.getTime());if(holidayFrom.setHours(0,0,0,0),holidayTo.setHours(23,59,59,59),date.getTime()>=holidayFrom.getTime()&&date.getTime()<holidayTo.getTime())return!0}return!1}getNonWorkingSecondsOnDate(startDate,endDate){let sHour=this.getSecondsInDecimal(startDate),eHour=this.getSecondsInDecimal(endDate),startRangeIndex=-1,endRangeIndex=-1,totNonWrkSecs=0,startOnHoliday=this.isOnHolidayOrWeekEnd(startDate,null),endOnHoliday=this.isOnHolidayOrWeekEnd(endDate,null);for(let i=0;i<this.parent.nonWorkingTimeRanges.length;i++){let val=this.parent.nonWorkingTimeRanges[i];sHour>=val.from&&sHour<=val.to&&(startRangeIndex=i),eHour>=val.from&&eHour<=val.to&&(endRangeIndex=i)}if(startDate.getDate()!==endDate.getDate()||startDate.getMonth()!==endDate.getMonth()||startDate.getFullYear()!==endDate.getFullYear()){if(startOnHoliday)totNonWrkSecs+=86400-sHour;else for(let i=startRangeIndex;i<this.parent.nonWorkingTimeRanges.length;i++)this.parent.nonWorkingTimeRanges[i].isWorking||(totNonWrkSecs+=i===startRangeIndex?this.parent.nonWorkingTimeRanges[i].to-sHour:this.parent.nonWorkingTimeRanges[i].interval);if(endOnHoliday)totNonWrkSecs+=eHour;else for(let i=0;i<=endRangeIndex;i++)this.parent.nonWorkingTimeRanges[i].isWorking||(totNonWrkSecs+=i===endRangeIndex?eHour-this.parent.nonWorkingTimeRanges[i].from:this.parent.nonWorkingTimeRanges[i].interval)}else if(startRangeIndex!==endRangeIndex)if(endOnHoliday)totNonWrkSecs+=eHour-sHour;else for(let i=startRangeIndex;i<=endRangeIndex;i++)this.parent.nonWorkingTimeRanges[i].isWorking||(totNonWrkSecs+=i===startRangeIndex?this.parent.nonWorkingTimeRanges[i].to-sHour:i===endRangeIndex?eHour-this.parent.nonWorkingTimeRanges[i].from:this.parent.nonWorkingTimeRanges[i].interval);else endOnHoliday?totNonWrkSecs+=eHour-sHour:this.parent.nonWorkingTimeRanges[startRangeIndex].isWorking||(totNonWrkSecs=eHour-sHour);return totNonWrkSecs}getPreviousWorkingDay(date){let dayIndex=date.getDay(),previousIndex=0===dayIndex?6:dayIndex-1;return-1!==this.parent.nonWorkingDayIndex.indexOf(dayIndex)||-1!==this.parent.nonWorkingDayIndex.indexOf(previousIndex)&&86400===this.parent.defaultEndTime&&0===this.getSecondsInDecimal(date)?(date.setDate(date.getDate()-1),-1!==this.parent.nonWorkingDayIndex.indexOf(date.getDay())&&(date=this.getPreviousWorkingDay(date)),date):date}getNonWorkingDayIndex(){let weekDay=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],weekDayLength=weekDay.length;0===this.parent.workWeek.length&&(this.parent.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"]);let workWeek=this.parent.workWeek.slice(),length=workWeek.length;for(let i=0;i<length;i++)workWeek[i]=workWeek[i].toLowerCase();this.parent.nonWorkingDayIndex=[];for(let i=0;i<weekDayLength;i++)-1===workWeek.indexOf(weekDay[i])&&this.parent.nonWorkingDayIndex.push(i)}setTime(seconds,date){let hour=seconds/3600,min=(seconds-3600*hour)/60;date.setHours(hour,min,seconds-3600*hour-60*min)}getTimeDifference(startDate,endDate,isCheckTimeZone){let sDate=new Date(startDate.getTime()),eDate=new Date(endDate.getTime());return isCheckTimeZone&&this.updateDateWithTimeZone(sDate,eDate),eDate.getTime()-sDate.getTime()}updateDateWithTimeZone(sDate,eDate){let uTZ,uDate,sTZ=sDate.getTimezoneOffset(),eTZ=eDate.getTimezoneOffset();if(sTZ!==eTZ){let standardTZ=new Date((new Date).getFullYear(),0,1).getTimezoneOffset();if(standardTZ!==sTZ?(uDate=sDate,uTZ=sTZ):standardTZ!==eTZ&&(uDate=eDate,uTZ=eTZ),standardTZ<0){let tzDiff=standardTZ-uTZ;uDate.setTime(uDate.getTime()+60*tzDiff*1e3)}else if(standardTZ>0){let tzDiff=uTZ-standardTZ;uDate.setTime(uDate.getTime()-60*tzDiff*1e3)}}}getSecondsInDecimal(date){return 60*date.getHours()*60+60*date.getMinutes()+date.getSeconds()+date.getMilliseconds()/1e3}getDateFromFormat(date){if(isNullOrUndefined(date))return null;if(date instanceof Date)return new Date(date.getTime());{let dateObject=this.parent.globalize.parseDate(date,{format:this.parent.dateFormat,type:"dateTime"});return isNullOrUndefined(dateObject)?new Date(date):dateObject}}compareDates(date1,date2){return isNullOrUndefined(date1)||isNullOrUndefined(date2)?!isNullOrUndefined(date1)&&isNullOrUndefined(date2)?1:isNullOrUndefined(date1)&&!isNullOrUndefined(date2)?-1:null:date1.getTime()>date2.getTime()?1:date1.getTime()<date2.getTime()?-1:0}getDurationString(duration,durationUnit){let value="";if(!isNullOrUndefined(duration)&&(value+=parseFloat(duration.toFixed(2))+" ",!isNullOrUndefined(durationUnit))){let plural=1!==duration;"day"===durationUnit?value+=this.parent.localeObj.getConstant(plural?"days":"day"):"hour"===durationUnit?value+=this.parent.localeObj.getConstant(plural?"hours":"hour"):"minute"===durationUnit&&(value+=this.parent.localeObj.getConstant(plural?"minutes":"minute"))}return value}calculateProjectDates(editArgs){let projectStartDate=this.getDateFromFormat(this.parent.timelineModule.isZooming&&this.parent.cloneProjectStartDate?this.parent.cloneProjectStartDate:this.parent.projectStartDate),projectEndDate=this.getDateFromFormat(this.parent.timelineModule.isZooming&&this.parent.cloneProjectEndDate?this.parent.cloneProjectEndDate:this.parent.projectEndDate),minStartDate=null,maxEndDate=null,flatData=this.parent.flatData;(!projectStartDate||!projectEndDate)&&flatData.length>0||editArgs||this.parent.timelineModule.isZoomToFit?(flatData.forEach((data,index)=>{let task=data.ganttProperties,tempStartDate=this.getValidStartDate(task),tempEndDate=this.getValidEndDate(task),baselineStartDate=this.parent.timelineModule.isZoomToFit?null:task.baselineStartDate?new Date(task.baselineStartDate.getTime()):null,baselineEndDate=this.parent.timelineModule.isZoomToFit?null:task.baselineEndDate?new Date(task.baselineEndDate.getTime()):null;minStartDate?(tempStartDate&&1===this.compareDates(minStartDate,tempStartDate)&&(minStartDate=tempStartDate),baselineStartDate&&this.parent.renderBaseline&&1===this.compareDates(minStartDate,baselineStartDate)?minStartDate=baselineStartDate:baselineEndDate&&this.parent.renderBaseline&&1===this.compareDates(minStartDate,baselineEndDate)&&(minStartDate=baselineEndDate)):minStartDate=baselineStartDate&&this.parent.renderBaseline&&1===this.compareDates(tempStartDate,baselineStartDate)?baselineStartDate:baselineEndDate&&this.parent.renderBaseline&&1===this.compareDates(tempStartDate,baselineEndDate)?baselineEndDate:tempStartDate,maxEndDate?(tempEndDate&&-1===this.compareDates(maxEndDate,tempEndDate)&&(maxEndDate=tempEndDate),baselineEndDate&&this.parent.renderBaseline&&-1===this.compareDates(maxEndDate,baselineEndDate)?maxEndDate=baselineEndDate:baselineEndDate&&this.parent.renderBaseline&&-1===this.compareDates(maxEndDate,baselineStartDate)&&(maxEndDate=baselineStartDate)):maxEndDate=baselineEndDate&&this.parent.renderBaseline&&-1===this.compareDates(tempEndDate,baselineEndDate)?baselineStartDate:baselineEndDate&&this.parent.renderBaseline&&-1===this.compareDates(tempEndDate,baselineStartDate)?baselineEndDate:tempEndDate}),minStartDate&&maxEndDate||(minStartDate=this.getDateFromFormat(new Date),(maxEndDate=this.getDateFromFormat(new Date(minStartDate.getTime()))).setDate(maxEndDate.getDate()+20)),this.updateProjectDatesByEventMarker(minStartDate,maxEndDate),this.updateProjectDatesByHolidays(minStartDate,maxEndDate)):projectStartDate&&projectEndDate||0!==flatData.length||(minStartDate=this.getDateFromFormat(new Date),maxEndDate=this.getDateFromFormat(new Date(minStartDate.getTime()))),editArgs?(setValue("minStartDate",minStartDate,editArgs),setValue("maxEndDate",maxEndDate,editArgs)):(this.parent.cloneProjectStartDate=minStartDate||new Date(projectStartDate.getTime()),this.parent.cloneProjectEndDate=maxEndDate||new Date(projectEndDate.getTime()))}updateProjectDatesByEventMarker(startDate,endDate){let eventMarker=this.parent.eventMarkers;if(eventMarker&&eventMarker.length>0)for(let index=0;index<eventMarker.length;index++){let day=this.getDateFromFormat(eventMarker[index].day);day.getTime()>startDate.getTime()&&day.getTime()<endDate.getTime()||(day.getTime()<startDate.getTime()?startDate=new Date(day.getTime()):endDate=new Date(day.getTime()))}}updateProjectDatesByHolidays(startDate,endDate){let holidayList=this.parent.totalHolidayDates;if(holidayList&&holidayList.length>0)for(let i=0;i<holidayList.length;i++){let holiday=this.getDateFromFormat(new Date(holidayList[i]));holiday.getTime()>startDate.getTime()&&holiday.getTime()<endDate.getTime()||(holiday.getTime()<startDate.getTime()?startDate=new Date(holiday.getTime()):endDate=new Date(holiday.getTime()))}}}class ej2_gantt_es2015_TaskProcessor extends ej2_gantt_es2015_DateProcessor{constructor(parent){super(parent),this.recordIndex=0,this.taskIds=[],this.hierarchyData=[],this.addEventListener()}addEventListener(){this.parent.on("beforeDataManipulate",this.checkDataBinding.bind(this))}checkDataBinding(isChange){isChange&&(this.parent.flatData=[],this.parent.currentViewData=[],this.dataArray=[],this.taskIds=[],this.parent.ids=[],this.recordIndex=0,this.taskIds=[],this.hierarchyData=[],this.parent.predecessorsCollection=[],this.parent.treeGrid.parentData=[]),isNullOrUndefined(this.parent.dataSource)?(this.parent.dataSource=[],this.parent.renderGantt(isChange)):this.parent.dataSource instanceof ej2_data_es2015_DataManager?this.initDataSource(isChange):this.parent.dataSource.length>0?(this.dataArray=this.parent.dataSource,this.cloneDataSource(),this.parent.renderGantt(isChange)):this.parent.renderGantt(isChange)}initDataSource(isChange){let queryManager=this.parent.query instanceof ej2_data_es2015_Query?this.parent.query:new ej2_data_es2015_Query;queryManager.requiresCount(),this.parent.dataSource.executeQuery(queryManager).then(e=>{this.dataArray=e.result,this.cloneDataSource(),this.parent.renderGantt(isChange)}).catch(e=>{this.parent.renderGantt(isChange),this.parent.trigger("actionFailure",{error:e})})}constructDataSource(dataSource){let mappingData=new ej2_data_es2015_DataManager(dataSource).executeLocal((new ej2_data_es2015_Query).group(this.parent.taskFields.parentID)),rootData=[];for(let i=0;i<mappingData.length;i++){let groupData=mappingData[i];if(!isNullOrUndefined(groupData.key)){let index=this.taskIds.indexOf(groupData.key.toString());if(index>-1&&!isNullOrUndefined(groupData.key)){dataSource[index][this.parent.taskFields.child]=groupData.items;continue}}rootData.push.apply(rootData,groupData.items)}this.hierarchyData=this.dataReorder(dataSource,rootData)}cloneDataSource(){let taskIdMapping=this.parent.taskFields.id,parentIdMapping=this.parent.taskFields.parentID;if(isNullOrUndefined(taskIdMapping)||isNullOrUndefined(parentIdMapping))this.prepareDataSource(this.dataArray);else{let data=[];for(let i=0;i<this.dataArray.length;i++){let tempData=this.dataArray[i];data.push(extend({},{},tempData,!0)),isNullOrUndefined(tempData[taskIdMapping])||this.taskIds.push(tempData[taskIdMapping].toString())}this.parent.taskFields.child||(this.parent.taskFields.child="Children"),this.constructDataSource(data),this.prepareDataSource(this.hierarchyData)}}prepareDataSource(data){this.prepareRecordCollection(data,0),this.parent.taskFields.dependency&&this.parent.predecessorModule.ensurePredecessorCollection()}prepareRecordCollection(data,level,parentItem){let length=data.length;for(let i=0;i<length;i++){let tempData=data[i],ganttData=this.createRecord(tempData,level,parentItem,!0);ganttData.index=this.recordIndex++,this.parent.ids[ganttData.index]=ganttData.ganttProperties.taskId.toString(),this.parent.flatData.push(ganttData);let childData=tempData[this.parent.taskFields.child];!isNullOrUndefined(childData)&&childData.length>0&&this.prepareRecordCollection(childData,ganttData.level+1,ganttData)}}addCustomFieldValue(data,ganttRecord){let columns=this.parent.ganttColumns,length=columns.length;if(length)for(let i=0;i<length;i++)void 0===ganttRecord[columns[i].field]&&this.parent.setRecordValue(columns[i].field,data[columns[i].field],ganttRecord)}createRecord(data,level,parentItem,isLoad){let taskSettings=this.parent.taskFields,progress=data[taskSettings.progress];progress=progress&&parseFloat(progress.toString())?parseFloat(progress.toString()):0;let predecessors=data[taskSettings.dependency],baselineStartDate=this.getDateFromFormat(data[taskSettings.baselineStartDate]),baselineEndDate=this.getDateFromFormat(data[taskSettings.baselineEndDate]),ganttData={},ganttProperties={};return this.parent.setRecordValue("ganttProperties",ganttProperties,ganttData),this.parent.setRecordValue("taskId",data[taskSettings.id],ganttProperties,!0),this.parent.setRecordValue("taskName",data[taskSettings.name],ganttProperties,!0),this.addTaskData(ganttData,data,isLoad),this.addCustomFieldValue(data,ganttData),this.parent.setRecordValue("isAutoSchedule",!0,ganttProperties,!0),this.parent.setRecordValue("resourceInfo",this.setResourceInfo(data),ganttProperties,!0),this.parent.setRecordValue("isMilestone",!1,ganttProperties,!0),this.updateResourceName(ganttData),this.calculateScheduledValues(ganttData,data,isLoad),this.parent.setRecordValue("baselineStartDate",this.checkBaselineStartDate(baselineStartDate),ganttProperties,!0),baselineEndDate&&0===baselineEndDate.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,baselineEndDate),this.parent.setRecordValue("baselineEndDate",this.checkBaselineEndDate(baselineEndDate),ganttProperties,!0),this.parent.setRecordValue("progress",progress,ganttProperties,!0),this.parent.setRecordValue("totalProgress",progress,ganttProperties,!0),this.parent.setRecordValue("predecessorsName",predecessors,ganttProperties,!0),this.parent.setRecordValue("indicators",data[taskSettings.indicators],ganttProperties,!0),this.parent.setRecordValue("notes",data[taskSettings.notes],ganttProperties,!0),this.parent.setRecordValue("cssClass",data[taskSettings.cssClass],ganttProperties,!0),this.parent.setRecordValue("parentItem",this.getCloneParent(parentItem),ganttData),this.parent.setRecordValue("parentUniqueID",ganttData.parentItem?ganttData.parentItem.uniqueID:null,ganttData),this.parent.setRecordValue("level",level,ganttData),this.parent.setRecordValue("uniqueID",getUid(this.parent.element.id+"_data_"),ganttData),this.parent.setRecordValue("uniqueID",ganttData.uniqueID,ganttProperties,!0),this.parent.setRecordValue("childRecords",[],ganttData),this.parent.setRecordValue("baselineEndDate",this.checkBaselineEndDate(baselineEndDate),ganttProperties,!0),!isNullOrUndefined(data[taskSettings.child])&&data[taskSettings.child].length>0?(this.parent.setRecordValue("hasChildRecords",!0,ganttData),this.parent.setRecordValue("isMilestone",!1,ganttProperties,!0)):this.parent.setRecordValue("hasChildRecords",!1,ganttData),this.parent.setRecordValue("expanded",!this.parent.collapseAllParentTasks,ganttData),this.updateExpandStateMappingValue(ganttData,data),isLoad||(this.parent.setRecordValue("width",this.calculateWidth(ganttProperties),ganttProperties,!0),this.parent.setRecordValue("left",this.calculateLeft(ganttProperties),ganttProperties,!0),this.parent.setRecordValue("progressWidth",this.getProgressWidth(ganttProperties.width,progress),ganttProperties,!0),ganttProperties.baselineEndDate&&ganttProperties.baselineStartDate&&(this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(ganttProperties),ganttProperties,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(ganttProperties),ganttProperties,!0))),this.updateTaskData(ganttData),isNullOrUndefined(parentItem)||parentItem.childRecords.push(ganttData),predecessors&&this.parent.predecessorsCollection.push(ganttData),ganttData}getCloneParent(parent){if(isNullOrUndefined(parent))return null;{let cloneParent={};return cloneParent.uniqueID=parent.uniqueID,cloneParent.expanded=parent.expanded,cloneParent.level=parent.level,cloneParent.index=parent.index,cloneParent.taskId=parent.ganttProperties.taskId,cloneParent}}reUpdateResources(){if(this.parent.flatData.length>0){let data,ganttProperties,ganttData;for(let index=0;index<this.parent.flatData.length;index++)ganttProperties=this.parent.flatData[index].ganttProperties,ganttData=this.parent.flatData[index],this.parent.setRecordValue("resourceInfo",this.setResourceInfo(data=this.parent.flatData[index].taskData),ganttProperties,!0),this.updateResourceName(ganttData)}}addTaskData(ganttData,data,isLoad){let taskSettings=this.parent.taskFields,dataManager=this.parent.dataSource;if(isLoad)if(taskSettings.parentID||dataManager instanceof ej2_data_es2015_DataManager&&dataManager.dataSource.json&&dataManager.dataSource.offline)if(taskSettings.parentID){let index=this.taskIds.indexOf(data[taskSettings.id]);this.parent.setRecordValue("taskData",index>-1?this.dataArray[index]:{},ganttData)}else this.parent.setRecordValue("taskData",data,ganttData);else this.parent.setRecordValue("taskData",data,ganttData);else this.parent.setRecordValue("taskData",data,ganttData)}updateExpandStateMappingValue(ganttData,data){let updatableValue,expandStateMapping=this.parent.taskFields.expandState,mappingValue=data[expandStateMapping];expandStateMapping&&ganttData.hasChildRecords&&(isNullOrUndefined(mappingValue)?isNullOrUndefined(mappingValue)&&!this.parent.collapseAllParentTasks?updatableValue=!0:isNullOrUndefined(mappingValue)&&this.parent.collapseAllParentTasks&&(updatableValue=!1):updatableValue="true"===mappingValue.toString(),this.parent.setRecordValue("taskData."+expandStateMapping,updatableValue,ganttData),this.parent.setRecordValue("expandStateMapping",updatableValue,ganttData),this.parent.setRecordValue("expanded",updatableValue,ganttData))}calculateScheduledValues(ganttData,data,isLoad){let taskSettings=this.parent.taskFields,ganttProperties=ganttData.ganttProperties,duration=data[taskSettings.duration];duration=isNullOrUndefined(duration)||""===duration?null:duration;let startDate=this.getDateFromFormat(data[taskSettings.startDate]),endDate=this.getDateFromFormat(data[taskSettings.endDate]),isMileStone=!!taskSettings.milestone&&!!data[taskSettings.milestone];if(this.parent.setRecordValue("durationUnit",this.validateDurationUnitMapping(data[taskSettings.durationUnit]?data[taskSettings.durationUnit]:""),ganttProperties,!0),endDate||startDate||!isNullOrUndefined(duration)&&""!==duration)startDate?this.calculateDateFromStartDate(startDate,endDate,duration,ganttData):endDate?this.calculateDateFromEndDate(endDate,duration,ganttData):isNullOrUndefined(duration)||""===duration||(this.updateDurationValue(duration,ganttProperties),this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("startDate",null,ganttProperties,!0),this.parent.setRecordValue("endDate",null,ganttProperties,!0)):(this.parent.setRecordValue("startDate",this.getProjectStartDate(ganttProperties,isLoad),ganttProperties,!0),this.calculateEndDate(ganttData)));else{if(this.parent.allowUnscheduledTasks)return;this.parent.setRecordValue("duration",1,ganttProperties,!0),this.parent.setRecordValue("startDate",this.getProjectStartDate(ganttProperties,isLoad),ganttProperties,!0),this.calculateEndDate(ganttData)}0===ganttProperties.duration&&(this.parent.setRecordValue("isMilestone",!0,ganttProperties,!0),this.parent.setRecordValue("endDate",ganttProperties.startDate,ganttProperties,!0)),!isNullOrUndefined(isMileStone)&&isMileStone&&(this.parent.setRecordValue("duration",0,ganttProperties,!0),this.parent.setRecordValue("isMilestone",!0,ganttProperties,!0),this.parent.setRecordValue("endDate",ganttProperties.startDate,ganttProperties,!0))}calculateDateFromEndDate(endDate,duration,ganttData){let ganttProperties=ganttData.ganttProperties;0===endDate.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,endDate),this.parent.setRecordValue("endDate",this.checkEndDate(endDate,ganttData.ganttProperties),ganttProperties,!0),isNullOrUndefined(duration)||""===duration?this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("startDate",null,ganttProperties,!0),this.parent.setRecordValue("duration",null,ganttProperties,!0)):(this.parent.setRecordValue("duration",1,ganttProperties,!0),this.parent.setRecordValue("startDate",this.getStartDate(ganttProperties.endDate,ganttProperties.duration,ganttProperties.durationUnit,ganttProperties),ganttProperties,!0)):isNullOrUndefined(duration)||""===duration||(this.updateDurationValue(duration,ganttProperties),this.parent.setRecordValue("startDate",this.getStartDate(ganttProperties.endDate,ganttProperties.duration,ganttProperties.durationUnit,ganttProperties),ganttProperties,!0))}calculateDateFromStartDate(startDate,endDate,duration,ganttData){let ganttProperties=ganttData.ganttProperties;this.parent.setRecordValue("startDate",this.checkStartDate(startDate,ganttProperties),ganttProperties,!0),endDate||!isNullOrUndefined(duration)&&""!==duration?(isNullOrUndefined(duration)||endDate)&&endDate&&(isNullOrUndefined(duration)||""===duration)?(0===endDate.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,endDate),this.parent.setRecordValue("endDate",this.checkEndDate(endDate,ganttData.ganttProperties),ganttProperties,!0),1===this.compareDates(ganttProperties.startDate,ganttProperties.endDate)?(this.parent.setRecordValue("endDate",ganttProperties.startDate,ganttProperties,!0),this.parent.setRecordValue("isMilestone",!0,ganttProperties,!0),this.parent.setRecordValue("duration",0,ganttProperties,!0)):this.calculateDuration(ganttData)):(this.updateDurationValue(duration,ganttProperties),this.calculateEndDate(ganttData)):this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("endDate",null,ganttProperties,!0),this.parent.setRecordValue("duration",null,ganttProperties,!0)):(this.parent.setRecordValue("duration",1,ganttProperties,!0),this.calculateEndDate(ganttData))}getProgressWidth(parentWidth,percent){return parentWidth*percent/100}calculateWidth(ganttProp){let sDate=ganttProp.startDate,eDate=ganttProp.endDate;return isNullOrUndefined(sDate)&&isNullOrUndefined(eDate)&&(sDate=this.getValidStartDate(ganttProp),eDate=this.getValidEndDate(ganttProp)),isNullOrUndefined(sDate)||isNullOrUndefined(eDate)?3:ganttProp.isMilestone?0:this.getTaskWidth(sDate,eDate)}getTaskbarHeight(){let rowHeight=this.parent.rowHeight,taskBarHeight=this.parent.taskbarHeight;return taskBarHeight<rowHeight?taskBarHeight:rowHeight}calculateLeft(ganttProp){let sDate=null,left=-300,milestone=ganttProp.isMilestone;return ganttProp.startDate?sDate=new Date(ganttProp.startDate.getTime()):ganttProp.endDate?(sDate=new Date(ganttProp.endDate.getTime()),milestone=!0):sDate=this.getValidStartDate(ganttProp),isNullOrUndefined(sDate)||(left=this.getTaskLeft(sDate,milestone)),left}calculateBaselineLeft(ganttProperties){let baselineStartDate=this.getDateFromFormat(ganttProperties.baselineStartDate),baselineEndDate=this.getDateFromFormat(ganttProperties.baselineEndDate);return baselineStartDate&&baselineEndDate?this.getTaskLeft(baselineStartDate,ganttProperties.isMilestone):0}calculateBaselineWidth(ganttProperties){let baselineStartDate=this.getDateFromFormat(ganttProperties.baselineStartDate),baselineEndDate=this.getDateFromFormat(ganttProperties.baselineEndDate);return baselineStartDate&&baselineEndDate?this.getTaskWidth(baselineStartDate,baselineEndDate):0}getTaskWidth(startDate,endDate){let sDate=new Date(startDate.getTime()),eDate=new Date(endDate.getTime());return"Day"===("None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier)&&(this.getSecondsInDecimal(sDate)===this.parent.defaultStartTime&&sDate.setHours(0,0,0,0),this.getSecondsInDecimal(eDate)===this.parent.defaultEndTime&&eDate.setHours(24)),this.getTimeDifference(sDate,eDate)/864e5*this.parent.perDayWidth}getTaskLeft(startDate,isMilestone){let date=new Date(startDate.getTime());"Day"===("None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier)&&(this.getSecondsInDecimal(date)===this.parent.defaultStartTime?date.setHours(0,0,0,0):isMilestone&&this.getSecondsInDecimal(date)===this.parent.defaultEndTime&&date.setHours(24));let timelineStartDate=this.parent.timelineModule.timelineStartDate;return timelineStartDate?(date.getTime()-timelineStartDate.getTime())/864e5*this.parent.perDayWidth:0}updateMappingData(ganttData,fieldName){let columnMapping=this.parent.columnMapping,ganttProp=ganttData.ganttProperties;if(!isNullOrUndefined(columnMapping[fieldName]))if("predecessorName"===fieldName);else if("resourceInfo"===fieldName){let resourceData=ganttProp.resourceInfo,resourcesId=[],resourcesName=[];for(let i=0;i<resourceData.length;i++)resourcesId.push(resourceData[i][this.parent.resourceIDMapping]),resourcesName.push(resourceData[i][this.parent.resourceNameMapping]);this.parent.setRecordValue("resourceNames",resourcesName.join(","),ganttProp,!0),this.parent.setRecordValue("taskData."+columnMapping[fieldName],resourcesId,ganttData),this.parent.setRecordValue(columnMapping[fieldName],resourcesName.join(","),ganttData)}else"startDate"===fieldName||"endDate"===fieldName?this.setRecordDate(ganttData,ganttProp[fieldName],columnMapping[fieldName]):"duration"===fieldName?this.setRecordDuration(ganttData,columnMapping[fieldName]):(this.parent.setRecordValue("taskData."+columnMapping[fieldName],ganttProp[fieldName],ganttData),this.parent.setRecordValue(columnMapping[fieldName],ganttProp[fieldName],ganttData))}setRecordDate(task,value,mapping){isNullOrUndefined(value)||(value=new Date(value.getTime())),this.parent.setRecordValue(mapping,value,task),isNullOrUndefined(value)||(value=new Date(value.getTime())),this.parent.setRecordValue("taskData."+mapping,value,task)}getDurationInDay(duration,durationUnit){return"day"===durationUnit?duration:"hour"===durationUnit?duration/(this.parent.secondsPerDay/3600):duration/(this.parent.secondsPerDay/60)}setRecordDuration(task,mapping){let duration=task.ganttProperties.duration,durationUnit=task.ganttProperties.durationUnit;isNullOrUndefined(duration)?(this.parent.setRecordValue(mapping,duration,task),this.parent.setRecordValue("taskData."+mapping,duration,task)):(this.parent.setRecordValue(mapping,this.getDurationInDay(duration,durationUnit),task),this.parent.setRecordValue("taskData."+mapping,this.getDurationString(duration,durationUnit),task))}updateTaskData(ganttData){let dataMapping=this.parent.taskFields,ganttProperties=ganttData.ganttProperties;if(!isNullOrUndefined(ganttData.taskData)){let data=ganttData.taskData;dataMapping.id&&(this.parent.setRecordValue("taskData."+dataMapping.id,ganttProperties.taskId,ganttData),this.parent.setRecordValue(dataMapping.id,ganttProperties.taskId,ganttData)),dataMapping.name&&(this.parent.setRecordValue("taskData."+dataMapping.name,ganttProperties.taskName,ganttData),this.parent.setRecordValue(dataMapping.name,ganttProperties.taskName,ganttData)),dataMapping.startDate&&this.setRecordDate(ganttData,ganttProperties.startDate,dataMapping.startDate),dataMapping.endDate&&this.setRecordDate(ganttData,ganttProperties.endDate,dataMapping.endDate),dataMapping.duration&&this.setRecordDuration(ganttData,dataMapping.duration),dataMapping.durationUnit&&(data[dataMapping.durationUnit]=ganttProperties.durationUnit),dataMapping.progress&&(this.parent.setRecordValue("taskData."+dataMapping.progress,ganttProperties.progress,ganttData),this.parent.setRecordValue(dataMapping.progress,ganttProperties.progress,ganttData)),dataMapping.baselineStartDate&&this.setRecordDate(ganttData,ganttProperties.baselineStartDate,dataMapping.baselineStartDate),dataMapping.baselineEndDate&&this.setRecordDate(ganttData,ganttProperties.baselineEndDate,dataMapping.baselineEndDate),dataMapping.notes&&(this.parent.setRecordValue("taskData."+dataMapping.notes,ganttProperties.notes,ganttData),this.parent.setRecordValue(dataMapping.notes,ganttProperties.notes,ganttData)),dataMapping.cssClass&&(this.parent.setRecordValue("taskData."+dataMapping.cssClass,ganttProperties.cssClass,ganttData),this.parent.setRecordValue(dataMapping.cssClass,ganttProperties.cssClass,ganttData)),dataMapping.indicators&&(this.parent.setRecordValue("taskData."+dataMapping.indicators,ganttProperties.indicators,ganttData),this.parent.setRecordValue(dataMapping.indicators,ganttProperties.indicators,ganttData))}}setResourceInfo(data){let resourceIdCollection;if(isNullOrUndefined(data[this.parent.taskFields.resourceInfo]))return resourceIdCollection;resourceIdCollection=data[this.parent.taskFields.resourceInfo];let resourceData=this.parent.resources,resourceIDMapping=this.parent.resourceIDMapping,resources=[];for(let count=0;count<resourceIdCollection.length;count++){let ganttDataResource=extend({},resourceData.filter(resourceInfo=>resourceIdCollection[count]===resourceInfo[resourceIDMapping])[0]);resources.push(ganttDataResource)}return resources}updateResourceName(data){let resourceInfo=data.ganttProperties.resourceInfo,resourceName=[];if(resourceInfo){this.parent.setRecordValue("taskData."+this.parent.taskFields.resourceInfo,[],data);for(let i=0;i<resourceInfo.length;i++){let resource=resourceInfo[i];resourceName.push(resource[this.parent.resourceNameMapping]),data.taskData&&data.taskData[this.parent.taskFields.resourceInfo].push(resource[this.parent.resourceIDMapping])}this.parent.setRecordValue("resourceNames",resourceName.join(","),data.ganttProperties,!0),this.parent.setRecordValue(this.parent.taskFields.resourceInfo,resourceName.join(","),data,!0)}}dataReorder(flatCollection,rootCollection){let result=[];for(;flatCollection.length>0&&rootCollection.length>0;){let index=rootCollection.indexOf(flatCollection[0]);-1===index?flatCollection.shift():(result.push(flatCollection.shift()),rootCollection.splice(index,1))}return result}validateDurationUnitMapping(durationUnit){return"minute"===durationUnit?"minute":"hour"===durationUnit?"hour":"day"===durationUnit?"day":this.parent.durationUnit.toLocaleLowerCase()}updateDurationValue(duration,ganttProperties){let tempDuration=this.getDurationValue(duration);this.parent.setRecordValue("duration",getValue("duration",tempDuration),ganttProperties,!0),isNullOrUndefined(getValue("durationUnit",tempDuration))||this.parent.setRecordValue("durationUnit",getValue("durationUnit",tempDuration),ganttProperties,!0)}reUpdateGanttData(){if(this.parent.flatData.length>0){let data,ganttData;this.parent.secondsPerDay=this.getSecondsPerDay();for(let index=0;index<this.parent.flatData.length;index++)data=this.parent.flatData[index].taskData,ganttData=this.parent.flatData[index],isNullOrUndefined(this.parent.taskFields.duration)||this.setRecordDuration(ganttData,this.parent.taskFields.duration),this.calculateScheduledValues(ganttData,data,!1);this.updateGanttData()}}updateGanttData(){let flatData=this.parent.flatData,length=flatData.length;for(let i=0;i<length;i++){let data=flatData[i],task=data.ganttProperties;data.hasChildRecords||this.updateWidthLeft(data),this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(task),task,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(task),task,!0);let parentItem,childData=[];data.parentItem&&(childData=(parentItem=this.parent.getParentTask(data.parentItem)).childRecords),parentItem&&childData.indexOf(data)===childData.length-1&&!data.hasChildRecords&&parentItem.ganttProperties.isAutoSchedule&&this.updateParentItems(parentItem)}}reUpdateGanttDataPosition(){let flatData=this.parent.flatData,length=flatData.length;for(let i=0;i<length;i++){let data=flatData[i],task=data.ganttProperties;this.updateWidthLeft(data),this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(task),task,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(task),task,!0),this.parent.dataOperation.updateTaskData(data)}}updateWidthLeft(data){let ganttRecord=data.ganttProperties;this.parent.setRecordValue("width",this.parent.dataOperation.calculateWidth(ganttRecord),ganttRecord,!0),this.parent.setRecordValue("left",this.parent.dataOperation.calculateLeft(ganttRecord),ganttRecord,!0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(ganttRecord.width,ganttRecord.progress),ganttRecord,!0)}getParentProgress(childGanttRecord){let durationInDay=0,progressValues={};switch(childGanttRecord.ganttProperties.durationUnit){case"hour":durationInDay=childGanttRecord.ganttProperties.duration/(this.parent.secondsPerDay/3600);break;case"minute":durationInDay=childGanttRecord.ganttProperties.duration/(this.parent.secondsPerDay/60);break;default:durationInDay=childGanttRecord.ganttProperties.duration}return childGanttRecord.hasChildRecords?(setValue("totalProgress",childGanttRecord.ganttProperties.totalProgress,progressValues),setValue("totalDuration",childGanttRecord.ganttProperties.totalDuration,progressValues)):(setValue("totalProgress",childGanttRecord.ganttProperties.progress*durationInDay,progressValues),setValue("totalDuration",durationInDay,progressValues)),progressValues}updateParentItems(cloneParent){let parentData=this.parent.getParentTask(cloneParent);if(parentData.childRecords.length>0){let taskCount,previousStartDate=parentData.ganttProperties.startDate,previousEndDate=parentData.ganttProperties.endDate,childRecords=parentData.childRecords,childLength=childRecords.length,totalDuration=0,progressValues={},minStartDate=null,maxEndDate=null,milestoneCount=0,totalProgress=0;for(let count=0;count<childLength;count++){let childData=childRecords[count];if(this.parent.isOnDelete&&childData.isDelete)continue;let startDate=this.getValidStartDate(childData.ganttProperties),endDate=this.getValidEndDate(childData.ganttProperties);isNullOrUndefined(minStartDate)&&(minStartDate=this.getDateFromFormat(startDate)),isNullOrUndefined(maxEndDate)&&(maxEndDate=this.getDateFromFormat(endDate)),isNullOrUndefined(endDate)||1!==this.compareDates(endDate,maxEndDate)||(maxEndDate=this.getDateFromFormat(endDate)),isNullOrUndefined(startDate)||-1!==this.compareDates(startDate,minStartDate)||(minStartDate=this.getDateFromFormat(startDate)),!childData.ganttProperties.isMilestone&&isScheduledTask(childData.ganttProperties)?(totalProgress+=getValue("totalProgress",progressValues=this.getParentProgress(childData)),totalDuration+=getValue("totalDuration",progressValues)):milestoneCount++}0!==this.compareDates(previousStartDate,minStartDate)&&this.parent.setRecordValue("startDate",minStartDate,parentData.ganttProperties,!0),0!==this.compareDates(previousEndDate,maxEndDate)&&this.parent.setRecordValue("endDate",maxEndDate,parentData.ganttProperties,!0);let parentProgress=(taskCount=this.parent.isOnDelete?childLength-milestoneCount-1:childLength-milestoneCount)>0?totalProgress/totalDuration:0;this.calculateDuration(parentData);let parentProp=parentData.ganttProperties;this.parent.setRecordValue("progress",Math.floor(parentProgress),parentProp,!0),this.parent.setRecordValue("totalProgress",totalProgress,parentProp,!0),this.parent.setRecordValue("totalDuration",totalDuration,parentProp,!0),this.updateWidthLeft(parentData),this.updateTaskData(parentData)}1===parentData.childRecords.length&&0===parentData.ganttProperties.duration&&(this.parent.setRecordValue("isMilestone",!0,parentData.ganttProperties,!0),this.updateWidthLeft(parentData),this.updateTaskData(parentData));let parentItem=this.parent.getParentTask(parentData.parentItem);parentItem&&parentItem.ganttProperties.isAutoSchedule&&this.updateParentItems(parentItem)}}const ganttChartPane="e-gantt-chart-pane",treeGridPane="e-gantt-tree-grid-pane",splitter="e-gantt-splitter",ganttChart="e-gantt-chart",chartBodyContainer="e-chart-root-container",toolbar="e-gantt-toolbar",chartScrollElement="e-chart-scroll-container",chartBodyContent="e-chart-rows-container",scrollContent="e-content",focusCell="e-grid",taskTable="e-task-table",zeroSpacing="e-zero-spacing",timelineHeaderContainer="e-timeline-header-container",timelineHeaderTableContainer="e-timeline-header-table-container",timelineHeaderTableBody="e-timeline-header-table-body",timelineTopHeaderCell="e-timeline-top-header-cell",timelineHeaderCellLabel="e-header-cell-label",weekendHeaderCell="e-weekend-header-cell",timelineSingleHeaderCell="e-timeline-single-header-cell",timelineSingleHeaderOuterDiv="e-timeline-single-header-outer-div",leftLabelContainer="e-left-label-container",leftLabelTempContainer="e-left-label-container e-left-label-temp-container",leftLabelInnerDiv="e-left-label-inner-div",rightLabelContainer="e-right-label-container",rightLabelTempContainer="e-right-label-container e-right-label-temp-container",rightLabelInnerDiv="e-right-label-inner-div",taskBarMainContainer="e-taskbar-main-container",parentTaskBarInnerDiv="e-gantt-parent-taskbar-inner-div",parentProgressBarInnerDiv="e-gantt-parent-progressbar-inner-div",taskLabel="e-task-label",childTaskBarInnerDiv="e-gantt-child-taskbar-inner-div",childProgressBarInnerDiv="e-gantt-child-progressbar-inner-div",milestoneTop="e-milestone-top",milestoneBottom="e-milestone-bottom",baselineBar="e-baseline-bar",baselineMilestoneContainer="e-baseline-gantt-milestone-container",baselineMilestoneDiv="e-baseline-gantt-milestone",baselineMilestoneTop="e-baseline-milestone-top",baselineMilestoneBottom="e-baseline-milestone-bottom",chartRowCell="e-chart-row-cell",ej2_gantt_es2015_chartRow="e-chart-row",rowExpand="e-row-expand",rowCollapse="e-row-collapse",taskBarLeftResizer="e-taskbar-left-resizer",taskBarRightResizer="e-taskbar-right-resizer",childProgressResizer="e-child-progress-resizer",progressBarHandler="e-progressbar-handler",progressHandlerElement="e-progressbar-handler-element",progressBarHandlerAfter="e-progressbar-handler-after",ej2_gantt_es2015_icon="e-icon",traceMilestone="e-gantt-milestone",traceChildTaskBar="e-gantt-child-taskbar",traceChildProgressBar="e-gantt-child-progressbar",traceParentTaskBar="e-gantt-parent-taskbar",traceParentProgressBar="e-gantt-parent-progressbar",taskIndicatorDiv="e-indicator-span",leftResizeGripper="e-left-resize-gripper",rightResizeGripper="e-right-resize-gripper",progressResizeGripper="e-progress-resize-gripper",ej2_gantt_es2015_label="e-label",eventMarkersContainer="e-event-markers-container",eventMarkersChild="e-event-markers",eventMarkersSpan="e-span-label",nonworkingContainer="e-nonworking-day-container",holidayContainer="e-holiday-container",holidayElement="e-holiday",holidayLabel="e-span",weekendContainer="e-weekend-container",weekend="e-weekend",unscheduledTaskbarLeft="e-gantt-unscheduled-taskbar-left",unscheduledTaskbarRight="e-gantt-unscheduled-taskbar-right",unscheduledTaskbar="e-gantt-unscheduled-taskbar",unscheduledMilestoneTop="e-unscheduled-milestone-top",unscheduledMilestoneBottom="e-unscheduled-milestone-bottom",dependencyViewContainer="e-gantt-dependency-view-container",connectorLineContainer="e-connector-line-container",connectorLine="e-line",connectorLineRightArrow="e-connector-line-right-arrow",connectorLineLeftArrow="e-connector-line-left-arrow",connectorLineZIndex="e-connector-line-z-index",connectorLineHover="e-connector-line-hover",connectorLineHoverZIndex="e-connector-line-hover-z-index",connectorLineRightArrowHover="e-connector-line-right-arrow-hover",connectorLineLeftArrowHover="e-connector-line-left-arrow-hover",connectorPointLeft="e-connectorpoint-left",connectorPointRight="e-connectorpoint-right",connectorPointLeftHover="e-connectorpoint-left-hover",connectorPointRightHover="e-connectorpoint-right-hover",falseLine="e-gantt-false-line",rightConnectorPointOuterDiv="e-right-connectorpoint-outer-div",leftConnectorPointOuterDiv="e-left-connectorpoint-outer-div",connectorPointAllowBlock="e-connectorpoint-allow-block",ganttTooltip="e-gantt-tooltip",columnHeader=".e-gridheader",ej2_gantt_es2015_content=".e-content",ej2_gantt_es2015_editForm=".e-gridform",ej2_gantt_es2015_deleteIcon="e-delete",saveIcon="e-save",cancelIcon="e-cancel",editIcon="e-edit",addIcon="e-add",addAboveIcon="e-add-above",addBelowIcon="e-add-below",activeParentTask="e-active-parent-task",activeChildTask="e-active-child-task",activeConnectedTask="e-active-connected-task",touchMode="e-predecessor-touch-mode";class ej2_gantt_es2015_ChartScroll{constructor(parent){this.previousScroll={top:0,left:0},this.parent=parent,this.element=this.parent.ganttChartModule.scrollElement,this.addEventListeners()}addEventListeners(){this.parent.on("grid-scroll",this.gridScrollHandler,this),EventHandler.add(this.element,"scroll",this.onScroll,this)}removeEventListeners(){EventHandler.remove(this.element,"scroll",this.onScroll),this.parent.off("grid-scroll",this.gridScrollHandler)}gridScrollHandler(args){this.element.scrollTop=getValue("top",args),this.previousScroll.top=this.element.scrollTop}onScroll(){this.element.scrollTop!==this.previousScroll.top&&(this.parent.notify("chartScroll",{top:this.element.scrollTop}),this.previousScroll.top=this.element.scrollTop),this.element.scrollLeft!==this.previousScroll.left&&(this.parent.ganttChartModule.chartTimelineContainer.scrollLeft=this.element.scrollLeft,this.previousScroll.left=this.element.scrollLeft)}setHeight(height){this.element.style.height=formatUnit(height)}setWidth(width){this.element.style.width=formatUnit(width)}setScrollTop(scrollTop){this.element.scrollTop=scrollTop}setScrollLeft(scrollLeft){this.element.scrollLeft=scrollLeft,this.parent.ganttChartModule.chartTimelineContainer.scrollLeft=this.element.scrollLeft,this.previousScroll.left=this.element.scrollLeft}destroy(){this.removeEventListeners()}}class ej2_gantt_es2015_GanttChart{constructor(parent){this.isExpandCollapseFromChart=!1,this.isExpandAll=!1,this.parent=parent,this.chartTimelineContainer=null,this.addEventListener()}addEventListener(){this.parent.on("renderPanels",this.renderChartContainer,this),this.parent.on("recordsUpdated",this.renderChartElements,this),this.parent.on("dataReady",this.renderInitialContents,this),this.parent.on("tree-grid-created",this.renderChartContents,this),this.parent.on("destroy",this.destroy,this)}renderChartContents(){this.parent.notify("refreshDayMarkers",{}),this.wireEvents()}renderChartContainer(){this.chartElement=ej2_base_es2015_createElement("div",{id:this.parent.element.id+"GanttChart",className:ganttChart}),this.parent.chartPane.appendChild(this.chartElement),this.renderTimelineContainer(),this.renderBodyContainers()}renderInitialContents(){this.parent.timelineModule.createTimelineSeries()}renderChartElements(){this.parent.chartRowsModule.renderChartRows(),this.parent.connectorLineModule.renderConnectorLines(this.parent.updatedConnectorLineCollection),this.updateWidthAndHeight(),this.parent.notify("selectRowByIndex",{})}renderTimelineContainer(){this.chartTimelineContainer=ej2_base_es2015_createElement("div",{className:timelineHeaderContainer}),this.chartElement.appendChild(this.chartTimelineContainer)}renderBodyContainers(){this.chartBodyContainer=ej2_base_es2015_createElement("div",{className:chartBodyContainer}),this.chartElement.appendChild(this.chartBodyContainer),this.scrollElement=ej2_base_es2015_createElement("div",{className:chartScrollElement+" "+scrollContent,styles:"position:relative;"}),this.chartBodyContainer.appendChild(this.scrollElement),this.chartBodyContent=ej2_base_es2015_createElement("div",{className:chartBodyContent}),this.scrollElement.appendChild(this.chartBodyContent),this.scrollObject=new ej2_gantt_es2015_ChartScroll(this.parent);let toolbarHeight=0;isNullOrUndefined(this.parent.toolbarModule)||isNullOrUndefined(this.parent.toolbarModule.element)||(toolbarHeight=this.parent.toolbarModule.element.offsetHeight),this.scrollObject.setHeight(this.parent.ganttHeight-this.chartTimelineContainer.offsetHeight-toolbarHeight)}updateWidthAndHeight(){this.chartBodyContent.style.height=formatUnit(this.parent.contentHeight),this.chartBodyContent.style.width=formatUnit(this.parent.timelineModule.totalTimelineWidth),this.parent.notify("updateHeight",{}),this.parent.updateGridLineContainerHeight(),this.updateLastRowBottomWidth()}updateLastRowBottomWidth(){if(this.parent.currentViewData.length>0&&"auto"!==this.parent.height){let expandedRecords=this.parent.getExpandedRecords(this.parent.currentViewData),lastExpandedRowIndex=this.parent.currentViewData.indexOf(expandedRecords[expandedRecords.length-1]),lastRow=this.parent.getRowByIndex(lastExpandedRowIndex),table=this.parent.chartRowsModule.ganttChartTableBody;table.querySelectorAll(".e-chart-row-cell.e-chart-row-border.e-lastrow")&&removeClass(table.querySelectorAll(".e-chart-row-cell.e-chart-row-border.e-lastrow"),"e-lastrow"),this.chartBodyContent.clientHeight<this.chartBodyContainer.clientHeight&&lastRow&&addClass(lastRow.querySelectorAll("td"),"e-lastrow")}}removeEventListener(){this.parent.isDestroyed||(this.parent.off("renderPanels",this.renderChartContainer),this.parent.off("recordsUpdated",this.renderChartElements),this.parent.off("dataReady",this.renderInitialContents),this.parent.off("tree-grid-created",this.renderChartContents),this.parent.off("destroy",this.destroy))}ganttChartMouseDown(e){3!==e.which&&(this.parent.notify("chartMouseDown",e),this.parent.element.tabIndex=0)}ganttChartMouseClick(e){this.parent.autoFocusTasks&&this.scrollToTarget(e),this.parent.notify("chartMouseClick",e)}ganttChartMouseUp(e){this.parent.notify("chartMouseUp",e)}scrollToTarget(e){let row=closest(e.target,"tr");if(row&&this.parent.element.contains(row)&&(this.parent.element.querySelectorAll(".e-chart-rows-container")[0].contains(e.target)||this.parent.element.querySelectorAll(".e-gridcontent")[0].contains(e.target))&&this.parent.currentViewData.length>0){let rowIndex=getValue("rowIndex",closest(e.target,"tr")),dateObject=this.parent.currentViewData[rowIndex].ganttProperties.startDate;if(!isNullOrUndefined(dateObject)){let left=this.parent.dataOperation.getTaskLeft(dateObject,!1);this.parent.autoFocusTasks&&this.updateScrollLeft(left)}}}updateScrollLeft(scrollLeft){(this.scrollElement.offsetWidth+this.parent.ganttChartModule.scrollElement.scrollLeft<(scrollLeft=this.scrollElement.scrollWidth<=(scrollLeft=scrollLeft-50>0?scrollLeft-50:0)?this.scrollElement.scrollWidth:scrollLeft)||this.scrollElement.scrollLeft>scrollLeft)&&this.scrollObject.setScrollLeft(scrollLeft)}documentMouseUp(e){if(this.parent.isDestroyed||3===e.which)return;let isTaskbarEdited=!1;if(this.parent.editSettings.allowTaskbarEditing&&getValue("editModule.taskbarEditModule.isMouseDragged",this.parent)&&getValue("editModule.taskbarEditModule.taskBarEditAction",this.parent)&&(isTaskbarEdited=!0),this.parent.notify("chartMouseUp",e),!isTaskbarEdited){let target=e.target,isOnTaskbarElement=e.target.classList.contains(taskBarMainContainer)||closest(e.target,"."+taskBarMainContainer);closest(target,".e-gantt-parent-taskbar")?this.chartExpandCollapseRequest(e):!isOnTaskbarElement&&this.parent.autoFocusTasks&&this.scrollToTarget(e)}this.parent.editModule&&this.parent.editModule.taskbarEditModule&&this.parent.editModule.taskbarEditModule.removeFalseLine(!0)}ganttChartLeave(e){this.parent.notify("chartMouseLeave",e)}ganttChartMove(e){this.parent.notify("chartMouseMove",e),isNullOrUndefined(this.parent.taskFields.dependency)||this.parent.connectorLineEditModule.updateConnectorLineEditElement(e)}doubleClickHandler(e){this.parent.notify("chartDblClick",e)}getRecordByTarget(e){let ganttData;if(closest(e.target,"tr")){let rowIndex=getValue("rowIndex",closest(e.target,"tr"));ganttData=this.parent.currentViewData[rowIndex]}return ganttData}getChartRows(){return document.getElementById(this.parent.element.id+"GanttTaskTableBody").querySelectorAll(".e-chart-row")}chartExpandCollapseRequest(e){let target=e.target,parentElement=closest(target,".e-gantt-parent-taskbar"),record=this.getRecordByTarget(e),chartRow$$1=closest(target,"tr"),rowIndex=getValue("rowIndex",chartRow$$1),args={data:record,gridRow:this.parent.treeGrid.getRows()[rowIndex],chartRow:chartRow$$1,cancel:!1};this.isExpandCollapseFromChart=!0,parentElement.classList.contains("e-row-expand")?this.collapseGanttRow(args):parentElement.classList.contains("e-row-collapse")&&this.expandGanttRow(args)}reRenderConnectorLines(){this.parent.connectorLineModule.dependencyViewContainer.innerHTML="";let expandedRecords=this.parent.getExpandedRecords(this.parent.currentViewData);this.parent.connectorLineIds=[],this.parent.updatedConnectorLineCollection=[],this.parent.predecessorModule.createConnectorLinesCollection(expandedRecords),this.parent.connectorLineModule.renderConnectorLines(this.parent.updatedConnectorLineCollection)}collapseGanttRow(args,isCancel){isCancel?this.collapsedGanttRow(args):this.parent.trigger("collapsing",args,args=>{this.isExpandCollapseFromChart&&!getValue("cancel",args)&&this.collapsedGanttRow(args)}),this.isExpandCollapseFromChart=!1}collapsedGanttRow(args){let record=getValue("data",args);this.isExpandCollapseFromChart?(this.expandCollapseChartRows("collapse",getValue("chartRow",args),record,null),this.parent.treeGrid.collapseRow(getValue("gridRow",args),record),this.isExpandCollapseFromChart=!1):this.expandCollapseChartRows("collapse",getValue("chartRow",args),record,null),this.parent.updateContentHeight(),this.updateWidthAndHeight(),this.reRenderConnectorLines(),getValue("chartRow",args).setAttribute("aria-expanded","false"),this.parent.trigger("collapsed",args)}expandGanttRow(args){this.parent.trigger("expanding",args),this.isExpandCollapseFromChart&&!getValue("cancel",args)&&this.expandedGanttRow(args),this.isExpandCollapseFromChart=!1}expandedGanttRow(args){let record=getValue("data",args);this.isExpandCollapseFromChart?(this.expandCollapseChartRows("expand",getValue("chartRow",args),record,null),this.parent.treeGrid.expandRow(getValue("gridRow",args),record),this.isExpandCollapseFromChart=!1):this.expandCollapseChartRows("expand",getValue("chartRow",args),record,null),this.parent.updateContentHeight(),this.updateWidthAndHeight(),this.reRenderConnectorLines(),getValue("chartRow",args).setAttribute("aria-expanded","true"),this.parent.trigger("expanded",args)}expandCollapseChartRows(action,rowElement,record,isChild){let displayType;if("expand"===action){displayType="table-row",isChild||(record.expanded=!0);let targetElement=rowElement.querySelectorAll(".e-row-collapse");for(let t=0;t<targetElement.length;t++)addClass([targetElement[t]],"e-row-expand"),removeClass([targetElement[t]],"e-row-collapse")}else if("collapse"===action){displayType="none",isChild||(record.expanded=!1);let targetElement=rowElement.querySelectorAll(".e-row-expand");for(let t=0;t<targetElement.length;t++)addClass([targetElement[t]],"e-row-collapse"),removeClass([targetElement[t]],"e-row-expand")}let childRecords=record.childRecords,chartRows=this.getChartRows(),rows=[];chartRows.forEach(item=>{item.classList.contains("gridrowtaskId"+record.ganttProperties.taskId+"level"+(record.level+1))&&rows.push(item)});for(let i=0;i<rows.length;i++)rows[i].style.display=displayType,childRecords[i].childRecords&&childRecords[i].childRecords.length&&("collapse"===action||childRecords[i].expanded||this.isExpandAll)&&this.expandCollapseChartRows(action,rows[i],childRecords[i],!0)}expandCollapseAll(action){"expand"===action?(this.isExpandAll=!0,this.parent.treeGrid.expandAll()):this.parent.treeGrid.collapseAll(),this.isExpandAll=!1,this.parent.element.querySelector(".e-treegrid").focus()}expandAtLevel(level){this.parent.treeGrid.expandAtLevel(level)}collapseAtLevel(level){this.parent.treeGrid.collapseAtLevel(level)}wireEvents(){let mouseUp=Browser.touchEndEvent,mouseMove=Browser.touchMoveEvent,cancel=Browser.isPointer?"pointerleave":"mouseleave";this.parent.editSettings.allowTaskbarEditing&&(EventHandler.add(this.parent.chartPane,Browser.touchStartEvent,this.ganttChartMouseDown,this),EventHandler.add(this.parent.chartPane,cancel,this.ganttChartLeave,this),EventHandler.add(this.parent.chartPane,mouseMove,this.ganttChartMove,this),this.parent.isAdaptive&&(EventHandler.add(this.parent.chartPane,click,this.ganttChartMouseClick,this),EventHandler.add(this.parent.chartPane,mouseUp,this.ganttChartMouseUp,this))),this.parent.isAdaptive||EventHandler.add(document.body,mouseUp,this.documentMouseUp,this),this.parent.editSettings.allowEditing&&EventHandler.add(this.parent.chartRowsModule.ganttChartTableBody,"dblclick",this.doubleClickHandler,this)}unWireEvents(){let mouseUp=Browser.touchEndEvent,mouseMove=Browser.touchMoveEvent,cancel=Browser.isPointer?"pointerleave":"mouseleave";this.parent.editSettings.allowTaskbarEditing&&(EventHandler.remove(this.parent.chartRowsModule.ganttChartTableBody,Browser.touchStartEvent,this.ganttChartMouseDown),EventHandler.remove(this.parent.chartPane,cancel,this.ganttChartLeave),EventHandler.remove(this.parent.chartPane,mouseMove,this.ganttChartMove),this.parent.isAdaptive&&(EventHandler.remove(this.parent.chartPane,click,this.ganttChartMouseClick),EventHandler.remove(this.parent.chartPane,mouseUp,this.ganttChartMouseUp))),this.parent.isAdaptive||EventHandler.remove(document.body,mouseUp,this.documentMouseUp),this.parent.editSettings.allowEditing&&EventHandler.remove(this.parent.chartPane,"dblclick",this.doubleClickHandler)}getRecordByTaskBar(target){return this.parent.currentViewData[this.getIndexByTaskBar(target)]}getIndexByTaskBar(target){let row=closest(target,"tr."+ej2_gantt_es2015_chartRow);return[].slice.call(this.parent.chartRowsModule.ganttChartTableBody.childNodes).indexOf(row)}destroy(){this.removeEventListener(),this.unWireEvents(),this.scrollObject.destroy(),this.scrollObject=null}}class ej2_gantt_es2015_Timeline{constructor(ganttObj){this.isZoomIn=!1,this.isZooming=!1,this.isZoomToFit=!1,this.parent=ganttObj,this.initProperties()}initProperties(){this.timelineStartDate=null,this.timelineEndDate=null,this.totalTimelineWidth=0,this.customTimelineSettings=null,this.parent.isTimelineRoundOff=!this.isZoomToFit&&!!isNullOrUndefined(this.parent.projectStartDate)}validateTimelineProp(){this.roundOffDays(),this.processTimelineProperty(),this.timelineWidthCalculation()}refreshTimeline(){this.initProperties(),this.processTimelineUnit(),this.parent.dataOperation.calculateProjectDates(),this.parent.updateProjectDates(this.parent.cloneProjectStartDate,this.parent.cloneProjectEndDate,this.parent.isTimelineRoundOff)}refreshTimelineByTimeSpan(){this.validateTimelineProp(),this.parent.ganttChartModule.chartTimelineContainer.innerHTML="",this.createTimelineSeries()}updateChartByNewTimeline(){this.parent.chartRowsModule.refreshChartByTimeline(),this.parent.notify("refreshDayMarkers",{})}processZooming(isZoomIn){let currentLevel;this.isZoomToFit=!1,isNullOrUndefined(this.parent.zoomingProjectStartDate)||(this.parent.cloneProjectStartDate=this.parent.cloneProjectStartDate.getTime()<this.parent.zoomingProjectStartDate.getTime()?this.parent.cloneProjectStartDate:this.parent.zoomingProjectStartDate,this.parent.cloneProjectEndDate=this.parent.cloneProjectEndDate.getTime()>this.parent.zoomingProjectEndDate.getTime()?this.parent.cloneProjectEndDate:this.parent.zoomingProjectEndDate),this.parent.zoomingProjectStartDate=null,this.parent.zoomingProjectEndDate=null;let currentZoomingLevel=this.checkCurrentZoomingLevel();this.isZoomIn=isZoomIn,this.isZooming=!0,currentLevel=isZoomIn?currentZoomingLevel+1:currentZoomingLevel-1,this.parent.toolbarModule&&(isZoomIn?currentLevel===this.parent.zoomingLevels[this.parent.zoomingLevels.length-1].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!1):this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!0):currentLevel===this.parent.zoomingLevels[0].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!1):this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!0));let newTimeline=this.parent.zoomingLevels[currentLevel],args={requestType:isZoomIn?"beforeZoomIn":"beforeZoomOut",timeline:newTimeline};this.parent.trigger("actionBegin",args),this.changeTimelineSettings(newTimeline=args.timeline)}changeTimelineSettings(newTimeline){let skipProperty=this.isSingleTier?"None"===this.customTimelineSettings.topTier.unit?"topTier":"bottomTier":null;Object.keys(this.customTimelineSettings).forEach(property=>{property!==skipProperty?this.customTimelineSettings[property]="object"!=typeof newTimeline[property]||isNullOrUndefined(newTimeline[property])?newTimeline[property]:Object.assign({},newTimeline[property]):this.customTimelineSettings["topTier"===property?"bottomTier":"topTier"]=Object.assign({},newTimeline.bottomTier)}),this.parent.isTimelineRoundOff=!this.isZoomToFit&&!!isNullOrUndefined(this.parent.projectStartDate),this.processTimelineUnit(),this.parent.updateProjectDates(this.parent.cloneProjectStartDate,this.parent.cloneProjectEndDate,this.parent.isTimelineRoundOff),(this.isZooming||this.isZoomToFit)&&this.parent.trigger("actionComplete",{requestType:this.isZoomIn?"AfterZoomIn":this.isZoomToFit?"afterZoomToProject":"AfterZoomOut"})}processZoomToFit(){this.isZoomToFit=!0,this.isZooming=!1,this.parent.zoomingProjectStartDate||(this.parent.zoomingProjectStartDate=this.parent.cloneProjectStartDate,this.parent.zoomingProjectEndDate=this.parent.cloneProjectEndDate),this.parent.dataOperation.calculateProjectDates();let zoomingLevel,firstValue,secondValue,timeDifference=this.parent.cloneProjectEndDate.getTime()-this.parent.cloneProjectStartDate.getTime(),chartWidth=this.parent.ganttChartModule.chartElement.offsetWidth,perDayWidth=chartWidth/(timeDifference/864e5),sortedCollectons=[...this.parent.zoomingLevels].sort((a,b)=>a.perDayWidth<b.perDayWidth?1:-1);if(0===perDayWidth)return;for(let i=0;i<sortedCollectons.length;i++){if(firstValue=sortedCollectons[i],i===sortedCollectons.length-1){zoomingLevel=sortedCollectons[i];break}if(secondValue=sortedCollectons[i+1],perDayWidth>=firstValue.perDayWidth){zoomingLevel=sortedCollectons[i];break}if(perDayWidth<firstValue.perDayWidth&&perDayWidth>secondValue.perDayWidth){zoomingLevel=sortedCollectons[i+1];break}}let newTimeline=Object.assign({},zoomingLevel);this.roundOffDateToZoom(this.parent.cloneProjectStartDate,!0,perDayWidth,newTimeline.bottomTier.unit),this.roundOffDateToZoom(this.parent.cloneProjectEndDate,!1,perDayWidth,newTimeline.bottomTier.unit);let numberOfCells=this.calculateNumberOfTimelineCells(newTimeline);newTimeline.timelineUnitSize=Math.abs(chartWidth-25)/numberOfCells,this.changeTimelineSettings(newTimeline),this.parent.trigger("actionBegin",{requestType:"beforeZoomToProject",timeline:newTimeline})}roundOffDateToZoom(date,isStartDate,perDayWidth,tierMode){let roundOffTime=("Month"===tierMode||"Year"===tierMode?60:20)/perDayWidth*864e5;date.setTime(isStartDate?date.getTime()-roundOffTime:date.getTime()+roundOffTime),"Hour"===tierMode?date.setMinutes(isStartDate?-120:120):"Minutes"===tierMode?date.setSeconds(isStartDate?-120:120):date.setHours(isStartDate?-48:48,0,0,0)}calculateNumberOfTimelineCells(newTimeline){let numberOfDays=Math.abs((this.parent.cloneProjectEndDate.getTime()-this.parent.cloneProjectStartDate.getTime())/864e5),count=newTimeline.bottomTier.count,unit=newTimeline.bottomTier.unit;return"Day"===unit?numberOfDays/count:"Week"===unit?numberOfDays/count/7:"Month"===unit?numberOfDays/count/28:"Year"===unit?numberOfDays/count/336:"Hour"===unit?numberOfDays*(24/count):numberOfDays*(1440/count)}processTimelineUnit(){let tierUnits=["Year","Month","Week","Day","Hour","Minutes"];this.customTimelineSettings=this.customTimelineSettings?this.customTimelineSettings:this.extendFunction(this.parent.timelineSettings,["timelineViewMode","timelineUnitSize","weekStartDay","weekendBackground"],{topTier:["unit","format","count","formatter"],bottomTier:["unit","format","count","formatter"]}),-1===tierUnits.indexOf(this.customTimelineSettings.topTier.unit)&&-1===tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit)?(this.customTimelineSettings.topTier.unit=-1!==tierUnits.indexOf(this.customTimelineSettings.timelineViewMode)?this.customTimelineSettings.timelineViewMode:"Week",this.customTimelineSettings.bottomTier.unit=5!==tierUnits.indexOf(this.customTimelineSettings.topTier.unit)?tierUnits[tierUnits.indexOf(this.customTimelineSettings.topTier.unit)+1]:"None"):-1!==tierUnits.indexOf(this.customTimelineSettings.topTier.unit)&&-1!==tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit)&&tierUnits.indexOf(this.customTimelineSettings.topTier.unit)>tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit)?this.customTimelineSettings.bottomTier.unit=this.customTimelineSettings.topTier.unit:(this.customTimelineSettings.topTier.unit=-1===tierUnits.indexOf(this.customTimelineSettings.topTier.unit)?"None":this.customTimelineSettings.topTier.unit,this.customTimelineSettings.bottomTier.unit=-1===tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit)?"None":this.customTimelineSettings.bottomTier.unit),this.topTier=this.customTimelineSettings.topTier.unit,this.bottomTier=this.customTimelineSettings.bottomTier.unit,this.previousIsSingleTier=this.isSingleTier,this.isSingleTier="None"===this.topTier||"None"===this.bottomTier}processTimelineProperty(){this.customTimelineSettings.topTier.count="None"===this.topTier?1:this.validateCount(this.customTimelineSettings.topTier.unit,this.customTimelineSettings.topTier.count,"topTier"),this.customTimelineSettings.bottomTier.count="None"===this.customTimelineSettings.bottomTier.unit?1:this.validateCount(this.customTimelineSettings.bottomTier.unit,this.customTimelineSettings.bottomTier.count,"bottomTier"),this.customTimelineSettings.bottomTier.format=this.validateFormat(this.customTimelineSettings.bottomTier.unit,this.customTimelineSettings.bottomTier.format),this.customTimelineSettings.topTier.format=this.validateFormat(this.topTier,this.customTimelineSettings.topTier.format),this.customTimelineSettings.weekStartDay=this.customTimelineSettings.weekStartDay>=0&&this.customTimelineSettings.weekStartDay<=6?this.customTimelineSettings.weekStartDay:0,this.checkCurrentZoomingLevel()}calculateZoomingLevelsPerDayWidth(){let collections=this.parent.zoomingLevels;for(let i=0;i<collections.length;i++){let perDayWidth=this.getPerDayWidth(collections[i].timelineUnitSize,collections[i].bottomTier.count,collections[i].bottomTier.unit);collections[i].perDayWidth=perDayWidth}}checkCurrentZoomingLevel(){let zoomLevel=this.getCurrentZoomingLevel("None"!==this.customTimelineSettings.bottomTier.unit?this.customTimelineSettings.bottomTier.unit:this.customTimelineSettings.topTier.unit,"None"!==this.customTimelineSettings.bottomTier.unit?this.customTimelineSettings.bottomTier.count:this.customTimelineSettings.topTier.count);return this.parent.toolbarModule&&(zoomLevel===this.parent.zoomingLevels[this.parent.zoomingLevels.length-1].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!1):zoomLevel===this.parent.zoomingLevels[0].level&&this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!1)),this.parent.currentZoomingLevel=this.parent.zoomingLevels[zoomLevel],zoomLevel}getCurrentZoomingLevel(unit,count){let level,currentZoomCollection,checkSameCountLevels,secondValue,firstValue;this.parent.zoomingLevels.length||(this.parent.zoomingLevels=this.parent.getZoomingLevels());let sameUnitLevels=this.parent.zoomingLevels.filter(tempLevel=>tempLevel.bottomTier.unit===unit);if(0===sameUnitLevels.length){let closestUnit=this.getClosestUnit(unit,"",!1);sameUnitLevels=this.parent.zoomingLevels.filter(tempLevel=>tempLevel.bottomTier.unit===closestUnit)}let sortedUnitLevels=sameUnitLevels.sort((a,b)=>a.bottomTier.count<b.bottomTier.count?1:-1);for(let i=0;i<sortedUnitLevels.length;i++){if(firstValue=sortedUnitLevels[i],i===sortedUnitLevels.length-1){level=sortedUnitLevels[i].level;break}if(secondValue=sortedUnitLevels[i+1],count>=firstValue.bottomTier.count){currentZoomCollection=sortedUnitLevels[i],level=(checkSameCountLevels=sortedUnitLevels.filter(tempLevel=>tempLevel.bottomTier.count===currentZoomCollection.bottomTier.count)).length>1?this.checkCollectionsWidth(checkSameCountLevels):checkSameCountLevels[0].level;break}if(count<firstValue.bottomTier.count&&count>secondValue.bottomTier.count){currentZoomCollection=sortedUnitLevels[i+1],level=(checkSameCountLevels=sortedUnitLevels.filter(tempLevel=>tempLevel.bottomTier.count===currentZoomCollection.bottomTier.count)).length>1?this.checkCollectionsWidth(checkSameCountLevels):checkSameCountLevels[0].level;break}}return level}getClosestUnit(unit,closetUnit,isCont){let bottomTierUnits=["Year","Month","Week","Day","Hour","Minutes"],index=bottomTierUnits.indexOf(unit);return 0===index&&(isCont=!0),unit=this.isZoomIn||isCont?bottomTierUnits[index+1]:bottomTierUnits[index-1],0===this.parent.zoomingLevels.filter(tempLevel=>tempLevel.bottomTier.unit===unit).length?("Year"===unit&&(isCont=!0),this.getClosestUnit(unit,unit,isCont)):unit}checkCollectionsWidth(checkSameLevels){let level,secondValue,firstValue,width=this.customTimelineSettings.timelineUnitSize,sortedZoomLevels=checkSameLevels.sort((a,b)=>a.timelineUnitSize<b.timelineUnitSize?1:-1);for(let i=0;i<sortedZoomLevels.length;i++){if(firstValue=sortedZoomLevels[i],i===sortedZoomLevels.length-1){level=sortedZoomLevels[i].level;break}if(secondValue=sortedZoomLevels[i+1],width>=firstValue.timelineUnitSize){level=sortedZoomLevels[i].level;break}if(width<firstValue.timelineUnitSize&&width>secondValue.timelineUnitSize){level=sortedZoomLevels[i+1].level;break}}return level}updateTimelineHeaderHeight(){if(this.parent.timelineModule.isSingleTier?(addClass([this.parent.ganttChartModule.chartTimelineContainer],timelineSingleHeaderOuterDiv),this.parent.treeGrid.element&&(addClass(this.parent.treeGrid.element.querySelectorAll(".e-headercell"),timelineSingleHeaderOuterDiv),addClass(this.parent.treeGrid.element.querySelectorAll(".e-columnheader"),timelineSingleHeaderOuterDiv))):(removeClass([this.parent.ganttChartModule.chartTimelineContainer],timelineSingleHeaderOuterDiv),this.parent.treeGrid.element&&(removeClass(this.parent.treeGrid.element.querySelectorAll(".e-headercell"),timelineSingleHeaderOuterDiv),removeClass(this.parent.treeGrid.element.querySelectorAll(".e-columnheader"),timelineSingleHeaderOuterDiv))),this.previousIsSingleTier!==this.isSingleTier){let toolbarHeight=0;isNullOrUndefined(this.parent.toolbarModule)||isNullOrUndefined(this.parent.toolbarModule.element)||(toolbarHeight=this.parent.toolbarModule.element.offsetHeight),this.parent.ganttChartModule.scrollObject.setHeight(this.parent.ganttHeight-this.parent.ganttChartModule.chartTimelineContainer.offsetHeight-toolbarHeight),this.parent.treeGrid.height=this.parent.ganttHeight-toolbarHeight-this.parent.ganttChartModule.chartTimelineContainer.offsetHeight}}createTimelineSeries(){let tr,td,div,table,thead,loopCount=this.isSingleTier?1:2,tier="None"===this.topTier?"bottomTier":"topTier";this.updateTimelineHeaderHeight();for(let count=0;count<loopCount;count++)table=ej2_base_es2015_createElement("table",{className:timelineHeaderTableContainer,styles:"display: block;"}),thead=ej2_base_es2015_createElement("thead",{className:timelineHeaderTableBody,styles:"display:block; border-collapse:collapse"}),tr=ej2_base_es2015_createElement("tr",{innerHTML:this.createTimelineTemplate(tier)}),td=ej2_base_es2015_createElement("th"),div=ej2_base_es2015_createElement("div",{styles:"width: 20px"}),td.appendChild(div),tr.appendChild(td),thead.appendChild(tr),table.appendChild(thead),this.parent.ganttChartModule.chartTimelineContainer.appendChild(table),tier="bottomTier",tr=null}validateCount(mode,count,tier){let difference,tierCount=!isNullOrUndefined(count)&&parseInt(count.toString(),10)>0?parseInt(count.toString(),10):1,timeDifference=Math.abs(this.timelineRoundOffEndDate.getTime()-this.timelineStartDate.getTime());switch(mode){case"Year":tierCount=tierCount<=(difference=Math.round(timeDifference/864e5/336))?tierCount:difference>0?difference:1,"None"!==this.topTier&&"bottomTier"===tier&&(tierCount=this.validateBottomTierCount(mode,tierCount));break;case"Month":tierCount=tierCount<=(difference=Math.round(timeDifference/864e5/28))?tierCount:difference>0?difference:1,"None"!==this.topTier&&"bottomTier"===tier&&(tierCount=this.validateBottomTierCount(mode,tierCount));break;case"Week":tierCount=tierCount<=(difference=Math.round(timeDifference/864e5/7))?tierCount:difference>0?difference:1,"None"!==this.topTier&&"bottomTier"===tier&&(tierCount=this.validateBottomTierCount(mode,tierCount));break;case"Day":tierCount=tierCount<=(difference=Math.round(timeDifference/864e5))?tierCount:difference>0?difference:1,"None"!==this.topTier&&"bottomTier"===tier&&(tierCount=this.validateBottomTierCount(mode,tierCount));break;case"Hour":tierCount=tierCount<=(difference=Math.round(timeDifference/36e5))?tierCount:difference>0?difference:1,"None"!==this.topTier&&"bottomTier"===tier&&(tierCount=this.validateBottomTierCount(mode,tierCount));break;case"Minutes":tierCount=tierCount<=(difference=Math.round(timeDifference/6e4))?tierCount:difference>0?difference:1,"None"!==this.topTier&&"bottomTier"===tier&&(tierCount=this.validateBottomTierCount(mode,tierCount))}return count!==tierCount&&this.isZooming&&this.parent.toolbarModule&&("bottomTier"===tier||this.isSingleTier)&&this.parent.toolbarModule.enableItems(this.isZoomIn?[this.parent.controlId+"_zoomin"]:[this.parent.controlId+"_zoomout"],!1),tierCount}validateBottomTierCount(mode,tierCount){let count;switch(mode){case"Year":count=tierCount<=this.customTimelineSettings.topTier.count?tierCount:this.customTimelineSettings.topTier.count;break;case"Month":count="Year"===this.topTier?tierCount<=12*this.customTimelineSettings.topTier.count?tierCount:12*this.customTimelineSettings.topTier.count:tierCount<=this.customTimelineSettings.topTier.count?tierCount:this.customTimelineSettings.topTier.count;break;case"Week":count="Year"===this.topTier?tierCount<=48*this.customTimelineSettings.topTier.count?tierCount:48*this.customTimelineSettings.topTier.count:"Month"===this.topTier?tierCount<=4*this.customTimelineSettings.topTier.count?tierCount:4*this.customTimelineSettings.topTier.count:tierCount<=this.customTimelineSettings.topTier.count?tierCount:this.customTimelineSettings.topTier.count;break;case"Day":count="Year"===this.topTier?tierCount<=336*this.customTimelineSettings.topTier.count?tierCount:336*this.customTimelineSettings.topTier.count:"Month"===this.topTier?tierCount<=28*this.customTimelineSettings.topTier.count?tierCount:28*this.customTimelineSettings.topTier.count:"Week"===this.topTier?tierCount<=7*this.customTimelineSettings.topTier.count?tierCount:7*this.customTimelineSettings.topTier.count:tierCount<=this.customTimelineSettings.topTier.count?tierCount:this.customTimelineSettings.topTier.count;break;case"Hour":count="Year"===this.topTier?tierCount<=8064*this.customTimelineSettings.topTier.count?tierCount:8064*this.customTimelineSettings.topTier.count:"Month"===this.topTier?tierCount<=672*this.customTimelineSettings.topTier.count?tierCount:672*this.customTimelineSettings.topTier.count:"Week"===this.topTier?tierCount<=7*this.customTimelineSettings.topTier.count*24?tierCount:7*this.customTimelineSettings.topTier.count*24:"Day"===this.topTier?tierCount<=24*this.customTimelineSettings.topTier.count?tierCount:24*this.customTimelineSettings.topTier.count:tierCount<=this.customTimelineSettings.topTier.count?tierCount:this.customTimelineSettings.topTier.count;break;case"Minutes":count="Year"===this.topTier?tierCount<=483840*this.customTimelineSettings.topTier.count?tierCount:483840*this.customTimelineSettings.topTier.count:"Month"===this.topTier?tierCount<=40320*this.customTimelineSettings.topTier.count?tierCount:40320*this.customTimelineSettings.topTier.count:"Week"===this.topTier?tierCount<=7*this.customTimelineSettings.topTier.count*24*60?tierCount:7*this.customTimelineSettings.topTier.count*24*60:"Day"===this.topTier?tierCount<=24*this.customTimelineSettings.topTier.count*60?tierCount:24*this.customTimelineSettings.topTier.count*60:"Hour"===this.topTier?tierCount<=60*this.customTimelineSettings.topTier.count?tierCount:60*this.customTimelineSettings.topTier.count:tierCount<=this.customTimelineSettings.topTier.count?tierCount:this.customTimelineSettings.topTier.count}return count}validateFormat(mode,format){let tierFormat;switch(mode){case"Week":tierFormat=format||"MMM dd, yyyy";break;case"Day":case"None":tierFormat=format||"";break;case"Hour":tierFormat=format||"H";break;case"Month":tierFormat=format||"MMM yyyy";break;case"Year":tierFormat=format||"yyyy";break;case"Minutes":tierFormat=format||"m"}return tierFormat}extendFunction(cloneObj,propertyCollection,innerProperty){let tempObj={};for(let index=0;index<propertyCollection.length;index++)tempObj[propertyCollection[index]]=cloneObj[propertyCollection[index]];return innerProperty&&Object.keys(innerProperty).forEach(key=>{tempObj[key]=this.extendFunction(cloneObj[key],innerProperty[key],null)}),tempObj}formatDateHeader(dayFormat,data){let dateString,date=new Date(data.getTime());switch(dayFormat){case"":dateString=(dateString=this.parent.globalize.formatDate(date,{format:"E"})).slice(0,1);break;default:dateString=this.parent.globalize.formatDate(date,{format:dayFormat})}return dateString}customFormat(date,format,tier,mode,formatter){return(formatter="string"==typeof formatter?getValue(formatter,window):formatter)(date,format,tier,mode)}createTimelineTemplate(tier){let increment,newTime,parent=this.parent,parentTh="",parentTr="",mode="topTier"===tier?parent.timelineModule.customTimelineSettings.topTier.unit:parent.timelineModule.customTimelineSettings.bottomTier.unit,count="topTier"===tier?parent.timelineModule.customTimelineSettings.topTier.count:parent.timelineModule.customTimelineSettings.bottomTier.count,startDate=new Date(this.parent.timelineModule.timelineStartDate.toString()),endDate=new Date(this.timelineRoundOffEndDate.toString()),scheduleDateCollection=[];do{parentTr=this.getHeaterTemplateString(new Date(startDate.toString()),mode,tier,!1,count),scheduleDateCollection.push(new Date(startDate.toString())),increment=this.getIncrement(startDate,count,mode),newTime=startDate.getTime()+increment,startDate.setTime(newTime),startDate>=endDate&&(parentTr=this.getHeaterTemplateString(scheduleDateCollection[scheduleDateCollection.length-1],mode,tier,!0,count)),parentTh+=parentTr,parentTr=""}while(!(startDate>=endDate));return parentTh}getTimelineRoundOffEndDate(date){let tierMode="None"===this.topTier?this.bottomTier:this.topTier,endDate=new Date(date.toString());return this.parent.isTimelineRoundOff&&("Hour"===tierMode?endDate.setMinutes(60):"Minutes"===tierMode?endDate.setSeconds(60):endDate.setHours(24,0,0,0)),endDate}getIncrement(startDate,count,mode){let increment,firstDay=new Date(startDate.getTime()),lastDay=new Date(startDate.getTime());switch(mode){case"Year":firstDay=startDate,increment=(lastDay=new Date(startDate.getFullYear()+(count-1),11,31)).getTime()-firstDay.getTime()+864e5;break;case"Month":firstDay=startDate,increment=(lastDay=new Date(startDate.getFullYear(),startDate.getMonth()+count,0)).getTime()-firstDay.getTime()+864e5;break;case"Week":let dayIndex=this.parent.timelineModule.customTimelineSettings.weekStartDay,dayIntervel=startDate.getDay()<dayIndex?dayIndex-startDate.getDay():6-startDate.getDay()+dayIndex;count=dayIntervel>0?count-1:0,lastDay.setHours(24,0,0,0),dayIntervel=startDate.getDay()<dayIndex&&dayIntervel>0?dayIntervel-1:dayIntervel,lastDay.setDate(lastDay.getDate()+(dayIntervel+7*count)),increment=lastDay.getTime()-firstDay.getTime();break;case"Day":lastDay.setHours(24,0,0,0),increment=lastDay.getTime()-firstDay.getTime()+864e5*(count-1);break;case"Hour":lastDay.setMinutes(60),lastDay.setSeconds(0),increment=lastDay.getTime()-firstDay.getTime()+36e5*(count-1);break;case"Minutes":lastDay.setSeconds(60),increment=lastDay.getTime()-firstDay.getTime()+6e4*(count-1)}return increment}isWeekendHeaderCell(mode,tier,day){return"Day"===mode&&1===this.customTimelineSettings[tier].count&&-1!==this.parent.nonWorkingDayIndex.indexOf(day.getDay())}getHeaterTemplateString(scheduleWeeks,mode,tier,isLast,count){let thWidth,cellWidth,isWeekendCell,parentTr="",td="",format="topTier"===tier?this.parent.timelineModule.customTimelineSettings.topTier.format:this.parent.timelineModule.customTimelineSettings.bottomTier.format,formatter="topTier"===tier?this.parent.timelineModule.customTimelineSettings.topTier.formatter:this.parent.timelineModule.customTimelineSettings.bottomTier.formatter,date=isNullOrUndefined(formatter)?this.parent.globalize.formatDate(scheduleWeeks,{format:this.parent.dateFormat}):this.customFormat(scheduleWeeks,format,tier,mode,formatter);cellWidth=thWidth=this.getIncrement(scheduleWeeks,count,mode)/864e5*this.parent.perDayWidth,thWidth=isLast?this.calculateWidthBetweenTwoDate(mode,scheduleWeeks,this.timelineRoundOffEndDate):thWidth,isWeekendCell=this.isWeekendHeaderCell(mode,tier,scheduleWeeks);let textClassName="topTier"===tier?" e-gantt-top-cell-text":"";return td+=this.parent.timelineModule.isSingleTier?'<th class="'+timelineSingleHeaderCell+" ":'<th class="'+timelineTopHeaderCell,td+=isWeekendCell?" "+weekendHeaderCell:"",td+='" tabindex="-1" aria-label= "'+this.parent.localeObj.getConstant("timelineCell")+" "+date,td+='" style="width:'+thWidth+"px;",td+=isWeekendCell&&this.customTimelineSettings.weekendBackground?"background-color:"+this.customTimelineSettings.weekendBackground+";":"",td+='"><div class="'+timelineHeaderCellLabel+textClassName+'" style="width:'+(thWidth-1)+"px;"+(this.parent.timelineSettings.showTooltip?'"title="'+date:""),td+=isWeekendCell&&this.customTimelineSettings.weekendBackground?"background-color:"+this.customTimelineSettings.weekendBackground+";":"",parentTr+=td+='">'+(isNullOrUndefined(formatter)?this.formatDateHeader(format,scheduleWeeks):this.customFormat(scheduleWeeks,format,tier,mode,formatter))+"</div>",parentTr+="</th>",td="",!this.isSingleTier&&"topTier"!==tier||isLast?(this.isSingleTier||"topTier"===tier)&&isLast&&(this.totalTimelineWidth=this.totalTimelineWidth-cellWidth+thWidth):this.totalTimelineWidth=this.totalTimelineWidth+thWidth,parentTr}calculateWidthBetweenTwoDate(mode,scheduleWeeks,endDate){return(endDate.getTime()-scheduleWeeks.getTime())/864e5*this.parent.perDayWidth}timelineWidthCalculation(){let timelineUnitSize=this.customTimelineSettings.timelineUnitSize,bottomTierCount=this.customTimelineSettings.bottomTier.count,topTierCount=this.customTimelineSettings.topTier.count;switch(this.bottomTierCellWidth=timelineUnitSize,this.bottomTier){case"None":this.parent.perDayWidth=this.getPerDayWidth(timelineUnitSize,topTierCount,this.topTier);break;default:this.parent.perDayWidth=this.getPerDayWidth(timelineUnitSize,bottomTierCount,this.bottomTier)}this.topTierCellWidth="None"!==this.bottomTier?"Week"===this.topTier?7*this.parent.perDayWidth:"Hour"===this.topTier?this.parent.perDayWidth/24:"Minutes"===this.topTier?this.parent.perDayWidth/1440:this.parent.perDayWidth:timelineUnitSize,this.topTierCellWidth=this.isSingleTier?this.topTierCellWidth:this.topTierCellWidth*topTierCount}getPerDayWidth(timelineUnitSize,bottomTierCount,mode){let perDayWidth;switch(mode){case"Year":perDayWidth=timelineUnitSize/bottomTierCount/336;break;case"Month":perDayWidth=timelineUnitSize/bottomTierCount/28;break;case"Week":perDayWidth=timelineUnitSize/bottomTierCount/7;break;case"Day":perDayWidth=timelineUnitSize/bottomTierCount;break;case"Hour":perDayWidth=24/bottomTierCount*timelineUnitSize;break;case"Minutes":perDayWidth=1440/bottomTierCount*timelineUnitSize}return perDayWidth}roundOffDays(){let startDate=this.parent.cloneProjectStartDate,endDate=this.parent.cloneProjectEndDate,tierMode="None"===this.topTier?this.bottomTier:this.topTier;if(this.parent.isTimelineRoundOff){if("Year"===tierMode)startDate=new Date(startDate.getFullYear(),0,1),endDate=new Date(endDate.getFullYear(),11,31);else if("Month"===tierMode)startDate=new Date(startDate.getFullYear(),startDate.getMonth(),1),endDate=new Date(endDate.getFullYear(),endDate.getMonth()+1,0);else if("Week"===tierMode){let dayIndex=this.parent.timelineModule.customTimelineSettings.weekStartDay,roundOffStartDate=startDate.getDay()<dayIndex?startDate.getDate()-(7-dayIndex+startDate.getDay()):startDate.getDate()-startDate.getDay()+dayIndex;startDate.setDate(roundOffStartDate);let first=endDate.getDate()-endDate.getDay();endDate.setDate(first+6+dayIndex)}"Hour"===tierMode?startDate.setMinutes(0):"Minutes"===tierMode?startDate.setSeconds(0):startDate.setHours(0,0,0,0)}this.timelineStartDate=startDate,this.timelineEndDate=endDate,this.timelineRoundOffEndDate=this.getTimelineRoundOffEndDate(this.timelineEndDate)}updateScheduleDatesByToolBar(mode,span,startDate,endDate){if("Year"===mode&&("prevTimeSpan"===span?startDate=0===startDate.getMonth()?new Date(startDate.getFullYear()-1,0,1):new Date(startDate.getFullYear(),0,1):endDate=11===endDate.getMonth()?new Date(endDate.getFullYear()+1,0,1):new Date(endDate.getFullYear(),12,1)),"Month"===mode&&("prevTimeSpan"===span?startDate=1===startDate.getDate()?new Date(startDate.getFullYear(),startDate.getMonth()-1,1):new Date(startDate.getFullYear(),startDate.getMonth(),1):endDate=new Date(endDate.getFullYear(),endDate.getMonth()+1,1)),"Week"===mode){let dayIntervel,dayIndex=this.parent.timelineModule.customTimelineSettings.weekStartDay;"prevTimeSpan"===span?(dayIntervel=startDate.getDay()<dayIndex?7-(dayIndex-startDate.getDay()):startDate.getDay()-dayIndex,startDate.setHours(0,0,0,0),startDate.setDate(0===dayIntervel?startDate.getDate()-7:startDate.getDate()-dayIntervel)):(dayIntervel=endDate.getDay()<dayIndex?dayIndex-endDate.getDay():7-endDate.getDay()+dayIndex,endDate.setHours(0,0,0,0),endDate.setDate(0===dayIntervel?endDate.getDate()+6:endDate.getDate()+dayIntervel))}"Day"===mode&&("prevTimeSpan"===span?0===startDate.getHours()?startDate.setTime(startDate.getTime()-864e5):startDate.setHours(0):0===endDate.getHours()?endDate.setTime(endDate.getTime()+864e5):endDate.setHours(24)),"Hour"===mode&&("prevTimeSpan"===span?0===startDate.getMinutes()?startDate.setTime(startDate.getTime()-36e5):startDate.setMinutes(0):0===endDate.getMinutes()?endDate.setTime(endDate.getTime()+36e5):endDate.setMinutes(60)),"Minutes"===mode&&("prevTimeSpan"===span?0===startDate.getSeconds()?startDate.setTime(startDate.getTime()-6e4):startDate.setSeconds(0):0===endDate.getSeconds()?endDate.setTime(endDate.getTime()+6e4):endDate.setSeconds(60)),this.parent.cloneProjectStartDate=startDate,this.parent.cloneProjectEndDate=endDate}updateTimeLineOnEditing(tempArray,action){let isChanged,filteredStartDateRecord=tempArray.filter(pdc=>!isNullOrUndefined(pdc.ganttProperties.startDate)),filteredEndDateRecord=tempArray.filter(pdc=>!isNullOrUndefined(pdc.ganttProperties.endDate)),minStartDate=filteredStartDateRecord.length>0?new Date(ej2_data_es2015_DataUtil.aggregates.min(filteredStartDateRecord,"ganttProperties.startDate")):null,maxEndDate=filteredEndDateRecord.length>0?new Date(ej2_data_es2015_DataUtil.aggregates.max(filteredEndDateRecord,"ganttProperties.endDate")):null,validStartDate=new Date(this.parent.dataOperation.checkStartDate(this.timelineStartDate).getTime()),validEndDate=new Date(this.parent.dataOperation.checkEndDate(this.timelineEndDate).getTime()),maxStartLeft=isNullOrUndefined(minStartDate)?null:this.parent.dataOperation.getTaskLeft(minStartDate,!1),maxEndLeft=isNullOrUndefined(maxEndDate)?null:this.parent.dataOperation.getTaskLeft(maxEndDate,!1),validStartLeft=this.parent.dataOperation.getTaskLeft(validStartDate,!1),validEndLeft=this.parent.dataOperation.getTaskLeft(validEndDate,!1);!isNullOrUndefined(maxStartLeft)&&(maxStartLeft<=this.bottomTierCellWidth||maxStartLeft<=validStartLeft)?(isChanged="prevTimeSpan",minStartDate=minStartDate>this.timelineStartDate?this.timelineStartDate:minStartDate):minStartDate=this.timelineStartDate,!isNullOrUndefined(maxEndLeft)&&(maxEndLeft>=this.totalTimelineWidth-this.bottomTierCellWidth||maxEndLeft>=validEndLeft)?(isChanged="prevTimeSpan"===isChanged?"both":"nextTimeSpan",maxEndDate=maxEndDate<this.timelineEndDate?this.timelineEndDate:maxEndDate):maxEndDate=this.timelineEndDate,isChanged&&this.performTimeSpanAction(isChanged,action,minStartDate,maxEndDate)}performTimeSpanAction(type,isFrom,startDate,endDate,mode){mode=isNullOrUndefined(mode)?"None"===this.parent.timelineModule.topTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier:mode;let projectStartDate=new Date(this.parent.cloneProjectStartDate.getTime()),projectEndDate=new Date(this.parent.cloneProjectEndDate.getTime());"publicMethod"!==isFrom&&"both"===type?(this.updateScheduleDatesByToolBar(mode,"prevTimeSpan",startDate,endDate),this.updateScheduleDatesByToolBar(mode,"nextTimeSpan",new Date(this.parent.cloneProjectStartDate.getTime()),endDate)):this.updateScheduleDatesByToolBar(mode,type,startDate,endDate);let args=this.timeSpanActionEvent("actionBegin",type,isFrom);args.cancel?(this.parent.cloneProjectStartDate=projectStartDate,this.parent.cloneProjectEndDate=projectEndDate):(this.parent.updateProjectDates(args.projectStartDate,args.ProjectEndDate,args.isTimelineRoundOff),"prevTimeSpan"===type&&"publicMethod"===isFrom?this.parent.ganttChartModule.updateScrollLeft(0):"nextTimeSpan"===type&&"publicMethod"===isFrom&&this.parent.ganttChartModule.updateScrollLeft(this.parent.timelineModule.totalTimelineWidth),this.parent.timelineModule.timeSpanActionEvent("actionComplete",type,isFrom))}timeSpanActionEvent(eventType,requestType,isFrom){let args={};return args.projectStartDate=new Date(this.parent.cloneProjectStartDate.getTime()),args.ProjectEndDate=new Date(this.parent.cloneProjectEndDate.getTime()),args.requestType="publicMethod"===isFrom?requestType:"beforeAdd"===isFrom?"TimelineRefreshOnAdd":"TaskbarEditing"===isFrom?"TimelineRefreshOnEdit":requestType,"actionBegin"===eventType&&(args.isTimelineRoundOff=this.parent.isTimelineRoundOff,args.cancel=!1),this.parent.trigger(eventType,args),args}}class ej2_gantt_es2015_Column{constructor(options){this.allowEditing=!0,this.allowReordering=!0,this.allowResizing=!0,this.allowSorting=!0,this.allowFiltering=!0,this.edit={},ej2_base_es2015_merge(this,options)}}class ej2_gantt_es2015_GanttTreeGrid{constructor(parent){this.previousScroll={top:0,left:0},this.queryCellInfo=args=>{this.parent.trigger("queryCellInfo",args)},this.headerCellInfo=args=>{this.parent.trigger("headerCellInfo",args)},this.rowDataBound=args=>{this.parent.trigger("rowDataBound",args)},this.columnMenuOpen=args=>{this.parent.notify("columnMenuOpen",args),this.parent.trigger("columnMenuOpen",args)},this.columnMenuClick=args=>{this.parent.trigger("columnMenuClick",args)},this.parent=parent,this.parent.treeGrid=new ej2_treegrid_es2015_TreeGrid,this.parent.treeGrid.allowSelection=!1,this.treeGridColumns=[],this.validateGanttColumns(),this.addEventListener()}addEventListener(){this.parent.on("renderPanels",this.createContainer,this),this.parent.on("chartScroll",this.updateScrollTop,this),this.parent.on("destroy",this.destroy,this)}createContainer(){this.treeGridElement=ej2_base_es2015_createElement("div",{id:"treeGrid"+this.parent.element.id,className:"e-gantt-tree-grid"});let tempHeader=ej2_base_es2015_createElement("div",{className:"e-gantt-temp-header"});this.parent.treeGridPane.appendChild(this.treeGridElement),this.treeGridElement.appendChild(tempHeader),this.parent.treeGridPane.classList.add("e-temp-content")}renderTreeGrid(){this.composeProperties(),this.bindEvents(),this.parent.treeGrid.appendTo(this.treeGridElement),this.wireEvents()}composeProperties(){this.parent.treeGrid.showColumnMenu=this.parent.showColumnMenu,this.parent.treeGrid.columnMenuItems=this.parent.columnMenuItems,this.parent.treeGrid.childMapping=this.parent.taskFields.child,this.parent.treeGrid.treeColumnIndex=this.parent.treeColumnIndex,this.parent.treeGrid.columns=this.treeGridColumns,this.parent.treeGrid.dataSource=this.parent.flatData,this.parent.treeGrid.rowHeight=this.parent.rowHeight,this.parent.treeGrid.gridLines=this.parent.gridLines,this.parent.treeGrid.searchSettings=this.parent.searchSettings;let toolbarHeight=0;isNullOrUndefined(this.parent.toolbarModule)||isNullOrUndefined(this.parent.toolbarModule.element)||(toolbarHeight=this.parent.toolbarModule.element.offsetHeight),this.parent.treeGrid.height=this.parent.ganttHeight-toolbarHeight-46}getContentDiv(){return this.treeGridElement.querySelector(".e-content")}getHeaderDiv(){return this.treeGridElement.querySelector(".e-headercontent")}getScrollbarWidth(){const outer=document.createElement("div");outer.style.visibility="hidden",outer.style.overflow="scroll",outer.style.msOverflowStyle="scrollbar";const inner=document.createElement("div");outer.appendChild(inner),this.parent.element.appendChild(outer);const scrollbarWidth=outer.offsetWidth-inner.offsetWidth;return outer.parentNode.removeChild(outer),scrollbarWidth}ensureScrollBar(){let content=this.getContentDiv(),headerDiv=this.getHeaderDiv(),scrollWidth=this.getScrollbarWidth(),isMobile=/Android|Mac|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);0!==scrollWidth?content.style.cssText+="width: calc(100% + "+scrollWidth+"px);":content.classList.add("e-gantt-scroll-padding"),0===scrollWidth&&isMobile&&(headerDiv.style.cssText+="width: calc(100% + 17px);")}bindEvents(){this.parent.treeGrid.dataBound=this.dataBound.bind(this),this.parent.treeGrid.collapsing=this.collapsing.bind(this),this.parent.treeGrid.collapsed=this.collapsed.bind(this),this.parent.treeGrid.expanding=this.expanding.bind(this),this.parent.treeGrid.expanded=this.expanded.bind(this),this.parent.treeGrid.actionBegin=this.actionBegin.bind(this),this.parent.treeGrid.actionComplete=this.treeActionComplete.bind(this),this.parent.treeGrid.created=this.created.bind(this),this.parent.treeGrid.actionFailure=this.actionFailure.bind(this),this.parent.treeGrid.queryCellInfo=this.queryCellInfo.bind(this),this.parent.treeGrid.headerCellInfo=this.headerCellInfo.bind(this),this.parent.treeGrid.rowDataBound=this.rowDataBound.bind(this),this.parent.treeGrid.columnMenuOpen=this.columnMenuOpen.bind(this),this.parent.treeGrid.columnMenuClick=this.columnMenuClick.bind(this)}dataBound(args){this.ensureScrollBar(),this.parent.treeDataBound(args)}collapsing(args){let callBackPromise=new Deferred;if(!this.parent.ganttChartModule.isExpandCollapseFromChart){let collapsingArgs=this.createExpandCollapseArgs(args);if(isBlazor())return this.parent.trigger("collapsing",collapsingArgs,args=>{callBackPromise.resolve(args),getValue("cancel",args)||this.parent.ganttChartModule.collapseGanttRow(collapsingArgs,!0)}),callBackPromise;this.parent.ganttChartModule.collapseGanttRow(collapsingArgs),setValue("cancel",getValue("cancel",collapsingArgs),args)}}expanding(args){if(!this.parent.ganttChartModule.isExpandCollapseFromChart){let expandingArgs=this.createExpandCollapseArgs(args);this.parent.ganttChartModule.expandGanttRow(expandingArgs),setValue("cancel",getValue("cancel",expandingArgs),args)}}collapsed(args){if(!this.parent.ganttChartModule.isExpandCollapseFromChart){this.updateExpandStatus(args);let collapsedArgs=this.createExpandCollapseArgs(args);this.parent.ganttChartModule.collapsedGanttRow(collapsedArgs)}}expanded(args){if(!this.parent.ganttChartModule.isExpandCollapseFromChart){this.updateExpandStatus(args);let expandedArgs=this.createExpandCollapseArgs(args);this.parent.ganttChartModule.expandedGanttRow(expandedArgs)}}updateExpandStatus(args){getValue("data",args)&&isBlazor()&&(this.parent.getTaskByUniqueID(getValue("data",args).uniqueID).expanded=getValue("data",args).expanded)}actionBegin(args){this.parent.notify("actionBegin",args),this.parent.trigger("actionBegin",args)}created(args){this.updateKeyConfigSettings()}actionFailure(args){this.parent.trigger("actionFailure",args)}createExpandCollapseArgs(args){let chartRow,record=getValue("data",args);return{data:record,gridRow:getValue("row",args),chartRow:chartRow=isBlazor()?this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(this.parent.getTaskByUniqueID(record.uniqueID))]:this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(record)],cancel:!1}}treeActionComplete(args){let updatedArgs=extend({},args,!0);"sorting"===getValue("requestType",args)?(this.parent.notify("updateModel",{}),deleteObject(updatedArgs,"isFrozen")):"filtering"===getValue("requestType",args)?(this.parent.notify("updateModel",{}),this.parent.element.querySelector(".e-treegrid").focus()):"save"===getValue("type",args)&&this.parent.editModule&&this.parent.editModule.cellEditModule&&(this.parent.editModule.cellEditModule.initiateCellEdit(args,this.currentEditRow),this.currentEditRow={}),"filterafteropen"===getValue("requestType",args)&&this.parent.notify("actionComplete",args),"searching"===getValue("requestType",args)&&this.parent.notify("actionComplete",args),isNullOrUndefined(getValue("batchChanges",args))||isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),this.parent.trigger("actionComplete",updatedArgs)}updateKeyConfigSettings(){delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.delete,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.insert,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.upArrow,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.downArrow,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.ctrlHome,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.ctrlEnd,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.enter,delete this.parent.treeGrid.keyboardModule.keyConfigs.enter,delete this.parent.treeGrid.keyboardModule.keyConfigs.upArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.downArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlShiftUpArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlShiftDownArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlUpArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlDownArrow}wireEvents(){let content=this.parent.treeGrid.element.querySelector(".e-content");content&&EventHandler.add(content,"scroll",this.scrollHandler,this),this.parent.isAdaptive&&EventHandler.add(this.parent.treeGridPane,"click",this.treeGridClickHandler,this)}unWireEvents(){let content=this.parent.treeGrid.element&&this.parent.treeGrid.element.querySelector(".e-content");content&&EventHandler.remove(content,"scroll",this.scrollHandler),this.parent.isAdaptive&&EventHandler.remove(this.parent.treeGridPane,"click",this.treeGridClickHandler)}scrollHandler(e){let content=this.parent.treeGrid.element.querySelector(".e-content");content.scrollTop!==this.previousScroll.top&&this.parent.notify("grid-scroll",{top:content.scrollTop}),this.previousScroll.top=content.scrollTop}validateGanttColumns(){let ganttObj=this.parent,length=ganttObj.columns.length,tasks=this.parent.taskFields;this.parent.columnMapping={},this.parent.columnByField={},this.parent.customColumns=[];let tasksMapping=["id","name","startDate","endDate","duration","dependency","progress","baselineStartDate","baselineEndDate","resourceInfo","notes"];for(let i=0;i<length;i++){let column={};"string"==typeof ganttObj.columns[i]?column.field=ganttObj.columns[i]:column=ganttObj.columns[i];let columnName=[];if(tasksMapping.length>0&&(columnName=tasksMapping.filter(name=>column.field===tasks[name])),0!==columnName.length){let index=tasksMapping.indexOf(columnName[0]);tasksMapping.splice(index,1),this.createTreeGridColumn(column,!0),this.parent.columnMapping[columnName[0]]=column.field}else this.parent.customColumns.push(column.field),column.headerText=column.headerText?column.headerText:column.field,column.width=column.width?column.width:150,column.editType=column.editType?column.editType:"stringedit",column.type=column.type?column.type:"string",this.bindTreeGridColumnProperties(column,!0)}for(let j=0;j<tasksMapping.length;j++){let column={};isNullOrUndefined(tasks[tasksMapping[j]])||(column.field=tasks[tasksMapping[j]],this.createTreeGridColumn(column,0===length),this.parent.columnMapping[tasksMapping[j]]=column.field)}}createTreeGridColumn(column,isDefined){let taskSettings=this.parent.taskFields;taskSettings.id!==column.field&&(column.clipMode=column.clipMode?column.clipMode:"EllipsisWithTooltip"),taskSettings.id===column.field?this.composeIDColumn(column):taskSettings.name===column.field?(column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("name"),column.width=column.width?column.width:150,column.editType=column.editType?column.editType:"stringedit",column.type=column.type?column.type:"string"):taskSettings.startDate===column.field?(column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("startDate"),column.format=column.format?column.format:{type:"date",format:this.parent.dateFormat},column.editType=column.editType?column.editType:-1!==this.parent.dateFormat.toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit",column.width=column.width?column.width:150,this.initiateFiltering(column)):taskSettings.endDate===column.field?(column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("endDate"),column.format=column.format?column.format:{type:"date",format:this.parent.dateFormat},column.editType=column.editType?column.editType:-1!==this.parent.dateFormat.toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit",this.initiateFiltering(column),column.width=column.width?column.width:150):taskSettings.duration===column.field?(column.width=column.width?column.width:150,column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("duration"),column.valueAccessor=column.valueAccessor?column.valueAccessor:this.durationValueAccessor.bind(this),column.editType=column.editType?column.editType:"stringedit",column.type="string",this.initiateFiltering(column)):taskSettings.progress===column.field?this.composeProgressColumn(column):taskSettings.dependency===column.field?(column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("dependency"),column.width=column.width?column.width:150,column.editType=column.editType?column.editType:"stringedit",column.type="string",column.allowFiltering=!1!==column.allowFiltering):taskSettings.resourceInfo===column.field?this.composeResourceColumn(column):taskSettings.notes===column.field?(column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("notes"),column.width=column.width?column.width:150,column.editType=column.editType?column.editType:"stringedit",this.parent.showInlineNotes?column.disableHtmlEncode=!0:column.template||(column.template='<div class="e-ganttnotes-info"><span class="e-icons e-notes-info"></span></div>')):taskSettings.baselineStartDate===column.field?(column.width=column.width?column.width:150,column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("baselineStartDate"),column.format=column.format?column.format:{type:"date",format:this.parent.dateFormat},column.editType=column.editType?column.editType:-1!==this.parent.dateFormat.toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit",this.initiateFiltering(column)):taskSettings.baselineEndDate===column.field&&(column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("baselineEndDate"),column.width=column.width?column.width:150,column.format=column.format?column.format:{type:"date",format:this.parent.dateFormat},column.editType=column.editType?column.editType:-1!==this.parent.dateFormat.toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit",this.initiateFiltering(column)),this.bindTreeGridColumnProperties(column,isDefined)}composeResourceColumn(column){column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("resourceName"),column.width=column.width?column.width:150,column.type="string",column.valueAccessor=column.valueAccessor?column.valueAccessor:this.resourceValueAccessor.bind(this),this.parent.editSettings.allowEditing&&isNullOrUndefined(column.edit)&&"Auto"===this.parent.editSettings.mode&&(column.editType="dropdownedit",column.edit=this.getResourceEditor()),column.allowFiltering=!1!==column.allowFiltering}getResourceIds(data){return getValue(this.parent.taskFields.resourceInfo,data.taskData)}getResourceEditor(){let editor,editObject={};return ej2_dropdowns_es2015_MultiSelect.Inject(ej2_dropdowns_es2015_CheckBoxSelection),editObject.write=args=>{this.currentEditRow={},(editor=new ej2_dropdowns_es2015_MultiSelect({dataSource:new ej2_data_es2015_DataManager(this.parent.resources),fields:{text:this.parent.resourceNameMapping,value:this.parent.resourceIDMapping},mode:"CheckBox",showDropDownIcon:!0,popupHeight:"350px",delimiterChar:",",value:this.getResourceIds(args.rowData)})).appendTo(args.element)},editObject.read=element=>{let value=element.ej2_instances[0].value,resourcesName=[];isNullOrUndefined(value)&&(value=[]);for(let i=0;i<value.length;i++)for(let j=0;j<this.parent.resources.length;j++)if(this.parent.resources[j][this.parent.resourceIDMapping]===value[i]){resourcesName.push(this.parent.resources[j][this.parent.resourceNameMapping]);break}return this.currentEditRow[this.parent.taskFields.resourceInfo]=value,resourcesName.join(",")},editObject.destroy=()=>{editor&&editor.destroy()},editObject}composeIDColumn(column){column.isPrimaryKey=!!isNullOrUndefined(column.isPrimaryKey)||column.isPrimaryKey,column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("id"),column.width=column.width?column.width:100,column.allowEditing=!1,column.editType=column.editType?column.editType:"numericedit",isNullOrUndefined(column.edit)?(column.edit={},column.edit.params={}):isNullOrUndefined(column.edit.params)&&(column.edit.params={}),extend(column.edit.params,{min:0,decimals:0,validateDecimalOnType:!0,format:"n0",showSpinButton:!1})}composeProgressColumn(column){column.headerText=column.headerText?column.headerText:this.parent.localeObj.getConstant("progress"),column.width=column.width?column.width:150,column.editType=column.editType?column.editType:"numericedit",isNullOrUndefined(column.edit)?(column.edit={},column.edit.params={}):isNullOrUndefined(column.edit.params)&&(column.edit.params={}),extend(column.edit.params,{min:0,max:100,decimals:0,validateDecimalOnType:!0,format:"n0"})}initiateFiltering(column){column.allowFiltering=!1!==column.allowFiltering,column.allowFiltering&&"Menu"===this.parent.filterSettings.type&&!column.filter&&(column.filter={ui:this.getCustomFilterUi(column)})}getCustomFilterUi(column){let settings=this.parent.taskFields,filterUI={};return"datepickeredit"!==column.editType||column.field!==settings.startDate&&column.field!==settings.endDate&&column.field!==settings.baselineStartDate&&column.field!==settings.baselineEndDate?"datetimepickeredit"!==column.editType||column.field!==settings.startDate&&column.field!==settings.endDate&&column.field!==settings.baselineStartDate&&column.field!==settings.baselineEndDate?column.field===settings.duration&&"stringedit"===column.editType&&(filterUI=this.getDurationFilter()):filterUI=this.getDateTimePickerFilter():filterUI=this.getDatePickerFilter(column.field),filterUI}getDatePickerFilter(columnName){let dropDateInstance,parent=this.parent,timeValue=columnName===parent.taskFields.startDate||columnName===parent.taskFields.baselineStartDate?parent.defaultStartTime:parent.defaultEndTime;return{create:args=>{let flValInput=ej2_base_es2015_createElement("input",{className:"flm-input"});args.target.appendChild(flValInput),(dropDateInstance=new ej2_calendars_es2015_DatePicker({placeholder:this.parent.localeObj.getConstant("enterValue")})).appendTo(flValInput)},write:args=>{dropDateInstance.value=args.filteredValue},read:args=>{dropDateInstance.value&&dropDateInstance.value.setSeconds(timeValue),args.fltrObj.filterByColumn(args.column.field,args.operator,dropDateInstance.value)}}}getDateTimePickerFilter(){let dropInstance;return{create:args=>{let flValInput=ej2_base_es2015_createElement("input",{className:"flm-input"});args.target.appendChild(flValInput),(dropInstance=new ej2_calendars_es2015_DateTimePicker({placeholder:this.parent.localeObj.getConstant("enterValue")})).appendTo(flValInput)},write:args=>{dropInstance.value=args.filteredValue},read:args=>{args.fltrObj.filterByColumn(args.column.field,args.operator,dropInstance.value)}}}getDurationFilter(){let textBoxInstance,parent=this.parent,textValue="";return{create:args=>{let flValInput=ej2_base_es2015_createElement("input",{className:"e-input"});flValInput.setAttribute("placeholder",this.parent.localeObj.getConstant("enterValue")),args.target.appendChild(flValInput),(textBoxInstance=new ej2_inputs_es2015_TextBox).appendTo(flValInput)},write:args=>{textBoxInstance.value=args.filteredValue?textValue:""},read:args=>{let durationObj=this.parent.dataOperation.getDurationValue(textBoxInstance.value),intVal=getValue("duration",durationObj),unit=getValue("durationUnit",durationObj);if(intVal>=0){let dayVal;"minute"===unit?dayVal=60*intVal/parent.secondsPerDay:"hour"===unit?dayVal=60*intVal*60/parent.secondsPerDay:(dayVal=intVal,unit="day"),args.fltrObj.filterByColumn(args.column.field,args.operator,dayVal),textValue=this.parent.dataOperation.getDurationString(intVal,unit)}else args.fltrObj.filterByColumn(args.column.field,args.operator,null),textValue=null}}}bindTreeGridColumnProperties(newGanttColumn,isDefined){let treeGridColumn={},ganttColumn={};for(let prop of Object.keys(newGanttColumn))treeGridColumn[prop]=ganttColumn[prop]=newGanttColumn[prop];this.parent.columnByField[ganttColumn.field]=ganttColumn,this.parent.ganttColumns.push(new ej2_gantt_es2015_Column(ganttColumn)),isDefined&&this.treeGridColumns.push(treeGridColumn)}durationValueAccessor(field,data,column){let ganttProp=data.ganttProperties;return isNullOrUndefined(ganttProp)?"":this.parent.dataOperation.getDurationString(ganttProp.duration,ganttProp.durationUnit)}resourceValueAccessor(field,data,column){let ganttProp=data.ganttProperties;return isNullOrUndefined(ganttProp)?"":ganttProp.resourceNames}updateScrollTop(args){this.treeGridElement.querySelector(".e-content").scrollTop=getValue("top",args),this.previousScroll.top=this.treeGridElement.querySelector(".e-content").scrollTop}treeGridClickHandler(e){this.parent.notify("treeGridClick",e)}removeEventListener(){this.parent.off("renderPanels",this.createContainer),this.parent.off("chartScroll",this.updateScrollTop),this.parent.off("destroy",this.destroy)}destroy(){this.removeEventListener(),this.unWireEvents(),this.parent.treeGrid.element&&this.parent.treeGrid.destroy()}}let ej2_gantt_es2015_DayWorkingTime=(()=>{class DayWorkingTime extends ChildProperty{}return __decorate([Property(null)],DayWorkingTime.prototype,"from",void 0),__decorate([Property(null)],DayWorkingTime.prototype,"to",void 0),DayWorkingTime})(),ej2_gantt_es2015_EditSettings=(()=>{class EditSettings extends ChildProperty{}return __decorate([Property(!1)],EditSettings.prototype,"allowEditing",void 0),__decorate([Property(!1)],EditSettings.prototype,"allowAdding",void 0),__decorate([Property(!1)],EditSettings.prototype,"allowDeleting",void 0),__decorate([Property("Auto")],EditSettings.prototype,"mode",void 0),__decorate([Property("Top")],EditSettings.prototype,"newRowPosition",void 0),__decorate([Property(!1)],EditSettings.prototype,"showDeleteConfirmDialog",void 0),__decorate([Property(!1)],EditSettings.prototype,"allowTaskbarEditing",void 0),EditSettings})(),ej2_gantt_es2015_EventMarker=(()=>{class EventMarker extends ChildProperty{}return __decorate([Property(null)],EventMarker.prototype,"day",void 0),__decorate([Property(null)],EventMarker.prototype,"label",void 0),__decorate([Property(null)],EventMarker.prototype,"cssClass",void 0),EventMarker})(),ej2_gantt_es2015_FilterSettings=(()=>{class FilterSettings extends ChildProperty{}return __decorate([Collection([],ej2_grids_es2015_Predicate$1)],FilterSettings.prototype,"columns",void 0),__decorate([Property("Menu")],FilterSettings.prototype,"type",void 0),__decorate([Property()],FilterSettings.prototype,"operators",void 0),__decorate([Property(!1)],FilterSettings.prototype,"ignoreAccent",void 0),__decorate([Property("Parent")],FilterSettings.prototype,"hierarchyMode",void 0),FilterSettings})(),ej2_gantt_es2015_SearchSettings=(()=>{class SearchSettings extends ChildProperty{}return __decorate([Property([])],SearchSettings.prototype,"fields",void 0),__decorate([Property(!1)],SearchSettings.prototype,"ignoreCase",void 0),__decorate([Property("contains")],SearchSettings.prototype,"operator",void 0),__decorate([Property("")],SearchSettings.prototype,"key",void 0),__decorate([Property("Parent")],SearchSettings.prototype,"hierarchyMode",void 0),SearchSettings})(),ej2_gantt_es2015_Holiday=(()=>{class Holiday extends ChildProperty{}return __decorate([Property(null)],Holiday.prototype,"from",void 0),__decorate([Property(null)],Holiday.prototype,"to",void 0),__decorate([Property(null)],Holiday.prototype,"label",void 0),__decorate([Property(null)],Holiday.prototype,"cssClass",void 0),Holiday})(),ej2_gantt_es2015_LabelSettings=(()=>{class LabelSettings extends ChildProperty{}return __decorate([Property(null)],LabelSettings.prototype,"rightLabel",void 0),__decorate([Property(null)],LabelSettings.prototype,"leftLabel",void 0),__decorate([Property(null)],LabelSettings.prototype,"taskLabel",void 0),LabelSettings})(),ej2_gantt_es2015_SelectionSettings=(()=>{class SelectionSettings extends ChildProperty{}return __decorate([Property("Row")],SelectionSettings.prototype,"mode",void 0),__decorate([Property("Flow")],SelectionSettings.prototype,"cellSelectionMode",void 0),__decorate([Property("Single")],SelectionSettings.prototype,"type",void 0),__decorate([Property(!1)],SelectionSettings.prototype,"persistSelection",void 0),SelectionSettings})(),ej2_gantt_es2015_SplitterSettings=(()=>{class SplitterSettings extends ChildProperty{}return __decorate([Property(null)],SplitterSettings.prototype,"position",void 0),__decorate([Property(-1)],SplitterSettings.prototype,"columnIndex",void 0),__decorate([Property(4)],SplitterSettings.prototype,"separatorSize",void 0),__decorate([Property(null)],SplitterSettings.prototype,"minimum",void 0),__decorate([Property("Default")],SplitterSettings.prototype,"view",void 0),SplitterSettings})(),ej2_gantt_es2015_TaskFields=(()=>{class TaskFields extends ChildProperty{}return __decorate([Property(null)],TaskFields.prototype,"id",void 0),__decorate([Property(null)],TaskFields.prototype,"name",void 0),__decorate([Property(null)],TaskFields.prototype,"parentID",void 0),__decorate([Property(null)],TaskFields.prototype,"startDate",void 0),__decorate([Property(null)],TaskFields.prototype,"endDate",void 0),__decorate([Property(null)],TaskFields.prototype,"dependency",void 0),__decorate([Property(null)],TaskFields.prototype,"progress",void 0),__decorate([Property(null)],TaskFields.prototype,"child",void 0),__decorate([Property(null)],TaskFields.prototype,"milestone",void 0),__decorate([Property(null)],TaskFields.prototype,"duration",void 0),__decorate([Property(null)],TaskFields.prototype,"durationUnit",void 0),__decorate([Property(null)],TaskFields.prototype,"cssClass",void 0),__decorate([Property(null)],TaskFields.prototype,"baselineStartDate",void 0),__decorate([Property(null)],TaskFields.prototype,"baselineEndDate",void 0),__decorate([Property(null)],TaskFields.prototype,"resourceInfo",void 0),__decorate([Property(null)],TaskFields.prototype,"expandState",void 0),__decorate([Property(null)],TaskFields.prototype,"indicators",void 0),__decorate([Property(null)],TaskFields.prototype,"notes",void 0),TaskFields})(),ej2_gantt_es2015_TimelineTierSettings=(()=>{class TimelineTierSettings extends ChildProperty{}return __decorate([Property("")],TimelineTierSettings.prototype,"format",void 0),__decorate([Property("None")],TimelineTierSettings.prototype,"unit",void 0),__decorate([Property(1)],TimelineTierSettings.prototype,"count",void 0),__decorate([Property(null)],TimelineTierSettings.prototype,"formatter",void 0),TimelineTierSettings})(),ej2_gantt_es2015_TimelineSettings=(()=>{class TimelineSettings extends ChildProperty{}return __decorate([Property("Week")],TimelineSettings.prototype,"timelineViewMode",void 0),__decorate([Complex({},ej2_gantt_es2015_TimelineTierSettings)],TimelineSettings.prototype,"topTier",void 0),__decorate([Complex({},ej2_gantt_es2015_TimelineTierSettings)],TimelineSettings.prototype,"bottomTier",void 0),__decorate([Property(33)],TimelineSettings.prototype,"timelineUnitSize",void 0),__decorate([Property(0)],TimelineSettings.prototype,"weekStartDay",void 0),__decorate([Property(null)],TimelineSettings.prototype,"weekendBackground",void 0),__decorate([Property(!0)],TimelineSettings.prototype,"showTooltip",void 0),__decorate([Property(!0)],TimelineSettings.prototype,"updateTimescaleView",void 0),TimelineSettings})(),ej2_gantt_es2015_TooltipSettings=(()=>{class TooltipSettings extends ChildProperty{}return __decorate([Property(!0)],TooltipSettings.prototype,"showTooltip",void 0),__decorate([Property()],TooltipSettings.prototype,"taskbar",void 0),__decorate([Property()],TooltipSettings.prototype,"baseline",void 0),__decorate([Property()],TooltipSettings.prototype,"connectorLine",void 0),__decorate([Property()],TooltipSettings.prototype,"editing",void 0),TooltipSettings})(),ej2_gantt_es2015_SortDescriptor=(()=>{class SortDescriptor extends ChildProperty{}return __decorate([Property()],SortDescriptor.prototype,"field",void 0),__decorate([Property()],SortDescriptor.prototype,"direction",void 0),SortDescriptor})(),ej2_gantt_es2015_SortSettings=(()=>{class SortSettings extends ChildProperty{}return __decorate([Collection([],ej2_gantt_es2015_SortDescriptor)],SortSettings.prototype,"columns",void 0),__decorate([Property(!0)],SortSettings.prototype,"allowUnsort",void 0),SortSettings})();class ej2_gantt_es2015_ChartRows{constructor(ganttObj){this.taskBarHeight=0,this.milestoneHeight=0,this.milesStoneRadius=0,this.baselineTop=0,this.baselineHeight=3,this.touchLeftConnectorpoint="",this.touchRightConnectorpoint="",this.parent=ganttObj,this.initPublicProp(),this.addEventListener()}initPublicProp(){this.ganttChartTableBody=null}addEventListener(){this.parent.on("renderPanels",this.createChartTable,this),this.parent.on("dataReady",this.initiateTemplates,this),this.parent.on("destroy",this.destroy,this)}refreshChartByTimeline(){this.taskTable.style.width=formatUnit(this.parent.timelineModule.totalTimelineWidth),this.refreshGanttRows()}createChartTable(){this.taskTable=ej2_base_es2015_createElement("table",{className:taskTable+" "+zeroSpacing,id:"GanttTaskTable"+this.parent.element.id,styles:"z-index: 2;position: absolute;width:"+this.parent.timelineModule.totalTimelineWidth+"px;",attrs:{cellspacing:"0.25px"}});let colgroup=ej2_base_es2015_createElement("colgroup"),column=ej2_base_es2015_createElement("col",{styles:"width:"+this.parent.timelineModule.totalTimelineWidth+"px;"});colgroup.appendChild(column),this.taskTable.appendChild(colgroup),this.ganttChartTableBody=ej2_base_es2015_createElement("tbody",{id:this.parent.element.id+"GanttTaskTableBody"}),this.taskTable.appendChild(this.ganttChartTableBody),this.parent.ganttChartModule.chartBodyContent.appendChild(this.taskTable)}initiateTemplates(){this.taskTable.style.width=formatUnit(this.parent.timelineModule.totalTimelineWidth),this.initChartHelperPrivateVariable(),this.initializeChartTemplate()}renderChartRows(){this.createTaskbarTemplate(),this.triggerQueryTaskbarInfo(),this.parent.isGanttChartRendered=!0}getIndicatorNode(indicator){let templateString='<label class="'+taskIndicatorDiv+'"  style="line-height:'+this.parent.rowHeight+"px;left:"+this.getIndicatorleft(indicator.date)+'px;"><i class="'+indicator.iconClass+'"></i> </label>';return this.createDivElement(templateString)}getIndicatorleft(date){return date=this.parent.dateValidationModule.getDateFromFormat(date),this.parent.dataOperation.getTaskLeft(date,!1)}getChildTaskbarNode(i){let childTaskbarNode=null,data=this.templateData;if(this.childTaskbarTemplateFunction)childTaskbarNode=this.childTaskbarTemplateFunction(extend({index:i},data),this.parent,"TaskbarTemplate",this.getTemplateID("TaskbarTemplate"),!1);else{let labelString="";if(this.taskLabelTemplateFunction){let taskLabelTemplateNode=this.taskLabelTemplateFunction(extend({index:i},data),this.parent,"TaskLabelTemplate",this.getTemplateID("TaskLabelTemplate"),!1),tempDiv=ej2_base_es2015_createElement("div");tempDiv.appendChild(taskLabelTemplateNode[0]),labelString=tempDiv.innerHTML}else labelString="isCustomTemplate"===(labelString=this.getTaskLabel(this.parent.labelSettings.taskLabel))?this.parent.labelSettings.taskLabel:labelString;let template=data.ganttProperties.startDate&&data.ganttProperties.endDate&&data.ganttProperties.duration?'<div class="'+childTaskBarInnerDiv+" "+traceChildTaskBar+'"style="width:'+data.ganttProperties.width+"px;height:"+this.taskBarHeight+'px;"><div class="'+childProgressBarInnerDiv+" "+traceChildProgressBar+'" style="border-style:'+(data.ganttProperties.progressWidth?"solid;":"none;")+"width:"+data.ganttProperties.progressWidth+"px;height:100%;border-top-right-radius:"+this.getBorderRadius(data.ganttProperties)+"px;border-bottom-right-radius:"+this.getBorderRadius(data.ganttProperties)+'px;"><span class="'+taskLabel+'" style="line-height:'+(this.taskBarHeight-1)+"px;height:"+this.taskBarHeight+'px;">'+labelString+"</span></div></div>":!data.ganttProperties.startDate||data.ganttProperties.endDate||data.ganttProperties.duration?!data.ganttProperties.endDate||data.ganttProperties.startDate||data.ganttProperties.duration?!data.ganttProperties.duration||data.ganttProperties.startDate||data.ganttProperties.endDate?"":'<div class="'+childProgressBarInnerDiv+" "+traceChildTaskBar+" "+unscheduledTaskbar+'"style="left:'+data.ganttProperties.left+"px; width:"+data.ganttProperties.width+"px; height:"+this.taskBarHeight+'px;"></div>':'<div class="'+childProgressBarInnerDiv+" "+traceChildTaskBar+" "+unscheduledTaskbarRight+'"style="left:'+data.ganttProperties.left+"px; height:"+this.taskBarHeight+'px;"></div>':'<div class="'+childProgressBarInnerDiv+" "+traceChildTaskBar+" "+unscheduledTaskbarLeft+'"style="left:'+data.ganttProperties.left+"px; height:"+this.taskBarHeight+'px;"></div>';childTaskbarNode=this.createDivElement(template)}return childTaskbarNode}getMilestoneNode(i){let data=this.templateData;return this.milestoneTemplateFunction?this.milestoneTemplateFunction(extend({index:i},data),this.parent,"MilestoneTemplate",this.getTemplateID("MilestoneTemplate"),!1):this.createDivElement('<div class="'+traceMilestone+'" style="position:absolute;"><div class="'+milestoneTop+(data.ganttProperties.startDate||data.ganttProperties.endDate?'"':unscheduledMilestoneTop)+'" style="border-right-width:'+this.milesStoneRadius+"px;border-left-width:"+this.milesStoneRadius+"px;border-bottom-width:"+this.milesStoneRadius+'px;"></div><div class="'+milestoneBottom+(data.ganttProperties.startDate||data.ganttProperties.endDate?'"':unscheduledMilestoneBottom)+'" style="top:'+this.milesStoneRadius+"px;border-right-width:"+this.milesStoneRadius+"px; border-left-width:"+this.milesStoneRadius+"px; border-top-width:"+this.milesStoneRadius+'px;"></div></div>')}getTaskBaselineNode(){let data=this.templateData;return this.createDivElement('<div class="'+baselineBar+' " style="margin-top:'+this.baselineTop+"px;left:"+data.ganttProperties.baselineLeft+"px;width:"+data.ganttProperties.baselineWidth+"px;height:"+this.baselineHeight+"px;"+(this.baselineColor?"background-color: "+this.baselineColor+";":"")+'"></div>')}getMilestoneBaselineNode(){let template='<div class="'+baselineMilestoneContainer+' " style="left:'+(this.templateData.ganttProperties.baselineLeft-this.milesStoneRadius)+"px;margin-top:"+(2-Math.floor(this.parent.rowHeight-this.milestoneMarginTop))+'px"><div class="'+baselineMilestoneDiv+'"><div class="'+baselineMilestoneDiv+" "+baselineMilestoneTop+'"  style="top:'+-this.milestoneHeight+"px;border-right:"+this.milesStoneRadius+"px solid transparent;border-left:"+this.milesStoneRadius+"px solid transparent;border-top:0pxsolid transparent;border-bottom-width:"+this.milesStoneRadius+"px;border-bottom-style: solid;"+(this.baselineColor?"border-bottom-color: "+this.baselineColor+";":"")+'"></div><div class="'+baselineMilestoneDiv+" "+baselineMilestoneBottom+'"  style="top:'+(this.milesStoneRadius-this.milestoneHeight)+"px;border-right:"+this.milesStoneRadius+"px solid transparent;border-left:"+this.milesStoneRadius+"px solid transparent;border-bottom:0pxsolid transparent;border-top-width:"+this.milesStoneRadius+"px;border-top-style: solid;"+(this.baselineColor?"border-top-color: "+this.baselineColor+";":"")+'"></div></div></div>';return this.createDivElement(template)}getLeftLabelNode(i){let leftLabelNode=this.leftLabelContainer(),leftLabelTemplateNode=null;if(this.leftTaskLabelTemplateFunction)leftLabelTemplateNode=this.leftTaskLabelTemplateFunction(extend({index:i},this.templateData),this.parent,"LeftLabelTemplate",this.getTemplateID("LeftLabelTemplate"),!1);else{let field=this.parent.labelSettings.leftLabel,labelString=this.getTaskLabel(field);labelString&&(leftLabelTemplateNode=this.createDivElement('<div class="'+leftLabelInnerDiv+'"  style="height:'+this.taskBarHeight+"px;margin-top:"+this.taskBarMarginTop+'px;"><span class="'+ej2_gantt_es2015_label+'">'+(labelString="isCustomTemplate"===labelString?field:labelString)+"</span></div>"))}return leftLabelTemplateNode&&leftLabelTemplateNode.length>0&&leftLabelNode[0].appendChild([].slice.call(leftLabelTemplateNode)[0]),leftLabelNode}getRightLabelNode(i){let rightLabelNode=this.rightLabelContainer(),rightLabelTemplateNode=null;if(this.rightTaskLabelTemplateFunction)rightLabelTemplateNode=this.rightTaskLabelTemplateFunction(extend({index:i},this.templateData),this.parent,"RightLabelTemplate",this.getTemplateID("RightLabelTemplate"),!1);else{let field=this.parent.labelSettings.rightLabel,labelString=this.getTaskLabel(field);labelString&&(rightLabelTemplateNode=this.createDivElement('<div class="'+rightLabelInnerDiv+'"  style="height:'+this.taskBarHeight+"px;margin-top:"+this.taskBarMarginTop+'px;"><span class="'+ej2_gantt_es2015_label+'">'+(labelString="isCustomTemplate"===labelString?field:labelString)+"</span></div>"))}return rightLabelTemplateNode&&rightLabelTemplateNode.length>0&&rightLabelNode[0].appendChild([].slice.call(rightLabelTemplateNode)[0]),rightLabelNode}getParentTaskbarNode(i){let parentTaskbarNode=null,data=this.templateData;if(this.parentTaskbarTemplateFunction)parentTaskbarNode=this.parentTaskbarTemplateFunction(extend({index:i},data),this.parent,"ParentTaskbarTemplate",this.getTemplateID("ParentTaskbarTemplate"),!1);else{let labelString="";if(this.taskLabelTemplateFunction){let parentTaskLabelNode=this.taskLabelTemplateFunction(extend({index:i},data),this.parent,"TaskLabelTemplate",this.getTemplateID("TaskLabelTemplate"),!1),div=ej2_base_es2015_createElement("div");div.appendChild(parentTaskLabelNode[0]),labelString=div.innerHTML}else labelString="isCustomTemplate"===(labelString=this.getTaskLabel(this.parent.labelSettings.taskLabel))?this.parent.labelSettings.taskLabel:labelString;let template='<div class="'+parentTaskBarInnerDiv+" "+this.getExpandClass(data)+" "+traceParentTaskBar+'" style="width:'+data.ganttProperties.width+"px;height:"+this.taskBarHeight+'px;"><div class="'+parentProgressBarInnerDiv+" "+this.getExpandClass(data)+" "+traceParentProgressBar+'" style="border-style:'+(data.ganttProperties.progressWidth?"solid;":"none;")+"width:"+data.ganttProperties.progressWidth+"px;border-top-right-radius:"+this.getBorderRadius(data)+"px;border-bottom-right-radius:"+this.getBorderRadius(data)+'px;height:100%;"><span class="'+taskLabel+'" style="line-height:'+(this.taskBarHeight-1)+"px;height:"+this.taskBarHeight+'px;">'+labelString+"</span></div></div>";parentTaskbarNode=this.createDivElement(template)}return parentTaskbarNode}getTableTrNode(){let table=ej2_base_es2015_createElement("table"),className="Horizontal"===this.parent.gridLines||"Both"===this.parent.gridLines?"e-chart-row-border":"";return table.innerHTML='<tr class="'+this.getRowClassName(this.templateData)+" "+ej2_gantt_es2015_chartRow+'"style="display:'+this.getExpandDisplayProp(this.templateData)+";height:"+this.parent.rowHeight+'px;"><td class="'+chartRowCell+" "+className+'" style="width:'+this.parent.timelineModule.totalTimelineWidth+'px;"></td></tr>',table.childNodes}initializeChartTemplate(){isNullOrUndefined(this.parent.parentTaskbarTemplate)||(this.parentTaskbarTemplateFunction=this.templateCompiler(this.parent.parentTaskbarTemplate)),!isNullOrUndefined(this.parent.labelSettings.leftLabel)&&this.isTemplate(this.parent.labelSettings.leftLabel)&&(this.leftTaskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.leftLabel)),!isNullOrUndefined(this.parent.labelSettings.rightLabel)&&this.isTemplate(this.parent.labelSettings.rightLabel)&&(this.rightTaskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.rightLabel)),!isNullOrUndefined(this.parent.labelSettings.taskLabel)&&this.isTemplate(this.parent.labelSettings.taskLabel)&&(this.taskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.taskLabel)),isNullOrUndefined(this.parent.taskbarTemplate)||(this.childTaskbarTemplateFunction=this.templateCompiler(this.parent.taskbarTemplate)),isNullOrUndefined(this.parent.milestoneTemplate)||(this.milestoneTemplateFunction=this.templateCompiler(this.parent.milestoneTemplate))}createDivElement(template){let div=ej2_base_es2015_createElement("div");return div.innerHTML=template,div.childNodes}isTemplate(template){let result=!1;return"string"!=typeof template?result=!0:(0===template.indexOf("#")||template.indexOf("<div")>-1||template.indexOf("$")>-1)&&(result=!0),result}getTemplateID(templateName){return this.parent.element.id+templateName}updateTaskbarBlazorTemplate(isUpdate,ganttData){let isMilestone=!0,isParent=!0,isChild=!0;ganttData&&(ganttData.ganttProperties.isMilestone?isParent=isChild=!1:ganttData.hasChildRecords?isMilestone=isChild=!1:ganttData.hasChildRecords||(isParent=isMilestone=!1)),this.parentTaskbarTemplateFunction&&isParent&&(isUpdate?updateBlazorTemplate(this.getTemplateID("ParentTaskbarTemplate"),"ParentTaskbarTemplate",this.parent):resetBlazorTemplate(this.getTemplateID("ParentTaskbarTemplate"))),this.childTaskbarTemplateFunction&&isChild&&(isUpdate?updateBlazorTemplate(this.getTemplateID("TaskbarTemplate"),"TaskbarTemplate",this.parent):resetBlazorTemplate(this.getTemplateID("TaskbarTemplate"))),this.milestoneTemplateFunction&&isMilestone&&(isUpdate?updateBlazorTemplate(this.getTemplateID("MilestoneTemplate"),"MilestoneTemplate",this.parent):resetBlazorTemplate(this.getTemplateID("MilestoneTemplate"))),this.leftTaskLabelTemplateFunction&&(isUpdate?updateBlazorTemplate(this.getTemplateID("LeftLabelTemplate"),"LeftLabelTemplate",this.parent.labelSettings):resetBlazorTemplate(this.getTemplateID("LeftLabelTemplate"))),this.rightTaskLabelTemplateFunction&&(isUpdate?updateBlazorTemplate(this.getTemplateID("RightLabelTemplate"),"RightLabelTemplate",this.parent.labelSettings):resetBlazorTemplate(this.getTemplateID("RightLabelTemplate"))),this.taskLabelTemplateFunction&&(isParent||isChild)&&(isUpdate?updateBlazorTemplate(this.getTemplateID("TaskLabelTemplate"),"TaskLabelTemplate",this.parent.labelSettings):resetBlazorTemplate(this.getTemplateID("TaskLabelTemplate")))}leftLabelContainer(){let template='<div class="'+(this.leftTaskLabelTemplateFunction?leftLabelTempContainer:leftLabelContainer)+' " tabindex="-1" '+this.generateTaskLabelAriaLabel("left")+'  style="height:'+(this.parent.rowHeight-1)+"px;width:"+this.taskNameWidth(this.templateData)+'"></div>';return this.createDivElement(template)}taskbarContainer(){let data=this.templateData,template='<div class="'+taskBarMainContainer+" "+this.parent.getUnscheduledTaskClass(data.ganttProperties)+(data.ganttProperties.cssClass?data.ganttProperties.cssClass:"")+' tabindex="-1"  aria-label = "'+this.generateAriaLabel(data)+'"   style="'+(data.ganttProperties.isMilestone?"width:"+this.milestoneHeight+"px;height:"+this.milestoneHeight+"px;margin-top:"+this.milestoneMarginTop+"px;left:"+(data.ganttProperties.left-this.milestoneHeight/2)+"px;":"width:"+data.ganttProperties.width+"px;margin-top:"+this.taskBarMarginTop+"px;left:"+data.ganttProperties.left+"px;height:"+this.taskBarHeight+"px;")+'"></div>';return this.createDivElement(template)}rightLabelContainer(){let template='<div class="'+(this.rightTaskLabelTemplateFunction?rightLabelTempContainer:rightLabelContainer)+'"  tabindex="-1" '+this.generateTaskLabelAriaLabel("right")+' style="left:'+this.getRightLabelLeft(this.templateData)+"px;height:"+(this.parent.rowHeight-1)+'px;"></div>';return this.createDivElement(template)}childTaskbarLeftResizer(){return this.createDivElement('<div class="'+taskBarLeftResizer+" "+ej2_gantt_es2015_icon+'" style="left:'+-(this.parent.isAdaptive?12:2)+"px;height:"+this.taskBarHeight+'px;"></div>')}childTaskbarRightResizer(){return this.createDivElement('<div class="'+taskBarRightResizer+" "+ej2_gantt_es2015_icon+'" style="left:'+(this.templateData.ganttProperties.width+(this.parent.isAdaptive?-2:-10))+"px;height:"+this.taskBarHeight+'px;"></div>')}childTaskbarProgressResizer(){return this.createDivElement('<div class="'+childProgressResizer+'" style="left:'+(this.templateData.ganttProperties.progressWidth-6)+"px;margin-top:"+this.taskBarHeight+'px;"><div class="'+progressBarHandler+'"><div class="'+progressHandlerElement+'"></div><div class="'+progressBarHandlerAfter+'"></div></div>')}getLeftPointNode(){let data=this.templateData,pointerLeft=-((this.parent.isAdaptive?14:2)+this.connectorPointWidth),mileStoneLeft=-(this.connectorPointWidth+2),pointerTop=Math.floor(this.milesStoneRadius-this.connectorPointWidth/2),template='<div class="'+leftConnectorPointOuterDiv+'" style="'+(data.ganttProperties.isMilestone?"margin-top:"+pointerTop+"px;left:"+mileStoneLeft+"px;":"margin-top:"+this.connectorPointMargin+"px;left:"+pointerLeft+"px;")+'"><div class="'+connectorPointLeft+" "+this.parent.getUnscheduledTaskClass(data.ganttProperties)+'" style="width: '+this.connectorPointWidth+"px;height: "+this.connectorPointWidth+'px;">'+this.touchLeftConnectorpoint+"</div></div>";return this.createDivElement(template)}getRightPointNode(){let data=this.templateData,pointerRight=this.parent.isAdaptive?10:-2,pointerTop=Math.floor(this.milesStoneRadius-this.connectorPointWidth/2),template='<div class="'+rightConnectorPointOuterDiv+'" style="'+(data.ganttProperties.isMilestone?"left:"+(this.milestoneHeight-2)+"px;margin-top:"+pointerTop+"px;":"left:"+(data.ganttProperties.width+pointerRight)+"px;margin-top:"+this.connectorPointMargin+"px;")+'"><div class="'+connectorPointRight+" "+this.parent.getUnscheduledTaskClass(data.ganttProperties)+'" style="width:'+this.connectorPointWidth+"px;height:"+this.connectorPointWidth+'px;">'+this.touchRightConnectorpoint+"</div></div>";return this.createDivElement(template)}getTaskLabel(field){let length=this.parent.ganttColumns.length,resultString=null;if(isNullOrUndefined(field)||""===field)resultString="";else if(field===this.parent.taskFields.resourceInfo)resultString=this.getResourceName(this.templateData);else{for(let i=0;i<length;i++)if(field===this.parent.ganttColumns[i].field){resultString=this.getFieldValue(this.templateData[field]).toString();break}if(isNullOrUndefined(resultString))return"isCustomTemplate"}return resultString}getExpandDisplayProp(data){return this.parent.getExpandStatus(this.templateData)?"table-row":"none"}getRowClassName(data){let rowClass="gridrowtaskId",parentItem=(data=this.templateData).parentItem;return parentItem&&(rowClass+=parentItem.taskId.toString()),(rowClass+="level")+data.level.toString()}getBorderRadius(data){let diff=(data=this.templateData).ganttProperties.width-data.ganttProperties.progressWidth;return diff<=4?4-diff:0}taskNameWidth(ganttData){let width;return(width=(ganttData=this.templateData).ganttProperties.isMilestone?ganttData.ganttProperties.left-this.parent.getTaskbarHeight()/2:ganttData.ganttProperties.left)<0&&(width=0),width+"px"}getRightLabelLeft(ganttData){return(ganttData=this.templateData).ganttProperties.isMilestone?ganttData.ganttProperties.left+this.parent.getTaskbarHeight()/2:ganttData.ganttProperties.left+ganttData.ganttProperties.width}getExpandClass(data){return(data=this.templateData).expanded?rowExpand:!data.expanded&&data.hasChildRecords?rowCollapse:""}getFieldValue(field){return isNullOrUndefined(field)?"":field}getResourceName(ganttData){let resource=null;if(!isNullOrUndefined((ganttData=this.templateData).ganttProperties.resourceInfo)){let length=ganttData.ganttProperties.resourceInfo.length;if(length>0){for(let i=0;i<length;i++)isNullOrUndefined(resource)?resource=ganttData.ganttProperties.resourceInfo[i][this.parent.resourceNameMapping]:resource+=" , "+ganttData.ganttProperties.resourceInfo[i][this.parent.resourceNameMapping];return resource}return""}return""}initChartHelperPrivateVariable(){if(this.baselineColor=isNullOrUndefined(this.parent.baselineColor)||""===this.parent.baselineColor?null:this.parent.baselineColor,this.taskBarHeight=isNullOrUndefined(this.parent.taskbarHeight)||this.parent.taskbarHeight>=this.parent.rowHeight?Math.floor(.62*this.parent.rowHeight):this.parent.taskbarHeight,this.parent.renderBaseline){let height;this.taskBarHeight=height=this.taskBarHeight+this.baselineHeight<=this.parent.rowHeight?this.taskBarHeight:this.taskBarHeight-(this.baselineHeight+1)}this.milestoneHeight=Math.floor(.82*this.taskBarHeight),this.taskBarMarginTop=Math.floor((this.parent.rowHeight-this.taskBarHeight)/2),this.milestoneMarginTop=Math.floor((this.parent.rowHeight-this.milestoneHeight)/2),this.milesStoneRadius=Math.floor(this.milestoneHeight/2),this.baselineTop=-(Math.floor(this.parent.rowHeight-(this.taskBarHeight+this.taskBarMarginTop))-1),this.connectorPointWidth=this.parent.isAdaptive?Math.round(this.taskBarHeight/2):8,this.connectorPointMargin=Math.floor(this.taskBarHeight/2-this.connectorPointWidth/2)}refreshGanttRows(){this.parent.currentViewData=this.parent.treeGrid.getCurrentViewRecords().slice(),this.createTaskbarTemplate(),this.triggerQueryTaskbarInfo()}createTaskbarTemplate(){this.updateTaskbarBlazorTemplate(!1),this.ganttChartTableBody.innerHTML="";for(let i=0;i<this.parent.currentViewData.length;i++)this.ganttChartTableBody.appendChild(this.getGanttChartRow(i,this.parent.currentViewData[i]));this.updateTaskbarBlazorTemplate(!0)}getGanttChartRow(i,tempTemplateData){this.templateData=tempTemplateData;let taskBaselineTemplateNode=null,parentTrNode=this.getTableTrNode(),leftLabelNode=this.getLeftLabelNode(i),taskbarContainerNode=this.taskbarContainer();if(!this.templateData.hasChildRecords){let connectorLineLeftNode=this.getLeftPointNode();taskbarContainerNode[0].appendChild([].slice.call(connectorLineLeftNode)[0])}if(this.templateData.hasChildRecords){let parentTaskbarTemplateNode=this.getParentTaskbarNode(i);parentTaskbarTemplateNode&&parentTaskbarTemplateNode.length>0&&taskbarContainerNode[0].appendChild([].slice.call(parentTaskbarTemplateNode)[0]),this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(taskBaselineTemplateNode=this.getTaskBaselineNode())}else if(this.templateData.ganttProperties.isMilestone){let milestoneTemplateNode=this.getMilestoneNode(i);milestoneTemplateNode&&milestoneTemplateNode.length>0&&taskbarContainerNode[0].appendChild([].slice.call(milestoneTemplateNode)[0]),this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(taskBaselineTemplateNode=this.getMilestoneBaselineNode())}else{let scheduledTask=isScheduledTask(this.templateData.ganttProperties),childTaskbarProgressResizeNode=null,childTaskbarRightResizeNode=null,childTaskbarLeftResizeNode=null;if(!isNullOrUndefined(scheduledTask)){(scheduledTask||this.templateData.ganttProperties.duration)&&scheduledTask&&(childTaskbarProgressResizeNode=this.childTaskbarProgressResizer(),childTaskbarLeftResizeNode=this.childTaskbarLeftResizer(),childTaskbarRightResizeNode=this.childTaskbarRightResizer());let childTaskbarTemplateNode=this.getChildTaskbarNode(i);childTaskbarLeftResizeNode&&taskbarContainerNode[0].appendChild([].slice.call(childTaskbarLeftResizeNode)[0]),childTaskbarTemplateNode&&childTaskbarTemplateNode.length>0&&taskbarContainerNode[0].appendChild([].slice.call(childTaskbarTemplateNode)[0]),childTaskbarProgressResizeNode&&taskbarContainerNode[0].appendChild([].slice.call(childTaskbarProgressResizeNode)[0]),childTaskbarRightResizeNode&&taskbarContainerNode[0].appendChild([].slice.call(childTaskbarRightResizeNode)[0])}this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(taskBaselineTemplateNode=this.getTaskBaselineNode())}if(!this.templateData.hasChildRecords){let connectorLineRightNode=this.getRightPointNode();taskbarContainerNode[0].appendChild([].slice.call(connectorLineRightNode)[0])}let rightLabelNode=this.getRightLabelNode(i);if(parentTrNode[0].childNodes[0].childNodes[0].appendChild([].slice.call(leftLabelNode)[0]),parentTrNode[0].childNodes[0].childNodes[0].appendChild([].slice.call(taskbarContainerNode)[0]),this.templateData.ganttProperties.indicators&&this.templateData.ganttProperties.indicators.length>0){let taskIndicatorNode,taskIndicatorTextFunction,taskIndicatorTextNode,indicators=this.templateData.ganttProperties.indicators;for(let indicatorIndex=0;indicatorIndex<indicators.length;indicatorIndex++){if(taskIndicatorNode=this.getIndicatorNode(indicators[indicatorIndex]),indicators[indicatorIndex].name.indexOf("$")>-1||indicators[indicatorIndex].name.indexOf("#")>-1)taskIndicatorTextNode=(taskIndicatorTextFunction=this.templateCompiler(indicators[indicatorIndex].name))(extend({index:i},this.templateData),this.parent,"indicatorLabelText");else{let text=ej2_base_es2015_createElement("Text");text.innerHTML=indicators[indicatorIndex].name,taskIndicatorTextNode=text.childNodes}taskIndicatorNode[0].appendChild([].slice.call(taskIndicatorTextNode)[0]),taskIndicatorNode[0].title=isNullOrUndefined(indicators[indicatorIndex].tooltip)?"":indicators[indicatorIndex].tooltip,parentTrNode[0].childNodes[0].childNodes[0].appendChild([].slice.call(taskIndicatorNode)[0])}}return rightLabelNode&&rightLabelNode.length>0&&parentTrNode[0].childNodes[0].childNodes[0].appendChild([].slice.call(rightLabelNode)[0]),isNullOrUndefined(taskBaselineTemplateNode)||parentTrNode[0].childNodes[0].childNodes[0].appendChild([].slice.call(taskBaselineTemplateNode)[0]),parentTrNode[0].childNodes[0]}triggerQueryTaskbarInfo(){let trElement,taskbarElement,data,length=this.ganttChartTableBody.querySelectorAll("tr").length;for(let index=0;index<length;index++)taskbarElement=(trElement=this.ganttChartTableBody.querySelectorAll("tr")[index]).querySelector("."+taskBarMainContainer),this.triggerQueryTaskbarInfoByIndex(trElement,data=this.parent.currentViewData[index])}triggerQueryTaskbarInfoByIndex(trElement,data){let taskbarElement,rowElement,triggerTaskbarElement;taskbarElement=trElement.querySelector("."+taskBarMainContainer);let args={data:data,rowElement:trElement,taskbarElement:trElement.querySelector("."+taskBarMainContainer),taskbarType:data.hasChildRecords?"ParentTask":data.ganttProperties.isMilestone?"Milestone":"ChildTask"},classCollections=this.getClassName(args);"Milestone"===args.taskbarType?(args.milestoneColor=taskbarElement.querySelector(classCollections[0])?getComputedStyle(taskbarElement.querySelector(classCollections[0])).borderBottomColor:null,args.baselineColor=trElement.querySelector(classCollections[1])?getComputedStyle(trElement.querySelector(classCollections[1])).borderBottomColor:null):(args.taskbarBgColor=taskbarElement.querySelector(classCollections[0])?getComputedStyle(taskbarElement.querySelector(classCollections[0])).backgroundColor:null,args.taskbarBorderColor=taskbarElement.querySelector(classCollections[0])?getComputedStyle(taskbarElement.querySelector(classCollections[0])).borderColor:null,args.progressBarBgColor=taskbarElement.querySelector(classCollections[1])?getComputedStyle(taskbarElement.querySelector(classCollections[1])).backgroundColor:null,args.baselineColor=trElement.querySelector("."+baselineBar)?getComputedStyle(trElement.querySelector("."+baselineBar)).backgroundColor:null,args.taskLabelColor=taskbarElement.querySelector("."+taskLabel)?getComputedStyle(taskbarElement.querySelector("."+taskLabel)).color:null),args.rightLabelColor=trElement.querySelector("."+rightLabelContainer)&&trElement.querySelector("."+rightLabelContainer).querySelector("."+ej2_gantt_es2015_label)?getComputedStyle(trElement.querySelector("."+rightLabelContainer).querySelector("."+ej2_gantt_es2015_label)).color:null,args.leftLabelColor=trElement.querySelector("."+leftLabelContainer)&&trElement.querySelector("."+leftLabelContainer).querySelector("."+ej2_gantt_es2015_label)?getComputedStyle(trElement.querySelector("."+leftLabelContainer).querySelector("."+ej2_gantt_es2015_label)).color:null,isBlazor()&&(rowElement=args.rowElement,triggerTaskbarElement=args.taskbarElement),this.parent.trigger("queryTaskbarInfo",args,taskbarArgs=>{this.updateQueryTaskbarInfoArgs(taskbarArgs,rowElement,triggerTaskbarElement)})}updateQueryTaskbarInfoArgs(args,rowElement,taskBarElement){let trElement=isBlazor()&&rowElement?rowElement:args.rowElement,taskbarElement=isBlazor()&&taskBarElement?taskBarElement:args.taskbarElement,classCollections=this.getClassName(args);"Milestone"===args.taskbarType?(taskbarElement.querySelector(classCollections[0])&&getComputedStyle(taskbarElement.querySelector(classCollections[0])).borderBottomColor!==args.milestoneColor&&(taskbarElement.querySelector(classCollections[0]).style.borderBottomColor=args.milestoneColor,taskbarElement.querySelector("."+milestoneBottom).style.borderTopColor=args.milestoneColor),trElement.querySelector(classCollections[1])&&getComputedStyle(trElement.querySelector(classCollections[1])).borderTopColor!==args.baselineColor&&(trElement.querySelector(classCollections[1]).style.borderBottomColor=args.baselineColor,trElement.querySelector("."+baselineMilestoneBottom).style.borderTopColor=args.baselineColor)):(taskbarElement.querySelector(classCollections[0])&&getComputedStyle(taskbarElement.querySelector(classCollections[0])).backgroundColor!==args.taskbarBgColor&&(taskbarElement.querySelector(classCollections[0]).style.backgroundColor=args.taskbarBgColor),taskbarElement.querySelector(classCollections[0])&&getComputedStyle(taskbarElement.querySelector(classCollections[0])).borderColor!==args.taskbarBorderColor&&(taskbarElement.querySelector(classCollections[0]).style.borderColor=args.taskbarBorderColor),taskbarElement.querySelector(classCollections[1])&&getComputedStyle(taskbarElement.querySelector(classCollections[1])).backgroundColor!==args.progressBarBgColor&&(taskbarElement.querySelector(classCollections[1]).style.backgroundColor=args.progressBarBgColor),taskbarElement.querySelector("."+taskLabel)&&getComputedStyle(taskbarElement.querySelector("."+taskLabel)).color!==args.taskLabelColor&&(taskbarElement.querySelector("."+taskLabel).style.color=args.taskLabelColor),trElement.querySelector("."+baselineBar)&&getComputedStyle(trElement.querySelector("."+baselineBar)).backgroundColor!==args.baselineColor&&(trElement.querySelector("."+baselineBar).style.backgroundColor=args.baselineColor)),trElement.querySelector("."+leftLabelContainer)&&trElement.querySelector("."+leftLabelContainer).querySelector("."+ej2_gantt_es2015_label)&&getComputedStyle(trElement.querySelector("."+leftLabelContainer).querySelector("."+ej2_gantt_es2015_label)).color!==args.leftLabelColor&&(trElement.querySelector("."+leftLabelContainer).querySelector("."+ej2_gantt_es2015_label).style.color=args.leftLabelColor),trElement.querySelector("."+rightLabelContainer)&&trElement.querySelector("."+rightLabelContainer).querySelector("."+ej2_gantt_es2015_label)&&getComputedStyle(trElement.querySelector("."+rightLabelContainer).querySelector("."+ej2_gantt_es2015_label)).color!==args.rightLabelColor&&(trElement.querySelector("."+rightLabelContainer).querySelector("."+ej2_gantt_es2015_label).style.color=args.rightLabelColor)}getClassName(args){let classCollection=[];return classCollection.push("."+("ParentTask"===args.taskbarType?traceParentTaskBar:"ChildTask"===args.taskbarType?traceChildTaskBar:milestoneTop)),classCollection.push("."+("ParentTask"===args.taskbarType?traceParentProgressBar:"ChildTask"===args.taskbarType?traceChildProgressBar:baselineMilestoneTop)),classCollection}templateCompiler(template){if(!isNullOrUndefined(template)&&""!==template)try{return document.querySelectorAll(template).length?compile$$1(document.querySelector(template).innerHTML.trim(),this.parent):compile$$1(template,this.parent)}catch(e){return compile$$1(template,this.parent)}return null}refreshRow(index){let tr=this.ganttChartTableBody.childNodes[index],selectedItem=this.parent.currentViewData[index];if(-1!==index&&selectedItem){let data=selectedItem;tr.replaceChild(this.getGanttChartRow(index,data).childNodes[0],tr.childNodes[0]),this.triggerQueryTaskbarInfoByIndex(tr,data),this.parent.treeGrid.grid.setRowData(data.ganttProperties.taskId,data),this.parent.treeGrid.grid.getRowObjectFromUID(this.parent.treeGrid.grid.getDataRows()[index].getAttribute("data-uid")).data=data}}refreshRecords(items){if(this.parent.isGanttChartRendered){this.updateTaskbarBlazorTemplate(!1);for(let i=0;i<items.length;i++){let index=this.parent.currentViewData.indexOf(items[i]);this.refreshRow(index)}this.updateTaskbarBlazorTemplate(!0)}}removeEventListener(){this.parent.isDestroyed||(this.parent.off("renderPanels",this.createChartTable),this.parent.off("dataReady",this.initiateTemplates),this.parent.off("destroy",this.destroy))}destroy(){this.removeEventListener()}generateAriaLabel(data){data=this.templateData;let defaultValue="",nameConstant=this.parent.localeObj.getConstant("name"),startDateConstant=this.parent.localeObj.getConstant("startDate"),endDateConstant=this.parent.localeObj.getConstant("endDate"),durationConstant=this.parent.localeObj.getConstant("duration"),taskNameVal=data.ganttProperties.taskName,startDateVal=data.ganttProperties.startDate,endDateVal=data.ganttProperties.endDate,durationVal=data.ganttProperties.duration;return data.ganttProperties.isMilestone?defaultValue=nameConstant+" "+taskNameVal+" "+startDateConstant+" "+this.parent.getFormatedDate(startDateVal):(taskNameVal&&(defaultValue+=nameConstant+" "+taskNameVal+" "),startDateVal&&(defaultValue+=startDateConstant+" "+this.parent.getFormatedDate(startDateVal)+" "),endDateVal&&(defaultValue+=endDateConstant+" "+this.parent.getFormatedDate(endDateVal)+" "),durationVal&&(defaultValue+=durationConstant+" "+this.parent.getDurationString(durationVal,data.ganttProperties.durationUnit))),defaultValue}generateTaskLabelAriaLabel(type){let label$$1="";return"left"===type&&this.parent.labelSettings.leftLabel&&0!==this.parent.labelSettings.leftLabel.indexOf("#")?label$$1+='aria-label= "'+this.parent.localeObj.getConstant("leftTaskLabel")+" "+this.getTaskLabel(this.parent.labelSettings.leftLabel)+'"':"right"===type&&this.parent.labelSettings.rightLabel&&0!==this.parent.labelSettings.rightLabel.indexOf("#")&&(label$$1+='aria-label="'+this.parent.localeObj.getConstant("rightTaskLabel")+" "+this.getTaskLabel(this.parent.labelSettings.rightLabel)+'"'),label$$1}}class ej2_gantt_es2015_Dependency{constructor(gantt){this.validationPredecessor=null,this.confirmPredecessorDialog=null,this.predecessorIndex=null,this.childRecord=null,this.parent=gantt,this.dateValidateModule=this.parent.dateValidationModule}ensurePredecessorCollection(){let predecessorTasks=this.parent.predecessorsCollection;for(let count=predecessorTasks.length-1;count>=0;count--){let ganttData=predecessorTasks[count];this.ensurePredecessorCollectionHelper(ganttData,ganttData.ganttProperties)}}ensurePredecessorCollectionHelper(ganttData,ganttProp){let predecessorVal=ganttProp.predecessorsName;if(!predecessorVal||"string"!=typeof predecessorVal&&"number"!=typeof predecessorVal){if(predecessorVal&&"object"==typeof predecessorVal&&predecessorVal.length){let preValues=[];for(let c=0;c<predecessorVal.length;c++){let predecessorItem=predecessorVal[c],preValue={};preValue.from=getValue("from",predecessorItem),preValue.to=getValue("to",predecessorItem)?getValue("to",predecessorItem):ganttProp.taskId,preValue.type=getValue("type",predecessorItem)?getValue("type",predecessorItem):"FS";let offsetUnits=getValue("offset",predecessorItem);if(isNullOrUndefined(offsetUnits))preValue.offset=0,preValue.offsetUnit=this.parent.durationUnit.toLocaleLowerCase();else if("string"==typeof offsetUnits){let tempOffsetUnits=this.getOffsetDurationUnit(getValue("offset",predecessorItem));preValue.offset=tempOffsetUnits.duration,preValue.offsetUnit=tempOffsetUnits.durationUnit}else preValue.offset=parseFloat(offsetUnits.toString()),preValue.offsetUnit=this.parent.durationUnit.toLocaleLowerCase();this.checkIsParent(preValue.from.toString())||preValues.push(preValue)}this.parent.setRecordValue("predecessor",preValues,ganttProp,!0)}}else this.parent.setRecordValue("predecessor",this.calculatePredecessor(predecessorVal,ganttData),ganttProp,!0);this.parent.setRecordValue("predecessorsName",this.getPredecessorStringValue(ganttData),ganttProp,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,ganttProp.predecessorsName,ganttData),this.parent.setRecordValue(this.parent.taskFields.dependency,ganttProp.predecessorsName,ganttData)}checkIsParent(fromId){let boolValue=!1;return this.parent.getRecordByID(fromId).hasChildRecords&&(boolValue=!0),boolValue}calculatePredecessor(predecessorValue,ganttRecord){let match,values,offsetValue,predecessorText,predecessor=predecessorValue.toString(),collection=[];return predecessor.split(",").forEach(el=>{if(values=el.split("+"),offsetValue="+",el.indexOf("-")>=0&&(values=el.split("-"),offsetValue="-"),!(match=values[0].match(/(\d+|[A-z]+)/g))[0]||-1===this.parent.ids.indexOf(match[0]))return;if(match.length>1){let type=match[1].toUpperCase();predecessorText="FS"===type||"FF"===type||"SF"===type||"SS"===type?type:"FS"}else predecessorText="FS";let offsetUnits=this.getOffsetDurationUnit(values.length>1?offsetValue+""+values[1]:"0"),obj={from:match[0],type:predecessorText,isDrawn:!1,to:ganttRecord.ganttProperties.taskId.toString(),offsetUnit:offsetUnits.durationUnit,offset:offsetUnits.duration};this.checkIsParent(match[0])||collection.push(obj)}),collection}getPredecessorStringValue(data){let predecessors=data.ganttProperties.predecessor,durationUnitTexts=this.parent.durationUnitTexts,resultString="";if(predecessors){let length=predecessors.length;for(let i=0;i<length;i++){let currentValue=predecessors[i],temp="";if(currentValue.from!==data.ganttProperties.taskId.toString()){if(temp=currentValue.from+currentValue.type,0!==currentValue.offset){temp+=currentValue.offset>0?"+"+currentValue.offset+" ":currentValue.offset+" ";let multiple=1!==currentValue.offset;temp+=getValue("day"===currentValue.offsetUnit?multiple?"days":"day":"hour"===currentValue.offsetUnit?multiple?"hours":"hour":multiple?"minutes":"minute",durationUnitTexts)}resultString=resultString.length>0?resultString+","+temp:temp}}}return resultString}getOffsetDurationUnit(val){let duration=0,durationUnit=this.parent.durationUnit.toLocaleLowerCase(),durationUnitLabels=this.parent.durationUnitEditText;if("string"==typeof val){let values=val.match(/[^0-9]+|[0-9]+/g);for(let x=0;x<values.length;x++)values[x]=values[x].trim();"-"===values[0]&&values[1]?(values[1]=values[0]+values[1],values.shift()):"+"===values[0]&&values.shift(),"."!==values[1]||isNaN(parseInt(values[2],10))||(values[0]+=values[1]+values[2],values.splice(1,2)),values&&values.length<=2&&(duration=parseFloat(values[0]),durationUnit=values[1]?values[1].toLowerCase().trim():"",durationUnit=-1!==getValue("minute",durationUnitLabels).indexOf(durationUnit)?"minute":-1!==getValue("hour",durationUnitLabels).indexOf(durationUnit)?"hour":-1!==getValue("day",durationUnitLabels).indexOf(durationUnit)?"day":this.parent.durationUnit.toLocaleLowerCase())}else duration=val,durationUnit=this.parent.durationUnit.toLocaleLowerCase();return isNaN(duration)&&(duration=0,durationUnit=this.parent.durationUnit.toLocaleLowerCase()),{duration:duration,durationUnit:durationUnit}}updatePredecessors(){let ganttRecord,predecessorsCollection=this.parent.predecessorsCollection,length=predecessorsCollection.length;for(let count=0;count<length;count++)this.updatePredecessorHelper(ganttRecord=predecessorsCollection[count],predecessorsCollection)}updatePredecessorHelper(ganttRecord,predecessorsCollection){let connectorsCollection,successorGanttRecord,connectorCount;predecessorsCollection=isNullOrUndefined(predecessorsCollection)?[]:predecessorsCollection,connectorCount=(connectorsCollection=ganttRecord.ganttProperties.predecessor).length;for(let i=0;i<connectorCount;i++){let connector=connectorsCollection[i];if(successorGanttRecord=this.parent.getRecordByID(connector.from),connector.from!==ganttRecord.ganttProperties.taskId.toString()&&successorGanttRecord){let predecessorCollection;successorGanttRecord.ganttProperties.predecessor?((predecessorCollection=extend([],successorGanttRecord.ganttProperties.predecessor,[],!0)).push(connector),this.parent.setRecordValue("predecessor",predecessorCollection,successorGanttRecord.ganttProperties,!0)):((predecessorCollection=[]).push(connector),this.parent.setRecordValue("predecessor",predecessorCollection,successorGanttRecord.ganttProperties,!0),predecessorsCollection.push(successorGanttRecord))}}}updatedRecordsDateByPredecessor(){let flatData=this.parent.flatData;for(let count=0;count<flatData.length;count++)flatData[count].ganttProperties.predecessor&&flatData[count].taskData[this.parent.taskFields.dependency]&&this.validatePredecessorDates(flatData[count])}validatePredecessorDates(ganttRecord){if(ganttRecord.ganttProperties.predecessor){let count,parentGanttRecord,predecessorsCollection=ganttRecord.ganttProperties.predecessor,record=null,currentTaskId=ganttRecord.ganttProperties.taskId.toString(),predecessors=predecessorsCollection.filter(data=>data.to===currentTaskId?data:null);for(count=0;count<predecessors.length;count++){let predecessor;parentGanttRecord=this.parent.getRecordByID((predecessor=predecessors[count]).from),(record=this.parent.getRecordByID(predecessor.to)).ganttProperties.isAutoSchedule&&this.validateChildGanttRecord(parentGanttRecord,record)}}}validateChildGanttRecord(parentGanttRecord,childGanttRecord){if(this.parent.editedTaskBarItem!==childGanttRecord&&!isNullOrUndefined(isScheduledTask(parentGanttRecord.ganttProperties))&&!isNullOrUndefined(isScheduledTask(childGanttRecord.ganttProperties))&&this.parent.isInPredecessorValidation&&childGanttRecord.ganttProperties.isAutoSchedule){let childRecordProperty=childGanttRecord.ganttProperties,currentTaskId=childRecordProperty.taskId.toString(),childPredecessor=childRecordProperty.predecessor.filter(data=>data.to===currentTaskId?data:null),startDate=this.getPredecessorDate(childGanttRecord,childPredecessor);this.parent.setRecordValue("startDate",startDate,childRecordProperty,!0),this.parent.dataOperation.updateMappingData(childGanttRecord,"startDate"),this.dateValidateModule.calculateEndDate(childGanttRecord),this.parent.setRecordValue("left",this.parent.dataOperation.calculateLeft(childRecordProperty),childRecordProperty,!0),this.parent.setRecordValue("width",this.parent.dataOperation.calculateWidth(childRecordProperty),childRecordProperty,!0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(childRecordProperty.width,childRecordProperty.progress),childRecordProperty,!0),childGanttRecord.parentItem&&this.parent.getParentTask(childGanttRecord.parentItem).ganttProperties.isAutoSchedule&&this.parent.isInPredecessorValidation&&this.parent.dataOperation.updateParentItems(childGanttRecord.parentItem)}}getPredecessorDate(ganttRecord,predecessorsCollection){let maxStartDate,tempStartDate,parentGanttRecord,childGanttRecord,validatedPredecessor=predecessorsCollection.filter(data=>data.to===ganttRecord.ganttProperties.taskId.toString()?data:null);if(validatedPredecessor){let length=validatedPredecessor.length;for(let i=0;i<length;i++){let predecessor=validatedPredecessor[i];parentGanttRecord=this.parent.getRecordByID(predecessor.from),childGanttRecord=this.parent.getRecordByID(predecessor.to),tempStartDate=this.getValidatedStartDate(childGanttRecord.ganttProperties,parentGanttRecord.ganttProperties,predecessor),null==maxStartDate?maxStartDate=tempStartDate:1===this.dateValidateModule.compareDates(tempStartDate,maxStartDate)&&(maxStartDate=tempStartDate)}}return maxStartDate}getValidatedStartDate(ganttProperty,parentRecordProperty,predecessor){let tempDate,returnStartDate,type=predecessor.type,offset=predecessor.offset;switch(type){case"FS":tempDate=this.dateValidateModule.getValidEndDate(parentRecordProperty),ganttProperty.isMilestone&&0===offset||(tempDate=this.dateValidateModule.checkStartDate(tempDate,ganttProperty)),0!==offset&&(tempDate=this.updateDateByOffset(tempDate,predecessor,ganttProperty)),returnStartDate=ganttProperty.isMilestone?tempDate:this.dateValidateModule.checkStartDate(tempDate,ganttProperty);break;case"FF":case"SF":tempDate="FF"===type?this.dateValidateModule.getValidEndDate(parentRecordProperty):this.dateValidateModule.getValidStartDate(parentRecordProperty),0!==offset&&(tempDate=this.updateDateByOffset(tempDate,predecessor,ganttProperty)),ganttProperty.isMilestone||(tempDate=this.dateValidateModule.checkEndDate(tempDate,ganttProperty)),returnStartDate=this.dateValidateModule.getStartDate(tempDate,ganttProperty.duration,ganttProperty.durationUnit,ganttProperty);break;case"SS":tempDate=this.dateValidateModule.getValidStartDate(parentRecordProperty),0!==offset&&(tempDate=this.updateDateByOffset(tempDate,predecessor,ganttProperty)),returnStartDate=ganttProperty.isMilestone?tempDate:this.dateValidateModule.checkStartDate(tempDate,ganttProperty)}return returnStartDate}updateDateByOffset(date,predecessor,record){let resultDate,offsetValue=predecessor.offset,durationUnit=predecessor.offsetUnit;return offsetValue<0?resultDate=this.dateValidateModule.getStartDate(this.dateValidateModule.checkEndDate(date,record),-1*offsetValue,durationUnit,record):(resultDate=this.dateValidateModule.getEndDate(date,offsetValue,durationUnit,record,!1),record.isMilestone||(resultDate=this.dateValidateModule.checkStartDate(resultDate,record))),resultDate}createConnectorLinesCollection(records){let count,ganttRecord,predecessorsCollection,recordLength=records.length;for(count=0;count<recordLength;count++)(predecessorsCollection=(ganttRecord=records[count]).ganttProperties.predecessor)&&this.addPredecessorsCollection(predecessorsCollection)}addPredecessorsCollection(predecessorsCollection){let predecessorsLength,predecessorCount,predecessor,parentGanttRecord,childGanttRecord;if(predecessorsCollection)for(predecessorsLength=predecessorsCollection.length,predecessorCount=0;predecessorCount<predecessorsLength;predecessorCount++){let to="to";parentGanttRecord=this.parent.getRecordByID((predecessor=predecessorsCollection[predecessorCount]).from),childGanttRecord=this.parent.getRecordByID(predecessor[to]),this.parent.currentViewData&&-1!==this.parent.currentViewData.indexOf(parentGanttRecord)&&-1!==this.parent.currentViewData.indexOf(childGanttRecord)&&this.parent.connectorLineEditModule.updateConnectorLineObject(parentGanttRecord,childGanttRecord,predecessor)}}validatePredecessor(childGanttRecord,previousValue,validationOn){if(this.parent.isInPredecessorValidation&&childGanttRecord.ganttProperties.predecessor){let parentGanttRecord,predecessor,predecessorsCollection=childGanttRecord.ganttProperties.predecessor,record=null,currentTaskId=childGanttRecord.ganttProperties.taskId.toString(),predecessors=predecessorsCollection.filter(data=>data.to===currentTaskId?data:null),successors=predecessorsCollection.filter(data=>data.from===currentTaskId?data:null);for(let count=0;count<predecessors.length;count++)parentGanttRecord=this.parent.getRecordByID((predecessor=predecessors[count]).from),record=this.parent.getRecordByID(predecessor.to),this.parent.isValidationEnabled=!(!this.parent.isInPredecessorValidation||!record.ganttProperties.isAutoSchedule),childGanttRecord.ganttProperties.taskId.toString()!==predecessor.to&&childGanttRecord.ganttProperties.taskId.toString()!==predecessor.from||validationOn&&"predecessor"!==validationOn||this.validateChildGanttRecord(parentGanttRecord,record);for(let count=0;count<successors.length;count++)parentGanttRecord=this.parent.getRecordByID((predecessor=successors[count]).from),record=this.parent.getRecordByID(predecessor.to),this.parent.isValidationEnabled=!(!this.parent.isInPredecessorValidation||!record.ganttProperties.isAutoSchedule),"predecessor"!==validationOn&&this.parent.isValidationEnabled&&this.validateChildGanttRecord(parentGanttRecord,record),record&&this.validatePredecessor(record,void 0,"successor")}}validationDialogTemplate(args){let topContent,topContentText,ganttId=this.parent.element.id,contentdiv=ej2_base_es2015_createElement("div",{className:"e-ValidationContent"}),taskData=getValue("task",args),parenttaskData=getValue("parentTask",args),violationType=getValue("violationType",args),recordName=taskData.ganttProperties.taskName,recordNewStartDate=this.parent.getFormatedDate(taskData.ganttProperties.startDate,"MM/dd/yyyy"),recordArgs=[recordName,parenttaskData.ganttProperties.taskName];return"taskBeforePredecessor_FS"===violationType?topContentText=this.parent.localeObj.getConstant("taskBeforePredecessor_FS"):"taskAfterPredecessor_FS"===violationType?topContentText=this.parent.localeObj.getConstant("taskAfterPredecessor_FS"):"taskBeforePredecessor_SS"===violationType?topContentText=this.parent.localeObj.getConstant("taskBeforePredecessor_SS"):"taskAfterPredecessor_SS"===violationType?topContentText=this.parent.localeObj.getConstant("taskAfterPredecessor_SS"):"taskBeforePredecessor_FF"===violationType?topContentText=this.parent.localeObj.getConstant("taskBeforePredecessor_FF"):"taskAfterPredecessor_FF"===violationType?topContentText=this.parent.localeObj.getConstant("taskAfterPredecessor_FF"):"taskBeforePredecessor_SF"===violationType?topContentText=this.parent.localeObj.getConstant("taskBeforePredecessor_SF"):"taskAfterPredecessor_SF"===violationType&&(topContentText=this.parent.localeObj.getConstant("taskAfterPredecessor_SF")),topContentText=function(str,args){let regx;for(let i=0;i<args.length;i++)regx=new RegExp("\\{"+i+"\\}","gm"),str=str.replace(regx,args[i].toString());return str}(topContentText,recordArgs),contentdiv.innerHTML=(topContent='<div id="'+ganttId+'_ValidationText">'+topContentText+"<div>")+'<table><tr><td><input type="radio" id="'+ganttId+'_ValidationCancel" name="ValidationRule" checked/><label for="'+ganttId+'_ValidationCancel" id= "'+ganttId+'_cancelLink">Cancel, keep the existing link</label></td></tr><tr><td><input type="radio" id="'+ganttId+'_ValidationRemoveline" name="ValidationRule"/><label for="'+ganttId+'_ValidationRemoveline" id="'+ganttId+'_removeLink">Remove the link and move <b>'+recordName+"</b> to start on <b>"+recordNewStartDate+'</b>.</label></td></tr><tr><td><input type="radio" id="'+ganttId+'_ValidationAddlineOffset" name="ValidationRule"/><label for="'+ganttId+'_ValidationAddlineOffset" id="'+ganttId+'_preserveLink">Move the <b>'+recordName+"</b> to start on <b>"+recordNewStartDate+"</b> and keep the link.</label></td></tr></table>",contentdiv}renderValidationDialog(){let validationDialog=new ej2_popups_es2015_Dialog({header:"Validate Editing",isModal:!0,visible:!1,width:"50%",showCloseIcon:!0,close:this.validationDialogClose.bind(this),content:"",buttons:[{click:this.validationDialogOkButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.validationDialogCancelButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});document.getElementById(this.parent.element.id+"_dialogValidationRule").innerHTML="",validationDialog.isStringTemplate=!0,validationDialog.appendTo("#"+this.parent.element.id+"_dialogValidationRule"),this.parent.validationDialogElement=validationDialog}validationDialogOkButton(){let currentArgs=this.parent.currentEditedArgs;currentArgs.validateMode.preserveLinkWithEditing=document.getElementById(this.parent.element.id+"_ValidationAddlineOffset").checked,currentArgs.validateMode.removeLink=document.getElementById(this.parent.element.id+"_ValidationRemoveline").checked,currentArgs.validateMode.respectLink=document.getElementById(this.parent.element.id+"_ValidationCancel").checked,this.applyPredecessorOption(),this.parent.validationDialogElement.hide()}validationDialogCancelButton(){this.parent.currentEditedArgs.validateMode.respectLink=!0,this.applyPredecessorOption(),this.parent.validationDialogElement.hide()}validationDialogClose(e){getValue("isInteraction",e)&&(this.parent.currentEditedArgs.validateMode.respectLink=!0,this.applyPredecessorOption())}applyPredecessorOption(){let args=this.parent.currentEditedArgs,ganttRecord=args.data;args.validateMode.respectLink?(this.parent.editModule.reUpdatePreviousRecords(),this.parent.chartRowsModule.refreshRecords([args.data])):args.validateMode.removeLink?(this.removePredecessors(ganttRecord,this.validationPredecessor),this.parent.editModule.updateEditedTask(args.editEventArgs)):args.validateMode.preserveLinkWithEditing&&(this.calculateOffset(ganttRecord),this.parent.editModule.updateEditedTask(args.editEventArgs))}calculateOffset(record){let prevPredecessor=extend([],record.ganttProperties.predecessor,[],!0),validPredecessor=this.getValidPredecessor(record);for(let i=0;i<validPredecessor.length;i++){let offset,predecessor=validPredecessor[i],parentTask=this.parent.getRecordByID(predecessor.from);if(isScheduledTask(parentTask.ganttProperties)&&isScheduledTask(record.ganttProperties)){let tempStartDate,tempEndDate,tempDuration,isNegativeOffset;switch(predecessor.type){case"FS":tempStartDate=new Date(parentTask.ganttProperties.endDate.getTime()),tempEndDate=new Date(record.ganttProperties.startDate.getTime());break;case"SS":tempStartDate=new Date(parentTask.ganttProperties.startDate.getTime()),tempEndDate=new Date(record.ganttProperties.startDate.getTime());break;case"SF":tempStartDate=new Date(parentTask.ganttProperties.startDate.getTime()),tempEndDate=new Date(record.ganttProperties.endDate.getTime());break;case"FF":tempStartDate=new Date(parentTask.ganttProperties.endDate.getTime()),tempEndDate=new Date(record.ganttProperties.endDate.getTime())}if(tempStartDate.getTime()<tempEndDate.getTime())tempStartDate=this.dateValidateModule.checkStartDate(tempStartDate),tempEndDate=this.dateValidateModule.checkEndDate(tempEndDate,null),isNegativeOffset=!1;else{let tempDate=new Date(tempStartDate.getTime());tempStartDate=this.dateValidateModule.checkStartDate(tempEndDate),tempEndDate=this.dateValidateModule.checkEndDate(tempDate,null),isNegativeOffset=!0}tempStartDate.getTime()<tempEndDate.getTime()?(tempDuration=this.dateValidateModule.getDuration(tempStartDate,tempEndDate,predecessor.offsetUnit,!0,!0),offset=isNegativeOffset?-1*tempDuration:tempDuration):offset=0}else offset=0;prevPredecessor[ej2_gantt_es2015_getIndex(predecessor,"from",prevPredecessor,"to")].offset=offset;let parentPredecessors=extend([],parentTask.ganttProperties.predecessor,[],!0);parentPredecessors[ej2_gantt_es2015_getIndex(predecessor,"from",parentPredecessors,"to")].offset=offset,this.parent.setRecordValue("predecessor",parentPredecessors,parentTask.ganttProperties,!0)}this.parent.setRecordValue("predecessor",prevPredecessor,record.ganttProperties,!0);let predecessorString=this.getPredecessorStringValue(record);this.parent.setRecordValue("predecessorsName",predecessorString,record.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,predecessorString,record),this.parent.setRecordValue(this.parent.taskFields.dependency,predecessorString,record)}removePredecessors(ganttRecord,predecessor){let prevPredecessor=extend([],[],ganttRecord.ganttProperties.predecessor,!0),preLength=predecessor.length;for(let i=0;i<preLength;i++){let parentGanttRecord=this.parent.getRecordByID(predecessor[i].from),parentPredecessor=extend([],[],parentGanttRecord.ganttProperties.predecessor,!0),index=ej2_gantt_es2015_getIndex(predecessor[i],"from",prevPredecessor,"to");prevPredecessor.splice(index,1);let parentIndex=ej2_gantt_es2015_getIndex(predecessor[i],"from",parentPredecessor,"to");parentPredecessor.splice(parentIndex,1),this.parent.setRecordValue("predecessor",parentPredecessor,parentGanttRecord.ganttProperties,!0)}if(prevPredecessor.length!==ganttRecord.ganttProperties.predecessor.length){this.parent.setRecordValue("predecessor",prevPredecessor,ganttRecord.ganttProperties,!0);let predecessorString=this.getPredecessorStringValue(ganttRecord);this.parent.setRecordValue("predecessorsName",predecessorString,ganttRecord.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,predecessorString,ganttRecord),this.parent.setRecordValue(this.parent.taskFields.dependency,predecessorString,ganttRecord)}}openValidationDialog(args){let contentTemplate=this.validationDialogTemplate(args);this.parent.validationDialogElement.setProperties({content:contentTemplate}),this.parent.validationDialogElement.show()}getValidPredecessor(record){let validPredecessor=[],recPredecessor=record.ganttProperties.predecessor;return recPredecessor&&recPredecessor.length>0&&(validPredecessor=recPredecessor.filter(value=>value.from!==record.ganttProperties.taskId.toString())),validPredecessor}validateTypes(ganttRecord){let parentGanttRecord,violatedParent,violateType,predecessor=this.getValidPredecessor(ganttRecord);this.validationPredecessor=[];let startDate=this.getPredecessorDate(ganttRecord,predecessor),ganttTaskData=ganttRecord.ganttProperties,endDate=this.dateValidateModule.getEndDate(startDate,ganttTaskData.duration,ganttTaskData.durationUnit,ganttTaskData,!1);for(let i=0;i<predecessor.length;i++){parentGanttRecord=this.parent.getRecordByID(predecessor[i].from);let violationType=null;"FS"===predecessor[i].type?ganttTaskData.startDate<startDate?(this.validationPredecessor.push(predecessor[i]),violationType="taskBeforePredecessor_FS"):ganttTaskData.startDate>startDate&&(this.validationPredecessor.push(predecessor[i]),violationType="taskAfterPredecessor_FS"):"SS"===predecessor[i].type?ganttTaskData.startDate<startDate?(this.validationPredecessor.push(predecessor[i]),violationType="taskBeforePredecessor_SS"):ganttTaskData.startDate>startDate&&(this.validationPredecessor.push(predecessor[i]),violationType="taskAfterPredecessor_SS"):"FF"===predecessor[i].type?endDate<parentGanttRecord.ganttProperties.endDate?(this.validationPredecessor.push(predecessor[i]),violationType="taskBeforePredecessor_FF"):endDate>parentGanttRecord.ganttProperties.endDate&&(this.validationPredecessor.push(predecessor[i]),violationType="taskAfterPredecessor_FF"):"SF"===predecessor[i].type&&(endDate<parentGanttRecord.ganttProperties.startDate?(this.validationPredecessor.push(predecessor[i]),violationType="taskBeforePredecessor_SF"):endDate>parentGanttRecord.ganttProperties.startDate&&(this.validationPredecessor.push(predecessor[i]),violationType="taskAfterPredecessor_SF")),!isNullOrUndefined(violationType)&&isNullOrUndefined(violateType)&&(violatedParent=parentGanttRecord,violateType=violationType)}return{parentTask:violatedParent,task:ganttRecord,violationType:violateType}}addRemovePredecessor(data){let prevData=this.parent.previousRecords[data.uniqueID],newPredecessor=data.ganttProperties.predecessor.slice();if(prevData&&prevData.ganttProperties&&prevData.ganttProperties.hasOwnProperty("predecessor")){let prevPredecessor=prevData.ganttProperties.predecessor;if(!isNullOrUndefined(prevPredecessor))for(let p=0;p<prevPredecessor.length;p++){let parentGanttRecord=this.parent.getRecordByID(prevPredecessor[p].from);if(parentGanttRecord===data)data.ganttProperties.predecessor.push(prevPredecessor[p]);else{let parentPredecessor=extend([],[],parentGanttRecord.ganttProperties.predecessor,!0),parentIndex=ej2_gantt_es2015_getIndex(prevPredecessor[p],"from",parentPredecessor,"to");-1!==parentIndex&&(parentPredecessor.splice(parentIndex,1),this.parent.setRecordValue("predecessor",parentPredecessor,parentGanttRecord.ganttProperties,!0))}}if(!isNullOrUndefined(newPredecessor))for(let n=0;n<newPredecessor.length;n++){let parentGanttRecord=this.parent.getRecordByID(newPredecessor[n].from),parentPredecessor=extend([],[],parentGanttRecord.ganttProperties.predecessor,!0);parentPredecessor.push(newPredecessor[n]),this.parent.setRecordValue("predecessor",parentPredecessor,parentGanttRecord.ganttProperties,!0)}}}removePredecessor(childRecord,index){let childPredecessor=childRecord.ganttProperties.predecessor,predecessor=childPredecessor.splice(index,1),parentPredecessor=this.parent.getRecordByID(predecessor[0].from).ganttProperties.predecessor,parentIndex=ej2_gantt_es2015_getIndex(predecessor[0],"from",parentPredecessor,"to");parentPredecessor.splice(parentIndex,1);let predecessorString=this.parent.predecessorModule.getPredecessorStringValue(childRecord);childPredecessor.push(predecessor[0]),this.parent.connectorLineEditModule.updatePredecessor(childRecord,predecessorString)}renderPredecessorDeleteConfirmDialog(){this.confirmPredecessorDialog=new ej2_popups_es2015_Dialog({width:"320px",isModal:!0,content:this.parent.localeObj.getConstant("confirmPredecessorDelete"),buttons:[{click:this.confirmOkDeleteButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.confirmCloseDialog.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});let confirmDialog=ej2_base_es2015_createElement("div",{id:this.parent.element.id+"_deletePredecessorConfirmDialog"});this.parent.element.appendChild(confirmDialog),this.confirmPredecessorDialog.isStringTemplate=!0,this.confirmPredecessorDialog.appendTo(confirmDialog)}confirmCloseDialog(){this.confirmPredecessorDialog.destroy()}confirmOkDeleteButton(){this.parent.predecessorModule.removePredecessor(this.childRecord,this.predecessorIndex),this.confirmPredecessorDialog.destroy()}}class ej2_gantt_es2015_ConnectorLine{constructor(ganttObj){this.parent=ganttObj,this.dependencyViewContainer=ej2_base_es2015_createElement("div",{className:dependencyViewContainer}),this.initPublicProp()}getconnectorLineGap(data){return data.milestoneChild?this.parent.chartRowsModule.milestoneMarginTop/2+this.parent.chartRowsModule.milestoneHeight/2:this.parent.chartRowsModule.taskBarMarginTop/2+this.parent.chartRowsModule.taskBarHeight/2}initPublicProp(){this.lineColor=this.parent.connectorLineBackground,this.lineStroke=this.parent.connectorLineWidth>4?4:this.parent.connectorLineWidth,this.createConnectorLineTooltipTable()}getTaskbarMidpoint(isMilestone){return Math.floor(isMilestone?this.parent.chartRowsModule.milestoneMarginTop+this.parent.chartRowsModule.milestoneHeight/2:this.parent.chartRowsModule.taskBarMarginTop+this.parent.chartRowsModule.taskBarHeight/2)+1}createConnectorLineObject(parentGanttData,childGanttData,predecessor){let connectorObj={},updatedRecords=this.parent.getExpandedRecords(this.parent.currentViewData),parentIndex=updatedRecords.indexOf(parentGanttData),childIndex=updatedRecords.indexOf(childGanttData),parentGanttRecord=parentGanttData.ganttProperties,childGanttRecord=childGanttData.ganttProperties;return-1===parentIndex||-1===childIndex?null:(connectorObj.parentLeft=parentGanttRecord.isMilestone?parentGanttRecord.left-this.parent.chartRowsModule.milestoneHeight/2:parentGanttRecord.left,connectorObj.childLeft=childGanttRecord.isMilestone?childGanttRecord.left-this.parent.chartRowsModule.milestoneHeight/2:childGanttRecord.left,connectorObj.parentWidth=0===parentGanttRecord.width||parentGanttRecord.isMilestone?Math.floor(this.parent.chartRowsModule.milestoneHeight):parentGanttRecord.width,connectorObj.childWidth=0===childGanttRecord.width||childGanttRecord.isMilestone?Math.floor(this.parent.chartRowsModule.milestoneHeight):childGanttRecord.width,connectorObj.parentIndex=parentIndex,connectorObj.childIndex=childIndex,connectorObj.rowHeight=this.parent.rowHeight,connectorObj.type=predecessor.type,connectorObj.connectorLineId="parent"+parentGanttRecord.taskId+"child"+childGanttRecord.taskId,connectorObj.milestoneParent=!!parentGanttRecord.isMilestone,connectorObj.milestoneChild=!!childGanttRecord.isMilestone,isNullOrUndefined(isScheduledTask(parentGanttRecord))||isNullOrUndefined(isScheduledTask(childGanttRecord))?null:connectorObj)}renderConnectorLines(connectorLinesCollection){let connectorLine$$1="";for(let index=0;index<connectorLinesCollection.length;index++)connectorLine$$1+=this.getConnectorLineTemplate(connectorLinesCollection[index]);this.dependencyViewContainer.innerHTML=connectorLine$$1,this.parent.ganttChartModule.scrollElement.appendChild(this.dependencyViewContainer)}getParentPosition(data){if(data.parentIndex<data.childIndex){if("FF"===data.type)return data.childLeft+data.childWidth>=data.parentLeft+data.parentWidth?"FFType2":"FFType1";if(data.parentLeft<data.childLeft&&data.childLeft>data.parentLeft+data.parentWidth+25){if("FS"===data.type)return"FSType1";if("SF"===data.type)return"SFType1";if("SS"===data.type)return"SSType2";if("FF"===data.type)return"FFType2"}else if(data.parentLeft<data.childLeft&&data.childLeft<data.parentLeft+data.parentWidth||data.parentLeft===data.childLeft||data.parentLeft>data.childLeft){if(data.parentLeft>data.childLeft+data.childWidth+25&&"SF"===data.type)return"SFType2";if(data.parentLeft>data.childLeft){if("SS"===data.type)return"SSType1";if("SF"===data.type)return"SFType1";if("FF"===data.type)return"FFType1"}else if(data.childLeft+data.childWidth>data.parentLeft+data.parentWidth&&"FF"===data.type)return"FFType2";if("FS"===data.type)return"FSType2";if("SS"===data.type)return"SSType2";if("FF"===data.type)return"FFType1";if("SF"===data.type)return"SFType1"}else if(data.parentLeft<data.childLeft){if("FS"===data.type)return"FSType2";if("FF"===data.type)return"FFType2";if("SS"===data.type)return"SSType2";if("SF"===data.type)return"SFType1"}}else if(data.parentIndex>data.childIndex)if(data.parentLeft<data.childLeft&&data.childLeft>data.parentLeft+data.parentWidth){if("FS"===data.type)return 30>=data.childLeft-(data.milestoneParent?data.parentLeft+data.parentWidth+4:data.parentLeft+data.parentWidth)?"FSType3":"FSType4";if(data.parentLeft<data.childLeft||data.childLeft+data.childWidth>data.parentLeft+data.parentWidth){if("SS"===data.type)return"SSType4";if("FF"===data.type)return"FFType4";if("SF"===data.type)return"SFType4"}else if(data.childLeft+data.childWidth>data.parentLeft+data.parentWidth&&"FF"===data.type)return"FFType4"}else if(data.parentLeft<data.childLeft&&data.childLeft<data.parentLeft+data.parentWidth||data.parentLeft===data.childLeft||data.parentLeft>data.childLeft){if(data.childLeft+data.childWidth<=data.parentLeft+data.parentWidth){if("FF"===data.type)return"FFType3";if("SF"===data.type)return data.childLeft+data.childWidth+25<data.parentLeft?"SFType3":"SFType4";if("SS"===data.type)return data.childLeft<=data.parentLeft?"SSType3":"SSType4"}else if(data.childLeft+data.childWidth>data.parentLeft+data.parentWidth){if("FF"===data.type)return"FFType4";if("SF"===data.type)return"SFType4";if("SS"===data.type)return data.childLeft<=data.parentLeft?"SSType3":"SSType4"}if("FS"===data.type)return"FSType3"}else if(data.parentLeft<data.childLeft){if("FS"===data.type)return"FSType3";if("SS"===data.type)return"SSType4";if("FF"===data.type)return"FFType4";if("SF"===data.type)return"SFType4"}return null}getHeightValue(data){return data.parentIndex*data.rowHeight>data.childIndex*data.rowHeight?data.parentIndex*data.rowHeight-data.childIndex*data.rowHeight:data.childIndex*data.rowHeight-data.parentIndex*data.rowHeight}getInnerElementWidthSSType2(data){return data.parentLeft===data.childLeft?10:data.childLeft-data.parentLeft}getInnerElementLeftSSType2(data){return data.parentLeft===data.childLeft?data.parentLeft-20:data.parentLeft-10}getInnerChildWidthSSType2(data){return data.parentLeft+data.parentWidth<data.childLeft?10:data.parentLeft===data.childLeft?20:data.parentLeft+data.parentWidth>=data.childLeft?10:data.childLeft-data.parentLeft}getBorderStyles(cssType,unit){return"border-"+cssType+"-width:"+unit+"px;border-"+cssType+"-style:solid;"+(isNullOrUndefined(this.lineColor)?"":"border-"+cssType+"-color:"+this.lineColor+";")}getConnectorLineTemplate(data){let setInnerChildWidthSSType2=this.getInnerChildWidthSSType2(data),setInnerElementWidthSSType2=this.getInnerElementWidthSSType2(data),setInnerElementLeftSSType2=this.getInnerElementLeftSSType2(data),heightValue=this.getHeightValue(data),isMilestoneParent=!!data.milestoneParent,isMilestone=!!data.milestoneChild,connectorContainer="";if(this.getParentPosition(data)){connectorContainer='<div id="ConnectorLine'+data.connectorLineId+'" style="background-color=black">';let div='<div class="'+connectorLineContainer+'" tabindex="-1" aria-label="'+this.generateAriaLabel(data)+'" style="',eLine='<div class="'+connectorLine+'" style="'+(isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),rightArrow='<div class="'+connectorLineRightArrow+'" style="'+(isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),leftArrow='<div class="'+connectorLineLeftArrow+'" style="'+(isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),duplicateStingOne=leftArrow+(isMilestone?"left:0px;":"")+this.getBorderStyles("right",10)+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',duplicateStingTwo=this.getBorderStyles("left",10)+"top:"+-6+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',duplicateStingThree=this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>'+eLine+"top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-(this.lineStroke-1))+'position:relative;"></div>',duplicateStingFour=leftArrow+"left:"+(data.childLeft+data.childWidth-data.parentLeft+10)+"px;"+this.getBorderStyles("right",10),duplicateStingFive="top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>';"FSType1"===this.getParentPosition(data)&&(div=div+"left:"+(data.parentLeft+data.parentWidth)+"px;top:"+(data.parentIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="FSType1">',div=(div+=eLine)+"left:"+(isMilestoneParent?-1:0)+"px;width:"+(isMilestoneParent?data.childLeft-(data.parentLeft+data.parentWidth+10)+this.lineStroke-10+1:data.childLeft-(data.parentLeft+data.parentWidth+10)+this.lineStroke-10)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.childLeft-(data.parentLeft+data.parentWidth+10)-10)+"px;width:0px;"+this.getBorderStyles("right",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.childLeft-(data.parentLeft+data.parentWidth+10)-10)+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=rightArrow)+"left:"+(data.childLeft-(data.parentLeft+data.parentWidth+10))+"px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FSType2"===this.getParentPosition(data)&&(div=div+"left:"+data.parentLeft+"px;top:"+(data.parentIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="FSType2">',div=(div+=eLine)+"left:"+(isMilestoneParent?data.parentWidth-1:data.parentWidth)+"px;width:"+(isMilestoneParent?11:10)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.parentWidth+10-this.lineStroke)+"px;"+this.getBorderStyles("left",this.lineStroke)+"width:0px;"+this.getBorderStyles("top",heightValue-this.getconnectorLineGap(data)-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.parentWidth-(data.parentLeft+data.parentWidth-data.childLeft+20))+"px;width:"+(data.parentLeft+data.parentWidth-data.childLeft+30)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.parentWidth-(data.parentLeft+data.parentWidth-data.childLeft+20))+"px;width:0px;"+this.getBorderStyles("top",this.getconnectorLineGap(data)-this.lineStroke)+this.getBorderStyles("left",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.parentWidth-(data.parentLeft+data.parentWidth-data.childLeft+20))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=rightArrow)+"left:"+(data.parentWidth-(data.parentLeft+data.parentWidth-data.childLeft+10))+"px;"+this.getBorderStyles("left",10)+"border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+"px;top:"+(-6-this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FSType3"===this.getParentPosition(data)&&(div=div+"left:"+(data.childLeft-20)+"px;top:"+(data.childIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestoneParent)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="FSType3">',div=(div+=rightArrow)+"left:10px;"+this.getBorderStyles("left",10)+"border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+"px;top:"+-6+'px;width:0;height:0;position:relative;"></div>',div=(div+=eLine)+"width:10px;"+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(6+(5+this.lineStroke)+Math.round(this.lineStroke/2))+'px;"></div>',div=(div+=eLine)+"width:"+this.lineStroke+"px;"+this.getBorderStyles("top",heightValue-this.getconnectorLineGap(data)-this.lineStroke+1)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',div=(div+=eLine)+"width:"+(data.parentLeft+data.parentWidth-data.childLeft+30)+"px;"+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',div=(div+=eLine)+"left:"+(data.parentLeft+data.parentWidth-data.childLeft+(30-this.lineStroke))+"px;width:0px;height:"+(this.getconnectorLineGap(data)-this.lineStroke)+"px;"+this.getBorderStyles("left",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',div=(div+=eLine)+(isMilestoneParent?"left:"+(data.parentLeft+data.parentWidth-data.childLeft+(18-this.lineStroke))+"px;width:"+(12+this.lineStroke)+"px;":"left:"+(data.parentLeft+data.parentWidth-data.childLeft+20)+"px;width:10px;")+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div></div>'),"FSType4"===this.getParentPosition(data)&&(div=div+"left:"+(data.parentLeft+data.parentWidth)+"px;top:"+(data.childIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="FSType4">',div=(div+=rightArrow)+"left:"+(data.childLeft-(data.parentLeft+data.parentWidth+10))+"px;"+this.getBorderStyles("left",10)+"top:"+-6+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',div=(div+=eLine)+"left:"+(data.childLeft-(data.parentLeft+data.parentWidth)-20)+"px;top:"+-(6+(5+this.lineStroke)+Math.round(this.lineStroke/2))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"top:"+-(13+2*(this.lineStroke-1))+"px;left:"+(data.childLeft-(data.parentLeft+data.parentWidth)-20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke+1)+'position:relative;"></div>',div=(div+=eLine)+(isMilestoneParent?"left:-1px;":"")+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(isMilestoneParent?data.childLeft-(data.parentLeft+data.parentWidth+20)+1+this.lineStroke:data.childLeft-(data.parentLeft+data.parentWidth+20)+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType4"===this.getParentPosition(data)&&(div=div+"left:"+(data.parentLeft-10)+"px;top:"+(data.childIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="SSType4">',div=(div+=rightArrow)+"left:"+(data.childLeft-data.parentLeft)+"px;"+duplicateStingTwo,div=(div+=eLine)+"top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;width:"+(data.childLeft-data.parentLeft)+"px;"+duplicateStingThree,div=(div+=eLine)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType3"===this.getParentPosition(data)&&(div=div+"left:"+(data.childLeft-20)+"px;top:"+(data.childIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="SSType3">',div=(div+=rightArrow)+"left:10px;"+duplicateStingTwo,div=(div+=eLine)+"top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;width:10px;"+duplicateStingThree,div=(div+=eLine)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(data.parentLeft-data.childLeft+21)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType2"===this.getParentPosition(data)&&(div=div+"left:"+setInnerElementLeftSSType2+"px;top:"+(data.parentIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestoneParent)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="SSType2">',div=(div+=eLine)+"width:"+(setInnerChildWidthSSType2+1)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"width:"+setInnerElementWidthSSType2+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=rightArrow)+"left:"+setInnerElementWidthSSType2+"px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"SSType1"===this.getParentPosition(data)&&(div=div+"left:"+(data.childLeft-20)+"px;top:"+(data.parentIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestoneParent)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="SSType1">',div=(div+=eLine)+"width:"+(data.parentLeft-data.childLeft+21)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=rightArrow)+"left:10px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType1"===this.getParentPosition(data)&&(div=div+"left:"+(data.childLeft+data.childWidth)+"px;top:"+(data.parentIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestoneParent)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="FFType1">',div=(div+=eLine)+"left:"+(isMilestoneParent?data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth)-1:data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth))+"px;width:"+(isMilestoneParent?21+this.lineStroke:20+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth)+20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(isMilestone?4:10)+"px;width:"+(isMilestone?data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth)+(16+this.lineStroke):data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth)+(10+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=leftArrow)+(isMilestone?"left:0px;":"")+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType2"===this.getParentPosition(data)&&(div=div+"left:"+(data.parentLeft+data.parentWidth)+"px;top:"+(data.parentIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestoneParent)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="FFType2">',div=(div+=eLine)+(isMilestoneParent?"left:-1px;":"")+"width:"+(isMilestoneParent?data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+(21+this.lineStroke):data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+(20+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(isMilestone?data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+4:data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+10)+"px;width:"+(isMilestone?16+this.lineStroke:10+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=leftArrow)+"left:"+(data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth))+"px;"+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType3"===this.getParentPosition(data)&&(div=div+"left:"+(data.childLeft+data.childWidth)+"px;top:"+(data.childIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="FFType3">',div+=duplicateStingOne,div=(div+=eLine)+(isMilestone?"left:4px;width:"+(data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth)+16):"left:10px;width:"+(data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth)+10))+"px;top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth)+20)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke+1)+'position:relative;"></div>',div=(div+=eLine)+(isMilestoneParent?"left:"+(data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth)-1)+"px;width:21":"left:"+(data.parentLeft+data.parentWidth-(data.childLeft+data.childWidth))+"px;width:20")+"px;top:"+-(13+2*(this.lineStroke-1))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"FFType4"===this.getParentPosition(data)&&(div=div+"left:"+(data.parentLeft+data.parentWidth)+"px;top:"+(data.childIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="FFType4">',div=(div+=leftArrow)+"left:"+(data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth))+"px;"+this.getBorderStyles("right",10)+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',div=(div+=eLine)+(isMilestone?"left:"+(data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+4)+"px;width:"+(16+this.lineStroke):"left:"+(data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+10)+"px;width:"+(10+this.lineStroke))+"px;"+duplicateStingFive,div=(div+=eLine)+"left:"+(data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+20)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke+1)+'position:relative;"></div>',div=(div+=eLine)+(isMilestoneParent?"left:-1px;width:"+(data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+(21+this.lineStroke)):"width:"+(data.childLeft+data.childWidth-(data.parentLeft+data.parentWidth)+(20+this.lineStroke)))+"px;top:"+-(13+2*(this.lineStroke-1))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType4"===this.getParentPosition(data)&&(div=(div=div+"left:"+(data.parentLeft-10)+"px;top:"+(data.childIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="SFType4">')+duplicateStingFour+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',div=(div+=eLine)+"left:"+(isMilestone?data.childLeft+data.childWidth-data.parentLeft+(14+this.lineStroke)+"px;width:16":data.childLeft+data.childWidth-data.parentLeft+20+"px;width:"+(10+this.lineStroke))+"px;"+duplicateStingFive,div=(div+=eLine)+"left:"+(data.childLeft+data.childWidth-data.parentLeft+30)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.getconnectorLineGap(data)-(this.lineStroke-1))+'position:relative;"></div>',div=(div+=eLine)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(data.childLeft+data.childWidth-data.parentLeft+(30+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",this.getconnectorLineGap(data)-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType3"===this.getParentPosition(data)&&(div=div+"left:"+(data.childLeft+data.childWidth)+"px;top:"+(data.childIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="SFType3">',div+=duplicateStingOne,div=(div+=eLine)+(isMilestone?"left:4px;width:"+(16+this.lineStroke):"left:10px;width:"+(10+this.lineStroke))+"px;top:"+-(13+2*(this.lineStroke-1)-1)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:20px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-(this.lineStroke-1))+'position:relative;"></div>',div=(div+=eLine)+"left:20px;top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(data.parentLeft-(data.childLeft+data.childWidth+20)+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType1"===this.getParentPosition(data)&&(div=div+"left:"+(data.parentLeft-10)+"px;top:"+(data.parentIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestone)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="SFType1">',div=(div+=eLine)+"width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.getconnectorLineGap(data)-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"width:"+(data.childLeft+data.childWidth-data.parentLeft+(30+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.childLeft+data.childWidth-data.parentLeft+30)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",this.getconnectorLineGap(data)-this.lineStroke)+'position:relative;"></div>',div=(div=(div+=eLine)+(isMilestone?"left:"+(data.childLeft+data.childWidth-data.parentLeft+15)+"px;width:"+(15+this.lineStroke):"left:"+(data.childLeft+data.childWidth-data.parentLeft+20)+"px;width:"+(10+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>')+duplicateStingFour+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;position:relative;"></div></div>'),"SFType2"===this.getParentPosition(data)&&(div=div+"left:"+(data.childLeft+data.childWidth)+"px;top:"+(data.parentIndex*data.rowHeight+this.getTaskbarMidpoint(isMilestoneParent)-(this.lineStroke-1))+"px;width:1px;height:"+heightValue+'px;position:absolute" data-connectortype="SFType2">',div=(div+=eLine)+"left:"+(data.parentLeft-(data.childLeft+data.childWidth)-10)+"px;width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+"left:"+(data.parentLeft-(data.childLeft+data.childWidth)-10)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",heightValue-this.lineStroke)+'position:relative;"></div>',div=(div+=eLine)+(isMilestone?"left:4px;width:"+(data.parentLeft-(data.childLeft+data.childWidth)-(14-this.lineStroke)):"left:10px;width:"+(data.parentLeft-(data.childLeft+data.childWidth)-(20-this.lineStroke)))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',div=(div+=leftArrow)+"left:0px;"+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),connectorContainer+=div,connectorContainer+="</div>"}return connectorContainer}createConnectorLineTooltipTable(){this.tooltipTable=ej2_base_es2015_createElement("table",{className:".e-tooltiptable",styles:"margin-top:0px",attrs:{cellspacing:"2px",cellpadding:"2px"}});let tooltipBody=ej2_base_es2015_createElement("tbody");tooltipBody.innerHTML="",this.tooltipTable.appendChild(tooltipBody)}getConnectorLineTooltipInnerTd(fromTaskName,fromPredecessorText,toTaskName,toPredecessorText){let innerTd='<tr  id="fromPredecessor"><td >'+this.parent.localeObj.getConstant("from")+"</td><td> ";return(innerTd=(innerTd=innerTd+fromTaskName+" </td><td> "+this.parent.localeObj.getConstant(fromPredecessorText)+" </td> </tr>")+'<tr id="toPredecessor"><td>'+this.parent.localeObj.getConstant("to")+"</td><td> "+toTaskName)+" </td><td> "+this.parent.localeObj.getConstant(toPredecessorText)+" </td></tr></tbody><table>"}generateAriaLabel(data){let type=data.type,updatedRecords=this.parent.getExpandedRecords(this.parent.currentViewData),fromName=updatedRecords[data.parentIndex].ganttProperties.taskName,toName=updatedRecords[data.childIndex].ganttProperties.taskName,start=this.parent.localeObj.getConstant("start"),finish=this.parent.localeObj.getConstant("finish");return"FS"===type?fromName+" "+finish+" to "+toName+" "+start:"FF"===type?fromName+" "+finish+" to "+toName+" "+finish:"SS"===type?fromName+" "+start+" to "+toName+" "+start:fromName+" "+start+" to "+toName+" "+finish}}class ej2_gantt_es2015_ConnectorLineEdit{constructor(ganttObj){this.parent=ganttObj}updateConnectorLineEditElement(e){let element=this.getConnectorLineHoverElement(e.target);getValue("editModule.taskbarEditModule.taskBarEditAction",this.parent)||this.highlightConnectorLineElements(element)}getConnectorLineHoverElement(target){let isOnLine=parentsUntil$1(target,connectorLine),isOnRightArrow=parentsUntil$1(target,connectorLineRightArrow),isOnLeftArrow=parentsUntil$1(target,connectorLineLeftArrow);return isOnLine||isOnRightArrow||isOnLeftArrow?parentsUntil$1(target,connectorLineContainer):null}highlightConnectorLineElements(element){element?element!==this.connectorLineElement&&(this.removeHighlight(),this.addHighlight(element)):this.removeHighlight()}addHighlight(element){this.connectorLineElement=element,addClass([element],[connectorLineHoverZIndex]),addClass(element.querySelectorAll("."+connectorLine),[connectorLineHover]),addClass(element.querySelectorAll("."+connectorLineRightArrow),[connectorLineRightArrowHover]),addClass(element.querySelectorAll("."+connectorLineLeftArrow),[connectorLineLeftArrowHover])}removeHighlight(){isNullOrUndefined(this.connectorLineElement)||(removeClass([this.connectorLineElement],[connectorLineHoverZIndex]),removeClass(this.connectorLineElement.querySelectorAll("."+connectorLine),[connectorLineHover]),removeClass(this.connectorLineElement.querySelectorAll("."+connectorLineRightArrow),[connectorLineRightArrowHover]),removeClass(this.connectorLineElement.querySelectorAll("."+connectorLineLeftArrow),[connectorLineLeftArrowHover]),this.connectorLineElement=null)}getEditedConnectorLineString(records){let ganttRecord,predecessorsCollection,predecessor,parentGanttRecord,childGanttRecord,connectorObj,idArray=[],lineArray=[],editedConnectorLineString="";for(let count=0;count<records.length;count++)if(predecessorsCollection=(ganttRecord=records[count]).ganttProperties.predecessor){for(let predecessorCount=0;predecessorCount<predecessorsCollection.length;predecessorCount++){let from="from",to="to";if(this.removeConnectorLineById("parent"+(predecessor=predecessorsCollection[predecessorCount])[from]+"child"+predecessor[to]),parentGanttRecord=this.parent.getRecordByID(predecessor[from]),childGanttRecord=this.parent.getRecordByID(predecessor[to]),(parentGanttRecord&&!0===parentGanttRecord.expanded||childGanttRecord&&!0===childGanttRecord.expanded)&&!isNullOrUndefined(connectorObj=this.updateConnectorLineObject(parentGanttRecord,childGanttRecord,predecessor))){let lineIndex=idArray.indexOf(connectorObj.connectorLineId),lineString=this.parent.connectorLineModule.getConnectorLineTemplate(connectorObj);-1!==lineIndex?lineArray[lineIndex]=lineString:(idArray.push(connectorObj.connectorLineId),lineArray.push(lineString))}}editedConnectorLineString=lineArray.join("")}return editedConnectorLineString}updateConnectorLineObject(parentGanttRecord,childGanttRecord,predecessor){let connectorObj;if(connectorObj=this.parent.connectorLineModule.createConnectorLineObject(parentGanttRecord,childGanttRecord,predecessor)){if(this.parent.connectorLineIds.length>0&&-1===this.parent.connectorLineIds.indexOf(connectorObj.connectorLineId))this.parent.updatedConnectorLineCollection.push(connectorObj),this.parent.connectorLineIds.push(connectorObj.connectorLineId);else if(0===this.parent.connectorLineIds.length)this.parent.updatedConnectorLineCollection.push(connectorObj),this.parent.connectorLineIds.push(connectorObj.connectorLineId);else if(-1!==this.parent.connectorLineIds.indexOf(connectorObj.connectorLineId)){let index=this.parent.connectorLineIds.indexOf(connectorObj.connectorLineId);this.parent.updatedConnectorLineCollection[index]=connectorObj}predecessor.isDrawn=!0}return connectorObj}refreshEditedRecordConnectorLine(editedRecord){let editedConnectorLineString;this.removePreviousConnectorLines(this.parent.previousRecords),editedConnectorLineString=this.getEditedConnectorLineString(editedRecord),this.parent.connectorLineModule.dependencyViewContainer.innerHTML=this.parent.connectorLineModule.dependencyViewContainer.innerHTML+editedConnectorLineString}removePreviousConnectorLines(records){let isObjectType,length=(isObjectType=!0===ej2_base_es2015_isObject(records))?Object.keys(records).length:records.length,keys=Object.keys(records);for(let i=0;i<length;i++){let data,predecessors;if((predecessors=(data=isObjectType?records[keys[i]]:records[i]).ganttProperties&&data.ganttProperties.predecessor)&&predecessors.length>0)for(let pre=0;pre<predecessors.length;pre++)this.removeConnectorLineById("parent"+predecessors[pre].from+"child"+predecessors[pre].to)}}removeConnectorLineById(id){let element=this.parent.connectorLineModule.dependencyViewContainer.querySelector("#ConnectorLine"+id);isNullOrUndefined(element)||ej2_base_es2015_remove(element)}idFromPredecessor(pre){let preArray=pre.split(","),preIdArray=[];for(let j=0;j<preArray.length;j++){let strArray=[];for(let i=0;i<preArray[j].length&&!isNullOrUndefined(preArray[j].charAt(i))&&"NaN"!==parseInt(preArray[j].charAt(i),10).toString();i++)strArray.push(preArray[j].charAt(i));preIdArray.push(strArray.join(""))}return preIdArray}predecessorValidation(predecessor,record){let currentId,currentRecord,recordId=record.taskId;for(let count=0;count<predecessor.length;count++){currentId=predecessor[count];let visitedIdArray=[];for(predecessor.slice(0).splice(count,1);null!==currentId;){let currentIdArray=[];if(-1!==visitedIdArray.indexOf(currentId))break;if(isNullOrUndefined(this.parent.getRecordByID(currentId)))return!1;if(!isNullOrUndefined((currentRecord=this.parent.getRecordByID(currentId).ganttProperties).predecessor)&&currentRecord.predecessor.length>0&&currentRecord.predecessor.forEach(value=>{currentRecord.taskId.toString()!==value.from&&currentIdArray.push(value.from.toString())}),recordId.toString()===currentRecord.taskId.toString()||-1!==currentIdArray.indexOf(recordId.toString()))return!1;if(visitedIdArray.push(currentId),isNullOrUndefined(currentRecord.predecessor)||!(currentRecord.predecessor.length>0))break;currentId=currentRecord.predecessor[0].from}}return!0}validatePredecessorRelation(ganttRecord,predecessorString){let predecessorIdArray,currentId,recordId=ganttRecord.ganttProperties.taskId;if(!isNullOrUndefined(predecessorString)&&predecessorString.length>0){predecessorIdArray=this.idFromPredecessor(predecessorString);for(let count=0;count<predecessorIdArray.length;count++){if(!this.checkParentRelation(ganttRecord,predecessorIdArray))return!1;let tempIdArray=predecessorIdArray.slice(0),checkArray=[],countFlag=!0;if(tempIdArray.forEach(value=>{-1===checkArray.indexOf(value)?checkArray.push(value):countFlag=!1}),!countFlag)return!1;currentId=predecessorIdArray[count];let visitedIdArray=[];for(predecessorIdArray.slice(0).splice(count,1);null!==currentId;){let currentIdIndex,currentRecord,currentIdArray=[];if(-1!==visitedIdArray.indexOf(currentId))break;if(isNullOrUndefined(this.parent.getRecordByID(currentId.toString())))return!1;if(!isNullOrUndefined((currentRecord=this.parent.getRecordByID(currentId.toString()).ganttProperties).predecessor)&&currentRecord.predecessor.length>0&&currentRecord.predecessor.forEach((value,index)=>{currentRecord.taskId.toString()!==value.from&&(currentIdArray.push(value.from.toString()),currentIdIndex=index)}),recordId.toString()===currentRecord.taskId.toString()||-1!==currentIdArray.indexOf(recordId.toString()))return!1;if(visitedIdArray.push(currentId),isNullOrUndefined(currentRecord.predecessor)||!(currentRecord.predecessor.length>0))break;{let result;if(currentIdArray.length>1?result=this.predecessorValidation(currentIdArray,ganttRecord.ganttProperties):1===currentIdArray.length&&(currentId=currentRecord.predecessor[currentIdIndex].from),!1===result)return!1}}}}return!0}addPredecessor(ganttRecord,predecessorString){let tempPredecessorString=isNullOrUndefined(ganttRecord.ganttProperties.predecessorsName)||""===ganttRecord.ganttProperties.predecessorsName?predecessorString:ganttRecord.ganttProperties.predecessorsName+","+predecessorString;this.updatePredecessorHelper(ganttRecord,tempPredecessorString)}removePredecessor(ganttRecord){this.updatePredecessorHelper(ganttRecord,null)}updatePredecessor(ganttRecord,predecessorString){return this.updatePredecessorHelper(ganttRecord,predecessorString)}updatePredecessorHelper(ganttRecord,predecessorString){if(isUndefined(predecessorString)||this.validatePredecessorRelation(ganttRecord,predecessorString)){this.parent.isOnEdit=!0;let predecessorCollection=[];isNullOrUndefined(predecessorString)||""===predecessorString||(predecessorCollection=this.parent.predecessorModule.calculatePredecessor(predecessorString,ganttRecord)),this.parent.setRecordValue("predecessor",predecessorCollection,ganttRecord.ganttProperties,!0);let stringValue=this.parent.predecessorModule.getPredecessorStringValue(ganttRecord);this.parent.setRecordValue("predecessorsName",stringValue,ganttRecord.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,stringValue,ganttRecord),this.parent.setRecordValue(this.parent.taskFields.dependency,stringValue,ganttRecord);let args={};return args.data=ganttRecord,this.parent.editModule.initiateUpdateAction(args),!0}return!1}checkParentRelation(ganttRecord,predecessorIdArray){if(ganttRecord&&ganttRecord.parentItem&&-1!==predecessorIdArray.indexOf(ganttRecord.parentItem.taskId.toString()))return!1;for(let p=0;p<predecessorIdArray.length;p++){let record=this.parent.currentViewData.filter(item=>item&&item.ganttProperties.taskId.toString()===predecessorIdArray[p].toString());if(record[0]&&record[0].hasChildRecords)return!1}return!0}}class ej2_gantt_es2015_Splitter$1{constructor(ganttObj){this.parent=ganttObj,this.parent.on("destroy",this.destroy,this)}renderSplitter(){let toolbarHeight=0;isNullOrUndefined(this.parent.toolbarModule)||isNullOrUndefined(this.parent.toolbarModule.element)||(toolbarHeight=this.parent.toolbarModule.element.offsetHeight);let splitterPosition=this.calculateSplitterPosition(this.parent.splitterSettings);this.parent.splitterElement=ej2_base_es2015_createElement("div",{className:splitter}),this.parent.treeGridPane=ej2_base_es2015_createElement("div",{className:treeGridPane}),this.parent.chartPane=ej2_base_es2015_createElement("div",{className:ganttChartPane}),this.parent.splitterElement.appendChild(this.parent.treeGridPane),this.parent.splitterElement.appendChild(this.parent.chartPane),this.splitterObject=new ej2_layouts_es2015_Splitter({height:(this.parent.ganttHeight-toolbarHeight).toString(),width:this.parent.ganttWidth.toString(),separatorSize:this.parent.splitterSettings.separatorSize,paneSettings:[{resizable:!0,size:splitterPosition,min:this.getSpliterPositionInPercentage(this.parent.splitterSettings.minimum)},{resizable:!0}],orientation:"Horizontal",resizeStart:args=>{let leftPane=isBlazor()?args.element.querySelectorAll(".e-pane")[0]:args.pane[0],rightPane=isBlazor()?args.element.querySelectorAll(".e-pane")[1]:args.pane[1];this.splitterPreviousPositionGrid=leftPane.scrollWidth+1+"px",this.splitterPreviousPositionChart=rightPane.scrollWidth+1+"px";let callBackPromise=new Deferred;return this.parent.trigger("splitterResizeStart",args,resizeStartArgs=>{callBackPromise.resolve(resizeStartArgs)}),callBackPromise},resizing:args=>{this.parent.trigger("splitterResizing",args)},resizeStop:args=>{let callBackPromise=new Deferred;return this.parent.trigger("splitterResized",args,splitterResizedArgs=>{!0===splitterResizedArgs.cancel&&(this.splitterObject.paneSettings[0].size=null,this.splitterObject.paneSettings[0].size=this.getSpliterPositionInPercentage(this.splitterPreviousPositionGrid),this.splitterObject.paneSettings[1].size=null,this.splitterObject.paneSettings[1].size=this.getSpliterPositionInPercentage(this.splitterPreviousPositionChart)),callBackPromise.resolve(splitterResizedArgs)}),callBackPromise}}),this.parent.element.appendChild(this.parent.splitterElement),this.splitterObject.appendTo(this.parent.splitterElement)}calculateSplitterPosition(splitter$$1,isDynamic){return"Grid"===splitter$$1.view?"100%":"Chart"===splitter$$1.view?"0%":isNullOrUndefined(splitter$$1.position)||""===splitter$$1.position?!isNullOrUndefined(splitter$$1.columnIndex)&&splitter$$1.columnIndex>=0?this.getSpliterPositionInPercentage(isDynamic?this.getTotalColumnWidthByIndex(splitter$$1.columnIndex).toString()+"px":150*splitter$$1.columnIndex+"px"):this.getSpliterPositionInPercentage("250px"):this.getSpliterPositionInPercentage(splitter$$1.position)}getSpliterPositionInPercentage(position){let value=isNullOrUndefined(position)||""===position?null:position;if(!isNullOrUndefined(value))if(-1!==position.indexOf("px")){let intValue=parseInt(position,10);value=intValue/this.parent.ganttWidth*100<=100?intValue/this.parent.ganttWidth*100+"%":"100%"}else value=-1===position.indexOf("%")?position+"%":position;return value}getTotalColumnWidthByIndex(index){let width=0,tr=this.parent.treeGrid.element.querySelectorAll(".e-headercell");index=tr.length>index?index:tr.length;for(let column=0;column<index;column++)width+=tr[column].offsetWidth;return width}updateSplitterPosition(){this.splitterObject.separatorSize=this.parent.splitterSettings.separatorSize>=4?this.parent.splitterSettings.separatorSize:4;let splitterPosition=this.calculateSplitterPosition(this.parent.splitterSettings,!0);this.splitterObject.paneSettings[0].min=this.getSpliterPositionInPercentage(this.parent.splitterSettings.minimum),this.splitterObject.dataBind(),this.splitterObject.paneSettings[0].size=splitterPosition}triggerCustomResizedEvent(){let pane1=this.splitterObject.element.querySelectorAll(".e-pane")[0],pane2=this.splitterObject.element.querySelectorAll(".e-pane")[1],eventArgs={event:null,element:this.splitterObject.element,pane:[pane1,pane2],index:[0,1],separator:this.splitterObject.element.querySelector(".e-split-bar"),paneSize:[pane1.offsetWidth,pane2.offsetWidth]};this.parent.trigger("splitterResized",eventArgs),!0===eventArgs.cancel&&(this.splitterObject.paneSettings[0].size=this.getSpliterPositionInPercentage(this.splitterPreviousPositionGrid),this.splitterObject.paneSettings[1].size=this.getSpliterPositionInPercentage(this.splitterPreviousPositionChart))}destroy(){this.splitterObject.destroy(),this.parent.off("destroy",this.destroy)}}class ej2_gantt_es2015_Tooltip$1{constructor(gantt){this.parent=gantt,this.createTooltip(),this.parent.on("destroy",this.destroy,this)}createTooltip(){this.toolTipObj=new ej2_popups_es2015_Tooltip,this.toolTipObj.target=".e-header-cell-label, .e-gantt-child-taskbar,.e-gantt-parent-taskbar, .e-gantt-milestone, .e-gantt-unscheduled-taskbar.e-event-markers, .e-baseline-bar, .e-event-markers,.e-connector-line-container, .e-indicator-span, .e-notes-info,.e-taskbar-left-resizer, .e-taskbar-right-resizer",this.toolTipObj.position="BottomCenter",this.toolTipObj.openDelay=700,this.toolTipObj.cssClass=ganttTooltip,this.toolTipObj.animation={open:{effect:"None",delay:0},close:{effect:"None",delay:0}},this.toolTipObj.afterOpen=this.updateTooltipPosition.bind(this),this.toolTipObj.showTipPointer=!1,this.toolTipObj.beforeRender=this.tooltipBeforeRender.bind(this),this.toolTipObj.afterClose=this.tooltipCloseHandler.bind(this),this.toolTipObj.isStringTemplate=!0,this.toolTipObj.appendTo(this.parent.element)}tooltipBeforeRender(args){let parent=this.parent;parent.isOnEdit&&(args.cancel=!0);let data,element=parentsUntil$1(args.target,chartRowCell),argsData={data:{},args:args,cancel:!1,content:""};if(args.target.classList.contains("e-header-cell-label"))parent.timelineSettings.showTooltip?argsData.content=this.toolTipObj.content=parent.tooltipModule.getTooltipContent("timeline",data,parent,args):args.cancel=!0;else if(parent.tooltipSettings.showTooltip){if(element&&(argsData.data=parent.ganttChartModule.getRecordByTaskBar(element),data=argsData.data),args.target.classList.contains("e-gantt-child-taskbar")||args.target.classList.contains("e-gantt-parent-taskbar")||args.target.classList.contains("e-gantt-milestone")||args.target.classList.contains("e-gantt-unscheduled-taskbar")||args.target.classList.contains("e-taskbar-left-resizer")||args.target.classList.contains("e-taskbar-right-resizer")){let taskbarTemplateNode;parent.tooltipSettings.taskbar&&(taskbarTemplateNode=parent.tooltipModule.templateCompiler(parent.tooltipSettings.taskbar,parent,data,"TooltipTaskbarTemplate")),argsData.content=this.toolTipObj.content=taskbarTemplateNode?taskbarTemplateNode[0]:parent.tooltipModule.getTooltipContent(data.ganttProperties.isMilestone?"milestone":"taskbar",data,parent,args)}else if(args.target.classList.contains("e-baseline-bar")){let baseLineTemplateNode;parent.tooltipSettings.baseline&&(baseLineTemplateNode=parent.tooltipModule.templateCompiler(parent.tooltipSettings.baseline,parent,data,"TooltipBaselineTemplate")),argsData.content=this.toolTipObj.content=baseLineTemplateNode?baseLineTemplateNode[0]:parent.tooltipModule.getTooltipContent("baseline",data,parent,args)}else if(args.target.classList.contains("e-event-markers"))argsData.content=this.toolTipObj.content=parent.tooltipModule.getTooltipContent("marker",data,parent,args);else if(args.target.classList.contains("e-connector-line-container")){let dependencyLineTemplateNode;parent.tooltipModule.predecessorTooltipData=parent.tooltipModule.getPredecessorTooltipData(args),argsData.data=this.predecessorTooltipData,parent.tooltipSettings.connectorLine&&(dependencyLineTemplateNode=parent.tooltipModule.templateCompiler(parent.tooltipSettings.connectorLine,parent,parent.tooltipModule.predecessorTooltipData,"TooltipConnectorLineTemplate")),argsData.content=this.toolTipObj.content=dependencyLineTemplateNode?dependencyLineTemplateNode[0]:parent.tooltipModule.getTooltipContent("connectorLine",data,parent,args)}else if(args.target.classList.contains("e-indicator-span"))argsData.content=this.toolTipObj.content=parent.tooltipModule.getTooltipContent("indicator",data,parent,args),isNullOrUndefined(argsData.content)&&(args.cancel=!0);else if(args.target.classList.contains("e-notes-info")){let ganttData=this.parent.ganttChartModule.getRecordByTarget(args.event);argsData.content=this.toolTipObj.content=ganttData.ganttProperties.notes,isNullOrUndefined(argsData.content)&&(args.cancel=!0)}}else args.cancel=!0;if(!1===args.cancel){let callBackPromise=new Deferred;return parent.trigger("beforeTooltipRender",argsData,argsData=>{callBackPromise.resolve(argsData),argsData.cancel&&(args.cancel=!0)}),this.parent.isAdaptive||"mouseover"!==args.event.type||(this.currentTarget=args.target,EventHandler.add(this.currentTarget,"mousemove",this.mouseMoveHandler.bind(this))),callBackPromise}}tooltipCloseHandler(args){this.tooltipMouseEvent=null,this.parent.isAdaptive||EventHandler.remove(this.currentTarget,"mousemove",this.mouseMoveHandler),this.currentTarget=null}mouseMoveHandler(e){this.tooltipMouseEvent=e}updateTooltipPosition(args){if(isNullOrUndefined(this.tooltipMouseEvent)||args.target.classList.contains("e-notes-info"))return;let postion=this.getPointorPosition(this.tooltipMouseEvent),containerPosition=this.parent.getOffsetRect(this.parent.chartPane),tooltipPositionX=postion.x,tooltipPositionY=postion.y,tooltipUpdated=!1;containerPosition.left+this.parent.chartPane.offsetWidth<tooltipPositionX+args.element.offsetWidth+20?tooltipPositionX=tooltipPositionX-args.element.offsetWidth-10:tooltipPositionX+=10,containerPosition.top+this.parent.chartPane.offsetHeight<tooltipPositionY+args.element.offsetHeight+20?tooltipPositionY=tooltipPositionY-args.element.offsetHeight-10:(tooltipUpdated=!0,tooltipPositionY+=10),window.innerHeight<args.element.offsetHeight+tooltipPositionY&&(tooltipPositionY=tooltipPositionY-args.element.offsetHeight-(tooltipUpdated?20:10)),args.element.style.left=tooltipPositionX+"px",args.element.style.top=tooltipPositionY+"px"}getPointorPosition(e){let posX,posY;return isNullOrUndefined(getValue("pageX",e))&&isNullOrUndefined(getValue("pageY",e))?isNullOrUndefined(getValue("clientX",e))&&isNullOrUndefined(getValue("clientY",e))||(posX=getValue("clientX",e)+document.body.scrollLeft+document.documentElement.scrollLeft,posY=getValue("clientY",e)+document.body.scrollTop+document.documentElement.scrollTop):(posX=getValue("pageX",e),posY=getValue("pageY",e)),{x:posX,y:posY}}getTooltipContent(elementType,ganttData,parent,args){let content$$1,data;switch(ganttData&&(data=ganttData.ganttProperties),elementType){case"milestone":content$$1='<table class = "e-gantt-tooltiptable"><tbody><tr class = "e-gantt-tooltip-rowcell"><td colspan="3">'+data.taskName+'</td></tr><tr><td class = "e-gantt-tooltip-label"> Date</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(data.startDate,this.parent.dateFormat)+"</tr></tbody></table>";break;case"taskbar":let startDate=data.startDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("startDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getFormatedDate(data.startDate,this.parent.dateFormat)+"</td></tr>":"",endDate=data.endDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("endDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(data.endDate,this.parent.dateFormat)+"</td></tr>":"",duration=isNullOrUndefined(data.duration)?"":'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("duration")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getDurationString(data.duration,data.durationUnit)+"</td></tr>";content$$1='<table class = "e-gantt-tooltiptable"><tbody><tr class = "e-gantt-tooltip-rowcell"><td colspan="3">'+data.taskName+"</td></tr>"+startDate+endDate+duration+'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("progress")+"</td><td>:</td><td>"+data.progress+"</td></tr></tbody></table>";break;case"baseline":content$$1='<table class = "e-gantt-tooltiptable"><tbody><tr class = "e-gantt-tooltip-rowcell"><td colspan="3">'+data.taskName+'</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("baselineStartDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(data.baselineStartDate,this.parent.dateFormat)+'</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("baselineEndDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(data.baselineEndDate,this.parent.dateFormat)+"</td></tr></tbody></table>";break;case"marker":let markerTooltipElement=parent.tooltipModule.getMarkerTooltipData(args),markerLabel=markerTooltipElement.label?markerTooltipElement.label:"";content$$1='<table class = "e-gantt-tooltiptable"><tbody><tr><td>'+this.parent.getFormatedDate(this.parent.dateValidationModule.getDateFromFormat(markerTooltipElement.day),this.parent.dateFormat)+"</td></tr><tr><td>"+markerLabel+"</td></tr></tbody></table>";break;case"connectorLine":content$$1='<table class = "e-gantt-tooltiptable"><tbody><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("from")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+parent.tooltipModule.predecessorTooltipData.fromName+" ("+parent.tooltipModule.predecessorTooltipData.fromId+')</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("to")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+parent.tooltipModule.predecessorTooltipData.toName+" ("+parent.tooltipModule.predecessorTooltipData.toId+')</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("taskLink")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+parent.tooltipModule.predecessorTooltipData.linkText+'</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("lag")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+parent.tooltipModule.predecessorTooltipData.offsetString+"</td></tr></tbody></table>";break;case"indicator":args.target.title.length&&(content$$1='<table class = "e-gantt-tooltiptable"><tbody><tr>'+args.target.title+"</tr></tbody></table>");break;case"timeline":content$$1='<table class = "e-gantt-tooltiptable"><tbody><tr>'+args.target.title+"</tr></tbody></table>"}return content$$1}getMarkerTooltipData(args){let markerTooltipId=args.target.id.match(/\d+/g);return this.parent.eventMarkers[Number(markerTooltipId)]}getPredecessorTooltipData(args){let taskIds=args.target.parentElement.id.match(/\d+/g),fromTask=this.parent.flatData[this.parent.ids.indexOf(taskIds[0])],toTask=this.parent.flatData[this.parent.ids.indexOf(taskIds[1])],predecessor=fromTask.ganttProperties.predecessor.filter(pdc=>pdc.to===taskIds[1]);return{fromId:fromTask.ganttProperties.taskId,toId:toTask.ganttProperties.taskId,fromName:fromTask.ganttProperties.taskName,toName:toTask.ganttProperties.taskName,linkType:predecessor[0].type,linkText:this.parent.getPredecessorTextValue(predecessor[0].type),offset:predecessor[0].offset,offsetUnit:predecessor[0].offsetUnit,offsetString:this.parent.getDurationString(predecessor[0].offset,predecessor[0].offsetUnit)}}templateCompiler(template,parent,data,propName){let tooltipFunction=parent.chartRowsModule.templateCompiler(template),templateID=parent.chartRowsModule.getTemplateID(propName);return tooltipFunction(extend({index:0},data),parent,propName,templateID,!0)}destroy(){this.toolTipObj.destroy()}}let ej2_gantt_es2015_Gantt=(()=>{let Gantt=class extends ej2_base_es2015_Component{constructor(options,element){super(options,element),this.previousRecords={},this.editedRecords=[],this.isOnEdit=!1,this.isOnDelete=!1,this.isConnectorLineUpdate=!1,this.staticSelectedRowIndex=-1,this.needsID=!0,this.isTreeGridRendered=!1,this.isGanttChartRendered=!1}getModuleName(){return"gantt"}onKeyPress(e){let expandedRecords=this.getExpandedRecords(this.currentViewData);if("home"!==e.action&&"end"!==e.action&&"downArrow"!==e.action&&"upArrow"!==e.action&&"delete"!==e.action&&"rightArrow"!==e.action&&"leftArrow"!==e.action&&"focusTask"!==e.action&&"focusSearch"!==e.action&&"expandAll"!==e.action&&"collapseAll"!==e.action||isNullOrUndefined(this.editModule)||isNullOrUndefined(this.editModule.cellEditModule)||!0!==this.editModule.cellEditModule.isCellEdit)switch(this.isAdaptive&&("addRowDialog"!==e.action&&"editRowDialog"!==e.action&&"delete"!==e.action&&"addRow"!==e.action||this.selectionModule&&"Multiple"===this.selectionSettings.type&&(this.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),e.action){case"home":if(this.selectionModule&&"Cell"!==this.selectionSettings.mode){if(0===this.selectedRowIndex)return;this.selectionModule.selectRow(0)}break;case"end":if(this.selectionModule&&"Cell"!==this.selectionSettings.mode){let currentSelectingRecord=expandedRecords[expandedRecords.length-1];if(this.selectedRowIndex===this.currentViewData.indexOf(currentSelectingRecord))return;this.selectionModule.selectRow(this.currentViewData.indexOf(currentSelectingRecord))}break;case"downArrow":case"upArrow":this.upDownKeyNavigate(e);break;case"expandAll":this.ganttChartModule.expandCollapseAll("expand");break;case"collapseAll":this.ganttChartModule.expandCollapseAll("collapse");break;case"expandRow":case"collapseRow":this.expandCollapseKey(e);break;case"saveRequest":isNullOrUndefined(this.editModule)||isNullOrUndefined(this.editModule.cellEditModule)||!0!==this.editModule.cellEditModule.isCellEdit||(this.editModule.cellEditModule.isCellEdit=!1,this.treeGrid.endEdit(),this.element.querySelector(".e-treegrid").focus());break;case"cancelRequest":isNullOrUndefined(this.editModule)||isNullOrUndefined(this.editModule.cellEditModule)||(this.editModule.cellEditModule.isCellEdit=!1,isNullOrUndefined(this.toolbarModule)||this.toolbarModule.refreshToolbarItems());break;case"addRow":e.preventDefault(),this.element.querySelector(".e-gantt-chart").focus(),this.addRecord();break;case"addRowDialog":if(e.preventDefault(),this.editModule&&this.editModule.dialogModule&&this.editSettings.allowAdding){if(this.editModule.dialogModule.dialogObj&&getValue("dialogOpen",this.editModule.dialogModule.dialogObj))return;this.editModule.dialogModule.openAddDialog()}break;case"editRowDialog":if(e.preventDefault(),this.element.querySelector(".e-treegrid").focus(),this.editModule&&this.editModule.dialogModule&&this.editSettings.allowEditing){if(this.editModule.dialogModule.dialogObj&&getValue("dialogOpen",this.editModule.dialogModule.dialogObj))return;this.editModule.dialogModule.openToolbarEditDialog()}break;case"delete":this.selectionModule&&this.editModule&&(!this.editSettings.allowTaskbarEditing||this.editSettings.allowTaskbarEditing&&!this.editModule.taskbarEditModule.touchEdit)&&("Cell"!==this.selectionSettings.mode&&this.selectionModule.selectedRowIndexes.length||"Cell"===this.selectionSettings.mode&&this.selectionModule.getSelectedRowCellIndexes().length)&&this.editModule.startDeleteAction();break;case"focusTask":let selectedId;if(e.preventDefault(),this.selectionModule)if("Cell"===this.selectionSettings.mode||isNullOrUndefined(this.currentViewData[this.selectedRowIndex])){if("Cell"===this.selectionSettings.mode&&this.selectionModule.getSelectedRowCellIndexes().length>0){let selectCellIndex=this.selectionModule.getSelectedRowCellIndexes();selectedId=this.currentViewData[selectCellIndex[selectCellIndex.length-1].rowIndex].ganttProperties.taskId}}else selectedId=this.currentViewData[this.selectedRowIndex].ganttProperties.taskId;selectedId&&this.scrollToTask(selectedId.toString());break;case"focusSearch":if(this.element.querySelector("#"+this.element.id+"_searchbar")){let searchElement=this.element.querySelector("#"+this.element.id+"_searchbar");searchElement.setAttribute("tabIndex","-1"),searchElement.focus()}break;default:this.trigger("actionComplete",{requestType:"keyPressed",action:e.action,keyEvent:e})}}expandCollapseKey(e){if(this.selectionModule&&-1!==this.selectedRowIndex){let selectedRowIndex;if("Cell"!==this.selectionSettings.mode)selectedRowIndex=this.selectedRowIndex;else if("Cell"===this.selectionSettings.mode&&this.selectionModule.getSelectedRowCellIndexes().length>0){let selectCellIndex=this.selectionModule.getSelectedRowCellIndexes();selectedRowIndex=selectCellIndex[selectCellIndex.length-1].rowIndex}"expandRow"===e.action?this.expandByIndex(selectedRowIndex):this.collapseByIndex(selectedRowIndex)}}upDownKeyNavigate(e){e.preventDefault();let expandedRecords=this.getExpandedRecords(this.currentViewData);if(this.selectionModule)if("Cell"!==this.selectionSettings.mode&&-1!==this.selectedRowIndex){let selectingRowIndex=expandedRecords.indexOf(this.currentViewData[this.selectedRowIndex]);this.selectionModule.selectRow(this.currentViewData.indexOf("downArrow"===e.action?expandedRecords[selectingRowIndex+1]:expandedRecords[selectingRowIndex-1]))}else if("Cell"===this.selectionSettings.mode&&this.selectionModule.getSelectedRowCellIndexes().length>0){let selectCellIndex=this.selectionModule.getSelectedRowCellIndexes(),selectedCellItem=selectCellIndex[selectCellIndex.length-1],currentCellIndex=selectedCellItem.cellIndexes[selectedCellItem.cellIndexes.length-1],selectingRowIndex=expandedRecords.indexOf(this.currentViewData[selectedCellItem.rowIndex]),cellInfo={rowIndex:this.currentViewData.indexOf("downArrow"===e.action?expandedRecords[selectingRowIndex+1]:expandedRecords[selectingRowIndex-1]),cellIndex:currentCellIndex};this.selectionModule.selectCell(cellInfo)}}preRender(){this.initProperties()}initProperties(){this.globalize=new Internationalization(this.locale),this.isAdaptive=Browser.isDevice,this.flatData=[],this.currentViewData=[],this.ids=[],this.ganttColumns=[],this.localeObj=new L10n(this.getModuleName(),this.getDefaultLocale(),this.locale),this.dataOperation=new ej2_gantt_es2015_TaskProcessor(this),this.nonWorkingHours=[],this.nonWorkingTimeRanges=[],this.workingTimeRanges=[],this.defaultEndTime=null,this.defaultStartTime=null,this.durationUnitTexts={days:"days",hours:"hours",minutes:"minutes",day:"day",hour:"hour",minute:"minute"},this.durationUnitEditText={minute:["m","min","minute","minutes"],hour:["h","hr","hour","hours"],day:["d","dy","day","days"]},this.perDayWidth=null,this.isMileStoneEdited=!1,this.chartVerticalLineContainer=null,this.updatedConnectorLineCollection=[],this.connectorLineIds=[],this.predecessorsCollection=[],this.isInPredecessorValidation=this.enablePredecessorValidation,this.isValidationEnabled=!0,this.isLoad=!0,this.editedTaskBarItem=null,this.validationDialogElement=null,this.currentEditedArgs={},this.dialogValidateMode={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},this.secondsPerDay=this.dataOperation.getSecondsPerDay(),this.nonWorkingDayIndex=[],this.dataOperation.getNonWorkingDayIndex(),this.columnMapping={},this.controlId=this.element.id,this.cloneProjectStartDate=null,this.cloneProjectEndDate=null,this.totalHolidayDates=this.dataOperation.getHolidayDates(),this.ganttChartModule=new ej2_gantt_es2015_GanttChart(this),this.timelineModule=new ej2_gantt_es2015_Timeline(this),this.chartRowsModule=new ej2_gantt_es2015_ChartRows(this),this.treeGridModule=new ej2_gantt_es2015_GanttTreeGrid(this),this.dateValidationModule=new ej2_gantt_es2015_DateProcessor(this),this.predecessorModule=new ej2_gantt_es2015_Dependency(this),this.connectorLineModule=new ej2_gantt_es2015_ConnectorLine(this),this.connectorLineEditModule=new ej2_gantt_es2015_ConnectorLineEdit(this),this.splitterModule=new ej2_gantt_es2015_Splitter$1(this),this.tooltipModule=new ej2_gantt_es2015_Tooltip$1(this),this.keyConfig={home:"home",end:"end",downArrow:"downarrow",upArrow:"uparrow",collapseAll:"ctrl+uparrow",expandAll:"ctrl+downarrow",collapseRow:"ctrl+shift+uparrow",expandRow:"ctrl+shift+downarrow",saveRequest:"13",cancelRequest:"27",addRow:"insert",addRowDialog:"ctrl+insert",editRowDialog:"ctrl+f2",delete:"delete",focusTask:"shift+f5",indentLevel:"shift+leftarrow",outdentLevel:"shift+rightarrow",focusSearch:"ctrl+shift+70"},this.zoomingLevels=this.getZoomingLevels()}validateDimentionValue(value){return isNullOrUndefined(value)?null:"string"==typeof value&&"auto"!==value&&-1===value.indexOf("%")?-1===value.indexOf("px")?value+"px":value:"number"==typeof value?value+"px":value.toString()}calculateDimensions(){let settingsHeight=this.validateDimentionValue(this.height),settingsWidth=this.validateDimentionValue(this.width);isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(settingsWidth=this.width);let elementStyleHeight=this.element.style.height,elementStyleWidth=this.element.style.width;settingsWidth&&(this.element.style.width=settingsWidth),settingsHeight&&(this.element.style.height=settingsHeight),settingsHeight||elementStyleHeight||(this.element.style.height="auto"),settingsWidth||elementStyleWidth||(this.element.style.width="auto"),this.ganttHeight=this.element.offsetHeight,this.ganttWidth=this.element.offsetWidth}render(){createSpinner({target:this.element},this.createElement),this.trigger("load",{}),this.element.classList.add("e-gantt"),this.isAdaptive?this.element.classList.add("e-device"):this.element.classList.remove("e-device"),this.calculateDimensions(),isNullOrUndefined(this.toolbarModule)||this.renderToolbar(),this.splitterModule.renderSplitter(),this.notify("renderPanels",null),this.showSpinner(),this.dataOperation.checkDataBinding()}showSpinner(){showSpinner(this.element)}hideSpinner(){hideSpinner(this.element)}renderGantt(isChange){if(this.timelineModule.processTimelineUnit(),this.timelineModule.calculateZoomingLevelsPerDayWidth(),this.taskFields.dependency&&(this.predecessorModule.updatePredecessors(),this.isInPredecessorValidation&&this.predecessorModule.updatedRecordsDateByPredecessor()),this.dataOperation.calculateProjectDates(),this.timelineModule.validateTimelineProp(),isChange)this.updateProjectDates(this.cloneProjectStartDate,this.cloneProjectEndDate,this.isTimelineRoundOff),this.dataOperation.updateGanttData(),this.treeGrid.dataSource=this.flatData;else if(this.dataOperation.updateGanttData(),this.treeGridPane.classList.remove("e-temp-content"),ej2_base_es2015_remove(this.treeGridPane.querySelector(".e-gantt-temp-header")),this.notify("dataReady",{}),this.enableContextMenu&&this.notify("initiate-contextMenu",{}),this.renderTreeGrid(),this.wireEvents(),this.taskFields.dependency&&this.isInPredecessorValidation){let dialogElement=ej2_base_es2015_createElement("div",{id:this.element.id+"_dialogValidationRule"});this.element.appendChild(dialogElement),this.predecessorModule.renderValidationDialog()}this.splitterModule.updateSplitterPosition(),"Vertical"!==this.gridLines&&"Both"!==this.gridLines||this.renderChartVerticalLines()}wireEvents(){this.allowKeyboard&&(this.keyboardModule=new ej2_base_es2015_KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfig,eventName:"keydown"}))}keyActionHandler(e){this.onKeyPress(e)}renderToolbar(){isNullOrUndefined(this.toolbarModule)||(this.toolbarModule.renderToolbar(),this.toolbarModule.refreshToolbarItems())}renderTreeGrid(){this.treeGridModule.renderTreeGrid()}updateCurrentViewData(){if(isBlazor()){let records=this.treeGrid.getCurrentViewRecords().slice();this.currentViewData=[];for(let i=0;i<records.length;i++)this.currentViewData.push(this.getTaskByUniqueID(records[i].uniqueID));this.treeGrid.grid.currentViewData=this.currentViewData}else this.currentViewData=this.treeGrid.getCurrentViewRecords().slice()}getRecordFromFlatdata(records){let updatedRecord=[];for(let i=0;i<records.length;i++)updatedRecord.push(this.getTaskByUniqueID(records[i].uniqueID));return updatedRecord}updateContentHeight(){let expandedRecords=this.getExpandedRecords(this.currentViewData);this.contentHeight=expandedRecords.length*this.rowHeight}getExpandStatus(data){let parentRecord=this.getParentTask(data.parentItem);return!!isNullOrUndefined(parentRecord)||!1!==parentRecord.expanded&&(!parentRecord.parentItem||!1!==this.getParentTask(parentRecord.parentItem).expanded&&this.getExpandStatus(this.getParentTask(parentRecord.parentItem)))}getExpandedRecords(records){return records.filter(record=>!0===this.getExpandStatus(record))}getZoomingLevels(){return[{topTier:{unit:"Year",format:"yyyy",count:50},bottomTier:{unit:"Year",format:"yyyy",count:10},timelineUnitSize:99,level:0,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:20},bottomTier:{unit:"Year",format:"yyyy",count:5},timelineUnitSize:99,level:1,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:5},bottomTier:{unit:"Year",format:"yyyy",count:1},timelineUnitSize:99,level:2,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayHalfValue,count:6},timelineUnitSize:66,level:3,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayHalfValue,count:6},timelineUnitSize:99,level:4,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayQuarterValue,count:3},timelineUnitSize:66,level:5,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:1},bottomTier:{unit:"Month",formatter:this.displayQuarterValue,count:3},timelineUnitSize:99,level:6,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:1},bottomTier:{unit:"Month",format:"MMM yyyy",count:1},timelineUnitSize:99,level:7,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yy",count:1},bottomTier:{unit:"Week",format:"dd",count:1},timelineUnitSize:33,level:8,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yyyy",count:1},bottomTier:{unit:"Week",format:"dd MMM",count:1},timelineUnitSize:66,level:9,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yyyy",count:1},bottomTier:{unit:"Week",format:"dd MMM",count:1},timelineUnitSize:99,level:10,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:33,level:11,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:66,level:12,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:99,level:13,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:12},timelineUnitSize:66,level:14,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:12},timelineUnitSize:99,level:15,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:6},timelineUnitSize:66,level:16,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:6},timelineUnitSize:99,level:17,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:2},timelineUnitSize:66,level:18,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:2},timelineUnitSize:99,level:19,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:1},timelineUnitSize:66,level:20,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:1},timelineUnitSize:99,level:21,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:30},timelineUnitSize:66,level:22,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:15},timelineUnitSize:66,level:23,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:1},timelineUnitSize:66,level:24,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0}]}displayQuarterValue(date){let month=date.getMonth();return month>=0&&month<=2?"Q1":month>=3&&month<=5?"Q2":month>=6&&month<=8?"Q3":"Q4"}displayHalfValue(date){let month=date.getMonth();return month>=0&&month<=6?"H1":"H2"}getFormatedDate(date,format){return isNullOrUndefined(date)?null:(isNullOrUndefined(format)&&(format=this.dateFormat),this.globalize.formatDate(date,{format:format}))}getDurationString(duration,durationUnit){return this.dateValidationModule.getDurationString(duration,durationUnit)}treeDataBound(args){if(this.updateCurrentViewData(),this.updateContentHeight(),!this.isTreeGridRendered){this.isTreeGridRendered=!0,this.isLoad=!1;let toolbarHeight=0;isNullOrUndefined(this.toolbarModule)||isNullOrUndefined(this.toolbarModule.element)||(toolbarHeight=this.toolbarModule.element.offsetHeight),this.timelineModule.isSingleTier?(addClass(this.treeGrid.element.querySelectorAll(".e-headercell"),timelineSingleHeaderOuterDiv),addClass(this.treeGrid.element.querySelectorAll(".e-columnheader"),timelineSingleHeaderOuterDiv)):(removeClass(this.treeGrid.element.querySelectorAll(".e-headercell"),timelineSingleHeaderOuterDiv),removeClass(this.treeGrid.element.querySelectorAll(".e-columnheader"),timelineSingleHeaderOuterDiv)),this.treeGrid.height=this.ganttHeight-toolbarHeight-this.treeGrid.grid.getHeaderContent().offsetHeight,this.notify("tree-grid-created",{}),this.createGanttPopUpElement(),this.hideSpinner(),this.renderComplete()}this.taskFields.dependency&&(this.connectorLineIds=[],this.updatedConnectorLineCollection=[],this.predecessorModule.createConnectorLinesCollection(this.currentViewData)),this.notify("recordsUpdated",{}),this.trigger("dataBound",args)}onPropertyChanged(newProp,oldProp){let isRefresh=!1;for(let prop of Object.keys(newProp))switch(prop){case"allowSelection":this.treeGrid.allowSelection=this.allowSelection,this.treeGrid.dataBind();break;case"allowFiltering":this.treeGrid.allowFiltering=this.allowFiltering,this.treeGrid.dataBind();break;case"workWeek":this.dataOperation.getNonWorkingDayIndex(),this.dataOperation.reUpdateGanttData(),this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows(),this.treeGrid.refreshColumns(),this.timelineModule.refreshTimeline();break;case"toolbar":this.notify("ui-toolbarupdate",{module:"toolbar",properties:newProp});break;case"showColumnMenu":this.treeGrid.showColumnMenu=this.showColumnMenu,this.treeGrid.dataBind();break;case"columnMenuItems":this.treeGrid.grid.columnMenuItems=getActualProperties(this.columnMenuItems);break;case"eventMarkers":case"highlightWeekends":this.notify("ui-update",{module:"day-markers",properties:newProp});break;case"sortSettings":this.treeGrid.sortSettings=getActualProperties(this.sortSettings),this.treeGrid.dataBind();break;case"timelineSettings":this.timelineModule.refreshTimeline();break;case"rowHeight":case"taskbarHeight":this.treeGrid.rowHeight=this.rowHeight,this.treeGrid.dataBind(),this.chartRowsModule.initiateTemplates(),this.timelineModule.updateChartByNewTimeline(),this.taskFields.dependency&&this.ganttChartModule.reRenderConnectorLines();break;case"filterSettings":this.treeGrid.filterSettings=getActualProperties(this.filterSettings),this.treeGrid.dataBind();break;case"allowResizing":this.treeGrid.allowResizing=this.allowResizing,this.treeGrid.dataBind();break;case"allowReordering":this.treeGrid.allowReordering=this.allowReordering,this.treeGrid.dataBind();break;case"gridLines":this.treeGrid.gridLines=this.gridLines,this.treeGrid.dataBind(),this.renderChartGridLines();break;case"tooltipSettings":this.tooltipModule.toolTipObj&&this.tooltipModule.toolTipObj.destroy(),this.tooltipModule.createTooltip();break;case"splitterSettings":this.splitterModule.updateSplitterPosition();break;case"selectionSettings":this.treeGrid.selectionSettings=getActualProperties(this.selectionSettings),this.treeGrid.dataBind();break;case"searchSettings":this.treeGrid.grid.searchSettings=getActualProperties(this.searchSettings),this.treeGrid.grid.dataBind(),this.toolbarModule&&this.toolbarModule.updateSearchTextBox();break;case"labelSettings":case"renderBaseline":case"baselineColor":this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"resourceIDMapping":case"resourceNameMapping":case"resources":this.dataOperation.reUpdateResources(),this.treeGrid.refreshColumns(),this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"includeWeekend":case"dayWorkingTime":case"allowUnscheduledTasks":case"holidays":"holidays"===prop&&(this.totalHolidayDates=this.dataOperation.getHolidayDates(),this.notify("ui-update",{module:"day-markers",properties:newProp})),this.dataOperation.reUpdateGanttData(),this.treeGrid.refreshColumns(),this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"addDialogFields":case"editDialogFields":this.editModule&&this.editModule.dialogModule&&this.editModule.dialogModule.processDialogFields();break;case"columns":this.treeGridModule.treeGridColumns=[],this.treeGridModule.validateGanttColumns(),this.treeGrid.columns=this.treeGridModule.treeGridColumns,this.chartRowsModule.initiateTemplates(),this.timelineModule.updateChartByNewTimeline();break;case"width":case"height":this.reUpdateDimention();break;case"editSettings":this.treeGrid.editSettings.allowAdding=this.editSettings.allowAdding,this.treeGrid.editSettings.allowDeleting=this.editSettings.allowDeleting,this.treeGrid.editSettings.showDeleteConfirmDialog=this.editSettings.showDeleteConfirmDialog,this.treeGrid.editSettings.allowEditing=this.editSettings.allowEditing,isNullOrUndefined(this.editModule)||this.editModule.reUpdateEditModules(),isNullOrUndefined(this.toolbarModule)||this.toolbarModule.refreshToolbarItems();break;case"connectorLineBackground":case"connectorLineWidth":this.taskFields.dependency&&(this.connectorLineModule.initPublicProp(),this.ganttChartModule.reRenderConnectorLines());break;case"treeColumnIndex":this.treeGrid.treeColumnIndex=this.treeColumnIndex;break;case"projectStartDate":case"projectEndDate":this.dataOperation.calculateProjectDates(),this.updateProjectDates(this.cloneProjectStartDate,this.cloneProjectEndDate,this.isTimelineRoundOff);break;case"selectedRowIndex":isNullOrUndefined(this.selectionModule)||this.selectionModule.selectRowByIndex();break;case"dataSource":this.closeGanttActions(),this.dataOperation.checkDataBinding(!0);break;case"enableContextMenu":case"contextMenuItems":this.enableContextMenu||"contextMenuItems"===prop?this.notify("reRender-contextMenu",{module:"contextMenu",enable:this.contextMenuItems}):this.treeGrid.contextMenuItems=[],this.treeGrid.dataBind();break;case"currencyCode":case"locale":case"enableRtl":isRefresh=!0}isRefresh&&this.refresh()}getPersistData(){return this.addOnPersist(["allowSelection"])}destroy(){this.notify("destroy",{}),isNullOrUndefined(this.validationDialogElement)||this.validationDialogElement.isDestroyed||this.validationDialogElement.destroy();let modules=["ganttChartModule","timelineModule","chartRowsModule","treeGridModule","ganttDataUpdatesModule","dateValidationModule","tooltipModule"];for(let i=0;i<modules.length;i++)this[modules[i]]&&(this[modules[i]]=null);super.destroy(),this.chartVerticalLineContainer=null,this.element.innerHTML="",removeClass([this.element],"e-gantt"),this.element.innerHTML="",this.isTreeGridRendered=!1}getTaskbarHeight(){return this.chartRowsModule.taskBarHeight}requiredModules(){let modules=[];return this.isDestroyed?modules:(this.allowSorting&&modules.push({member:"sort",args:[this]}),(this.allowFiltering||this.toolbar&&-1!==this.toolbar.indexOf("Search"))&&modules.push({member:"filter",args:[this]}),this.allowReordering&&modules.push({member:"reorder",args:[this]}),this.allowResizing&&modules.push({member:"resize",args:[this]}),this.toolbar&&modules.push({member:"toolbar",args:[this]}),(this.editSettings.allowAdding||this.editSettings.allowEditing||this.editSettings.allowDeleting||this.editSettings.allowTaskbarEditing)&&modules.push({member:"edit",args:[this]}),this.allowSelection&&modules.push({member:"selection",args:[this]}),this.tooltipSettings.showTooltip&&modules.push({member:"tooltip",args:[this]}),(this.highlightWeekends||this.holidays&&this.holidays.length>0||this.eventMarkers&&this.eventMarkers.length>0)&&modules.push({member:"dayMarkers",args:[this]}),this.enableContextMenu&&modules.push({member:"contextMenu",args:[this]}),modules)}sortColumn(columnName,direction,isMultiSort){this.sortModule.sortColumn(columnName,direction,isMultiSort)}clearSorting(){this.sortModule.clearSorting()}renderChartGridLines(){let className="e-chart-row-border",verticalLines=this.chartVerticalLineContainer,chartRowsTD=document.getElementById(this.element.id+"GanttTaskTableBody").querySelectorAll("td");if("Vertical"===this.gridLines){if(isNullOrUndefined(verticalLines)?this.renderChartVerticalLines():"none"===verticalLines.style.display&&(verticalLines.style.display="block"),chartRowsTD[0].classList.contains(className))for(let c=0;c<chartRowsTD.length;c++)removeClass([chartRowsTD[c]],className)}else if("Horizontal"===this.gridLines){if(isNullOrUndefined(verticalLines)||(verticalLines.style.display="none"),!chartRowsTD[0].classList.contains(className))for(let c=0;c<chartRowsTD.length;c++)addClass([chartRowsTD[c]],className)}else if("Both"===this.gridLines){if(isNullOrUndefined(verticalLines)?this.renderChartVerticalLines():"none"===verticalLines.style.display&&(verticalLines.style.display="block"),!chartRowsTD[0].classList.contains(className))for(let c=0;c<chartRowsTD.length;c++)addClass([chartRowsTD[c]],className)}else if("None"===this.gridLines&&(isNullOrUndefined(verticalLines)||"none"===verticalLines.style.display||(verticalLines.style.display="none"),chartRowsTD[0].classList.contains(className)))for(let c=0;c<chartRowsTD.length;c++)removeClass([chartRowsTD[c]],className)}updateGridLineContainerHeight(){this.chartVerticalLineContainer&&(this.chartVerticalLineContainer.style.height=formatUnit(this.contentHeight))}reUpdateDimention(){let toolbarHeight=0;this.calculateDimensions(),isNullOrUndefined(this.toolbarModule)||isNullOrUndefined(this.toolbarModule.element)||(this.toolbarModule.toolbar.refresh(),this.toolbarModule.refreshToolbarItems(),toolbarHeight=this.toolbarModule.element.offsetHeight),this.treeGrid.height=this.ganttHeight-toolbarHeight-this.treeGrid.grid.getHeaderContent().offsetHeight,this.splitterModule.splitterObject.height=(this.ganttHeight-toolbarHeight).toString(),this.splitterModule.splitterObject.width=this.ganttWidth.toString(),this.ganttChartModule.scrollObject.setHeight(this.ganttHeight-this.ganttChartModule.chartTimelineContainer.offsetHeight-toolbarHeight)}renderChartVerticalLines(){this.element.contains(this.chartVerticalLineContainer)||(this.chartVerticalLineContainer=ej2_base_es2015_createElement("div",{id:this.element.id+"line-container",styles:"position:absolute;height:100%;z-index:1"}),this.element.getElementsByClassName("e-chart-rows-container")[0].appendChild(this.chartVerticalLineContainer)),this.chartVerticalLineContainer.innerHTML="";let headerTable=this.element.getElementsByClassName("e-timeline-header-table-container")[1];isNullOrUndefined(headerTable)&&(headerTable=this.element.getElementsByClassName("e-timeline-header-table-container")[0]);let thWidth,thElements=headerTable.getElementsByTagName("th"),thLength=thElements.length,leftPos=0,containerDiv=ej2_base_es2015_createElement("div");for(let n=0;n<thLength;n++){leftPos=0===n?-1:leftPos+parseFloat(thWidth),thWidth=thElements[n].style.width;let divElement=ej2_base_es2015_createElement("div",{className:"e-line-container-cell",styles:"left:"+leftPos+"px"});containerDiv.appendChild(divElement)}this.chartVerticalLineContainer.innerHTML=containerDiv.innerHTML}getDefaultLocale(){return{emptyRecord:"No records to display",id:"ID",name:"Name",startDate:"Start Date",endDate:"End Date",duration:"Duration",progress:"Progress",dependency:"Dependency",notes:"Notes",baselineStartDate:"Baseline Start Date",baselineEndDate:"Baseline End Date",type:"Type",offset:"Offset",resourceName:"Resources",resourceID:"Resource ID",day:"day",hour:"hour",minute:"minute",days:"days",hours:"hours",minutes:"minutes",generalTab:"General",customTab:"Custom Columns",writeNotes:"Write Notes",addDialogTitle:"New Task",editDialogTitle:"Task Information",add:"Add",edit:"Edit",update:"Update",delete:"Delete",cancel:"Cancel",search:"Search",task:" task",tasks:" tasks",zoomIn:"Zoom in",zoomOut:"Zoom out",zoomToFit:"Zoom to fit",expandAll:"Expand all",collapseAll:"Collapse all",nextTimeSpan:"Next timespan",prevTimeSpan:"Previous timespan",saveButton:"Save",taskBeforePredecessor_FS:'You moved "{0}" to start before "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_FS:'You moved "{0}" away from "{1}" and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_SS:'You moved "{0}" to start before "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_SS:'You moved "{0}" to start after "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_FF:'You moved "{0}" to finish before "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_FF:'You moved "{0}" to finish after "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_SF:'You moved "{0}" away from "{1}" to starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_SF:'You moved "{0}" to finish after "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',okText:"Ok",confirmDelete:"Are you sure you want to Delete Record?",from:"From",to:"To",taskLink:"Task Link",lag:"Lag",start:"Start",finish:"Finish",enterValue:"Enter the value",taskInformation:"Task Information",deleteTask:"Delete Task",deleteDependency:"Delete Dependency",convert:"Convert",save:"Save",above:"Above",below:"Below",child:"Child",milestone:"Milestone",toTask:"To Task",toMilestone:"To Milestone",eventMarkers:"Event markers",leftTaskLabel:"Left task label",rightTaskLabel:"Right task label",timelineCell:"Timeline cell",confirmPredecessorDelete:"Are you sure you want to remove dependency link?"}}removeSortColumn(columnName){this.sortModule.removeSortColumn(columnName)}actionBeginTask(args){this.trigger("actionBegin",args)}scrollToDate(date){let tempDate=this.dateValidationModule.getDateFromFormat(date),left=this.dataOperation.getTaskLeft(tempDate,!1);this.ganttChartModule.updateScrollLeft(left)}scrollToTask(taskId){if(-1!==this.ids.indexOf(taskId)){let left=this.flatData[this.ids.indexOf(taskId)].ganttProperties.left;this.ganttChartModule.updateScrollLeft(left)}}updateChartScrollOffset(left,top){isNullOrUndefined(left)||this.ganttChartModule.scrollObject.setScrollLeft(left=this.ganttChartModule.scrollElement.scrollWidth<=left?this.ganttChartModule.scrollElement.scrollWidth:left),isNullOrUndefined(top)||this.ganttChartModule.scrollObject.setScrollTop(top=this.ganttChartModule.scrollElement.scrollHeight<=top?this.ganttChartModule.scrollElement.scrollHeight:top)}getParentTask(cloneParent){if(isNullOrUndefined(cloneParent))return null;{let parent=this.flatData.filter(val=>cloneParent.uniqueID===val.uniqueID);return parent.length>0?parent[0]:null}}filterByColumn(fieldName,filterOperator,filterValue,predicate,matchCase,ignoreAccent){this.treeGrid.filterByColumn(fieldName,filterOperator,filterValue,predicate,matchCase,ignoreAccent)}clearFiltering(){this.treeGrid.clearFiltering()}removeFilteredColsByField(field){this.treeGrid.removeFilteredColsByField(field,!1)}renderWorkingDayCell(args){let nonWorkingDays=this.nonWorkingDayIndex,holidays=this.totalHolidayDates;if(nonWorkingDays.length>0&&-1!==nonWorkingDays.indexOf(args.date.getDay()))args.isDisabled=!0;else if(holidays.length>0){let tempDate=new Date(args.date.getTime());tempDate.setHours(0,0,0),-1!==holidays.indexOf(tempDate.getTime())&&(args.isDisabled=!0)}}previousTimeSpan(mode){this.timelineModule.performTimeSpanAction("prevTimeSpan","publicMethod",new Date(this.timelineModule.timelineStartDate.getTime()),new Date(this.timelineModule.timelineEndDate.getTime()),mode)}nextTimeSpan(mode){this.timelineModule.performTimeSpanAction("nextTimeSpan","publicMethod",new Date(this.timelineModule.timelineStartDate.getTime()),new Date(this.timelineModule.timelineEndDate.getTime()),mode)}updateProjectDates(startDate,endDate,isTimelineRoundOff){this.timelineModule.totalTimelineWidth=0,this.cloneProjectStartDate=startDate,this.cloneProjectEndDate=endDate,this.isTimelineRoundOff=isTimelineRoundOff,this.timelineModule.refreshTimelineByTimeSpan(),this.dataOperation.reUpdateGanttDataPosition(),this.timelineModule.updateChartByNewTimeline(),this.ganttChartModule.chartBodyContent.style.width=formatUnit(this.timelineModule.totalTimelineWidth),this.ganttChartModule.updateLastRowBottomWidth(),"Vertical"!==this.gridLines&&"Both"!==this.gridLines||this.renderChartVerticalLines(),this.taskFields.dependency&&this.ganttChartModule.reRenderConnectorLines(),this.notify("selectRowByIndex",{})}reorderColumns(fromFName,toFName){this.treeGrid.reorderColumns(fromFName,toFName)}initiateEditAction(isStart){this.isOnEdit=isStart,this.previousRecords={},this.editedRecords=[]}setRecordValue(field,value,record,isTaskData){if(this.isOnEdit||this.isOnDelete){this.makeCloneData(field,record,isTaskData);let task=this.getRecordByID(isTaskData?record.taskId:record.ganttProperties.taskId);task&&-1===this.editedRecords.indexOf(task)&&this.editedRecords.push(task)}setValue(field,value=isUndefined(value)?null:value,record)}makeCloneData(field,record,isTaskData){let cloneData,prevValue,clonedValue,value=getValue(field,record);isTaskData&&(field="ganttProperties."+field),isNullOrUndefined(this.previousRecords[record.uniqueID])&&(this.previousRecords[record.uniqueID]={}),isUndefined(prevValue=getValue(field,cloneData=this.previousRecords[record.uniqueID]))&&(isUndefined(clonedValue=value instanceof Date?new Date(value.getTime()):function(value){let parser=Object.prototype.toString;return"[object Array]"===parser.call(value)&&"[object Object]"===parser.call(value[0])}(value)?extend([],value,[],!0):ej2_base_es2015_isObject(value)?extend({},{},value,!0):value)?setValue(field,null,cloneData):setValue(field,clonedValue,cloneData))}closeGanttActions(){this.editModule&&(this.editModule.cellEditModule&&this.editModule.cellEditModule.isCellEdit?(this.treeGrid.closeEdit(),this.editModule.cellEditModule.isCellEdit=!1,isNullOrUndefined(this.toolbarModule)||this.toolbarModule.refreshToolbarItems()):this.editModule.dialogModule&&this.editModule.dialogModule.dialogObj&&this.editModule.dialogModule.dialogObj.visible&&(this.editModule.dialogModule.dialogObj.hide(),this.editModule.dialogModule.dialogClose()))}getTaskByUniqueID(id){let value=this.flatData.filter(val=>val.uniqueID===id);return value.length>0?value[0]:null}getRecordByID(id){return isNullOrUndefined(id)?null:this.flatData[this.ids.indexOf(id.toString())]}setSplitterPosition(value,type){let tempSplitterSettings={};tempSplitterSettings[type]=value;let splitterPosition=this.splitterModule.calculateSplitterPosition(tempSplitterSettings,!0),pane1=this.splitterModule.splitterObject.element.querySelectorAll(".e-pane")[0],pane2=this.splitterModule.splitterObject.element.querySelectorAll(".e-pane")[1];this.splitterModule.splitterPreviousPositionGrid=pane1.scrollWidth+1+"px",this.splitterModule.splitterPreviousPositionChart=pane2.scrollWidth+1+"px",this.splitterModule.splitterObject.paneSettings[0].size=splitterPosition,this.splitterModule.triggerCustomResizedEvent()}expandByIndex(index){let args=this.contructExpandCollapseArgs(null,index);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.expandGanttRow(args)}expandByID(id){let args=this.contructExpandCollapseArgs(id);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.expandGanttRow(args)}collapseByIndex(index){let args=this.contructExpandCollapseArgs(null,index);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.collapseGanttRow(args)}collapseByID(id){let args=this.contructExpandCollapseArgs(id);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.collapseGanttRow(args)}addRecord(data,rowPosition,rowIndex){this.editModule&&this.editSettings.allowAdding&&this.editModule.addRecord(data,rowPosition,rowIndex)}updateRecordByID(data){this.editModule&&this.editSettings.allowEditing&&this.editModule.updateRecordByID(data)}zoomIn(){this.timelineModule.processZooming(!0)}zoomOut(){this.timelineModule.processZooming(!1)}fitToProject(){this.timelineModule.processZoomToFit(),this.ganttChartModule.updateScrollLeft(0)}updateRecordByIndex(index,data){if(this.editModule&&this.editSettings.allowEditing){let record,tasks=this.taskFields;record=this.currentViewData.length>0?isNullOrUndefined(this.currentViewData[index])?null:this.currentViewData[index]:null,isNullOrUndefined(record)||(data[tasks.id]=record[tasks.id],this.editModule.updateRecordByID(data))}}addPredecessor(id,predecessorString){let ganttRecord=this.getRecordByID(id.toString());this.editModule&&!isNullOrUndefined(ganttRecord)&&this.connectorLineEditModule.addPredecessor(ganttRecord,predecessorString)}removePredecessor(id){let ganttRecord=this.getRecordByID(id.toString());this.editModule&&!isNullOrUndefined(ganttRecord)&&this.connectorLineEditModule.removePredecessor(ganttRecord)}updatePredecessor(id,predecessorString){let ganttRecord=this.getRecordByID(id.toString());this.editModule&&!isNullOrUndefined(ganttRecord)&&this.connectorLineEditModule.updatePredecessor(ganttRecord,predecessorString)}openAddDialog(){this.editModule&&this.editModule.dialogModule&&this.editSettings.allowAdding&&this.editModule.dialogModule.openAddDialog()}openEditDialog(taskId){this.editModule&&this.editModule.dialogModule&&this.editSettings.allowEditing&&this.editModule.dialogModule.openEditDialog(taskId)}contructExpandCollapseArgs(id,index){let chartRow$$1,record,rowIndex;return isNullOrUndefined(index)?(record=this.getRecordByID(id.toString()),rowIndex=getValue("rowIndex",chartRow$$1=this.getRowByID(id))):isNullOrUndefined(index)||(rowIndex=getValue("rowIndex",chartRow$$1=this.getRowByIndex(index)),record=this.currentViewData[rowIndex]),{data:record,gridRow:this.treeGrid.getRows()[rowIndex],chartRow:chartRow$$1,cancel:!1}}getRowByIndex(index){try{let gridRows=this.element.querySelectorAll(".e-chart-row");return isNullOrUndefined(index)?null:gridRows[index]}catch(e){return null}}getRowByID(id){let record=this.getRecordByID(id.toString()),index=this.currentViewData.indexOf(record);return-1!==index?this.getRowByIndex(index):null}getUnscheduledTaskClass(ganttProp){return isNullOrUndefined(ganttProp.startDate)&&isNullOrUndefined(ganttProp.endDate)&&isNullOrUndefined(ganttProp.duration)?" e-gantt-unscheduled-task":isNullOrUndefined(ganttProp.startDate)||isNullOrUndefined(ganttProp.endDate)||isNullOrUndefined(ganttProp.duration)?" e-gantt-unscheduled-task":""}createGanttPopUpElement(){let popup=this.createElement("div",{className:"e-ganttpopup",styles:"display:none;"}),content$$1=this.createElement("div",{className:"e-content",attrs:{tabIndex:"-1"}});append([content$$1,this.createElement("div",{className:"e-uptail e-tail"})],popup),content$$1.appendChild(this.createElement("span")),append([content$$1,this.createElement("div",{className:"e-downtail e-tail"})],popup),document.getElementById(this.element.id+"GanttChart").appendChild(popup)}getPredecessorTextValue(type){let textValue;switch(type){case"SS":textValue=this.localeObj.getConstant("start")+"-"+this.localeObj.getConstant("start");break;case"FF":textValue=this.localeObj.getConstant("finish")+"-"+this.localeObj.getConstant("finish");break;case"SF":textValue=this.localeObj.getConstant("start")+"-"+this.localeObj.getConstant("finish");break;case"FS":textValue=this.localeObj.getConstant("finish")+"-"+this.localeObj.getConstant("start")}return textValue}search(keyVal){this.searchSettings.key=keyVal,this.dataBind()}getOffsetRect(element){let box=element.getBoundingClientRect(),scrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,scrollLeft=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,clientTop=document.documentElement.clientTop||document.body.clientTop||0,clientLeft=document.documentElement.clientLeft||document.body.clientLeft||0,left=box.left+scrollLeft-clientLeft;return{top:Math.round(box.top+scrollTop-clientTop),left:Math.round(left)}}expandAll(){this.ganttChartModule.expandCollapseAll("expand")}updateDataSource(dataSource,args){for(let prop of Object.keys(args))switch(prop){case"projectStartDate":this.setProperties({projectStartDate:args[prop]},!0);break;case"projectEndDate":this.setProperties({projectEndDate:args[prop]},!0)}this.dataSource=dataSource}collapseAll(){this.ganttChartModule.expandCollapseAll("collapse")}getGridColumns(){return this.treeGrid.getColumns()}getGanttColumns(){return this.ganttColumns}ShowColumn(keys,showBy){this.treeGrid.showColumns(keys,showBy)}hideColumn(keys,hideBy){this.treeGrid.hideColumns(keys,hideBy)}setScrollTop(scrollTop){this.ganttChartModule.scrollObject.setScrollTop(scrollTop)}cancelEdit(){this.closeGanttActions()}selectCells(cellIndex,isToggle){this.selectionModule&&this.selectionModule.selectCell(cellIndex,isToggle)}selectRow(index,isToggle){this.selectionModule&&this.selectionModule.selectRow(index,isToggle)}selectRows(records){this.selectionModule&&this.selectionModule.selectRows(records)}};return __decorate([Property(!0)],Gantt.prototype,"allowKeyboard",void 0),__decorate([Property(!0)],Gantt.prototype,"autoFocusTasks",void 0),__decorate([Property(!0)],Gantt.prototype,"allowSelection",void 0),__decorate([Property(!1)],Gantt.prototype,"allowSorting",void 0),__decorate([Property(!0)],Gantt.prototype,"enablePredecessorValidation",void 0),__decorate([Property(!1)],Gantt.prototype,"showColumnMenu",void 0),__decorate([Property()],Gantt.prototype,"columnMenuItems",void 0),__decorate([Property(!1)],Gantt.prototype,"collapseAllParentTasks",void 0),__decorate([Property(!1)],Gantt.prototype,"highlightWeekends",void 0),__decorate([Property(0)],Gantt.prototype,"treeColumnIndex",void 0),__decorate([Property([])],Gantt.prototype,"dataSource",void 0),__decorate([Property("day")],Gantt.prototype,"durationUnit",void 0),__decorate([Property(null)],Gantt.prototype,"query",void 0),__decorate([Property("MM/dd/yyyy")],Gantt.prototype,"dateFormat",void 0),__decorate([Property("auto")],Gantt.prototype,"height",void 0),__decorate([Property(!1)],Gantt.prototype,"renderBaseline",void 0),__decorate([Property("Horizontal")],Gantt.prototype,"gridLines",void 0),__decorate([Complex({},ej2_gantt_es2015_LabelSettings)],Gantt.prototype,"labelSettings",void 0),__decorate([Property(null)],Gantt.prototype,"taskbarTemplate",void 0),__decorate([Property(null)],Gantt.prototype,"parentTaskbarTemplate",void 0),__decorate([Property(null)],Gantt.prototype,"milestoneTemplate",void 0),__decorate([Property()],Gantt.prototype,"baselineColor",void 0),__decorate([Property("auto")],Gantt.prototype,"width",void 0),__decorate([Property()],Gantt.prototype,"toolbar",void 0),__decorate([Property(["Monday","Tuesday","Wednesday","Thursday","Friday"])],Gantt.prototype,"workWeek",void 0),__decorate([Property(!1)],Gantt.prototype,"includeWeekend",void 0),__decorate([Property(!1)],Gantt.prototype,"allowUnscheduledTasks",void 0),__decorate([Property(!1)],Gantt.prototype,"showInlineNotes",void 0),__decorate([Property(36)],Gantt.prototype,"rowHeight",void 0),__decorate([Property(null)],Gantt.prototype,"taskbarHeight",void 0),__decorate([Property(null)],Gantt.prototype,"projectStartDate",void 0),__decorate([Property(null)],Gantt.prototype,"projectEndDate",void 0),__decorate([Property(null)],Gantt.prototype,"resourceIDMapping",void 0),__decorate([Property(null)],Gantt.prototype,"resourceNameMapping",void 0),__decorate([Property([])],Gantt.prototype,"resources",void 0),__decorate([Property(null)],Gantt.prototype,"connectorLineBackground",void 0),__decorate([Property(1)],Gantt.prototype,"connectorLineWidth",void 0),__decorate([Property([])],Gantt.prototype,"columns",void 0),__decorate([Property([])],Gantt.prototype,"addDialogFields",void 0),__decorate([Property([])],Gantt.prototype,"editDialogFields",void 0),__decorate([Property(-1)],Gantt.prototype,"selectedRowIndex",void 0),__decorate([Collection([{from:8,to:12},{from:13,to:17}],ej2_gantt_es2015_DayWorkingTime)],Gantt.prototype,"dayWorkingTime",void 0),__decorate([Collection([],ej2_gantt_es2015_Holiday)],Gantt.prototype,"holidays",void 0),__decorate([Collection([],ej2_gantt_es2015_EventMarker)],Gantt.prototype,"eventMarkers",void 0),__decorate([Complex({},ej2_gantt_es2015_TaskFields)],Gantt.prototype,"taskFields",void 0),__decorate([Complex({},ej2_gantt_es2015_TimelineSettings)],Gantt.prototype,"timelineSettings",void 0),__decorate([Complex({},ej2_gantt_es2015_SortSettings)],Gantt.prototype,"sortSettings",void 0),__decorate([Complex({},ej2_gantt_es2015_EditSettings)],Gantt.prototype,"editSettings",void 0),__decorate([Complex({},ej2_gantt_es2015_TooltipSettings)],Gantt.prototype,"tooltipSettings",void 0),__decorate([Complex({},ej2_gantt_es2015_SelectionSettings)],Gantt.prototype,"selectionSettings",void 0),__decorate([Property(!1)],Gantt.prototype,"allowFiltering",void 0),__decorate([Property(!1)],Gantt.prototype,"allowReordering",void 0),__decorate([Property(!1)],Gantt.prototype,"allowResizing",void 0),__decorate([Property(!1)],Gantt.prototype,"enableContextMenu",void 0),__decorate([Property()],Gantt.prototype,"contextMenuItems",void 0),__decorate([Complex({},ej2_gantt_es2015_FilterSettings)],Gantt.prototype,"filterSettings",void 0),__decorate([Complex({},ej2_gantt_es2015_SearchSettings)],Gantt.prototype,"searchSettings",void 0),__decorate([Complex({},ej2_gantt_es2015_SplitterSettings)],Gantt.prototype,"splitterSettings",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"queryTaskbarInfo",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"collapsing",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"collapsed",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"expanding",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"expanded",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"actionBegin",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"actionComplete",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"actionFailure",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"taskbarEdited",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"endEdit",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"cellEdit",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"load",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"taskbarEditing",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"dataBound",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"resizeStart",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"resizing",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"resizeStop",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"splitterResizeStart",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"splitterResizing",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"splitterResized",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"columnDragStart",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"columnDrag",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"columnDrop",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"beforeTooltipRender",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"rowSelecting",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"rowSelected",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"rowDeselecting",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"rowDeselected",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"cellSelecting",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"cellSelected",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"cellDeselecting",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"cellDeselected",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"queryCellInfo",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"headerCellInfo",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"rowDataBound",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"columnMenuOpen",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"toolbarClick",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"columnMenuClick",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"contextMenuOpen",void 0),__decorate([ej2_base_es2015_Event()],Gantt.prototype,"contextMenuClick",void 0),__decorate([NotifyPropertyChanges],Gantt)})();const ej2_gantt_es2015_toolbarClick="toolbarClick";class ej2_gantt_es2015_CellEdit{constructor(ganttObj){this.isCellEdit=!1,this.parent=ganttObj,this.bindTreeGridProperties()}bindTreeGridProperties(){this.parent.treeGrid.editSettings.allowEditing=this.parent.editSettings.allowEditing,this.parent.treeGrid.editSettings.mode="Cell",this.parent.treeGrid.cellEdit=this.ensureEditCell.bind(this),this.parent.editSettings.allowEditing&&ej2_treegrid_es2015_TreeGrid.Inject(ej2_treegrid_es2015_Edit$1)}ensureEditCell(args){let field=args.columnName,taskSettings=this.parent.taskFields;if(!args.rowData.hasChildRecords||field!==taskSettings.endDate&&field!==taskSettings.duration&&field!==taskSettings.dependency&&field!==taskSettings.progress){let callBackPromise=new Deferred;return this.parent.trigger("cellEdit",args,args=>{isBlazor()&&(args.cell=getElement(args.cell),args.row=getElement(args.row)),callBackPromise.resolve(args),args.cancel||(this.isCellEdit=!0,isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),args.columnName===this.parent.taskFields.notes&&this.openNotesEditor(args))}),callBackPromise}args.cancel=!0}openNotesEditor(args){let data=args.rowData;if(args.columnName===this.parent.taskFields.notes&&!this.parent.showInlineNotes){args.cancel=!0;let index=this.parent.editModule.dialogModule.updatedEditFields.map(x=>x.type).indexOf("Notes");-1!==index&&(this.parent.editModule.dialogModule.openEditDialog(data.ganttProperties.taskId),document.getElementById(this.parent.element.id+"_Tab").ej2_instances[0].selectedItem=index)}}isValueChange(args,field){let data=getValue("data",args),editedValue=data[field],previousValue=getValue("previousData",args);if(isNullOrUndefined(editedValue)&&!isNullOrUndefined(previousValue)||!isNullOrUndefined(editedValue)&&isNullOrUndefined(previousValue))return!0;if(!isNullOrUndefined(editedValue)&&!isNullOrUndefined(previousValue)){if(editedValue instanceof Date)return editedValue.getTime()!==data.taskData[field].getTime();if(field===this.parent.taskFields.resourceInfo)return editedValue!==previousValue;if(editedValue!==data.taskData[field])return!0}return!1}initiateCellEdit(args,editedObj){let column=getValue("column",args),data=getValue("data",args),editedArgs={action:"CellEditing"};editedArgs.data=this.parent.getTaskByUniqueID(data.uniqueID);let editedValue=data[column.field],previousValue=getValue("previousData",args);this.isValueChange(args,column.field)?(data[column.field]=previousValue,editedArgs.data[column.field]=previousValue,this.parent.initiateEditAction(!0),this.parent.setRecordValue(column.field,editedValue,editedArgs.data),column.field===this.parent.taskFields.name?this.taskNameEdited(editedArgs):column.field===this.parent.taskFields.startDate?this.startDateEdited(editedArgs):column.field===this.parent.taskFields.endDate?this.endDateEdited(editedArgs):column.field===this.parent.taskFields.duration?this.durationEdited(editedArgs):column.field===this.parent.taskFields.resourceInfo?this.resourceEdited(editedArgs,editedObj):column.field===this.parent.taskFields.progress?this.progressEdited(editedArgs):column.field===this.parent.taskFields.baselineStartDate||column.field===this.parent.taskFields.baselineEndDate?this.baselineEdited(editedArgs):column.field===this.parent.taskFields.dependency?this.dependencyEdited(editedArgs,previousValue):column.field===this.parent.taskFields.notes?this.notedEdited(editedArgs):(this.parent.setRecordValue("taskData."+column.field,editedArgs.data[column.field],editedArgs.data),this.parent.editModule.initiateSaveAction(editedArgs))):this.parent.editModule.endEditAction(args),this.isCellEdit=!1,isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()}taskNameEdited(args){this.parent.setRecordValue("taskData."+this.parent.taskFields.name,args.data[this.parent.taskFields.name],args.data),this.parent.setRecordValue("taskName",args.data[this.parent.taskFields.name],args.data.ganttProperties,!0),this.updateEditedRecord(args)}notedEdited(args){this.parent.setRecordValue("taskData."+this.parent.taskFields.notes,args.data[this.parent.taskFields.name],args.data),this.parent.setRecordValue("notes",args.data[this.parent.taskFields.notes],args.data.ganttProperties,!0),this.updateEditedRecord(args)}startDateEdited(args){let ganttData=args.data,ganttProb=args.data.ganttProperties,currentValue=args.data[this.parent.taskFields.startDate];currentValue=currentValue?new Date(currentValue.getTime()):null,isNullOrUndefined(currentValue=this.parent.dateValidationModule.checkStartDate(currentValue))?ganttData.hasChildRecords||(this.parent.setRecordValue("startDate",null,ganttProb,!0),this.parent.setRecordValue("duration",null,ganttProb,!0),this.parent.setRecordValue("isMilestone",!1,ganttProb,!0)):ganttProb.endDate||!isNullOrUndefined(ganttProb.duration)?(this.parent.setRecordValue("startDate",new Date(currentValue.getTime()),ganttProb,!0),this.parent.dateValidationModule.calculateEndDate(ganttData)):isNullOrUndefined(ganttProb.endDate)&&isNullOrUndefined(ganttProb.duration)&&this.parent.setRecordValue("startDate",new Date(currentValue.getTime()),ganttProb,!0),this.parent.setRecordValue("isMilestone",0===ganttProb.duration,ganttProb,!0),this.parent.dataOperation.updateWidthLeft(args.data),this.parent.dataOperation.updateMappingData(ganttData,"startDate"),this.parent.dataOperation.updateMappingData(ganttData,"endDate"),this.parent.dataOperation.updateMappingData(ganttData,"duration"),this.updateEditedRecord(args)}endDateEdited(args){let ganttProb=args.data.ganttProperties,currentValue=args.data[this.parent.taskFields.endDate];isNullOrUndefined(currentValue=currentValue?new Date(currentValue.getTime()):null)?(this.parent.setRecordValue("endDate",currentValue,ganttProb,!0),this.parent.setRecordValue("duration",null,ganttProb,!0),this.parent.setRecordValue("isMilestone",!1,ganttProb,!0)):(0===currentValue.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,currentValue),currentValue=this.parent.dateValidationModule.checkEndDate(currentValue,ganttProb),this.parent.setRecordValue("endDate",currentValue,ganttProb,!0),!isNullOrUndefined(ganttProb.startDate)&&isNullOrUndefined(ganttProb.duration)?-1===this.parent.dateValidationModule.compareDates(ganttProb.endDate,ganttProb.startDate)&&(this.parent.setRecordValue("endDate",new Date(ganttProb.startDate.getTime()),ganttProb,!0),this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,ganttProb.endDate)):!isNullOrUndefined(ganttProb.duration)&&isNullOrUndefined(ganttProb.startDate)&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.getStartDate(ganttProb.endDate,ganttProb.duration,ganttProb.durationUnit,ganttProb),ganttProb,!0),-1===this.compareDatesFromRecord(ganttProb)?this.parent.dateValidationModule.calculateDuration(args.data):this.parent.editModule.revertCellEdit(args),this.parent.setRecordValue("isMilestone",0===ganttProb.duration,ganttProb,!0),ganttProb.isMilestone&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(ganttProb.startDate,ganttProb),ganttProb,!0),this.parent.dataOperation.updateWidthLeft(args.data)),this.parent.dataOperation.updateMappingData(args.data,"startDate"),this.parent.dataOperation.updateMappingData(args.data,"endDate"),this.parent.dataOperation.updateMappingData(args.data,"duration"),this.updateEditedRecord(args)}durationEdited(args){let ganttProb=args.data.ganttProperties,endDate=this.parent.dateValidationModule.getDateFromFormat(ganttProb.endDate),startDate=this.parent.dateValidationModule.getDateFromFormat(ganttProb.startDate);this.parent.dataOperation.updateDurationValue(args.data[this.parent.taskFields.duration],ganttProb);let currentDuration=ganttProb.duration;isNullOrUndefined(currentDuration)?(this.parent.setRecordValue("isMilestone",!1,ganttProb,!0),this.parent.setRecordValue("endDate",null,ganttProb,!0)):(isNullOrUndefined(startDate)&&!isNullOrUndefined(endDate)&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.getStartDate(endDate,currentDuration,ganttProb.durationUnit,ganttProb),ganttProb,!0),0!==currentDuration&&ganttProb.isMilestone&&(this.parent.setRecordValue("isMilestone",!1,ganttProb,!0),this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(ganttProb.startDate,ganttProb),ganttProb,!0)),this.parent.setRecordValue("isMilestone",0===ganttProb.duration,ganttProb,!0),this.parent.dateValidationModule.calculateEndDate(args.data)),this.parent.dataOperation.updateWidthLeft(args.data),this.parent.dataOperation.updateMappingData(args.data,"endDate"),this.parent.dataOperation.updateMappingData(args.data,"startDate"),this.parent.dataOperation.updateMappingData(args.data,"duration"),this.updateEditedRecord(args)}progressEdited(args){let ganttRecord=args.data;this.parent.setRecordValue("progress",ganttRecord[this.parent.taskFields.progress]>100?100:ganttRecord[this.parent.taskFields.progress],ganttRecord.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.progress,ganttRecord[this.parent.taskFields.progress]>100?100:ganttRecord[this.parent.taskFields.progress],args.data),args.data.hasChildRecords||this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(ganttRecord.ganttProperties.width,ganttRecord.ganttProperties.progress),ganttRecord.ganttProperties,!0),this.updateEditedRecord(args)}baselineEdited(args){let ganttRecord=args.data.ganttProperties,baseLineStartDate=args.data[this.parent.taskFields.baselineStartDate],baseLineEndDate=args.data[this.parent.taskFields.baselineEndDate];baseLineEndDate&&0===baseLineEndDate.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,baseLineEndDate),this.parent.setRecordValue("baselineStartDate",this.parent.dateValidationModule.checkBaselineStartDate(baseLineStartDate),ganttRecord,!0),this.parent.setRecordValue("baselineEndDate",this.parent.dateValidationModule.checkBaselineEndDate(baseLineEndDate),ganttRecord,!0),ganttRecord.baselineStartDate&&ganttRecord.baselineEndDate&&(this.parent.setRecordValue("baselineLeft",this.parent.dataOperation.calculateBaselineLeft(ganttRecord),ganttRecord,!0),this.parent.setRecordValue("baselineWidth",this.parent.dataOperation.calculateBaselineWidth(ganttRecord),ganttRecord,!0)),this.updateEditedRecord(args)}resourceEdited(args,editedObj){editedObj[this.parent.taskFields.resourceInfo]&&(args.data.ganttProperties.resourceInfo=this.parent.dataOperation.setResourceInfo(editedObj),this.parent.dataOperation.updateMappingData(args.data,"resourceInfo"),this.updateEditedRecord(args))}dependencyEdited(editedArgs,cellEditArgs){this.parent.connectorLineEditModule.updatePredecessor(editedArgs.data,editedArgs.data[this.parent.taskFields.dependency])||this.parent.editModule.revertCellEdit(cellEditArgs)}compareDatesFromRecord(ganttRecord){let sDate=this.parent.dateValidationModule.getValidStartDate(ganttRecord),eDate=this.parent.dateValidationModule.getValidEndDate(ganttRecord);return this.parent.dateValidationModule.compareDates(sDate,eDate)}updateEditedRecord(args){this.parent.editModule.initiateUpdateAction(args)}destroy(){}}class ej2_gantt_es2015_EditTooltip{constructor(gantt,taskbarEdit){this.parent=gantt,this.taskbarEdit=taskbarEdit}createTooltip(opensOn,mouseTrail,target){this.toolTipObj=new ej2_popups_es2015_Tooltip({opensOn:opensOn,content:this.getTooltipText(),position:"TopRight",mouseTrail:mouseTrail,cssClass:ganttTooltip,target:target||null,animation:{open:{effect:"None"},close:{effect:"None"}}}),this.toolTipObj.beforeRender=args=>{this.parent.trigger("beforeTooltipRender",{data:this.taskbarEdit.taskBarEditRecord,args:args,content:this.toolTipObj.content})},this.toolTipObj.isStringTemplate=!0,this.toolTipObj.appendTo(this.parent.chartPane)}showHideTaskbarEditTooltip(bool){bool?(this.createTooltip("Custom",!1),this.parent.tooltipModule.toolTipObj.close(),this.updateTooltip(),this.toolTipObj.open("ConnectorPointLeftDrag"===this.taskbarEdit.connectorSecondAction?this.taskbarEdit.connectorSecondElement.querySelector("."+connectorPointLeft):"ConnectorPointRightDrag"===this.taskbarEdit.connectorSecondAction?this.taskbarEdit.connectorSecondElement.querySelector("."+connectorPointRight):this.taskbarEdit.taskBarEditElement)):isNullOrUndefined(this.toolTipObj)||(this.toolTipObj.destroy(),this.toolTipObj=null)}updateTooltip(){isNullOrUndefined(this.toolTipObj)||("ConnectorPointLeftDrag"===this.taskbarEdit.taskBarEditAction||"ConnectorPointRightDrag"===this.taskbarEdit.taskBarEditAction?(this.toolTipObj.content=this.getTooltipText(),this.toolTipObj.offsetY=-3):(this.toolTipObj.content=this.getTooltipText(),this.toolTipObj.refresh(this.taskbarEdit.taskBarEditElement),"LeftResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-this.taskbarEdit.taskBarEditRecord.ganttProperties.width:"RightResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=0:"ProgressResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-(this.taskbarEdit.taskBarEditRecord.ganttProperties.width-this.taskbarEdit.taskBarEditRecord.ganttProperties.progressWidth):"MilestoneDrag"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-this.parent.chartRowsModule.milestoneHeight/2:this.taskbarEdit.taskBarEditRecord.ganttProperties.width>5&&(this.toolTipObj.offsetX=-(this.taskbarEdit.taskBarEditRecord.ganttProperties.width+this.taskbarEdit.taskBarEditRecord.ganttProperties.left-this.taskbarEdit.tooltipPositionX))))}getTooltipText(){let tooltipString="",instance=this.parent.globalize,editRecord=this.taskbarEdit.taskBarEditRecord.ganttProperties;if(this.parent.tooltipSettings.editing)tooltipString=this.parent.tooltipModule.templateCompiler(this.parent.tooltipSettings.editing,this.parent,editRecord,"TooltipEditingTemplate")[0];else switch(this.taskbarEdit.taskBarEditAction){case"ProgressResizing":tooltipString=this.parent.localeObj.getConstant("progress")+" : "+editRecord.progress;break;case"LeftResizing":tooltipString=this.parent.localeObj.getConstant("startDate")+" : ",tooltipString+=instance.formatDate(editRecord.startDate,{format:this.parent.dateFormat}),tooltipString+="<br/>"+this.parent.localeObj.getConstant("duration")+" : "+this.parent.getDurationString(editRecord.duration,editRecord.durationUnit);break;case"RightResizing":tooltipString=this.parent.localeObj.getConstant("endDate")+" : ",tooltipString+=instance.formatDate(editRecord.endDate,{format:this.parent.dateFormat}),tooltipString+="<br/>"+this.parent.localeObj.getConstant("duration")+" : "+this.parent.getDurationString(editRecord.duration,editRecord.durationUnit);break;case"ChildDrag":case"ParentDrag":case"MilestoneDrag":isNullOrUndefined(this.taskbarEdit.taskBarEditRecord.ganttProperties.startDate)||(tooltipString=this.parent.localeObj.getConstant("startDate")+" : ",tooltipString+=instance.formatDate(editRecord.startDate,{format:this.parent.dateFormat})),isNullOrUndefined(this.taskbarEdit.taskBarEditRecord.ganttProperties.endDate)||(tooltipString+=""===tooltipString?"":"<br/>",tooltipString+=this.parent.localeObj.getConstant("endDate")+" : "+instance.formatDate(editRecord.endDate,{format:this.parent.dateFormat}));break;case"ConnectorPointLeftDrag":case"ConnectorPointRightDrag":tooltipString=this.parent.connectorLineModule.tooltipTable,isNullOrUndefined(this.toolTipObj)&&(this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.parent.editModule.taskbarEditModule.taskBarEditRecord.ganttProperties.taskName,this.parent.editModule.taskbarEditModule.fromPredecessorText,"",""))}return tooltipString}}class ej2_gantt_es2015_TaskbarEdit{constructor(ganttObj){this.isMouseDragged=!1,this.editElement=null,this.parent=ganttObj,this.initPublicProp(),this.wireEvents(),this.editTooltip=new ej2_gantt_es2015_EditTooltip(this.parent,this)}wireEvents(){this.parent.on("chartMouseDown",this.mouseDownHandler,this),this.parent.on("chartMouseUp",this.mouseUpHandler,this),this.parent.on("chartMouseLeave",this.mouseLeaveHandler,this),this.parent.on("chartMouseMove",this.mouseMoveAction,this),this.parent.on("chartMouseClick",this.mouseClickHandler,this)}initPublicProp(){this.taskBarEditElement=null,this.taskBarEditRecord=null,this.taskBarEditAction=null,this.connectorSecondElement=null,this.connectorSecondRecord=null,this.connectorSecondAction=null,this.highlightedSecondElement=null,this.fromPredecessorText=null,this.toPredecessorText=null,this.finalPredecessor=null,this.drawPredecessor=!1,this.roundOffDuration=!0,this.dragMouseLeave=!1,this.isMouseDragged=!1,this.previousItemProperty=["left","progress","duration","startDate","endDate","width","progressWidth"],this.tapPointOnFocus=!1,this.touchEdit=!1}mouseDownHandler(e){if(this.parent.editSettings.allowTaskbarEditing)if(this.canDrag=!1,this.parent.isAdaptive&&this.taskBarEditElement){let targetElement=this.getElementByPosition(e),element=parentsUntil$1(targetElement,taskBarMainContainer);!element||element.innerHTML!==this.taskBarEditElement.innerHTML||targetElement.classList.contains(connectorPointLeft)||targetElement.classList.contains(connectorPointRight)||this.tapPointOnFocus||(this.updateTaskBarEditElement(e),this.canDrag=!0,e.preventDefault())}else this.parent.isAdaptive||this.updateTaskBarEditElement(e)}mouseClickHandler(e){let targetElement=this.getElementByPosition(e),element=parentsUntil$1(targetElement,taskBarMainContainer);this.parent.selectionModule.enableSelectMultiTouch?this.tapPointOnFocus&&this.updateTaskBarEditElement(e):this.tapPointOnFocus&&element&&element.innerHTML!==this.taskBarEditElement.innerHTML?(this.connectorSecondRecord=this.parent.ganttChartModule.getRecordByTaskBar(element),this.connectorSecondAction="ConnectorPointLeftDrag",this.connectorSecondElement=element,this.fromPredecessorText="Finish",this.validateConnectorPoint()&&!this.taskBarEditingAction(e)&&this.taskBarEditedAction(e),this.showHideActivePredecessors(!1),this.initPublicProp()):targetElement.classList.contains(connectorPointLeftHover)||targetElement.classList.contains(connectorPointRightHover)?(this.canDrag=!1,this.multipleSelectionEnabled(),this.showHideTaskBarEditingElements(targetElement,this.taskBarEditElement),this.tapPointOnFocus=!0,this.taskBarEditAction="ConnectorPointRightDrag",this.connectorSecondRecord=this.taskBarEditRecord,this.taskBarEditingAction(e)&&(this.tapPointOnFocus=!1)):(this.tapPointOnFocus&&(this.showHideActivePredecessors(!1),this.showHideTaskBarEditingElements(element,this.taskBarEditElement)),this.updateTaskBarEditElement(e))}showHideActivePredecessors(show){let ganttProp=this.taskBarEditRecord.ganttProperties,predecessors=ganttProp.predecessor;if(predecessors)for(let i=0;i<predecessors.length;i++){let predecessor=predecessors[i];ganttProp.taskId.toString()===predecessor.from?this.applyActiveColor(predecessor.from,predecessor.to,show):ganttProp.taskId.toString()===predecessor.to&&this.applyActiveColor(predecessor.from,predecessor.to,show)}let chartContent=this.parent.ganttChartModule.chartBodyContainer;show?(addClass([this.taskBarEditElement],[activeChildTask]),addClass([chartContent],[touchMode])):(removeClass([this.taskBarEditElement],[activeChildTask]),removeClass([chartContent],[touchMode])),this.touchEdit=show,isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()}applyActiveColor(from,to,enable){let taskId=this.taskBarEditRecord.ganttProperties.taskId.toString(),ganttRecord=this.parent.getRecordByID(taskId===from?to:from),$tr=this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(ganttRecord)];if(!isNullOrUndefined($tr)){let $taskbar=$tr.querySelector("."+taskBarMainContainer),$connectorElement=this.parent.element.querySelector("#ConnectorLineparent"+from+"child"+to);enable?(addClass([$taskbar],[activeConnectedTask]),$connectorElement&&addClass([$connectorElement],[activeConnectedTask])):(removeClass([$taskbar],[activeConnectedTask]),$connectorElement&&removeClass([$connectorElement],[activeConnectedTask]))}}validateConnectorPoint(){let parentRecord=this.taskBarEditRecord.ganttProperties,childRecord=this.connectorSecondRecord.ganttProperties,isValid=!0;if(this.connectorSecondRecord.hasChildRecords)isValid=!1;else if(childRecord.predecessor)for(let i=0;i<childRecord.predecessor.length;i++){let predecessor=childRecord.predecessor[i];if(predecessor.from===parentRecord.taskId.toString()&&predecessor.to===childRecord.taskId.toString()){this.parent.predecessorModule.childRecord=this.connectorSecondRecord,this.parent.predecessorModule.predecessorIndex=i,this.parent.predecessorModule.renderPredecessorDeleteConfirmDialog(),isValid=!1;break}if(predecessor.from===childRecord.taskId.toString()&&predecessor.to===parentRecord.taskId.toString()){this.parent.predecessorModule.childRecord=this.taskBarEditRecord,this.parent.predecessorModule.predecessorIndex=i,this.parent.predecessorModule.renderPredecessorDeleteConfirmDialog(),isValid=!1;break}}return isValid}mouseLeaveHandler(e){this.dragMouseLeave=!0}updateTaskBarEditElement(e){let element=parentsUntil$1(this.getElementByPosition(e),taskBarMainContainer);this.parent.editSettings.allowTaskbarEditing&&element?(this.showHideTaskBarEditingElements(element,this.taskBarEditElement),this.editElement=element,this.taskBarEditElement=element,this.taskBarEditRecord=this.parent.ganttChartModule.getRecordByTaskBar(this.taskBarEditElement),e.type!==Browser.touchStartEvent&&e.type!==click||(this.roundOffDuration=!0,this.taskBarEditAction=this.getTaskBarAction(e),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||!isNullOrUndefined(this.parent.taskFields.dependency)||(this.taskBarEditAction=null),this.updateMouseDownProperties(e))):this.parent.isAdaptive?(this.taskBarEditElement&&this.showHideTaskBarEditingElements(element,this.taskBarEditElement),this.initPublicProp()):this.showHideTaskBarEditingElements(element,this.taskBarEditElement)}showHideTaskBarEditingElements(element,secondElement,fadeConnectorLine){if(secondElement=secondElement||this.editElement,element?(element.querySelector("."+taskBarLeftResizer)?(addClass([element.querySelector("."+taskBarLeftResizer)],[leftResizeGripper]),addClass([element.querySelector("."+taskBarRightResizer)],[rightResizeGripper]),addClass([element.querySelector("."+childProgressResizer)],[progressResizeGripper])):this.parent.isAdaptive&&this.parent.ganttChartModule.getRecordByTaskBar(element).hasChildRecords&&addClass([element],[activeParentTask]),addClass(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+connectorLineContainer),[connectorLineZIndex]),!isNullOrUndefined(this.parent.taskFields.dependency)&&element.querySelector("."+connectorPointLeft)&&(addClass([element.querySelector("."+connectorPointLeft)],[connectorPointLeftHover]),addClass([element.querySelector("."+connectorPointRight)],[connectorPointRightHover]))):fadeConnectorLine||removeClass(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+connectorLineContainer),[connectorLineZIndex]),secondElement&&element!==secondElement){if(secondElement.querySelector("."+taskBarLeftResizer)&&(removeClass([secondElement.querySelector("."+taskBarLeftResizer)],[leftResizeGripper]),removeClass([secondElement.querySelector("."+taskBarRightResizer)],[rightResizeGripper]),secondElement.querySelector("."+childProgressResizer)&&removeClass([secondElement.querySelector("."+childProgressResizer)],[progressResizeGripper])),!isNullOrUndefined(this.parent.taskFields.dependency)&&secondElement.querySelector("."+connectorPointLeft))removeClass([secondElement.querySelector("."+connectorPointLeft)],[connectorPointLeftHover]),removeClass([secondElement.querySelector("."+connectorPointRight)],[connectorPointRightHover]);else if(this.parent.isAdaptive){let record=this.parent.ganttChartModule.getRecordByTaskBar(secondElement);record&&record.hasChildRecords&&removeClass([secondElement],[activeParentTask])}this.editElement=null}}getTaskBarAction(e){let mouseDownElement=this.getElementByPosition(e),data=this.taskBarEditRecord,action="";return mouseDownElement.classList.contains(taskBarLeftResizer)?action="LeftResizing":mouseDownElement.classList.contains(taskBarRightResizer)?action="RightResizing":mouseDownElement.classList.contains(childProgressResizer)||closest(mouseDownElement,"."+childProgressResizer)?action="ProgressResizing":mouseDownElement.classList.contains(connectorPointLeft)?action="ConnectorPointLeftDrag":mouseDownElement.classList.contains(connectorPointRight)?action="ConnectorPointRightDrag":data&&(action=data.hasChildRecords?"ParentDrag":data.ganttProperties.isMilestone?"MilestoneDrag":"ChildDrag"),action}updateMouseDownProperties(event){let e=this.getCoordinate(event);if(e.pageX||e.pageY){let containerPosition=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer);this.mouseDownX=e.pageX-containerPosition.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.tooltipPositionX=this.mouseDownX,this.mouseDownY=e.pageY-containerPosition.top+this.parent.ganttChartModule.scrollObject.previousScroll.top}"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||(this.fromPredecessorText="ConnectorPointLeftDrag"===this.taskBarEditAction?"Start":"Finish",this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.taskBarEditRecord.ganttProperties.taskName,this.fromPredecessorText,"",""))}isMouseDragCheck(){!this.isMouseDragged&&this.taskBarEditAction&&(this.mouseDownX!==this.mouseMoveX&&(this.mouseDownX+3<this.mouseMoveX||this.mouseDownX-3>this.mouseMoveX)||this.mouseDownY!==this.mouseMoveY&&(this.mouseDownY+3<this.mouseMoveY||this.mouseDownY-3>this.mouseMoveY))&&(this.isMouseDragged=!0,this.parent.initiateEditAction(!0),this.previousItem=this.parent.timelineModule.extendFunction(this.taskBarEditRecord.ganttProperties,this.previousItemProperty),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction&&this.editTooltip.showHideTaskbarEditTooltip(!0),this.taskBarEditElement.setAttribute("aria-grabbed","true"))}mouseMoveAction(event){if(this.parent.isAdaptive){if(!this.canDrag)return;this.multipleSelectionEnabled()}let containerPosition=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer),e=this.getCoordinate(event);this.mouseMoveX=e.pageX-containerPosition.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.mouseMoveY=e.pageY-containerPosition.top+this.parent.ganttChartModule.scrollObject.previousScroll.top,this.dragMouseLeave=!1,this.isMouseDragCheck(),this.isMouseDragged&&this.taskBarEditAction?("ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||this.updateConnectorLineSecondProperties(event),this.taskBarEditingAction(event)):this.parent.isAdaptive||this.taskBarEditAction||this.updateTaskBarEditElement(event)}taskBarEditingAction(e){let args={},recordIndex=this.parent.ganttChartModule.getIndexByTaskBar(this.taskBarEditElement);return null!==this.taskBarEditRecord&&(args.editingFields=this.taskBarEditRecord.ganttProperties,args.data=this.taskBarEditRecord,args.recordIndex=recordIndex,args.taskBarEditAction=this.taskBarEditAction,args.roundOffDuration=this.roundOffDuration,this.parent.trigger("taskbarEditing",args)),args.cancel||null===this.taskBarEditRecord?this.editTooltip.showHideTaskbarEditTooltip(!1):(this.roundOffDuration=args.roundOffDuration,this.updateMouseMoveProperties(e),"ProgressResizing"===this.taskBarEditAction?this.performProgressResize(e):"LeftResizing"===this.taskBarEditAction?this.enableLeftResizing(e):"RightResizing"===this.taskBarEditAction?this.enableRightResizing(e):"ParentDrag"===this.taskBarEditAction||"ChildDrag"===this.taskBarEditAction||"MilestoneDrag"===this.taskBarEditAction?this.enableDragging(e):"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||(this.triggerDependencyEvent(e),this.parent.isAdaptive||this.drawFalseLine()),this.setItemPosition(),this.updateEditedItem(),this.editTooltip.updateTooltip()),args.cancel}updateMouseMoveProperties(event){let containerPosition=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer),e=this.getCoordinate(event);(e.pageX||e.pageY)&&(this.mouseMoveX=e.pageX-containerPosition.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.tooltipPositionX=this.mouseMoveX,this.mouseMoveY=e.pageY-containerPosition.top+this.parent.ganttChartModule.scrollObject.previousScroll.top);let isConnectorLineEdit="ConnectorPointLeftDrag"===this.taskBarEditAction||"ConnectorPointRightDrag"===this.taskBarEditAction;if(this.taskBarEditRecord.ganttProperties.width>3&&("ProgressResizing"!==this.taskBarEditAction||0!==this.taskBarEditRecord.ganttProperties.progress&&100!==this.taskBarEditRecord.ganttProperties.progress)||isConnectorLineEdit){let mouseX=this.mouseMoveX-this.parent.ganttChartModule.scrollObject.previousScroll.left+containerPosition.left,mouseY=this.mouseMoveY-this.parent.ganttChartModule.scrollObject.previousScroll.top+containerPosition.top;mouseX+20>containerPosition.left+this.parent.ganttChartModule.chartBodyContainer.offsetWidth?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.left,this.startScrollTimer("right")):mouseX-20<containerPosition.left?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.left,this.startScrollTimer("left")):isConnectorLineEdit&&mouseY+20>containerPosition.top+this.parent.ganttChartModule.chartBodyContainer.offsetHeight?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.top,this.startScrollTimer("bottom")):isConnectorLineEdit&&mouseY-20<containerPosition.top?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.top,this.startScrollTimer("top")):this.stopScrollTimer()}else this.stopScrollTimer()}startScrollTimer(direction){this.stopScrollTimer(),this.scrollTimer=window.setInterval(()=>{this.timerCount="right"===direction||"bottom"===direction?this.timerCount+1>=this.parent.timelineModule.totalTimelineWidth?this.parent.timelineModule.totalTimelineWidth:this.timerCount+1:this.timerCount-1<0?0:this.timerCount-1,"bottom"===direction||"top"===direction?this.parent.ganttChartModule.scrollObject.setScrollTop(this.timerCount):this.parent.ganttChartModule.scrollObject.setScrollLeft(this.timerCount),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||this.drawFalseLine()},0)}stopScrollTimer(){window.clearInterval(this.scrollTimer),this.scrollTimer=null}enableDragging(e){let item=this.taskBarEditRecord.ganttProperties,diffrenceWidth=0;this.mouseDownX>this.mouseMoveX?(diffrenceWidth=this.mouseDownX-this.mouseMoveX)>0&&this.parent.setRecordValue("left",this.previousItem.left-diffrenceWidth,item,!0):this.parent.setRecordValue("left",this.previousItem.left+(diffrenceWidth=this.mouseMoveX-this.mouseDownX),item,!0),this.parent.setRecordValue("left",item.left<0?0:item.left+item.width>=this.parent.timelineModule.totalTimelineWidth?this.parent.timelineModule.totalTimelineWidth-item.width:item.left,item,!0)}performProgressResize(e){let item=this.taskBarEditRecord.ganttProperties,diffrenceWidth=0;this.parent.setRecordValue("progressWidth",this.mouseDownX>this.mouseMoveX?this.mouseMoveX>item.left&&this.mouseMoveX<item.left+item.width&&item.left>0?diffrenceWidth=this.mouseMoveX-item.left:this.mouseMoveX>=item.left+item.width?item.width:0:this.mouseMoveX>item.left&&this.mouseMoveX<item.left+item.width?diffrenceWidth=this.mouseMoveX-item.left:this.mouseMoveX<=item.left?0:item.width,item,!0);let widthValue=item.progressWidth>item.width?item.width:item.progressWidth;this.parent.setRecordValue("progressWidth",widthValue=item.progressWidth<0?0:item.progressWidth,item,!0);let diff=item.width-item.progressWidth;this.progressBorderRadius=diff<=4?4-diff:0}enableLeftResizing(e){let item=this.taskBarEditRecord.ganttProperties,diffrenceWidth=0;this.mouseDownX>this.mouseMoveX?this.mouseMoveX<item.left+item.width?(diffrenceWidth=this.mouseDownX-this.mouseMoveX,item.left>0&&(this.parent.setRecordValue("left",this.previousItem.left-diffrenceWidth,item,!0),this.parent.setRecordValue("width",this.previousItem.width+diffrenceWidth,item,!0))):this.mouseMoveX>item.left+item.width&&(this.parent.setRecordValue("left",this.previousItem.left-(diffrenceWidth=this.mouseDownX-this.mouseMoveX),item,!0),this.parent.setRecordValue("width",3,item,!0)):this.mouseMoveX<item.left+item.width?(diffrenceWidth=this.mouseMoveX-this.mouseDownX,item.left<item.left+item.width&&this.previousItem.left+diffrenceWidth<=this.previousItem.left+this.previousItem.width&&(this.parent.setRecordValue("left",this.previousItem.left+diffrenceWidth,item,!0),this.parent.setRecordValue("width",this.previousItem.width-diffrenceWidth,item,!0))):(this.parent.setRecordValue("left",this.previousItem.left+(diffrenceWidth=this.mouseMoveX-this.mouseDownX),item,!0),this.parent.setRecordValue("width",3,item,!0)),this.updateEditPosition(e,item),this.parent.setRecordValue("left",this.previousItem.left+this.previousItem.width-item.width,item,!0)}updateEditPosition(e,item){this.updateIsMilestone(item),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(item.width,item.progress),item,!0)}updateIsMilestone(item){item.width<=3?(this.parent.setRecordValue("width",3,item,!0),this.parent.setRecordValue("isMilestone",!0,item,!0)):(this.parent.setRecordValue("width",item.width,item,!0),this.parent.setRecordValue("isMilestone",!1,item,!0))}enableRightResizing(e){let item=this.taskBarEditRecord.ganttProperties,diffrenceWidth=0;this.mouseDownX>this.mouseMoveX?this.mouseMoveX>item.left&&this.mouseDownX-this.mouseMoveX>3?this.parent.setRecordValue("width",this.previousItem.width-(diffrenceWidth=this.mouseDownX-this.mouseMoveX),item,!0):this.mouseMoveX<item.left&&this.parent.setRecordValue("width",3,item,!0):this.mouseMoveX>item.left&&this.parent.setRecordValue("width",this.previousItem.width+(diffrenceWidth=this.mouseMoveX-this.mouseDownX),item,!0),this.updateEditPosition(e,item)}updateEditedItem(){let left,projectStartDate,endDate,startDate,item=this.taskBarEditRecord.ganttProperties;switch(this.taskBarEditAction){case"ProgressResizing":this.parent.setRecordValue("progress",this.getProgressPercent(item.width,item.progressWidth),item,!0);break;case"LeftResizing":left=this.getRoundOffStartLeft(item,this.roundOffDuration),projectStartDate=this.getDateByLeft(left),isNullOrUndefined(item.endDate)&&(endDate=this.parent.dateValidationModule.getValidEndDate(item),this.parent.setRecordValue("endDate",endDate,item,!0)),startDate=this.parent.dateValidationModule.checkStartDate(projectStartDate,item,null),this.parent.setRecordValue("startDate",new Date(startDate.getTime()),item,!0),0===this.parent.dateValidationModule.compareDates(item.startDate,item.endDate)&&isNullOrUndefined(item.isMilestone)&&!1===item.isMilestone&&0===item.duration&&this.parent.setRecordValue("duration",1,item,!0),this.parent.dateValidationModule.calculateDuration(this.taskBarEditRecord);break;case"RightResizing":left=this.getRoundOffEndLeft(item,this.roundOffDuration);let tempEndDate=this.getDateByLeft(left);isNullOrUndefined(item.startDate)&&(startDate=this.parent.dateValidationModule.getValidStartDate(item),this.parent.setRecordValue("startDate",startDate,item,!0)),endDate=this.parent.dateValidationModule.checkEndDate(tempEndDate,this.taskBarEditRecord.ganttProperties),this.parent.setRecordValue("endDate",new Date(endDate.getTime()),item,!0),this.parent.dateValidationModule.calculateDuration(this.taskBarEditRecord);break;case"ParentDrag":case"ChildDrag":case"MilestoneDrag":left=this.getRoundOffStartLeft(item,this.roundOffDuration),projectStartDate=this.getDateByLeft(left),!isNullOrUndefined(item.endDate)&&isNullOrUndefined(item.startDate)?(endDate=this.parent.dateValidationModule.checkStartDate(projectStartDate,item,null),endDate=this.parent.dateValidationModule.checkEndDate(endDate,this.taskBarEditRecord.ganttProperties),this.parent.setRecordValue("endDate",endDate,item,!0)):(this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(projectStartDate,item,null),item,!0),isNullOrUndefined(item.duration)||this.parent.dateValidationModule.calculateEndDate(this.taskBarEditRecord))}}getRoundOffEndLeft(ganttRecord,isRoundOff){let tierMode="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier,totalLeft=ganttRecord.width+ganttRecord.left,remainingContribution=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(totalLeft),1,"Day")/864e5),remainingLeft=this.parent.perDayWidth-this.parent.perDayWidth/remainingContribution,positionValue=remainingLeft/this.parent.perDayWidth;if(void 0===isRoundOff&&(isRoundOff=!1),isRoundOff){if(isRoundOff)if("Hour"===tierMode){let inHour=this.parent.perDayWidth/24;remainingContribution=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(totalLeft),1,"Hour")/36e5),0!=(remainingLeft=this.parent.perDayWidth/24-this.parent.perDayWidth/24/remainingContribution)&&(totalLeft=totalLeft-remainingLeft+inHour)}else if("Minutes"===tierMode){let inMinutes=this.parent.perDayWidth/1440;remainingContribution=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(totalLeft),1,"Minutes")/6e4),0!=(remainingLeft=this.parent.perDayWidth/1440-this.parent.perDayWidth/1440/remainingContribution)&&(totalLeft=totalLeft-remainingLeft+inMinutes)}else 0!==remainingLeft&&(totalLeft=totalLeft-remainingLeft+this.parent.perDayWidth)}else"Hour"!==tierMode&&"Minutes"!==tierMode&&(0===positionValue?totalLeft=totalLeft:positionValue>.5?totalLeft=totalLeft-remainingLeft+this.parent.perDayWidth:positionValue<.5&&(totalLeft=totalLeft-remainingLeft+this.parent.perDayWidth/2));return totalLeft}getRoundOffStartLeft(ganttRecord,isRoundOff){let left=ganttRecord.left,tierMode="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier,remainingContribution=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(left),1,"Day")/864e5),remainDays=this.parent.perDayWidth-this.parent.perDayWidth/remainingContribution,remainDaysInDecimal=remainDays/this.parent.perDayWidth;return void 0===isRoundOff&&(isRoundOff=!1),isRoundOff?isRoundOff&&("Hour"===tierMode?(remainingContribution=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(left),1,"Hour")/36e5),left=ganttRecord.left-(remainDays=this.parent.perDayWidth/24-this.parent.perDayWidth/24/remainingContribution)):"Minutes"===tierMode?(remainingContribution=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(left),1,"Minutes")/6e4),left=ganttRecord.left-(remainDays=this.parent.perDayWidth/1440-this.parent.perDayWidth/1440/remainingContribution)):left=ganttRecord.left-remainDays):"Hour"!==tierMode&&"Minutes"!==tierMode&&(remainDaysInDecimal<=.5?left=ganttRecord.left-remainDays:remainDaysInDecimal>.5&&(left=ganttRecord.left-remainDays+this.parent.perDayWidth/2)),left}getDateByLeft(left){let pStartDate=new Date(this.parent.timelineModule.timelineStartDate.toString()),milliSecondsPerPixel=864e5/this.parent.perDayWidth;pStartDate.setTime(pStartDate.getTime()+left*milliSecondsPerPixel);let tierMode="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.topTier:this.parent.timelineModule.bottomTier;return"Hour"!==tierMode&&"Minutes"!==tierMode&&(this.isInDst(new Date(this.parent.timelineModule.timelineStartDate.toString()))&&!this.isInDst(pStartDate)?pStartDate.setTime(pStartDate.getTime()+36e5):!this.isInDst(new Date(this.parent.timelineModule.timelineStartDate.toString()))&&this.isInDst(pStartDate)&&pStartDate.setTime(pStartDate.getTime()-36e5)),pStartDate}getDefaultTZOffset(){let janMonth=new Date((new Date).getFullYear(),0,1),julMonth=new Date((new Date).getFullYear(),6,1);return Math.max(janMonth.getTimezoneOffset(),julMonth.getTimezoneOffset())}isInDst(date){return date.getTimezoneOffset()<this.getDefaultTZOffset()}setItemPosition(){let item=this.taskBarEditRecord.ganttProperties,width="MilestoneDrag"===this.taskBarEditAction?this.parent.chartRowsModule.milestoneHeight:item.width,rightResizer=this.parent.isAdaptive?width-2:width-10,taskBarMainContainer$$1=closest(this.taskBarEditElement,"tr."+ej2_gantt_es2015_chartRow).querySelector("."+taskBarMainContainer),leftLabelContainer$$1=closest(this.taskBarEditElement,"tr."+ej2_gantt_es2015_chartRow).querySelector("."+leftLabelContainer),rightLabelContainer$$1=closest(this.taskBarEditElement,"tr."+ej2_gantt_es2015_chartRow).querySelector("."+rightLabelContainer),traceChildProgressBar$$1=this.taskBarEditElement.querySelector("."+traceChildProgressBar),traceChildTaskBar$$1=this.taskBarEditElement.querySelector("."+traceChildTaskBar),childProgressResizer$$1=this.taskBarEditElement.querySelector("."+childProgressResizer),taskBarRightResizer$$1=this.taskBarEditElement.querySelector("."+taskBarRightResizer),traceParentTaskBar$$1=this.taskBarEditElement.querySelector("."+traceParentTaskBar),traceParentProgressBar$$1=this.taskBarEditElement.querySelector("."+traceParentProgressBar),traceConnectorPointRight=this.taskBarEditElement.querySelector("."+rightConnectorPointOuterDiv);"ConnectorPointRightDrag"!==this.taskBarEditAction&&"ConnectorPointLeftDrag"!==this.taskBarEditAction&&(taskBarMainContainer$$1.style.width=width+"px",taskBarMainContainer$$1.style.left=item.left+"px",leftLabelContainer$$1.style.width=item.left+"px",rightLabelContainer$$1.style.left=item.left+width+"px",traceConnectorPointRight&&(traceConnectorPointRight.style.left=(this.parent.isAdaptive?width+10:width+2)+"px"),"MilestoneDrag"===this.taskBarEditAction?(taskBarMainContainer$$1.style.left=item.left-width/2+"px",leftLabelContainer$$1.style.width=item.left-width/2+"px",rightLabelContainer$$1.style.left=item.left+width/2+"px"):"ProgressResizing"===this.taskBarEditAction?(traceChildProgressBar$$1.style.width=item.progressWidth+"px",traceChildProgressBar$$1.style.borderBottomRightRadius=this.progressBorderRadius+"px",traceChildProgressBar$$1.style.borderTopRightRadius=this.progressBorderRadius+"px",traceChildTaskBar$$1.style.left=item.left+item.progressWidth-10+"px",childProgressResizer$$1.style.left=item.progressWidth-8+"px"):"RightResizing"===this.taskBarEditAction?(traceChildTaskBar$$1.style.width=width+"px",traceChildProgressBar$$1.style.width=item.progressWidth+"px",taskBarRightResizer$$1.style.left=rightResizer+"px",childProgressResizer$$1.style.left=item.progressWidth-10+"px"):"ParentDrag"===this.taskBarEditAction?(traceParentTaskBar$$1.style.width=width+"px",traceParentProgressBar$$1.style.width=item.progressWidth+"px"):(traceChildTaskBar$$1.style.width=width+"px",isNullOrUndefined(traceChildProgressBar$$1)||(taskBarRightResizer$$1.style.left=rightResizer+"px",traceChildProgressBar$$1.style.width=item.progressWidth+"px",childProgressResizer$$1.style.left=item.progressWidth-10+"px")))}mouseUpHandler(e){let mouseDragged=this.isMouseDragged;this.editTooltip.showHideTaskbarEditTooltip(!1),this.taskBarEditAction&&this.isMouseDragged&&(!this.dragMouseLeave&&this.taskBarEditedAction?(this.taskBarEditedAction(e),this.isMouseDragged=!1):this.cancelTaskbarEditActionInMouseLeave()),this.parent.isAdaptive&&!mouseDragged||this.initPublicProp(),this.stopScrollTimer()}taskBarEditedAction(event){let x2,y2,resMouseY,args={},x1=this.mouseDownX,y1=this.mouseDownY,item=this.taskBarEditRecord,recordIndex=this.parent.ganttChartModule.getIndexByTaskBar(this.taskBarEditElement),e=this.getCoordinate(event);y2=this.mouseMoveY,"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||!this.drawPredecessor?(x1!==(x2=this.mouseMoveX)||Math.abs(y1-(resMouseY=e.pageY-this.parent.ganttChartModule.chartBodyContainer.offsetTop))>=(this.parent.rowHeight-this.parent.taskbarHeight)/2)&&null!==item&&(args.editingFields=item.ganttProperties,args.data=item,args.recordIndex=recordIndex,args.previousData=this.previousItem,args.taskBarEditAction=this.taskBarEditAction,args.action="TaskbarEditing",args.roundOffDuration=this.roundOffDuration,this.taskbarEditedArgs=args,this.taskbarEdited(args)):this.parent.connectorLineEditModule.updatePredecessor(this.connectorSecondRecord,this.finalPredecessor)}cancelTaskbarEditActionInMouseLeave(){this.parent.editModule.reUpdatePreviousRecords(!0)}taskbarEdited(arg){let args=extend({},arg),ganttRecord=args.data,taskData=ganttRecord.ganttProperties;"ProgressResizing"===args.taskBarEditAction?args.previousData.progress!==taskData.progress&&(this.parent.setRecordValue("progress",this.getProgressPercent(taskData.width,taskData.progressWidth),taskData,!0),ganttRecord.parentItem&&this.parent.editModule.updateParentProgress(ganttRecord.parentItem)):this.parent.dataOperation.updateWidthLeft(args.data),this.parent.dataOperation.updateTaskData(ganttRecord),this.parent.editModule.initiateUpdateAction(args)}getProgressPercent(parentwidth,progresswidth){return Math.ceil(progresswidth/parentwidth*100)}drawFalseLine(){let left,top,x1=this.mouseDownX,y1=this.mouseDownY,x2=this.mouseMoveX,y2=this.mouseMoveY,length=Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2)),transform="rotate("+180*Math.atan2(y2-y1,x2-x1)/Math.PI+"deg)";"ConnectorPointLeftDrag"===this.taskBarEditAction&&(left=this.taskBarEditElement.offsetLeft-this.parent.chartRowsModule.connectorPointWidth/2-this.parent.ganttChartModule.scrollObject.previousScroll.left),"ConnectorPointRightDrag"===this.taskBarEditAction&&(left=this.taskBarEditElement.offsetLeft+this.taskBarEditElement.offsetWidth+this.parent.chartRowsModule.connectorPointWidth/2-this.parent.ganttChartModule.scrollObject.previousScroll.left),top=this.taskBarEditElement.offsetTop+this.taskBarEditElement.offsetHeight/2+this.parent.ganttChartModule.chartBodyContainer.offsetTop-this.parent.ganttChartModule.scrollObject.previousScroll.top,this.removeFalseLine(!1),this.falseLine=ej2_base_es2015_createElement("div",{className:falseLine,id:"ganttfalseline"+this.parent.element.id,styles:"transform-origin: 0% 100%;right: auto;position: absolute;transform:"+transform+";border-top-width: 1px;border-top-style: dashed;z-index: 5;width:"+(length-3)+"px;left:"+left+"px;top:"+top+"px;"}),this.parent.ganttChartModule.chartBodyContainer.appendChild(this.falseLine)}removeFalseLine(isRemoveConnectorPointDisplay){this.falseLine&&(ej2_base_es2015_remove(this.falseLine),this.falseLine=null,isRemoveConnectorPointDisplay&&removeClass(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+connectorLineContainer),[connectorLineZIndex]))}updateConnectorLineSecondProperties(e){let target=this.getElementByPosition(e),element=parentsUntil$1(target,taskBarMainContainer);this.connectorSecondAction=null,parentsUntil$1(target,connectorPointLeft)?(this.connectorSecondAction="ConnectorPointLeftDrag",this.toPredecessorText="Start"):parentsUntil$1(target,connectorPointRight)?(this.connectorSecondAction="ConnectorPointRightDrag",this.toPredecessorText="Finish"):(this.connectorSecondAction=null,this.toPredecessorText=null),this.taskBarEditElement!==element&&this.taskBarEditElement!==this.highlightedSecondElement&&this.showHideTaskBarEditingElements(element,this.highlightedSecondElement,!0),isNullOrUndefined(this.connectorSecondAction)&&!isNullOrUndefined(this.connectorSecondElement)&&(this.editTooltip.showHideTaskbarEditTooltip(!1),removeClass([this.connectorSecondElement.querySelector("."+connectorPointLeft)],[connectorPointAllowBlock]),removeClass([this.connectorSecondElement.querySelector("."+connectorPointRight)],[connectorPointAllowBlock])),this.connectorSecondElement=this.connectorSecondAction?element:null,this.highlightedSecondElement=element,this.connectorSecondRecord=isNullOrUndefined(this.connectorSecondElement)?null:this.parent.ganttChartModule.getRecordByTaskBar(this.connectorSecondElement)}triggerDependencyEvent(e,mouseUp){let predecessor,currentTarget,fromItem=this.taskBarEditRecord.ganttProperties,toItem=this.connectorSecondRecord?this.connectorSecondRecord.ganttProperties:null,target=this.getElementByPosition(e),element=target;if("ConnectorPointLeftDrag"===this.taskBarEditAction?predecessor=fromItem.taskId+"S":"ConnectorPointRightDrag"===this.taskBarEditAction&&(predecessor=fromItem.taskId+"F"),this.connectorSecondAction&&("ConnectorPointLeftDrag"===this.connectorSecondAction?(predecessor+="S",currentTarget="Start"):"ConnectorPointRightDrag"===this.connectorSecondAction&&(predecessor+="F",currentTarget="Finish")),isNullOrUndefined(toItem))return void(this.drawPredecessor=!1);this.finalPredecessor=toItem.predecessorsName?toItem.predecessorsName+","+predecessor:predecessor;let isValidLink=this.parent.connectorLineEditModule.validatePredecessorRelation(this.connectorSecondRecord,this.finalPredecessor),args={};if(args.fromItem=fromItem,args.toItem=toItem,args.newPredecessorString=this.finalPredecessor,args.isValidLink=isValidLink,args.requestType="ValidateDependency",this.parent.trigger("actionBegin",args),args.isValidLink=!(!isValidLink&&args.isValidLink)&&args.isValidLink,args.isValidLink){if(this.editTooltip.toolTipObj||this.parent.isAdaptive||this.editTooltip.showHideTaskbarEditTooltip(!0),this.editTooltip.toolTipObj){this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.parent.editModule.taskbarEditModule.taskBarEditRecord.ganttProperties.taskName,this.parent.editModule.taskbarEditModule.fromPredecessorText,"","");let table=this.parent.connectorLineModule.tooltipTable.querySelector("#toPredecessor").querySelectorAll("td");table[1].innerText=toItem.taskName,table[2].innerText=currentTarget}this.drawPredecessor=!0}else this.parent.isAdaptive?(target.classList.contains(connectorPointLeft)||target.classList.contains(connectorPointRight))&&this.showHideActivePredecessors(!0):addClass([element],[connectorPointAllowBlock]),this.drawPredecessor=!1}getCoordinate(event){let coordinates={};if(Browser.isTouch&&event&&event.type!==click){let e=event;"touchmove"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type||(coordinates.pageX=e.changedTouches[0].pageX,coordinates.pageY=e.changedTouches[0].pageY)}else if(event){let e=event;coordinates.pageX=e.pageX,coordinates.pageY=e.pageY}return coordinates}getElementByPosition(event){if(this.parent.isAdaptive){let e=this.getCoordinate(event);return document.elementFromPoint(e.pageX-window.pageXOffset,e.pageY-window.pageYOffset)}return event.target}multipleSelectionEnabled(){"Cell"!==this.parent.selectionSettings.mode&&"Multiple"===this.parent.selectionSettings.type&&this.parent.selectionModule.hidePopUp()}unWireEvents(){this.parent.isDestroyed||(this.parent.off("chartMouseDown",this.mouseDownHandler),this.parent.off("chartMouseUp",this.mouseUpHandler),this.parent.off("chartMouseLeave",this.mouseLeaveHandler),this.parent.off("chartMouseMove",this.mouseMoveAction),this.parent.off("chartMouseClick",this.mouseClickHandler))}destroy(){this.unWireEvents(),this.stopScrollTimer()}}class ej2_gantt_es2015_DialogEdit{constructor(parent){this.updatedEditFields=null,this.updatedAddFields=null,this.addedRecord=null,this.dialogEditValidationFlag=!1,this.ganttResources=[],this.parent=parent,this.localeObj=this.parent.localeObj,this.beforeOpenArgs={cancel:!1},this.types=this.getPredecessorType(),this.rowData={},this.editedRecord={},this.inputs={booleanedit:ej2_buttons_es2015_CheckBox,dropdownedit:ej2_dropdowns_es2015_DropDownList,datepickeredit:ej2_calendars_es2015_DatePicker,datetimepickeredit:ej2_calendars_es2015_DateTimePicker,maskededit:ej2_inputs_es2015_MaskedTextBox,numericedit:ej2_inputs_es2015_NumericTextBox,stringedit:ej2_inputs_es2015_TextBox},this.processDialogFields(),this.wireEvents()}wireEvents(){this.parent.on("chartDblClick",this.dblClickHandler,this)}dblClickHandler(e){let ganttData=this.parent.ganttChartModule.getRecordByTarget(e);isNullOrUndefined(ganttData)||this.openEditDialog(ganttData)}processDialogFields(){isNullOrUndefined(this.parent.editDialogFields)||this.parent.editDialogFields&&0===this.parent.editDialogFields.length?(this.updatedEditFields=this.getDefaultDialogFields(),this.updatedEditFields=this.validateDialogFields(this.updatedEditFields)):this.updatedEditFields=this.validateDialogFields(this.parent.editDialogFields),isNullOrUndefined(this.parent.addDialogFields)||this.parent.addDialogFields&&0===this.parent.addDialogFields.length?(this.updatedAddFields=this.getDefaultDialogFields(),this.updatedAddFields=this.validateDialogFields(this.updatedAddFields)):this.updatedAddFields=this.validateDialogFields(this.parent.addDialogFields)}validateDialogFields(dialogFields){let newDialogFields=[],emptyCustomColumn=0;for(let i=0;i<dialogFields.length;i++){let fieldItem=getActualProperties(dialogFields[i]);"General"!==fieldItem.type||!isNullOrUndefined(fieldItem.fields)&&0!==fieldItem.fields.length||(fieldItem.fields=this.getGeneralColumnFields()),"Dependency"===fieldItem.type&&isNullOrUndefined(this.parent.taskFields.dependency)||"Resources"===fieldItem.type&&isNullOrUndefined(this.parent.taskFields.resourceInfo)||"Notes"===fieldItem.type&&isNullOrUndefined(this.parent.taskFields.notes)||("Custom"!==fieldItem.type||!isNullOrUndefined(fieldItem.fields)&&0!==fieldItem.fields.length||(emptyCustomColumn+=1,fieldItem.fields=this.getCustomColumnFields()),emptyCustomColumn>1||newDialogFields.push(fieldItem))}return newDialogFields}getGeneralColumnFields(){let fields=[];for(let key of Object.keys(this.parent.columnMapping))"dependency"!==key&&"resourceInfo"!==key&&"notes"!==key&&fields.push(this.parent.columnMapping[key]);return fields}getCustomColumnFields(){let fields=[];for(let i=0;i<this.parent.customColumns.length;i++)fields.push(this.parent.customColumns[i]);return fields}getDefaultDialogFields(){let fields,dialogFields=[],fieldItem={};return 0!==Object.keys(this.parent.columnMapping).length&&(fieldItem.type="General",fields=this.getGeneralColumnFields(),dialogFields.push(fieldItem)),isNullOrUndefined(getValue("dependency",this.parent.columnMapping))||((fieldItem={}).type="Dependency",dialogFields.push(fieldItem)),isNullOrUndefined(getValue("resourceInfo",this.parent.columnMapping))||((fieldItem={}).type="Resources",dialogFields.push(fieldItem)),isNullOrUndefined(getValue("notes",this.parent.columnMapping))||((fieldItem={}).type="Notes",dialogFields.push(fieldItem)),this.parent.customColumns.length>0&&((fieldItem={}).type="Custom",dialogFields.push(fieldItem)),dialogFields}openAddDialog(){this.isEdit=!1,this.editedRecord=this.composeAddRecord(),this.createDialog()}getMinimumStartDate(){let minDate=ej2_data_es2015_DataUtil.aggregates.min(this.parent.flatData,"ganttProperties.startDate");return minDate=isNullOrUndefined(minDate)?new Date(this.parent.timelineModule.timelineStartDate.getTime()):new Date(minDate.getTime()),minDate=this.parent.dateValidationModule.checkStartDate(minDate),new Date(minDate.getTime())}composeAddRecord(){let tempData={ganttProperties:{}},columns=this.parent.ganttColumns,taskSettings=this.parent.taskFields,id=this.parent.editModule.getNewTaskId();for(let i=0;i<columns.length;i++){let field=columns[i].field;field===taskSettings.id?(tempData[field]=id,tempData.ganttProperties.taskId=tempData[field]):columns[i].field===taskSettings.startDate?(tempData[field]=isNullOrUndefined(tempData[taskSettings.endDate])?this.getMinimumStartDate():new Date(tempData[taskSettings.endDate]),tempData.ganttProperties.startDate=new Date(tempData[field])):columns[i].field===taskSettings.endDate?(tempData[field]=isNullOrUndefined(tempData[taskSettings.startDate])?this.getMinimumStartDate():new Date(tempData[taskSettings.startDate]),tempData.ganttProperties.endDate=new Date(tempData[field])):columns[i].field===taskSettings.duration?(tempData[field]=1,tempData.ganttProperties.duration=tempData[field],tempData.ganttProperties.durationUnit=this.parent.durationUnit.toLocaleLowerCase()):columns[i].field===taskSettings.name?(tempData[field]="New Task "+id,tempData.ganttProperties.taskName=tempData[field]):columns[i].field===taskSettings.progress?(tempData[field]=0,tempData.ganttProperties.progress=tempData[field]):tempData[this.parent.ganttColumns[i].field]=""}return tempData}openToolbarEditDialog(){let gObj=this.parent;if(gObj.editModule&&gObj.editSettings.allowEditing){let selectedRowId=gObj.selectionModule?"Row"!==gObj.selectionSettings.mode&&"Both"!==gObj.selectionSettings.mode||1!==gObj.selectionModule.selectedRowIndexes.length?"Cell"===gObj.selectionSettings.mode&&1===gObj.selectionModule.getSelectedRowCellIndexes().length?gObj.currentViewData[gObj.selectionModule.getSelectedRowCellIndexes()[0].rowIndex].ganttProperties.taskId:null:gObj.currentViewData[gObj.selectionModule.selectedRowIndexes[0]].ganttProperties.taskId:null;isNullOrUndefined(selectedRowId)||this.openEditDialog(selectedRowId)}}openEditDialog(taskId){let ganttObj=this.parent;"object"==typeof taskId?(this.rowIndex=this.parent.currentViewData.indexOf(taskId),this.rowIndex>-1&&(this.rowData=taskId)):isNullOrUndefined(taskId)?ganttObj.selectedRowIndex>-1&&(this.rowData=ganttObj.currentViewData[ganttObj.selectedRowIndex],this.rowIndex=ganttObj.selectedRowIndex):(this.rowIndex=ganttObj.ids.indexOf(taskId.toString()),this.rowIndex>-1&&(this.rowData=ganttObj.flatData[this.rowIndex])),this.isEdit=!0,this.editedRecord=extend({},{},this.rowData,!0),this.createDialog()}createDialog(){let ganttObj=this.parent,dialogModel={};this.beforeOpenArgs.dialogModel=dialogModel,this.beforeOpenArgs.rowData=this.editedRecord,this.beforeOpenArgs.rowIndex=this.rowIndex,this.dialog=this.parent.createElement("div",{id:ganttObj.element.id+"_dialog",styles:"max-width:"+(this.parent.isAdaptive?"":"600px")}),ganttObj.element.appendChild(this.dialog),dialogModel.animationSettings={effect:"None"},dialogModel.header=this.localeObj.getConstant(this.isEdit?"editDialogTitle":"addDialogTitle"),dialogModel.isModal=!0,dialogModel.cssClass="e-gantt-dialog",dialogModel.allowDragging=!this.parent.isAdaptive,dialogModel.showCloseIcon=!0,dialogModel.position=this.parent.isAdaptive?{X:"top",Y:"left"}:{X:"center",Y:"center"},dialogModel.height=this.parent.isAdaptive?"100%":"auto",dialogModel.target=this.parent.element,dialogModel.close=this.dialogClose.bind(this),dialogModel.closeOnEscape=!0,dialogModel.open=args=>{let dialogElement=getValue("element",args),generalTabElement=dialogElement.querySelector("#"+this.parent.element.id+"GeneralTabContainer");generalTabElement&&generalTabElement.scrollHeight>generalTabElement.offsetHeight&&generalTabElement.classList.add("e-scroll"),0===this.tabObj.selectedItem&&this.tabObj.select(0),this.parent.isAdaptive&&(dialogElement.style.maxHeight="none")},dialogModel.locale=this.parent.locale,dialogModel.buttons=[{buttonModel:{content:this.localeObj.getConstant("saveButton"),cssClass:"e-primary"},click:this.buttonClick.bind(this)},{buttonModel:{cssClass:"e-flat",content:this.localeObj.getConstant("cancel")},click:this.buttonClick.bind(this)}];let tabElement=this.createTab();if(!this.beforeOpenArgs.cancel){dialogModel.content=tabElement,this.dialogObj=new ej2_popups_es2015_Dialog(dialogModel),this.dialogObj.isStringTemplate=!0,this.dialogObj.appendTo(this.dialog);let args={requestType:this.isEdit?"openEditDialog":"openAddDialog",data:this.beforeOpenArgs.rowData,element:this.dialog,cancel:!1};this.parent.trigger("actionComplete",args),args.cancel&&this.resetValues()}}buttonClick(e){let target=e.target;target.style.pointerEvents="none",this.localeObj.getConstant("cancel").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.hide(),this.dialogClose()):(this.initiateDialogSave(),target.style.pointerEvents="auto")}dialogClose(){this.dialog&&this.resetValues()}resetValues(){this.isEdit=!1,this.editedRecord={},this.rowData={},this.rowIndex=-1,this.addedRecord=null,this.ganttResources=[],this.dialog&&!this.dialogObj.isDestroyed&&(this.destroyDialogInnerElements(),this.dialogObj.destroy(),ej2_base_es2015_remove(this.dialog))}destroyDialogInnerElements(){let ganttObj=this.parent,items=this.beforeOpenArgs.tabModel.items;for(let i=0;i<items.length;i++){let element=items[i].content,id=element.id;isNullOrUndefined(id)&&""===id||("General"===(id=(id=id.replace(ganttObj.element.id,"")).replace("TabContainer",""))?this.destroyCustomField(element):"Dependency"===id?element.ej2_instances[0].destroy():"Notes"===id?element.ej2_instances[0].destroy():"Resources"===id?element.ej2_instances[0].destroy():-1!==id.indexOf("Custom")&&this.destroyCustomField(element))}}destroyCustomField(element){let childNodes=element.childNodes,ganttObj=this.parent;for(let i=0;i<childNodes.length;i++){let div=childNodes[i],inputElement=div.querySelector('input[id^="'+ganttObj.element.id+'"]');if(inputElement){let fieldName=inputElement.id.replace(ganttObj.element.id,""),controlObj=div.querySelector("#"+ganttObj.element.id+fieldName).ej2_instances[0];controlObj&&controlObj.destroy()}}}destroy(){this.resetValues(),this.parent.isDestroyed||this.parent.off("chartDblClick",this.dblClickHandler)}getEditFields(){return this.isEdit?this.updatedEditFields:this.updatedAddFields}createTab(){let tabElement,ganttObj=this.parent,tabModel={},tabItems=[],dialogSettings=this.getEditFields(),tasks=ganttObj.taskFields,length=dialogSettings.length;tabModel.items=tabItems,tabModel.locale=this.parent.locale,this.beforeOpenArgs.tabModel=tabModel;let index=0;if(length>0)for(let i=0;i<length;i++){let dialogField=dialogSettings[i],tabItem={};if("General"===dialogField.type){if(0===Object.keys(ganttObj.columnMapping).length)continue;isNullOrUndefined(dialogField.headerText)&&(dialogField.headerText=this.localeObj.getConstant("generalTab")),tabItem.content="General",this.beforeOpenArgs[tabItem.content]=this.getFieldsModel(dialogField.fields)}else if("Dependency"===dialogField.type){if(isNullOrUndefined(tasks.dependency))continue;isNullOrUndefined(dialogField.headerText)&&(dialogField.headerText=this.localeObj.getConstant("dependency")),tabItem.content="Dependency",this.beforeOpenArgs[tabItem.content]=this.getPredecessorModel(dialogField.fields)}else if("Resources"===dialogField.type){if(isNullOrUndefined(tasks.resourceInfo))continue;isNullOrUndefined(dialogField.headerText)&&(dialogField.headerText=this.localeObj.getConstant("resourceName")),tabItem.content="Resources",this.beforeOpenArgs[tabItem.content]=this.getResourcesModel(dialogField.fields)}else if("Notes"===dialogField.type){if(isNullOrUndefined(tasks.notes))continue;isNullOrUndefined(dialogField.headerText)&&(dialogField.headerText=this.localeObj.getConstant("notes")),tabItem.content="Notes",this.beforeOpenArgs[tabItem.content]=this.getNotesModel(dialogField.fields)}else{if(isNullOrUndefined(dialogField.fields)||0===dialogField.fields.length)continue;isNullOrUndefined(dialogField.headerText)&&(dialogField.headerText=this.localeObj.getConstant("customTab")),tabItem.content="Custom"+index++,this.beforeOpenArgs[tabItem.content]=this.getFieldsModel(dialogField.fields)}tabItem.header={text:dialogField.headerText},tabItems.push(tabItem)}return this.beforeOpenArgs.requestType=this.isEdit?"beforeOpenEditDialog":"beforeOpenAddDialog",this.renderTabItems(),this.parent.trigger("actionBegin",this.beforeOpenArgs),this.beforeOpenArgs.cancel?tabElement:(tabModel.selected=this.tabSelectedEvent.bind(this),tabModel.height=this.parent.isAdaptive?"100%":"auto",tabModel.overflowMode="Scrollable",this.tabObj=new ej2_navigations_es2015_Tab(tabModel),this.tabObj.isStringTemplate=!0,tabElement=this.parent.createElement("div",{id:ganttObj.element.id+"_Tab"}),this.tabObj.appendTo(tabElement),tabElement)}tabSelectedEvent(args){let ganttObj=this.parent,id=args.selectedContent.childNodes[0].id;if(this.parent.isAdaptive&&this.responsiveTabContent(id,ganttObj),id===ganttObj.element.id+"ResourcesTabContainer"){let resourceGrid=ganttObj.element.querySelector("#"+id).ej2_instances[0],resources=this.ganttResources;resources&&resources.length>0&&resourceGrid.currentViewData.forEach((data,index)=>{for(let i=0;i<resources.length;i++)data[ganttObj.resourceIDMapping]===resources[i][ganttObj.resourceIDMapping]&&-1===resourceGrid.selectionModule.selectedRowIndexes.indexOf(index)&&resourceGrid.selectRow(index)})}else id===ganttObj.element.id+"NotesTabContainer"&&ganttObj.element.querySelector("#"+id).ej2_instances[0].refresh()}responsiveTabContent(id,ganttObj){let dialogContent=document.getElementById(ganttObj.element.id+"_dialog_dialog-content"),dialogContentHeight=dialogContent.clientHeight;dialogContentHeight-=dialogContent.querySelector(".e-tab-header").offsetHeight;let grid=document.querySelector("#"+id);if(grid.classList.contains("e-grid")){dialogContentHeight-=grid.ej2_instances[0].getHeaderContent().offsetHeight;let toolbar=grid.querySelector(".e-toolbar");toolbar&&(dialogContentHeight-=toolbar.offsetHeight)}grid.parentElement.style.height=dialogContentHeight+"px"}getFieldsModel(fields){let fieldsModel={},columnByField=this.parent.columnByField;for(let i=0;i<fields.length;i++)fields[i]===this.parent.taskFields.dependency||fields[i]===this.parent.taskFields.resourceInfo||fields[i]===this.parent.taskFields.notes||isNullOrUndefined(columnByField[fields[i]])||this.createInputModel(columnByField[fields[i]],fieldsModel);return fieldsModel}createInputModel(column,fieldsModel){let ganttObj=this.parent,locale=this.parent.locale,taskSettings=this.parent.taskFields,common={placeholder:column.headerText,floatLabelType:"Auto"};switch(column.editType){case"booleanedit":fieldsModel[column.field]={label:column.headerText,locale:locale};break;case"stringedit":let textBox=common;column.field===ganttObj.columnMapping.duration&&(textBox.change=args=>{this.validateScheduleFields(args,column,ganttObj)}),fieldsModel[column.field]=common;break;case"numericedit":fieldsModel[column.field]=common;break;case"datepickeredit":let datePickerObj=common;datePickerObj.format=this.parent.dateFormat,datePickerObj.strictMode=!0,datePickerObj.firstDayOfWeek=ganttObj.timelineModule.customTimelineSettings.weekStartDay,column.field!==ganttObj.columnMapping.startDate&&column.field!==ganttObj.columnMapping.endDate||(datePickerObj.renderDayCell=this.parent.renderWorkingDayCell.bind(this.parent),datePickerObj.change=args=>{this.validateScheduleFields(args,column,ganttObj)}),fieldsModel[column.field]=datePickerObj;break;case"datetimepickeredit":let dateTimePickerObj=common;dateTimePickerObj.format=this.parent.dateFormat,dateTimePickerObj.strictMode=!0,dateTimePickerObj.firstDayOfWeek=ganttObj.timelineModule.customTimelineSettings.weekStartDay,column.field!==ganttObj.columnMapping[taskSettings.startDate]&&column.field!==ganttObj.columnMapping[taskSettings.endDate]||(dateTimePickerObj.renderDayCell=this.parent.renderWorkingDayCell.bind(this.parent),dateTimePickerObj.change=args=>{this.validateScheduleFields(args,column,ganttObj)}),fieldsModel[column.field]=dateTimePickerObj;break;case"dropdownedit":case"maskededit":fieldsModel[column.field]=common}return isNullOrUndefined(column.edit)||extend(fieldsModel[column.field],column.edit.params),fieldsModel}validateScheduleFields(args,column,ganttObj){let inputElement,dialog=ganttObj.editModule.dialogModule.dialog,targetId=null,currentData=ganttObj.editModule.dialogModule.editedRecord;isNullOrUndefined(args.element)?isNullOrUndefined(args.container)||(targetId=(inputElement=args.container).querySelector("input").getAttribute("id"),inputElement=inputElement.querySelector("#"+targetId)):targetId=(inputElement=args.element).getAttribute("id");let cellValue=inputElement.value,colName=targetId.replace(ganttObj.element.id,"");this.validateScheduleValuesByCurrentField(colName,cellValue,this.editedRecord);let ganttProp=currentData.ganttProperties,tasks=ganttObj.taskFields;return isNullOrUndefined(tasks.startDate)||this.updateScheduleFields(dialog,ganttProp,"startDate"),isNullOrUndefined(tasks.endDate)||this.updateScheduleFields(dialog,ganttProp,"endDate"),isNullOrUndefined(tasks.duration)||this.updateScheduleFields(dialog,ganttProp,"duration"),this.dialogEditValidationFlag=!1,!0}updateScheduleFields(dialog,ganttProp,ganttField){let tempValue,ganttObj=this.parent,ganttId=ganttObj.element.id,columnName=getValue(ganttField,ganttObj.columnMapping),col=ganttObj.columnByField[columnName];if("stringedit"===col.editType){let textBox=dialog.querySelector("#"+ganttId+columnName).ej2_instances[0];tempValue=this.parent.dataOperation.getDurationString(ganttProp.duration,ganttProp.durationUnit),textBox.value!==tempValue&&(textBox.value=tempValue,textBox.dataBind())}else if("datepickeredit"===col.editType||"datetimepickeredit"===col.editType){let picker=dialog.querySelector("#"+ganttId+columnName).ej2_instances[0];tempValue=ganttProp[ganttField],(isNullOrUndefined(picker.value)&&!isNullOrUndefined(tempValue)||isNullOrUndefined(tempValue)&&!isNullOrUndefined(picker.value)||picker.value!==tempValue&&!isNullOrUndefined(picker.value)&&!isNullOrUndefined(tempValue)&&picker.value.toString()!==tempValue.toString())&&(picker.value=tempValue,picker.dataBind())}}validateDuration(ganttData){let ganttProp=ganttData.ganttProperties;this.dialogEditValidationFlag||(isNullOrUndefined(ganttProp.duration)?(this.parent.setRecordValue("endDate",null,ganttProp,!0),this.parent.setRecordValue("isMilestone",!1,ganttProp,!0)):isScheduledTask(ganttProp)||!isNullOrUndefined(ganttProp.startDate)?(ganttData.ganttProperties.isMilestone&&0!==ganttData.ganttProperties.duration&&this.parent.dateValidationModule.calculateStartDate(ganttData),this.parent.dateValidationModule.calculateEndDate(ganttData)):isScheduledTask(ganttProp)||isNullOrUndefined(ganttProp.endDate)||this.parent.dateValidationModule.calculateStartDate(ganttData),this.parent.setRecordValue("isMilestone",0===ganttProp.duration,ganttProp,!0),this.dialogEditValidationFlag=!0)}validateStartDate(ganttData){let ganttProp=ganttData.ganttProperties,tasks=this.parent.taskFields;this.dialogEditValidationFlag||(isNullOrUndefined(ganttProp.startDate)?(this.parent.setRecordValue("endDate",null,ganttProp,!0),this.parent.setRecordValue("isMilestone",!1,ganttProp,!0)):isScheduledTask(ganttProp)?isNullOrUndefined(tasks.duration)?this.parent.dateValidationModule.calculateDuration(ganttData):(isNullOrUndefined(tasks.endDate),this.parent.dateValidationModule.calculateEndDate(ganttData)):isNullOrUndefined(ganttProp.endDate)?isNullOrUndefined(ganttProp.duration)||this.parent.dateValidationModule.calculateEndDate(ganttData):this.parent.dateValidationModule.calculateDuration(ganttData),this.dialogEditValidationFlag=!0)}validateEndDate(ganttData){let ganttProp=ganttData.ganttProperties,tasks=this.parent.taskFields;this.dialogEditValidationFlag||(isNullOrUndefined(ganttProp.endDate)?(this.parent.setRecordValue("duration",null,ganttProp,!0),this.parent.setRecordValue("isMilestone",!1,ganttProp,!0)):isScheduledTask(ganttProp)?isNullOrUndefined(tasks.duration)?this.parent.dateValidationModule.calculateDuration(ganttData):isNullOrUndefined(ganttProp.startDate)?this.parent.dateValidationModule.calculateStartDate(ganttData):this.parent.dateValidationModule.calculateDuration(ganttData):isNullOrUndefined(ganttProp.duration)?isNullOrUndefined(ganttProp.startDate)||this.parent.dateValidationModule.calculateDuration(ganttData):this.parent.dateValidationModule.calculateStartDate(ganttData),this.dialogEditValidationFlag=!0)}validateScheduleValuesByCurrentField(columnName,value,currentData){let ganttObj=this.parent,ganttProp=currentData.ganttProperties,taskSettings=ganttObj.taskFields;if(taskSettings.duration===columnName&&(isNullOrUndefined(value)||""===value?ganttObj.allowUnscheduledTasks&&this.parent.setRecordValue("duration",null,ganttProp,!0):ganttObj.dataOperation.updateDurationValue(value,ganttProp),this.validateDuration(currentData)),taskSettings.startDate===columnName){if(""!==value){let startDate=this.parent.dateValidationModule.getDateFromFormat(value);startDate=this.parent.dateValidationModule.checkStartDate(startDate),this.parent.setRecordValue("startDate",startDate,ganttProp,!0)}else ganttObj.allowUnscheduledTasks&&!currentData.hasChildRecords&&this.parent.setRecordValue("startDate",null,ganttProp,!0);this.validateStartDate(currentData)}if(taskSettings.endDate===columnName){if(""!==value){let endDate=this.parent.dateValidationModule.getDateFromFormat(value);0===endDate.getHours()&&86400!==ganttObj.defaultEndTime&&this.parent.dateValidationModule.setTime(ganttObj.defaultEndTime,endDate),endDate=this.parent.dateValidationModule.checkEndDate(endDate,ganttProp),(isNullOrUndefined(ganttProp.startDate)||endDate.getTime()>ganttProp.startDate.getTime())&&this.parent.setRecordValue("endDate",endDate,ganttProp,!0)}else ganttObj.allowUnscheduledTasks&&this.parent.setRecordValue("endDate",null,ganttProp,!0);this.validateEndDate(currentData)}return!0}getPredecessorModel(fields){(isNullOrUndefined(fields)||0===fields.length)&&(fields=["ID","Name","Type","Offset"]);let inputModel={editSettings:{allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"}};inputModel.locale=this.parent.locale,inputModel.dataSource=[],inputModel.rowHeight=this.parent.isAdaptive?48:null,inputModel.toolbar=[{id:this.parent.element.id+"DependencyTabContainer_add",prefixIcon:"e-add",tooltipText:this.localeObj.getConstant("add"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("add")},{id:this.parent.element.id+"DependencyTabContainer_delete",prefixIcon:"e-delete",tooltipText:this.localeObj.getConstant("delete"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("delete")}];let columns=[];for(let i=0;i<fields.length;i++){let column={};"id"===fields[i].toLowerCase()?(column={field:"id",headerText:this.localeObj.getConstant("id"),allowEditing:!1,width:"70px"},columns.push(column)):"name"===fields[i].toLowerCase()?(column={field:"name",headerText:this.localeObj.getConstant("name"),editType:"stringedit",width:"250px",validationRules:{required:!0}},columns.push(column)):"type"===fields[i].toLowerCase()?(column={field:"type",headerText:this.localeObj.getConstant("type"),editType:"dropdownedit",dataSource:this.types,foreignKeyField:"id",foreignKeyValue:"text",defaultValue:"FS",validationRules:{required:!0},width:"150px"},columns.push(column)):"offset"===fields[i].toLowerCase()&&(column={field:"offset",headerText:this.localeObj.getConstant("offset"),editType:"stringedit",defaultValue:"0 days",validationRules:{required:!0},width:"100px"},columns.push(column))}return inputModel.columns=columns,inputModel.height=this.parent.isAdaptive?"100%":"153px",inputModel}getResourcesModel(fields){let ganttObj=this.parent;(isNullOrUndefined(fields)||0===fields.length)&&(fields=[ganttObj.resourceIDMapping,ganttObj.resourceNameMapping]);let inputModel={allowFiltering:!0,locale:this.parent.locale,allowSelection:!0,rowHeight:this.parent.isAdaptive?48:null,filterSettings:{type:"Menu"},selectionSettings:{checkboxOnly:!0,checkboxMode:"ResetOnRowClick",persistSelection:!0,type:"Multiple"}},columns=[{type:"checkbox",allowEditing:!1,allowSorting:!1,allowFiltering:!1,width:60}];for(let i=0;i<fields.length;i++){let column={};fields[i]===ganttObj.resourceIDMapping?(column={field:ganttObj.resourceIDMapping,headerText:this.localeObj.getConstant("id"),isPrimaryKey:!0,width:"100px"},columns.push(column)):fields[i]===ganttObj.resourceNameMapping&&(column={field:ganttObj.resourceNameMapping,headerText:this.localeObj.getConstant("name")},columns.push(column))}return inputModel.columns=columns,inputModel.height=this.parent.isAdaptive?"100%":"196px",inputModel}getNotesModel(fields){return(isNullOrUndefined(fields)||0===fields.length)&&(fields=["Bold","Italic","Underline","StrikeThrough","FontName","FontSize","FontColor","BackgroundColor","LowerCase","UpperCase","|","Alignments","OrderedList","UnorderedList","Outdent","Indent","|","CreateTable","CreateLink","|","ClearFormat","Print","|","Undo","Redo"]),{placeholder:this.localeObj.getConstant("writeNotes"),toolbarSettings:{items:fields},height:this.parent.isAdaptive?"100%":"auto",locale:this.parent.locale}}createDivElement(className,id){return ej2_base_es2015_createElement("div",{className:className,id:id})}createInputElement(className,id,fieldName,type){return ej2_base_es2015_createElement(type||"input",{className:className,attrs:{type:"text",id:id,name:fieldName,title:fieldName}})}renderTabItems(){let items=this.beforeOpenArgs.tabModel.items,index=0;for(let i=0;i<items.length;i++){let item=items[i];item.content instanceof HTMLElement||("General"===item.content?item.content=this.renderGeneralTab(item.content):"Dependency"===item.content?(this.editedRecord.hasChildRecords&&(item.disabled=!0),item.content=this.renderPredecessorTab(item.content)):"Resources"===item.content?item.content=this.renderResourceTab(item.content):item.content==="Custom"+index?(item.content=this.renderCustomTab(item.content),index++):"Notes"===item.content&&(item.content=this.renderNotesTab(item.content)))}}renderGeneralTab(itemName){let itemModel=this.beforeOpenArgs[itemName],divElement=this.createDivElement("e-edit-form-row",this.parent.element.id+""+itemName+"TabContainer");for(let key of Object.keys(itemModel))divElement.appendChild(this.renderInputElements(itemModel[key],this.parent.columnByField[key]));return divElement}isCheckIsDisabled(column){let disabled=!1;return this.isEdit&&(column.field===this.parent.taskFields.id&&(disabled=!0),this.editedRecord.hasChildRecords&&(column.field===this.parent.taskFields.endDate?disabled=!0:column.field===this.parent.taskFields.duration?disabled=!0:column.field===this.parent.taskFields.progress?disabled=!0:column.field===this.parent.taskFields.progress&&(disabled=!0))),disabled}renderPredecessorTab(itemName){let ganttObj=this.parent,gridModel=this.beforeOpenArgs[itemName],ganttData=this.beforeOpenArgs.rowData,preData=[];this.taskNameCollection(),this.isEdit&&(preData=this.predecessorEditCollection(ganttData),this.updatePredecessorDropDownData(ganttData)),gridModel.dataSource=preData,gridModel.columns[1].edit={write:args=>{new ej2_dropdowns_es2015_ComboBox({dataSource:new ej2_data_es2015_DataManager(this.preTableCollection),popupHeight:"180px",allowCustom:!1,fields:{value:"text"},value:args.rowData.name,change:args=>{closest(args.element,"tr").querySelector("#"+this.parent.element.id+"DependencyTabContainerid").value=isNullOrUndefined(args.itemData)||isNullOrUndefined(args.item)?"":args.itemData.id},autofill:!0}).appendTo(args.element)},read:args=>args.ej2_instances[0].value},ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_Edit,ej2_grids_es2015_Page,ej2_grids_es2015_Toolbar$1,ej2_grids_es2015_ForeignKey);let gridObj=new ej2_grids_es2015_Grid(gridModel),divElement=this.createDivElement("e-dependent-div",ganttObj.element.id+""+itemName+"TabContainer");return gridObj.appendTo(divElement),divElement}updateResourceCollection(args,resourceGridId){if(!isNullOrUndefined(args.data)){let resourceGrid=this.parent.element.querySelector("#"+resourceGridId).ej2_instances[0];this.ganttResources=!isNullOrUndefined(resourceGrid)&&resourceGrid.selectionModule.getSelectedRecords().length>0?extend([],resourceGrid.selectionModule.getSelectedRecords()):[]}}renderResourceTab(itemName){let ganttObj=this.parent,ganttData=this.beforeOpenArgs.rowData,inputModel=this.beforeOpenArgs[itemName],resourceGridId=ganttObj.element.id+""+itemName+"TabContainer";inputModel.dataSource=ganttObj.resources;let resourceInfo=ganttData.ganttProperties.resourceInfo;if(this.isEdit&&!isNullOrUndefined(resourceInfo))for(let i=0;i<resourceInfo.length;i++)this.ganttResources.push(resourceInfo[i]);inputModel.rowSelected=args=>{this.updateResourceCollection(args,resourceGridId)},inputModel.rowDeselected=args=>{this.updateResourceCollection(args,resourceGridId)};let divElement=this.createDivElement("e-resource-div",resourceGridId);return ej2_grids_es2015_Grid.Inject(ej2_grids_es2015_Selection,ej2_grids_es2015_Filter),new ej2_grids_es2015_Grid(inputModel).appendTo(divElement),divElement}renderCustomTab(itemName){return this.renderGeneralTab(itemName)}renderNotesTab(itemName){let inputModel=this.beforeOpenArgs[itemName],ganttProp=this.editedRecord.ganttProperties,divElement=this.createDivElement("",this.parent.element.id+""+itemName+"TabContainer");return ej2_richtexteditor_es2015_RichTextEditor.Inject(ej2_richtexteditor_es2015_Toolbar$1,ej2_richtexteditor_es2015_Link,ej2_richtexteditor_es2015_HtmlEditor,ej2_richtexteditor_es2015_QuickToolbar,ej2_richtexteditor_es2015_Count),inputModel.value=ganttProp.notes,new ej2_richtexteditor_es2015_RichTextEditor(inputModel).appendTo(divElement),divElement}renderInputElements(inputModel,column){let ganttId=this.parent.element.id,ganttData=this.editedRecord,divElement=this.createDivElement("e-edit-form-column"),inputElement=this.createInputElement("",ganttId+""+column.field,column.field);if(divElement.appendChild(inputElement),inputModel.enabled=!this.isCheckIsDisabled(column),column.field===this.parent.taskFields.duration){let ganttProp=ganttData.ganttProperties;inputModel.value=this.parent.dataOperation.getDurationString(ganttProp.duration,ganttProp.durationUnit)}else inputModel.value=ganttData[column.field];return new this.inputs[column.editType](inputModel).appendTo(inputElement),divElement}taskNameCollection(){let flatData=this.parent.flatData;this.preTaskIds=[],this.preTableCollection=[];for(let i=0;i<flatData.length;i++){let data=flatData[i];if(data.hasChildRecords)continue;let tempObject={id:data.ganttProperties.taskId.toString(),text:data.ganttProperties.taskId.toString()+"-"+data.ganttProperties.taskName,value:data.ganttProperties.taskId.toString()};this.preTaskIds.push(tempObject.id),this.preTableCollection.push(tempObject)}}predecessorEditCollection(ganttData){let preDataCollection=[],ganttProp=ganttData.ganttProperties;if(this.isEdit&&!isNullOrUndefined(this.parent.taskFields.dependency)&&!isNullOrUndefined(ganttData)&&!isNullOrUndefined(ganttProp.predecessor)){let predecessor=ganttProp.predecessor,idCollection=this.preTableCollection;for(let i=0;i<predecessor.length;i++){let from=predecessor[i].from.toString(),preData={};if(ganttProp.taskId.toString()!==from){preData.id=from;for(let index=0;index<idCollection.length;index++)if(idCollection[index].value===from){preData.name=idCollection[index].text;break}preData.type=predecessor[i].type;let offset=Math.abs(predecessor[i].offset);preData.offset=this.parent.dataOperation.getDurationString(offset,predecessor[i].offsetUnit),preDataCollection.push(preData)}}}return preDataCollection}updatePredecessorDropDownData(ganttData){let index=-1,id=ganttData.ganttProperties.taskId.toString();index=this.preTaskIds.indexOf(id),this.preTableCollection.splice(index,1),this.preTaskIds.splice(index,1),this.validSuccessorTasks(ganttData,this.preTaskIds,this.preTableCollection)}validSuccessorTasks(data,ids,idCollection){let ganttProp=data.ganttProperties;if(ganttProp.predecessor&&ganttProp.predecessor.length>0){let predecessor=ganttProp.predecessor,fromId=ganttProp.taskId.toString();predecessor.forEach(item=>{if(item.from.toString()===fromId){let toId=item.to,idIndex=-1;(idIndex=ids.indexOf(toId))>-1&&(ids.splice(idIndex,1),idCollection.splice(idIndex,1));let ganttData=this.parent.getRecordByID(toId);this.validSuccessorTasks(ganttData,ids,idCollection)}})}}getPredecessorType(){let typeText=[this.parent.getPredecessorTextValue("SS"),this.parent.getPredecessorTextValue("SF"),this.parent.getPredecessorTextValue("FS"),this.parent.getPredecessorTextValue("FF")];return[{id:"FS",text:typeText[2],value:typeText[2]},{id:"FF",text:typeText[3],value:typeText[3]},{id:"SS",text:typeText[0],value:typeText[0]},{id:"SF",text:typeText[1],value:typeText[1]}]}initiateDialogSave(){this.isEdit?this.parent.initiateEditAction(!0):this.addedRecord={};let ganttObj=this.parent,items=this.beforeOpenArgs.tabModel.items;for(let i=0;i<items.length;i++){let element=items[i].content,id=element.id;isNullOrUndefined(id)&&""===id||("General"===(id=(id=id.replace(ganttObj.element.id,"")).replace("TabContainer",""))?this.updateGeneralTab(element,!1):"Dependency"===id?this.updatePredecessorTab(element):"Notes"===id?this.updateNotesTab(element):"Resources"===id?this.updateResourceTab(element):-1!==id.indexOf("Custom")&&this.updateCustomTab(element))}return this.isEdit?(this.parent.dataOperation.updateWidthLeft(this.rowData),this.parent.editModule.initiateUpdateAction({data:this.rowData,action:"DialogEditing"})):this.parent.editModule.addRecord(this.addedRecord,this.parent.editSettings.newRowPosition),!0}updateGeneralTab(generalForm,isCustom){let ganttObj=this.parent,childNodes=generalForm.childNodes,tasksData={};this.isEdit||(tasksData=this.addedRecord);for(let i=0;i<childNodes.length;i++){let div=childNodes[i],inputElement=div.querySelector('input[id^="'+ganttObj.element.id+'"]');if(inputElement){let fieldName=inputElement.id.replace(ganttObj.element.id,""),controlObj=div.querySelector("#"+ganttObj.element.id+fieldName).ej2_instances[0];tasksData[fieldName]=controlObj.value}}this.isEdit&&(this.updateScheduleProperties(this.editedRecord,this.rowData),ganttObj.editModule.validateUpdateValues(tasksData,this.rowData,!0))}updateScheduleProperties(fromRecord,toRecord){this.parent.setRecordValue("startDate",fromRecord.ganttProperties.startDate,toRecord.ganttProperties,!0),this.parent.setRecordValue("endDate",fromRecord.ganttProperties.endDate,toRecord.ganttProperties,!0),this.parent.setRecordValue("duration",fromRecord.ganttProperties.duration,toRecord.ganttProperties,!0),this.parent.setRecordValue("durationUnit",fromRecord.ganttProperties.durationUnit,toRecord.ganttProperties,!0),isNullOrUndefined(this.parent.taskFields.startDate)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.startDate),isNullOrUndefined(this.parent.taskFields.endDate)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.endDate),isNullOrUndefined(this.parent.taskFields.duration)||(this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.duration),this.parent.setRecordValue("durationUnit",fromRecord.ganttProperties.durationUnit,this.rowData,!0),this.parent.setRecordValue("isMilestone",0===this.rowData.ganttProperties.duration,this.rowData.ganttProperties,!0))}updatePredecessorTab(preElement){let gridObj=preElement.ej2_instances[0];gridObj.isEdit&&gridObj.endEdit();let dataSource=gridObj.dataSource,predecessorName=[],newValues=[],predecessorString="",ids=[];for(let i=0;i<dataSource.length;i++){let preData=dataSource[i];if(-1===ids.indexOf(preData.id)){let name=preData.id+preData.type;preData.offset&&-1!==preData.offset.indexOf("-")?name+=preData.offset:name+="+"+preData.offset,predecessorName.push(name),ids.push(preData.id)}}this.isEdit?(predecessorName.length>0?(newValues=this.parent.predecessorModule.calculatePredecessor(predecessorName.join(","),this.rowData),this.parent.setRecordValue("predecessor",newValues,this.rowData.ganttProperties,!0),predecessorString=this.parent.predecessorModule.getPredecessorStringValue(this.rowData)):(this.parent.setRecordValue("predecessor",newValues=[],this.rowData.ganttProperties,!0),predecessorString=""),this.parent.setRecordValue("predecessorsName",predecessorString,this.rowData.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,predecessorString,this.rowData),this.parent.setRecordValue(this.parent.taskFields.dependency,predecessorString,this.rowData)):this.addedRecord[this.parent.taskFields.dependency]=predecessorName.length>0?predecessorName.join(","):""}updateResourceTab(resourceElement){let selectedItems=this.ganttResources,idArray=[];if(this.isEdit)this.parent.setRecordValue("resourceInfo",selectedItems,this.rowData.ganttProperties,!0),this.parent.dataOperation.updateMappingData(this.rowData,"resourceInfo");else{for(let i=0;i<selectedItems.length;i++)idArray.push(selectedItems[i][this.parent.resourceIDMapping]);this.addedRecord[this.parent.taskFields.resourceInfo]=idArray}}updateNotesTab(notesElement){let ganttObj=this.parent,rte=notesElement.ej2_instances[0];this.isEdit?(this.parent.setRecordValue("notes",rte.getHtml(),this.rowData.ganttProperties,!0),ganttObj.dataOperation.updateMappingData(this.rowData,"notes")):this.addedRecord[this.parent.taskFields.notes]=rte.getHtml()}updateCustomTab(customElement){this.updateGeneralTab(customElement,!0)}}class ej2_gantt_es2015_Edit$2{constructor(parent){if(this.isFromDeleteMethod=!1,this.targetedRecords=[],this.confirmDialog=null,this.taskbarMoved=!1,this.predecessorUpdated=!1,this.isBreakLoop=!1,this.deletedTaskDetails=[],this.parent=parent,this.validatedChildItems=[],this.parent.editSettings.allowEditing&&"Auto"===this.parent.editSettings.mode&&(this.cellEditModule=new ej2_gantt_es2015_CellEdit(this.parent)),(this.parent.editSettings.allowAdding||this.parent.editSettings.allowEditing&&("Dialog"===this.parent.editSettings.mode||"Auto"===this.parent.editSettings.mode))&&(this.dialogModule=new ej2_gantt_es2015_DialogEdit(this.parent),"Dialog"===this.parent.editSettings.mode&&(this.parent.treeGrid.recordDoubleClick=this.recordDoubleClick.bind(this))),this.parent.editSettings.allowTaskbarEditing&&(this.taskbarEditModule=new ej2_gantt_es2015_TaskbarEdit(this.parent)),this.parent.editSettings.allowDeleting){let confirmDialog=ej2_base_es2015_createElement("div",{id:this.parent.element.id+"_deleteConfirmDialog"});this.parent.element.appendChild(confirmDialog),this.renderDeleteConfirmDialog()}this.parent.treeGrid.editSettings.allowAdding=this.parent.editSettings.allowAdding,this.parent.treeGrid.editSettings.allowDeleting=this.parent.editSettings.allowDeleting,this.parent.treeGrid.editSettings.showDeleteConfirmDialog=this.parent.editSettings.showDeleteConfirmDialog}getModuleName(){return"edit"}reUpdateEditModules(){let editSettings=this.parent.editSettings;if(!this.parent.editModule.cellEditModule||editSettings.allowEditing&&"Dialog"!==editSettings.mode?!isNullOrUndefined(this.cellEditModule)&&editSettings.allowEditing&&"Auto"===editSettings.mode&&(this.cellEditModule=new ej2_gantt_es2015_CellEdit(this.parent)):this.cellEditModule.destroy(),this.taskbarEditModule&&!editSettings.allowTaskbarEditing?this.taskbarEditModule.destroy():!isNullOrUndefined(this.taskbarEditModule)&&editSettings.allowTaskbarEditing&&(this.taskbarEditModule=new ej2_gantt_es2015_TaskbarEdit(this.parent)),this.dialogModule&&!editSettings.allowEditing?this.dialogModule.destroy():!isNullOrUndefined(this.dialogModule)&&editSettings.allowEditing&&(this.dialogModule=new ej2_gantt_es2015_DialogEdit(this.parent),"Dialog"===this.parent.editSettings.mode&&(this.parent.treeGrid.recordDoubleClick=this.recordDoubleClick.bind(this))),!this.confirmDialog||this.confirmDialog.isDestroyed||editSettings.allowDeleting){if(!isNullOrUndefined(this.confirmDialog)&&this.parent.editSettings.allowDeleting){let confirmDialog=ej2_base_es2015_createElement("div",{id:this.parent.element.id+"_deleteConfirmDialog"});this.parent.element.appendChild(confirmDialog),this.renderDeleteConfirmDialog()}}else this.confirmDialog.destroy()}recordDoubleClick(args){let ganttData;if(args.row){let rowIndex=getValue("rowIndex",args.row);ganttData=this.parent.currentViewData[rowIndex]}!isNullOrUndefined(ganttData)&&this.parent.editSettings.allowEditing&&this.dialogModule.openEditDialog(ganttData)}destroy(){this.cellEditModule&&this.cellEditModule.destroy(),this.taskbarEditModule&&this.taskbarEditModule.destroy(),this.dialogModule&&this.dialogModule.destroy(),this.confirmDialog&&!this.confirmDialog.isDestroyed&&this.confirmDialog.destroy()}updateRecordByID(data){let tasks=this.parent.taskFields;if(isNullOrUndefined(data)||isNullOrUndefined(data[tasks.id]))return;let ganttData=this.parent.getRecordByID(data[tasks.id]);if(!isNullOrUndefined(this.parent.editModule)&&ganttData){this.parent.isOnEdit=!0,this.validateUpdateValues(data,ganttData,!0);let keys=Object.keys(data);if(-1===keys.indexOf(tasks.startDate)&&-1===keys.indexOf(tasks.endDate)&&-1===keys.indexOf(tasks.duration)||this.parent.dataOperation.calculateScheduledValues(ganttData,ganttData.taskData,!1),this.parent.dataOperation.updateWidthLeft(ganttData),isUndefined(data[this.parent.taskFields.dependency])||data[this.parent.taskFields.dependency]===ganttData.ganttProperties.predecessorsName){let args={};args.data=ganttData,this.parent.editModule.initiateUpdateAction(args)}else this.parent.connectorLineEditModule.updatePredecessor(ganttData,data[this.parent.taskFields.dependency])}}validateUpdateValues(data,ganttData,isFromDialog){let ganttObj=this.parent,tasks=ganttObj.taskFields,ganttPropByMapping=function(obj){let temp={};for(let key of Object.keys(obj))temp[obj[key]]=key;return temp}(ganttObj.columnMapping),scheduleFieldNames=[],isScheduleValueUpdated=!1;for(let key of Object.keys(data))if(!isNullOrUndefined(key)&&!isNullOrUndefined(data[key]))if(-1!==[tasks.startDate,tasks.endDate,tasks.duration].indexOf(key))isFromDialog?tasks.duration===key?(ganttObj.dataOperation.updateDurationValue(data[key],ganttData.ganttProperties),ganttData.ganttProperties.duration>0&&ganttData.ganttProperties.isMilestone&&this.parent.setRecordValue("isMilestone",!1,ganttData.ganttProperties,!0),ganttObj.dataOperation.updateMappingData(ganttData,ganttPropByMapping[key])):(ganttObj.setRecordValue(ganttPropByMapping[key],data[key],ganttData.ganttProperties,!0),ganttObj.dataOperation.updateMappingData(ganttData,ganttPropByMapping[key])):(scheduleFieldNames.push(key),isScheduleValueUpdated=!0);else if(tasks.resourceInfo===key){let resourceData=ganttObj.dataOperation.setResourceInfo(data);ganttData.ganttProperties.resourceInfo=resourceData,ganttObj.dataOperation.updateMappingData(ganttData,"resourceInfo")}else if(tasks.dependency===key);else if(-1!==[tasks.progress,tasks.notes,tasks.durationUnit,tasks.expandState,tasks.milestone,tasks.name,tasks.baselineStartDate,tasks.baselineEndDate,tasks.indicators,tasks.id].indexOf(key)){let column=ganttObj.columnByField[key],value=data[key];"datepickeredit"!==column.editType&&"datetimepickeredit"!==column.editType||(value=ganttObj.dataOperation.getDateFromFormat(value));let ganttPropKey=ganttPropByMapping[key];key===tasks.id?ganttPropKey="taskId":key===tasks.name&&(ganttPropKey="taskName"),ganttObj.setRecordValue(ganttPropKey,value,ganttData.ganttProperties,!0),(key===tasks.baselineStartDate||key===tasks.baselineEndDate)&&ganttData.ganttProperties.baselineStartDate&&ganttData.ganttProperties.baselineEndDate&&(ganttObj.setRecordValue("baselineLeft",ganttObj.dataOperation.calculateBaselineLeft(ganttData.ganttProperties),ganttData.ganttProperties,!0),ganttObj.setRecordValue("baselineWidth",ganttObj.dataOperation.calculateBaselineWidth(ganttData.ganttProperties),ganttData.ganttProperties,!0)),ganttObj.setRecordValue("taskData."+key,value,ganttData),ganttObj.setRecordValue(key,value,ganttData)}else if(-1!==ganttObj.customColumns.indexOf(key)){let column=ganttObj.columnByField[key],value=data[key];"datepickeredit"!==column.editType&&"datetimepickeredit"!==column.editType||(value=ganttObj.dataOperation.getDateFromFormat(value)),ganttObj.setRecordValue("taskData."+key,value,ganttData),ganttObj.setRecordValue(key,value,ganttData)}isScheduleValueUpdated&&this.validateScheduleValues(scheduleFieldNames,ganttData,data)}validateScheduleValues(fieldNames,ganttData,data){fieldNames.length>2?this.parent.dataOperation.calculateScheduledValues(ganttData,data,!1):fieldNames.length>1?this.validateScheduleByTwoValues(data,fieldNames,ganttData):this.dialogModule.validateScheduleValuesByCurrentField(fieldNames[0],data[fieldNames[0]],ganttData)}validateScheduleByTwoValues(data,fieldNames,ganttData){let startDate,endDate,duration,ganttObj=this.parent,tasks=ganttObj.taskFields,ganttProp=ganttData.ganttProperties,isUnscheduledTask=ganttObj.allowUnscheduledTasks;-1!==fieldNames.indexOf(tasks.startDate)&&(startDate=data[tasks.startDate]),-1!==fieldNames.indexOf(tasks.endDate)&&(endDate=data[tasks.endDate]),-1!==fieldNames.indexOf(tasks.duration)&&(duration=data[tasks.duration]),startDate&&endDate||isUnscheduledTask&&-1!==fieldNames.indexOf(tasks.startDate)&&-1!==fieldNames.indexOf(tasks.endDate)?(ganttObj.setRecordValue("startDate",ganttObj.dataOperation.getDateFromFormat(startDate),ganttProp,!0),ganttObj.setRecordValue("endDate",ganttObj.dataOperation.getDateFromFormat(endDate),ganttProp,!0),ganttObj.dataOperation.calculateDuration(ganttData)):endDate&&duration||isUnscheduledTask&&-1!==fieldNames.indexOf(tasks.endDate)&&-1!==fieldNames.indexOf(tasks.duration)?(ganttObj.setRecordValue("endDate",ganttObj.dataOperation.getDateFromFormat(endDate),ganttProp,!0),ganttObj.dataOperation.updateDurationValue(duration,ganttProp)):(startDate&&duration||isUnscheduledTask&&-1!==fieldNames.indexOf(tasks.startDate)&&-1!==fieldNames.indexOf(tasks.duration))&&(ganttObj.setRecordValue("startDate",ganttObj.dataOperation.getDateFromFormat(startDate),ganttProp,!0),ganttObj.dataOperation.updateDurationValue(duration,ganttProp))}isTaskbarMoved(data){let isMoved=!1,taskData=data.ganttProperties,prevData=this.parent.previousRecords&&this.parent.previousRecords[data.uniqueID];if(prevData&&prevData.ganttProperties){let prevStart=getValue("ganttProperties.startDate",prevData),prevEnd=getValue("ganttProperties.endDate",prevData),prevDuration=getValue("ganttProperties.duration",prevData),prevDurationUnit=getValue("ganttProperties.durationUnit",prevData),keys=Object.keys(prevData.ganttProperties);-1===keys.indexOf("startDate")&&-1===keys.indexOf("endDate")&&-1===keys.indexOf("duration")&&-1===keys.indexOf("durationUnit")||(isNullOrUndefined(prevStart)&&!isNullOrUndefined(taskData.startDate)||isNullOrUndefined(prevEnd)&&!isNullOrUndefined(taskData.endDate)||isNullOrUndefined(taskData.startDate)&&!isNullOrUndefined(prevStart)||isNullOrUndefined(taskData.endDate)&&!isNullOrUndefined(prevEnd)||prevStart&&prevStart.getTime()!==taskData.startDate.getTime()||prevEnd&&prevEnd.getTime()!==taskData.endDate.getTime()||!isNullOrUndefined(prevDuration)&&prevDuration!==taskData.duration||!isNullOrUndefined(prevDuration)&&prevDuration===taskData.duration&&prevDurationUnit!==taskData.durationUnit)&&(isMoved=!0)}return isMoved}isPredecessorUpdated(data){let isPredecessorUpdated=!1,prevData=this.parent.previousRecords[data.uniqueID];return prevData&&prevData.ganttProperties&&prevData.ganttProperties.hasOwnProperty("predecessor")&&(data.ganttProperties.predecessorsName!==prevData.ganttProperties.predecessorsName?isPredecessorUpdated=!0:this.parent.setRecordValue("predecessor",prevData.ganttProperties.predecessor,data.ganttProperties,!0)),isPredecessorUpdated}isCheckPredecessor(data){let isValidatePredecessor=!1;return this.parent.previousRecords[data.uniqueID]&&this.parent.taskFields.dependency&&this.parent.isInPredecessorValidation&&this.parent.predecessorModule.getValidPredecessor(data).length>0&&this.isTaskbarMoved(data)&&(isValidatePredecessor=!0),isValidatePredecessor}initiateUpdateAction(args){let isValidatePredecessor=this.isCheckPredecessor(args.data);this.taskbarMoved=this.isTaskbarMoved(args.data),this.predecessorUpdated=this.isPredecessorUpdated(args.data),this.predecessorUpdated&&(this.parent.isConnectorLineUpdate=!0,this.parent.predecessorModule.addRemovePredecessor(args.data));let validateObject={};if(isValidatePredecessor)if(validateObject=this.parent.predecessorModule.validateTypes(args.data),this.parent.isConnectorLineUpdate=!0,isNullOrUndefined(getValue("violationType",validateObject)))this.updateEditedTask(args);else{let newArgs=this.validateTaskEvent(args);!1===newArgs.validateMode.preserveLinkWithEditing&&!1===newArgs.validateMode.removeLink&&!1===newArgs.validateMode.respectLink?this.parent.predecessorModule.openValidationDialog(validateObject):this.parent.predecessorModule.applyPredecessorOption()}else this.taskbarMoved&&(this.parent.isConnectorLineUpdate=!0),this.updateEditedTask(args)}validateTaskEvent(editedEventArgs){let newArgs={};return this.resetValidateArgs(),this.parent.currentEditedArgs=newArgs,newArgs.cancel=!1,newArgs.data=editedEventArgs.data,newArgs.requestType="validateLinkedTask",newArgs.validateMode=this.parent.dialogValidateMode,newArgs.editEventArgs=editedEventArgs,this.parent.actionBeginTask(newArgs),newArgs}resetValidateArgs(){this.parent.dialogValidateMode.preserveLinkWithEditing=!0,this.parent.dialogValidateMode.removeLink=!1,this.parent.dialogValidateMode.respectLink=!1}updateEditedTask(args){let ganttRecord=args.data;if(ganttRecord.parentItem&&this.parent.dataOperation.updateParentItems(ganttRecord.parentItem),this.updateParentChildRecord(ganttRecord),this.parent.isConnectorLineUpdate){for(let i=0;i<this.validatedChildItems.length;i++){let child=this.validatedChildItems[i];child.ganttProperties.predecessor&&child.ganttProperties.predecessor.length>0&&(this.parent.editedTaskBarItem=child,this.parent.predecessorModule.validatePredecessor(child,[],""))}ganttRecord.ganttProperties.predecessor&&(this.parent.isMileStoneEdited=ganttRecord.ganttProperties.isMilestone,this.taskbarMoved&&(this.parent.editedTaskBarItem=ganttRecord),this.parent.predecessorModule.validatePredecessor(ganttRecord,[],""))}this.initiateSaveAction(args)}updateParentChildRecord(data){data.hasChildRecords&&this.taskbarMoved&&this.updateChildItems(data)}calculateDateByRoundOffDuration(data,newStartDate){let ganttRecord=data,taskData=ganttRecord.ganttProperties,projectStartDate=new Date(newStartDate.getTime());if(!isNullOrUndefined(taskData.endDate)&&isNullOrUndefined(taskData.startDate)){let endDate=this.parent.dateValidationModule.checkStartDate(projectStartDate,taskData,null);this.parent.setRecordValue("endDate",this.parent.dateValidationModule.checkEndDate(endDate,ganttRecord.ganttProperties),taskData,!0)}else this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(projectStartDate,taskData),taskData,!0),isNullOrUndefined(taskData.duration)||this.parent.dateValidationModule.calculateEndDate(ganttRecord);this.parent.dataOperation.updateWidthLeft(data),this.parent.dataOperation.updateTaskData(ganttRecord)}updateParentProgress(cloneParent){let parentProgress=0,parent=this.parent.getParentTask(cloneParent),childRecords=parent.childRecords,childCount=childRecords?childRecords.length:0,totalProgress=0,milesStoneCount=0,taskCount=0,totalDuration=0,progressValues={};if(childRecords){for(let i=0;i<childCount;i++)childRecords[i].ganttProperties.isMilestone&&!childRecords[i].hasChildRecords||!isScheduledTask(childRecords[i].ganttProperties)?milesStoneCount+=1:(totalProgress+=getValue("totalProgress",progressValues=this.parent.dataOperation.getParentProgress(childRecords[i])),totalDuration+=getValue("totalDuration",progressValues));parentProgress=(taskCount=childCount-milesStoneCount)>0?Math.round(totalProgress/totalDuration):0,isNaN(parentProgress)&&(parentProgress=0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(parent.ganttProperties.width,parentProgress),parent.ganttProperties,!0),this.parent.setRecordValue("progress",Math.floor(parentProgress),parent.ganttProperties,!0),this.parent.setRecordValue("totalProgress",totalProgress,parent.ganttProperties,!0),this.parent.setRecordValue("totalDuration",totalDuration,parent.ganttProperties,!0)}this.parent.dataOperation.updateTaskData(parent),parent.parentItem&&this.updateParentProgress(parent.parentItem)}revertCellEdit(args){this.parent.editModule.reUpdatePreviousRecords(!1,!0),this.resetEditProperties()}reUpdatePreviousRecords(isRefreshChart,isRefreshGrid){let collection=this.parent.previousRecords,keys=Object.keys(collection);for(let i=0;i<keys.length;i++){let uniqueId=keys[i],prevTask=collection[uniqueId],originalData=this.parent.getTaskByUniqueID(uniqueId);this.copyTaskData(originalData.taskData,prevTask.taskData),delete prevTask.taskData,this.copyTaskData(originalData.ganttProperties,prevTask.ganttProperties),delete prevTask.ganttProperties,this.copyTaskData(originalData,prevTask);let rowIndex=this.parent.currentViewData.indexOf(originalData);isRefreshChart&&this.parent.chartRowsModule.refreshRow(rowIndex),isRefreshGrid&&(this.parent.treeGrid.grid.setRowData(originalData.ganttProperties.taskId,originalData),this.parent.treeGrid.grid.getRowObjectFromUID(this.parent.treeGrid.grid.getDataRows()[rowIndex].getAttribute("data-uid")).data=originalData)}}copyTaskData(existing,newValue){isNullOrUndefined(newValue)||extend(existing,newValue)}updateScheduleDatesOnEditing(args){}updateChildItems(ganttRecord){let previousStartDate,previousData=this.parent.previousRecords[ganttRecord.uniqueID];previousStartDate=isNullOrUndefined(previousData)||isNullOrUndefined(previousData)&&!isNullOrUndefined(previousData.ganttProperties)?new Date(ganttRecord.ganttProperties.startDate.getTime()):new Date(previousData.ganttProperties.startDate.getTime());let validStartDate,validEndDate,calcEndDate,isRightMove,durationDiff,currentStartDate=ganttRecord.ganttProperties.startDate,childRecords=[];if(this.getUpdatableChildRecords(ganttRecord,childRecords),0!==childRecords.length){previousStartDate.getTime()>currentStartDate.getTime()?(validStartDate=this.parent.dateValidationModule.checkStartDate(currentStartDate),validEndDate=this.parent.dateValidationModule.checkEndDate(previousStartDate,ganttRecord.ganttProperties),isRightMove=!1):(validStartDate=this.parent.dateValidationModule.checkStartDate(previousStartDate),validEndDate=this.parent.dateValidationModule.checkEndDate(currentStartDate,ganttRecord.ganttProperties),isRightMove=!0),durationDiff=validStartDate.getTime()>=validEndDate.getTime()?0:this.parent.dateValidationModule.getDuration(validStartDate,validEndDate,"minute",!0);for(let i=0;i<childRecords.length;i++)if(childRecords[i].ganttProperties.isAutoSchedule)if(durationDiff>0){let startDate=isScheduledTask(childRecords[i].ganttProperties)?childRecords[i].ganttProperties.startDate:childRecords[i].ganttProperties.startDate?childRecords[i].ganttProperties.startDate:childRecords[i].ganttProperties.endDate?childRecords[i].ganttProperties.endDate:new Date(previousStartDate.toString());calcEndDate=isRightMove?this.parent.dateValidationModule.getEndDate(this.parent.dateValidationModule.checkStartDate(startDate,childRecords[i].ganttProperties,childRecords[i].ganttProperties.isMilestone),durationDiff,"minute",childRecords[i].ganttProperties,!1):this.parent.dateValidationModule.getStartDate(this.parent.dateValidationModule.checkEndDate(startDate,childRecords[i].ganttProperties),durationDiff,"minute",childRecords[i].ganttProperties),this.calculateDateByRoundOffDuration(childRecords[i],calcEndDate),this.parent.isOnEdit&&-1===this.validatedChildItems.indexOf(childRecords[i])&&this.validatedChildItems.push(childRecords[i])}else isNullOrUndefined(previousData)&&(this.calculateDateByRoundOffDuration(childRecords[i],calcEndDate=previousStartDate),this.parent.isOnEdit&&-1===this.validatedChildItems.indexOf(childRecords[i])&&this.validatedChildItems.push(childRecords[i]))}}getUpdatableChildRecords(parentRecord,childLists){let childRecords=parentRecord.childRecords;for(let i=0;i<childRecords.length;i++)childRecords[i].ganttProperties.isAutoSchedule&&(childLists.push(childRecords[i]),childRecords[i].hasChildRecords&&this.getUpdatableChildRecords(childRecords[i],childLists))}initiateSaveAction(args){this.parent.showSpinner();let eventArgs={requestType:"beforeSave"};eventArgs.data=args.data,eventArgs.modifiedRecords=this.parent.editedRecords,eventArgs.modifiedTaskData=getTaskData(this.parent.editedRecords),this.parent.trigger("actionBegin",eventArgs),eventArgs.cancel?(this.reUpdatePreviousRecords(),this.parent.chartRowsModule.refreshRecords([args.data]),this.resetEditProperties()):ej2_gantt_es2015_isRemoteData(this.parent.dataSource)?this.parent.dataSource.saveChanges({changedRecords:eventArgs.modifiedTaskData},this.parent.taskFields.id,null,new ej2_data_es2015_Query).then(e=>this.dmSuccess(e,args)).catch(e=>this.dmFailure(e,args)):this.saveSuccess(args)}dmSuccess(e,args){this.saveSuccess(args)}dmFailure(e,args){if(this.deletedTaskDetails.length){let deleteRecords=this.deletedTaskDetails;for(let d=0;d<deleteRecords.length;d++)deleteRecords[d].isDelete=!1;this.deletedTaskDetails=[]}this.reUpdatePreviousRecords(!0,!0),this.resetEditProperties(),this.parent.trigger("actionFailure",{error:e})}saveSuccess(args){let eventArgs={};this.parent.timelineSettings.updateTimescaleView&&this.parent.timelineModule.updateTimeLineOnEditing(this.parent.editedRecords,args.action),this.parent.chartRowsModule.refreshRecords(this.parent.editedRecords),this.parent.isConnectorLineUpdate&&(this.parent.updatedConnectorLineCollection=[],this.parent.connectorLineIds=[],this.parent.connectorLineEditModule.refreshEditedRecordConnectorLine(this.parent.editedRecords),this.updateScheduleDatesOnEditing(args)),eventArgs.requestType="save",eventArgs.data=args.data,eventArgs.modifiedRecords=this.parent.editedRecords,eventArgs.modifiedTaskData=getTaskData(this.parent.editedRecords),setValue("action",args.action,eventArgs),this.endEditAction(args),this.parent.trigger("actionComplete",eventArgs)}resetEditProperties(){this.parent.currentEditedArgs={},this.resetValidateArgs(),this.parent.editedTaskBarItem=null,this.parent.isOnEdit=!1,this.validatedChildItems=[],this.parent.isConnectorLineUpdate=!1,this.parent.editedTaskBarItem=null,this.taskbarMoved=!1,this.predecessorUpdated=!1,isNullOrUndefined(this.dialogModule)||(this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose()),this.parent.hideSpinner(),this.parent.initiateEditAction(!1)}endEditAction(args){this.resetEditProperties(),"TaskbarEditing"===args.action?this.parent.trigger("taskbarEdited",args):"CellEditing"===args.action?this.parent.trigger("endEdit",args):"DialogEditing"===args.action&&(this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose())}saveFailed(args){this.reUpdatePreviousRecords(),this.parent.hideSpinner()}renderDeleteConfirmDialog(){let dialogObj=new ej2_popups_es2015_Dialog({width:"320px",isModal:!0,visible:!1,content:this.parent.localeObj.getConstant("confirmDelete"),buttons:[{click:this.confirmDeleteOkButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.closeConfirmDialog.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});dialogObj.appendTo("#"+this.parent.element.id+"_deleteConfirmDialog"),this.confirmDialog=dialogObj}closeConfirmDialog(){this.confirmDialog.hide()}confirmDeleteOkButton(){this.deleteSelectedItems(),this.confirmDialog.hide(),this.parent.element.querySelector(".e-treegrid").focus()}startDeleteAction(){this.parent.editSettings.allowDeleting&&(this.parent.editSettings.showDeleteConfirmDialog?this.confirmDialog.show():this.deleteSelectedItems())}deleteSelectedItems(){if(this.isFromDeleteMethod)this.targetedRecords.length&&this.deleteRow(this.targetedRecords),this.isFromDeleteMethod=!1;else{let selectedRecords=[];"Cell"!==this.parent.selectionSettings.mode?selectedRecords=this.parent.selectionModule.getSelectedRecords():"Cell"===this.parent.selectionSettings.mode&&(selectedRecords=this.parent.selectionModule.getCellSelectedRecords()),this.deleteRow(selectedRecords)}}deleteRecord(taskDetail){this.isFromDeleteMethod=!0;let variableType=typeof taskDetail;switch(this.targetedRecords=[],variableType){case"number":case"string":let taskId=taskDetail.toString();isNullOrUndefined(taskId)||-1===this.parent.ids.indexOf(taskId)||this.targetedRecords.push(this.parent.getRecordByID(taskId));break;case"object":Array.isArray(taskDetail)?this.updateTargetedRecords(taskDetail):this.targetedRecords.push(taskDetail.valueOf())}this.startDeleteAction()}updateTargetedRecords(taskDetailArray){if(taskDetailArray.length)if("object"==typeof taskDetailArray[0])this.targetedRecords=taskDetailArray;else for(let i=0;i<taskDetailArray.length;i++){let taskId=taskDetailArray[i].toString();isNullOrUndefined(taskId)||-1===this.parent.ids.indexOf(taskId)||this.targetedRecords.push(this.parent.getRecordByID(taskId))}}deleteRow(tasks){let rowItems=tasks&&tasks.length?tasks:this.parent.selectionModule.getSelectedRecords();if(rowItems.length){this.parent.isOnDelete=!0,rowItems.forEach(item=>{item.isDelete=!0});for(let i=0;i<rowItems.length;i++){let deleteRecord=rowItems[i];if(-1!==this.deletedTaskDetails.indexOf(deleteRecord))continue;if(deleteRecord.parentItem){let childRecord=this.parent.getParentTask(deleteRecord.parentItem).childRecords;(1===childRecord.length?childRecord:childRecord.filter(data=>!data.isDelete)).length>0&&this.parent.dataOperation.updateParentItems(deleteRecord.parentItem)}let predecessor=deleteRecord.ganttProperties.predecessor;predecessor&&predecessor.length&&this.removePredecessorOnDelete(deleteRecord),this.deletedTaskDetails.push(deleteRecord),deleteRecord.hasChildRecords&&this.deleteChildRecords(deleteRecord)}this.parent.selectionModule&&this.parent.allowSelection&&this.parent.selectionModule.clearSelection();let delereArgs={};delereArgs.deletedRecordCollection=this.deletedTaskDetails,delereArgs.updatedRecordCollection=this.parent.editedRecords,delereArgs.cancel=!1,delereArgs.action="delete",this.initiateDeleteAction(delereArgs),this.parent.isOnDelete=!1}isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()}removePredecessorOnDelete(record){let predecessors=record.ganttProperties.predecessor;for(let i=0;i<predecessors.length;i++){let predecessor=predecessors[i];if(predecessor.from.toString()===record.ganttProperties.taskId.toString()){let index,toRecord=this.parent.getRecordByID(predecessor.to.toString()),toRecordPredcessor=extend([],[],toRecord.ganttProperties.predecessor,!0);for(let t=0;t<toRecordPredcessor.length;t++)if(toRecordPredcessor[t].to.toString()===toRecord.ganttProperties.taskId.toString()&&toRecordPredcessor[t].from.toString()===record.ganttProperties.taskId.toString()){index=t;break}toRecordPredcessor.splice(index,1),this.updatePredecessorValues(toRecord,toRecordPredcessor)}else if(predecessor.to.toString()===record.ganttProperties.taskId.toString()){let index,fromRecord=this.parent.getRecordByID(predecessor.from.toString()),fromRecordPredcessor=extend([],[],fromRecord.ganttProperties.predecessor,!0);for(let t=0;t<fromRecordPredcessor.length;t++)if(fromRecordPredcessor[t].from.toString()===fromRecord.ganttProperties.taskId.toString()&&fromRecordPredcessor[t].to.toString()===record.ganttProperties.taskId.toString()){index=t;break}fromRecordPredcessor.splice(index,1),this.updatePredecessorValues(fromRecord,fromRecordPredcessor)}}}updatePredecessorValues(record,predcessorArray){this.parent.setRecordValue("predecessor",predcessorArray,record.ganttProperties,!0);let predecessorString=this.parent.predecessorModule.getPredecessorStringValue(record);this.parent.setRecordValue("predecessorsName",predecessorString,record.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,predecessorString,record),this.parent.setRecordValue(this.parent.taskFields.dependency,predecessorString,record)}deleteChildRecords(record){let childRecords=record.childRecords;for(let c=0;c<childRecords.length;c++){let childRecord=childRecords[c];if(-1!==this.deletedTaskDetails.indexOf(childRecord))continue;let predecessor=childRecord.ganttProperties.predecessor;predecessor&&predecessor.length&&this.removePredecessorOnDelete(childRecord),this.deletedTaskDetails.push(childRecord),childRecord.hasChildRecords&&this.deleteChildRecords(childRecord)}}removeFromDataSource(deleteRecordIDs){let dataSource;this.removeData(dataSource=this.parent.dataSource instanceof ej2_data_es2015_DataManager?this.parent.dataSource.dataSource.json:this.parent.dataSource,deleteRecordIDs),this.isBreakLoop=!1}removeData(dataCollection,record){for(let i=0;i<dataCollection.length&&!this.isBreakLoop;i++)if(-1!==record.indexOf(getValue(this.parent.taskFields.id,dataCollection[i]).toString())){if(dataCollection[i][this.parent.taskFields.child]&&this.removeData(dataCollection[i][this.parent.taskFields.child],record),record.splice(record.indexOf(getValue(this.parent.taskFields.id,dataCollection[i]).toString()),1),dataCollection.splice(i,1),0===record.length){this.isBreakLoop=!0;break}}else dataCollection[i][this.parent.taskFields.child]&&this.removeData(dataCollection[i][this.parent.taskFields.child],record)}initiateDeleteAction(args){this.parent.showSpinner();let eventArgs={requestType:"beforeDelete"};if(eventArgs.data=args.deletedRecordCollection,eventArgs.modifiedRecords=args.updatedRecordCollection,eventArgs.modifiedTaskData=getTaskData(args.updatedRecordCollection),this.parent.trigger("actionBegin",eventArgs),eventArgs.cancel){let deleteRecords=this.deletedTaskDetails;for(let d=0;d<deleteRecords.length;d++)deleteRecords[d].isDelete=!1;this.deletedTaskDetails=[],this.reUpdatePreviousRecords(),this.parent.initiateEditAction(!1),this.parent.hideSpinner()}else if(ej2_gantt_es2015_isRemoteData(this.parent.dataSource)){let data=this.parent.dataSource,updatedData={deletedRecords:getTaskData(eventArgs.data),changedRecords:eventArgs.modifiedTaskData};data.saveChanges(updatedData,this.parent.taskFields.id).then(e=>this.deleteSuccess(args)).catch(e=>this.dmFailure(e,args))}else this.deleteSuccess(args)}deleteSuccess(args){let flatData=this.parent.flatData,currentData=this.parent.currentViewData,deletedRecords=this.parent.getRecordFromFlatdata(args.deletedRecordCollection),deleteRecordIDs=[];for(let i=0;i<deletedRecords.length;i++){let childIndex,deleteRecord=deletedRecords[i],currentIndex=currentData.indexOf(deleteRecord),flatIndex=flatData.indexOf(deleteRecord),treeGridParentIndex=this.parent.treeGrid.parentData.indexOf(deleteRecord);if(-1!==currentIndex&&currentData.splice(currentIndex,1),-1!==flatIndex&&flatData.splice(flatIndex,1),deleteRecordIDs.push(deleteRecord.ganttProperties.taskId.toString()),-1!==flatIndex&&this.parent.ids.splice(flatIndex,1),0===deleteRecord.level&&-1!==treeGridParentIndex&&this.parent.treeGrid.parentData.splice(treeGridParentIndex,1),deleteRecord.parentItem){let parentItem=this.parent.getParentTask(deleteRecord.parentItem);if(parentItem){let childRecords=parentItem.childRecords;-1!==(childIndex=childRecords.indexOf(deleteRecord))&&childRecords.splice(childIndex,1),childRecords.length||(parentItem.hasChildRecords=!1)}}}deleteRecordIDs.length>0&&this.removeFromDataSource(deleteRecordIDs);let eventArgs={};this.parent.updatedConnectorLineCollection=[],this.parent.connectorLineIds=[],this.parent.predecessorModule.createConnectorLinesCollection(this.parent.flatData),this.parent.treeGrid.refresh(),eventArgs.requestType="delete",eventArgs.data=args.deletedRecordCollection,eventArgs.modifiedRecords=args.updatedRecordCollection,eventArgs.modifiedTaskData=getTaskData(args.updatedRecordCollection),setValue("action",args.action,eventArgs),this.parent.trigger("actionComplete",eventArgs),this.deletedTaskDetails=[],this.parent.initiateEditAction(!1),this.parent.hideSpinner()}getNewTaskId(){let maxId=ej2_data_es2015_DataUtil.aggregates.max(this.parent.flatData,this.parent.taskFields.id);return isNullOrUndefined(maxId)?1:parseInt(maxId.toString(),10)+1}prepareNewlyAddedData(obj,rowPosition){let id,taskModel=this.parent.taskFields;if(obj[taskModel.id]&&(obj[taskModel.id]=-1!==this.parent.ids.indexOf(obj[taskModel.id].toString())?null:isNullOrUndefined(obj[taskModel.id])?null:parseInt(obj[taskModel.id],10)),obj[taskModel.id]||(id=this.getNewTaskId(),obj[taskModel.id]=id),taskModel.name&&!obj[taskModel.name]&&(obj[taskModel.name]="New Task "+obj[taskModel.id]),this.parent.allowUnscheduledTasks||obj[taskModel.startDate]||(obj[taskModel.startDate]=this.parent.projectStartDate),!this.parent.allowUnscheduledTasks&&taskModel.duration&&isNullOrUndefined(obj[taskModel.duration])&&(obj[taskModel.endDate]||(obj[taskModel.duration]="5")),taskModel.progress&&(obj[taskModel.progress]=obj[taskModel.progress]?obj[taskModel.progress]>100?100:obj[taskModel.progress]:0),!this.parent.allowUnscheduledTasks&&!obj[taskModel.endDate]&&taskModel.endDate&&!obj[taskModel.duration]){let startDate=this.parent.dataOperation.getDateFromFormat(this.parent.projectStartDate);startDate.setDate(startDate.getDate()+4),obj[taskModel.endDate]=this.parent.getFormatedDate(startDate,this.parent.dateFormat)}}updateNewlyAddedDataBeforeAjax(obj,level,rowPosition,parentItem){let cAddedRecord;return(cAddedRecord=this.parent.dataOperation.createRecord(obj,level)).index=parseInt(cAddedRecord.ganttProperties.taskId.toString(),10)-1,isNullOrUndefined(parentItem)||(this.parent.setRecordValue("parentItem",this.parent.dataOperation.getCloneParent(parentItem),cAddedRecord),this.parent.setRecordValue("parentIndex",cAddedRecord.parentItem?cAddedRecord.parentItem.index:null,cAddedRecord),this.parent.setRecordValue("parentUniqueID",cAddedRecord.parentItem?cAddedRecord.parentItem.uniqueID:null,cAddedRecord),isNullOrUndefined(this.parent.taskFields.id)||isNullOrUndefined(this.parent.taskFields.parentID)||!cAddedRecord.parentItem||this.parent.setRecordValue(this.parent.taskFields.parentID,cAddedRecord.parentItem.taskId,cAddedRecord.taskData,!0)),this.backUpAndPushNewlyAddedRecord(cAddedRecord,rowPosition,parentItem),this.parent.isOnEdit=!0,this.parent.taskFields.dependency&&cAddedRecord.ganttProperties.predecessorsName?(this.parent.predecessorModule.ensurePredecessorCollectionHelper(cAddedRecord,cAddedRecord.ganttProperties),this.parent.predecessorModule.updatePredecessorHelper(cAddedRecord),this.parent.predecessorModule.validatePredecessorDates(cAddedRecord)):cAddedRecord.parentItem&&this.parent.getParentTask(cAddedRecord.parentItem).ganttProperties.isAutoSchedule&&this.parent.dataOperation.updateParentItems(cAddedRecord.parentItem),cAddedRecord}getChildCount(record,count){let currentRecord;if(!record.hasChildRecords)return 0;for(let i=0;i<record.childRecords.length;i++)count++,(currentRecord=record.childRecords[i]).hasChildRecords&&(count=this.getChildCount(currentRecord,count));return count}getVisibleChildRecordCount(data,count,collection){let childRecords,length;if(data.hasChildRecords){length=(childRecords=data.childRecords).length;for(let i=0;i<length;i++)-1!==collection.indexOf(childRecords[i])&&count++,childRecords[i].hasChildRecords&&(count=this.getVisibleChildRecordCount(childRecords[i],count,collection))}else-1!==collection.indexOf(data)&&count++;return count}updatePredecessorOnIndentOutdent(parentRecord){let childRecord,predecessorIndex,len=parentRecord.ganttProperties.predecessor.length,parentRecordTaskData=parentRecord.ganttProperties,predecessorCollection=parentRecordTaskData.predecessor;for(let count=0;count<len;count++)if(predecessorCollection[count].to===parentRecordTaskData.taskId.toString()){let predecessorCollections;childRecord=this.parent.getRecordByID(predecessorCollection[count].from),predecessorIndex=ej2_gantt_es2015_getIndex(predecessorCollection[count],"from",childRecord.ganttProperties.predecessor,"to"),(predecessorCollections=extend([],childRecord.ganttProperties.predecessor,[],!0)).splice(predecessorIndex,1),this.parent.setRecordValue("predecessor",predecessorCollections,childRecord.ganttProperties,!0)}else if(predecessorCollection[count].from===parentRecordTaskData.taskId.toString()){childRecord=this.parent.getRecordByID(predecessorCollection[count].to),this.predecessorToString(childRecord.ganttProperties.predecessor,parentRecord);let temppredecessorCollection,prdcList=childRecord.ganttProperties.predecessorsName.toString().split(","),ind=prdcList.indexOf(predecessorCollection[count].from+predecessorCollection[count].type);prdcList.splice(ind,1),this.parent.setRecordValue("predecessorsName",prdcList.join(","),childRecord.ganttProperties,!0),predecessorIndex=ej2_gantt_es2015_getIndex(predecessorCollection[count],"from",childRecord.ganttProperties.predecessor,"to"),(temppredecessorCollection=extend([],childRecord.ganttProperties.predecessor,[],!0)).splice(predecessorIndex,1),this.parent.setRecordValue("predecessor",temppredecessorCollection,childRecord.ganttProperties,!0),this.parent.predecessorModule.validatePredecessorDates(childRecord)}this.parent.setRecordValue("predecessor",[],parentRecord.ganttProperties,!0),this.parent.setRecordValue("predecessorsName","",parentRecord.ganttProperties,!0)}predecessorToString(predecessorCollection,record){let predecessorString=[],count=0,length=predecessorCollection.length;for(;count<length;count++)if(record.ganttProperties.taskId.toString()!==predecessorCollection[count].from){let tem=predecessorCollection[count].from+predecessorCollection[count].type;predecessorCollection[count].offset=isNaN(predecessorCollection[count].offset)?0:predecessorCollection[count].offset,0!==predecessorCollection[count].offset&&(predecessorCollection[count].offset<0?tem+=predecessorCollection[count].offset.toString()+"d":predecessorCollection[count].offset>0&&(tem+="+"+predecessorCollection[count].offset.toString()+"d")),predecessorString.push(tem)}return predecessorString.join(",")}backUpAndPushNewlyAddedRecord(record,rowPosition,parentItem){let currentItemIndex,recordIndex,updatedCollectionIndex,flatRecords=this.parent.flatData,currentViewData=this.parent.currentViewData,ids=this.parent.ids;switch(rowPosition){case"Top":flatRecords.splice(0,0,record),currentViewData.splice(0,0,record),ids.splice(0,0,record.ganttProperties.taskId.toString());break;case"Bottom":flatRecords.push(record),currentViewData.push(record),ids.push(record.ganttProperties.taskId.toString());break;case"Above":recordIndex=flatRecords.indexOf(this.addRowSelectedItem),updatedCollectionIndex=currentViewData.indexOf(this.addRowSelectedItem),this.recordCollectionUpdate(void 0,recordIndex,updatedCollectionIndex,record,parentItem);break;case"Below":currentItemIndex=flatRecords.indexOf(this.addRowSelectedItem),this.addRowSelectedItem.hasChildRecords?(recordIndex=currentItemIndex+this.getChildCount(this.addRowSelectedItem,0)+1,updatedCollectionIndex=currentViewData.indexOf(this.addRowSelectedItem)+this.getVisibleChildRecordCount(this.addRowSelectedItem,0,currentViewData)+1):(recordIndex=currentItemIndex+1,updatedCollectionIndex=currentViewData.indexOf(this.addRowSelectedItem)+1),this.recordCollectionUpdate(NaN,recordIndex,updatedCollectionIndex,record,parentItem);break;case"Child":currentItemIndex=flatRecords.indexOf(this.addRowSelectedItem),this.addRowSelectedItem.hasChildRecords?(recordIndex=currentItemIndex+this.getChildCount(this.addRowSelectedItem,0)+1,this.addRowSelectedItem.expanded||this.parent.expandByID(Number(this.addRowSelectedItem.ganttProperties.taskId)),updatedCollectionIndex=currentViewData.indexOf(this.addRowSelectedItem)+this.getVisibleChildRecordCount(this.addRowSelectedItem,0,currentViewData)+1):(this.addRowSelectedItem.hasChildRecords=!0,this.addRowSelectedItem.childRecords=[],this.addRowSelectedItem.expanded=!0,this.addRowSelectedItem.ganttProperties.isMilestone=!1,recordIndex=currentItemIndex+1,updatedCollectionIndex=currentViewData.indexOf(this.addRowSelectedItem)+1,this.addRowSelectedItem.ganttProperties.predecessor&&this.updatePredecessorOnIndentOutdent(this.addRowSelectedItem)),this.recordCollectionUpdate(NaN,recordIndex,updatedCollectionIndex,record,parentItem)}this.newlyAddedRecordBackup=record}recordCollectionUpdate(childIndex,recordIndex,updatedCollectionIndex,record,parentItem){let currentViewData=this.parent.currentViewData,ids=this.parent.ids;this.parent.flatData.splice(recordIndex,0,record),currentViewData.splice(updatedCollectionIndex,0,record),ids.splice(recordIndex,0,record.ganttProperties.taskId.toString()),isNullOrUndefined(parentItem)||(childIndex=parentItem.childRecords.indexOf(this.addRowSelectedItem),parentItem.childRecords.splice(childIndex,0,record))}constructTaskAddedEventArgs(cAddedRecord,modifiedRecords,event){let eventArgs={};return eventArgs.action=event,eventArgs.data=cAddedRecord,eventArgs.newTaskData=getTaskData([cAddedRecord])[0],eventArgs.recordIndex=cAddedRecord.index,eventArgs.modifiedRecords=modifiedRecords,eventArgs.modifiedTaskData=getTaskData(modifiedRecords),eventArgs}addSuccess(args){this.parent.treeGrid.refresh()}updateRealDataSource(addedRecord,rowPosition){let dataSource,taskFields=this.parent.taskFields;dataSource=this.parent.dataSource instanceof ej2_data_es2015_DataManager?this.parent.dataSource.dataSource.json:this.parent.dataSource,"Top"===rowPosition?dataSource.splice(0,0,addedRecord.taskData):"Bottom"===rowPosition?dataSource.push(addedRecord):isNullOrUndefined(taskFields.id)||isNullOrUndefined(taskFields.parentID)?this.addDataInRealDataSource(dataSource,addedRecord.taskData,rowPosition):dataSource.push(addedRecord.taskData),this.isBreakLoop=!1}addDataInRealDataSource(dataCollection,record,rowPosition){for(let i=0;i<dataCollection.length&&!this.isBreakLoop;i++){if(getValue(this.parent.taskFields.id,dataCollection[i]).toString()===this.addRowSelectedItem.ganttProperties.taskId.toString()){"Above"===rowPosition?dataCollection.splice(i,0,record):"Below"===rowPosition?dataCollection.splice(i+1,0,record):"Child"===rowPosition&&(dataCollection[i].subtasks&&dataCollection[i].subtasks.length>0?dataCollection[i].subtasks.push(record):(dataCollection[i].subtasks=[],dataCollection[i].subtasks.push(record))),this.isBreakLoop=!0;break}dataCollection[i][this.parent.taskFields.child]&&this.addDataInRealDataSource(dataCollection[i][this.parent.taskFields.child],record,rowPosition)}}addRecord(data,rowPosition,rowIndex){let selectedRowIndex=isNullOrUndefined(rowIndex)||isNaN(parseInt(rowIndex.toString(),10))?this.parent.selectionModule?"Row"!==this.parent.selectionSettings.mode&&"Both"!==this.parent.selectionSettings.mode||1!==this.parent.selectionModule.selectedRowIndexes.length?"Cell"===this.parent.selectionSettings.mode&&1===this.parent.selectionModule.getSelectedRowCellIndexes().length?this.parent.selectionModule.getSelectedRowCellIndexes()[0].rowIndex:null:this.parent.selectionModule.selectedRowIndexes[0]:null:rowIndex;this.addRowSelectedItem=isNullOrUndefined(selectedRowIndex)?null:this.parent.currentViewData[selectedRowIndex],rowPosition=isNullOrUndefined(rowPosition)?this.parent.editSettings.newRowPosition:rowPosition,data=isNullOrUndefined(data)?this.parent.editModule.dialogModule.composeAddRecord():data,((isNullOrUndefined(selectedRowIndex)||selectedRowIndex<0||isNullOrUndefined(this.addRowSelectedItem))&&("Above"===rowPosition||"Below"===rowPosition||"Child"===rowPosition)||!rowPosition||"Above"!==rowPosition&&"Below"!==rowPosition&&"Child"!==rowPosition&&"Top"!==rowPosition&&"Bottom"!==rowPosition)&&(rowPosition="Top");let cAddedRecord,parentItem,level=0,args={};switch(rowPosition){case"Top":case"Bottom":level=0;break;case"Above":case"Below":level=this.addRowSelectedItem.level,parentItem=this.parent.getParentTask(this.addRowSelectedItem.parentItem);break;case"Child":level=this.addRowSelectedItem.level+1,parentItem=this.addRowSelectedItem}this.prepareNewlyAddedData(data,rowPosition),cAddedRecord=this.updateNewlyAddedDataBeforeAjax(data,level,rowPosition,parentItem),args=this.constructTaskAddedEventArgs(cAddedRecord,this.parent.editedRecords,"beforeAdd"),this.parent.showSpinner(),this.parent.trigger("actionBegin",args),args.cancel?(this.removeAddedRecord(),this.reUpdatePreviousRecords(),this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose()):ej2_gantt_es2015_isRemoteData(this.parent.dataSource)?this.parent.dataSource.saveChanges({addedRecords:[args.newTaskData],changedRecords:args.modifiedTaskData},this.parent.taskFields.id,null,new ej2_data_es2015_Query).then(e=>{this.parent.taskFields.id&&!isNullOrUndefined(e.addedRecords[0][this.parent.taskFields.id])&&e.addedRecords[0][this.parent.taskFields.id]!==args.data.ganttProperties.taskId&&(this.parent.setRecordValue("taskId",e.addedRecords[0][this.parent.taskFields.id],args.data.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.id,e.addedRecords[0][this.parent.taskFields.id],args.data),this.parent.setRecordValue(this.parent.taskFields.id,e.addedRecords[0][this.parent.taskFields.id],args.data)),0===cAddedRecord.level&&this.parent.treeGrid.parentData.splice(0,0,cAddedRecord),this.RefreshNewlyAddedRecord(args,cAddedRecord)}).catch(e=>{this.removeAddedRecord(),this.dmFailure(e,args)}):(this.updateRealDataSource(args.data,rowPosition),0===cAddedRecord.level&&this.parent.treeGrid.parentData.splice(0,0,cAddedRecord),this.RefreshNewlyAddedRecord(args,cAddedRecord)),this.parent.isOnEdit=!1,this.parent.hideSpinner(),this.addRowSelectedItem=null,this.newlyAddedRecordBackup=null,this.isBreakLoop=!1,this.parent.element.tabIndex=0,this.parent.initiateEditAction(!1)}RefreshNewlyAddedRecord(args,cAddedRecord){if(this.parent.selectionModule&&this.parent.allowSelection&&("Row"===this.parent.selectionSettings.mode||"Both"===this.parent.selectionSettings.mode)&&(this.parent.staticSelectedRowIndex=this.parent.currentViewData.indexOf(args.data)),this.parent.timelineSettings.updateTimescaleView){let tempArray=[];args.modifiedRecords.length>0?(tempArray.push(args.data),tempArray.push.apply(tempArray,args.modifiedRecords)):tempArray=[args.data],this.parent.timelineModule.updateTimeLineOnEditing(tempArray,args.action)}this.addSuccess(args),args=this.constructTaskAddedEventArgs(cAddedRecord,args.modifiedRecords,"add"),this.parent.trigger("actionComplete",args),this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose()}removeAddedRecord(){let flatRecords=this.parent.flatData,currentViewData=this.parent.currentViewData,ids=this.parent.ids,flatRecordsIndex=flatRecords.indexOf(this.newlyAddedRecordBackup),currentViewDataIndex=currentViewData.indexOf(this.newlyAddedRecordBackup),idsIndex=ids.indexOf(this.newlyAddedRecordBackup.ganttProperties.taskId.toString());if(deleteObject(this.parent.previousRecords,flatRecords[flatRecordsIndex].uniqueID),this.newlyAddedRecordBackup.parentItem){let parentItem=this.parent.getParentTask(this.newlyAddedRecordBackup.parentItem),parentIndex=parentItem.childRecords.indexOf(this.newlyAddedRecordBackup);parentItem.childRecords.splice(parentIndex,1)}flatRecords.splice(flatRecordsIndex,1),currentViewData.splice(currentViewDataIndex,1),ids.splice(idsIndex,1)}}class ej2_gantt_es2015_Reorder$1{constructor(gantt){this.parent=gantt,ej2_treegrid_es2015_TreeGrid.Inject(ej2_treegrid_es2015_Reorder$1),this.parent.treeGrid.allowReordering=this.parent.allowReordering,this.bindEvents()}getModuleName(){return"reorder"}bindEvents(){this.parent.treeGrid.columnDragStart=args=>{this.parent.trigger("columnDragStart",args)},this.parent.treeGrid.columnDrag=args=>{this.parent.trigger("columnDrag",args)},this.parent.treeGrid.columnDrop=args=>{this.parent.trigger("columnDrop",args)}}destroy(){}}class ej2_gantt_es2015_Resize$1{constructor(gantt){this.parent=gantt,ej2_treegrid_es2015_TreeGrid.Inject(ej2_treegrid_es2015_Resize$1),this.parent.treeGrid.allowResizing=this.parent.allowResizing,this.bindEvents()}getModuleName(){return"resize"}bindEvents(){this.parent.treeGrid.resizeStart=args=>{this.parent.trigger("resizeStart",args)},this.parent.treeGrid.resizing=args=>{this.parent.trigger("resizing",args)},this.parent.treeGrid.resizeStop=args=>{this.parent.trigger("resizeStop",args)}}destroy(){}}class ej2_gantt_es2015_Filter$2{constructor(gantt){this.parent=gantt,ej2_treegrid_es2015_TreeGrid.Inject(ej2_treegrid_es2015_Filter$1),this.parent.treeGrid.allowFiltering=this.parent.allowFiltering||-1!==this.parent.toolbar.indexOf("Search"),this.parent.treeGrid.filterSettings=getActualProperties(this.parent.filterSettings),this.addEventListener()}getModuleName(){return"filter"}updateModel(){this.parent.filterSettings=this.parent.treeGrid.filterSettings}addEventListener(){this.parent.on("updateModel",this.updateModel,this),this.parent.on("actionBegin",this.actionBegin,this),this.parent.on("actionComplete",this.actionComplete,this),this.parent.on("columnMenuOpen",this.columnMenuOpen,this)}columnMenuOpen(args){this.filterMenuElement&&this.parent.element.contains(this.filterMenuElement)&&ej2_base_es2015_remove(this.filterMenuElement),this.filterMenuElement=null}actionBegin(args){}actionComplete(args){if(args.requestType===filterAfterOpen){this.filterMenuElement=getValue("filterModel.dlgObj.element",args),this.updateFilterMenuPosition(this.filterMenuElement,args);let taskID=this.parent.taskFields.id,predecessor=this.parent.taskFields.dependency,resource=this.parent.taskFields.resourceInfo,filterValues=getValue("values",this.parent.treeGrid.grid.filterModule);if(args.columnName===predecessor&&isNullOrUndefined(getValue(predecessor,filterValues))||args.columnName===resource&&isNullOrUndefined(getValue(resource,filterValues))){let instanceObj=getValue("ej2_instances[0]",this.filterMenuElement.querySelector(".e-dropdownlist"));instanceObj.index=2,instanceObj.dataBind()}else if(args.columnName===taskID&&isNullOrUndefined(getValue(taskID,filterValues))){let instanceObj=getValue("ej2_instances[0]",this.filterMenuElement.querySelector(".e-numerictextbox"));!isNullOrUndefined(instanceObj)&&isNullOrUndefined(this.parent.columnByField[args.columnName].format)&&(instanceObj.format="n")}}}setPosition(li,ul){let gridPos=this.parent.element.getBoundingClientRect(),liPos=li.getBoundingClientRect(),left=liPos.left-gridPos.left,top=liPos.top-gridPos.top;gridPos.height<top?top=top-ul.offsetHeight+liPos.height:gridPos.height<top+ul.offsetHeight&&(top=gridPos.height-ul.offsetHeight),window.innerHeight<ul.offsetHeight+top+gridPos.top&&(top=window.innerHeight-ul.offsetHeight-gridPos.top),gridPos.width<=(left+=this.parent.enableRtl?-ul.offsetWidth:liPos.width)+ul.offsetWidth?left-=liPos.width+ul.offsetWidth:left<0&&(left+=ul.offsetWidth+liPos.width),ul.style.top=top+7+"px",ul.style.left=left+7+"px"}updateFilterMenuPosition(element,args){let targetElement;this.parent.element.appendChild(element),this.parent.showColumnMenu?(targetElement=document.querySelector("#treeGrid"+this.parent.controlId+"_gridcontrol_colmenu_Filter"),this.setPosition(targetElement,getValue("filterModel.dlgObj.element",args))):getFilterMenuPostion(targetElement=this.parent.treeGrid.grid.getColumnHeaderByField(args.columnName).querySelector(".e-filtermenudiv"),getValue("filterModel.dlgObj",args),this.parent.treeGrid.grid)}removeEventListener(){this.parent.isDestroyed||(this.parent.off("updateModel",this.updateModel),this.parent.off("actionBegin",this.actionBegin),this.parent.off("actionComplete",this.actionComplete),this.parent.off("columnMenuOpen",this.columnMenuOpen))}destroy(){this.removeEventListener()}}class ej2_gantt_es2015_Sort$1{constructor(gantt){this.parent=gantt,ej2_treegrid_es2015_TreeGrid.Inject(ej2_treegrid_es2015_Sort$1),this.parent.treeGrid.allowSorting=this.parent.allowSorting,this.parent.treeGrid.sortSettings=getActualProperties(this.parent.sortSettings),this.addEventListener()}getModuleName(){return"sort"}addEventListener(){this.parent.on("updateModel",this.updateModel,this)}removeEventListener(){this.parent.isDestroyed||this.parent.off("updateModel",this.updateModel)}destroy(){this.removeEventListener()}sortColumn(columnName,direction,isMultiSort){this.parent.treeGrid.sortByColumn(columnName,direction,isMultiSort)}clearSorting(){this.parent.treeGrid.clearSorting()}updateModel(){this.parent.sortSettings=this.parent.treeGrid.sortSettings}removeSortColumn(columnName){this.parent.treeGrid.grid.removeSortColumn(columnName)}}class ej2_gantt_es2015_Selection$1{constructor(gantt){this.isSelectionFromChart=!1,this.selectedRowIndexes=[],this.enableSelectMultiTouch=!1,this.openPopup=!1,this.parent=gantt,this.bindEvents(),this.parent.treeGrid.selectedRowIndex=this.parent.selectedRowIndex,this.parent.treeGrid.allowSelection=this.parent.allowSelection,this.parent.treeGrid.selectionSettings=getActualProperties(this.parent.selectionSettings),this.wireEvents()}getModuleName(){return"selection"}wireEvents(){this.parent.on("selectRowByIndex",this.selectRowByIndex,this),this.parent.isAdaptive?(this.parent.on("chartMouseClick",this.mouseUpHandler,this),this.parent.on("treeGridClick",this.popUpClickHandler,this)):this.parent.on("chartMouseUp",this.mouseUpHandler,this)}selectRowByIndex(){-1===this.parent.selectedRowIndex&&-1===this.parent.staticSelectedRowIndex||(this.selectRow(-1!==this.parent.staticSelectedRowIndex?this.parent.staticSelectedRowIndex:this.parent.selectedRowIndex),this.parent.staticSelectedRowIndex=-1)}bindEvents(){this.parent.treeGrid.rowSelecting=this.rowSelecting.bind(this),this.parent.treeGrid.rowSelected=this.rowSelected.bind(this),this.parent.treeGrid.rowDeselecting=this.rowDeselecting.bind(this),this.parent.treeGrid.rowDeselected=this.rowDeselected.bind(this),this.parent.treeGrid.cellSelecting=this.cellSelecting.bind(this),this.parent.treeGrid.cellSelected=this.cellSelected.bind(this),this.parent.treeGrid.cellDeselecting=this.cellDeselecting.bind(this),this.parent.treeGrid.cellDeselected=this.cellDeselected.bind(this)}rowSelecting(args){args.isCtrlPressed=this.isMultiCtrlRequest,args.isShiftPressed=this.isMultiShiftRequest,args.target=this.actualTarget,isNullOrUndefined(args.foreignKeyData)||0!==Object.keys(args.foreignKeyData).length||delete args.foreignKeyData,this.parent.trigger("rowSelecting",args)}rowSelected(args){let index="Multiple"!==this.parent.selectionSettings.type||isNullOrUndefined(args.rowIndexes)?[args.rowIndex]:args.rowIndexes;this.addClass(index),this.selectedRowIndexes=extend([],this.getSelectedRowIndexes(),[],!0),this.parent.setProperties({selectedRowIndex:this.parent.treeGrid.selectedRowIndex},!0),this.isMultiShiftRequest&&(this.selectedRowIndexes=index),this.parent.autoFocusTasks&&this.parent.ganttChartModule.updateScrollLeft(getValue("data.ganttProperties.left",args)),args.target=this.actualTarget,isNullOrUndefined(args.foreignKeyData)||0!==Object.keys(args.foreignKeyData).length||delete args.foreignKeyData,this.prevRowIndex=args.rowIndex,isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),this.parent.trigger("rowSelected",args)}rowDeselecting(args){args.target=this.actualTarget,args.isInteracted=this.isInteracted,this.parent.trigger("rowDeselecting",args)}rowDeselected(args){this.removeClass(args.rowIndexes||args.rowIndex),this.selectedRowIndexes=extend([],this.getSelectedRowIndexes(),[],!0),this.parent.setProperties({selectedRowIndex:-1},!0),isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),args.target=this.actualTarget,args.isInteracted=this.isInteracted,this.parent.trigger("rowDeselected",args),this.isInteracted=!1}cellSelecting(args){let callBackPromise=new Deferred;return this.parent.trigger("cellSelecting",args,cellselectingArgs=>{callBackPromise.resolve(cellselectingArgs)}),callBackPromise}cellSelected(args){this.parent.trigger("cellSelected",args),isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()}cellDeselecting(args){this.parent.trigger("cellDeselecting",args)}cellDeselected(args){this.parent.trigger("cellDeselected",args),isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()}selectCell(cellIndex,isToggle){this.parent.treeGrid.selectCell(cellIndex,isToggle)}selectRow(index,isToggle){let selectedRow=this.parent.getRowByIndex(index);-1===index||isNullOrUndefined(selectedRow)||"Cell"===this.parent.selectionSettings.mode||(this.parent.treeGrid.selectRow(index,isToggle),this.prevRowIndex=index)}selectRows(records){!isNullOrUndefined(records)&&records.length>0&&this.parent.treeGrid.selectRows(records)}getSelectedRowIndexes(){return this.parent.treeGrid.getSelectedRowIndexes()}getSelectedRowCellIndexes(){return this.parent.treeGrid.getSelectedRowCellIndexes()}getSelectedRecords(){return isBlazor()?this.parent.getRecordFromFlatdata(this.parent.treeGrid.getSelectedRecords()):this.parent.treeGrid.getSelectedRecords()}getCellSelectedRecords(){let cellDetails=this.parent.selectionModule.getSelectedRowCellIndexes(),cellSelectedRecords=[];for(let i=0;i<cellDetails.length;i++)cellSelectedRecords.push(this.parent.currentViewData[cellDetails[i].rowIndex]);return isBlazor()?this.parent.getRecordFromFlatdata(cellSelectedRecords):cellSelectedRecords}getSelectedRows(){return this.parent.treeGrid.getSelectedRows()}clearSelection(){this.removeClass(this.selectedRowIndexes),this.parent.treeGrid.clearSelection(),this.parent.selectedRowIndex=-1,this.selectedRowIndexes=[],isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),this.isInteracted=!1}highlightSelectedRows(e,fromChart){let rows=closest(e.target,"tbody").children,selectedRow=closest(e.target,"tr.e-chart-row"),rIndex=[].slice.call(rows).indexOf(selectedRow);this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch,this.isMultiShiftRequest=e.shiftKey,this.actualTarget=e.target,this.isInteracted=!0,this.isSelectionFromChart=fromChart,fromChart&&("Single"===this.parent.selectionSettings.type||!this.isMultiCtrlRequest&&!this.isMultiShiftRequest?this.selectRow(rIndex,!0):this.isMultiShiftRequest?this.selectRowsByRange(isNullOrUndefined(this.prevRowIndex)?rIndex:this.prevRowIndex,rIndex):this.parent.treeGrid.grid.selectionModule.addRowsToSelection([rIndex]))}getselectedrowsIndex(startIndex,endIndex){let indexes=[],{i:i,max:max}=startIndex<endIndex?{i:startIndex,max:endIndex}:{i:endIndex,max:startIndex};for(;i<=max;i++)indexes.push(i);startIndex>endIndex&&indexes.reverse(),this.selectedRowIndexes=indexes}selectRowsByRange(startIndex,endIndex){this.isSelectionFromChart=!0,this.getselectedrowsIndex(startIndex,endIndex),this.selectRows(this.selectedRowIndexes)}addClass(records){let ganttRow=document.getElementById(this.parent.element.id+"GanttTaskTableBody").children;for(let i=0;i<records.length;i++)isNullOrUndefined(ganttRow[records[i]])||(addClass([ganttRow[records[i]]],"e-active"),ganttRow[records[i]].setAttribute("aria-selected","true"))}removeClass(records){if(!this.parent.selectionSettings.persistSelection){let ganttRow=document.getElementById(this.parent.element.id+"GanttTaskTableBody").children,rowIndex=isBlazor()&&isNullOrUndefined(records.length)?[records]:records;for(let i=0;i<rowIndex.length;i++)removeClass([ganttRow[rowIndex[i]]],"e-active"),ganttRow[rowIndex[i]].removeAttribute("aria-selected")}}showPopup(e){this.isSelectionFromChart?(setCssInGridPopUp(this.parent.element.querySelector(".e-ganttpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(this.enableSelectMultiTouch&&(this.getSelectedRecords().length>1||this.getSelectedRowCellIndexes().length>1)?" e-spanclicked":"")),document.getElementsByClassName("e-gridpopup")[0].style.display="none",this.openPopup=!0):this.hidePopUp()}hidePopUp(){this.openPopup&&(document.getElementsByClassName("e-ganttpopup")[0].style.display="none",this.openPopup=!1)}popUpClickHandler(e){let target=e.target,grid=this.parent.treeGrid.grid,$popUpElemet=closest(target,".e-ganttpopup")?closest(target,".e-ganttpopup"):closest(target,".e-gridpopup");if($popUpElemet){let spanElement=$popUpElemet.querySelector(".e-rowselect");closest(target,".e-ganttpopup")&&!spanElement.classList.contains("e-spanclicked")?(this.enableSelectMultiTouch=!0,spanElement.classList.add("e-spanclicked")):closest(target,".e-gridpopup")&&spanElement.classList.contains("e-spanclicked")?(this.openPopup=!0,this.enableSelectMultiTouch=!0):(this.hidePopUp(),this.enableSelectMultiTouch=!1,closest(target,".e-ganttpopup")&&spanElement.classList.remove("e-spanclicked"))}else this.hidePopUp();grid&&setValue("enableSelectMultiTouch",this.enableSelectMultiTouch,grid.selectionModule)}mouseUpHandler(e){let isTaskbarEdited=!1;if(this.parent.editModule&&this.parent.editSettings.allowTaskbarEditing){let taskbarEdit=this.parent.editModule.taskbarEditModule;(taskbarEdit.isMouseDragged||taskbarEdit.tapPointOnFocus)&&(isTaskbarEdited=!0)}if(!isTaskbarEdited&&this.parent.element.contains(e.target)){let parent=parentsUntil(e.target,"e-chart-row"),isSelected=e.target.classList.contains("e-rowcell")||e.target.classList.contains("e-row")||e.target.classList.contains("e-treegridexpand")||e.target.classList.contains("e-treegridcollapse")||!isNullOrUndefined(parent);this.popUpClickHandler(e),"Cell"!==this.parent.selectionSettings.mode&&isSelected?(closest(e.target,"tr.e-chart-row")?this.highlightSelectedRows(e,!0):this.highlightSelectedRows(e,!1),"Multiple"===this.parent.selectionSettings.type&&Browser.isDevice&&this.showPopup(e)):this.isSelectionFromChart=!1}}destroy(){this.parent.isDestroyed||(this.parent.off("selectRowByIndex",this.selectRowByIndex),this.parent.isAdaptive?(this.parent.off("chartMouseClick",this.mouseUpHandler),this.parent.off("treeGridClick",this.popUpClickHandler)):this.parent.off("chartMouseUp",this.mouseUpHandler))}}class ej2_gantt_es2015_Toolbar$3{constructor(parent){this.predefinedItems={},this.items=["Add","Edit","Update","Delete","Cancel","ExpandAll","CollapseAll","Search","PrevTimeSpan","NextTimeSpan","ZoomIn","ZoomOut","ZoomToFit"],this.parent=parent,this.id=this.parent.element.id,this.parent.on("ui-toolbarupdate",this.propertyChanged,this)}getModuleName(){return"toolbar"}renderToolbar(){if((this.parent.toolbar||[]).length>0){this.element=ej2_base_es2015_createElement("div",{id:this.parent.controlId+"_Gantt_Toolbar",className:toolbar}),this.parent.treeGrid.grid.headerModule?this.parent.element.insertBefore(this.element,this.parent.treeGridPane.offsetParent):this.parent.element.appendChild(this.element);let preItems=["Add","Edit","Update","Delete","Cancel","ExpandAll","CollapseAll","PrevTimeSpan","NextTimeSpan","ZoomIn","ZoomOut","ZoomToFit"];for(let item of preItems){let itemStr=item.toLowerCase(),localeName=item[0].toLowerCase()+item.slice(1);this.predefinedItems[item]={id:this.parent.element.id+"_"+itemStr,prefixIcon:"e-"+itemStr,text:this.parent.isAdaptive?"":this.parent.localeObj.getConstant(localeName),tooltipText:this.parent.localeObj.getConstant(localeName)+("add"===localeName||"edit"===localeName||"delete"===localeName?this.parent.localeObj.getConstant("task"):"expandAll"===localeName||"collapseAll"===localeName?this.parent.localeObj.getConstant("tasks"):""),align:this.parent.isAdaptive?"Right":"Left"}}let searchLocalText=this.parent.localeObj.getConstant("search");this.predefinedItems.Search=this.parent.isAdaptive?{id:this.id+"_searchbutton",prefixIcon:"e-search-icon",tooltipText:searchLocalText,align:"Right"}:{id:this.id+"_search",template:'<div class="e-input-group e-search" role="search">                <input id="'+this.id+'_searchbar" class="e-input" name="input" type="search"                 placeholder= "'+searchLocalText+'"/>                <span id="'+this.id+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                 tabindex="-1" title="'+searchLocalText+'" aria-label= "search"></span>                 </div>',tooltipText:searchLocalText,align:"Right",cssClass:"e-search-wrapper"},this.createToolbar()}}createToolbar(){let items=this.getItems();this.toolbar=new ej2_navigations_es2015_Toolbar({items:items,clicked:this.toolbarClickHandler.bind(this),height:this.parent.isAdaptive?48:"auto"}),this.toolbar.isStringTemplate=!0,this.toolbar.appendTo(this.element);let cancelItem=this.element.querySelector("#"+this.parent.element.id+"_cancel"),updateItem=this.element.querySelector("#"+this.parent.element.id+"_update");cancelItem&&addClass([cancelItem],focusCell),updateItem&&addClass([updateItem],focusCell),this.parent.isAdaptive?(this.element.insertBefore(this.getSearchBarElement(),this.element.childNodes[0]),this.searchElement=this.element.querySelector("#"+this.parent.element.id+"_searchbar"),new ej2_inputs_es2015_TextBox({placeholder:this.parent.localeObj.getConstant("search"),floatLabelType:"Never",showClearButton:!0}).appendTo(this.searchElement)):this.searchElement=this.element.querySelector("#"+this.parent.element.id+"_searchbar"),this.parent.filterModule&&(this.wireEvent(),this.parent.searchSettings&&this.updateSearchTextBox())}getSearchBarElement(){let div=ej2_base_es2015_createElement("div",{className:"e-adaptive-searchbar",styles:"display: none"}),textbox=ej2_base_es2015_createElement("input",{attrs:{type:"text"},id:this.parent.element.id+"_searchbar"}),span=ej2_base_es2015_createElement("span",{className:"e-backarrowspan e-icons"});return span.onclick=()=>{div.style.display="none",this.element.childNodes[1].style.display="block"},div.appendChild(span),div.appendChild(textbox),div}wireEvent(){this.searchElement&&(EventHandler.add(this.searchElement,"keyup",this.keyUpHandler,this),EventHandler.add(this.searchElement,"focus",this.focusHandler,this),EventHandler.add(this.searchElement,"blur",this.blurHandler,this))}propertyChanged(property){getValue("module",property)===this.getModuleName()&&this.parent.toolbar&&(this.element&&this.element.parentNode&&ej2_base_es2015_remove(this.element),this.renderToolbar(),this.refreshToolbarItems())}unWireEvent(){this.searchElement&&(EventHandler.remove(this.searchElement,"keyup",this.keyUpHandler),EventHandler.remove(this.searchElement,"focus",this.focusHandler),EventHandler.remove(this.searchElement,"blur",this.blurHandler),this.searchElement=null),this.parent.off("ui-toolbarupdate",this.propertyChanged)}keyUpHandler(e){13===e.keyCode&&this.parent.searchSettings.key!==this.searchElement.value&&(this.parent.searchSettings.key=this.searchElement.value,this.parent.dataBind())}focusHandler(e){e.target.parentElement.classList.add("e-input-focus")}blurHandler(e){e.target.parentElement.classList.remove("e-input-focus")}updateSearchTextBox(){this.searchElement&&this.searchElement.value!==this.parent.searchSettings.key&&(this.searchElement.value=this.parent.searchSettings.key)}getItems(){let items=[],toolbarItems=this.parent.toolbar;for(let item of toolbarItems)switch(typeof item){case"string":items.push(this.getItemObject(item));break;default:items.push(this.getItem(item))}return items}getItem(itemObject){let item=this.predefinedItems[itemObject.text];return item?extend(item,item,itemObject):itemObject}getItemObject(itemName){return this.predefinedItems[itemName]||{text:itemName,id:this.id+"_"+itemName}}toolbarClickHandler(args){let gObj=this.parent,gID=this.id;extend(args,{cancel:!1}),gObj.trigger(ej2_gantt_es2015_toolbarClick,args,args=>{if(!args.cancel)switch(!0===this.parent.isAdaptive&&(args.item.id!==gID+"_edit"&&args.item.id!==gID+"_add"&&args.item.id!==gID+"_delete"&&args.item.id!==gID+"_searchbutton"&&args.item.id!==gID+"_expandall"&&args.item.id!==gID+"_collapseall"||this.parent.selectionModule&&"Multiple"===this.parent.selectionSettings.type&&(this.parent.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),!isNullOrUndefined(args.item)&&args.item.id){case gID+"_edit":gObj.editModule&&gObj.editSettings.allowEditing&&gObj.editModule.dialogModule.openToolbarEditDialog();break;case gID+"_update":gObj.editModule.cellEditModule.isCellEdit=!1,gObj.treeGrid.endEdit();break;case gID+"_cancel":gObj.cancelEdit();break;case gID+"_add":gObj.editModule&&gObj.editSettings.allowAdding&&gObj.editModule.dialogModule.openAddDialog();break;case gID+"_delete":this.parent.selectionModule&&this.parent.editModule&&("Cell"!==this.parent.selectionSettings.mode&&this.parent.selectionModule.selectedRowIndexes.length||"Cell"===this.parent.selectionSettings.mode&&this.parent.selectionModule.getSelectedRowCellIndexes().length)&&this.parent.editModule.startDeleteAction();break;case gID+"_search":if(getValue("originalEvent.target.id",args)===this.parent.element.id+"_searchbutton"&&this.parent.filterModule){let keyVal=this.element.querySelector("#"+this.parent.element.id+"_searchbar").value;this.parent.searchSettings.key!==keyVal&&(this.parent.searchSettings.key=keyVal,this.parent.dataBind())}break;case gID+"_searchbutton":let adaptiveSearchbar=this.element.querySelector(".e-adaptive-searchbar");adaptiveSearchbar.parentElement.childNodes[1].style.display="none",adaptiveSearchbar.style.display="block";break;case gID+"_expandall":this.parent.ganttChartModule.expandCollapseAll("expand");break;case gID+"_collapseall":this.parent.ganttChartModule.expandCollapseAll("collapse");break;case gID+"_prevtimespan":this.parent.previousTimeSpan();break;case gID+"_nexttimespan":this.parent.nextTimeSpan();break;case gID+"_zoomin":this.zoomIn();break;case gID+"_zoomout":this.zoomOut();break;case gID+"_zoomtofit":this.zoomToFit()}})}zoomIn(){this.parent.timelineModule.processZooming(!0)}zoomToFit(){this.parent.timelineModule.processZoomToFit(),this.parent.ganttChartModule.updateScrollLeft(0)}zoomOut(){this.parent.timelineModule.processZooming(!1)}refreshToolbarItems(){let gObj=this.parent,enableItems=[],disableItems=[],edit=gObj.editSettings,gID=this.id,isSelected=!!gObj.selectionModule&&(1===gObj.selectionModule.selectedRowIndexes.length||1===gObj.selectionModule.getSelectedRowCellIndexes().length),toolbarItems=this.toolbar?this.toolbar.items:[],toolbarDefaultItems=[gID+"_add",gID+"_edit",gID+"_delete",gID+"_update",gID+"_cancel"];if(isNullOrUndefined(this.parent.editModule))disableItems.push(gID+"_delete"),disableItems.push(gID+"_add"),disableItems.push(gID+"_edit"),disableItems.push(gID+"_update"),disableItems.push(gID+"_cancel");else{let touchEdit=!!gObj.editModule.taskbarEditModule&&gObj.editModule.taskbarEditModule.touchEdit,hasData=gObj.currentViewData&&gObj.currentViewData.length;edit.allowAdding&&!touchEdit?enableItems.push(gID+"_add"):disableItems.push(gID+"_add"),edit.allowEditing&&hasData&&isSelected&&!touchEdit?enableItems.push(gID+"_edit"):disableItems.push(gID+"_edit");let isDeleteSelected=!!gObj.selectionModule&&(gObj.selectionModule.selectedRowIndexes.length>0||gObj.selectionModule.getSelectedRowCellIndexes().length>0);if(edit.allowDeleting&&hasData&&isDeleteSelected&&!touchEdit?enableItems.push(gID+"_delete"):disableItems.push(gID+"_delete"),"Auto"===gObj.editSettings.mode&&!isNullOrUndefined(gObj.editModule.cellEditModule)&&gObj.editModule.cellEditModule.isCellEdit){(enableItems=[]).push(gID+"_update",gID+"_cancel"),disableItems=[];for(let t=0;t<toolbarItems.length;t++)toolbarItems[t].id!==gID+"_update"&&toolbarItems[t].id!==gID+"_cancel"&&-1!==toolbarDefaultItems.indexOf(toolbarItems[t].id)&&disableItems.push(toolbarItems[t].id)}else{disableItems.push(gID+"_update",gID+"_cancel");for(let t=0;t<toolbarItems.length;t++)-1===enableItems.indexOf(toolbarItems[t].id)&&-1===disableItems.indexOf(toolbarItems[t].id)&&enableItems.push(toolbarItems[t].id)}}for(let e=0;e<enableItems.length;e++){let index;for(let t=0;t<toolbarItems.length;t++)if(toolbarItems[t].id===enableItems[e]){index=t;break}toolbarItems.length>0&&this.toolbar.hideItem(index,!1)}for(let d=0;d<disableItems.length;d++){let index;for(let t=0;t<toolbarItems.length;t++)if(toolbarItems[t].id===disableItems[d]){index=t;break}toolbarItems.length>0&&this.toolbar.hideItem(index,!0)}}enableItems(items,isEnable){for(let item of items){let element=this.element.querySelector("#"+item);element&&this.toolbar.enableItems(element.parentElement,isEnable)}}destroy(){this.parent.isDestroyed||(this.toolbar.destroy(),this.parent.filterModule&&this.unWireEvent(),ej2_base_es2015_remove(this.element))}}class ej2_gantt_es2015_NonWorkingDay{constructor(gantt){this.parent=gantt,this.nonworkingContainer=null,this.holidayContainer=null,this.weekendContainer=null}createNonworkingContainer(){this.parent.ganttChartModule.chartBodyContent.contains(this.nonworkingContainer)||(this.nonworkingContainer=ej2_base_es2015_createElement("div",{className:nonworkingContainer}),this.parent.ganttChartModule.chartBodyContent.appendChild(this.nonworkingContainer))}renderHolidays(){this.parent.holidays&&this.parent.holidays.length>0?(this.createNonworkingContainer(),this.nonworkingContainer.contains(this.holidayContainer)||(this.holidayContainer=ej2_base_es2015_createElement("div",{className:holidayContainer}),this.nonworkingContainer.appendChild(this.holidayContainer)),this.holidayContainer.innerHTML=this.getHolidaysElement().innerHTML):this.holidayContainer&&(ej2_base_es2015_remove(this.holidayContainer),this.nonworkingContainer&&0===this.nonworkingContainer.childNodes.length&&ej2_base_es2015_remove(this.nonworkingContainer))}getHolidaysElement(){let fromDate,toDate,container=ej2_base_es2015_createElement("div"),height=this.parent.contentHeight,viewportHeight=parseInt(this.parent.ganttChartModule.scrollElement.style.height,10);for(let i=0;i<this.parent.holidays.length;i++){this.parent.holidays[i].from&&this.parent.holidays[i].to?(fromDate=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[i].from),(toDate=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[i].to)).setDate(toDate.getDate()+1),fromDate.setHours(0,0,0,0),toDate.setHours(0,0,0,0)):this.parent.holidays[i].from?(fromDate=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[i].from)).setHours(0,0,0,0):this.parent.holidays[i].to&&(fromDate=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[i].to)).setHours(0,0,0,0);let width=this.parent.holidays[i].from&&this.parent.holidays[i].to?this.parent.dataOperation.getTaskWidth(fromDate,toDate):this.parent.perDayWidth,left=this.parent.dataOperation.getTaskLeft(fromDate,!1),holidayDiv=ej2_base_es2015_createElement("div",{className:holidayElement,styles:`left:${left}px; width:${width}px; height:100%;`}),spanElement=ej2_base_es2015_createElement("span",{className:holidayLabel,innerHTML:this.parent.holidays[i].label?`${this.parent.holidays[i].label}`:"",styles:`top:${viewportHeight<height?viewportHeight/2:height/2}px;left:${width/2}px;`});holidayDiv.appendChild(spanElement),this.parent.holidays[i].cssClass&&holidayDiv.classList.add(this.parent.holidays[i].cssClass),container.appendChild(holidayDiv)}return container}renderWeekends(){this.parent.highlightWeekends?(this.createNonworkingContainer(),this.nonworkingContainer.contains(this.weekendContainer)||(this.weekendContainer=ej2_base_es2015_createElement("div",{className:weekendContainer}),this.nonworkingContainer.appendChild(this.weekendContainer)),this.weekendContainer.innerHTML=this.getWeekendElements().innerHTML):this.weekendContainer&&(ej2_base_es2015_remove(this.weekendContainer),this.nonworkingContainer&&0===this.nonworkingContainer.childNodes.length&&ej2_base_es2015_remove(this.nonworkingContainer))}getWeekendElements(){let container=ej2_base_es2015_createElement("div"),startDate=new Date(this.parent.timelineModule.timelineStartDate.getTime()),endDate=new Date(this.parent.timelineModule.timelineEndDate.getTime()),nonWorkingIndex=this.parent.nonWorkingDayIndex,isFirstCell=!0;do{if(-1!==nonWorkingIndex.indexOf(startDate.getDay())){let left=this.parent.dataOperation.getTaskLeft(startDate,!1),width=this.parent.perDayWidth;if(isFirstCell){let start=new Date(startDate.getTime()),tempEnd=new Date(start.getTime());tempEnd.setDate(tempEnd.getDate()+1),tempEnd.setHours(0,0,0,0),width=this.parent.dataOperation.getTaskWidth(start,tempEnd),isFirstCell=!1}let weekendDiv=ej2_base_es2015_createElement("div",{className:weekend,styles:`left:${left}px;width:${width}px;height:100%;`});container.appendChild(weekendDiv)}startDate.setDate(startDate.getDate()+1),startDate.setHours(0,0,0,0)}while(startDate<endDate);return container}updateHolidayLabelHeight(){let height=this.parent.contentHeight,viewportHeight=parseInt(this.parent.ganttChartModule.scrollElement.style.height,10),top=viewportHeight<height?viewportHeight/2:height/2;this.holidayContainer.querySelectorAll("."+holidayLabel).forEach(element=>{element.style.top=formatUnit(top)})}updateContainerHeight(){this.holidayContainer&&(this.holidayContainer.style.height=formatUnit(this.parent.contentHeight),this.updateHolidayLabelHeight()),this.weekendContainer&&(this.weekendContainer.style.height=formatUnit(this.parent.contentHeight))}removeContainers(){this.holidayContainer&&ej2_base_es2015_remove(this.holidayContainer),this.weekendContainer&&ej2_base_es2015_remove(this.weekendContainer),this.nonworkingContainer&&ej2_base_es2015_remove(this.nonworkingContainer)}}class ej2_gantt_es2015_EventMarker$1{constructor(gantt){this.parent=gantt,this.eventMarkersContainer=null}renderEventMarkers(){this.parent.eventMarkers&&this.parent.eventMarkers.length>0?(this.parent.ganttChartModule.chartBodyContent.contains(this.eventMarkersContainer)||(this.eventMarkersContainer=ej2_base_es2015_createElement("div",{className:eventMarkersContainer}),this.parent.ganttChartModule.chartBodyContent.appendChild(this.eventMarkersContainer)),this.eventMarkersContainer.innerHTML="",this.getEventMarkersElements(this.eventMarkersContainer)):this.eventMarkersContainer&&ej2_base_es2015_remove(this.eventMarkersContainer)}removeContainer(){this.eventMarkersContainer&&ej2_base_es2015_remove(this.eventMarkersContainer)}getEventMarkersElements(container){let left,eventMarkerElement,spanElement,rightArrow;for(let i=0;i<this.parent.eventMarkers.length;i++)left=this.parent.dataOperation.getTaskLeft(this.parent.dateValidationModule.getDateFromFormat(this.parent.eventMarkers[i].day),!1),eventMarkerElement=ej2_base_es2015_createElement("div",{className:eventMarkersChild,styles:`left:${left}px;  height:100%;`,id:"stripline"+i}),this.parent.eventMarkers[i].label&&(spanElement=ej2_base_es2015_createElement("div",{className:eventMarkersSpan,innerHTML:`${this.parent.eventMarkers[i].label}`}),eventMarkerElement.appendChild(spanElement),rightArrow=ej2_base_es2015_createElement("div",{className:"e-gantt-right-arrow"}),eventMarkerElement.appendChild(rightArrow)),this.parent.eventMarkers[i].cssClass&&eventMarkerElement.classList.add(this.parent.eventMarkers[i].cssClass),eventMarkerElement.setAttribute("tabindex","-1"),isNullOrUndefined(this.parent.eventMarkers[i].day)||eventMarkerElement.setAttribute("aria-label",this.parent.localeObj.getConstant("eventMarkers")+" "+("string"==typeof this.parent.eventMarkers[i].day?this.parent.eventMarkers[i].day:this.parent.getFormatedDate(this.parent.eventMarkers[i].day))+" "+this.parent.eventMarkers[i].label),container.appendChild(eventMarkerElement)}updateContainerHeight(){this.eventMarkersContainer&&(this.eventMarkersContainer.style.height=formatUnit(this.parent.contentHeight))}}class ej2_gantt_es2015_DayMarkers{constructor(parent){this.parent=parent,this.nonworkingDayRender=new ej2_gantt_es2015_NonWorkingDay(this.parent),this.eventMarkerRender=new ej2_gantt_es2015_EventMarker$1(this.parent),this.wireEvents()}wireEvents(){this.parent.on("refreshDayMarkers",this.refreshMarkers,this),this.parent.on("updateHeight",this.updateHeight,this),this.parent.on("ui-update",this.propertyChanged,this)}propertyChanged(property){let keys=Object.keys(getValue("properties",property));for(let i=0;i<keys.length;i++)switch(keys[i]){case"eventMarkers":this.eventMarkerRender.renderEventMarkers(),this.updateHeight();break;case"highlightWeekends":this.nonworkingDayRender.renderWeekends(),this.updateHeight();break;case"holidays":this.nonworkingDayRender.renderHolidays(),this.updateHeight()}}refreshMarkers(){this.eventMarkerRender.renderEventMarkers(),this.nonworkingDayRender.renderWeekends(),this.nonworkingDayRender.renderHolidays()}updateHeight(){this.nonworkingDayRender.updateContainerHeight(),this.eventMarkerRender.updateContainerHeight()}getModuleName(){return"dayMarkers"}destroy(){this.parent.isDestroyed||(this.nonworkingDayRender.removeContainers(),this.eventMarkerRender.removeContainer(),this.parent.off("refreshDayMarkers",this.refreshMarkers),this.parent.off("updateHeight",this.updateHeight),this.parent.off("ui-update",this.propertyChanged))}}class ej2_gantt_es2015_ContextMenu$2{constructor(parent){this.headerContextMenuClick=args=>{let gridRow=closest(args.event.target,".e-row"),chartRow$$1=closest(args.event.target,".e-chart-row");isNullOrUndefined(gridRow)&&isNullOrUndefined(chartRow$$1)&&(args.type="Header",this.parent.trigger("contextMenuClick",args))},this.headerContextMenuOpen=args=>{let gridRow=closest(args.event.target,".e-row"),chartRow$$1=closest(args.event.target,".e-chart-row");isNullOrUndefined(gridRow)&&isNullOrUndefined(chartRow$$1)?(args.type="Header",this.parent.trigger("contextMenuOpen",args)):args.cancel=!0},this.parent=parent,this.ganttID=parent.element.id,ej2_treegrid_es2015_TreeGrid.Inject(ej2_treegrid_es2015_ContextMenu$1),this.parent.treeGrid.contextMenuClick=this.headerContextMenuClick.bind(this),this.parent.treeGrid.contextMenuOpen=this.headerContextMenuOpen.bind(this),this.addEventListener(),this.resetItems()}addEventListener(){this.parent.isDestroyed||(this.parent.on("initiate-contextMenu",this.render,this),this.parent.on("reRender-contextMenu",this.reRenderContextMenu,this),this.parent.on("contextMenuClick",this.contextMenuItemClick,this),this.parent.on("contextMenuOpen",this.contextMenuBeforeOpen,this))}reRenderContextMenu(e){e.module===this.getModuleName()&&e.enable&&(this.contextMenu&&(this.contextMenu.destroy(),ej2_base_es2015_remove(this.element)),this.resetItems(),this.render())}render(){this.element=this.parent.createElement("ul",{id:this.ganttID+"_contextmenu",className:focusCell}),this.parent.element.appendChild(this.element);let target="#"+this.ganttID;this.contextMenu=new ej2_navigations_es2015_ContextMenu({items:this.getMenuItems(),locale:this.parent.locale,target:target,animationSettings:{effect:"None"},select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-gantt"}),this.contextMenu.appendTo(this.element),this.parent.treeGrid.contextMenuItems=this.headerMenuItems}contextMenuItemClick(args){let item=this.getKeyFromId(args.item.id),parentItem=getValue("parentObj",args.item),index=-1;switch(parentItem&&!isNullOrUndefined(parentItem.id)&&"DeleteDependency"===this.getKeyFromId(parentItem.id)&&(index=parentItem.items.indexOf(args.item)),this.parent.isAdaptive&&("TaskInformation"!==item&&"Above"!==item&&"Below"!==item&&"Child"!==item&&"DeleteTask"!==item||this.parent.selectionModule&&"Multiple"===this.parent.selectionSettings.type&&(this.parent.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),item){case"TaskInformation":this.parent.openEditDialog(Number(this.rowData.ganttProperties.taskId));break;case"Above":case"Below":case"Child":let position=item,data=extend({},{},this.rowData.taskData,!0),taskfields=this.parent.taskFields;if(isNullOrUndefined(taskfields.dependency)||(data[taskfields.dependency]=null),!isNullOrUndefined(taskfields.child)&&data[taskfields.child]&&delete data[taskfields.child],!isNullOrUndefined(taskfields.parentID)&&data[taskfields.parentID]&&(data[taskfields.parentID]=null),this.rowData){let rowIndex=this.parent.currentViewData.indexOf(this.rowData);this.parent.addRecord(data,position,rowIndex)}break;case"Milestone":case"ToMilestone":this.convertToMilestone(item);break;case"DeleteTask":this.parent.editModule.deleteRecord(this.rowData);break;case"ToTask":if(data=extend({},{},this.rowData.taskData,!0),isNullOrUndefined((taskfields=this.parent.taskFields).duration)){data[taskfields.startDate]=new Date(this.rowData.taskData[taskfields.startDate]);let endDate=new Date(this.rowData.taskData[taskfields.startDate]);endDate.setDate(endDate.getDate()+1),data[taskfields.endDate]=endDate}else data[taskfields.duration]="1 "+this.rowData.ganttProperties.durationUnit;isNullOrUndefined(data[taskfields.milestone])||!0===data[taskfields.milestone]&&(data[taskfields.milestone]=!1),this.parent.updateRecordByID(data);break;case"Cancel":this.parent.cancelEdit();break;case"Save":this.parent.editModule.cellEditModule.isCellEdit=!1,this.parent.treeGrid.endEdit();break;case"Dependency"+index:this.parent.predecessorModule.removePredecessor(this.rowData,index)}args.type="Content",args.rowData=this.rowData,this.parent.trigger("contextMenuClick",args)}convertToMilestone(item){let data=extend({},{},this.rowData.taskData,!0),taskfields=this.parent.taskFields;isNullOrUndefined(taskfields.duration)?(data[taskfields.startDate]=new Date(this.rowData.taskData[taskfields.startDate]),data[taskfields.endDate]=new Date(this.rowData.taskData[taskfields.startDate])):data[taskfields.duration]=0,isNullOrUndefined(taskfields.milestone)||!1===data[taskfields.milestone]&&(data[taskfields.milestone]=!0),isNullOrUndefined(taskfields.progress)||(data[taskfields.progress]=0),!isNullOrUndefined(taskfields.child)&&data[taskfields.child]&&(data[taskfields.child]=[]),!isNullOrUndefined(taskfields.parentID)&&data[taskfields.parentID]&&(data[taskfields.parentID]=null),"Milestone"===item?(isNullOrUndefined(taskfields.dependency)||(data[taskfields.dependency]=null),this.parent.addRecord(data,"Below")):this.parent.updateRecordByID(data)}contextMenuBeforeOpen(args){args.gridRow=closest(args.event.target,".e-row"),args.chartRow=closest(args.event.target,".e-chart-row");let menuElement=closest(args.event.target,".e-gantt");if(!closest(args.event.target,ej2_gantt_es2015_editForm)&&this.parent.editModule&&this.parent.editModule.cellEditModule&&this.parent.editModule.cellEditModule.isCellEdit&&(this.parent.treeGrid.endEdit(),this.parent.editModule.cellEditModule.isCellEdit=!1),(isNullOrUndefined(args.gridRow)&&isNullOrUndefined(args.chartRow)||0===this.contentMenuItems.length)&&(args.cancel=!(!isNullOrUndefined(args.parentItem)&&!isNullOrUndefined(menuElement))),!args.cancel){let rowIndex=-1;args.gridRow?rowIndex=parseInt(args.gridRow.getAttribute("aria-rowindex"),0):args.chartRow&&(rowIndex=parseInt(getValue("rowIndex",args.chartRow),0)),this.parent.selectionModule&&this.parent.allowSelection&&this.parent.selectionModule.selectRow(rowIndex),args.parentItem||(this.rowData=this.parent.currentViewData[rowIndex]);for(let item of args.items){let target=args.event.target;item.separator||this.updateItemStatus(item,target)}args.rowData=this.rowData,args.type="Content",args.disableItems=this.disableItems,args.hideItems=this.hideItems;let callBackPromise=new Deferred;return this.parent.trigger("contextMenuOpen",args,args=>{callBackPromise.resolve(args),isBlazor()&&(args.element=getElement(args.element),args.gridRow=getElement(args.gridRow)),this.hideItems=args.hideItems,this.disableItems=args.disableItems,args.parentItem||args.hideItems.length!==args.items.length||(this.revertItemStatus(),args.cancel=!0),this.hideItems.length>0&&this.contextMenu.hideItems(this.hideItems),this.disableItems.length>0&&this.contextMenu.enableItems(this.disableItems,!1)}),callBackPromise}}updateItemStatus(item,target){let key=this.getKeyFromId(item.id);if(closest(target,ej2_gantt_es2015_editForm))"Save"!==key&&"Cancel"!==key&&this.hideItems.push(item.text);else switch(key){case"TaskInformation":this.parent.editSettings.allowEditing&&this.parent.editModule||this.updateItemVisibility(item.text);break;case"Add":this.parent.editSettings.allowAdding&&this.parent.editModule||this.updateItemVisibility(item.text);break;case"Save":case"Cancel":this.hideItems.push(item.text);break;case"Convert":if(this.rowData.hasChildRecords)this.hideItems.push(item.text);else if(this.parent.editSettings.allowEditing&&this.parent.editModule){let subMenu=[];subMenu.push(this.rowData.ganttProperties.isMilestone?this.createItemModel(ej2_gantt_es2015_content,"ToTask",this.getLocale("toTask")):this.createItemModel(ej2_gantt_es2015_content,"ToMilestone",this.getLocale("toMilestone"))),item.items=subMenu}else this.updateItemVisibility(item.text);break;case"DeleteDependency":let items=this.getPredecessorsItems();this.rowData.hasChildRecords?this.hideItems.push(item.text):this.parent.editSettings.allowDeleting&&0!==items.length&&this.parent.editModule?items.length>0&&(item.items=items):this.updateItemVisibility(item.text);break;case"DeleteTask":this.parent.editSettings.allowDeleting&&this.parent.editModule||this.updateItemVisibility(item.text)}}updateItemVisibility(text){isNullOrUndefined(this.parent.contextMenuItems)?this.hideItems.push(text):this.disableItems.push(text)}contextMenuOpen(){this.isOpen=!0}getMenuItems(){let menuItems=isNullOrUndefined(this.parent.contextMenuItems)?this.getDefaultItems():this.parent.contextMenuItems;for(let item of menuItems)"string"==typeof item&&-1!==this.getDefaultItems().indexOf(item)?this.buildDefaultItems(item):"string"!=typeof item&&(-1!==this.getDefaultItems().indexOf(item.text)?this.buildDefaultItems(item.text,item.iconCss):item.target===columnHeader?this.headerMenuItems.push(item):this.contentMenuItems.push(item));return this.contentMenuItems}createItemModel(target,item,text,iconCss){return{text:text,id:this.generateID(item),target:target,iconCss:iconCss?"e-icons "+iconCss:""}}getLocale(text){return this.parent.localeObj.getConstant(text)}buildDefaultItems(item,iconCSS){let contentMenuItem;switch(item){case"AutoFitAll":case"AutoFit":case"SortAscending":case"SortDescending":this.headerMenuItems.push(item);break;case"TaskInformation":contentMenuItem=this.createItemModel(ej2_gantt_es2015_content,item,this.getLocale("taskInformation"),this.getIconCSS(editIcon,iconCSS));break;case"Save":contentMenuItem=this.createItemModel(editIcon,item,this.getLocale("save"),this.getIconCSS(saveIcon,iconCSS));break;case"Cancel":contentMenuItem=this.createItemModel(editIcon,item,this.getLocale("cancel"),this.getIconCSS(cancelIcon,iconCSS));break;case"Add":(contentMenuItem=this.createItemModel(ej2_gantt_es2015_content,item,this.getLocale("add"),this.getIconCSS(addIcon,iconCSS))).items=[],contentMenuItem.items.push(this.createItemModel(ej2_gantt_es2015_content,"Above",this.getLocale("above"),this.getIconCSS(addAboveIcon,iconCSS))),contentMenuItem.items.push(this.createItemModel(ej2_gantt_es2015_content,"Below",this.getLocale("below"),this.getIconCSS(addBelowIcon,iconCSS))),contentMenuItem.items.push(this.createItemModel(ej2_gantt_es2015_content,"Child",this.getLocale("child"))),contentMenuItem.items.push(this.createItemModel(ej2_gantt_es2015_content,"Milestone",this.getLocale("milestone")));break;case"DeleteTask":contentMenuItem=this.createItemModel(ej2_gantt_es2015_content,item,this.getLocale("deleteTask"),this.getIconCSS(ej2_gantt_es2015_deleteIcon,iconCSS));break;case"DeleteDependency":(contentMenuItem=this.createItemModel(ej2_gantt_es2015_content,item,this.getLocale("deleteDependency"))).items=[],contentMenuItem.items.push({});break;case"Convert":(contentMenuItem=this.createItemModel(ej2_gantt_es2015_content,item,this.getLocale("convert"))).items=[],contentMenuItem.items.push({})}contentMenuItem&&this.contentMenuItems.push(contentMenuItem)}getIconCSS(menuClass,iconString){return isNullOrUndefined(iconString)?menuClass:iconString}getPredecessorsItems(){this.predecessors=this.parent.predecessorModule.getValidPredecessor(this.rowData);let itemModel,items=[],increment=0;for(let predecessor of this.predecessors){let ganttProp=this.parent.getRecordByID(predecessor.from).ganttProperties,id="Dependency"+increment++;itemModel=this.createItemModel(ej2_gantt_es2015_content,id,ganttProp.taskId+" - "+ganttProp.taskName),items.push(itemModel)}return items}getDefaultItems(){return["AutoFitAll","AutoFit","TaskInformation","DeleteTask","Save","Cancel","SortAscending","SortDescending","Add","DeleteDependency","Convert"]}getModuleName(){return"contextMenu"}removeEventListener(){this.parent.isDestroyed||(this.parent.off("initiate-contextMenu",this.render),this.parent.off("reRender-contextMenu",this.reRenderContextMenu),this.parent.off("contextMenuClick",this.contextMenuItemClick),this.parent.off("contextMenuOpen",this.contextMenuOpen))}contextMenuOnClose(args){args.items.length>0&&args.items[0].parentObj instanceof ej2_navigations_es2015_ContextMenu&&this.revertItemStatus()}revertItemStatus(){isBlazor()&&isNullOrUndefined(this.disableItems)&&(this.disableItems=[]),this.contextMenu.showItems(this.hideItems),this.contextMenu.enableItems(this.disableItems),this.hideItems=[],this.disableItems=[],this.isOpen=!1}resetItems(){this.hideItems=[],this.disableItems=[],this.headerMenuItems=[],this.contentMenuItems=[]}generateID(item){return this.ganttID+"_contextMenu_"+item}getKeyFromId(id){let idPrefix=this.ganttID+"_contextMenu_";return id.indexOf(idPrefix)>-1?id.replace(idPrefix,""):"Custom"}destroy(){this.contextMenu.destroy(),ej2_base_es2015_remove(this.element),this.removeEventListener(),this.contextMenu=null,this.element=null}}const outputs$6=["actionBegin","actionComplete","actionFailure","beforeTooltipRender","cellDeselected","cellDeselecting","cellEdit","cellSelected","cellSelecting","collapsed","collapsing","columnDrag","columnDragStart","columnDrop","columnMenuClick","columnMenuOpen","contextMenuClick","contextMenuOpen","dataBound","endEdit","expanded","expanding","headerCellInfo","load","queryCellInfo","queryTaskbarInfo","resizeStart","resizeStop","resizing","rowDataBound","rowDeselected","rowDeselecting","rowSelected","rowSelecting","splitterResizeStart","splitterResized","splitterResizing","taskbarEdited","taskbarEditing","toolbarClick","dataSourceChange"],twoWays=["dataSource"];let ej2_angular_gantt_GanttComponent=(()=>{let GanttComponent=class extends ej2_gantt_es2015_Gantt{constructor(ngEle,srenderer,viewContainerRef,injector){super(),this.ngEle=ngEle,this.srenderer=srenderer,this.viewContainerRef=viewContainerRef,this.injector=injector,this.tags=["columns","addDialogFields","editDialogFields","dayWorkingTime","holidays","eventMarkers"],this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let mod=this.injector.get("GanttFilter");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_a){}try{let mod=this.injector.get("GanttSelection");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_b){}try{let mod=this.injector.get("GanttSort");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_c){}try{let mod=this.injector.get("GanttReorder");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_d){}try{let mod=this.injector.get("GanttResize");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_e){}try{let mod=this.injector.get("GanttEdit");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_f){}try{let mod=this.injector.get("GanttDayMarkers");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_g){}try{let mod=this.injector.get("GanttToolbar");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_h){}try{let mod=this.injector.get("GanttContextMenu");-1===this.injectedModules.indexOf(mod)&&this.injectedModules.push(mod)}catch(_j){}this.registerEvents(outputs$6),this.addTwoWay.call(this,twoWays),util_setValue("currentInstance",this,this.viewContainerRef)}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){}ngAfterContentChecked(){}};return __decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"parentTaskbarTemplate",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"milestoneTemplate",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"taskbarTemplate",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"labelSettings_rightLabel",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"labelSettings_leftLabel",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"labelSettings_taskLabel",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"tooltipSettings_taskbar",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"tooltipSettings_baseline",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"tooltipSettings_connectorLine",void 0),__decorate([Template(),__metadata("design:type",Object)],GanttComponent.prototype,"tooltipSettings_editing",void 0),__decorate([ComponentMixins([component_base_ComponentBase]),__metadata("design:paramtypes",[ElementRef,Renderer2,ViewContainerRef,Injector])],GanttComponent)})();class GanttModule{}class GanttAllModule{}var RenderType_GanttComponent=createRendererType2({encapsulation:2,styles:[],data:{}});function View_GanttComponent_0(_l){return viewDef(2,[],null,null)}class TextBoxModule{}class TextBoxAllModule{}const ej2_angular_inputs_outputs$1=["blur","change","created","destroyed","focus","valueChange"],twoWays$1=["value"];let ej2_angular_inputs_NumericTextBoxComponent=(()=>{return __decorate([ComponentMixins([component_base_ComponentBase,form_base_FormBase]),__metadata("design:paramtypes",[ElementRef,Renderer2,ViewContainerRef,Injector])],class extends ej2_inputs_es2015_NumericTextBox{constructor(ngEle,srenderer,viewContainerRef,injector){super(),this.ngEle=ngEle,this.srenderer=srenderer,this.viewContainerRef=viewContainerRef,this.injector=injector,this.skipFromEvent=!0,this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[],this.registerEvents(ej2_angular_inputs_outputs$1),this.addTwoWay.call(this,twoWays$1),util_setValue("currentInstance",this,this.viewContainerRef)}registerOnChange(registerFunction){}registerOnTouched(registerFunction){}writeValue(value){}setDisabledState(disabled){}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){}ngAfterContentChecked(){}})})();class NumericTextBoxModule{}class NumericTextBoxAllModule{}const NG_VALUE_ACCESSOR=new InjectionToken("NgValueAccessor");var RenderType_NumericTextBoxComponent=createRendererType2({encapsulation:2,styles:[],data:{}});function View_NumericTextBoxComponent_0(_l){return viewDef(2,[],null,null)}const ej2_angular_buttons_outputs$1=["focus","blur","change","created","checkedChange","indeterminateChange"],ej2_angular_buttons_twoWays$1=["checked","indeterminate"];let ej2_angular_buttons_CheckBoxComponent=(()=>{return __decorate([ComponentMixins([component_base_ComponentBase,form_base_FormBase]),__metadata("design:paramtypes",[ElementRef,Renderer2,ViewContainerRef,Injector])],class extends ej2_buttons_es2015_CheckBox{constructor(ngEle,srenderer,viewContainerRef,injector){super(),this.ngEle=ngEle,this.srenderer=srenderer,this.viewContainerRef=viewContainerRef,this.injector=injector,this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[],this.registerEvents(ej2_angular_buttons_outputs$1),this.addTwoWay.call(this,ej2_angular_buttons_twoWays$1),util_setValue("currentInstance",this,this.viewContainerRef)}registerOnChange(registerFunction){}registerOnTouched(registerFunction){}writeValue(value){}setDisabledState(disabled){}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){}ngAfterContentChecked(){}})})();class CheckBoxModule{}class CheckBoxAllModule{}var RenderType_CheckBoxComponent=createRendererType2({encapsulation:2,styles:[],data:{}});function View_CheckBoxComponent_0(_l){return viewDef(2,[],null,null)}const ej2_angular_dropdowns_outputs=["actionBegin","actionComplete","actionFailure","beforeOpen","blur","change","close","created","dataBound","destroyed","filtering","focus","open","select","valueChange"],ej2_angular_dropdowns_twoWays=["value"];let ej2_angular_dropdowns_DropDownListComponent=(()=>{let DropDownListComponent=class extends ej2_dropdowns_es2015_DropDownList{constructor(ngEle,srenderer,viewContainerRef,injector){super(),this.ngEle=ngEle,this.srenderer=srenderer,this.viewContainerRef=viewContainerRef,this.injector=injector,this.skipFromEvent=!0,this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[],this.registerEvents(ej2_angular_dropdowns_outputs),this.addTwoWay.call(this,ej2_angular_dropdowns_twoWays),util_setValue("currentInstance",this,this.viewContainerRef)}registerOnChange(registerFunction){}registerOnTouched(registerFunction){}writeValue(value){}setDisabledState(disabled){}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){}ngAfterContentChecked(){}};return __decorate([Template(),__metadata("design:type",Object)],DropDownListComponent.prototype,"footerTemplate",void 0),__decorate([Template(),__metadata("design:type",Object)],DropDownListComponent.prototype,"headerTemplate",void 0),__decorate([Template(),__metadata("design:type",Object)],DropDownListComponent.prototype,"valueTemplate",void 0),__decorate([Template(),__metadata("design:type",Object)],DropDownListComponent.prototype,"groupTemplate",void 0),__decorate([Template(),__metadata("design:type",Object)],DropDownListComponent.prototype,"itemTemplate",void 0),__decorate([Template("No Records Found"),__metadata("design:type",Object)],DropDownListComponent.prototype,"noRecordsTemplate",void 0),__decorate([Template("The Request Failed"),__metadata("design:type",Object)],DropDownListComponent.prototype,"actionFailureTemplate",void 0),__decorate([ComponentMixins([component_base_ComponentBase,form_base_FormBase])],DropDownListComponent)})();class DropDownListModule{}class DropDownListAllModule{}var RenderType_DropDownListComponent=createRendererType2({encapsulation:2,styles:[],data:{}});function View_DropDownListComponent_0(_l){return viewDef(2,[],null,null)}var RenderType_AppComponent=createRendererType2({encapsulation:0,styles:[[""]],data:{}});function View_AppComponent_0(_l){return viewDef(0,[queryDef(402653184,1,{ganttObj:0}),queryDef(402653184,2,{topTierFormatObj:0}),queryDef(402653184,3,{bottomTierFormatObj:0}),queryDef(402653184,4,{topCountNumericObj:0}),queryDef(402653184,5,{bottomCountNumericObj:0}),queryDef(402653184,6,{topUnitDropdownObj:0}),queryDef(402653184,7,{bottomUnitDropdownObj:0}),queryDef(402653184,8,{unitWidthNumericObject:0}),(_l()(),elementDef(8,0,null,null,138,"div",[["class","control-section"]],null,null,null,null,null)),(_l()(),elementDef(9,0,null,null,18,"div",[["class","col-lg-8 content-wrapper"]],null,null,null,null,null)),(_l()(),elementDef(10,16777216,null,null,17,"ejs-gantt",[["collapseAllParentTasks","true"],["height","520px"],["id","ganttDefault"],["resourceIDMapping","resourceId"],["resourceNameMapping","resourceName"]],null,null,null,View_GanttComponent_0,RenderType_GanttComponent)),directiveDef(11,6537216,[[1,4],["gantt",4]],16,ej2_angular_gantt_GanttComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{allowSelection:[0,"allowSelection"],collapseAllParentTasks:[1,"collapseAllParentTasks"],dataSource:[2,"dataSource"],eventMarkers:[3,"eventMarkers"],height:[4,"height"],highlightWeekends:[5,"highlightWeekends"],labelSettings:[6,"labelSettings"],projectEndDate:[7,"projectEndDate"],projectStartDate:[8,"projectStartDate"],resourceIDMapping:[9,"resourceIDMapping"],resourceNameMapping:[10,"resourceNameMapping"],resources:[11,"resources"],splitterSettings:[12,"splitterSettings"],taskFields:[13,"taskFields"],timelineSettings:[14,"timelineSettings"],treeColumnIndex:[15,"treeColumnIndex"]},null),queryDef(335544320,9,{childColumns:0}),queryDef(335544320,10,{childAddDialogFields:0}),queryDef(335544320,11,{childEditDialogFields:0}),queryDef(335544320,12,{childDayWorkingTime:0}),queryDef(335544320,13,{childHolidays:0}),queryDef(335544320,14,{childEventMarkers:0}),queryDef(335544320,15,{parentTaskbarTemplate:0}),queryDef(335544320,16,{milestoneTemplate:0}),queryDef(335544320,17,{taskbarTemplate:0}),queryDef(335544320,18,{labelSettings_rightLabel:0}),queryDef(335544320,19,{labelSettings_leftLabel:0}),queryDef(335544320,20,{labelSettings_taskLabel:0}),queryDef(335544320,21,{tooltipSettings_taskbar:0}),queryDef(335544320,22,{tooltipSettings_baseline:0}),queryDef(335544320,23,{tooltipSettings_connectorLine:0}),queryDef(335544320,24,{tooltipSettings_editing:0}),(_l()(),elementDef(28,0,null,null,118,"div",[["class","col-lg-4 property-section"]],null,null,null,null,null)),(_l()(),elementDef(29,0,null,null,117,"div",[["class","property-panel-section"]],null,null,null,null,null)),(_l()(),elementDef(30,0,null,null,1,"div",[["class","property-panel-header"]],null,null,null,null,null)),(_l()(),textDef(-1,null,["Properties"])),(_l()(),elementDef(32,0,null,null,114,"div",[["class","property-panel-content"]],null,null,null,null,null)),(_l()(),elementDef(33,0,null,null,113,"div",[["class","property-panel-table"],["id","property"],["title","Properties"]],null,null,null,null,null)),(_l()(),elementDef(34,0,null,null,112,"table",[["id","property"],["style","width: 100%"],["title","Properties"]],null,null,null,null,null)),(_l()(),elementDef(35,0,null,null,111,"tbody",[],null,null,null,null,null)),(_l()(),elementDef(36,0,null,null,8,"tr",[],null,null,null,null,null)),(_l()(),elementDef(37,0,null,null,2,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(38,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Unit width"])),(_l()(),elementDef(40,0,null,null,4,"td",[["style","width: 70%;"]],null,null,null,null,null)),(_l()(),elementDef(41,0,null,null,3,"div",[],null,null,null,null,null)),(_l()(),elementDef(42,16777216,null,null,2,"ejs-numerictextbox",[["format","n"],["id","unitWidth"],["value","33"]],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onUnitWidthChange($event)&&ad),ad},View_NumericTextBoxComponent_0,RenderType_NumericTextBoxComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_inputs_NumericTextBoxComponent]),directiveDef(44,6537216,[[8,4],["unitWidth",4]],0,ej2_angular_inputs_NumericTextBoxComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{format:[0,"format"],min:[1,"min"],value:[2,"value"]},{change:"change"}),(_l()(),elementDef(45,0,null,null,9,"tr",[],null,null,null,null,null)),(_l()(),elementDef(46,0,null,null,3,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(47,0,null,null,2,"div",[],null,null,null,null,null)),(_l()(),elementDef(48,0,null,null,1,"b",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Top tier"])),(_l()(),elementDef(50,0,null,null,4,"td",[["style","width: 70%;"]],null,null,null,null,null)),(_l()(),elementDef(51,0,null,null,3,"div",[],null,null,null,null,null)),(_l()(),elementDef(52,16777216,null,null,2,"ejs-checkbox",[],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onTopTierChange($event)&&ad),ad},View_CheckBoxComponent_0,RenderType_CheckBoxComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_buttons_CheckBoxComponent]),directiveDef(54,6537216,null,0,ej2_angular_buttons_CheckBoxComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{checked:[0,"checked"]},{change:"change"}),(_l()(),elementDef(55,0,null,null,8,"tr",[],null,null,null,null,null)),(_l()(),elementDef(56,0,null,null,2,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(57,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Count"])),(_l()(),elementDef(59,0,null,null,4,"td",[["style","width: 70%"]],null,null,null,null,null)),(_l()(),elementDef(60,0,null,null,3,"div",[["id","numericbox"]],null,null,null,null,null)),(_l()(),elementDef(61,16777216,null,null,2,"ejs-numerictextbox",[["format","n"],["id"," count"],["value","1"]],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onTopCountChange($event)&&ad),ad},View_NumericTextBoxComponent_0,RenderType_NumericTextBoxComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_inputs_NumericTextBoxComponent]),directiveDef(63,6537216,[[4,4],["topCount",4]],0,ej2_angular_inputs_NumericTextBoxComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{format:[0,"format"],value:[1,"value"]},{change:"change"}),(_l()(),elementDef(64,0,null,null,15,"tr",[],null,null,null,null,null)),(_l()(),elementDef(65,0,null,null,2,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(66,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Unit "])),(_l()(),elementDef(68,0,null,null,11,"td",[["style","width: 70%"]],null,null,null,null,null)),(_l()(),elementDef(69,0,null,null,10,"div",[],null,null,null,null,null)),(_l()(),elementDef(70,16777216,null,null,9,"ejs-dropdownlist",[["id","unit"]],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onChangeUnit($event)&&ad),ad},View_DropDownListComponent_0,RenderType_DropDownListComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_dropdowns_DropDownListComponent]),directiveDef(72,6537216,[[6,4],["topUnit",4]],7,ej2_angular_dropdowns_DropDownListComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{dataSource:[0,"dataSource"],fields:[1,"fields"],value:[2,"value"]},{change:"change"}),queryDef(335544320,25,{footerTemplate:0}),queryDef(335544320,26,{headerTemplate:0}),queryDef(335544320,27,{valueTemplate:0}),queryDef(335544320,28,{groupTemplate:0}),queryDef(335544320,29,{itemTemplate:0}),queryDef(335544320,30,{noRecordsTemplate:0}),queryDef(335544320,31,{actionFailureTemplate:0}),(_l()(),elementDef(80,0,null,null,15,"tr",[],null,null,null,null,null)),(_l()(),elementDef(81,0,null,null,2,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(82,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Format "])),(_l()(),elementDef(84,0,null,null,11,"td",[["style","width: 70%"]],null,null,null,null,null)),(_l()(),elementDef(85,0,null,null,10,"div",[],null,null,null,null,null)),(_l()(),elementDef(86,16777216,null,null,9,"ejs-dropdownlist",[["id","format"]],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onChangeFormat($event)&&ad),ad},View_DropDownListComponent_0,RenderType_DropDownListComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_dropdowns_DropDownListComponent]),directiveDef(88,6537216,[[2,4],["topFormatDropdown",4]],7,ej2_angular_dropdowns_DropDownListComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{dataSource:[0,"dataSource"],fields:[1,"fields"],value:[2,"value"]},{change:"change"}),queryDef(335544320,32,{footerTemplate:0}),queryDef(335544320,33,{headerTemplate:0}),queryDef(335544320,34,{valueTemplate:0}),queryDef(335544320,35,{groupTemplate:0}),queryDef(335544320,36,{itemTemplate:0}),queryDef(335544320,37,{noRecordsTemplate:0}),queryDef(335544320,38,{actionFailureTemplate:0}),(_l()(),elementDef(96,0,null,null,9,"tr",[],null,null,null,null,null)),(_l()(),elementDef(97,0,null,null,3,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(98,0,null,null,2,"div",[],null,null,null,null,null)),(_l()(),elementDef(99,0,null,null,1,"b",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Bottom tier"])),(_l()(),elementDef(101,0,null,null,4,"td",[["style","width: 70%"]],null,null,null,null,null)),(_l()(),elementDef(102,0,null,null,3,"div",[],null,null,null,null,null)),(_l()(),elementDef(103,16777216,null,null,2,"ejs-checkbox",[["id","bottomTierCheck"]],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onBottomTierChange($event)&&ad),ad},View_CheckBoxComponent_0,RenderType_CheckBoxComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_buttons_CheckBoxComponent]),directiveDef(105,6537216,null,0,ej2_angular_buttons_CheckBoxComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{checked:[0,"checked"]},{change:"change"}),(_l()(),elementDef(106,0,null,null,8,"tr",[],null,null,null,null,null)),(_l()(),elementDef(107,0,null,null,2,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(108,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),textDef(-1,null,["Count"])),(_l()(),elementDef(110,0,null,null,4,"td",[["style","width: 70%"]],null,null,null,null,null)),(_l()(),elementDef(111,0,null,null,3,"div",[["id","numericbox"]],null,null,null,null,null)),(_l()(),elementDef(112,16777216,null,null,2,"ejs-numerictextbox",[["format","n"],["id","btCount"],["value","1"]],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onBottomCountChange($event)&&ad),ad},View_NumericTextBoxComponent_0,RenderType_NumericTextBoxComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_inputs_NumericTextBoxComponent]),directiveDef(114,6537216,[[5,4],["bottomCount",4]],0,ej2_angular_inputs_NumericTextBoxComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{format:[0,"format"],value:[1,"value"]},{change:"change"}),(_l()(),elementDef(115,0,null,null,15,"tr",[],null,null,null,null,null)),(_l()(),elementDef(116,0,null,null,2,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(117,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Unit "])),(_l()(),elementDef(119,0,null,null,11,"td",[["style","width: 70%"]],null,null,null,null,null)),(_l()(),elementDef(120,0,null,null,10,"div",[],null,null,null,null,null)),(_l()(),elementDef(121,16777216,null,null,9,"ejs-dropdownlist",[["id","btUnit"]],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onChangebtUnit($event)&&ad),ad},View_DropDownListComponent_0,RenderType_DropDownListComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_dropdowns_DropDownListComponent]),directiveDef(123,6537216,[[7,4],["bottomUnit",4]],7,ej2_angular_dropdowns_DropDownListComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{dataSource:[0,"dataSource"],fields:[1,"fields"],value:[2,"value"]},{change:"change"}),queryDef(335544320,39,{footerTemplate:0}),queryDef(335544320,40,{headerTemplate:0}),queryDef(335544320,41,{valueTemplate:0}),queryDef(335544320,42,{groupTemplate:0}),queryDef(335544320,43,{itemTemplate:0}),queryDef(335544320,44,{noRecordsTemplate:0}),queryDef(335544320,45,{actionFailureTemplate:0}),(_l()(),elementDef(131,0,null,null,15,"tr",[],null,null,null,null,null)),(_l()(),elementDef(132,0,null,null,2,"td",[["style","width: 30%"]],null,null,null,null,null)),(_l()(),elementDef(133,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),textDef(-1,null,[" Format "])),(_l()(),elementDef(135,0,null,null,11,"td",[["style","width: 70%"]],null,null,null,null,null)),(_l()(),elementDef(136,0,null,null,10,"div",[],null,null,null,null,null)),(_l()(),elementDef(137,16777216,null,null,9,"ejs-dropdownlist",[["id","btFormat"]],null,[[null,"change"]],function(_v,en,$event){var ad=!0;return"change"===en&&(ad=!1!==_v.component.onChangebtFormat($event)&&ad),ad},View_DropDownListComponent_0,RenderType_DropDownListComponent)),providerDef(5120,null,NG_VALUE_ACCESSOR,function(p0_0){return[p0_0]},[ej2_angular_dropdowns_DropDownListComponent]),directiveDef(139,6537216,[[3,4],["bottomFormatDropdown",4]],7,ej2_angular_dropdowns_DropDownListComponent,[ElementRef,Renderer2,ViewContainerRef,Injector],{dataSource:[0,"dataSource"],fields:[1,"fields"]},{change:"change"}),queryDef(335544320,46,{footerTemplate:0}),queryDef(335544320,47,{headerTemplate:0}),queryDef(335544320,48,{valueTemplate:0}),queryDef(335544320,49,{groupTemplate:0}),queryDef(335544320,50,{itemTemplate:0}),queryDef(335544320,51,{noRecordsTemplate:0}),queryDef(335544320,52,{actionFailureTemplate:0}),(_l()(),elementDef(147,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),directiveDef(148,212992,null,0,router_RouterOutlet,[ChildrenOutletContexts,ViewContainerRef,ComponentFactoryResolver,[8,null],ChangeDetectorRef],null,null)],function(_ck,_v){var _co=_v.component;_ck(_v,11,1,[!0,"true",_co.data,_co.eventMarkers,"520px",!0,_co.labelSettings,_co.projectEndDate,_co.projectStartDate,"resourceId","resourceName",_co.resources,_co.splitterSettings,_co.taskSettings,_co.timelineSettings,1]),_ck(_v,44,0,"n",10,"33"),_ck(_v,54,0,!0),_ck(_v,63,0,"n","1"),_ck(_v,72,0,_co.unit,_co.unitFields,_co.unitValue),_ck(_v,88,0,_co.weekformat,_co.formatFields,_co.topFormatValue),_ck(_v,105,0,!0),_ck(_v,114,0,"n","1"),_ck(_v,123,0,_co.unit,_co.unitFields,_co.bottomUnitValue),_ck(_v,139,0,_co.dayformat,_co.formatFields),_ck(_v,148,0)},null)}function View_AppComponent_Host_0(_l){return viewDef(0,[(_l()(),elementDef(0,0,null,null,1,"app-root",[],null,null,null,View_AppComponent_0,RenderType_AppComponent)),directiveDef(1,4308992,null,0,app_component_AppComponent,[],null,null)],function(_ck,_v){_ck(_v,1,0)},null)}var AppComponentNgFactory=createComponentFactory("app-root",app_component_AppComponent,View_AppComponent_Host_0,{},{},[]);class AppRoutingModule{}var AppModuleNgFactory=createNgModuleFactory(AppModule,[app_component_AppComponent],function(_l){return function(providers){const providersByKey={},modules=[];let isRoot=!1;for(let i=0;i<providers.length;i++){const provider=providers[i];provider.token===APP_ROOT&&!0===provider.value&&(isRoot=!0),1073741824&provider.flags&&modules.push(provider.token),provider.index=i,providersByKey[tokenKey(provider.token)]=provider}return{factory:null,providersByKey:providersByKey,providers:providers,modules:modules,isRoot:isRoot}}([moduleProvideDef(512,ComponentFactoryResolver,CodegenComponentFactoryResolver,[[8,[ɵangular_packages_router_router_lNgFactory,AppComponentNgFactory]],[3,ComponentFactoryResolver],NgModuleRef]),moduleProvideDef(5120,router_ActivatedRoute,rootRoute,[router_Router]),moduleProvideDef(4608,router_NoPreloading,router_NoPreloading,[]),moduleProvideDef(6144,PreloadingStrategy,null,[router_NoPreloading]),moduleProvideDef(135680,router_RouterPreloader,router_RouterPreloader,[router_Router,NgModuleFactoryLoader,Compiler,Injector,PreloadingStrategy]),moduleProvideDef(4608,router_PreloadAllModules,router_PreloadAllModules,[]),moduleProvideDef(5120,RouterScroller,createRouterScroller,[router_Router,common_ViewportScroller,ROUTER_CONFIGURATION]),moduleProvideDef(5120,ROUTER_INITIALIZER,getBootstrapListener,[router_RouterInitializer]),moduleProvideDef(5120,APP_BOOTSTRAP_LISTENER,function(p0_0){return[p0_0]},[ROUTER_INITIALIZER]),moduleProvideDef(5120,LOCALE_ID$1,_localeFactory,[[3,LOCALE_ID$1]]),moduleProvideDef(4608,NgLocalization,NgLocaleLocalization,[LOCALE_ID$1,[2,DEPRECATED_PLURAL_FN]]),moduleProvideDef(5120,SCHEDULER,zoneSchedulerFactory,[NgZone]),moduleProvideDef(5120,APP_ID,_appIdRandomProviderFactory,[]),moduleProvideDef(5120,IterableDiffers,_iterableDiffersFactory,[]),moduleProvideDef(5120,KeyValueDiffers,_keyValueDiffersFactory,[]),moduleProvideDef(4608,DomSanitizer,platform_browser_DomSanitizerImpl,[DOCUMENT]),moduleProvideDef(6144,Sanitizer,null,[DomSanitizer]),moduleProvideDef(4608,HAMMER_GESTURE_CONFIG,HammerGestureConfig,[]),moduleProvideDef(5120,EVENT_MANAGER_PLUGINS,function(p0_0,p0_1,p0_2,p1_0,p2_0,p2_1,p2_2,p2_3){return[new platform_browser_DomEventsPlugin(p0_0,p0_1,p0_2),new KeyEventsPlugin(p1_0),new HammerGesturesPlugin(p2_0,p2_1,p2_2,p2_3)]},[DOCUMENT,NgZone,PLATFORM_ID,DOCUMENT,DOCUMENT,HAMMER_GESTURE_CONFIG,Console,[2,HAMMER_LOADER]]),moduleProvideDef(4608,EventManager,EventManager,[EVENT_MANAGER_PLUGINS,NgZone]),moduleProvideDef(135680,DomSharedStylesHost,DomSharedStylesHost,[DOCUMENT]),moduleProvideDef(4608,platform_browser_DomRendererFactory2,platform_browser_DomRendererFactory2,[EventManager,DomSharedStylesHost,APP_ID]),moduleProvideDef(6144,RendererFactory2,null,[platform_browser_DomRendererFactory2]),moduleProvideDef(6144,SharedStylesHost,null,[DomSharedStylesHost]),moduleProvideDef(4608,Testability,Testability,[NgZone]),moduleProvideDef(1024,ROUTER_FORROOT_GUARD,provideForRootGuard,[[3,router_Router]]),moduleProvideDef(1024,ErrorHandler,errorHandler,[]),moduleProvideDef(512,router_RouterInitializer,router_RouterInitializer,[Injector]),moduleProvideDef(1024,NgProbeToken,function(){return[routerNgProbeToken()]},[]),moduleProvideDef(1024,APP_INITIALIZER,function(p0_0,p1_0){return[getAppInitializer(p0_0),(coreTokens=p1_0,exportNgVar("probe",inspectNativeElement),exportNgVar("coreTokens",Object.assign({},CORE_TOKENS,(coreTokens||[]).reduce((prev,t)=>(prev[t.name]=t.token,prev),{}))),()=>inspectNativeElement)];var coreTokens},[router_RouterInitializer,[2,NgProbeToken]]),moduleProvideDef(512,ApplicationInitStatus,ApplicationInitStatus,[[2,APP_INITIALIZER]]),moduleProvideDef(131584,core_ApplicationRef,core_ApplicationRef,[NgZone,Console,Injector,ErrorHandler,ComponentFactoryResolver,ApplicationInitStatus]),moduleProvideDef(512,UrlSerializer,DefaultUrlSerializer,[]),moduleProvideDef(512,ChildrenOutletContexts,ChildrenOutletContexts,[]),moduleProvideDef(256,ROUTER_CONFIGURATION,{},[]),moduleProvideDef(1024,LocationStrategy,provideLocationStrategy,[PlatformLocation,[2,APP_BASE_HREF],ROUTER_CONFIGURATION]),moduleProvideDef(512,common_Location,common_Location,[LocationStrategy,PlatformLocation]),moduleProvideDef(512,Compiler,Compiler,[]),moduleProvideDef(512,NgModuleFactoryLoader,SystemJsNgModuleLoader,[Compiler,[2,SystemJsNgModuleLoaderConfig]]),moduleProvideDef(1024,ROUTES,function(){return[[]]},[]),moduleProvideDef(1024,router_Router,setupRouter,[core_ApplicationRef,UrlSerializer,ChildrenOutletContexts,common_Location,Injector,NgModuleFactoryLoader,Compiler,ROUTES,ROUTER_CONFIGURATION,[2,UrlHandlingStrategy],[2,RouteReuseStrategy]]),moduleProvideDef(1073742336,router_RouterModule,router_RouterModule,[[2,ROUTER_FORROOT_GUARD],[2,router_Router]]),moduleProvideDef(1073742336,AppRoutingModule,AppRoutingModule,[]),moduleProvideDef(1073742336,CommonModule,CommonModule,[]),moduleProvideDef(1073742336,ApplicationModule,ApplicationModule,[core_ApplicationRef]),moduleProvideDef(1073742336,platform_browser_BrowserModule,platform_browser_BrowserModule,[[3,platform_browser_BrowserModule]]),moduleProvideDef(1073742336,GanttModule,GanttModule,[]),moduleProvideDef(1073742336,GanttAllModule,GanttAllModule,[]),moduleProvideDef(1073742336,DropDownListModule,DropDownListModule,[]),moduleProvideDef(1073742336,DropDownListAllModule,DropDownListAllModule,[]),moduleProvideDef(1073742336,CheckBoxModule,CheckBoxModule,[]),moduleProvideDef(1073742336,CheckBoxAllModule,CheckBoxAllModule,[]),moduleProvideDef(1073742336,TextBoxModule,TextBoxModule,[]),moduleProvideDef(1073742336,TextBoxAllModule,TextBoxAllModule,[]),moduleProvideDef(1073742336,NumericTextBoxModule,NumericTextBoxModule,[]),moduleProvideDef(1073742336,NumericTextBoxAllModule,NumericTextBoxAllModule,[]),moduleProvideDef(1073742336,AppModule,AppModule,[]),moduleProvideDef(256,APP_ROOT,!0,[]),moduleProvideDef(256,"GanttFilter",ej2_gantt_es2015_Filter$2,[]),moduleProvideDef(256,"GanttSelection",ej2_gantt_es2015_Selection$1,[]),moduleProvideDef(256,"GanttSort",ej2_gantt_es2015_Sort$1,[]),moduleProvideDef(256,"GanttReorder",ej2_gantt_es2015_Reorder$1,[]),moduleProvideDef(256,"GanttResize",ej2_gantt_es2015_Resize$1,[]),moduleProvideDef(256,"GanttEdit",ej2_gantt_es2015_Edit$2,[]),moduleProvideDef(256,"GanttDayMarkers",ej2_gantt_es2015_DayMarkers,[]),moduleProvideDef(256,"GanttToolbar",ej2_gantt_es2015_Toolbar$3,[]),moduleProvideDef(256,"GanttContextMenu",ej2_gantt_es2015_ContextMenu$2,[])])});(function(){if(_runModeLocked)throw new Error("Cannot enable prod mode after platform setup.");_devMode=!1})(),platformBrowser().bootstrapModuleFactory(AppModuleNgFactory).catch(err=>console.error(err))},zn8P:function(module,exports){function webpackEmptyAsyncContext(req){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e})}webpackEmptyAsyncContext.keys=function(){return[]},webpackEmptyAsyncContext.resolve=webpackEmptyAsyncContext,module.exports=webpackEmptyAsyncContext,webpackEmptyAsyncContext.id="zn8P"}},[[0,0]]]);